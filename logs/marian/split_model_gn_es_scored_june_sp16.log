[2023-06-26 22:05:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:05:42] [marian] Running on node20.datos.cluster.uy as process 30501 with command line:
[2023-06-26 22:05:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 22:05:42] [config] after: 0e
[2023-06-26 22:05:42] [config] after-batches: 0
[2023-06-26 22:05:42] [config] after-epochs: 10
[2023-06-26 22:05:42] [config] all-caps-every: 0
[2023-06-26 22:05:42] [config] allow-unk: false
[2023-06-26 22:05:42] [config] authors: false
[2023-06-26 22:05:42] [config] beam-size: 6
[2023-06-26 22:05:42] [config] bert-class-symbol: "[CLS]"
[2023-06-26 22:05:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 22:05:42] [config] bert-masking-fraction: 0.15
[2023-06-26 22:05:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 22:05:42] [config] bert-train-type-embeddings: true
[2023-06-26 22:05:42] [config] bert-type-vocab-size: 2
[2023-06-26 22:05:42] [config] build-info: ""
[2023-06-26 22:05:42] [config] check-gradient-nan: false
[2023-06-26 22:05:42] [config] check-nan: false
[2023-06-26 22:05:42] [config] cite: false
[2023-06-26 22:05:42] [config] clip-norm: 1
[2023-06-26 22:05:42] [config] cost-scaling:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] cost-type: ce-sum
[2023-06-26 22:05:42] [config] cpu-threads: 0
[2023-06-26 22:05:42] [config] data-threads: 8
[2023-06-26 22:05:42] [config] data-weighting: ""
[2023-06-26 22:05:42] [config] data-weighting-type: sentence
[2023-06-26 22:05:42] [config] dec-cell: gru
[2023-06-26 22:05:42] [config] dec-cell-base-depth: 2
[2023-06-26 22:05:42] [config] dec-cell-high-depth: 1
[2023-06-26 22:05:42] [config] dec-depth: 1
[2023-06-26 22:05:42] [config] devices:
[2023-06-26 22:05:42] [config]   - 0
[2023-06-26 22:05:42] [config] dim-emb: 512
[2023-06-26 22:05:42] [config] dim-rnn: 1024
[2023-06-26 22:05:42] [config] dim-vocabs:
[2023-06-26 22:05:42] [config]   - 16384
[2023-06-26 22:05:42] [config]   - 16384
[2023-06-26 22:05:42] [config] disp-first: 0
[2023-06-26 22:05:42] [config] disp-freq: 1000u
[2023-06-26 22:05:42] [config] disp-label-counts: true
[2023-06-26 22:05:42] [config] dropout-rnn: 0.2
[2023-06-26 22:05:42] [config] dropout-src: 0.1
[2023-06-26 22:05:42] [config] dropout-trg: 0.1
[2023-06-26 22:05:42] [config] dump-config: ""
[2023-06-26 22:05:42] [config] dynamic-gradient-scaling:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] early-stopping: 10
[2023-06-26 22:05:42] [config] early-stopping-on: first
[2023-06-26 22:05:42] [config] embedding-fix-src: false
[2023-06-26 22:05:42] [config] embedding-fix-trg: false
[2023-06-26 22:05:42] [config] embedding-normalization: false
[2023-06-26 22:05:42] [config] embedding-vectors:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] enc-cell: gru
[2023-06-26 22:05:42] [config] enc-cell-depth: 1
[2023-06-26 22:05:42] [config] enc-depth: 1
[2023-06-26 22:05:42] [config] enc-type: bidirectional
[2023-06-26 22:05:42] [config] english-title-case-every: 0
[2023-06-26 22:05:42] [config] exponential-smoothing: 0
[2023-06-26 22:05:42] [config] factor-weight: 1
[2023-06-26 22:05:42] [config] factors-combine: sum
[2023-06-26 22:05:42] [config] factors-dim-emb: 0
[2023-06-26 22:05:42] [config] gradient-checkpointing: false
[2023-06-26 22:05:42] [config] gradient-norm-average-window: 100
[2023-06-26 22:05:42] [config] guided-alignment: none
[2023-06-26 22:05:42] [config] guided-alignment-cost: mse
[2023-06-26 22:05:42] [config] guided-alignment-weight: 0.1
[2023-06-26 22:05:42] [config] ignore-model-config: false
[2023-06-26 22:05:42] [config] input-types:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] interpolate-env-vars: false
[2023-06-26 22:05:42] [config] keep-best: false
[2023-06-26 22:05:42] [config] label-smoothing: 0
[2023-06-26 22:05:42] [config] layer-normalization: true
[2023-06-26 22:05:42] [config] learn-rate: 0.0001
[2023-06-26 22:05:42] [config] lemma-dependency: ""
[2023-06-26 22:05:42] [config] lemma-dim-emb: 0
[2023-06-26 22:05:42] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 22:05:42] [config] log-level: info
[2023-06-26 22:05:42] [config] log-time-zone: ""
[2023-06-26 22:05:42] [config] logical-epoch:
[2023-06-26 22:05:42] [config]   - 1e
[2023-06-26 22:05:42] [config]   - 0
[2023-06-26 22:05:42] [config] lr-decay: 0
[2023-06-26 22:05:42] [config] lr-decay-freq: 50000
[2023-06-26 22:05:42] [config] lr-decay-inv-sqrt:
[2023-06-26 22:05:42] [config]   - 0
[2023-06-26 22:05:42] [config] lr-decay-repeat-warmup: false
[2023-06-26 22:05:42] [config] lr-decay-reset-optimizer: false
[2023-06-26 22:05:42] [config] lr-decay-start:
[2023-06-26 22:05:42] [config]   - 10
[2023-06-26 22:05:42] [config]   - 1
[2023-06-26 22:05:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 22:05:42] [config] lr-report: false
[2023-06-26 22:05:42] [config] lr-warmup: 0
[2023-06-26 22:05:42] [config] lr-warmup-at-reload: false
[2023-06-26 22:05:42] [config] lr-warmup-cycle: false
[2023-06-26 22:05:42] [config] lr-warmup-start-rate: 0
[2023-06-26 22:05:42] [config] max-length: 50
[2023-06-26 22:05:42] [config] max-length-crop: false
[2023-06-26 22:05:42] [config] max-length-factor: 3
[2023-06-26 22:05:42] [config] maxi-batch: 100
[2023-06-26 22:05:42] [config] maxi-batch-sort: trg
[2023-06-26 22:05:42] [config] mini-batch: 64
[2023-06-26 22:05:42] [config] mini-batch-fit: true
[2023-06-26 22:05:42] [config] mini-batch-fit-step: 10
[2023-06-26 22:05:42] [config] mini-batch-round-up: true
[2023-06-26 22:05:42] [config] mini-batch-track-lr: false
[2023-06-26 22:05:42] [config] mini-batch-warmup: 0
[2023-06-26 22:05:42] [config] mini-batch-words: 0
[2023-06-26 22:05:42] [config] mini-batch-words-ref: 0
[2023-06-26 22:05:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:05:42] [config] multi-loss-type: sum
[2023-06-26 22:05:42] [config] n-best: false
[2023-06-26 22:05:42] [config] no-nccl: false
[2023-06-26 22:05:42] [config] no-reload: false
[2023-06-26 22:05:42] [config] no-restore-corpus: false
[2023-06-26 22:05:42] [config] normalize: 0.6
[2023-06-26 22:05:42] [config] normalize-gradient: false
[2023-06-26 22:05:42] [config] num-devices: 0
[2023-06-26 22:05:42] [config] optimizer: adam
[2023-06-26 22:05:42] [config] optimizer-delay: 1
[2023-06-26 22:05:42] [config] optimizer-params:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] output-omit-bias: false
[2023-06-26 22:05:42] [config] overwrite: false
[2023-06-26 22:05:42] [config] precision:
[2023-06-26 22:05:42] [config]   - float32
[2023-06-26 22:05:42] [config]   - float32
[2023-06-26 22:05:42] [config] pretrained-model: ""
[2023-06-26 22:05:42] [config] quantize-biases: false
[2023-06-26 22:05:42] [config] quantize-bits: 0
[2023-06-26 22:05:42] [config] quantize-log-based: false
[2023-06-26 22:05:42] [config] quantize-optimization-steps: 0
[2023-06-26 22:05:42] [config] quiet: false
[2023-06-26 22:05:42] [config] quiet-translation: true
[2023-06-26 22:05:42] [config] relative-paths: false
[2023-06-26 22:05:42] [config] right-left: false
[2023-06-26 22:05:42] [config] save-freq: 10000u
[2023-06-26 22:05:42] [config] seed: 1234
[2023-06-26 22:05:42] [config] sentencepiece-alphas:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] sentencepiece-max-lines: 2000000
[2023-06-26 22:05:42] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 22:05:42] [config] sharding: global
[2023-06-26 22:05:42] [config] shuffle: data
[2023-06-26 22:05:42] [config] shuffle-in-ram: false
[2023-06-26 22:05:42] [config] sigterm: save-and-exit
[2023-06-26 22:05:42] [config] skip: false
[2023-06-26 22:05:42] [config] sqlite: ""
[2023-06-26 22:05:42] [config] sqlite-drop: false
[2023-06-26 22:05:42] [config] sync-freq: 200u
[2023-06-26 22:05:42] [config] sync-sgd: false
[2023-06-26 22:05:42] [config] tempdir: /tmp
[2023-06-26 22:05:42] [config] tied-embeddings: false
[2023-06-26 22:05:42] [config] tied-embeddings-all: true
[2023-06-26 22:05:42] [config] tied-embeddings-src: false
[2023-06-26 22:05:42] [config] train-embedder-rank:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] train-sets:
[2023-06-26 22:05:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 22:05:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 22:05:42] [config] transformer-aan-activation: swish
[2023-06-26 22:05:42] [config] transformer-aan-depth: 2
[2023-06-26 22:05:42] [config] transformer-aan-nogate: false
[2023-06-26 22:05:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 22:05:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 22:05:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 22:05:42] [config] transformer-depth-scaling: false
[2023-06-26 22:05:42] [config] transformer-dim-aan: 2048
[2023-06-26 22:05:42] [config] transformer-dim-ffn: 2048
[2023-06-26 22:05:42] [config] transformer-dropout: 0
[2023-06-26 22:05:42] [config] transformer-dropout-attention: 0
[2023-06-26 22:05:42] [config] transformer-dropout-ffn: 0
[2023-06-26 22:05:42] [config] transformer-ffn-activation: swish
[2023-06-26 22:05:42] [config] transformer-ffn-depth: 2
[2023-06-26 22:05:42] [config] transformer-guided-alignment-layer: last
[2023-06-26 22:05:42] [config] transformer-heads: 8
[2023-06-26 22:05:42] [config] transformer-no-projection: false
[2023-06-26 22:05:42] [config] transformer-pool: false
[2023-06-26 22:05:42] [config] transformer-postprocess: dan
[2023-06-26 22:05:42] [config] transformer-postprocess-emb: d
[2023-06-26 22:05:42] [config] transformer-postprocess-top: ""
[2023-06-26 22:05:42] [config] transformer-preprocess: ""
[2023-06-26 22:05:42] [config] transformer-tied-layers:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] transformer-train-position-embeddings: false
[2023-06-26 22:05:42] [config] tsv: false
[2023-06-26 22:05:42] [config] tsv-fields: 0
[2023-06-26 22:05:42] [config] type: amun
[2023-06-26 22:05:42] [config] ulr: false
[2023-06-26 22:05:42] [config] ulr-dim-emb: 0
[2023-06-26 22:05:42] [config] ulr-dropout: 0
[2023-06-26 22:05:42] [config] ulr-keys-vectors: ""
[2023-06-26 22:05:42] [config] ulr-query-vectors: ""
[2023-06-26 22:05:42] [config] ulr-softmax-temperature: 1
[2023-06-26 22:05:42] [config] ulr-trainable-transformation: false
[2023-06-26 22:05:42] [config] unlikelihood-loss: false
[2023-06-26 22:05:42] [config] valid-freq: 5000000
[2023-06-26 22:05:42] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 22:05:42] [config] valid-max-length: 1000
[2023-06-26 22:05:42] [config] valid-metrics:
[2023-06-26 22:05:42] [config]   - cross-entropy
[2023-06-26 22:05:42] [config]   - translation
[2023-06-26 22:05:42] [config] valid-mini-batch: 32
[2023-06-26 22:05:42] [config] valid-reset-stalled: false
[2023-06-26 22:05:42] [config] valid-script-args:
[2023-06-26 22:05:42] [config]   []
[2023-06-26 22:05:42] [config] valid-script-path: ""
[2023-06-26 22:05:42] [config] valid-sets:
[2023-06-26 22:05:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 22:05:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 22:05:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 22:05:42] [config] vocabs:
[2023-06-26 22:05:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:05:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:05:42] [config] word-penalty: 0
[2023-06-26 22:05:42] [config] word-scores: false
[2023-06-26 22:05:42] [config] workspace: 3000
[2023-06-26 22:05:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:05:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:05:42] [training] Using single-device training
[2023-06-26 22:05:44] Synced seed 1234
[2023-06-26 22:05:44] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:05:44] [SentencePiece] Creating temporary file /tmp/marian.m5tNAz 
[2023-06-26 22:05:44] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 22:05:44] [SentencePiece] Selected 20193 lines
[2023-06-26 22:05:46] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm.vocab
[2023-06-26 22:05:46] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:05:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:05:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 22:05:46] [SentencePiece] Training SentencePiece vocabulary /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:05:46] [SentencePiece] Creating temporary file /tmp/marian.rmBAww 
[2023-06-26 22:05:46] [SentencePiece] Sampling at most 2000000 lines from /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 22:05:46] [SentencePiece] Selected 20193 lines
[2023-06-26 22:05:48] [SentencePiece] Removing /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm.vocab
[2023-06-26 22:05:48] [SentencePiece] Renaming /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm.model to /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:05:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:05:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 22:05:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 22:05:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:05:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:05:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:05:50] [comm] Using global sharding
[2023-06-26 22:05:50] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:05:50] [training] Using 1 GPUs
[2023-06-26 22:05:50] [logits] Applying loss function for 1 factor(s)
[2023-06-26 22:05:50] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:05:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 22:05:54] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:06:06] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 22:06:06] [valid] No post-processing script given for validating translator
[2023-06-26 22:06:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:06:06] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:06:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:06:06] [comm] Using global sharding
[2023-06-26 22:06:06] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:06:06] [training] Using 1 GPUs
[2023-06-26 22:06:06] Training started
[2023-06-26 22:06:06] [data] Shuffling data
[2023-06-26 22:06:06] [data] Done reading 20,192 sentences
[2023-06-26 22:06:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:06:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 22:06:06] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:06:06] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:06:07] Parameter type float32, optimization type float32, casting types false
[2023-06-26 22:06:07] Allocating memory for Adam-specific shards
[2023-06-26 22:06:07] [memory] Reserving 322 MB, device gpu0
[2023-06-26 22:06:42] Seen 16,611 samples
[2023-06-26 22:06:42] Starting data epoch 2 in logical epoch 2
[2023-06-26 22:06:42] [data] Shuffling data
[2023-06-26 22:06:42] [data] Done reading 20,192 sentences
[2023-06-26 22:06:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:07:18] Seen 16,611 samples
[2023-06-26 22:07:18] Starting data epoch 3 in logical epoch 3
[2023-06-26 22:07:18] [data] Shuffling data
[2023-06-26 22:07:18] [data] Done reading 20,192 sentences
[2023-06-26 22:07:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:07:53] Seen 16,611 samples
[2023-06-26 22:07:53] Starting data epoch 4 in logical epoch 4
[2023-06-26 22:07:53] [data] Shuffling data
[2023-06-26 22:07:53] [data] Done reading 20,192 sentences
[2023-06-26 22:07:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:08:29] Seen 16,611 samples
[2023-06-26 22:08:29] Starting data epoch 5 in logical epoch 5
[2023-06-26 22:08:29] [data] Shuffling data
[2023-06-26 22:08:29] [data] Done reading 20,192 sentences
[2023-06-26 22:08:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:09:05] Seen 16,611 samples
[2023-06-26 22:09:05] Starting data epoch 6 in logical epoch 6
[2023-06-26 22:09:05] [data] Shuffling data
[2023-06-26 22:09:05] [data] Done reading 20,192 sentences
[2023-06-26 22:09:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:09:43] Seen 16,611 samples
[2023-06-26 22:09:43] Starting data epoch 7 in logical epoch 7
[2023-06-26 22:09:43] [data] Shuffling data
[2023-06-26 22:09:43] [data] Done reading 20,192 sentences
[2023-06-26 22:09:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:10:23] Seen 16,611 samples
[2023-06-26 22:10:23] Starting data epoch 8 in logical epoch 8
[2023-06-26 22:10:23] [data] Shuffling data
[2023-06-26 22:10:23] [data] Done reading 20,192 sentences
[2023-06-26 22:10:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:11:02] Seen 16,611 samples
[2023-06-26 22:11:02] Starting data epoch 9 in logical epoch 9
[2023-06-26 22:11:02] [data] Shuffling data
[2023-06-26 22:11:02] [data] Done reading 20,192 sentences
[2023-06-26 22:11:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:11:42] Seen 16,611 samples
[2023-06-26 22:11:42] Starting data epoch 10 in logical epoch 10
[2023-06-26 22:11:42] [data] Shuffling data
[2023-06-26 22:11:42] [data] Done reading 20,192 sentences
[2023-06-26 22:11:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:12:10] Ep. 10 : Up. 1000 : Sen. 11,290 : Cost 5.65243578 * 3,775,466 @ 3,758 after 3,775,466 : Time 364.36s : 10361.93 words/s : gNorm 1.1466
[2023-06-26 22:12:23] Seen 16,611 samples
[2023-06-26 22:12:23] Starting data epoch 11 in logical epoch 11
[2023-06-26 22:12:23] Training finished
[2023-06-26 22:12:31] [valid] Ep. 11 : Up. 1033 : cross-entropy : 150.171 : new best
[2023-06-26 22:13:49] [valid] Ep. 11 : Up. 1033 : translation : 0 : new best
[2023-06-26 22:13:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:13:51] Saving Adam parameters
[2023-06-26 22:13:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:19:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:19:09] [marian] Running on node20.datos.cluster.uy as process 32009 with command line:
[2023-06-26 22:19:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 22:19:09] [config] after: 0e
[2023-06-26 22:19:09] [config] after-batches: 0
[2023-06-26 22:19:09] [config] after-epochs: 20
[2023-06-26 22:19:09] [config] all-caps-every: 0
[2023-06-26 22:19:09] [config] allow-unk: false
[2023-06-26 22:19:09] [config] authors: false
[2023-06-26 22:19:09] [config] beam-size: 6
[2023-06-26 22:19:09] [config] bert-class-symbol: "[CLS]"
[2023-06-26 22:19:09] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 22:19:09] [config] bert-masking-fraction: 0.15
[2023-06-26 22:19:09] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 22:19:09] [config] bert-train-type-embeddings: true
[2023-06-26 22:19:09] [config] bert-type-vocab-size: 2
[2023-06-26 22:19:09] [config] build-info: ""
[2023-06-26 22:19:09] [config] check-gradient-nan: false
[2023-06-26 22:19:09] [config] check-nan: false
[2023-06-26 22:19:09] [config] cite: false
[2023-06-26 22:19:09] [config] clip-norm: 1
[2023-06-26 22:19:09] [config] cost-scaling:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] cost-type: ce-sum
[2023-06-26 22:19:09] [config] cpu-threads: 0
[2023-06-26 22:19:09] [config] data-threads: 8
[2023-06-26 22:19:09] [config] data-weighting: ""
[2023-06-26 22:19:09] [config] data-weighting-type: sentence
[2023-06-26 22:19:09] [config] dec-cell: gru
[2023-06-26 22:19:09] [config] dec-cell-base-depth: 2
[2023-06-26 22:19:09] [config] dec-cell-high-depth: 1
[2023-06-26 22:19:09] [config] dec-depth: 1
[2023-06-26 22:19:09] [config] devices:
[2023-06-26 22:19:09] [config]   - 0
[2023-06-26 22:19:09] [config] dim-emb: 512
[2023-06-26 22:19:09] [config] dim-rnn: 1024
[2023-06-26 22:19:09] [config] dim-vocabs:
[2023-06-26 22:19:09] [config]   - 16384
[2023-06-26 22:19:09] [config]   - 16384
[2023-06-26 22:19:09] [config] disp-first: 0
[2023-06-26 22:19:09] [config] disp-freq: 1000u
[2023-06-26 22:19:09] [config] disp-label-counts: true
[2023-06-26 22:19:09] [config] dropout-rnn: 0.2
[2023-06-26 22:19:09] [config] dropout-src: 0.1
[2023-06-26 22:19:09] [config] dropout-trg: 0.1
[2023-06-26 22:19:09] [config] dump-config: ""
[2023-06-26 22:19:09] [config] dynamic-gradient-scaling:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] early-stopping: 10
[2023-06-26 22:19:09] [config] early-stopping-on: first
[2023-06-26 22:19:09] [config] embedding-fix-src: false
[2023-06-26 22:19:09] [config] embedding-fix-trg: false
[2023-06-26 22:19:09] [config] embedding-normalization: false
[2023-06-26 22:19:09] [config] embedding-vectors:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] enc-cell: gru
[2023-06-26 22:19:09] [config] enc-cell-depth: 1
[2023-06-26 22:19:09] [config] enc-depth: 1
[2023-06-26 22:19:09] [config] enc-type: bidirectional
[2023-06-26 22:19:09] [config] english-title-case-every: 0
[2023-06-26 22:19:09] [config] exponential-smoothing: 0
[2023-06-26 22:19:09] [config] factor-weight: 1
[2023-06-26 22:19:09] [config] factors-combine: sum
[2023-06-26 22:19:09] [config] factors-dim-emb: 0
[2023-06-26 22:19:09] [config] gradient-checkpointing: false
[2023-06-26 22:19:09] [config] gradient-norm-average-window: 100
[2023-06-26 22:19:09] [config] guided-alignment: none
[2023-06-26 22:19:09] [config] guided-alignment-cost: mse
[2023-06-26 22:19:09] [config] guided-alignment-weight: 0.1
[2023-06-26 22:19:09] [config] ignore-model-config: false
[2023-06-26 22:19:09] [config] input-types:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] interpolate-env-vars: false
[2023-06-26 22:19:09] [config] keep-best: false
[2023-06-26 22:19:09] [config] label-smoothing: 0
[2023-06-26 22:19:09] [config] layer-normalization: true
[2023-06-26 22:19:09] [config] learn-rate: 0.0001
[2023-06-26 22:19:09] [config] lemma-dependency: ""
[2023-06-26 22:19:09] [config] lemma-dim-emb: 0
[2023-06-26 22:19:09] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 22:19:09] [config] log-level: info
[2023-06-26 22:19:09] [config] log-time-zone: ""
[2023-06-26 22:19:09] [config] logical-epoch:
[2023-06-26 22:19:09] [config]   - 1e
[2023-06-26 22:19:09] [config]   - 0
[2023-06-26 22:19:09] [config] lr-decay: 0
[2023-06-26 22:19:09] [config] lr-decay-freq: 50000
[2023-06-26 22:19:09] [config] lr-decay-inv-sqrt:
[2023-06-26 22:19:09] [config]   - 0
[2023-06-26 22:19:09] [config] lr-decay-repeat-warmup: false
[2023-06-26 22:19:09] [config] lr-decay-reset-optimizer: false
[2023-06-26 22:19:09] [config] lr-decay-start:
[2023-06-26 22:19:09] [config]   - 10
[2023-06-26 22:19:09] [config]   - 1
[2023-06-26 22:19:09] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 22:19:09] [config] lr-report: false
[2023-06-26 22:19:09] [config] lr-warmup: 0
[2023-06-26 22:19:09] [config] lr-warmup-at-reload: false
[2023-06-26 22:19:09] [config] lr-warmup-cycle: false
[2023-06-26 22:19:09] [config] lr-warmup-start-rate: 0
[2023-06-26 22:19:09] [config] max-length: 50
[2023-06-26 22:19:09] [config] max-length-crop: false
[2023-06-26 22:19:09] [config] max-length-factor: 3
[2023-06-26 22:19:09] [config] maxi-batch: 100
[2023-06-26 22:19:09] [config] maxi-batch-sort: trg
[2023-06-26 22:19:09] [config] mini-batch: 64
[2023-06-26 22:19:09] [config] mini-batch-fit: true
[2023-06-26 22:19:09] [config] mini-batch-fit-step: 10
[2023-06-26 22:19:09] [config] mini-batch-round-up: true
[2023-06-26 22:19:09] [config] mini-batch-track-lr: false
[2023-06-26 22:19:09] [config] mini-batch-warmup: 0
[2023-06-26 22:19:09] [config] mini-batch-words: 0
[2023-06-26 22:19:09] [config] mini-batch-words-ref: 0
[2023-06-26 22:19:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:19:09] [config] multi-loss-type: sum
[2023-06-26 22:19:09] [config] n-best: false
[2023-06-26 22:19:09] [config] no-nccl: false
[2023-06-26 22:19:09] [config] no-reload: false
[2023-06-26 22:19:09] [config] no-restore-corpus: false
[2023-06-26 22:19:09] [config] normalize: 0.6
[2023-06-26 22:19:09] [config] normalize-gradient: false
[2023-06-26 22:19:09] [config] num-devices: 0
[2023-06-26 22:19:09] [config] optimizer: adam
[2023-06-26 22:19:09] [config] optimizer-delay: 1
[2023-06-26 22:19:09] [config] optimizer-params:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] output-omit-bias: false
[2023-06-26 22:19:09] [config] overwrite: false
[2023-06-26 22:19:09] [config] precision:
[2023-06-26 22:19:09] [config]   - float32
[2023-06-26 22:19:09] [config]   - float32
[2023-06-26 22:19:09] [config] pretrained-model: ""
[2023-06-26 22:19:09] [config] quantize-biases: false
[2023-06-26 22:19:09] [config] quantize-bits: 0
[2023-06-26 22:19:09] [config] quantize-log-based: false
[2023-06-26 22:19:09] [config] quantize-optimization-steps: 0
[2023-06-26 22:19:09] [config] quiet: false
[2023-06-26 22:19:09] [config] quiet-translation: true
[2023-06-26 22:19:09] [config] relative-paths: false
[2023-06-26 22:19:09] [config] right-left: false
[2023-06-26 22:19:09] [config] save-freq: 10000u
[2023-06-26 22:19:09] [config] seed: 1234
[2023-06-26 22:19:09] [config] sentencepiece-alphas:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] sentencepiece-max-lines: 2000000
[2023-06-26 22:19:09] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 22:19:09] [config] sharding: global
[2023-06-26 22:19:09] [config] shuffle: data
[2023-06-26 22:19:09] [config] shuffle-in-ram: false
[2023-06-26 22:19:09] [config] sigterm: save-and-exit
[2023-06-26 22:19:09] [config] skip: false
[2023-06-26 22:19:09] [config] sqlite: ""
[2023-06-26 22:19:09] [config] sqlite-drop: false
[2023-06-26 22:19:09] [config] sync-freq: 200u
[2023-06-26 22:19:09] [config] sync-sgd: false
[2023-06-26 22:19:09] [config] tempdir: /tmp
[2023-06-26 22:19:09] [config] tied-embeddings: false
[2023-06-26 22:19:09] [config] tied-embeddings-all: true
[2023-06-26 22:19:09] [config] tied-embeddings-src: false
[2023-06-26 22:19:09] [config] train-embedder-rank:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] train-sets:
[2023-06-26 22:19:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 22:19:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 22:19:09] [config] transformer-aan-activation: swish
[2023-06-26 22:19:09] [config] transformer-aan-depth: 2
[2023-06-26 22:19:09] [config] transformer-aan-nogate: false
[2023-06-26 22:19:09] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 22:19:09] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 22:19:09] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 22:19:09] [config] transformer-depth-scaling: false
[2023-06-26 22:19:09] [config] transformer-dim-aan: 2048
[2023-06-26 22:19:09] [config] transformer-dim-ffn: 2048
[2023-06-26 22:19:09] [config] transformer-dropout: 0
[2023-06-26 22:19:09] [config] transformer-dropout-attention: 0
[2023-06-26 22:19:09] [config] transformer-dropout-ffn: 0
[2023-06-26 22:19:09] [config] transformer-ffn-activation: swish
[2023-06-26 22:19:09] [config] transformer-ffn-depth: 2
[2023-06-26 22:19:09] [config] transformer-guided-alignment-layer: last
[2023-06-26 22:19:09] [config] transformer-heads: 8
[2023-06-26 22:19:09] [config] transformer-no-projection: false
[2023-06-26 22:19:09] [config] transformer-pool: false
[2023-06-26 22:19:09] [config] transformer-postprocess: dan
[2023-06-26 22:19:09] [config] transformer-postprocess-emb: d
[2023-06-26 22:19:09] [config] transformer-postprocess-top: ""
[2023-06-26 22:19:09] [config] transformer-preprocess: ""
[2023-06-26 22:19:09] [config] transformer-tied-layers:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] transformer-train-position-embeddings: false
[2023-06-26 22:19:09] [config] tsv: false
[2023-06-26 22:19:09] [config] tsv-fields: 0
[2023-06-26 22:19:09] [config] type: amun
[2023-06-26 22:19:09] [config] ulr: false
[2023-06-26 22:19:09] [config] ulr-dim-emb: 0
[2023-06-26 22:19:09] [config] ulr-dropout: 0
[2023-06-26 22:19:09] [config] ulr-keys-vectors: ""
[2023-06-26 22:19:09] [config] ulr-query-vectors: ""
[2023-06-26 22:19:09] [config] ulr-softmax-temperature: 1
[2023-06-26 22:19:09] [config] ulr-trainable-transformation: false
[2023-06-26 22:19:09] [config] unlikelihood-loss: false
[2023-06-26 22:19:09] [config] valid-freq: 5000000
[2023-06-26 22:19:09] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 22:19:09] [config] valid-max-length: 1000
[2023-06-26 22:19:09] [config] valid-metrics:
[2023-06-26 22:19:09] [config]   - cross-entropy
[2023-06-26 22:19:09] [config]   - translation
[2023-06-26 22:19:09] [config] valid-mini-batch: 32
[2023-06-26 22:19:09] [config] valid-reset-stalled: false
[2023-06-26 22:19:09] [config] valid-script-args:
[2023-06-26 22:19:09] [config]   []
[2023-06-26 22:19:09] [config] valid-script-path: ""
[2023-06-26 22:19:09] [config] valid-sets:
[2023-06-26 22:19:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 22:19:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 22:19:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 22:19:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:19:09] [config] vocabs:
[2023-06-26 22:19:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:19:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:19:09] [config] word-penalty: 0
[2023-06-26 22:19:09] [config] word-scores: false
[2023-06-26 22:19:09] [config] workspace: 3000
[2023-06-26 22:19:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:19:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:19:09] [training] Using single-device training
[2023-06-26 22:19:09] Synced seed 1234
[2023-06-26 22:19:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:19:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 22:19:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:19:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 22:19:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 22:19:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:19:10] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:19:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:19:10] [comm] Using global sharding
[2023-06-26 22:19:10] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:19:10] [training] Using 1 GPUs
[2023-06-26 22:19:10] [logits] Applying loss function for 1 factor(s)
[2023-06-26 22:19:10] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:19:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 22:19:11] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:19:23] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 22:19:23] [valid] No post-processing script given for validating translator
[2023-06-26 22:19:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:19:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:19:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:19:23] [comm] Using global sharding
[2023-06-26 22:19:23] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:19:23] [training] Using 1 GPUs
[2023-06-26 22:19:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:19:24] Loading Adam parameters
[2023-06-26 22:19:24] [memory] Reserving 322 MB, device gpu0
[2023-06-26 22:19:25] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:19:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:19:25] [data] Restoring the corpus state to epoch 11, batch 1033
[2023-06-26 22:19:25] [data] Shuffling data
[2023-06-26 22:19:25] [data] Done reading 20,192 sentences
[2023-06-26 22:19:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:19:25] Training started
[2023-06-26 22:19:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 22:19:25] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:19:25] Parameter type float32, optimization type float32, casting types false
[2023-06-26 22:20:01] Seen 16,611 samples
[2023-06-26 22:20:01] Starting data epoch 12 in logical epoch 12
[2023-06-26 22:20:01] [data] Shuffling data
[2023-06-26 22:20:01] [data] Done reading 20,192 sentences
[2023-06-26 22:20:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:20:39] Seen 16,611 samples
[2023-06-26 22:20:39] Starting data epoch 13 in logical epoch 13
[2023-06-26 22:20:39] [data] Shuffling data
[2023-06-26 22:20:39] [data] Done reading 20,192 sentences
[2023-06-26 22:20:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:21:19] Seen 16,611 samples
[2023-06-26 22:21:19] Starting data epoch 14 in logical epoch 14
[2023-06-26 22:21:19] [data] Shuffling data
[2023-06-26 22:21:19] [data] Done reading 20,192 sentences
[2023-06-26 22:21:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:22:00] Seen 16,611 samples
[2023-06-26 22:22:00] Starting data epoch 15 in logical epoch 15
[2023-06-26 22:22:00] [data] Shuffling data
[2023-06-26 22:22:00] [data] Done reading 20,192 sentences
[2023-06-26 22:22:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:22:40] Seen 16,611 samples
[2023-06-26 22:22:40] Starting data epoch 16 in logical epoch 16
[2023-06-26 22:22:40] [data] Shuffling data
[2023-06-26 22:22:40] [data] Done reading 20,192 sentences
[2023-06-26 22:22:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:23:20] Seen 16,611 samples
[2023-06-26 22:23:20] Starting data epoch 17 in logical epoch 17
[2023-06-26 22:23:20] [data] Shuffling data
[2023-06-26 22:23:20] [data] Done reading 20,192 sentences
[2023-06-26 22:23:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:24:01] Seen 16,611 samples
[2023-06-26 22:24:01] Starting data epoch 18 in logical epoch 18
[2023-06-26 22:24:01] [data] Shuffling data
[2023-06-26 22:24:01] [data] Done reading 20,192 sentences
[2023-06-26 22:24:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:24:41] Seen 16,611 samples
[2023-06-26 22:24:41] Starting data epoch 19 in logical epoch 19
[2023-06-26 22:24:41] [data] Shuffling data
[2023-06-26 22:24:41] [data] Done reading 20,192 sentences
[2023-06-26 22:24:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:25:22] Seen 16,611 samples
[2023-06-26 22:25:22] Starting data epoch 20 in logical epoch 20
[2023-06-26 22:25:22] [data] Shuffling data
[2023-06-26 22:25:22] [data] Done reading 20,192 sentences
[2023-06-26 22:25:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:25:37] Ep. 20 : Up. 2000 : Sen. 6,131 : Cost 4.29982090 * 3,769,706 @ 2,447 after 7,545,172 : Time 373.91s : 10081.83 words/s : gNorm 1.1690
[2023-06-26 22:26:04] Seen 16,611 samples
[2023-06-26 22:26:04] Starting data epoch 21 in logical epoch 21
[2023-06-26 22:26:04] Training finished
[2023-06-26 22:26:13] [valid] Ep. 21 : Up. 2065 : cross-entropy : 133.655 : new best
[2023-06-26 22:27:05] [valid] Ep. 21 : Up. 2065 : translation : 0 : new best
[2023-06-26 22:27:05] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:27:07] Saving Adam parameters
[2023-06-26 22:27:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:31:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:31:07] [marian] Running on node20.datos.cluster.uy as process 32703 with command line:
[2023-06-26 22:31:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 22:31:07] [config] after: 0e
[2023-06-26 22:31:07] [config] after-batches: 0
[2023-06-26 22:31:07] [config] after-epochs: 30
[2023-06-26 22:31:07] [config] all-caps-every: 0
[2023-06-26 22:31:07] [config] allow-unk: false
[2023-06-26 22:31:07] [config] authors: false
[2023-06-26 22:31:07] [config] beam-size: 6
[2023-06-26 22:31:07] [config] bert-class-symbol: "[CLS]"
[2023-06-26 22:31:07] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 22:31:07] [config] bert-masking-fraction: 0.15
[2023-06-26 22:31:07] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 22:31:07] [config] bert-train-type-embeddings: true
[2023-06-26 22:31:07] [config] bert-type-vocab-size: 2
[2023-06-26 22:31:07] [config] build-info: ""
[2023-06-26 22:31:07] [config] check-gradient-nan: false
[2023-06-26 22:31:07] [config] check-nan: false
[2023-06-26 22:31:07] [config] cite: false
[2023-06-26 22:31:07] [config] clip-norm: 1
[2023-06-26 22:31:07] [config] cost-scaling:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] cost-type: ce-sum
[2023-06-26 22:31:07] [config] cpu-threads: 0
[2023-06-26 22:31:07] [config] data-threads: 8
[2023-06-26 22:31:07] [config] data-weighting: ""
[2023-06-26 22:31:07] [config] data-weighting-type: sentence
[2023-06-26 22:31:07] [config] dec-cell: gru
[2023-06-26 22:31:07] [config] dec-cell-base-depth: 2
[2023-06-26 22:31:07] [config] dec-cell-high-depth: 1
[2023-06-26 22:31:07] [config] dec-depth: 1
[2023-06-26 22:31:07] [config] devices:
[2023-06-26 22:31:07] [config]   - 0
[2023-06-26 22:31:07] [config] dim-emb: 512
[2023-06-26 22:31:07] [config] dim-rnn: 1024
[2023-06-26 22:31:07] [config] dim-vocabs:
[2023-06-26 22:31:07] [config]   - 16384
[2023-06-26 22:31:07] [config]   - 16384
[2023-06-26 22:31:07] [config] disp-first: 0
[2023-06-26 22:31:07] [config] disp-freq: 1000u
[2023-06-26 22:31:07] [config] disp-label-counts: true
[2023-06-26 22:31:07] [config] dropout-rnn: 0.2
[2023-06-26 22:31:07] [config] dropout-src: 0.1
[2023-06-26 22:31:07] [config] dropout-trg: 0.1
[2023-06-26 22:31:07] [config] dump-config: ""
[2023-06-26 22:31:07] [config] dynamic-gradient-scaling:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] early-stopping: 10
[2023-06-26 22:31:07] [config] early-stopping-on: first
[2023-06-26 22:31:07] [config] embedding-fix-src: false
[2023-06-26 22:31:07] [config] embedding-fix-trg: false
[2023-06-26 22:31:07] [config] embedding-normalization: false
[2023-06-26 22:31:07] [config] embedding-vectors:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] enc-cell: gru
[2023-06-26 22:31:07] [config] enc-cell-depth: 1
[2023-06-26 22:31:07] [config] enc-depth: 1
[2023-06-26 22:31:07] [config] enc-type: bidirectional
[2023-06-26 22:31:07] [config] english-title-case-every: 0
[2023-06-26 22:31:07] [config] exponential-smoothing: 0
[2023-06-26 22:31:07] [config] factor-weight: 1
[2023-06-26 22:31:07] [config] factors-combine: sum
[2023-06-26 22:31:07] [config] factors-dim-emb: 0
[2023-06-26 22:31:07] [config] gradient-checkpointing: false
[2023-06-26 22:31:07] [config] gradient-norm-average-window: 100
[2023-06-26 22:31:07] [config] guided-alignment: none
[2023-06-26 22:31:07] [config] guided-alignment-cost: mse
[2023-06-26 22:31:07] [config] guided-alignment-weight: 0.1
[2023-06-26 22:31:07] [config] ignore-model-config: false
[2023-06-26 22:31:07] [config] input-types:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] interpolate-env-vars: false
[2023-06-26 22:31:07] [config] keep-best: false
[2023-06-26 22:31:07] [config] label-smoothing: 0
[2023-06-26 22:31:07] [config] layer-normalization: true
[2023-06-26 22:31:07] [config] learn-rate: 0.0001
[2023-06-26 22:31:07] [config] lemma-dependency: ""
[2023-06-26 22:31:07] [config] lemma-dim-emb: 0
[2023-06-26 22:31:07] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 22:31:07] [config] log-level: info
[2023-06-26 22:31:07] [config] log-time-zone: ""
[2023-06-26 22:31:07] [config] logical-epoch:
[2023-06-26 22:31:07] [config]   - 1e
[2023-06-26 22:31:07] [config]   - 0
[2023-06-26 22:31:07] [config] lr-decay: 0
[2023-06-26 22:31:07] [config] lr-decay-freq: 50000
[2023-06-26 22:31:07] [config] lr-decay-inv-sqrt:
[2023-06-26 22:31:07] [config]   - 0
[2023-06-26 22:31:07] [config] lr-decay-repeat-warmup: false
[2023-06-26 22:31:07] [config] lr-decay-reset-optimizer: false
[2023-06-26 22:31:07] [config] lr-decay-start:
[2023-06-26 22:31:07] [config]   - 10
[2023-06-26 22:31:07] [config]   - 1
[2023-06-26 22:31:07] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 22:31:07] [config] lr-report: false
[2023-06-26 22:31:07] [config] lr-warmup: 0
[2023-06-26 22:31:07] [config] lr-warmup-at-reload: false
[2023-06-26 22:31:07] [config] lr-warmup-cycle: false
[2023-06-26 22:31:07] [config] lr-warmup-start-rate: 0
[2023-06-26 22:31:07] [config] max-length: 50
[2023-06-26 22:31:07] [config] max-length-crop: false
[2023-06-26 22:31:07] [config] max-length-factor: 3
[2023-06-26 22:31:07] [config] maxi-batch: 100
[2023-06-26 22:31:07] [config] maxi-batch-sort: trg
[2023-06-26 22:31:07] [config] mini-batch: 64
[2023-06-26 22:31:07] [config] mini-batch-fit: true
[2023-06-26 22:31:07] [config] mini-batch-fit-step: 10
[2023-06-26 22:31:07] [config] mini-batch-round-up: true
[2023-06-26 22:31:07] [config] mini-batch-track-lr: false
[2023-06-26 22:31:07] [config] mini-batch-warmup: 0
[2023-06-26 22:31:07] [config] mini-batch-words: 0
[2023-06-26 22:31:07] [config] mini-batch-words-ref: 0
[2023-06-26 22:31:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:31:07] [config] multi-loss-type: sum
[2023-06-26 22:31:07] [config] n-best: false
[2023-06-26 22:31:07] [config] no-nccl: false
[2023-06-26 22:31:07] [config] no-reload: false
[2023-06-26 22:31:07] [config] no-restore-corpus: false
[2023-06-26 22:31:07] [config] normalize: 0.6
[2023-06-26 22:31:07] [config] normalize-gradient: false
[2023-06-26 22:31:07] [config] num-devices: 0
[2023-06-26 22:31:07] [config] optimizer: adam
[2023-06-26 22:31:07] [config] optimizer-delay: 1
[2023-06-26 22:31:07] [config] optimizer-params:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] output-omit-bias: false
[2023-06-26 22:31:07] [config] overwrite: false
[2023-06-26 22:31:07] [config] precision:
[2023-06-26 22:31:07] [config]   - float32
[2023-06-26 22:31:07] [config]   - float32
[2023-06-26 22:31:07] [config] pretrained-model: ""
[2023-06-26 22:31:07] [config] quantize-biases: false
[2023-06-26 22:31:07] [config] quantize-bits: 0
[2023-06-26 22:31:07] [config] quantize-log-based: false
[2023-06-26 22:31:07] [config] quantize-optimization-steps: 0
[2023-06-26 22:31:07] [config] quiet: false
[2023-06-26 22:31:07] [config] quiet-translation: true
[2023-06-26 22:31:07] [config] relative-paths: false
[2023-06-26 22:31:07] [config] right-left: false
[2023-06-26 22:31:07] [config] save-freq: 10000u
[2023-06-26 22:31:07] [config] seed: 1234
[2023-06-26 22:31:07] [config] sentencepiece-alphas:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] sentencepiece-max-lines: 2000000
[2023-06-26 22:31:07] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 22:31:07] [config] sharding: global
[2023-06-26 22:31:07] [config] shuffle: data
[2023-06-26 22:31:07] [config] shuffle-in-ram: false
[2023-06-26 22:31:07] [config] sigterm: save-and-exit
[2023-06-26 22:31:07] [config] skip: false
[2023-06-26 22:31:07] [config] sqlite: ""
[2023-06-26 22:31:07] [config] sqlite-drop: false
[2023-06-26 22:31:07] [config] sync-freq: 200u
[2023-06-26 22:31:07] [config] sync-sgd: false
[2023-06-26 22:31:07] [config] tempdir: /tmp
[2023-06-26 22:31:07] [config] tied-embeddings: false
[2023-06-26 22:31:07] [config] tied-embeddings-all: true
[2023-06-26 22:31:07] [config] tied-embeddings-src: false
[2023-06-26 22:31:07] [config] train-embedder-rank:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] train-sets:
[2023-06-26 22:31:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 22:31:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 22:31:07] [config] transformer-aan-activation: swish
[2023-06-26 22:31:07] [config] transformer-aan-depth: 2
[2023-06-26 22:31:07] [config] transformer-aan-nogate: false
[2023-06-26 22:31:07] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 22:31:07] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 22:31:07] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 22:31:07] [config] transformer-depth-scaling: false
[2023-06-26 22:31:07] [config] transformer-dim-aan: 2048
[2023-06-26 22:31:07] [config] transformer-dim-ffn: 2048
[2023-06-26 22:31:07] [config] transformer-dropout: 0
[2023-06-26 22:31:07] [config] transformer-dropout-attention: 0
[2023-06-26 22:31:07] [config] transformer-dropout-ffn: 0
[2023-06-26 22:31:07] [config] transformer-ffn-activation: swish
[2023-06-26 22:31:07] [config] transformer-ffn-depth: 2
[2023-06-26 22:31:07] [config] transformer-guided-alignment-layer: last
[2023-06-26 22:31:07] [config] transformer-heads: 8
[2023-06-26 22:31:07] [config] transformer-no-projection: false
[2023-06-26 22:31:07] [config] transformer-pool: false
[2023-06-26 22:31:07] [config] transformer-postprocess: dan
[2023-06-26 22:31:07] [config] transformer-postprocess-emb: d
[2023-06-26 22:31:07] [config] transformer-postprocess-top: ""
[2023-06-26 22:31:07] [config] transformer-preprocess: ""
[2023-06-26 22:31:07] [config] transformer-tied-layers:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] transformer-train-position-embeddings: false
[2023-06-26 22:31:07] [config] tsv: false
[2023-06-26 22:31:07] [config] tsv-fields: 0
[2023-06-26 22:31:07] [config] type: amun
[2023-06-26 22:31:07] [config] ulr: false
[2023-06-26 22:31:07] [config] ulr-dim-emb: 0
[2023-06-26 22:31:07] [config] ulr-dropout: 0
[2023-06-26 22:31:07] [config] ulr-keys-vectors: ""
[2023-06-26 22:31:07] [config] ulr-query-vectors: ""
[2023-06-26 22:31:07] [config] ulr-softmax-temperature: 1
[2023-06-26 22:31:07] [config] ulr-trainable-transformation: false
[2023-06-26 22:31:07] [config] unlikelihood-loss: false
[2023-06-26 22:31:07] [config] valid-freq: 5000000
[2023-06-26 22:31:07] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 22:31:07] [config] valid-max-length: 1000
[2023-06-26 22:31:07] [config] valid-metrics:
[2023-06-26 22:31:07] [config]   - cross-entropy
[2023-06-26 22:31:07] [config]   - translation
[2023-06-26 22:31:07] [config] valid-mini-batch: 32
[2023-06-26 22:31:07] [config] valid-reset-stalled: false
[2023-06-26 22:31:07] [config] valid-script-args:
[2023-06-26 22:31:07] [config]   []
[2023-06-26 22:31:07] [config] valid-script-path: ""
[2023-06-26 22:31:07] [config] valid-sets:
[2023-06-26 22:31:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 22:31:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 22:31:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 22:31:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:31:07] [config] vocabs:
[2023-06-26 22:31:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:31:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:31:07] [config] word-penalty: 0
[2023-06-26 22:31:07] [config] word-scores: false
[2023-06-26 22:31:07] [config] workspace: 3000
[2023-06-26 22:31:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:31:07] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:31:07] [training] Using single-device training
[2023-06-26 22:31:07] Synced seed 1234
[2023-06-26 22:31:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:31:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 22:31:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:31:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 22:31:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 22:31:07] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:31:08] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:31:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:31:08] [comm] Using global sharding
[2023-06-26 22:31:08] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:31:08] [training] Using 1 GPUs
[2023-06-26 22:31:08] [logits] Applying loss function for 1 factor(s)
[2023-06-26 22:31:08] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:31:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 22:31:09] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:31:21] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 22:31:21] [valid] No post-processing script given for validating translator
[2023-06-26 22:31:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:31:21] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:31:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:31:21] [comm] Using global sharding
[2023-06-26 22:31:21] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:31:21] [training] Using 1 GPUs
[2023-06-26 22:31:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:31:22] Loading Adam parameters
[2023-06-26 22:31:22] [memory] Reserving 322 MB, device gpu0
[2023-06-26 22:31:22] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:31:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:31:22] [data] Restoring the corpus state to epoch 21, batch 2065
[2023-06-26 22:31:22] [data] Shuffling data
[2023-06-26 22:31:22] [data] Done reading 20,192 sentences
[2023-06-26 22:31:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:31:22] Training started
[2023-06-26 22:31:22] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 22:31:22] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:31:23] Parameter type float32, optimization type float32, casting types false
[2023-06-26 22:31:59] Seen 16,611 samples
[2023-06-26 22:31:59] Starting data epoch 22 in logical epoch 22
[2023-06-26 22:31:59] [data] Shuffling data
[2023-06-26 22:31:59] [data] Done reading 20,192 sentences
[2023-06-26 22:31:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:32:39] Seen 16,611 samples
[2023-06-26 22:32:39] Starting data epoch 23 in logical epoch 23
[2023-06-26 22:32:39] [data] Shuffling data
[2023-06-26 22:32:39] [data] Done reading 20,192 sentences
[2023-06-26 22:32:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:33:20] Seen 16,611 samples
[2023-06-26 22:33:20] Starting data epoch 24 in logical epoch 24
[2023-06-26 22:33:20] [data] Shuffling data
[2023-06-26 22:33:20] [data] Done reading 20,192 sentences
[2023-06-26 22:33:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:34:00] Seen 16,611 samples
[2023-06-26 22:34:00] Starting data epoch 25 in logical epoch 25
[2023-06-26 22:34:00] [data] Shuffling data
[2023-06-26 22:34:00] [data] Done reading 20,192 sentences
[2023-06-26 22:34:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:34:40] Seen 16,611 samples
[2023-06-26 22:34:40] Starting data epoch 26 in logical epoch 26
[2023-06-26 22:34:40] [data] Shuffling data
[2023-06-26 22:34:40] [data] Done reading 20,192 sentences
[2023-06-26 22:34:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:35:21] Seen 16,611 samples
[2023-06-26 22:35:21] Starting data epoch 27 in logical epoch 27
[2023-06-26 22:35:21] [data] Shuffling data
[2023-06-26 22:35:21] [data] Done reading 20,192 sentences
[2023-06-26 22:35:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:36:02] Seen 16,611 samples
[2023-06-26 22:36:02] Starting data epoch 28 in logical epoch 28
[2023-06-26 22:36:02] [data] Shuffling data
[2023-06-26 22:36:02] [data] Done reading 20,192 sentences
[2023-06-26 22:36:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:36:42] Seen 16,611 samples
[2023-06-26 22:36:42] Starting data epoch 29 in logical epoch 29
[2023-06-26 22:36:42] [data] Shuffling data
[2023-06-26 22:36:42] [data] Done reading 20,192 sentences
[2023-06-26 22:36:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:37:22] Seen 16,611 samples
[2023-06-26 22:37:22] Starting data epoch 30 in logical epoch 30
[2023-06-26 22:37:22] [data] Shuffling data
[2023-06-26 22:37:22] [data] Done reading 20,192 sentences
[2023-06-26 22:37:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:37:25] Ep. 30 : Up. 3000 : Sen. 1,220 : Cost 3.50897932 * 3,769,090 @ 3,988 after 11,314,262 : Time 364.00s : 10354.77 words/s : gNorm 1.2508
[2023-06-26 22:38:02] Seen 16,611 samples
[2023-06-26 22:38:02] Starting data epoch 31 in logical epoch 31
[2023-06-26 22:38:02] Training finished
[2023-06-26 22:38:11] [valid] Ep. 31 : Up. 3096 : cross-entropy : 125.341 : new best
[2023-06-26 22:38:50] [valid] Ep. 31 : Up. 3096 : translation : 0 : new best
[2023-06-26 22:38:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:38:51] Saving Adam parameters
[2023-06-26 22:38:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:42:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:42:12] [marian] Running on node20.datos.cluster.uy as process 33694 with command line:
[2023-06-26 22:42:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 22:42:12] [config] after: 0e
[2023-06-26 22:42:12] [config] after-batches: 0
[2023-06-26 22:42:12] [config] after-epochs: 40
[2023-06-26 22:42:12] [config] all-caps-every: 0
[2023-06-26 22:42:12] [config] allow-unk: false
[2023-06-26 22:42:12] [config] authors: false
[2023-06-26 22:42:12] [config] beam-size: 6
[2023-06-26 22:42:12] [config] bert-class-symbol: "[CLS]"
[2023-06-26 22:42:12] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 22:42:12] [config] bert-masking-fraction: 0.15
[2023-06-26 22:42:12] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 22:42:12] [config] bert-train-type-embeddings: true
[2023-06-26 22:42:12] [config] bert-type-vocab-size: 2
[2023-06-26 22:42:12] [config] build-info: ""
[2023-06-26 22:42:12] [config] check-gradient-nan: false
[2023-06-26 22:42:12] [config] check-nan: false
[2023-06-26 22:42:12] [config] cite: false
[2023-06-26 22:42:12] [config] clip-norm: 1
[2023-06-26 22:42:12] [config] cost-scaling:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] cost-type: ce-sum
[2023-06-26 22:42:12] [config] cpu-threads: 0
[2023-06-26 22:42:12] [config] data-threads: 8
[2023-06-26 22:42:12] [config] data-weighting: ""
[2023-06-26 22:42:12] [config] data-weighting-type: sentence
[2023-06-26 22:42:12] [config] dec-cell: gru
[2023-06-26 22:42:12] [config] dec-cell-base-depth: 2
[2023-06-26 22:42:12] [config] dec-cell-high-depth: 1
[2023-06-26 22:42:12] [config] dec-depth: 1
[2023-06-26 22:42:12] [config] devices:
[2023-06-26 22:42:12] [config]   - 0
[2023-06-26 22:42:12] [config] dim-emb: 512
[2023-06-26 22:42:12] [config] dim-rnn: 1024
[2023-06-26 22:42:12] [config] dim-vocabs:
[2023-06-26 22:42:12] [config]   - 16384
[2023-06-26 22:42:12] [config]   - 16384
[2023-06-26 22:42:12] [config] disp-first: 0
[2023-06-26 22:42:12] [config] disp-freq: 1000u
[2023-06-26 22:42:12] [config] disp-label-counts: true
[2023-06-26 22:42:12] [config] dropout-rnn: 0.2
[2023-06-26 22:42:12] [config] dropout-src: 0.1
[2023-06-26 22:42:12] [config] dropout-trg: 0.1
[2023-06-26 22:42:12] [config] dump-config: ""
[2023-06-26 22:42:12] [config] dynamic-gradient-scaling:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] early-stopping: 10
[2023-06-26 22:42:12] [config] early-stopping-on: first
[2023-06-26 22:42:12] [config] embedding-fix-src: false
[2023-06-26 22:42:12] [config] embedding-fix-trg: false
[2023-06-26 22:42:12] [config] embedding-normalization: false
[2023-06-26 22:42:12] [config] embedding-vectors:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] enc-cell: gru
[2023-06-26 22:42:12] [config] enc-cell-depth: 1
[2023-06-26 22:42:12] [config] enc-depth: 1
[2023-06-26 22:42:12] [config] enc-type: bidirectional
[2023-06-26 22:42:12] [config] english-title-case-every: 0
[2023-06-26 22:42:12] [config] exponential-smoothing: 0
[2023-06-26 22:42:12] [config] factor-weight: 1
[2023-06-26 22:42:12] [config] factors-combine: sum
[2023-06-26 22:42:12] [config] factors-dim-emb: 0
[2023-06-26 22:42:12] [config] gradient-checkpointing: false
[2023-06-26 22:42:12] [config] gradient-norm-average-window: 100
[2023-06-26 22:42:12] [config] guided-alignment: none
[2023-06-26 22:42:12] [config] guided-alignment-cost: mse
[2023-06-26 22:42:12] [config] guided-alignment-weight: 0.1
[2023-06-26 22:42:12] [config] ignore-model-config: false
[2023-06-26 22:42:12] [config] input-types:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] interpolate-env-vars: false
[2023-06-26 22:42:12] [config] keep-best: false
[2023-06-26 22:42:12] [config] label-smoothing: 0
[2023-06-26 22:42:12] [config] layer-normalization: true
[2023-06-26 22:42:12] [config] learn-rate: 0.0001
[2023-06-26 22:42:12] [config] lemma-dependency: ""
[2023-06-26 22:42:12] [config] lemma-dim-emb: 0
[2023-06-26 22:42:12] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 22:42:12] [config] log-level: info
[2023-06-26 22:42:12] [config] log-time-zone: ""
[2023-06-26 22:42:12] [config] logical-epoch:
[2023-06-26 22:42:12] [config]   - 1e
[2023-06-26 22:42:12] [config]   - 0
[2023-06-26 22:42:12] [config] lr-decay: 0
[2023-06-26 22:42:12] [config] lr-decay-freq: 50000
[2023-06-26 22:42:12] [config] lr-decay-inv-sqrt:
[2023-06-26 22:42:12] [config]   - 0
[2023-06-26 22:42:12] [config] lr-decay-repeat-warmup: false
[2023-06-26 22:42:12] [config] lr-decay-reset-optimizer: false
[2023-06-26 22:42:12] [config] lr-decay-start:
[2023-06-26 22:42:12] [config]   - 10
[2023-06-26 22:42:12] [config]   - 1
[2023-06-26 22:42:12] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 22:42:12] [config] lr-report: false
[2023-06-26 22:42:12] [config] lr-warmup: 0
[2023-06-26 22:42:12] [config] lr-warmup-at-reload: false
[2023-06-26 22:42:12] [config] lr-warmup-cycle: false
[2023-06-26 22:42:12] [config] lr-warmup-start-rate: 0
[2023-06-26 22:42:12] [config] max-length: 50
[2023-06-26 22:42:12] [config] max-length-crop: false
[2023-06-26 22:42:12] [config] max-length-factor: 3
[2023-06-26 22:42:12] [config] maxi-batch: 100
[2023-06-26 22:42:12] [config] maxi-batch-sort: trg
[2023-06-26 22:42:12] [config] mini-batch: 64
[2023-06-26 22:42:12] [config] mini-batch-fit: true
[2023-06-26 22:42:12] [config] mini-batch-fit-step: 10
[2023-06-26 22:42:12] [config] mini-batch-round-up: true
[2023-06-26 22:42:12] [config] mini-batch-track-lr: false
[2023-06-26 22:42:12] [config] mini-batch-warmup: 0
[2023-06-26 22:42:12] [config] mini-batch-words: 0
[2023-06-26 22:42:12] [config] mini-batch-words-ref: 0
[2023-06-26 22:42:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:42:12] [config] multi-loss-type: sum
[2023-06-26 22:42:12] [config] n-best: false
[2023-06-26 22:42:12] [config] no-nccl: false
[2023-06-26 22:42:12] [config] no-reload: false
[2023-06-26 22:42:12] [config] no-restore-corpus: false
[2023-06-26 22:42:12] [config] normalize: 0.6
[2023-06-26 22:42:12] [config] normalize-gradient: false
[2023-06-26 22:42:12] [config] num-devices: 0
[2023-06-26 22:42:12] [config] optimizer: adam
[2023-06-26 22:42:12] [config] optimizer-delay: 1
[2023-06-26 22:42:12] [config] optimizer-params:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] output-omit-bias: false
[2023-06-26 22:42:12] [config] overwrite: false
[2023-06-26 22:42:12] [config] precision:
[2023-06-26 22:42:12] [config]   - float32
[2023-06-26 22:42:12] [config]   - float32
[2023-06-26 22:42:12] [config] pretrained-model: ""
[2023-06-26 22:42:12] [config] quantize-biases: false
[2023-06-26 22:42:12] [config] quantize-bits: 0
[2023-06-26 22:42:12] [config] quantize-log-based: false
[2023-06-26 22:42:12] [config] quantize-optimization-steps: 0
[2023-06-26 22:42:12] [config] quiet: false
[2023-06-26 22:42:12] [config] quiet-translation: true
[2023-06-26 22:42:12] [config] relative-paths: false
[2023-06-26 22:42:12] [config] right-left: false
[2023-06-26 22:42:12] [config] save-freq: 10000u
[2023-06-26 22:42:12] [config] seed: 1234
[2023-06-26 22:42:12] [config] sentencepiece-alphas:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] sentencepiece-max-lines: 2000000
[2023-06-26 22:42:12] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 22:42:12] [config] sharding: global
[2023-06-26 22:42:12] [config] shuffle: data
[2023-06-26 22:42:12] [config] shuffle-in-ram: false
[2023-06-26 22:42:12] [config] sigterm: save-and-exit
[2023-06-26 22:42:12] [config] skip: false
[2023-06-26 22:42:12] [config] sqlite: ""
[2023-06-26 22:42:12] [config] sqlite-drop: false
[2023-06-26 22:42:12] [config] sync-freq: 200u
[2023-06-26 22:42:12] [config] sync-sgd: false
[2023-06-26 22:42:12] [config] tempdir: /tmp
[2023-06-26 22:42:12] [config] tied-embeddings: false
[2023-06-26 22:42:12] [config] tied-embeddings-all: true
[2023-06-26 22:42:12] [config] tied-embeddings-src: false
[2023-06-26 22:42:12] [config] train-embedder-rank:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] train-sets:
[2023-06-26 22:42:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 22:42:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 22:42:12] [config] transformer-aan-activation: swish
[2023-06-26 22:42:12] [config] transformer-aan-depth: 2
[2023-06-26 22:42:12] [config] transformer-aan-nogate: false
[2023-06-26 22:42:12] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 22:42:12] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 22:42:12] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 22:42:12] [config] transformer-depth-scaling: false
[2023-06-26 22:42:12] [config] transformer-dim-aan: 2048
[2023-06-26 22:42:12] [config] transformer-dim-ffn: 2048
[2023-06-26 22:42:12] [config] transformer-dropout: 0
[2023-06-26 22:42:12] [config] transformer-dropout-attention: 0
[2023-06-26 22:42:12] [config] transformer-dropout-ffn: 0
[2023-06-26 22:42:12] [config] transformer-ffn-activation: swish
[2023-06-26 22:42:12] [config] transformer-ffn-depth: 2
[2023-06-26 22:42:12] [config] transformer-guided-alignment-layer: last
[2023-06-26 22:42:12] [config] transformer-heads: 8
[2023-06-26 22:42:12] [config] transformer-no-projection: false
[2023-06-26 22:42:12] [config] transformer-pool: false
[2023-06-26 22:42:12] [config] transformer-postprocess: dan
[2023-06-26 22:42:12] [config] transformer-postprocess-emb: d
[2023-06-26 22:42:12] [config] transformer-postprocess-top: ""
[2023-06-26 22:42:12] [config] transformer-preprocess: ""
[2023-06-26 22:42:12] [config] transformer-tied-layers:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] transformer-train-position-embeddings: false
[2023-06-26 22:42:12] [config] tsv: false
[2023-06-26 22:42:12] [config] tsv-fields: 0
[2023-06-26 22:42:12] [config] type: amun
[2023-06-26 22:42:12] [config] ulr: false
[2023-06-26 22:42:12] [config] ulr-dim-emb: 0
[2023-06-26 22:42:12] [config] ulr-dropout: 0
[2023-06-26 22:42:12] [config] ulr-keys-vectors: ""
[2023-06-26 22:42:12] [config] ulr-query-vectors: ""
[2023-06-26 22:42:12] [config] ulr-softmax-temperature: 1
[2023-06-26 22:42:12] [config] ulr-trainable-transformation: false
[2023-06-26 22:42:12] [config] unlikelihood-loss: false
[2023-06-26 22:42:12] [config] valid-freq: 5000000
[2023-06-26 22:42:12] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 22:42:12] [config] valid-max-length: 1000
[2023-06-26 22:42:12] [config] valid-metrics:
[2023-06-26 22:42:12] [config]   - cross-entropy
[2023-06-26 22:42:12] [config]   - translation
[2023-06-26 22:42:12] [config] valid-mini-batch: 32
[2023-06-26 22:42:12] [config] valid-reset-stalled: false
[2023-06-26 22:42:12] [config] valid-script-args:
[2023-06-26 22:42:12] [config]   []
[2023-06-26 22:42:12] [config] valid-script-path: ""
[2023-06-26 22:42:12] [config] valid-sets:
[2023-06-26 22:42:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 22:42:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 22:42:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 22:42:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:42:12] [config] vocabs:
[2023-06-26 22:42:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:42:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:42:12] [config] word-penalty: 0
[2023-06-26 22:42:12] [config] word-scores: false
[2023-06-26 22:42:12] [config] workspace: 3000
[2023-06-26 22:42:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:42:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:42:12] [training] Using single-device training
[2023-06-26 22:42:14] Synced seed 1234
[2023-06-26 22:42:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:42:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 22:42:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:42:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 22:42:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 22:42:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:42:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:42:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:42:15] [comm] Using global sharding
[2023-06-26 22:42:15] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:42:15] [training] Using 1 GPUs
[2023-06-26 22:42:15] [logits] Applying loss function for 1 factor(s)
[2023-06-26 22:42:15] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:42:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 22:42:16] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:42:28] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 22:42:28] [valid] No post-processing script given for validating translator
[2023-06-26 22:42:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:42:28] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:42:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:42:28] [comm] Using global sharding
[2023-06-26 22:42:28] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:42:28] [training] Using 1 GPUs
[2023-06-26 22:42:28] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:42:29] Loading Adam parameters
[2023-06-26 22:42:29] [memory] Reserving 322 MB, device gpu0
[2023-06-26 22:42:29] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:42:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:42:29] [data] Restoring the corpus state to epoch 31, batch 3096
[2023-06-26 22:42:29] [data] Shuffling data
[2023-06-26 22:42:29] [data] Done reading 20,192 sentences
[2023-06-26 22:42:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:42:29] Training started
[2023-06-26 22:42:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 22:42:29] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:42:30] Parameter type float32, optimization type float32, casting types false
[2023-06-26 22:43:06] Seen 16,611 samples
[2023-06-26 22:43:06] Starting data epoch 32 in logical epoch 32
[2023-06-26 22:43:06] [data] Shuffling data
[2023-06-26 22:43:06] [data] Done reading 20,192 sentences
[2023-06-26 22:43:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:43:45] Seen 16,611 samples
[2023-06-26 22:43:45] Starting data epoch 33 in logical epoch 33
[2023-06-26 22:43:45] [data] Shuffling data
[2023-06-26 22:43:45] [data] Done reading 20,192 sentences
[2023-06-26 22:43:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:44:25] Seen 16,611 samples
[2023-06-26 22:44:25] Starting data epoch 34 in logical epoch 34
[2023-06-26 22:44:25] [data] Shuffling data
[2023-06-26 22:44:25] [data] Done reading 20,192 sentences
[2023-06-26 22:44:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:45:06] Seen 16,611 samples
[2023-06-26 22:45:06] Starting data epoch 35 in logical epoch 35
[2023-06-26 22:45:06] [data] Shuffling data
[2023-06-26 22:45:06] [data] Done reading 20,192 sentences
[2023-06-26 22:45:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:45:47] Seen 16,611 samples
[2023-06-26 22:45:47] Starting data epoch 36 in logical epoch 36
[2023-06-26 22:45:47] [data] Shuffling data
[2023-06-26 22:45:47] [data] Done reading 20,192 sentences
[2023-06-26 22:45:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:46:28] Seen 16,611 samples
[2023-06-26 22:46:28] Starting data epoch 37 in logical epoch 37
[2023-06-26 22:46:28] [data] Shuffling data
[2023-06-26 22:46:28] [data] Done reading 20,192 sentences
[2023-06-26 22:46:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:47:08] Seen 16,611 samples
[2023-06-26 22:47:08] Starting data epoch 38 in logical epoch 38
[2023-06-26 22:47:08] [data] Shuffling data
[2023-06-26 22:47:08] [data] Done reading 20,192 sentences
[2023-06-26 22:47:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:47:49] Seen 16,611 samples
[2023-06-26 22:47:49] Starting data epoch 39 in logical epoch 39
[2023-06-26 22:47:49] [data] Shuffling data
[2023-06-26 22:47:49] [data] Done reading 20,192 sentences
[2023-06-26 22:47:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:48:20] Ep. 39 : Up. 4000 : Sen. 12,390 : Cost 2.92168641 * 3,781,080 @ 2,670 after 15,095,342 : Time 352.25s : 10734.04 words/s : gNorm 1.2180
[2023-06-26 22:48:29] Seen 16,611 samples
[2023-06-26 22:48:29] Starting data epoch 40 in logical epoch 40
[2023-06-26 22:48:29] [data] Shuffling data
[2023-06-26 22:48:29] [data] Done reading 20,192 sentences
[2023-06-26 22:48:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:49:10] Seen 16,611 samples
[2023-06-26 22:49:10] Starting data epoch 41 in logical epoch 41
[2023-06-26 22:49:10] Training finished
[2023-06-26 22:49:18] [valid] Ep. 41 : Up. 4128 : cross-entropy : 120.355 : new best
[2023-06-26 22:50:01] [valid] Ep. 41 : Up. 4128 : translation : 0 : new best
[2023-06-26 22:50:01] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:50:04] Saving Adam parameters
[2023-06-26 22:50:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:53:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:53:39] [marian] Running on node20.datos.cluster.uy as process 34364 with command line:
[2023-06-26 22:53:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 22:53:39] [config] after: 0e
[2023-06-26 22:53:39] [config] after-batches: 0
[2023-06-26 22:53:39] [config] after-epochs: 50
[2023-06-26 22:53:39] [config] all-caps-every: 0
[2023-06-26 22:53:39] [config] allow-unk: false
[2023-06-26 22:53:39] [config] authors: false
[2023-06-26 22:53:39] [config] beam-size: 6
[2023-06-26 22:53:39] [config] bert-class-symbol: "[CLS]"
[2023-06-26 22:53:39] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 22:53:39] [config] bert-masking-fraction: 0.15
[2023-06-26 22:53:39] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 22:53:39] [config] bert-train-type-embeddings: true
[2023-06-26 22:53:39] [config] bert-type-vocab-size: 2
[2023-06-26 22:53:39] [config] build-info: ""
[2023-06-26 22:53:39] [config] check-gradient-nan: false
[2023-06-26 22:53:39] [config] check-nan: false
[2023-06-26 22:53:39] [config] cite: false
[2023-06-26 22:53:39] [config] clip-norm: 1
[2023-06-26 22:53:39] [config] cost-scaling:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] cost-type: ce-sum
[2023-06-26 22:53:39] [config] cpu-threads: 0
[2023-06-26 22:53:39] [config] data-threads: 8
[2023-06-26 22:53:39] [config] data-weighting: ""
[2023-06-26 22:53:39] [config] data-weighting-type: sentence
[2023-06-26 22:53:39] [config] dec-cell: gru
[2023-06-26 22:53:39] [config] dec-cell-base-depth: 2
[2023-06-26 22:53:39] [config] dec-cell-high-depth: 1
[2023-06-26 22:53:39] [config] dec-depth: 1
[2023-06-26 22:53:39] [config] devices:
[2023-06-26 22:53:39] [config]   - 0
[2023-06-26 22:53:39] [config] dim-emb: 512
[2023-06-26 22:53:39] [config] dim-rnn: 1024
[2023-06-26 22:53:39] [config] dim-vocabs:
[2023-06-26 22:53:39] [config]   - 16384
[2023-06-26 22:53:39] [config]   - 16384
[2023-06-26 22:53:39] [config] disp-first: 0
[2023-06-26 22:53:39] [config] disp-freq: 1000u
[2023-06-26 22:53:39] [config] disp-label-counts: true
[2023-06-26 22:53:39] [config] dropout-rnn: 0.2
[2023-06-26 22:53:39] [config] dropout-src: 0.1
[2023-06-26 22:53:39] [config] dropout-trg: 0.1
[2023-06-26 22:53:39] [config] dump-config: ""
[2023-06-26 22:53:39] [config] dynamic-gradient-scaling:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] early-stopping: 10
[2023-06-26 22:53:39] [config] early-stopping-on: first
[2023-06-26 22:53:39] [config] embedding-fix-src: false
[2023-06-26 22:53:39] [config] embedding-fix-trg: false
[2023-06-26 22:53:39] [config] embedding-normalization: false
[2023-06-26 22:53:39] [config] embedding-vectors:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] enc-cell: gru
[2023-06-26 22:53:39] [config] enc-cell-depth: 1
[2023-06-26 22:53:39] [config] enc-depth: 1
[2023-06-26 22:53:39] [config] enc-type: bidirectional
[2023-06-26 22:53:39] [config] english-title-case-every: 0
[2023-06-26 22:53:39] [config] exponential-smoothing: 0
[2023-06-26 22:53:39] [config] factor-weight: 1
[2023-06-26 22:53:39] [config] factors-combine: sum
[2023-06-26 22:53:39] [config] factors-dim-emb: 0
[2023-06-26 22:53:39] [config] gradient-checkpointing: false
[2023-06-26 22:53:39] [config] gradient-norm-average-window: 100
[2023-06-26 22:53:39] [config] guided-alignment: none
[2023-06-26 22:53:39] [config] guided-alignment-cost: mse
[2023-06-26 22:53:39] [config] guided-alignment-weight: 0.1
[2023-06-26 22:53:39] [config] ignore-model-config: false
[2023-06-26 22:53:39] [config] input-types:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] interpolate-env-vars: false
[2023-06-26 22:53:39] [config] keep-best: false
[2023-06-26 22:53:39] [config] label-smoothing: 0
[2023-06-26 22:53:39] [config] layer-normalization: true
[2023-06-26 22:53:39] [config] learn-rate: 0.0001
[2023-06-26 22:53:39] [config] lemma-dependency: ""
[2023-06-26 22:53:39] [config] lemma-dim-emb: 0
[2023-06-26 22:53:39] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 22:53:39] [config] log-level: info
[2023-06-26 22:53:39] [config] log-time-zone: ""
[2023-06-26 22:53:39] [config] logical-epoch:
[2023-06-26 22:53:39] [config]   - 1e
[2023-06-26 22:53:39] [config]   - 0
[2023-06-26 22:53:39] [config] lr-decay: 0
[2023-06-26 22:53:39] [config] lr-decay-freq: 50000
[2023-06-26 22:53:39] [config] lr-decay-inv-sqrt:
[2023-06-26 22:53:39] [config]   - 0
[2023-06-26 22:53:39] [config] lr-decay-repeat-warmup: false
[2023-06-26 22:53:39] [config] lr-decay-reset-optimizer: false
[2023-06-26 22:53:39] [config] lr-decay-start:
[2023-06-26 22:53:39] [config]   - 10
[2023-06-26 22:53:39] [config]   - 1
[2023-06-26 22:53:39] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 22:53:39] [config] lr-report: false
[2023-06-26 22:53:39] [config] lr-warmup: 0
[2023-06-26 22:53:39] [config] lr-warmup-at-reload: false
[2023-06-26 22:53:39] [config] lr-warmup-cycle: false
[2023-06-26 22:53:39] [config] lr-warmup-start-rate: 0
[2023-06-26 22:53:39] [config] max-length: 50
[2023-06-26 22:53:39] [config] max-length-crop: false
[2023-06-26 22:53:39] [config] max-length-factor: 3
[2023-06-26 22:53:39] [config] maxi-batch: 100
[2023-06-26 22:53:39] [config] maxi-batch-sort: trg
[2023-06-26 22:53:39] [config] mini-batch: 64
[2023-06-26 22:53:39] [config] mini-batch-fit: true
[2023-06-26 22:53:39] [config] mini-batch-fit-step: 10
[2023-06-26 22:53:39] [config] mini-batch-round-up: true
[2023-06-26 22:53:39] [config] mini-batch-track-lr: false
[2023-06-26 22:53:39] [config] mini-batch-warmup: 0
[2023-06-26 22:53:39] [config] mini-batch-words: 0
[2023-06-26 22:53:39] [config] mini-batch-words-ref: 0
[2023-06-26 22:53:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:53:39] [config] multi-loss-type: sum
[2023-06-26 22:53:39] [config] n-best: false
[2023-06-26 22:53:39] [config] no-nccl: false
[2023-06-26 22:53:39] [config] no-reload: false
[2023-06-26 22:53:39] [config] no-restore-corpus: false
[2023-06-26 22:53:39] [config] normalize: 0.6
[2023-06-26 22:53:39] [config] normalize-gradient: false
[2023-06-26 22:53:39] [config] num-devices: 0
[2023-06-26 22:53:39] [config] optimizer: adam
[2023-06-26 22:53:39] [config] optimizer-delay: 1
[2023-06-26 22:53:39] [config] optimizer-params:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] output-omit-bias: false
[2023-06-26 22:53:39] [config] overwrite: false
[2023-06-26 22:53:39] [config] precision:
[2023-06-26 22:53:39] [config]   - float32
[2023-06-26 22:53:39] [config]   - float32
[2023-06-26 22:53:39] [config] pretrained-model: ""
[2023-06-26 22:53:39] [config] quantize-biases: false
[2023-06-26 22:53:39] [config] quantize-bits: 0
[2023-06-26 22:53:39] [config] quantize-log-based: false
[2023-06-26 22:53:39] [config] quantize-optimization-steps: 0
[2023-06-26 22:53:39] [config] quiet: false
[2023-06-26 22:53:39] [config] quiet-translation: true
[2023-06-26 22:53:39] [config] relative-paths: false
[2023-06-26 22:53:39] [config] right-left: false
[2023-06-26 22:53:39] [config] save-freq: 10000u
[2023-06-26 22:53:39] [config] seed: 1234
[2023-06-26 22:53:39] [config] sentencepiece-alphas:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] sentencepiece-max-lines: 2000000
[2023-06-26 22:53:39] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 22:53:39] [config] sharding: global
[2023-06-26 22:53:39] [config] shuffle: data
[2023-06-26 22:53:39] [config] shuffle-in-ram: false
[2023-06-26 22:53:39] [config] sigterm: save-and-exit
[2023-06-26 22:53:39] [config] skip: false
[2023-06-26 22:53:39] [config] sqlite: ""
[2023-06-26 22:53:39] [config] sqlite-drop: false
[2023-06-26 22:53:39] [config] sync-freq: 200u
[2023-06-26 22:53:39] [config] sync-sgd: false
[2023-06-26 22:53:39] [config] tempdir: /tmp
[2023-06-26 22:53:39] [config] tied-embeddings: false
[2023-06-26 22:53:39] [config] tied-embeddings-all: true
[2023-06-26 22:53:39] [config] tied-embeddings-src: false
[2023-06-26 22:53:39] [config] train-embedder-rank:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] train-sets:
[2023-06-26 22:53:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 22:53:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 22:53:39] [config] transformer-aan-activation: swish
[2023-06-26 22:53:39] [config] transformer-aan-depth: 2
[2023-06-26 22:53:39] [config] transformer-aan-nogate: false
[2023-06-26 22:53:39] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 22:53:39] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 22:53:39] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 22:53:39] [config] transformer-depth-scaling: false
[2023-06-26 22:53:39] [config] transformer-dim-aan: 2048
[2023-06-26 22:53:39] [config] transformer-dim-ffn: 2048
[2023-06-26 22:53:39] [config] transformer-dropout: 0
[2023-06-26 22:53:39] [config] transformer-dropout-attention: 0
[2023-06-26 22:53:39] [config] transformer-dropout-ffn: 0
[2023-06-26 22:53:39] [config] transformer-ffn-activation: swish
[2023-06-26 22:53:39] [config] transformer-ffn-depth: 2
[2023-06-26 22:53:39] [config] transformer-guided-alignment-layer: last
[2023-06-26 22:53:39] [config] transformer-heads: 8
[2023-06-26 22:53:39] [config] transformer-no-projection: false
[2023-06-26 22:53:39] [config] transformer-pool: false
[2023-06-26 22:53:39] [config] transformer-postprocess: dan
[2023-06-26 22:53:39] [config] transformer-postprocess-emb: d
[2023-06-26 22:53:39] [config] transformer-postprocess-top: ""
[2023-06-26 22:53:39] [config] transformer-preprocess: ""
[2023-06-26 22:53:39] [config] transformer-tied-layers:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] transformer-train-position-embeddings: false
[2023-06-26 22:53:39] [config] tsv: false
[2023-06-26 22:53:39] [config] tsv-fields: 0
[2023-06-26 22:53:39] [config] type: amun
[2023-06-26 22:53:39] [config] ulr: false
[2023-06-26 22:53:39] [config] ulr-dim-emb: 0
[2023-06-26 22:53:39] [config] ulr-dropout: 0
[2023-06-26 22:53:39] [config] ulr-keys-vectors: ""
[2023-06-26 22:53:39] [config] ulr-query-vectors: ""
[2023-06-26 22:53:39] [config] ulr-softmax-temperature: 1
[2023-06-26 22:53:39] [config] ulr-trainable-transformation: false
[2023-06-26 22:53:39] [config] unlikelihood-loss: false
[2023-06-26 22:53:39] [config] valid-freq: 5000000
[2023-06-26 22:53:39] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 22:53:39] [config] valid-max-length: 1000
[2023-06-26 22:53:39] [config] valid-metrics:
[2023-06-26 22:53:39] [config]   - cross-entropy
[2023-06-26 22:53:39] [config]   - translation
[2023-06-26 22:53:39] [config] valid-mini-batch: 32
[2023-06-26 22:53:39] [config] valid-reset-stalled: false
[2023-06-26 22:53:39] [config] valid-script-args:
[2023-06-26 22:53:39] [config]   []
[2023-06-26 22:53:39] [config] valid-script-path: ""
[2023-06-26 22:53:39] [config] valid-sets:
[2023-06-26 22:53:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 22:53:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 22:53:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 22:53:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:53:39] [config] vocabs:
[2023-06-26 22:53:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:53:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:53:39] [config] word-penalty: 0
[2023-06-26 22:53:39] [config] word-scores: false
[2023-06-26 22:53:39] [config] workspace: 3000
[2023-06-26 22:53:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 22:53:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:53:39] [training] Using single-device training
[2023-06-26 22:53:40] Synced seed 1234
[2023-06-26 22:53:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 22:53:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 22:53:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 22:53:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 22:53:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 22:53:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:53:40] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:53:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:53:40] [comm] Using global sharding
[2023-06-26 22:53:40] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:53:40] [training] Using 1 GPUs
[2023-06-26 22:53:40] [logits] Applying loss function for 1 factor(s)
[2023-06-26 22:53:40] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:53:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 22:53:41] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:53:53] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 22:53:53] [valid] No post-processing script given for validating translator
[2023-06-26 22:53:53] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 22:53:53] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 22:53:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 22:53:53] [comm] Using global sharding
[2023-06-26 22:53:53] [comm] NCCLCommunicators constructed successfully
[2023-06-26 22:53:53] [training] Using 1 GPUs
[2023-06-26 22:53:53] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 22:53:54] Loading Adam parameters
[2023-06-26 22:53:54] [memory] Reserving 322 MB, device gpu0
[2023-06-26 22:53:54] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:53:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 22:53:54] [data] Restoring the corpus state to epoch 41, batch 4128
[2023-06-26 22:53:54] [data] Shuffling data
[2023-06-26 22:53:55] [data] Done reading 20,192 sentences
[2023-06-26 22:53:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:53:55] Training started
[2023-06-26 22:53:55] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 22:53:55] [memory] Reserving 161 MB, device gpu0
[2023-06-26 22:53:55] Parameter type float32, optimization type float32, casting types false
[2023-06-26 22:54:32] Seen 16,611 samples
[2023-06-26 22:54:32] Starting data epoch 42 in logical epoch 42
[2023-06-26 22:54:32] [data] Shuffling data
[2023-06-26 22:54:32] [data] Done reading 20,192 sentences
[2023-06-26 22:54:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:55:12] Seen 16,611 samples
[2023-06-26 22:55:12] Starting data epoch 43 in logical epoch 43
[2023-06-26 22:55:12] [data] Shuffling data
[2023-06-26 22:55:12] [data] Done reading 20,192 sentences
[2023-06-26 22:55:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:55:52] Seen 16,611 samples
[2023-06-26 22:55:52] Starting data epoch 44 in logical epoch 44
[2023-06-26 22:55:52] [data] Shuffling data
[2023-06-26 22:55:52] [data] Done reading 20,192 sentences
[2023-06-26 22:55:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:56:32] Seen 16,611 samples
[2023-06-26 22:56:32] Starting data epoch 45 in logical epoch 45
[2023-06-26 22:56:32] [data] Shuffling data
[2023-06-26 22:56:32] [data] Done reading 20,192 sentences
[2023-06-26 22:56:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:57:13] Seen 16,611 samples
[2023-06-26 22:57:13] Starting data epoch 46 in logical epoch 46
[2023-06-26 22:57:13] [data] Shuffling data
[2023-06-26 22:57:13] [data] Done reading 20,192 sentences
[2023-06-26 22:57:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:57:54] Seen 16,611 samples
[2023-06-26 22:57:54] Starting data epoch 47 in logical epoch 47
[2023-06-26 22:57:54] [data] Shuffling data
[2023-06-26 22:57:54] [data] Done reading 20,192 sentences
[2023-06-26 22:57:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:58:35] Seen 16,611 samples
[2023-06-26 22:58:35] Starting data epoch 48 in logical epoch 48
[2023-06-26 22:58:35] [data] Shuffling data
[2023-06-26 22:58:35] [data] Done reading 20,192 sentences
[2023-06-26 22:58:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:59:15] Seen 16,611 samples
[2023-06-26 22:59:15] Starting data epoch 49 in logical epoch 49
[2023-06-26 22:59:15] [data] Shuffling data
[2023-06-26 22:59:16] [data] Done reading 20,192 sentences
[2023-06-26 22:59:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 22:59:35] Ep. 49 : Up. 5000 : Sen. 8,029 : Cost 2.44395876 * 3,779,862 @ 4,345 after 18,875,204 : Time 341.72s : 11061.23 words/s : gNorm 1.4464
[2023-06-26 22:59:56] Seen 16,611 samples
[2023-06-26 22:59:56] Starting data epoch 50 in logical epoch 50
[2023-06-26 22:59:56] [data] Shuffling data
[2023-06-26 22:59:56] [data] Done reading 20,192 sentences
[2023-06-26 22:59:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:00:37] Seen 16,611 samples
[2023-06-26 23:00:37] Starting data epoch 51 in logical epoch 51
[2023-06-26 23:00:37] Training finished
[2023-06-26 23:00:45] [valid] Ep. 51 : Up. 5157 : cross-entropy : 118.987 : new best
[2023-06-26 23:01:26] [valid] Ep. 51 : Up. 5157 : translation : 0 : new best
[2023-06-26 23:01:26] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:01:28] Saving Adam parameters
[2023-06-26 23:01:28] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:04:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:04:57] [marian] Running on node20.datos.cluster.uy as process 35228 with command line:
[2023-06-26 23:04:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 23:04:57] [config] after: 0e
[2023-06-26 23:04:57] [config] after-batches: 0
[2023-06-26 23:04:57] [config] after-epochs: 60
[2023-06-26 23:04:57] [config] all-caps-every: 0
[2023-06-26 23:04:57] [config] allow-unk: false
[2023-06-26 23:04:57] [config] authors: false
[2023-06-26 23:04:57] [config] beam-size: 6
[2023-06-26 23:04:57] [config] bert-class-symbol: "[CLS]"
[2023-06-26 23:04:57] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 23:04:57] [config] bert-masking-fraction: 0.15
[2023-06-26 23:04:57] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 23:04:57] [config] bert-train-type-embeddings: true
[2023-06-26 23:04:57] [config] bert-type-vocab-size: 2
[2023-06-26 23:04:57] [config] build-info: ""
[2023-06-26 23:04:57] [config] check-gradient-nan: false
[2023-06-26 23:04:57] [config] check-nan: false
[2023-06-26 23:04:57] [config] cite: false
[2023-06-26 23:04:57] [config] clip-norm: 1
[2023-06-26 23:04:57] [config] cost-scaling:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] cost-type: ce-sum
[2023-06-26 23:04:57] [config] cpu-threads: 0
[2023-06-26 23:04:57] [config] data-threads: 8
[2023-06-26 23:04:57] [config] data-weighting: ""
[2023-06-26 23:04:57] [config] data-weighting-type: sentence
[2023-06-26 23:04:57] [config] dec-cell: gru
[2023-06-26 23:04:57] [config] dec-cell-base-depth: 2
[2023-06-26 23:04:57] [config] dec-cell-high-depth: 1
[2023-06-26 23:04:57] [config] dec-depth: 1
[2023-06-26 23:04:57] [config] devices:
[2023-06-26 23:04:57] [config]   - 0
[2023-06-26 23:04:57] [config] dim-emb: 512
[2023-06-26 23:04:57] [config] dim-rnn: 1024
[2023-06-26 23:04:57] [config] dim-vocabs:
[2023-06-26 23:04:57] [config]   - 16384
[2023-06-26 23:04:57] [config]   - 16384
[2023-06-26 23:04:57] [config] disp-first: 0
[2023-06-26 23:04:57] [config] disp-freq: 1000u
[2023-06-26 23:04:57] [config] disp-label-counts: true
[2023-06-26 23:04:57] [config] dropout-rnn: 0.2
[2023-06-26 23:04:57] [config] dropout-src: 0.1
[2023-06-26 23:04:57] [config] dropout-trg: 0.1
[2023-06-26 23:04:57] [config] dump-config: ""
[2023-06-26 23:04:57] [config] dynamic-gradient-scaling:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] early-stopping: 10
[2023-06-26 23:04:57] [config] early-stopping-on: first
[2023-06-26 23:04:57] [config] embedding-fix-src: false
[2023-06-26 23:04:57] [config] embedding-fix-trg: false
[2023-06-26 23:04:57] [config] embedding-normalization: false
[2023-06-26 23:04:57] [config] embedding-vectors:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] enc-cell: gru
[2023-06-26 23:04:57] [config] enc-cell-depth: 1
[2023-06-26 23:04:57] [config] enc-depth: 1
[2023-06-26 23:04:57] [config] enc-type: bidirectional
[2023-06-26 23:04:57] [config] english-title-case-every: 0
[2023-06-26 23:04:57] [config] exponential-smoothing: 0
[2023-06-26 23:04:57] [config] factor-weight: 1
[2023-06-26 23:04:57] [config] factors-combine: sum
[2023-06-26 23:04:57] [config] factors-dim-emb: 0
[2023-06-26 23:04:57] [config] gradient-checkpointing: false
[2023-06-26 23:04:57] [config] gradient-norm-average-window: 100
[2023-06-26 23:04:57] [config] guided-alignment: none
[2023-06-26 23:04:57] [config] guided-alignment-cost: mse
[2023-06-26 23:04:57] [config] guided-alignment-weight: 0.1
[2023-06-26 23:04:57] [config] ignore-model-config: false
[2023-06-26 23:04:57] [config] input-types:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] interpolate-env-vars: false
[2023-06-26 23:04:57] [config] keep-best: false
[2023-06-26 23:04:57] [config] label-smoothing: 0
[2023-06-26 23:04:57] [config] layer-normalization: true
[2023-06-26 23:04:57] [config] learn-rate: 0.0001
[2023-06-26 23:04:57] [config] lemma-dependency: ""
[2023-06-26 23:04:57] [config] lemma-dim-emb: 0
[2023-06-26 23:04:57] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 23:04:57] [config] log-level: info
[2023-06-26 23:04:57] [config] log-time-zone: ""
[2023-06-26 23:04:57] [config] logical-epoch:
[2023-06-26 23:04:57] [config]   - 1e
[2023-06-26 23:04:57] [config]   - 0
[2023-06-26 23:04:57] [config] lr-decay: 0
[2023-06-26 23:04:57] [config] lr-decay-freq: 50000
[2023-06-26 23:04:57] [config] lr-decay-inv-sqrt:
[2023-06-26 23:04:57] [config]   - 0
[2023-06-26 23:04:57] [config] lr-decay-repeat-warmup: false
[2023-06-26 23:04:57] [config] lr-decay-reset-optimizer: false
[2023-06-26 23:04:57] [config] lr-decay-start:
[2023-06-26 23:04:57] [config]   - 10
[2023-06-26 23:04:57] [config]   - 1
[2023-06-26 23:04:57] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 23:04:57] [config] lr-report: false
[2023-06-26 23:04:57] [config] lr-warmup: 0
[2023-06-26 23:04:57] [config] lr-warmup-at-reload: false
[2023-06-26 23:04:57] [config] lr-warmup-cycle: false
[2023-06-26 23:04:57] [config] lr-warmup-start-rate: 0
[2023-06-26 23:04:57] [config] max-length: 50
[2023-06-26 23:04:57] [config] max-length-crop: false
[2023-06-26 23:04:57] [config] max-length-factor: 3
[2023-06-26 23:04:57] [config] maxi-batch: 100
[2023-06-26 23:04:57] [config] maxi-batch-sort: trg
[2023-06-26 23:04:57] [config] mini-batch: 64
[2023-06-26 23:04:57] [config] mini-batch-fit: true
[2023-06-26 23:04:57] [config] mini-batch-fit-step: 10
[2023-06-26 23:04:57] [config] mini-batch-round-up: true
[2023-06-26 23:04:57] [config] mini-batch-track-lr: false
[2023-06-26 23:04:57] [config] mini-batch-warmup: 0
[2023-06-26 23:04:57] [config] mini-batch-words: 0
[2023-06-26 23:04:57] [config] mini-batch-words-ref: 0
[2023-06-26 23:04:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:04:57] [config] multi-loss-type: sum
[2023-06-26 23:04:57] [config] n-best: false
[2023-06-26 23:04:57] [config] no-nccl: false
[2023-06-26 23:04:57] [config] no-reload: false
[2023-06-26 23:04:57] [config] no-restore-corpus: false
[2023-06-26 23:04:57] [config] normalize: 0.6
[2023-06-26 23:04:57] [config] normalize-gradient: false
[2023-06-26 23:04:57] [config] num-devices: 0
[2023-06-26 23:04:57] [config] optimizer: adam
[2023-06-26 23:04:57] [config] optimizer-delay: 1
[2023-06-26 23:04:57] [config] optimizer-params:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] output-omit-bias: false
[2023-06-26 23:04:57] [config] overwrite: false
[2023-06-26 23:04:57] [config] precision:
[2023-06-26 23:04:57] [config]   - float32
[2023-06-26 23:04:57] [config]   - float32
[2023-06-26 23:04:57] [config] pretrained-model: ""
[2023-06-26 23:04:57] [config] quantize-biases: false
[2023-06-26 23:04:57] [config] quantize-bits: 0
[2023-06-26 23:04:57] [config] quantize-log-based: false
[2023-06-26 23:04:57] [config] quantize-optimization-steps: 0
[2023-06-26 23:04:57] [config] quiet: false
[2023-06-26 23:04:57] [config] quiet-translation: true
[2023-06-26 23:04:57] [config] relative-paths: false
[2023-06-26 23:04:57] [config] right-left: false
[2023-06-26 23:04:57] [config] save-freq: 10000u
[2023-06-26 23:04:57] [config] seed: 1234
[2023-06-26 23:04:57] [config] sentencepiece-alphas:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] sentencepiece-max-lines: 2000000
[2023-06-26 23:04:57] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 23:04:57] [config] sharding: global
[2023-06-26 23:04:57] [config] shuffle: data
[2023-06-26 23:04:57] [config] shuffle-in-ram: false
[2023-06-26 23:04:57] [config] sigterm: save-and-exit
[2023-06-26 23:04:57] [config] skip: false
[2023-06-26 23:04:57] [config] sqlite: ""
[2023-06-26 23:04:57] [config] sqlite-drop: false
[2023-06-26 23:04:57] [config] sync-freq: 200u
[2023-06-26 23:04:57] [config] sync-sgd: false
[2023-06-26 23:04:57] [config] tempdir: /tmp
[2023-06-26 23:04:57] [config] tied-embeddings: false
[2023-06-26 23:04:57] [config] tied-embeddings-all: true
[2023-06-26 23:04:57] [config] tied-embeddings-src: false
[2023-06-26 23:04:57] [config] train-embedder-rank:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] train-sets:
[2023-06-26 23:04:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 23:04:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 23:04:57] [config] transformer-aan-activation: swish
[2023-06-26 23:04:57] [config] transformer-aan-depth: 2
[2023-06-26 23:04:57] [config] transformer-aan-nogate: false
[2023-06-26 23:04:57] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 23:04:57] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 23:04:57] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 23:04:57] [config] transformer-depth-scaling: false
[2023-06-26 23:04:57] [config] transformer-dim-aan: 2048
[2023-06-26 23:04:57] [config] transformer-dim-ffn: 2048
[2023-06-26 23:04:57] [config] transformer-dropout: 0
[2023-06-26 23:04:57] [config] transformer-dropout-attention: 0
[2023-06-26 23:04:57] [config] transformer-dropout-ffn: 0
[2023-06-26 23:04:57] [config] transformer-ffn-activation: swish
[2023-06-26 23:04:57] [config] transformer-ffn-depth: 2
[2023-06-26 23:04:57] [config] transformer-guided-alignment-layer: last
[2023-06-26 23:04:57] [config] transformer-heads: 8
[2023-06-26 23:04:57] [config] transformer-no-projection: false
[2023-06-26 23:04:57] [config] transformer-pool: false
[2023-06-26 23:04:57] [config] transformer-postprocess: dan
[2023-06-26 23:04:57] [config] transformer-postprocess-emb: d
[2023-06-26 23:04:57] [config] transformer-postprocess-top: ""
[2023-06-26 23:04:57] [config] transformer-preprocess: ""
[2023-06-26 23:04:57] [config] transformer-tied-layers:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] transformer-train-position-embeddings: false
[2023-06-26 23:04:57] [config] tsv: false
[2023-06-26 23:04:57] [config] tsv-fields: 0
[2023-06-26 23:04:57] [config] type: amun
[2023-06-26 23:04:57] [config] ulr: false
[2023-06-26 23:04:57] [config] ulr-dim-emb: 0
[2023-06-26 23:04:57] [config] ulr-dropout: 0
[2023-06-26 23:04:57] [config] ulr-keys-vectors: ""
[2023-06-26 23:04:57] [config] ulr-query-vectors: ""
[2023-06-26 23:04:57] [config] ulr-softmax-temperature: 1
[2023-06-26 23:04:57] [config] ulr-trainable-transformation: false
[2023-06-26 23:04:57] [config] unlikelihood-loss: false
[2023-06-26 23:04:57] [config] valid-freq: 5000000
[2023-06-26 23:04:57] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 23:04:57] [config] valid-max-length: 1000
[2023-06-26 23:04:57] [config] valid-metrics:
[2023-06-26 23:04:57] [config]   - cross-entropy
[2023-06-26 23:04:57] [config]   - translation
[2023-06-26 23:04:57] [config] valid-mini-batch: 32
[2023-06-26 23:04:57] [config] valid-reset-stalled: false
[2023-06-26 23:04:57] [config] valid-script-args:
[2023-06-26 23:04:57] [config]   []
[2023-06-26 23:04:57] [config] valid-script-path: ""
[2023-06-26 23:04:57] [config] valid-sets:
[2023-06-26 23:04:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 23:04:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 23:04:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 23:04:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:04:57] [config] vocabs:
[2023-06-26 23:04:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:04:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:04:57] [config] word-penalty: 0
[2023-06-26 23:04:57] [config] word-scores: false
[2023-06-26 23:04:57] [config] workspace: 3000
[2023-06-26 23:04:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:04:57] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:04:57] [training] Using single-device training
[2023-06-26 23:04:58] Synced seed 1234
[2023-06-26 23:04:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:04:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 23:04:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:04:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 23:04:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 23:04:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:04:58] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:04:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:04:58] [comm] Using global sharding
[2023-06-26 23:04:59] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:04:59] [training] Using 1 GPUs
[2023-06-26 23:04:59] [logits] Applying loss function for 1 factor(s)
[2023-06-26 23:04:59] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:04:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 23:04:59] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:05:11] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 23:05:11] [valid] No post-processing script given for validating translator
[2023-06-26 23:05:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:05:11] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:05:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:05:11] [comm] Using global sharding
[2023-06-26 23:05:11] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:05:11] [training] Using 1 GPUs
[2023-06-26 23:05:11] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:05:12] Loading Adam parameters
[2023-06-26 23:05:13] [memory] Reserving 322 MB, device gpu0
[2023-06-26 23:05:13] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:05:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:05:13] [data] Restoring the corpus state to epoch 51, batch 5157
[2023-06-26 23:05:13] [data] Shuffling data
[2023-06-26 23:05:13] [data] Done reading 20,192 sentences
[2023-06-26 23:05:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:05:13] Training started
[2023-06-26 23:05:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 23:05:13] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:05:13] Parameter type float32, optimization type float32, casting types false
[2023-06-26 23:05:50] Seen 16,611 samples
[2023-06-26 23:05:50] Starting data epoch 52 in logical epoch 52
[2023-06-26 23:05:50] [data] Shuffling data
[2023-06-26 23:05:50] [data] Done reading 20,192 sentences
[2023-06-26 23:05:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:06:30] Seen 16,611 samples
[2023-06-26 23:06:30] Starting data epoch 53 in logical epoch 53
[2023-06-26 23:06:30] [data] Shuffling data
[2023-06-26 23:06:30] [data] Done reading 20,192 sentences
[2023-06-26 23:06:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:07:11] Seen 16,611 samples
[2023-06-26 23:07:11] Starting data epoch 54 in logical epoch 54
[2023-06-26 23:07:11] [data] Shuffling data
[2023-06-26 23:07:11] [data] Done reading 20,192 sentences
[2023-06-26 23:07:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:07:51] Seen 16,611 samples
[2023-06-26 23:07:51] Starting data epoch 55 in logical epoch 55
[2023-06-26 23:07:51] [data] Shuffling data
[2023-06-26 23:07:51] [data] Done reading 20,192 sentences
[2023-06-26 23:07:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:08:31] Seen 16,611 samples
[2023-06-26 23:08:31] Starting data epoch 56 in logical epoch 56
[2023-06-26 23:08:31] [data] Shuffling data
[2023-06-26 23:08:31] [data] Done reading 20,192 sentences
[2023-06-26 23:08:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:09:12] Seen 16,611 samples
[2023-06-26 23:09:12] Starting data epoch 57 in logical epoch 57
[2023-06-26 23:09:12] [data] Shuffling data
[2023-06-26 23:09:12] [data] Done reading 20,192 sentences
[2023-06-26 23:09:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:09:53] Seen 16,611 samples
[2023-06-26 23:09:53] Starting data epoch 58 in logical epoch 58
[2023-06-26 23:09:53] [data] Shuffling data
[2023-06-26 23:09:53] [data] Done reading 20,192 sentences
[2023-06-26 23:09:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:10:34] Seen 16,611 samples
[2023-06-26 23:10:34] Starting data epoch 59 in logical epoch 59
[2023-06-26 23:10:34] [data] Shuffling data
[2023-06-26 23:10:34] [data] Done reading 20,192 sentences
[2023-06-26 23:10:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:10:41] Ep. 59 : Up. 6000 : Sen. 2,697 : Cost 2.06612468 * 3,775,325 @ 4,695 after 22,650,529 : Time 329.64s : 11452.80 words/s : gNorm 1.2315
[2023-06-26 23:11:14] Seen 16,611 samples
[2023-06-26 23:11:14] Starting data epoch 60 in logical epoch 60
[2023-06-26 23:11:14] [data] Shuffling data
[2023-06-26 23:11:14] [data] Done reading 20,192 sentences
[2023-06-26 23:11:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:11:54] Seen 16,611 samples
[2023-06-26 23:11:54] Starting data epoch 61 in logical epoch 61
[2023-06-26 23:11:54] Training finished
[2023-06-26 23:12:03] [valid] Ep. 61 : Up. 6188 : cross-entropy : 119.579 : stalled 1 times (last best: 118.987)
[2023-06-26 23:12:38] [valid] Ep. 61 : Up. 6188 : translation : 0 : new best
[2023-06-26 23:12:38] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:12:42] Saving Adam parameters
[2023-06-26 23:12:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:15:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:15:53] [marian] Running on node20.datos.cluster.uy as process 36212 with command line:
[2023-06-26 23:15:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 23:15:53] [config] after: 0e
[2023-06-26 23:15:53] [config] after-batches: 0
[2023-06-26 23:15:53] [config] after-epochs: 70
[2023-06-26 23:15:53] [config] all-caps-every: 0
[2023-06-26 23:15:53] [config] allow-unk: false
[2023-06-26 23:15:53] [config] authors: false
[2023-06-26 23:15:53] [config] beam-size: 6
[2023-06-26 23:15:53] [config] bert-class-symbol: "[CLS]"
[2023-06-26 23:15:53] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 23:15:53] [config] bert-masking-fraction: 0.15
[2023-06-26 23:15:53] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 23:15:53] [config] bert-train-type-embeddings: true
[2023-06-26 23:15:53] [config] bert-type-vocab-size: 2
[2023-06-26 23:15:53] [config] build-info: ""
[2023-06-26 23:15:53] [config] check-gradient-nan: false
[2023-06-26 23:15:53] [config] check-nan: false
[2023-06-26 23:15:53] [config] cite: false
[2023-06-26 23:15:53] [config] clip-norm: 1
[2023-06-26 23:15:53] [config] cost-scaling:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] cost-type: ce-sum
[2023-06-26 23:15:53] [config] cpu-threads: 0
[2023-06-26 23:15:53] [config] data-threads: 8
[2023-06-26 23:15:53] [config] data-weighting: ""
[2023-06-26 23:15:53] [config] data-weighting-type: sentence
[2023-06-26 23:15:53] [config] dec-cell: gru
[2023-06-26 23:15:53] [config] dec-cell-base-depth: 2
[2023-06-26 23:15:53] [config] dec-cell-high-depth: 1
[2023-06-26 23:15:53] [config] dec-depth: 1
[2023-06-26 23:15:53] [config] devices:
[2023-06-26 23:15:53] [config]   - 0
[2023-06-26 23:15:53] [config] dim-emb: 512
[2023-06-26 23:15:53] [config] dim-rnn: 1024
[2023-06-26 23:15:53] [config] dim-vocabs:
[2023-06-26 23:15:53] [config]   - 16384
[2023-06-26 23:15:53] [config]   - 16384
[2023-06-26 23:15:53] [config] disp-first: 0
[2023-06-26 23:15:53] [config] disp-freq: 1000u
[2023-06-26 23:15:53] [config] disp-label-counts: true
[2023-06-26 23:15:53] [config] dropout-rnn: 0.2
[2023-06-26 23:15:53] [config] dropout-src: 0.1
[2023-06-26 23:15:53] [config] dropout-trg: 0.1
[2023-06-26 23:15:53] [config] dump-config: ""
[2023-06-26 23:15:53] [config] dynamic-gradient-scaling:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] early-stopping: 10
[2023-06-26 23:15:53] [config] early-stopping-on: first
[2023-06-26 23:15:53] [config] embedding-fix-src: false
[2023-06-26 23:15:53] [config] embedding-fix-trg: false
[2023-06-26 23:15:53] [config] embedding-normalization: false
[2023-06-26 23:15:53] [config] embedding-vectors:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] enc-cell: gru
[2023-06-26 23:15:53] [config] enc-cell-depth: 1
[2023-06-26 23:15:53] [config] enc-depth: 1
[2023-06-26 23:15:53] [config] enc-type: bidirectional
[2023-06-26 23:15:53] [config] english-title-case-every: 0
[2023-06-26 23:15:53] [config] exponential-smoothing: 0
[2023-06-26 23:15:53] [config] factor-weight: 1
[2023-06-26 23:15:53] [config] factors-combine: sum
[2023-06-26 23:15:53] [config] factors-dim-emb: 0
[2023-06-26 23:15:53] [config] gradient-checkpointing: false
[2023-06-26 23:15:53] [config] gradient-norm-average-window: 100
[2023-06-26 23:15:53] [config] guided-alignment: none
[2023-06-26 23:15:53] [config] guided-alignment-cost: mse
[2023-06-26 23:15:53] [config] guided-alignment-weight: 0.1
[2023-06-26 23:15:53] [config] ignore-model-config: false
[2023-06-26 23:15:53] [config] input-types:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] interpolate-env-vars: false
[2023-06-26 23:15:53] [config] keep-best: false
[2023-06-26 23:15:53] [config] label-smoothing: 0
[2023-06-26 23:15:53] [config] layer-normalization: true
[2023-06-26 23:15:53] [config] learn-rate: 0.0001
[2023-06-26 23:15:53] [config] lemma-dependency: ""
[2023-06-26 23:15:53] [config] lemma-dim-emb: 0
[2023-06-26 23:15:53] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 23:15:53] [config] log-level: info
[2023-06-26 23:15:53] [config] log-time-zone: ""
[2023-06-26 23:15:53] [config] logical-epoch:
[2023-06-26 23:15:53] [config]   - 1e
[2023-06-26 23:15:53] [config]   - 0
[2023-06-26 23:15:53] [config] lr-decay: 0
[2023-06-26 23:15:53] [config] lr-decay-freq: 50000
[2023-06-26 23:15:53] [config] lr-decay-inv-sqrt:
[2023-06-26 23:15:53] [config]   - 0
[2023-06-26 23:15:53] [config] lr-decay-repeat-warmup: false
[2023-06-26 23:15:53] [config] lr-decay-reset-optimizer: false
[2023-06-26 23:15:53] [config] lr-decay-start:
[2023-06-26 23:15:53] [config]   - 10
[2023-06-26 23:15:53] [config]   - 1
[2023-06-26 23:15:53] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 23:15:53] [config] lr-report: false
[2023-06-26 23:15:53] [config] lr-warmup: 0
[2023-06-26 23:15:53] [config] lr-warmup-at-reload: false
[2023-06-26 23:15:53] [config] lr-warmup-cycle: false
[2023-06-26 23:15:53] [config] lr-warmup-start-rate: 0
[2023-06-26 23:15:53] [config] max-length: 50
[2023-06-26 23:15:53] [config] max-length-crop: false
[2023-06-26 23:15:53] [config] max-length-factor: 3
[2023-06-26 23:15:53] [config] maxi-batch: 100
[2023-06-26 23:15:53] [config] maxi-batch-sort: trg
[2023-06-26 23:15:53] [config] mini-batch: 64
[2023-06-26 23:15:53] [config] mini-batch-fit: true
[2023-06-26 23:15:53] [config] mini-batch-fit-step: 10
[2023-06-26 23:15:53] [config] mini-batch-round-up: true
[2023-06-26 23:15:53] [config] mini-batch-track-lr: false
[2023-06-26 23:15:53] [config] mini-batch-warmup: 0
[2023-06-26 23:15:53] [config] mini-batch-words: 0
[2023-06-26 23:15:53] [config] mini-batch-words-ref: 0
[2023-06-26 23:15:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:15:53] [config] multi-loss-type: sum
[2023-06-26 23:15:53] [config] n-best: false
[2023-06-26 23:15:53] [config] no-nccl: false
[2023-06-26 23:15:53] [config] no-reload: false
[2023-06-26 23:15:53] [config] no-restore-corpus: false
[2023-06-26 23:15:53] [config] normalize: 0.6
[2023-06-26 23:15:53] [config] normalize-gradient: false
[2023-06-26 23:15:53] [config] num-devices: 0
[2023-06-26 23:15:53] [config] optimizer: adam
[2023-06-26 23:15:53] [config] optimizer-delay: 1
[2023-06-26 23:15:53] [config] optimizer-params:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] output-omit-bias: false
[2023-06-26 23:15:53] [config] overwrite: false
[2023-06-26 23:15:53] [config] precision:
[2023-06-26 23:15:53] [config]   - float32
[2023-06-26 23:15:53] [config]   - float32
[2023-06-26 23:15:53] [config] pretrained-model: ""
[2023-06-26 23:15:53] [config] quantize-biases: false
[2023-06-26 23:15:53] [config] quantize-bits: 0
[2023-06-26 23:15:53] [config] quantize-log-based: false
[2023-06-26 23:15:53] [config] quantize-optimization-steps: 0
[2023-06-26 23:15:53] [config] quiet: false
[2023-06-26 23:15:53] [config] quiet-translation: true
[2023-06-26 23:15:53] [config] relative-paths: false
[2023-06-26 23:15:53] [config] right-left: false
[2023-06-26 23:15:53] [config] save-freq: 10000u
[2023-06-26 23:15:53] [config] seed: 1234
[2023-06-26 23:15:53] [config] sentencepiece-alphas:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] sentencepiece-max-lines: 2000000
[2023-06-26 23:15:53] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 23:15:53] [config] sharding: global
[2023-06-26 23:15:53] [config] shuffle: data
[2023-06-26 23:15:53] [config] shuffle-in-ram: false
[2023-06-26 23:15:53] [config] sigterm: save-and-exit
[2023-06-26 23:15:53] [config] skip: false
[2023-06-26 23:15:53] [config] sqlite: ""
[2023-06-26 23:15:53] [config] sqlite-drop: false
[2023-06-26 23:15:53] [config] sync-freq: 200u
[2023-06-26 23:15:53] [config] sync-sgd: false
[2023-06-26 23:15:53] [config] tempdir: /tmp
[2023-06-26 23:15:53] [config] tied-embeddings: false
[2023-06-26 23:15:53] [config] tied-embeddings-all: true
[2023-06-26 23:15:53] [config] tied-embeddings-src: false
[2023-06-26 23:15:53] [config] train-embedder-rank:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] train-sets:
[2023-06-26 23:15:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 23:15:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 23:15:53] [config] transformer-aan-activation: swish
[2023-06-26 23:15:53] [config] transformer-aan-depth: 2
[2023-06-26 23:15:53] [config] transformer-aan-nogate: false
[2023-06-26 23:15:53] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 23:15:53] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 23:15:53] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 23:15:53] [config] transformer-depth-scaling: false
[2023-06-26 23:15:53] [config] transformer-dim-aan: 2048
[2023-06-26 23:15:53] [config] transformer-dim-ffn: 2048
[2023-06-26 23:15:53] [config] transformer-dropout: 0
[2023-06-26 23:15:53] [config] transformer-dropout-attention: 0
[2023-06-26 23:15:53] [config] transformer-dropout-ffn: 0
[2023-06-26 23:15:53] [config] transformer-ffn-activation: swish
[2023-06-26 23:15:53] [config] transformer-ffn-depth: 2
[2023-06-26 23:15:53] [config] transformer-guided-alignment-layer: last
[2023-06-26 23:15:53] [config] transformer-heads: 8
[2023-06-26 23:15:53] [config] transformer-no-projection: false
[2023-06-26 23:15:53] [config] transformer-pool: false
[2023-06-26 23:15:53] [config] transformer-postprocess: dan
[2023-06-26 23:15:53] [config] transformer-postprocess-emb: d
[2023-06-26 23:15:53] [config] transformer-postprocess-top: ""
[2023-06-26 23:15:53] [config] transformer-preprocess: ""
[2023-06-26 23:15:53] [config] transformer-tied-layers:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] transformer-train-position-embeddings: false
[2023-06-26 23:15:53] [config] tsv: false
[2023-06-26 23:15:53] [config] tsv-fields: 0
[2023-06-26 23:15:53] [config] type: amun
[2023-06-26 23:15:53] [config] ulr: false
[2023-06-26 23:15:53] [config] ulr-dim-emb: 0
[2023-06-26 23:15:53] [config] ulr-dropout: 0
[2023-06-26 23:15:53] [config] ulr-keys-vectors: ""
[2023-06-26 23:15:53] [config] ulr-query-vectors: ""
[2023-06-26 23:15:53] [config] ulr-softmax-temperature: 1
[2023-06-26 23:15:53] [config] ulr-trainable-transformation: false
[2023-06-26 23:15:53] [config] unlikelihood-loss: false
[2023-06-26 23:15:53] [config] valid-freq: 5000000
[2023-06-26 23:15:53] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 23:15:53] [config] valid-max-length: 1000
[2023-06-26 23:15:53] [config] valid-metrics:
[2023-06-26 23:15:53] [config]   - cross-entropy
[2023-06-26 23:15:53] [config]   - translation
[2023-06-26 23:15:53] [config] valid-mini-batch: 32
[2023-06-26 23:15:53] [config] valid-reset-stalled: false
[2023-06-26 23:15:53] [config] valid-script-args:
[2023-06-26 23:15:53] [config]   []
[2023-06-26 23:15:53] [config] valid-script-path: ""
[2023-06-26 23:15:53] [config] valid-sets:
[2023-06-26 23:15:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 23:15:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 23:15:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 23:15:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:15:53] [config] vocabs:
[2023-06-26 23:15:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:15:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:15:53] [config] word-penalty: 0
[2023-06-26 23:15:53] [config] word-scores: false
[2023-06-26 23:15:53] [config] workspace: 3000
[2023-06-26 23:15:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:15:53] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:15:53] [training] Using single-device training
[2023-06-26 23:15:54] Synced seed 1234
[2023-06-26 23:15:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:15:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 23:15:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:15:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 23:15:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 23:15:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:15:54] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:15:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:15:54] [comm] Using global sharding
[2023-06-26 23:15:54] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:15:54] [training] Using 1 GPUs
[2023-06-26 23:15:54] [logits] Applying loss function for 1 factor(s)
[2023-06-26 23:15:54] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:15:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 23:15:55] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:16:07] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 23:16:07] [valid] No post-processing script given for validating translator
[2023-06-26 23:16:07] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:16:07] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:16:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:16:07] [comm] Using global sharding
[2023-06-26 23:16:07] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:16:07] [training] Using 1 GPUs
[2023-06-26 23:16:07] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:16:08] Loading Adam parameters
[2023-06-26 23:16:08] [memory] Reserving 322 MB, device gpu0
[2023-06-26 23:16:08] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:16:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:16:09] [data] Restoring the corpus state to epoch 61, batch 6188
[2023-06-26 23:16:09] [data] Shuffling data
[2023-06-26 23:16:09] [data] Done reading 20,192 sentences
[2023-06-26 23:16:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:16:09] Training started
[2023-06-26 23:16:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 23:16:09] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:16:09] Parameter type float32, optimization type float32, casting types false
[2023-06-26 23:16:46] Seen 16,611 samples
[2023-06-26 23:16:46] Starting data epoch 62 in logical epoch 62
[2023-06-26 23:16:46] [data] Shuffling data
[2023-06-26 23:16:46] [data] Done reading 20,192 sentences
[2023-06-26 23:16:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:17:26] Seen 16,611 samples
[2023-06-26 23:17:26] Starting data epoch 63 in logical epoch 63
[2023-06-26 23:17:26] [data] Shuffling data
[2023-06-26 23:17:26] [data] Done reading 20,192 sentences
[2023-06-26 23:17:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:18:06] Seen 16,611 samples
[2023-06-26 23:18:06] Starting data epoch 64 in logical epoch 64
[2023-06-26 23:18:06] [data] Shuffling data
[2023-06-26 23:18:06] [data] Done reading 20,192 sentences
[2023-06-26 23:18:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:18:47] Seen 16,611 samples
[2023-06-26 23:18:47] Starting data epoch 65 in logical epoch 65
[2023-06-26 23:18:47] [data] Shuffling data
[2023-06-26 23:18:47] [data] Done reading 20,192 sentences
[2023-06-26 23:18:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:19:28] Seen 16,611 samples
[2023-06-26 23:19:28] Starting data epoch 66 in logical epoch 66
[2023-06-26 23:19:28] [data] Shuffling data
[2023-06-26 23:19:28] [data] Done reading 20,192 sentences
[2023-06-26 23:19:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:20:08] Seen 16,611 samples
[2023-06-26 23:20:08] Starting data epoch 67 in logical epoch 67
[2023-06-26 23:20:08] [data] Shuffling data
[2023-06-26 23:20:08] [data] Done reading 20,192 sentences
[2023-06-26 23:20:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:20:48] Seen 16,611 samples
[2023-06-26 23:20:48] Starting data epoch 68 in logical epoch 68
[2023-06-26 23:20:48] [data] Shuffling data
[2023-06-26 23:20:48] [data] Done reading 20,192 sentences
[2023-06-26 23:20:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:21:22] Ep. 68 : Up. 7000 : Sen. 14,291 : Cost 1.77206087 * 3,761,836 @ 2,860 after 26,412,365 : Time 315.14s : 11937.18 words/s : gNorm 1.1632
[2023-06-26 23:21:29] Seen 16,611 samples
[2023-06-26 23:21:29] Starting data epoch 69 in logical epoch 69
[2023-06-26 23:21:29] [data] Shuffling data
[2023-06-26 23:21:29] [data] Done reading 20,192 sentences
[2023-06-26 23:21:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:22:09] Seen 16,611 samples
[2023-06-26 23:22:09] Starting data epoch 70 in logical epoch 70
[2023-06-26 23:22:09] [data] Shuffling data
[2023-06-26 23:22:09] [data] Done reading 20,192 sentences
[2023-06-26 23:22:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:22:50] Seen 16,611 samples
[2023-06-26 23:22:50] Starting data epoch 71 in logical epoch 71
[2023-06-26 23:22:50] Training finished
[2023-06-26 23:22:58] [valid] Ep. 71 : Up. 7221 : cross-entropy : 119.431 : stalled 2 times (last best: 118.987)
[2023-06-26 23:23:33] [valid] Ep. 71 : Up. 7221 : translation : 0 : new best
[2023-06-26 23:23:33] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:23:35] Saving Adam parameters
[2023-06-26 23:23:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:26:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:26:47] [marian] Running on node20.datos.cluster.uy as process 36896 with command line:
[2023-06-26 23:26:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 23:26:47] [config] after: 0e
[2023-06-26 23:26:47] [config] after-batches: 0
[2023-06-26 23:26:47] [config] after-epochs: 80
[2023-06-26 23:26:47] [config] all-caps-every: 0
[2023-06-26 23:26:47] [config] allow-unk: false
[2023-06-26 23:26:47] [config] authors: false
[2023-06-26 23:26:47] [config] beam-size: 6
[2023-06-26 23:26:47] [config] bert-class-symbol: "[CLS]"
[2023-06-26 23:26:47] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 23:26:47] [config] bert-masking-fraction: 0.15
[2023-06-26 23:26:47] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 23:26:47] [config] bert-train-type-embeddings: true
[2023-06-26 23:26:47] [config] bert-type-vocab-size: 2
[2023-06-26 23:26:47] [config] build-info: ""
[2023-06-26 23:26:47] [config] check-gradient-nan: false
[2023-06-26 23:26:47] [config] check-nan: false
[2023-06-26 23:26:47] [config] cite: false
[2023-06-26 23:26:47] [config] clip-norm: 1
[2023-06-26 23:26:47] [config] cost-scaling:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] cost-type: ce-sum
[2023-06-26 23:26:47] [config] cpu-threads: 0
[2023-06-26 23:26:47] [config] data-threads: 8
[2023-06-26 23:26:47] [config] data-weighting: ""
[2023-06-26 23:26:47] [config] data-weighting-type: sentence
[2023-06-26 23:26:47] [config] dec-cell: gru
[2023-06-26 23:26:47] [config] dec-cell-base-depth: 2
[2023-06-26 23:26:47] [config] dec-cell-high-depth: 1
[2023-06-26 23:26:47] [config] dec-depth: 1
[2023-06-26 23:26:47] [config] devices:
[2023-06-26 23:26:47] [config]   - 0
[2023-06-26 23:26:47] [config] dim-emb: 512
[2023-06-26 23:26:47] [config] dim-rnn: 1024
[2023-06-26 23:26:47] [config] dim-vocabs:
[2023-06-26 23:26:47] [config]   - 16384
[2023-06-26 23:26:47] [config]   - 16384
[2023-06-26 23:26:47] [config] disp-first: 0
[2023-06-26 23:26:47] [config] disp-freq: 1000u
[2023-06-26 23:26:47] [config] disp-label-counts: true
[2023-06-26 23:26:47] [config] dropout-rnn: 0.2
[2023-06-26 23:26:47] [config] dropout-src: 0.1
[2023-06-26 23:26:47] [config] dropout-trg: 0.1
[2023-06-26 23:26:47] [config] dump-config: ""
[2023-06-26 23:26:47] [config] dynamic-gradient-scaling:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] early-stopping: 10
[2023-06-26 23:26:47] [config] early-stopping-on: first
[2023-06-26 23:26:47] [config] embedding-fix-src: false
[2023-06-26 23:26:47] [config] embedding-fix-trg: false
[2023-06-26 23:26:47] [config] embedding-normalization: false
[2023-06-26 23:26:47] [config] embedding-vectors:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] enc-cell: gru
[2023-06-26 23:26:47] [config] enc-cell-depth: 1
[2023-06-26 23:26:47] [config] enc-depth: 1
[2023-06-26 23:26:47] [config] enc-type: bidirectional
[2023-06-26 23:26:47] [config] english-title-case-every: 0
[2023-06-26 23:26:47] [config] exponential-smoothing: 0
[2023-06-26 23:26:47] [config] factor-weight: 1
[2023-06-26 23:26:47] [config] factors-combine: sum
[2023-06-26 23:26:47] [config] factors-dim-emb: 0
[2023-06-26 23:26:47] [config] gradient-checkpointing: false
[2023-06-26 23:26:47] [config] gradient-norm-average-window: 100
[2023-06-26 23:26:47] [config] guided-alignment: none
[2023-06-26 23:26:47] [config] guided-alignment-cost: mse
[2023-06-26 23:26:47] [config] guided-alignment-weight: 0.1
[2023-06-26 23:26:47] [config] ignore-model-config: false
[2023-06-26 23:26:47] [config] input-types:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] interpolate-env-vars: false
[2023-06-26 23:26:47] [config] keep-best: false
[2023-06-26 23:26:47] [config] label-smoothing: 0
[2023-06-26 23:26:47] [config] layer-normalization: true
[2023-06-26 23:26:47] [config] learn-rate: 0.0001
[2023-06-26 23:26:47] [config] lemma-dependency: ""
[2023-06-26 23:26:47] [config] lemma-dim-emb: 0
[2023-06-26 23:26:47] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 23:26:47] [config] log-level: info
[2023-06-26 23:26:47] [config] log-time-zone: ""
[2023-06-26 23:26:47] [config] logical-epoch:
[2023-06-26 23:26:47] [config]   - 1e
[2023-06-26 23:26:47] [config]   - 0
[2023-06-26 23:26:47] [config] lr-decay: 0
[2023-06-26 23:26:47] [config] lr-decay-freq: 50000
[2023-06-26 23:26:47] [config] lr-decay-inv-sqrt:
[2023-06-26 23:26:47] [config]   - 0
[2023-06-26 23:26:47] [config] lr-decay-repeat-warmup: false
[2023-06-26 23:26:47] [config] lr-decay-reset-optimizer: false
[2023-06-26 23:26:47] [config] lr-decay-start:
[2023-06-26 23:26:47] [config]   - 10
[2023-06-26 23:26:47] [config]   - 1
[2023-06-26 23:26:47] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 23:26:47] [config] lr-report: false
[2023-06-26 23:26:47] [config] lr-warmup: 0
[2023-06-26 23:26:47] [config] lr-warmup-at-reload: false
[2023-06-26 23:26:47] [config] lr-warmup-cycle: false
[2023-06-26 23:26:47] [config] lr-warmup-start-rate: 0
[2023-06-26 23:26:47] [config] max-length: 50
[2023-06-26 23:26:47] [config] max-length-crop: false
[2023-06-26 23:26:47] [config] max-length-factor: 3
[2023-06-26 23:26:47] [config] maxi-batch: 100
[2023-06-26 23:26:47] [config] maxi-batch-sort: trg
[2023-06-26 23:26:47] [config] mini-batch: 64
[2023-06-26 23:26:47] [config] mini-batch-fit: true
[2023-06-26 23:26:47] [config] mini-batch-fit-step: 10
[2023-06-26 23:26:47] [config] mini-batch-round-up: true
[2023-06-26 23:26:47] [config] mini-batch-track-lr: false
[2023-06-26 23:26:47] [config] mini-batch-warmup: 0
[2023-06-26 23:26:47] [config] mini-batch-words: 0
[2023-06-26 23:26:47] [config] mini-batch-words-ref: 0
[2023-06-26 23:26:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:26:47] [config] multi-loss-type: sum
[2023-06-26 23:26:47] [config] n-best: false
[2023-06-26 23:26:47] [config] no-nccl: false
[2023-06-26 23:26:47] [config] no-reload: false
[2023-06-26 23:26:47] [config] no-restore-corpus: false
[2023-06-26 23:26:47] [config] normalize: 0.6
[2023-06-26 23:26:47] [config] normalize-gradient: false
[2023-06-26 23:26:47] [config] num-devices: 0
[2023-06-26 23:26:47] [config] optimizer: adam
[2023-06-26 23:26:47] [config] optimizer-delay: 1
[2023-06-26 23:26:47] [config] optimizer-params:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] output-omit-bias: false
[2023-06-26 23:26:47] [config] overwrite: false
[2023-06-26 23:26:47] [config] precision:
[2023-06-26 23:26:47] [config]   - float32
[2023-06-26 23:26:47] [config]   - float32
[2023-06-26 23:26:47] [config] pretrained-model: ""
[2023-06-26 23:26:47] [config] quantize-biases: false
[2023-06-26 23:26:47] [config] quantize-bits: 0
[2023-06-26 23:26:47] [config] quantize-log-based: false
[2023-06-26 23:26:47] [config] quantize-optimization-steps: 0
[2023-06-26 23:26:47] [config] quiet: false
[2023-06-26 23:26:47] [config] quiet-translation: true
[2023-06-26 23:26:47] [config] relative-paths: false
[2023-06-26 23:26:47] [config] right-left: false
[2023-06-26 23:26:47] [config] save-freq: 10000u
[2023-06-26 23:26:47] [config] seed: 1234
[2023-06-26 23:26:47] [config] sentencepiece-alphas:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] sentencepiece-max-lines: 2000000
[2023-06-26 23:26:47] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 23:26:47] [config] sharding: global
[2023-06-26 23:26:47] [config] shuffle: data
[2023-06-26 23:26:47] [config] shuffle-in-ram: false
[2023-06-26 23:26:47] [config] sigterm: save-and-exit
[2023-06-26 23:26:47] [config] skip: false
[2023-06-26 23:26:47] [config] sqlite: ""
[2023-06-26 23:26:47] [config] sqlite-drop: false
[2023-06-26 23:26:47] [config] sync-freq: 200u
[2023-06-26 23:26:47] [config] sync-sgd: false
[2023-06-26 23:26:47] [config] tempdir: /tmp
[2023-06-26 23:26:47] [config] tied-embeddings: false
[2023-06-26 23:26:47] [config] tied-embeddings-all: true
[2023-06-26 23:26:47] [config] tied-embeddings-src: false
[2023-06-26 23:26:47] [config] train-embedder-rank:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] train-sets:
[2023-06-26 23:26:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 23:26:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 23:26:47] [config] transformer-aan-activation: swish
[2023-06-26 23:26:47] [config] transformer-aan-depth: 2
[2023-06-26 23:26:47] [config] transformer-aan-nogate: false
[2023-06-26 23:26:47] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 23:26:47] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 23:26:47] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 23:26:47] [config] transformer-depth-scaling: false
[2023-06-26 23:26:47] [config] transformer-dim-aan: 2048
[2023-06-26 23:26:47] [config] transformer-dim-ffn: 2048
[2023-06-26 23:26:47] [config] transformer-dropout: 0
[2023-06-26 23:26:47] [config] transformer-dropout-attention: 0
[2023-06-26 23:26:47] [config] transformer-dropout-ffn: 0
[2023-06-26 23:26:47] [config] transformer-ffn-activation: swish
[2023-06-26 23:26:47] [config] transformer-ffn-depth: 2
[2023-06-26 23:26:47] [config] transformer-guided-alignment-layer: last
[2023-06-26 23:26:47] [config] transformer-heads: 8
[2023-06-26 23:26:47] [config] transformer-no-projection: false
[2023-06-26 23:26:47] [config] transformer-pool: false
[2023-06-26 23:26:47] [config] transformer-postprocess: dan
[2023-06-26 23:26:47] [config] transformer-postprocess-emb: d
[2023-06-26 23:26:47] [config] transformer-postprocess-top: ""
[2023-06-26 23:26:47] [config] transformer-preprocess: ""
[2023-06-26 23:26:47] [config] transformer-tied-layers:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] transformer-train-position-embeddings: false
[2023-06-26 23:26:47] [config] tsv: false
[2023-06-26 23:26:47] [config] tsv-fields: 0
[2023-06-26 23:26:47] [config] type: amun
[2023-06-26 23:26:47] [config] ulr: false
[2023-06-26 23:26:47] [config] ulr-dim-emb: 0
[2023-06-26 23:26:47] [config] ulr-dropout: 0
[2023-06-26 23:26:47] [config] ulr-keys-vectors: ""
[2023-06-26 23:26:47] [config] ulr-query-vectors: ""
[2023-06-26 23:26:47] [config] ulr-softmax-temperature: 1
[2023-06-26 23:26:47] [config] ulr-trainable-transformation: false
[2023-06-26 23:26:47] [config] unlikelihood-loss: false
[2023-06-26 23:26:47] [config] valid-freq: 5000000
[2023-06-26 23:26:47] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 23:26:47] [config] valid-max-length: 1000
[2023-06-26 23:26:47] [config] valid-metrics:
[2023-06-26 23:26:47] [config]   - cross-entropy
[2023-06-26 23:26:47] [config]   - translation
[2023-06-26 23:26:47] [config] valid-mini-batch: 32
[2023-06-26 23:26:47] [config] valid-reset-stalled: false
[2023-06-26 23:26:47] [config] valid-script-args:
[2023-06-26 23:26:47] [config]   []
[2023-06-26 23:26:47] [config] valid-script-path: ""
[2023-06-26 23:26:47] [config] valid-sets:
[2023-06-26 23:26:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 23:26:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 23:26:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 23:26:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:26:47] [config] vocabs:
[2023-06-26 23:26:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:26:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:26:47] [config] word-penalty: 0
[2023-06-26 23:26:47] [config] word-scores: false
[2023-06-26 23:26:47] [config] workspace: 3000
[2023-06-26 23:26:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:26:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:26:47] [training] Using single-device training
[2023-06-26 23:26:47] Synced seed 1234
[2023-06-26 23:26:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:26:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 23:26:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:26:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 23:26:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 23:26:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:26:48] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:26:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:26:48] [comm] Using global sharding
[2023-06-26 23:26:48] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:26:48] [training] Using 1 GPUs
[2023-06-26 23:26:48] [logits] Applying loss function for 1 factor(s)
[2023-06-26 23:26:48] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:26:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 23:26:49] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:27:01] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 23:27:01] [valid] No post-processing script given for validating translator
[2023-06-26 23:27:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:27:01] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:27:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:27:01] [comm] Using global sharding
[2023-06-26 23:27:01] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:27:01] [training] Using 1 GPUs
[2023-06-26 23:27:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:27:03] Loading Adam parameters
[2023-06-26 23:27:03] [memory] Reserving 322 MB, device gpu0
[2023-06-26 23:27:03] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:27:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:27:03] [data] Restoring the corpus state to epoch 71, batch 7221
[2023-06-26 23:27:03] [data] Shuffling data
[2023-06-26 23:27:03] [data] Done reading 20,192 sentences
[2023-06-26 23:27:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:27:03] Training started
[2023-06-26 23:27:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 23:27:03] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:27:03] Parameter type float32, optimization type float32, casting types false
[2023-06-26 23:27:40] Seen 16,611 samples
[2023-06-26 23:27:40] Starting data epoch 72 in logical epoch 72
[2023-06-26 23:27:40] [data] Shuffling data
[2023-06-26 23:27:40] [data] Done reading 20,192 sentences
[2023-06-26 23:27:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:28:20] Seen 16,611 samples
[2023-06-26 23:28:20] Starting data epoch 73 in logical epoch 73
[2023-06-26 23:28:20] [data] Shuffling data
[2023-06-26 23:28:20] [data] Done reading 20,192 sentences
[2023-06-26 23:28:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:29:00] Seen 16,611 samples
[2023-06-26 23:29:00] Starting data epoch 74 in logical epoch 74
[2023-06-26 23:29:00] [data] Shuffling data
[2023-06-26 23:29:00] [data] Done reading 20,192 sentences
[2023-06-26 23:29:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:29:41] Seen 16,611 samples
[2023-06-26 23:29:41] Starting data epoch 75 in logical epoch 75
[2023-06-26 23:29:41] [data] Shuffling data
[2023-06-26 23:29:41] [data] Done reading 20,192 sentences
[2023-06-26 23:29:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:30:21] Seen 16,611 samples
[2023-06-26 23:30:21] Starting data epoch 76 in logical epoch 76
[2023-06-26 23:30:21] [data] Shuffling data
[2023-06-26 23:30:21] [data] Done reading 20,192 sentences
[2023-06-26 23:30:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:31:01] Seen 16,611 samples
[2023-06-26 23:31:01] Starting data epoch 77 in logical epoch 77
[2023-06-26 23:31:01] [data] Shuffling data
[2023-06-26 23:31:02] [data] Done reading 20,192 sentences
[2023-06-26 23:31:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:31:42] Seen 16,611 samples
[2023-06-26 23:31:42] Starting data epoch 78 in logical epoch 78
[2023-06-26 23:31:42] [data] Shuffling data
[2023-06-26 23:31:42] [data] Done reading 20,192 sentences
[2023-06-26 23:31:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:32:03] Ep. 78 : Up. 8000 : Sen. 9,190 : Cost 1.49995589 * 3,767,396 @ 4,254 after 30,179,761 : Time 302.19s : 12466.78 words/s : gNorm 1.1676
[2023-06-26 23:32:23] Seen 16,611 samples
[2023-06-26 23:32:23] Starting data epoch 79 in logical epoch 79
[2023-06-26 23:32:23] [data] Shuffling data
[2023-06-26 23:32:23] [data] Done reading 20,192 sentences
[2023-06-26 23:32:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:33:03] Seen 16,611 samples
[2023-06-26 23:33:03] Starting data epoch 80 in logical epoch 80
[2023-06-26 23:33:03] [data] Shuffling data
[2023-06-26 23:33:03] [data] Done reading 20,192 sentences
[2023-06-26 23:33:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:33:44] Seen 16,611 samples
[2023-06-26 23:33:44] Starting data epoch 81 in logical epoch 81
[2023-06-26 23:33:44] Training finished
[2023-06-26 23:33:52] [valid] Ep. 81 : Up. 8253 : cross-entropy : 118.897 : new best
[2023-06-26 23:34:27] [valid] Ep. 81 : Up. 8253 : translation : 0 : new best
[2023-06-26 23:34:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:34:29] Saving Adam parameters
[2023-06-26 23:34:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:37:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:37:47] [marian] Running on node20.datos.cluster.uy as process 37877 with command line:
[2023-06-26 23:37:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 23:37:47] [config] after: 0e
[2023-06-26 23:37:47] [config] after-batches: 0
[2023-06-26 23:37:47] [config] after-epochs: 90
[2023-06-26 23:37:47] [config] all-caps-every: 0
[2023-06-26 23:37:47] [config] allow-unk: false
[2023-06-26 23:37:47] [config] authors: false
[2023-06-26 23:37:47] [config] beam-size: 6
[2023-06-26 23:37:47] [config] bert-class-symbol: "[CLS]"
[2023-06-26 23:37:47] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 23:37:47] [config] bert-masking-fraction: 0.15
[2023-06-26 23:37:47] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 23:37:47] [config] bert-train-type-embeddings: true
[2023-06-26 23:37:47] [config] bert-type-vocab-size: 2
[2023-06-26 23:37:47] [config] build-info: ""
[2023-06-26 23:37:47] [config] check-gradient-nan: false
[2023-06-26 23:37:47] [config] check-nan: false
[2023-06-26 23:37:47] [config] cite: false
[2023-06-26 23:37:47] [config] clip-norm: 1
[2023-06-26 23:37:47] [config] cost-scaling:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] cost-type: ce-sum
[2023-06-26 23:37:47] [config] cpu-threads: 0
[2023-06-26 23:37:47] [config] data-threads: 8
[2023-06-26 23:37:47] [config] data-weighting: ""
[2023-06-26 23:37:47] [config] data-weighting-type: sentence
[2023-06-26 23:37:47] [config] dec-cell: gru
[2023-06-26 23:37:47] [config] dec-cell-base-depth: 2
[2023-06-26 23:37:47] [config] dec-cell-high-depth: 1
[2023-06-26 23:37:47] [config] dec-depth: 1
[2023-06-26 23:37:47] [config] devices:
[2023-06-26 23:37:47] [config]   - 0
[2023-06-26 23:37:47] [config] dim-emb: 512
[2023-06-26 23:37:47] [config] dim-rnn: 1024
[2023-06-26 23:37:47] [config] dim-vocabs:
[2023-06-26 23:37:47] [config]   - 16384
[2023-06-26 23:37:47] [config]   - 16384
[2023-06-26 23:37:47] [config] disp-first: 0
[2023-06-26 23:37:47] [config] disp-freq: 1000u
[2023-06-26 23:37:47] [config] disp-label-counts: true
[2023-06-26 23:37:47] [config] dropout-rnn: 0.2
[2023-06-26 23:37:47] [config] dropout-src: 0.1
[2023-06-26 23:37:47] [config] dropout-trg: 0.1
[2023-06-26 23:37:47] [config] dump-config: ""
[2023-06-26 23:37:47] [config] dynamic-gradient-scaling:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] early-stopping: 10
[2023-06-26 23:37:47] [config] early-stopping-on: first
[2023-06-26 23:37:47] [config] embedding-fix-src: false
[2023-06-26 23:37:47] [config] embedding-fix-trg: false
[2023-06-26 23:37:47] [config] embedding-normalization: false
[2023-06-26 23:37:47] [config] embedding-vectors:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] enc-cell: gru
[2023-06-26 23:37:47] [config] enc-cell-depth: 1
[2023-06-26 23:37:47] [config] enc-depth: 1
[2023-06-26 23:37:47] [config] enc-type: bidirectional
[2023-06-26 23:37:47] [config] english-title-case-every: 0
[2023-06-26 23:37:47] [config] exponential-smoothing: 0
[2023-06-26 23:37:47] [config] factor-weight: 1
[2023-06-26 23:37:47] [config] factors-combine: sum
[2023-06-26 23:37:47] [config] factors-dim-emb: 0
[2023-06-26 23:37:47] [config] gradient-checkpointing: false
[2023-06-26 23:37:47] [config] gradient-norm-average-window: 100
[2023-06-26 23:37:47] [config] guided-alignment: none
[2023-06-26 23:37:47] [config] guided-alignment-cost: mse
[2023-06-26 23:37:47] [config] guided-alignment-weight: 0.1
[2023-06-26 23:37:47] [config] ignore-model-config: false
[2023-06-26 23:37:47] [config] input-types:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] interpolate-env-vars: false
[2023-06-26 23:37:47] [config] keep-best: false
[2023-06-26 23:37:47] [config] label-smoothing: 0
[2023-06-26 23:37:47] [config] layer-normalization: true
[2023-06-26 23:37:47] [config] learn-rate: 0.0001
[2023-06-26 23:37:47] [config] lemma-dependency: ""
[2023-06-26 23:37:47] [config] lemma-dim-emb: 0
[2023-06-26 23:37:47] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 23:37:47] [config] log-level: info
[2023-06-26 23:37:47] [config] log-time-zone: ""
[2023-06-26 23:37:47] [config] logical-epoch:
[2023-06-26 23:37:47] [config]   - 1e
[2023-06-26 23:37:47] [config]   - 0
[2023-06-26 23:37:47] [config] lr-decay: 0
[2023-06-26 23:37:47] [config] lr-decay-freq: 50000
[2023-06-26 23:37:47] [config] lr-decay-inv-sqrt:
[2023-06-26 23:37:47] [config]   - 0
[2023-06-26 23:37:47] [config] lr-decay-repeat-warmup: false
[2023-06-26 23:37:47] [config] lr-decay-reset-optimizer: false
[2023-06-26 23:37:47] [config] lr-decay-start:
[2023-06-26 23:37:47] [config]   - 10
[2023-06-26 23:37:47] [config]   - 1
[2023-06-26 23:37:47] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 23:37:47] [config] lr-report: false
[2023-06-26 23:37:47] [config] lr-warmup: 0
[2023-06-26 23:37:47] [config] lr-warmup-at-reload: false
[2023-06-26 23:37:47] [config] lr-warmup-cycle: false
[2023-06-26 23:37:47] [config] lr-warmup-start-rate: 0
[2023-06-26 23:37:47] [config] max-length: 50
[2023-06-26 23:37:47] [config] max-length-crop: false
[2023-06-26 23:37:47] [config] max-length-factor: 3
[2023-06-26 23:37:47] [config] maxi-batch: 100
[2023-06-26 23:37:47] [config] maxi-batch-sort: trg
[2023-06-26 23:37:47] [config] mini-batch: 64
[2023-06-26 23:37:47] [config] mini-batch-fit: true
[2023-06-26 23:37:47] [config] mini-batch-fit-step: 10
[2023-06-26 23:37:47] [config] mini-batch-round-up: true
[2023-06-26 23:37:47] [config] mini-batch-track-lr: false
[2023-06-26 23:37:47] [config] mini-batch-warmup: 0
[2023-06-26 23:37:47] [config] mini-batch-words: 0
[2023-06-26 23:37:47] [config] mini-batch-words-ref: 0
[2023-06-26 23:37:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:37:47] [config] multi-loss-type: sum
[2023-06-26 23:37:47] [config] n-best: false
[2023-06-26 23:37:47] [config] no-nccl: false
[2023-06-26 23:37:47] [config] no-reload: false
[2023-06-26 23:37:47] [config] no-restore-corpus: false
[2023-06-26 23:37:47] [config] normalize: 0.6
[2023-06-26 23:37:47] [config] normalize-gradient: false
[2023-06-26 23:37:47] [config] num-devices: 0
[2023-06-26 23:37:47] [config] optimizer: adam
[2023-06-26 23:37:47] [config] optimizer-delay: 1
[2023-06-26 23:37:47] [config] optimizer-params:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] output-omit-bias: false
[2023-06-26 23:37:47] [config] overwrite: false
[2023-06-26 23:37:47] [config] precision:
[2023-06-26 23:37:47] [config]   - float32
[2023-06-26 23:37:47] [config]   - float32
[2023-06-26 23:37:47] [config] pretrained-model: ""
[2023-06-26 23:37:47] [config] quantize-biases: false
[2023-06-26 23:37:47] [config] quantize-bits: 0
[2023-06-26 23:37:47] [config] quantize-log-based: false
[2023-06-26 23:37:47] [config] quantize-optimization-steps: 0
[2023-06-26 23:37:47] [config] quiet: false
[2023-06-26 23:37:47] [config] quiet-translation: true
[2023-06-26 23:37:47] [config] relative-paths: false
[2023-06-26 23:37:47] [config] right-left: false
[2023-06-26 23:37:47] [config] save-freq: 10000u
[2023-06-26 23:37:47] [config] seed: 1234
[2023-06-26 23:37:47] [config] sentencepiece-alphas:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] sentencepiece-max-lines: 2000000
[2023-06-26 23:37:47] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 23:37:47] [config] sharding: global
[2023-06-26 23:37:47] [config] shuffle: data
[2023-06-26 23:37:47] [config] shuffle-in-ram: false
[2023-06-26 23:37:47] [config] sigterm: save-and-exit
[2023-06-26 23:37:47] [config] skip: false
[2023-06-26 23:37:47] [config] sqlite: ""
[2023-06-26 23:37:47] [config] sqlite-drop: false
[2023-06-26 23:37:47] [config] sync-freq: 200u
[2023-06-26 23:37:47] [config] sync-sgd: false
[2023-06-26 23:37:47] [config] tempdir: /tmp
[2023-06-26 23:37:47] [config] tied-embeddings: false
[2023-06-26 23:37:47] [config] tied-embeddings-all: true
[2023-06-26 23:37:47] [config] tied-embeddings-src: false
[2023-06-26 23:37:47] [config] train-embedder-rank:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] train-sets:
[2023-06-26 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 23:37:47] [config] transformer-aan-activation: swish
[2023-06-26 23:37:47] [config] transformer-aan-depth: 2
[2023-06-26 23:37:47] [config] transformer-aan-nogate: false
[2023-06-26 23:37:47] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 23:37:47] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 23:37:47] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 23:37:47] [config] transformer-depth-scaling: false
[2023-06-26 23:37:47] [config] transformer-dim-aan: 2048
[2023-06-26 23:37:47] [config] transformer-dim-ffn: 2048
[2023-06-26 23:37:47] [config] transformer-dropout: 0
[2023-06-26 23:37:47] [config] transformer-dropout-attention: 0
[2023-06-26 23:37:47] [config] transformer-dropout-ffn: 0
[2023-06-26 23:37:47] [config] transformer-ffn-activation: swish
[2023-06-26 23:37:47] [config] transformer-ffn-depth: 2
[2023-06-26 23:37:47] [config] transformer-guided-alignment-layer: last
[2023-06-26 23:37:47] [config] transformer-heads: 8
[2023-06-26 23:37:47] [config] transformer-no-projection: false
[2023-06-26 23:37:47] [config] transformer-pool: false
[2023-06-26 23:37:47] [config] transformer-postprocess: dan
[2023-06-26 23:37:47] [config] transformer-postprocess-emb: d
[2023-06-26 23:37:47] [config] transformer-postprocess-top: ""
[2023-06-26 23:37:47] [config] transformer-preprocess: ""
[2023-06-26 23:37:47] [config] transformer-tied-layers:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] transformer-train-position-embeddings: false
[2023-06-26 23:37:47] [config] tsv: false
[2023-06-26 23:37:47] [config] tsv-fields: 0
[2023-06-26 23:37:47] [config] type: amun
[2023-06-26 23:37:47] [config] ulr: false
[2023-06-26 23:37:47] [config] ulr-dim-emb: 0
[2023-06-26 23:37:47] [config] ulr-dropout: 0
[2023-06-26 23:37:47] [config] ulr-keys-vectors: ""
[2023-06-26 23:37:47] [config] ulr-query-vectors: ""
[2023-06-26 23:37:47] [config] ulr-softmax-temperature: 1
[2023-06-26 23:37:47] [config] ulr-trainable-transformation: false
[2023-06-26 23:37:47] [config] unlikelihood-loss: false
[2023-06-26 23:37:47] [config] valid-freq: 5000000
[2023-06-26 23:37:47] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 23:37:47] [config] valid-max-length: 1000
[2023-06-26 23:37:47] [config] valid-metrics:
[2023-06-26 23:37:47] [config]   - cross-entropy
[2023-06-26 23:37:47] [config]   - translation
[2023-06-26 23:37:47] [config] valid-mini-batch: 32
[2023-06-26 23:37:47] [config] valid-reset-stalled: false
[2023-06-26 23:37:47] [config] valid-script-args:
[2023-06-26 23:37:47] [config]   []
[2023-06-26 23:37:47] [config] valid-script-path: ""
[2023-06-26 23:37:47] [config] valid-sets:
[2023-06-26 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 23:37:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 23:37:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:37:47] [config] vocabs:
[2023-06-26 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:37:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:37:47] [config] word-penalty: 0
[2023-06-26 23:37:47] [config] word-scores: false
[2023-06-26 23:37:47] [config] workspace: 3000
[2023-06-26 23:37:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:37:47] [training] Using single-device training
[2023-06-26 23:37:47] Synced seed 1234
[2023-06-26 23:37:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:37:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 23:37:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:37:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 23:37:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 23:37:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:37:48] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:37:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:37:48] [comm] Using global sharding
[2023-06-26 23:37:48] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:37:48] [training] Using 1 GPUs
[2023-06-26 23:37:48] [logits] Applying loss function for 1 factor(s)
[2023-06-26 23:37:48] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:37:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 23:37:48] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:38:00] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 23:38:01] [valid] No post-processing script given for validating translator
[2023-06-26 23:38:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:38:01] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:38:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:38:01] [comm] Using global sharding
[2023-06-26 23:38:01] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:38:01] [training] Using 1 GPUs
[2023-06-26 23:38:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:38:02] Loading Adam parameters
[2023-06-26 23:38:02] [memory] Reserving 322 MB, device gpu0
[2023-06-26 23:38:02] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:38:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:38:02] [data] Restoring the corpus state to epoch 81, batch 8253
[2023-06-26 23:38:02] [data] Shuffling data
[2023-06-26 23:38:02] [data] Done reading 20,192 sentences
[2023-06-26 23:38:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:38:02] Training started
[2023-06-26 23:38:02] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 23:38:02] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:38:03] Parameter type float32, optimization type float32, casting types false
[2023-06-26 23:38:39] Seen 16,611 samples
[2023-06-26 23:38:39] Starting data epoch 82 in logical epoch 82
[2023-06-26 23:38:39] [data] Shuffling data
[2023-06-26 23:38:39] [data] Done reading 20,192 sentences
[2023-06-26 23:38:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:39:19] Seen 16,611 samples
[2023-06-26 23:39:19] Starting data epoch 83 in logical epoch 83
[2023-06-26 23:39:19] [data] Shuffling data
[2023-06-26 23:39:19] [data] Done reading 20,192 sentences
[2023-06-26 23:39:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:39:59] Seen 16,611 samples
[2023-06-26 23:39:59] Starting data epoch 84 in logical epoch 84
[2023-06-26 23:39:59] [data] Shuffling data
[2023-06-26 23:39:59] [data] Done reading 20,192 sentences
[2023-06-26 23:39:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:40:40] Seen 16,611 samples
[2023-06-26 23:40:40] Starting data epoch 85 in logical epoch 85
[2023-06-26 23:40:40] [data] Shuffling data
[2023-06-26 23:40:40] [data] Done reading 20,192 sentences
[2023-06-26 23:40:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:41:20] Seen 16,611 samples
[2023-06-26 23:41:20] Starting data epoch 86 in logical epoch 86
[2023-06-26 23:41:20] [data] Shuffling data
[2023-06-26 23:41:20] [data] Done reading 20,192 sentences
[2023-06-26 23:41:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:42:01] Seen 16,611 samples
[2023-06-26 23:42:01] Starting data epoch 87 in logical epoch 87
[2023-06-26 23:42:01] [data] Shuffling data
[2023-06-26 23:42:01] [data] Done reading 20,192 sentences
[2023-06-26 23:42:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:42:41] Seen 16,611 samples
[2023-06-26 23:42:41] Starting data epoch 88 in logical epoch 88
[2023-06-26 23:42:41] [data] Shuffling data
[2023-06-26 23:42:41] [data] Done reading 20,192 sentences
[2023-06-26 23:42:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:42:52] Ep. 88 : Up. 9000 : Sen. 3,703 : Cost 1.30207360 * 3,787,934 @ 5,615 after 33,967,695 : Time 291.05s : 13014.81 words/s : gNorm 1.1069
[2023-06-26 23:43:22] Seen 16,611 samples
[2023-06-26 23:43:22] Starting data epoch 89 in logical epoch 89
[2023-06-26 23:43:22] [data] Shuffling data
[2023-06-26 23:43:22] [data] Done reading 20,192 sentences
[2023-06-26 23:43:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:44:03] Seen 16,611 samples
[2023-06-26 23:44:03] Starting data epoch 90 in logical epoch 90
[2023-06-26 23:44:03] [data] Shuffling data
[2023-06-26 23:44:03] [data] Done reading 20,192 sentences
[2023-06-26 23:44:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:44:43] Seen 16,611 samples
[2023-06-26 23:44:43] Starting data epoch 91 in logical epoch 91
[2023-06-26 23:44:43] Training finished
[2023-06-26 23:44:52] [valid] Ep. 91 : Up. 9285 : cross-entropy : 120.644 : stalled 1 times (last best: 118.897)
[2023-06-26 23:45:25] [valid] Ep. 91 : Up. 9285 : translation : 0 : new best
[2023-06-26 23:45:25] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:45:27] Saving Adam parameters
[2023-06-26 23:45:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:48:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:48:36] [marian] Running on node20.datos.cluster.uy as process 38517 with command line:
[2023-06-26 23:48:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 23:48:36] [config] after: 0e
[2023-06-26 23:48:36] [config] after-batches: 0
[2023-06-26 23:48:36] [config] after-epochs: 100
[2023-06-26 23:48:36] [config] all-caps-every: 0
[2023-06-26 23:48:36] [config] allow-unk: false
[2023-06-26 23:48:36] [config] authors: false
[2023-06-26 23:48:36] [config] beam-size: 6
[2023-06-26 23:48:36] [config] bert-class-symbol: "[CLS]"
[2023-06-26 23:48:36] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 23:48:36] [config] bert-masking-fraction: 0.15
[2023-06-26 23:48:36] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 23:48:36] [config] bert-train-type-embeddings: true
[2023-06-26 23:48:36] [config] bert-type-vocab-size: 2
[2023-06-26 23:48:36] [config] build-info: ""
[2023-06-26 23:48:36] [config] check-gradient-nan: false
[2023-06-26 23:48:36] [config] check-nan: false
[2023-06-26 23:48:36] [config] cite: false
[2023-06-26 23:48:36] [config] clip-norm: 1
[2023-06-26 23:48:36] [config] cost-scaling:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] cost-type: ce-sum
[2023-06-26 23:48:36] [config] cpu-threads: 0
[2023-06-26 23:48:36] [config] data-threads: 8
[2023-06-26 23:48:36] [config] data-weighting: ""
[2023-06-26 23:48:36] [config] data-weighting-type: sentence
[2023-06-26 23:48:36] [config] dec-cell: gru
[2023-06-26 23:48:36] [config] dec-cell-base-depth: 2
[2023-06-26 23:48:36] [config] dec-cell-high-depth: 1
[2023-06-26 23:48:36] [config] dec-depth: 1
[2023-06-26 23:48:36] [config] devices:
[2023-06-26 23:48:36] [config]   - 0
[2023-06-26 23:48:36] [config] dim-emb: 512
[2023-06-26 23:48:36] [config] dim-rnn: 1024
[2023-06-26 23:48:36] [config] dim-vocabs:
[2023-06-26 23:48:36] [config]   - 16384
[2023-06-26 23:48:36] [config]   - 16384
[2023-06-26 23:48:36] [config] disp-first: 0
[2023-06-26 23:48:36] [config] disp-freq: 1000u
[2023-06-26 23:48:36] [config] disp-label-counts: true
[2023-06-26 23:48:36] [config] dropout-rnn: 0.2
[2023-06-26 23:48:36] [config] dropout-src: 0.1
[2023-06-26 23:48:36] [config] dropout-trg: 0.1
[2023-06-26 23:48:36] [config] dump-config: ""
[2023-06-26 23:48:36] [config] dynamic-gradient-scaling:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] early-stopping: 10
[2023-06-26 23:48:36] [config] early-stopping-on: first
[2023-06-26 23:48:36] [config] embedding-fix-src: false
[2023-06-26 23:48:36] [config] embedding-fix-trg: false
[2023-06-26 23:48:36] [config] embedding-normalization: false
[2023-06-26 23:48:36] [config] embedding-vectors:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] enc-cell: gru
[2023-06-26 23:48:36] [config] enc-cell-depth: 1
[2023-06-26 23:48:36] [config] enc-depth: 1
[2023-06-26 23:48:36] [config] enc-type: bidirectional
[2023-06-26 23:48:36] [config] english-title-case-every: 0
[2023-06-26 23:48:36] [config] exponential-smoothing: 0
[2023-06-26 23:48:36] [config] factor-weight: 1
[2023-06-26 23:48:36] [config] factors-combine: sum
[2023-06-26 23:48:36] [config] factors-dim-emb: 0
[2023-06-26 23:48:36] [config] gradient-checkpointing: false
[2023-06-26 23:48:36] [config] gradient-norm-average-window: 100
[2023-06-26 23:48:36] [config] guided-alignment: none
[2023-06-26 23:48:36] [config] guided-alignment-cost: mse
[2023-06-26 23:48:36] [config] guided-alignment-weight: 0.1
[2023-06-26 23:48:36] [config] ignore-model-config: false
[2023-06-26 23:48:36] [config] input-types:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] interpolate-env-vars: false
[2023-06-26 23:48:36] [config] keep-best: false
[2023-06-26 23:48:36] [config] label-smoothing: 0
[2023-06-26 23:48:36] [config] layer-normalization: true
[2023-06-26 23:48:36] [config] learn-rate: 0.0001
[2023-06-26 23:48:36] [config] lemma-dependency: ""
[2023-06-26 23:48:36] [config] lemma-dim-emb: 0
[2023-06-26 23:48:36] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 23:48:36] [config] log-level: info
[2023-06-26 23:48:36] [config] log-time-zone: ""
[2023-06-26 23:48:36] [config] logical-epoch:
[2023-06-26 23:48:36] [config]   - 1e
[2023-06-26 23:48:36] [config]   - 0
[2023-06-26 23:48:36] [config] lr-decay: 0
[2023-06-26 23:48:36] [config] lr-decay-freq: 50000
[2023-06-26 23:48:36] [config] lr-decay-inv-sqrt:
[2023-06-26 23:48:36] [config]   - 0
[2023-06-26 23:48:36] [config] lr-decay-repeat-warmup: false
[2023-06-26 23:48:36] [config] lr-decay-reset-optimizer: false
[2023-06-26 23:48:36] [config] lr-decay-start:
[2023-06-26 23:48:36] [config]   - 10
[2023-06-26 23:48:36] [config]   - 1
[2023-06-26 23:48:36] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 23:48:36] [config] lr-report: false
[2023-06-26 23:48:36] [config] lr-warmup: 0
[2023-06-26 23:48:36] [config] lr-warmup-at-reload: false
[2023-06-26 23:48:36] [config] lr-warmup-cycle: false
[2023-06-26 23:48:36] [config] lr-warmup-start-rate: 0
[2023-06-26 23:48:36] [config] max-length: 50
[2023-06-26 23:48:36] [config] max-length-crop: false
[2023-06-26 23:48:36] [config] max-length-factor: 3
[2023-06-26 23:48:36] [config] maxi-batch: 100
[2023-06-26 23:48:36] [config] maxi-batch-sort: trg
[2023-06-26 23:48:36] [config] mini-batch: 64
[2023-06-26 23:48:36] [config] mini-batch-fit: true
[2023-06-26 23:48:36] [config] mini-batch-fit-step: 10
[2023-06-26 23:48:36] [config] mini-batch-round-up: true
[2023-06-26 23:48:36] [config] mini-batch-track-lr: false
[2023-06-26 23:48:36] [config] mini-batch-warmup: 0
[2023-06-26 23:48:36] [config] mini-batch-words: 0
[2023-06-26 23:48:36] [config] mini-batch-words-ref: 0
[2023-06-26 23:48:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:48:36] [config] multi-loss-type: sum
[2023-06-26 23:48:36] [config] n-best: false
[2023-06-26 23:48:36] [config] no-nccl: false
[2023-06-26 23:48:36] [config] no-reload: false
[2023-06-26 23:48:36] [config] no-restore-corpus: false
[2023-06-26 23:48:36] [config] normalize: 0.6
[2023-06-26 23:48:36] [config] normalize-gradient: false
[2023-06-26 23:48:36] [config] num-devices: 0
[2023-06-26 23:48:36] [config] optimizer: adam
[2023-06-26 23:48:36] [config] optimizer-delay: 1
[2023-06-26 23:48:36] [config] optimizer-params:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] output-omit-bias: false
[2023-06-26 23:48:36] [config] overwrite: false
[2023-06-26 23:48:36] [config] precision:
[2023-06-26 23:48:36] [config]   - float32
[2023-06-26 23:48:36] [config]   - float32
[2023-06-26 23:48:36] [config] pretrained-model: ""
[2023-06-26 23:48:36] [config] quantize-biases: false
[2023-06-26 23:48:36] [config] quantize-bits: 0
[2023-06-26 23:48:36] [config] quantize-log-based: false
[2023-06-26 23:48:36] [config] quantize-optimization-steps: 0
[2023-06-26 23:48:36] [config] quiet: false
[2023-06-26 23:48:36] [config] quiet-translation: true
[2023-06-26 23:48:36] [config] relative-paths: false
[2023-06-26 23:48:36] [config] right-left: false
[2023-06-26 23:48:36] [config] save-freq: 10000u
[2023-06-26 23:48:36] [config] seed: 1234
[2023-06-26 23:48:36] [config] sentencepiece-alphas:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] sentencepiece-max-lines: 2000000
[2023-06-26 23:48:36] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 23:48:36] [config] sharding: global
[2023-06-26 23:48:36] [config] shuffle: data
[2023-06-26 23:48:36] [config] shuffle-in-ram: false
[2023-06-26 23:48:36] [config] sigterm: save-and-exit
[2023-06-26 23:48:36] [config] skip: false
[2023-06-26 23:48:36] [config] sqlite: ""
[2023-06-26 23:48:36] [config] sqlite-drop: false
[2023-06-26 23:48:36] [config] sync-freq: 200u
[2023-06-26 23:48:36] [config] sync-sgd: false
[2023-06-26 23:48:36] [config] tempdir: /tmp
[2023-06-26 23:48:36] [config] tied-embeddings: false
[2023-06-26 23:48:36] [config] tied-embeddings-all: true
[2023-06-26 23:48:36] [config] tied-embeddings-src: false
[2023-06-26 23:48:36] [config] train-embedder-rank:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] train-sets:
[2023-06-26 23:48:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 23:48:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 23:48:36] [config] transformer-aan-activation: swish
[2023-06-26 23:48:36] [config] transformer-aan-depth: 2
[2023-06-26 23:48:36] [config] transformer-aan-nogate: false
[2023-06-26 23:48:36] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 23:48:36] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 23:48:36] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 23:48:36] [config] transformer-depth-scaling: false
[2023-06-26 23:48:36] [config] transformer-dim-aan: 2048
[2023-06-26 23:48:36] [config] transformer-dim-ffn: 2048
[2023-06-26 23:48:36] [config] transformer-dropout: 0
[2023-06-26 23:48:36] [config] transformer-dropout-attention: 0
[2023-06-26 23:48:36] [config] transformer-dropout-ffn: 0
[2023-06-26 23:48:36] [config] transformer-ffn-activation: swish
[2023-06-26 23:48:36] [config] transformer-ffn-depth: 2
[2023-06-26 23:48:36] [config] transformer-guided-alignment-layer: last
[2023-06-26 23:48:36] [config] transformer-heads: 8
[2023-06-26 23:48:36] [config] transformer-no-projection: false
[2023-06-26 23:48:36] [config] transformer-pool: false
[2023-06-26 23:48:36] [config] transformer-postprocess: dan
[2023-06-26 23:48:36] [config] transformer-postprocess-emb: d
[2023-06-26 23:48:36] [config] transformer-postprocess-top: ""
[2023-06-26 23:48:36] [config] transformer-preprocess: ""
[2023-06-26 23:48:36] [config] transformer-tied-layers:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] transformer-train-position-embeddings: false
[2023-06-26 23:48:36] [config] tsv: false
[2023-06-26 23:48:36] [config] tsv-fields: 0
[2023-06-26 23:48:36] [config] type: amun
[2023-06-26 23:48:36] [config] ulr: false
[2023-06-26 23:48:36] [config] ulr-dim-emb: 0
[2023-06-26 23:48:36] [config] ulr-dropout: 0
[2023-06-26 23:48:36] [config] ulr-keys-vectors: ""
[2023-06-26 23:48:36] [config] ulr-query-vectors: ""
[2023-06-26 23:48:36] [config] ulr-softmax-temperature: 1
[2023-06-26 23:48:36] [config] ulr-trainable-transformation: false
[2023-06-26 23:48:36] [config] unlikelihood-loss: false
[2023-06-26 23:48:36] [config] valid-freq: 5000000
[2023-06-26 23:48:36] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 23:48:36] [config] valid-max-length: 1000
[2023-06-26 23:48:36] [config] valid-metrics:
[2023-06-26 23:48:36] [config]   - cross-entropy
[2023-06-26 23:48:36] [config]   - translation
[2023-06-26 23:48:36] [config] valid-mini-batch: 32
[2023-06-26 23:48:36] [config] valid-reset-stalled: false
[2023-06-26 23:48:36] [config] valid-script-args:
[2023-06-26 23:48:36] [config]   []
[2023-06-26 23:48:36] [config] valid-script-path: ""
[2023-06-26 23:48:36] [config] valid-sets:
[2023-06-26 23:48:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 23:48:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 23:48:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 23:48:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:48:36] [config] vocabs:
[2023-06-26 23:48:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:48:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:48:36] [config] word-penalty: 0
[2023-06-26 23:48:36] [config] word-scores: false
[2023-06-26 23:48:36] [config] workspace: 3000
[2023-06-26 23:48:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:48:36] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:48:36] [training] Using single-device training
[2023-06-26 23:48:36] Synced seed 1234
[2023-06-26 23:48:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:48:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 23:48:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:48:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 23:48:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 23:48:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:48:37] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:48:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:48:37] [comm] Using global sharding
[2023-06-26 23:48:37] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:48:37] [training] Using 1 GPUs
[2023-06-26 23:48:37] [logits] Applying loss function for 1 factor(s)
[2023-06-26 23:48:37] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:48:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 23:48:38] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:48:50] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 23:48:50] [valid] No post-processing script given for validating translator
[2023-06-26 23:48:50] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:48:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:48:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:48:50] [comm] Using global sharding
[2023-06-26 23:48:50] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:48:50] [training] Using 1 GPUs
[2023-06-26 23:48:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:48:51] Loading Adam parameters
[2023-06-26 23:48:51] [memory] Reserving 322 MB, device gpu0
[2023-06-26 23:48:51] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:48:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:48:51] [data] Restoring the corpus state to epoch 91, batch 9285
[2023-06-26 23:48:51] [data] Shuffling data
[2023-06-26 23:48:51] [data] Done reading 20,192 sentences
[2023-06-26 23:48:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:48:51] Training started
[2023-06-26 23:48:52] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 23:48:52] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:48:52] Parameter type float32, optimization type float32, casting types false
[2023-06-26 23:49:29] Seen 16,611 samples
[2023-06-26 23:49:29] Starting data epoch 92 in logical epoch 92
[2023-06-26 23:49:29] [data] Shuffling data
[2023-06-26 23:49:29] [data] Done reading 20,192 sentences
[2023-06-26 23:49:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:50:09] Seen 16,611 samples
[2023-06-26 23:50:09] Starting data epoch 93 in logical epoch 93
[2023-06-26 23:50:09] [data] Shuffling data
[2023-06-26 23:50:09] [data] Done reading 20,192 sentences
[2023-06-26 23:50:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:50:49] Seen 16,611 samples
[2023-06-26 23:50:49] Starting data epoch 94 in logical epoch 94
[2023-06-26 23:50:49] [data] Shuffling data
[2023-06-26 23:50:49] [data] Done reading 20,192 sentences
[2023-06-26 23:50:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:51:30] Seen 16,611 samples
[2023-06-26 23:51:30] Starting data epoch 95 in logical epoch 95
[2023-06-26 23:51:30] [data] Shuffling data
[2023-06-26 23:51:30] [data] Done reading 20,192 sentences
[2023-06-26 23:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:52:10] Seen 16,611 samples
[2023-06-26 23:52:10] Starting data epoch 96 in logical epoch 96
[2023-06-26 23:52:10] [data] Shuffling data
[2023-06-26 23:52:10] [data] Done reading 20,192 sentences
[2023-06-26 23:52:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:52:51] Seen 16,611 samples
[2023-06-26 23:52:51] Starting data epoch 97 in logical epoch 97
[2023-06-26 23:52:51] [data] Shuffling data
[2023-06-26 23:52:51] [data] Done reading 20,192 sentences
[2023-06-26 23:52:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:53:27] Ep. 97 : Up. 10000 : Sen. 15,141 : Cost 1.10872293 * 3,756,616 @ 2,556 after 37,724,311 : Time 277.05s : 13559.56 words/s : gNorm 1.0776
[2023-06-26 23:53:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.iter10000.npz
[2023-06-26 23:53:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:53:30] Saving Adam parameters
[2023-06-26 23:53:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:53:37] Seen 16,611 samples
[2023-06-26 23:53:37] Starting data epoch 98 in logical epoch 98
[2023-06-26 23:53:37] [data] Shuffling data
[2023-06-26 23:53:37] [data] Done reading 20,192 sentences
[2023-06-26 23:53:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:54:17] Seen 16,611 samples
[2023-06-26 23:54:17] Starting data epoch 99 in logical epoch 99
[2023-06-26 23:54:17] [data] Shuffling data
[2023-06-26 23:54:17] [data] Done reading 20,192 sentences
[2023-06-26 23:54:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:54:57] Seen 16,611 samples
[2023-06-26 23:54:57] Starting data epoch 100 in logical epoch 100
[2023-06-26 23:54:57] [data] Shuffling data
[2023-06-26 23:54:57] [data] Done reading 20,192 sentences
[2023-06-26 23:54:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:55:38] Seen 16,611 samples
[2023-06-26 23:55:38] Starting data epoch 101 in logical epoch 101
[2023-06-26 23:55:38] Training finished
[2023-06-26 23:55:47] [valid] Ep. 101 : Up. 10321 : cross-entropy : 121.571 : stalled 2 times (last best: 118.897)
[2023-06-26 23:56:21] [valid] Ep. 101 : Up. 10321 : translation : 0 : new best
[2023-06-26 23:56:21] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:56:22] Saving Adam parameters
[2023-06-26 23:56:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:59:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:59:37] [marian] Running on node20.datos.cluster.uy as process 39165 with command line:
[2023-06-26 23:59:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 110 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-26 23:59:37] [config] after: 0e
[2023-06-26 23:59:37] [config] after-batches: 0
[2023-06-26 23:59:37] [config] after-epochs: 110
[2023-06-26 23:59:37] [config] all-caps-every: 0
[2023-06-26 23:59:37] [config] allow-unk: false
[2023-06-26 23:59:37] [config] authors: false
[2023-06-26 23:59:37] [config] beam-size: 6
[2023-06-26 23:59:37] [config] bert-class-symbol: "[CLS]"
[2023-06-26 23:59:37] [config] bert-mask-symbol: "[MASK]"
[2023-06-26 23:59:37] [config] bert-masking-fraction: 0.15
[2023-06-26 23:59:37] [config] bert-sep-symbol: "[SEP]"
[2023-06-26 23:59:37] [config] bert-train-type-embeddings: true
[2023-06-26 23:59:37] [config] bert-type-vocab-size: 2
[2023-06-26 23:59:37] [config] build-info: ""
[2023-06-26 23:59:37] [config] check-gradient-nan: false
[2023-06-26 23:59:37] [config] check-nan: false
[2023-06-26 23:59:37] [config] cite: false
[2023-06-26 23:59:37] [config] clip-norm: 1
[2023-06-26 23:59:37] [config] cost-scaling:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] cost-type: ce-sum
[2023-06-26 23:59:37] [config] cpu-threads: 0
[2023-06-26 23:59:37] [config] data-threads: 8
[2023-06-26 23:59:37] [config] data-weighting: ""
[2023-06-26 23:59:37] [config] data-weighting-type: sentence
[2023-06-26 23:59:37] [config] dec-cell: gru
[2023-06-26 23:59:37] [config] dec-cell-base-depth: 2
[2023-06-26 23:59:37] [config] dec-cell-high-depth: 1
[2023-06-26 23:59:37] [config] dec-depth: 1
[2023-06-26 23:59:37] [config] devices:
[2023-06-26 23:59:37] [config]   - 0
[2023-06-26 23:59:37] [config] dim-emb: 512
[2023-06-26 23:59:37] [config] dim-rnn: 1024
[2023-06-26 23:59:37] [config] dim-vocabs:
[2023-06-26 23:59:37] [config]   - 16384
[2023-06-26 23:59:37] [config]   - 16384
[2023-06-26 23:59:37] [config] disp-first: 0
[2023-06-26 23:59:37] [config] disp-freq: 1000u
[2023-06-26 23:59:37] [config] disp-label-counts: true
[2023-06-26 23:59:37] [config] dropout-rnn: 0.2
[2023-06-26 23:59:37] [config] dropout-src: 0.1
[2023-06-26 23:59:37] [config] dropout-trg: 0.1
[2023-06-26 23:59:37] [config] dump-config: ""
[2023-06-26 23:59:37] [config] dynamic-gradient-scaling:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] early-stopping: 10
[2023-06-26 23:59:37] [config] early-stopping-on: first
[2023-06-26 23:59:37] [config] embedding-fix-src: false
[2023-06-26 23:59:37] [config] embedding-fix-trg: false
[2023-06-26 23:59:37] [config] embedding-normalization: false
[2023-06-26 23:59:37] [config] embedding-vectors:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] enc-cell: gru
[2023-06-26 23:59:37] [config] enc-cell-depth: 1
[2023-06-26 23:59:37] [config] enc-depth: 1
[2023-06-26 23:59:37] [config] enc-type: bidirectional
[2023-06-26 23:59:37] [config] english-title-case-every: 0
[2023-06-26 23:59:37] [config] exponential-smoothing: 0
[2023-06-26 23:59:37] [config] factor-weight: 1
[2023-06-26 23:59:37] [config] factors-combine: sum
[2023-06-26 23:59:37] [config] factors-dim-emb: 0
[2023-06-26 23:59:37] [config] gradient-checkpointing: false
[2023-06-26 23:59:37] [config] gradient-norm-average-window: 100
[2023-06-26 23:59:37] [config] guided-alignment: none
[2023-06-26 23:59:37] [config] guided-alignment-cost: mse
[2023-06-26 23:59:37] [config] guided-alignment-weight: 0.1
[2023-06-26 23:59:37] [config] ignore-model-config: false
[2023-06-26 23:59:37] [config] input-types:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] interpolate-env-vars: false
[2023-06-26 23:59:37] [config] keep-best: false
[2023-06-26 23:59:37] [config] label-smoothing: 0
[2023-06-26 23:59:37] [config] layer-normalization: true
[2023-06-26 23:59:37] [config] learn-rate: 0.0001
[2023-06-26 23:59:37] [config] lemma-dependency: ""
[2023-06-26 23:59:37] [config] lemma-dim-emb: 0
[2023-06-26 23:59:37] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-26 23:59:37] [config] log-level: info
[2023-06-26 23:59:37] [config] log-time-zone: ""
[2023-06-26 23:59:37] [config] logical-epoch:
[2023-06-26 23:59:37] [config]   - 1e
[2023-06-26 23:59:37] [config]   - 0
[2023-06-26 23:59:37] [config] lr-decay: 0
[2023-06-26 23:59:37] [config] lr-decay-freq: 50000
[2023-06-26 23:59:37] [config] lr-decay-inv-sqrt:
[2023-06-26 23:59:37] [config]   - 0
[2023-06-26 23:59:37] [config] lr-decay-repeat-warmup: false
[2023-06-26 23:59:37] [config] lr-decay-reset-optimizer: false
[2023-06-26 23:59:37] [config] lr-decay-start:
[2023-06-26 23:59:37] [config]   - 10
[2023-06-26 23:59:37] [config]   - 1
[2023-06-26 23:59:37] [config] lr-decay-strategy: epoch+stalled
[2023-06-26 23:59:37] [config] lr-report: false
[2023-06-26 23:59:37] [config] lr-warmup: 0
[2023-06-26 23:59:37] [config] lr-warmup-at-reload: false
[2023-06-26 23:59:37] [config] lr-warmup-cycle: false
[2023-06-26 23:59:37] [config] lr-warmup-start-rate: 0
[2023-06-26 23:59:37] [config] max-length: 50
[2023-06-26 23:59:37] [config] max-length-crop: false
[2023-06-26 23:59:37] [config] max-length-factor: 3
[2023-06-26 23:59:37] [config] maxi-batch: 100
[2023-06-26 23:59:37] [config] maxi-batch-sort: trg
[2023-06-26 23:59:37] [config] mini-batch: 64
[2023-06-26 23:59:37] [config] mini-batch-fit: true
[2023-06-26 23:59:37] [config] mini-batch-fit-step: 10
[2023-06-26 23:59:37] [config] mini-batch-round-up: true
[2023-06-26 23:59:37] [config] mini-batch-track-lr: false
[2023-06-26 23:59:37] [config] mini-batch-warmup: 0
[2023-06-26 23:59:37] [config] mini-batch-words: 0
[2023-06-26 23:59:37] [config] mini-batch-words-ref: 0
[2023-06-26 23:59:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:59:37] [config] multi-loss-type: sum
[2023-06-26 23:59:37] [config] n-best: false
[2023-06-26 23:59:37] [config] no-nccl: false
[2023-06-26 23:59:37] [config] no-reload: false
[2023-06-26 23:59:37] [config] no-restore-corpus: false
[2023-06-26 23:59:37] [config] normalize: 0.6
[2023-06-26 23:59:37] [config] normalize-gradient: false
[2023-06-26 23:59:37] [config] num-devices: 0
[2023-06-26 23:59:37] [config] optimizer: adam
[2023-06-26 23:59:37] [config] optimizer-delay: 1
[2023-06-26 23:59:37] [config] optimizer-params:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] output-omit-bias: false
[2023-06-26 23:59:37] [config] overwrite: false
[2023-06-26 23:59:37] [config] precision:
[2023-06-26 23:59:37] [config]   - float32
[2023-06-26 23:59:37] [config]   - float32
[2023-06-26 23:59:37] [config] pretrained-model: ""
[2023-06-26 23:59:37] [config] quantize-biases: false
[2023-06-26 23:59:37] [config] quantize-bits: 0
[2023-06-26 23:59:37] [config] quantize-log-based: false
[2023-06-26 23:59:37] [config] quantize-optimization-steps: 0
[2023-06-26 23:59:37] [config] quiet: false
[2023-06-26 23:59:37] [config] quiet-translation: true
[2023-06-26 23:59:37] [config] relative-paths: false
[2023-06-26 23:59:37] [config] right-left: false
[2023-06-26 23:59:37] [config] save-freq: 10000u
[2023-06-26 23:59:37] [config] seed: 1234
[2023-06-26 23:59:37] [config] sentencepiece-alphas:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] sentencepiece-max-lines: 2000000
[2023-06-26 23:59:37] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-26 23:59:37] [config] sharding: global
[2023-06-26 23:59:37] [config] shuffle: data
[2023-06-26 23:59:37] [config] shuffle-in-ram: false
[2023-06-26 23:59:37] [config] sigterm: save-and-exit
[2023-06-26 23:59:37] [config] skip: false
[2023-06-26 23:59:37] [config] sqlite: ""
[2023-06-26 23:59:37] [config] sqlite-drop: false
[2023-06-26 23:59:37] [config] sync-freq: 200u
[2023-06-26 23:59:37] [config] sync-sgd: false
[2023-06-26 23:59:37] [config] tempdir: /tmp
[2023-06-26 23:59:37] [config] tied-embeddings: false
[2023-06-26 23:59:37] [config] tied-embeddings-all: true
[2023-06-26 23:59:37] [config] tied-embeddings-src: false
[2023-06-26 23:59:37] [config] train-embedder-rank:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] train-sets:
[2023-06-26 23:59:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-26 23:59:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-26 23:59:37] [config] transformer-aan-activation: swish
[2023-06-26 23:59:37] [config] transformer-aan-depth: 2
[2023-06-26 23:59:37] [config] transformer-aan-nogate: false
[2023-06-26 23:59:37] [config] transformer-decoder-autoreg: self-attention
[2023-06-26 23:59:37] [config] transformer-decoder-dim-ffn: 0
[2023-06-26 23:59:37] [config] transformer-decoder-ffn-depth: 0
[2023-06-26 23:59:37] [config] transformer-depth-scaling: false
[2023-06-26 23:59:37] [config] transformer-dim-aan: 2048
[2023-06-26 23:59:37] [config] transformer-dim-ffn: 2048
[2023-06-26 23:59:37] [config] transformer-dropout: 0
[2023-06-26 23:59:37] [config] transformer-dropout-attention: 0
[2023-06-26 23:59:37] [config] transformer-dropout-ffn: 0
[2023-06-26 23:59:37] [config] transformer-ffn-activation: swish
[2023-06-26 23:59:37] [config] transformer-ffn-depth: 2
[2023-06-26 23:59:37] [config] transformer-guided-alignment-layer: last
[2023-06-26 23:59:37] [config] transformer-heads: 8
[2023-06-26 23:59:37] [config] transformer-no-projection: false
[2023-06-26 23:59:37] [config] transformer-pool: false
[2023-06-26 23:59:37] [config] transformer-postprocess: dan
[2023-06-26 23:59:37] [config] transformer-postprocess-emb: d
[2023-06-26 23:59:37] [config] transformer-postprocess-top: ""
[2023-06-26 23:59:37] [config] transformer-preprocess: ""
[2023-06-26 23:59:37] [config] transformer-tied-layers:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] transformer-train-position-embeddings: false
[2023-06-26 23:59:37] [config] tsv: false
[2023-06-26 23:59:37] [config] tsv-fields: 0
[2023-06-26 23:59:37] [config] type: amun
[2023-06-26 23:59:37] [config] ulr: false
[2023-06-26 23:59:37] [config] ulr-dim-emb: 0
[2023-06-26 23:59:37] [config] ulr-dropout: 0
[2023-06-26 23:59:37] [config] ulr-keys-vectors: ""
[2023-06-26 23:59:37] [config] ulr-query-vectors: ""
[2023-06-26 23:59:37] [config] ulr-softmax-temperature: 1
[2023-06-26 23:59:37] [config] ulr-trainable-transformation: false
[2023-06-26 23:59:37] [config] unlikelihood-loss: false
[2023-06-26 23:59:37] [config] valid-freq: 5000000
[2023-06-26 23:59:37] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-26 23:59:37] [config] valid-max-length: 1000
[2023-06-26 23:59:37] [config] valid-metrics:
[2023-06-26 23:59:37] [config]   - cross-entropy
[2023-06-26 23:59:37] [config]   - translation
[2023-06-26 23:59:37] [config] valid-mini-batch: 32
[2023-06-26 23:59:37] [config] valid-reset-stalled: false
[2023-06-26 23:59:37] [config] valid-script-args:
[2023-06-26 23:59:37] [config]   []
[2023-06-26 23:59:37] [config] valid-script-path: ""
[2023-06-26 23:59:37] [config] valid-sets:
[2023-06-26 23:59:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-26 23:59:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-26 23:59:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-26 23:59:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:59:37] [config] vocabs:
[2023-06-26 23:59:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:59:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:59:37] [config] word-penalty: 0
[2023-06-26 23:59:37] [config] word-scores: false
[2023-06-26 23:59:37] [config] workspace: 3000
[2023-06-26 23:59:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-26 23:59:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:59:37] [training] Using single-device training
[2023-06-26 23:59:37] Synced seed 1234
[2023-06-26 23:59:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-26 23:59:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-26 23:59:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-26 23:59:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-26 23:59:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-26 23:59:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:59:38] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:59:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:59:38] [comm] Using global sharding
[2023-06-26 23:59:38] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:59:38] [training] Using 1 GPUs
[2023-06-26 23:59:38] [logits] Applying loss function for 1 factor(s)
[2023-06-26 23:59:38] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:59:38] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-26 23:59:38] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:59:51] [batching] Done. Typical MB size is 6,418 target words
[2023-06-26 23:59:51] [valid] No post-processing script given for validating translator
[2023-06-26 23:59:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-26 23:59:51] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-26 23:59:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-26 23:59:51] [comm] Using global sharding
[2023-06-26 23:59:51] [comm] NCCLCommunicators constructed successfully
[2023-06-26 23:59:51] [training] Using 1 GPUs
[2023-06-26 23:59:51] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-26 23:59:52] Loading Adam parameters
[2023-06-26 23:59:52] [memory] Reserving 322 MB, device gpu0
[2023-06-26 23:59:52] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:59:52] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-26 23:59:52] [data] Restoring the corpus state to epoch 101, batch 10321
[2023-06-26 23:59:52] [data] Shuffling data
[2023-06-26 23:59:52] [data] Done reading 20,192 sentences
[2023-06-26 23:59:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-26 23:59:52] Training started
[2023-06-26 23:59:52] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-26 23:59:52] [memory] Reserving 161 MB, device gpu0
[2023-06-26 23:59:53] Parameter type float32, optimization type float32, casting types false
[2023-06-27 00:00:29] Seen 16,611 samples
[2023-06-27 00:00:29] Starting data epoch 102 in logical epoch 102
[2023-06-27 00:00:29] [data] Shuffling data
[2023-06-27 00:00:29] [data] Done reading 20,192 sentences
[2023-06-27 00:00:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:01:10] Seen 16,611 samples
[2023-06-27 00:01:10] Starting data epoch 103 in logical epoch 103
[2023-06-27 00:01:10] [data] Shuffling data
[2023-06-27 00:01:10] [data] Done reading 20,192 sentences
[2023-06-27 00:01:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:01:50] Seen 16,611 samples
[2023-06-27 00:01:50] Starting data epoch 104 in logical epoch 104
[2023-06-27 00:01:50] [data] Shuffling data
[2023-06-27 00:01:50] [data] Done reading 20,192 sentences
[2023-06-27 00:01:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:02:30] Seen 16,611 samples
[2023-06-27 00:02:30] Starting data epoch 105 in logical epoch 105
[2023-06-27 00:02:30] [data] Shuffling data
[2023-06-27 00:02:30] [data] Done reading 20,192 sentences
[2023-06-27 00:02:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:03:11] Seen 16,611 samples
[2023-06-27 00:03:11] Starting data epoch 106 in logical epoch 106
[2023-06-27 00:03:11] [data] Shuffling data
[2023-06-27 00:03:11] [data] Done reading 20,192 sentences
[2023-06-27 00:03:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:03:51] Seen 16,611 samples
[2023-06-27 00:03:51] Starting data epoch 107 in logical epoch 107
[2023-06-27 00:03:51] [data] Shuffling data
[2023-06-27 00:03:51] [data] Done reading 20,192 sentences
[2023-06-27 00:03:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:04:15] Ep. 107 : Up. 11000 : Sen. 9,816 : Cost 0.96790022 * 3,772,650 @ 2,527 after 41,496,961 : Time 264.57s : 14259.64 words/s : gNorm 1.0100
[2023-06-27 00:04:32] Seen 16,611 samples
[2023-06-27 00:04:32] Starting data epoch 108 in logical epoch 108
[2023-06-27 00:04:32] [data] Shuffling data
[2023-06-27 00:04:32] [data] Done reading 20,192 sentences
[2023-06-27 00:04:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:05:12] Seen 16,611 samples
[2023-06-27 00:05:12] Starting data epoch 109 in logical epoch 109
[2023-06-27 00:05:12] [data] Shuffling data
[2023-06-27 00:05:12] [data] Done reading 20,192 sentences
[2023-06-27 00:05:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:05:53] Seen 16,611 samples
[2023-06-27 00:05:53] Starting data epoch 110 in logical epoch 110
[2023-06-27 00:05:53] [data] Shuffling data
[2023-06-27 00:05:53] [data] Done reading 20,192 sentences
[2023-06-27 00:05:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:06:34] Seen 16,611 samples
[2023-06-27 00:06:34] Starting data epoch 111 in logical epoch 111
[2023-06-27 00:06:34] Training finished
[2023-06-27 00:06:42] [valid] Ep. 111 : Up. 11355 : cross-entropy : 122.385 : stalled 3 times (last best: 118.897)
[2023-06-27 00:07:18] [valid] Ep. 111 : Up. 11355 : translation : 0 : new best
[2023-06-27 00:07:18] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 00:07:19] Saving Adam parameters
[2023-06-27 00:07:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 00:10:33] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 00:10:33] [marian] Running on node20.datos.cluster.uy as process 40176 with command line:
[2023-06-27 00:10:33] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 120 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 00:10:33] [config] after: 0e
[2023-06-27 00:10:33] [config] after-batches: 0
[2023-06-27 00:10:33] [config] after-epochs: 120
[2023-06-27 00:10:33] [config] all-caps-every: 0
[2023-06-27 00:10:33] [config] allow-unk: false
[2023-06-27 00:10:33] [config] authors: false
[2023-06-27 00:10:33] [config] beam-size: 6
[2023-06-27 00:10:33] [config] bert-class-symbol: "[CLS]"
[2023-06-27 00:10:33] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 00:10:33] [config] bert-masking-fraction: 0.15
[2023-06-27 00:10:33] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 00:10:33] [config] bert-train-type-embeddings: true
[2023-06-27 00:10:33] [config] bert-type-vocab-size: 2
[2023-06-27 00:10:33] [config] build-info: ""
[2023-06-27 00:10:33] [config] check-gradient-nan: false
[2023-06-27 00:10:33] [config] check-nan: false
[2023-06-27 00:10:33] [config] cite: false
[2023-06-27 00:10:33] [config] clip-norm: 1
[2023-06-27 00:10:33] [config] cost-scaling:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] cost-type: ce-sum
[2023-06-27 00:10:33] [config] cpu-threads: 0
[2023-06-27 00:10:33] [config] data-threads: 8
[2023-06-27 00:10:33] [config] data-weighting: ""
[2023-06-27 00:10:33] [config] data-weighting-type: sentence
[2023-06-27 00:10:33] [config] dec-cell: gru
[2023-06-27 00:10:33] [config] dec-cell-base-depth: 2
[2023-06-27 00:10:33] [config] dec-cell-high-depth: 1
[2023-06-27 00:10:33] [config] dec-depth: 1
[2023-06-27 00:10:33] [config] devices:
[2023-06-27 00:10:33] [config]   - 0
[2023-06-27 00:10:33] [config] dim-emb: 512
[2023-06-27 00:10:33] [config] dim-rnn: 1024
[2023-06-27 00:10:33] [config] dim-vocabs:
[2023-06-27 00:10:33] [config]   - 16384
[2023-06-27 00:10:33] [config]   - 16384
[2023-06-27 00:10:33] [config] disp-first: 0
[2023-06-27 00:10:33] [config] disp-freq: 1000u
[2023-06-27 00:10:33] [config] disp-label-counts: true
[2023-06-27 00:10:33] [config] dropout-rnn: 0.2
[2023-06-27 00:10:33] [config] dropout-src: 0.1
[2023-06-27 00:10:33] [config] dropout-trg: 0.1
[2023-06-27 00:10:33] [config] dump-config: ""
[2023-06-27 00:10:33] [config] dynamic-gradient-scaling:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] early-stopping: 10
[2023-06-27 00:10:33] [config] early-stopping-on: first
[2023-06-27 00:10:33] [config] embedding-fix-src: false
[2023-06-27 00:10:33] [config] embedding-fix-trg: false
[2023-06-27 00:10:33] [config] embedding-normalization: false
[2023-06-27 00:10:33] [config] embedding-vectors:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] enc-cell: gru
[2023-06-27 00:10:33] [config] enc-cell-depth: 1
[2023-06-27 00:10:33] [config] enc-depth: 1
[2023-06-27 00:10:33] [config] enc-type: bidirectional
[2023-06-27 00:10:33] [config] english-title-case-every: 0
[2023-06-27 00:10:33] [config] exponential-smoothing: 0
[2023-06-27 00:10:33] [config] factor-weight: 1
[2023-06-27 00:10:33] [config] factors-combine: sum
[2023-06-27 00:10:33] [config] factors-dim-emb: 0
[2023-06-27 00:10:33] [config] gradient-checkpointing: false
[2023-06-27 00:10:33] [config] gradient-norm-average-window: 100
[2023-06-27 00:10:33] [config] guided-alignment: none
[2023-06-27 00:10:33] [config] guided-alignment-cost: mse
[2023-06-27 00:10:33] [config] guided-alignment-weight: 0.1
[2023-06-27 00:10:33] [config] ignore-model-config: false
[2023-06-27 00:10:33] [config] input-types:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] interpolate-env-vars: false
[2023-06-27 00:10:33] [config] keep-best: false
[2023-06-27 00:10:33] [config] label-smoothing: 0
[2023-06-27 00:10:33] [config] layer-normalization: true
[2023-06-27 00:10:33] [config] learn-rate: 0.0001
[2023-06-27 00:10:33] [config] lemma-dependency: ""
[2023-06-27 00:10:33] [config] lemma-dim-emb: 0
[2023-06-27 00:10:33] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 00:10:33] [config] log-level: info
[2023-06-27 00:10:33] [config] log-time-zone: ""
[2023-06-27 00:10:33] [config] logical-epoch:
[2023-06-27 00:10:33] [config]   - 1e
[2023-06-27 00:10:33] [config]   - 0
[2023-06-27 00:10:33] [config] lr-decay: 0
[2023-06-27 00:10:33] [config] lr-decay-freq: 50000
[2023-06-27 00:10:33] [config] lr-decay-inv-sqrt:
[2023-06-27 00:10:33] [config]   - 0
[2023-06-27 00:10:33] [config] lr-decay-repeat-warmup: false
[2023-06-27 00:10:33] [config] lr-decay-reset-optimizer: false
[2023-06-27 00:10:33] [config] lr-decay-start:
[2023-06-27 00:10:33] [config]   - 10
[2023-06-27 00:10:33] [config]   - 1
[2023-06-27 00:10:33] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 00:10:33] [config] lr-report: false
[2023-06-27 00:10:33] [config] lr-warmup: 0
[2023-06-27 00:10:33] [config] lr-warmup-at-reload: false
[2023-06-27 00:10:33] [config] lr-warmup-cycle: false
[2023-06-27 00:10:33] [config] lr-warmup-start-rate: 0
[2023-06-27 00:10:33] [config] max-length: 50
[2023-06-27 00:10:33] [config] max-length-crop: false
[2023-06-27 00:10:33] [config] max-length-factor: 3
[2023-06-27 00:10:33] [config] maxi-batch: 100
[2023-06-27 00:10:33] [config] maxi-batch-sort: trg
[2023-06-27 00:10:33] [config] mini-batch: 64
[2023-06-27 00:10:33] [config] mini-batch-fit: true
[2023-06-27 00:10:33] [config] mini-batch-fit-step: 10
[2023-06-27 00:10:33] [config] mini-batch-round-up: true
[2023-06-27 00:10:33] [config] mini-batch-track-lr: false
[2023-06-27 00:10:33] [config] mini-batch-warmup: 0
[2023-06-27 00:10:33] [config] mini-batch-words: 0
[2023-06-27 00:10:33] [config] mini-batch-words-ref: 0
[2023-06-27 00:10:33] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 00:10:33] [config] multi-loss-type: sum
[2023-06-27 00:10:33] [config] n-best: false
[2023-06-27 00:10:33] [config] no-nccl: false
[2023-06-27 00:10:33] [config] no-reload: false
[2023-06-27 00:10:33] [config] no-restore-corpus: false
[2023-06-27 00:10:33] [config] normalize: 0.6
[2023-06-27 00:10:33] [config] normalize-gradient: false
[2023-06-27 00:10:33] [config] num-devices: 0
[2023-06-27 00:10:33] [config] optimizer: adam
[2023-06-27 00:10:33] [config] optimizer-delay: 1
[2023-06-27 00:10:33] [config] optimizer-params:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] output-omit-bias: false
[2023-06-27 00:10:33] [config] overwrite: false
[2023-06-27 00:10:33] [config] precision:
[2023-06-27 00:10:33] [config]   - float32
[2023-06-27 00:10:33] [config]   - float32
[2023-06-27 00:10:33] [config] pretrained-model: ""
[2023-06-27 00:10:33] [config] quantize-biases: false
[2023-06-27 00:10:33] [config] quantize-bits: 0
[2023-06-27 00:10:33] [config] quantize-log-based: false
[2023-06-27 00:10:33] [config] quantize-optimization-steps: 0
[2023-06-27 00:10:33] [config] quiet: false
[2023-06-27 00:10:33] [config] quiet-translation: true
[2023-06-27 00:10:33] [config] relative-paths: false
[2023-06-27 00:10:33] [config] right-left: false
[2023-06-27 00:10:33] [config] save-freq: 10000u
[2023-06-27 00:10:33] [config] seed: 1234
[2023-06-27 00:10:33] [config] sentencepiece-alphas:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] sentencepiece-max-lines: 2000000
[2023-06-27 00:10:33] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 00:10:33] [config] sharding: global
[2023-06-27 00:10:33] [config] shuffle: data
[2023-06-27 00:10:33] [config] shuffle-in-ram: false
[2023-06-27 00:10:33] [config] sigterm: save-and-exit
[2023-06-27 00:10:33] [config] skip: false
[2023-06-27 00:10:33] [config] sqlite: ""
[2023-06-27 00:10:33] [config] sqlite-drop: false
[2023-06-27 00:10:33] [config] sync-freq: 200u
[2023-06-27 00:10:33] [config] sync-sgd: false
[2023-06-27 00:10:33] [config] tempdir: /tmp
[2023-06-27 00:10:33] [config] tied-embeddings: false
[2023-06-27 00:10:33] [config] tied-embeddings-all: true
[2023-06-27 00:10:33] [config] tied-embeddings-src: false
[2023-06-27 00:10:33] [config] train-embedder-rank:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] train-sets:
[2023-06-27 00:10:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 00:10:33] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 00:10:33] [config] transformer-aan-activation: swish
[2023-06-27 00:10:33] [config] transformer-aan-depth: 2
[2023-06-27 00:10:33] [config] transformer-aan-nogate: false
[2023-06-27 00:10:33] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 00:10:33] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 00:10:33] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 00:10:33] [config] transformer-depth-scaling: false
[2023-06-27 00:10:33] [config] transformer-dim-aan: 2048
[2023-06-27 00:10:33] [config] transformer-dim-ffn: 2048
[2023-06-27 00:10:33] [config] transformer-dropout: 0
[2023-06-27 00:10:33] [config] transformer-dropout-attention: 0
[2023-06-27 00:10:33] [config] transformer-dropout-ffn: 0
[2023-06-27 00:10:33] [config] transformer-ffn-activation: swish
[2023-06-27 00:10:33] [config] transformer-ffn-depth: 2
[2023-06-27 00:10:33] [config] transformer-guided-alignment-layer: last
[2023-06-27 00:10:33] [config] transformer-heads: 8
[2023-06-27 00:10:33] [config] transformer-no-projection: false
[2023-06-27 00:10:33] [config] transformer-pool: false
[2023-06-27 00:10:33] [config] transformer-postprocess: dan
[2023-06-27 00:10:33] [config] transformer-postprocess-emb: d
[2023-06-27 00:10:33] [config] transformer-postprocess-top: ""
[2023-06-27 00:10:33] [config] transformer-preprocess: ""
[2023-06-27 00:10:33] [config] transformer-tied-layers:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] transformer-train-position-embeddings: false
[2023-06-27 00:10:33] [config] tsv: false
[2023-06-27 00:10:33] [config] tsv-fields: 0
[2023-06-27 00:10:33] [config] type: amun
[2023-06-27 00:10:33] [config] ulr: false
[2023-06-27 00:10:33] [config] ulr-dim-emb: 0
[2023-06-27 00:10:33] [config] ulr-dropout: 0
[2023-06-27 00:10:33] [config] ulr-keys-vectors: ""
[2023-06-27 00:10:33] [config] ulr-query-vectors: ""
[2023-06-27 00:10:33] [config] ulr-softmax-temperature: 1
[2023-06-27 00:10:33] [config] ulr-trainable-transformation: false
[2023-06-27 00:10:33] [config] unlikelihood-loss: false
[2023-06-27 00:10:33] [config] valid-freq: 5000000
[2023-06-27 00:10:33] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 00:10:33] [config] valid-max-length: 1000
[2023-06-27 00:10:33] [config] valid-metrics:
[2023-06-27 00:10:33] [config]   - cross-entropy
[2023-06-27 00:10:33] [config]   - translation
[2023-06-27 00:10:33] [config] valid-mini-batch: 32
[2023-06-27 00:10:33] [config] valid-reset-stalled: false
[2023-06-27 00:10:33] [config] valid-script-args:
[2023-06-27 00:10:33] [config]   []
[2023-06-27 00:10:33] [config] valid-script-path: ""
[2023-06-27 00:10:33] [config] valid-sets:
[2023-06-27 00:10:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 00:10:33] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 00:10:33] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 00:10:33] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 00:10:33] [config] vocabs:
[2023-06-27 00:10:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 00:10:33] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 00:10:33] [config] word-penalty: 0
[2023-06-27 00:10:33] [config] word-scores: false
[2023-06-27 00:10:33] [config] workspace: 3000
[2023-06-27 00:10:33] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 00:10:33] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 00:10:33] [training] Using single-device training
[2023-06-27 00:10:33] Synced seed 1234
[2023-06-27 00:10:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 00:10:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 00:10:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 00:10:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 00:10:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 00:10:33] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 00:10:34] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 00:10:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 00:10:34] [comm] Using global sharding
[2023-06-27 00:10:34] [comm] NCCLCommunicators constructed successfully
[2023-06-27 00:10:34] [training] Using 1 GPUs
[2023-06-27 00:10:34] [logits] Applying loss function for 1 factor(s)
[2023-06-27 00:10:34] [memory] Reserving 161 MB, device gpu0
[2023-06-27 00:10:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 00:10:35] [memory] Reserving 161 MB, device gpu0
[2023-06-27 00:10:47] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 00:10:47] [valid] No post-processing script given for validating translator
[2023-06-27 00:10:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 00:10:47] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 00:10:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 00:10:47] [comm] Using global sharding
[2023-06-27 00:10:47] [comm] NCCLCommunicators constructed successfully
[2023-06-27 00:10:47] [training] Using 1 GPUs
[2023-06-27 00:10:47] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 00:10:48] Loading Adam parameters
[2023-06-27 00:10:48] [memory] Reserving 322 MB, device gpu0
[2023-06-27 00:10:48] [memory] Reserving 161 MB, device gpu0
[2023-06-27 00:10:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 00:10:48] [data] Restoring the corpus state to epoch 111, batch 11355
[2023-06-27 00:10:48] [data] Shuffling data
[2023-06-27 00:10:48] [data] Done reading 20,192 sentences
[2023-06-27 00:10:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:10:48] Training started
[2023-06-27 00:10:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 00:10:48] [memory] Reserving 161 MB, device gpu0
[2023-06-27 00:10:48] Parameter type float32, optimization type float32, casting types false
[2023-06-27 00:11:25] Seen 16,611 samples
[2023-06-27 00:11:25] Starting data epoch 112 in logical epoch 112
[2023-06-27 00:11:25] [data] Shuffling data
[2023-06-27 00:11:25] [data] Done reading 20,192 sentences
[2023-06-27 00:11:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:12:05] Seen 16,611 samples
[2023-06-27 00:12:05] Starting data epoch 113 in logical epoch 113
[2023-06-27 00:12:05] [data] Shuffling data
[2023-06-27 00:12:05] [data] Done reading 20,192 sentences
[2023-06-27 00:12:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:12:46] Seen 16,611 samples
[2023-06-27 00:12:46] Starting data epoch 114 in logical epoch 114
[2023-06-27 00:12:46] [data] Shuffling data
[2023-06-27 00:12:46] [data] Done reading 20,192 sentences
[2023-06-27 00:12:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:13:26] Seen 16,611 samples
[2023-06-27 00:13:26] Starting data epoch 115 in logical epoch 115
[2023-06-27 00:13:26] [data] Shuffling data
[2023-06-27 00:13:26] [data] Done reading 20,192 sentences
[2023-06-27 00:13:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:14:07] Seen 16,611 samples
[2023-06-27 00:14:07] Starting data epoch 116 in logical epoch 116
[2023-06-27 00:14:07] [data] Shuffling data
[2023-06-27 00:14:07] [data] Done reading 20,192 sentences
[2023-06-27 00:14:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:14:47] Seen 16,611 samples
[2023-06-27 00:14:47] Starting data epoch 117 in logical epoch 117
[2023-06-27 00:14:47] [data] Shuffling data
[2023-06-27 00:14:47] [data] Done reading 20,192 sentences
[2023-06-27 00:14:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:14:58] Ep. 117 : Up. 12000 : Sen. 4,083 : Cost 0.84167093 * 3,760,246 @ 5,827 after 45,257,207 : Time 250.84s : 14990.39 words/s : gNorm 1.0328
[2023-06-27 00:15:28] Seen 16,611 samples
[2023-06-27 00:15:28] Starting data epoch 118 in logical epoch 118
[2023-06-27 00:15:28] [data] Shuffling data
[2023-06-27 00:15:28] [data] Done reading 20,192 sentences
[2023-06-27 00:15:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:16:08] Seen 16,611 samples
[2023-06-27 00:16:08] Starting data epoch 119 in logical epoch 119
[2023-06-27 00:16:08] [data] Shuffling data
[2023-06-27 00:16:08] [data] Done reading 20,192 sentences
[2023-06-27 00:16:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:16:49] Seen 16,611 samples
[2023-06-27 00:16:49] Starting data epoch 120 in logical epoch 120
[2023-06-27 00:16:49] [data] Shuffling data
[2023-06-27 00:16:49] [data] Done reading 20,192 sentences
[2023-06-27 00:16:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 00:17:30] Seen 16,611 samples
[2023-06-27 00:17:30] Starting data epoch 121 in logical epoch 121
[2023-06-27 00:17:30] Training finished
[2023-06-27 00:17:38] [valid] Ep. 121 : Up. 12388 : cross-entropy : 123.85 : stalled 4 times (last best: 118.897)
[2023-06-27 00:18:13] [valid] Ep. 121 : Up. 12388 : translation : 0 : new best
[2023-06-27 00:18:13] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 00:18:15] Saving Adam parameters
[2023-06-27 00:18:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 07:35:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 07:35:41] [marian] Running on node20.datos.cluster.uy as process 27917 with command line:
[2023-06-27 07:35:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 07:35:41] [config] after: 0e
[2023-06-27 07:35:41] [config] after-batches: 0
[2023-06-27 07:35:41] [config] after-epochs: 10
[2023-06-27 07:35:41] [config] all-caps-every: 0
[2023-06-27 07:35:41] [config] allow-unk: false
[2023-06-27 07:35:41] [config] authors: false
[2023-06-27 07:35:41] [config] beam-size: 6
[2023-06-27 07:35:41] [config] bert-class-symbol: "[CLS]"
[2023-06-27 07:35:41] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 07:35:41] [config] bert-masking-fraction: 0.15
[2023-06-27 07:35:41] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 07:35:41] [config] bert-train-type-embeddings: true
[2023-06-27 07:35:41] [config] bert-type-vocab-size: 2
[2023-06-27 07:35:41] [config] build-info: ""
[2023-06-27 07:35:41] [config] check-gradient-nan: false
[2023-06-27 07:35:41] [config] check-nan: false
[2023-06-27 07:35:41] [config] cite: false
[2023-06-27 07:35:41] [config] clip-norm: 1
[2023-06-27 07:35:41] [config] cost-scaling:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] cost-type: ce-sum
[2023-06-27 07:35:41] [config] cpu-threads: 0
[2023-06-27 07:35:41] [config] data-threads: 8
[2023-06-27 07:35:41] [config] data-weighting: ""
[2023-06-27 07:35:41] [config] data-weighting-type: sentence
[2023-06-27 07:35:41] [config] dec-cell: gru
[2023-06-27 07:35:41] [config] dec-cell-base-depth: 2
[2023-06-27 07:35:41] [config] dec-cell-high-depth: 1
[2023-06-27 07:35:41] [config] dec-depth: 1
[2023-06-27 07:35:41] [config] devices:
[2023-06-27 07:35:41] [config]   - 0
[2023-06-27 07:35:41] [config] dim-emb: 512
[2023-06-27 07:35:41] [config] dim-rnn: 1024
[2023-06-27 07:35:41] [config] dim-vocabs:
[2023-06-27 07:35:41] [config]   - 16384
[2023-06-27 07:35:41] [config]   - 16384
[2023-06-27 07:35:41] [config] disp-first: 0
[2023-06-27 07:35:41] [config] disp-freq: 1000u
[2023-06-27 07:35:41] [config] disp-label-counts: true
[2023-06-27 07:35:41] [config] dropout-rnn: 0.2
[2023-06-27 07:35:41] [config] dropout-src: 0.1
[2023-06-27 07:35:41] [config] dropout-trg: 0.1
[2023-06-27 07:35:41] [config] dump-config: ""
[2023-06-27 07:35:41] [config] dynamic-gradient-scaling:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] early-stopping: 10
[2023-06-27 07:35:41] [config] early-stopping-on: first
[2023-06-27 07:35:41] [config] embedding-fix-src: false
[2023-06-27 07:35:41] [config] embedding-fix-trg: false
[2023-06-27 07:35:41] [config] embedding-normalization: false
[2023-06-27 07:35:41] [config] embedding-vectors:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] enc-cell: gru
[2023-06-27 07:35:41] [config] enc-cell-depth: 1
[2023-06-27 07:35:41] [config] enc-depth: 1
[2023-06-27 07:35:41] [config] enc-type: bidirectional
[2023-06-27 07:35:41] [config] english-title-case-every: 0
[2023-06-27 07:35:41] [config] exponential-smoothing: 0
[2023-06-27 07:35:41] [config] factor-weight: 1
[2023-06-27 07:35:41] [config] factors-combine: sum
[2023-06-27 07:35:41] [config] factors-dim-emb: 0
[2023-06-27 07:35:41] [config] gradient-checkpointing: false
[2023-06-27 07:35:41] [config] gradient-norm-average-window: 100
[2023-06-27 07:35:41] [config] guided-alignment: none
[2023-06-27 07:35:41] [config] guided-alignment-cost: mse
[2023-06-27 07:35:41] [config] guided-alignment-weight: 0.1
[2023-06-27 07:35:41] [config] ignore-model-config: false
[2023-06-27 07:35:41] [config] input-types:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] interpolate-env-vars: false
[2023-06-27 07:35:41] [config] keep-best: false
[2023-06-27 07:35:41] [config] label-smoothing: 0
[2023-06-27 07:35:41] [config] layer-normalization: true
[2023-06-27 07:35:41] [config] learn-rate: 0.0001
[2023-06-27 07:35:41] [config] lemma-dependency: ""
[2023-06-27 07:35:41] [config] lemma-dim-emb: 0
[2023-06-27 07:35:41] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 07:35:41] [config] log-level: info
[2023-06-27 07:35:41] [config] log-time-zone: ""
[2023-06-27 07:35:41] [config] logical-epoch:
[2023-06-27 07:35:41] [config]   - 1e
[2023-06-27 07:35:41] [config]   - 0
[2023-06-27 07:35:41] [config] lr-decay: 0
[2023-06-27 07:35:41] [config] lr-decay-freq: 50000
[2023-06-27 07:35:41] [config] lr-decay-inv-sqrt:
[2023-06-27 07:35:41] [config]   - 0
[2023-06-27 07:35:41] [config] lr-decay-repeat-warmup: false
[2023-06-27 07:35:41] [config] lr-decay-reset-optimizer: false
[2023-06-27 07:35:41] [config] lr-decay-start:
[2023-06-27 07:35:41] [config]   - 10
[2023-06-27 07:35:41] [config]   - 1
[2023-06-27 07:35:41] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 07:35:41] [config] lr-report: false
[2023-06-27 07:35:41] [config] lr-warmup: 0
[2023-06-27 07:35:41] [config] lr-warmup-at-reload: false
[2023-06-27 07:35:41] [config] lr-warmup-cycle: false
[2023-06-27 07:35:41] [config] lr-warmup-start-rate: 0
[2023-06-27 07:35:41] [config] max-length: 50
[2023-06-27 07:35:41] [config] max-length-crop: false
[2023-06-27 07:35:41] [config] max-length-factor: 3
[2023-06-27 07:35:41] [config] maxi-batch: 100
[2023-06-27 07:35:41] [config] maxi-batch-sort: trg
[2023-06-27 07:35:41] [config] mini-batch: 64
[2023-06-27 07:35:41] [config] mini-batch-fit: true
[2023-06-27 07:35:41] [config] mini-batch-fit-step: 10
[2023-06-27 07:35:41] [config] mini-batch-round-up: true
[2023-06-27 07:35:41] [config] mini-batch-track-lr: false
[2023-06-27 07:35:41] [config] mini-batch-warmup: 0
[2023-06-27 07:35:41] [config] mini-batch-words: 0
[2023-06-27 07:35:41] [config] mini-batch-words-ref: 0
[2023-06-27 07:35:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 07:35:41] [config] multi-loss-type: sum
[2023-06-27 07:35:41] [config] n-best: false
[2023-06-27 07:35:41] [config] no-nccl: false
[2023-06-27 07:35:41] [config] no-reload: false
[2023-06-27 07:35:41] [config] no-restore-corpus: false
[2023-06-27 07:35:41] [config] normalize: 0.6
[2023-06-27 07:35:41] [config] normalize-gradient: false
[2023-06-27 07:35:41] [config] num-devices: 0
[2023-06-27 07:35:41] [config] optimizer: adam
[2023-06-27 07:35:41] [config] optimizer-delay: 1
[2023-06-27 07:35:41] [config] optimizer-params:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] output-omit-bias: false
[2023-06-27 07:35:41] [config] overwrite: false
[2023-06-27 07:35:41] [config] precision:
[2023-06-27 07:35:41] [config]   - float32
[2023-06-27 07:35:41] [config]   - float32
[2023-06-27 07:35:41] [config] pretrained-model: ""
[2023-06-27 07:35:41] [config] quantize-biases: false
[2023-06-27 07:35:41] [config] quantize-bits: 0
[2023-06-27 07:35:41] [config] quantize-log-based: false
[2023-06-27 07:35:41] [config] quantize-optimization-steps: 0
[2023-06-27 07:35:41] [config] quiet: false
[2023-06-27 07:35:41] [config] quiet-translation: true
[2023-06-27 07:35:41] [config] relative-paths: false
[2023-06-27 07:35:41] [config] right-left: false
[2023-06-27 07:35:41] [config] save-freq: 10000u
[2023-06-27 07:35:41] [config] seed: 1234
[2023-06-27 07:35:41] [config] sentencepiece-alphas:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] sentencepiece-max-lines: 2000000
[2023-06-27 07:35:41] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 07:35:41] [config] sharding: global
[2023-06-27 07:35:41] [config] shuffle: data
[2023-06-27 07:35:41] [config] shuffle-in-ram: false
[2023-06-27 07:35:41] [config] sigterm: save-and-exit
[2023-06-27 07:35:41] [config] skip: false
[2023-06-27 07:35:41] [config] sqlite: ""
[2023-06-27 07:35:41] [config] sqlite-drop: false
[2023-06-27 07:35:41] [config] sync-freq: 200u
[2023-06-27 07:35:41] [config] sync-sgd: false
[2023-06-27 07:35:41] [config] tempdir: /tmp
[2023-06-27 07:35:41] [config] tied-embeddings: false
[2023-06-27 07:35:41] [config] tied-embeddings-all: true
[2023-06-27 07:35:41] [config] tied-embeddings-src: false
[2023-06-27 07:35:41] [config] train-embedder-rank:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] train-sets:
[2023-06-27 07:35:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 07:35:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 07:35:41] [config] transformer-aan-activation: swish
[2023-06-27 07:35:41] [config] transformer-aan-depth: 2
[2023-06-27 07:35:41] [config] transformer-aan-nogate: false
[2023-06-27 07:35:41] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 07:35:41] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 07:35:41] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 07:35:41] [config] transformer-depth-scaling: false
[2023-06-27 07:35:41] [config] transformer-dim-aan: 2048
[2023-06-27 07:35:41] [config] transformer-dim-ffn: 2048
[2023-06-27 07:35:41] [config] transformer-dropout: 0
[2023-06-27 07:35:41] [config] transformer-dropout-attention: 0
[2023-06-27 07:35:41] [config] transformer-dropout-ffn: 0
[2023-06-27 07:35:41] [config] transformer-ffn-activation: swish
[2023-06-27 07:35:41] [config] transformer-ffn-depth: 2
[2023-06-27 07:35:41] [config] transformer-guided-alignment-layer: last
[2023-06-27 07:35:41] [config] transformer-heads: 8
[2023-06-27 07:35:41] [config] transformer-no-projection: false
[2023-06-27 07:35:41] [config] transformer-pool: false
[2023-06-27 07:35:41] [config] transformer-postprocess: dan
[2023-06-27 07:35:41] [config] transformer-postprocess-emb: d
[2023-06-27 07:35:41] [config] transformer-postprocess-top: ""
[2023-06-27 07:35:41] [config] transformer-preprocess: ""
[2023-06-27 07:35:41] [config] transformer-tied-layers:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] transformer-train-position-embeddings: false
[2023-06-27 07:35:41] [config] tsv: false
[2023-06-27 07:35:41] [config] tsv-fields: 0
[2023-06-27 07:35:41] [config] type: amun
[2023-06-27 07:35:41] [config] ulr: false
[2023-06-27 07:35:41] [config] ulr-dim-emb: 0
[2023-06-27 07:35:41] [config] ulr-dropout: 0
[2023-06-27 07:35:41] [config] ulr-keys-vectors: ""
[2023-06-27 07:35:41] [config] ulr-query-vectors: ""
[2023-06-27 07:35:41] [config] ulr-softmax-temperature: 1
[2023-06-27 07:35:41] [config] ulr-trainable-transformation: false
[2023-06-27 07:35:41] [config] unlikelihood-loss: false
[2023-06-27 07:35:41] [config] valid-freq: 5000000
[2023-06-27 07:35:41] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 07:35:41] [config] valid-max-length: 1000
[2023-06-27 07:35:41] [config] valid-metrics:
[2023-06-27 07:35:41] [config]   - cross-entropy
[2023-06-27 07:35:41] [config]   - translation
[2023-06-27 07:35:41] [config] valid-mini-batch: 32
[2023-06-27 07:35:41] [config] valid-reset-stalled: false
[2023-06-27 07:35:41] [config] valid-script-args:
[2023-06-27 07:35:41] [config]   []
[2023-06-27 07:35:41] [config] valid-script-path: ""
[2023-06-27 07:35:41] [config] valid-sets:
[2023-06-27 07:35:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 07:35:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 07:35:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 07:35:41] [config] vocabs:
[2023-06-27 07:35:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 07:35:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 07:35:41] [config] word-penalty: 0
[2023-06-27 07:35:41] [config] word-scores: false
[2023-06-27 07:35:41] [config] workspace: 3000
[2023-06-27 07:35:41] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 07:35:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 07:35:41] [training] Using single-device training
[2023-06-27 07:35:42] Synced seed 1234
[2023-06-27 07:35:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 07:35:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 07:35:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 07:35:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 07:35:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 07:35:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 07:35:43] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 07:35:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 07:35:44] [comm] Using global sharding
[2023-06-27 07:35:44] [comm] NCCLCommunicators constructed successfully
[2023-06-27 07:35:44] [training] Using 1 GPUs
[2023-06-27 07:35:44] [logits] Applying loss function for 1 factor(s)
[2023-06-27 07:35:44] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:35:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 07:35:47] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:35:59] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 07:35:59] [valid] No post-processing script given for validating translator
[2023-06-27 07:35:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 07:35:59] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 07:35:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 07:35:59] [comm] Using global sharding
[2023-06-27 07:35:59] [comm] NCCLCommunicators constructed successfully
[2023-06-27 07:35:59] [training] Using 1 GPUs
[2023-06-27 07:35:59] Training started
[2023-06-27 07:35:59] [data] Shuffling data
[2023-06-27 07:36:00] [data] Done reading 20,192 sentences
[2023-06-27 07:36:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:36:00] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 07:36:00] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:36:00] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:36:00] Parameter type float32, optimization type float32, casting types false
[2023-06-27 07:36:00] Allocating memory for Adam-specific shards
[2023-06-27 07:36:00] [memory] Reserving 322 MB, device gpu0
[2023-06-27 07:36:36] Seen 16,611 samples
[2023-06-27 07:36:36] Starting data epoch 2 in logical epoch 2
[2023-06-27 07:36:36] [data] Shuffling data
[2023-06-27 07:36:36] [data] Done reading 20,192 sentences
[2023-06-27 07:36:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:37:11] Seen 16,611 samples
[2023-06-27 07:37:11] Starting data epoch 3 in logical epoch 3
[2023-06-27 07:37:11] [data] Shuffling data
[2023-06-27 07:37:11] [data] Done reading 20,192 sentences
[2023-06-27 07:37:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:37:47] Seen 16,611 samples
[2023-06-27 07:37:47] Starting data epoch 4 in logical epoch 4
[2023-06-27 07:37:47] [data] Shuffling data
[2023-06-27 07:37:47] [data] Done reading 20,192 sentences
[2023-06-27 07:37:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:38:23] Seen 16,611 samples
[2023-06-27 07:38:23] Starting data epoch 5 in logical epoch 5
[2023-06-27 07:38:23] [data] Shuffling data
[2023-06-27 07:38:23] [data] Done reading 20,192 sentences
[2023-06-27 07:38:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:39:00] Seen 16,611 samples
[2023-06-27 07:39:00] Starting data epoch 6 in logical epoch 6
[2023-06-27 07:39:00] [data] Shuffling data
[2023-06-27 07:39:00] [data] Done reading 20,192 sentences
[2023-06-27 07:39:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:39:39] Seen 16,611 samples
[2023-06-27 07:39:39] Starting data epoch 7 in logical epoch 7
[2023-06-27 07:39:39] [data] Shuffling data
[2023-06-27 07:39:39] [data] Done reading 20,192 sentences
[2023-06-27 07:39:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:40:19] Seen 16,611 samples
[2023-06-27 07:40:19] Starting data epoch 8 in logical epoch 8
[2023-06-27 07:40:19] [data] Shuffling data
[2023-06-27 07:40:19] [data] Done reading 20,192 sentences
[2023-06-27 07:40:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:40:59] Seen 16,611 samples
[2023-06-27 07:40:59] Starting data epoch 9 in logical epoch 9
[2023-06-27 07:40:59] [data] Shuffling data
[2023-06-27 07:40:59] [data] Done reading 20,192 sentences
[2023-06-27 07:40:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:41:40] Seen 16,611 samples
[2023-06-27 07:41:40] Starting data epoch 10 in logical epoch 10
[2023-06-27 07:41:40] [data] Shuffling data
[2023-06-27 07:41:40] [data] Done reading 20,192 sentences
[2023-06-27 07:41:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:42:07] Ep. 10 : Up. 1000 : Sen. 11,290 : Cost 5.65243578 * 3,775,466 @ 3,758 after 3,775,466 : Time 368.21s : 10253.55 words/s : gNorm 1.1466
[2023-06-27 07:42:20] Seen 16,611 samples
[2023-06-27 07:42:20] Starting data epoch 11 in logical epoch 11
[2023-06-27 07:42:20] Training finished
[2023-06-27 07:42:28] [valid] Ep. 11 : Up. 1033 : cross-entropy : 150.171 : new best
[2023-06-27 07:43:46] [valid] Ep. 11 : Up. 1033 : translation : 0 : new best
[2023-06-27 07:43:46] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 07:43:48] Saving Adam parameters
[2023-06-27 07:43:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 07:49:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 07:49:05] [marian] Running on node20.datos.cluster.uy as process 29015 with command line:
[2023-06-27 07:49:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 07:49:05] [config] after: 0e
[2023-06-27 07:49:05] [config] after-batches: 0
[2023-06-27 07:49:05] [config] after-epochs: 20
[2023-06-27 07:49:05] [config] all-caps-every: 0
[2023-06-27 07:49:05] [config] allow-unk: false
[2023-06-27 07:49:05] [config] authors: false
[2023-06-27 07:49:05] [config] beam-size: 6
[2023-06-27 07:49:05] [config] bert-class-symbol: "[CLS]"
[2023-06-27 07:49:05] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 07:49:05] [config] bert-masking-fraction: 0.15
[2023-06-27 07:49:05] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 07:49:05] [config] bert-train-type-embeddings: true
[2023-06-27 07:49:05] [config] bert-type-vocab-size: 2
[2023-06-27 07:49:05] [config] build-info: ""
[2023-06-27 07:49:05] [config] check-gradient-nan: false
[2023-06-27 07:49:05] [config] check-nan: false
[2023-06-27 07:49:05] [config] cite: false
[2023-06-27 07:49:05] [config] clip-norm: 1
[2023-06-27 07:49:05] [config] cost-scaling:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] cost-type: ce-sum
[2023-06-27 07:49:05] [config] cpu-threads: 0
[2023-06-27 07:49:05] [config] data-threads: 8
[2023-06-27 07:49:05] [config] data-weighting: ""
[2023-06-27 07:49:05] [config] data-weighting-type: sentence
[2023-06-27 07:49:05] [config] dec-cell: gru
[2023-06-27 07:49:05] [config] dec-cell-base-depth: 2
[2023-06-27 07:49:05] [config] dec-cell-high-depth: 1
[2023-06-27 07:49:05] [config] dec-depth: 1
[2023-06-27 07:49:05] [config] devices:
[2023-06-27 07:49:05] [config]   - 0
[2023-06-27 07:49:05] [config] dim-emb: 512
[2023-06-27 07:49:05] [config] dim-rnn: 1024
[2023-06-27 07:49:05] [config] dim-vocabs:
[2023-06-27 07:49:05] [config]   - 16384
[2023-06-27 07:49:05] [config]   - 16384
[2023-06-27 07:49:05] [config] disp-first: 0
[2023-06-27 07:49:05] [config] disp-freq: 1000u
[2023-06-27 07:49:05] [config] disp-label-counts: true
[2023-06-27 07:49:05] [config] dropout-rnn: 0.2
[2023-06-27 07:49:05] [config] dropout-src: 0.1
[2023-06-27 07:49:05] [config] dropout-trg: 0.1
[2023-06-27 07:49:05] [config] dump-config: ""
[2023-06-27 07:49:05] [config] dynamic-gradient-scaling:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] early-stopping: 10
[2023-06-27 07:49:05] [config] early-stopping-on: first
[2023-06-27 07:49:05] [config] embedding-fix-src: false
[2023-06-27 07:49:05] [config] embedding-fix-trg: false
[2023-06-27 07:49:05] [config] embedding-normalization: false
[2023-06-27 07:49:05] [config] embedding-vectors:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] enc-cell: gru
[2023-06-27 07:49:05] [config] enc-cell-depth: 1
[2023-06-27 07:49:05] [config] enc-depth: 1
[2023-06-27 07:49:05] [config] enc-type: bidirectional
[2023-06-27 07:49:05] [config] english-title-case-every: 0
[2023-06-27 07:49:05] [config] exponential-smoothing: 0
[2023-06-27 07:49:05] [config] factor-weight: 1
[2023-06-27 07:49:05] [config] factors-combine: sum
[2023-06-27 07:49:05] [config] factors-dim-emb: 0
[2023-06-27 07:49:05] [config] gradient-checkpointing: false
[2023-06-27 07:49:05] [config] gradient-norm-average-window: 100
[2023-06-27 07:49:05] [config] guided-alignment: none
[2023-06-27 07:49:05] [config] guided-alignment-cost: mse
[2023-06-27 07:49:05] [config] guided-alignment-weight: 0.1
[2023-06-27 07:49:05] [config] ignore-model-config: false
[2023-06-27 07:49:05] [config] input-types:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] interpolate-env-vars: false
[2023-06-27 07:49:05] [config] keep-best: false
[2023-06-27 07:49:05] [config] label-smoothing: 0
[2023-06-27 07:49:05] [config] layer-normalization: true
[2023-06-27 07:49:05] [config] learn-rate: 0.0001
[2023-06-27 07:49:05] [config] lemma-dependency: ""
[2023-06-27 07:49:05] [config] lemma-dim-emb: 0
[2023-06-27 07:49:05] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 07:49:05] [config] log-level: info
[2023-06-27 07:49:05] [config] log-time-zone: ""
[2023-06-27 07:49:05] [config] logical-epoch:
[2023-06-27 07:49:05] [config]   - 1e
[2023-06-27 07:49:05] [config]   - 0
[2023-06-27 07:49:05] [config] lr-decay: 0
[2023-06-27 07:49:05] [config] lr-decay-freq: 50000
[2023-06-27 07:49:05] [config] lr-decay-inv-sqrt:
[2023-06-27 07:49:05] [config]   - 0
[2023-06-27 07:49:05] [config] lr-decay-repeat-warmup: false
[2023-06-27 07:49:05] [config] lr-decay-reset-optimizer: false
[2023-06-27 07:49:05] [config] lr-decay-start:
[2023-06-27 07:49:05] [config]   - 10
[2023-06-27 07:49:05] [config]   - 1
[2023-06-27 07:49:05] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 07:49:05] [config] lr-report: false
[2023-06-27 07:49:05] [config] lr-warmup: 0
[2023-06-27 07:49:05] [config] lr-warmup-at-reload: false
[2023-06-27 07:49:05] [config] lr-warmup-cycle: false
[2023-06-27 07:49:05] [config] lr-warmup-start-rate: 0
[2023-06-27 07:49:05] [config] max-length: 50
[2023-06-27 07:49:05] [config] max-length-crop: false
[2023-06-27 07:49:05] [config] max-length-factor: 3
[2023-06-27 07:49:05] [config] maxi-batch: 100
[2023-06-27 07:49:05] [config] maxi-batch-sort: trg
[2023-06-27 07:49:05] [config] mini-batch: 64
[2023-06-27 07:49:05] [config] mini-batch-fit: true
[2023-06-27 07:49:05] [config] mini-batch-fit-step: 10
[2023-06-27 07:49:05] [config] mini-batch-round-up: true
[2023-06-27 07:49:05] [config] mini-batch-track-lr: false
[2023-06-27 07:49:05] [config] mini-batch-warmup: 0
[2023-06-27 07:49:05] [config] mini-batch-words: 0
[2023-06-27 07:49:05] [config] mini-batch-words-ref: 0
[2023-06-27 07:49:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 07:49:05] [config] multi-loss-type: sum
[2023-06-27 07:49:05] [config] n-best: false
[2023-06-27 07:49:05] [config] no-nccl: false
[2023-06-27 07:49:05] [config] no-reload: false
[2023-06-27 07:49:05] [config] no-restore-corpus: false
[2023-06-27 07:49:05] [config] normalize: 0.6
[2023-06-27 07:49:05] [config] normalize-gradient: false
[2023-06-27 07:49:05] [config] num-devices: 0
[2023-06-27 07:49:05] [config] optimizer: adam
[2023-06-27 07:49:05] [config] optimizer-delay: 1
[2023-06-27 07:49:05] [config] optimizer-params:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] output-omit-bias: false
[2023-06-27 07:49:05] [config] overwrite: false
[2023-06-27 07:49:05] [config] precision:
[2023-06-27 07:49:05] [config]   - float32
[2023-06-27 07:49:05] [config]   - float32
[2023-06-27 07:49:05] [config] pretrained-model: ""
[2023-06-27 07:49:05] [config] quantize-biases: false
[2023-06-27 07:49:05] [config] quantize-bits: 0
[2023-06-27 07:49:05] [config] quantize-log-based: false
[2023-06-27 07:49:05] [config] quantize-optimization-steps: 0
[2023-06-27 07:49:05] [config] quiet: false
[2023-06-27 07:49:05] [config] quiet-translation: true
[2023-06-27 07:49:05] [config] relative-paths: false
[2023-06-27 07:49:05] [config] right-left: false
[2023-06-27 07:49:05] [config] save-freq: 10000u
[2023-06-27 07:49:05] [config] seed: 1234
[2023-06-27 07:49:05] [config] sentencepiece-alphas:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] sentencepiece-max-lines: 2000000
[2023-06-27 07:49:05] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 07:49:05] [config] sharding: global
[2023-06-27 07:49:05] [config] shuffle: data
[2023-06-27 07:49:05] [config] shuffle-in-ram: false
[2023-06-27 07:49:05] [config] sigterm: save-and-exit
[2023-06-27 07:49:05] [config] skip: false
[2023-06-27 07:49:05] [config] sqlite: ""
[2023-06-27 07:49:05] [config] sqlite-drop: false
[2023-06-27 07:49:05] [config] sync-freq: 200u
[2023-06-27 07:49:05] [config] sync-sgd: false
[2023-06-27 07:49:05] [config] tempdir: /tmp
[2023-06-27 07:49:05] [config] tied-embeddings: false
[2023-06-27 07:49:05] [config] tied-embeddings-all: true
[2023-06-27 07:49:05] [config] tied-embeddings-src: false
[2023-06-27 07:49:05] [config] train-embedder-rank:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] train-sets:
[2023-06-27 07:49:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 07:49:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 07:49:05] [config] transformer-aan-activation: swish
[2023-06-27 07:49:05] [config] transformer-aan-depth: 2
[2023-06-27 07:49:05] [config] transformer-aan-nogate: false
[2023-06-27 07:49:05] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 07:49:05] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 07:49:05] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 07:49:05] [config] transformer-depth-scaling: false
[2023-06-27 07:49:05] [config] transformer-dim-aan: 2048
[2023-06-27 07:49:05] [config] transformer-dim-ffn: 2048
[2023-06-27 07:49:05] [config] transformer-dropout: 0
[2023-06-27 07:49:05] [config] transformer-dropout-attention: 0
[2023-06-27 07:49:05] [config] transformer-dropout-ffn: 0
[2023-06-27 07:49:05] [config] transformer-ffn-activation: swish
[2023-06-27 07:49:05] [config] transformer-ffn-depth: 2
[2023-06-27 07:49:05] [config] transformer-guided-alignment-layer: last
[2023-06-27 07:49:05] [config] transformer-heads: 8
[2023-06-27 07:49:05] [config] transformer-no-projection: false
[2023-06-27 07:49:05] [config] transformer-pool: false
[2023-06-27 07:49:05] [config] transformer-postprocess: dan
[2023-06-27 07:49:05] [config] transformer-postprocess-emb: d
[2023-06-27 07:49:05] [config] transformer-postprocess-top: ""
[2023-06-27 07:49:05] [config] transformer-preprocess: ""
[2023-06-27 07:49:05] [config] transformer-tied-layers:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] transformer-train-position-embeddings: false
[2023-06-27 07:49:05] [config] tsv: false
[2023-06-27 07:49:05] [config] tsv-fields: 0
[2023-06-27 07:49:05] [config] type: amun
[2023-06-27 07:49:05] [config] ulr: false
[2023-06-27 07:49:05] [config] ulr-dim-emb: 0
[2023-06-27 07:49:05] [config] ulr-dropout: 0
[2023-06-27 07:49:05] [config] ulr-keys-vectors: ""
[2023-06-27 07:49:05] [config] ulr-query-vectors: ""
[2023-06-27 07:49:05] [config] ulr-softmax-temperature: 1
[2023-06-27 07:49:05] [config] ulr-trainable-transformation: false
[2023-06-27 07:49:05] [config] unlikelihood-loss: false
[2023-06-27 07:49:05] [config] valid-freq: 5000000
[2023-06-27 07:49:05] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 07:49:05] [config] valid-max-length: 1000
[2023-06-27 07:49:05] [config] valid-metrics:
[2023-06-27 07:49:05] [config]   - cross-entropy
[2023-06-27 07:49:05] [config]   - translation
[2023-06-27 07:49:05] [config] valid-mini-batch: 32
[2023-06-27 07:49:05] [config] valid-reset-stalled: false
[2023-06-27 07:49:05] [config] valid-script-args:
[2023-06-27 07:49:05] [config]   []
[2023-06-27 07:49:05] [config] valid-script-path: ""
[2023-06-27 07:49:05] [config] valid-sets:
[2023-06-27 07:49:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 07:49:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 07:49:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 07:49:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 07:49:05] [config] vocabs:
[2023-06-27 07:49:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 07:49:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 07:49:05] [config] word-penalty: 0
[2023-06-27 07:49:05] [config] word-scores: false
[2023-06-27 07:49:05] [config] workspace: 3000
[2023-06-27 07:49:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 07:49:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 07:49:05] [training] Using single-device training
[2023-06-27 07:49:06] Synced seed 1234
[2023-06-27 07:49:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 07:49:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 07:49:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 07:49:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 07:49:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 07:49:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 07:49:06] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 07:49:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 07:49:06] [comm] Using global sharding
[2023-06-27 07:49:06] [comm] NCCLCommunicators constructed successfully
[2023-06-27 07:49:06] [training] Using 1 GPUs
[2023-06-27 07:49:06] [logits] Applying loss function for 1 factor(s)
[2023-06-27 07:49:06] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:49:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 07:49:07] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:49:19] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 07:49:19] [valid] No post-processing script given for validating translator
[2023-06-27 07:49:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 07:49:20] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 07:49:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 07:49:20] [comm] Using global sharding
[2023-06-27 07:49:20] [comm] NCCLCommunicators constructed successfully
[2023-06-27 07:49:20] [training] Using 1 GPUs
[2023-06-27 07:49:20] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 07:49:21] Loading Adam parameters
[2023-06-27 07:49:21] [memory] Reserving 322 MB, device gpu0
[2023-06-27 07:49:21] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:49:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 07:49:21] [data] Restoring the corpus state to epoch 11, batch 1033
[2023-06-27 07:49:21] [data] Shuffling data
[2023-06-27 07:49:21] [data] Done reading 20,192 sentences
[2023-06-27 07:49:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:49:21] Training started
[2023-06-27 07:49:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 07:49:21] [memory] Reserving 161 MB, device gpu0
[2023-06-27 07:49:22] Parameter type float32, optimization type float32, casting types false
[2023-06-27 07:49:58] Seen 16,611 samples
[2023-06-27 07:49:58] Starting data epoch 12 in logical epoch 12
[2023-06-27 07:49:58] [data] Shuffling data
[2023-06-27 07:49:58] [data] Done reading 20,192 sentences
[2023-06-27 07:49:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:50:37] Seen 16,611 samples
[2023-06-27 07:50:37] Starting data epoch 13 in logical epoch 13
[2023-06-27 07:50:37] [data] Shuffling data
[2023-06-27 07:50:37] [data] Done reading 20,192 sentences
[2023-06-27 07:50:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:51:17] Seen 16,611 samples
[2023-06-27 07:51:17] Starting data epoch 14 in logical epoch 14
[2023-06-27 07:51:17] [data] Shuffling data
[2023-06-27 07:51:17] [data] Done reading 20,192 sentences
[2023-06-27 07:51:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:51:57] Seen 16,611 samples
[2023-06-27 07:51:57] Starting data epoch 15 in logical epoch 15
[2023-06-27 07:51:57] [data] Shuffling data
[2023-06-27 07:51:57] [data] Done reading 20,192 sentences
[2023-06-27 07:51:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:52:38] Seen 16,611 samples
[2023-06-27 07:52:38] Starting data epoch 16 in logical epoch 16
[2023-06-27 07:52:38] [data] Shuffling data
[2023-06-27 07:52:38] [data] Done reading 20,192 sentences
[2023-06-27 07:52:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:53:18] Seen 16,611 samples
[2023-06-27 07:53:18] Starting data epoch 17 in logical epoch 17
[2023-06-27 07:53:18] [data] Shuffling data
[2023-06-27 07:53:18] [data] Done reading 20,192 sentences
[2023-06-27 07:53:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:53:59] Seen 16,611 samples
[2023-06-27 07:53:59] Starting data epoch 18 in logical epoch 18
[2023-06-27 07:53:59] [data] Shuffling data
[2023-06-27 07:53:59] [data] Done reading 20,192 sentences
[2023-06-27 07:53:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:54:39] Seen 16,611 samples
[2023-06-27 07:54:39] Starting data epoch 19 in logical epoch 19
[2023-06-27 07:54:39] [data] Shuffling data
[2023-06-27 07:54:39] [data] Done reading 20,192 sentences
[2023-06-27 07:54:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:55:20] Seen 16,611 samples
[2023-06-27 07:55:20] Starting data epoch 20 in logical epoch 20
[2023-06-27 07:55:20] [data] Shuffling data
[2023-06-27 07:55:20] [data] Done reading 20,192 sentences
[2023-06-27 07:55:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 07:55:35] Ep. 20 : Up. 2000 : Sen. 6,131 : Cost 4.29982090 * 3,769,706 @ 2,447 after 7,545,172 : Time 376.22s : 10019.93 words/s : gNorm 1.1690
[2023-06-27 07:56:01] Seen 16,611 samples
[2023-06-27 07:56:01] Starting data epoch 21 in logical epoch 21
[2023-06-27 07:56:01] Training finished
[2023-06-27 07:56:09] [valid] Ep. 21 : Up. 2065 : cross-entropy : 133.655 : new best
[2023-06-27 07:57:02] [valid] Ep. 21 : Up. 2065 : translation : 0 : new best
[2023-06-27 07:57:02] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 07:57:03] Saving Adam parameters
[2023-06-27 07:57:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:01:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:01:10] [marian] Running on node20.datos.cluster.uy as process 29735 with command line:
[2023-06-27 08:01:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 08:01:10] [config] after: 0e
[2023-06-27 08:01:10] [config] after-batches: 0
[2023-06-27 08:01:10] [config] after-epochs: 30
[2023-06-27 08:01:10] [config] all-caps-every: 0
[2023-06-27 08:01:10] [config] allow-unk: false
[2023-06-27 08:01:10] [config] authors: false
[2023-06-27 08:01:10] [config] beam-size: 6
[2023-06-27 08:01:10] [config] bert-class-symbol: "[CLS]"
[2023-06-27 08:01:10] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 08:01:10] [config] bert-masking-fraction: 0.15
[2023-06-27 08:01:10] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 08:01:10] [config] bert-train-type-embeddings: true
[2023-06-27 08:01:10] [config] bert-type-vocab-size: 2
[2023-06-27 08:01:10] [config] build-info: ""
[2023-06-27 08:01:10] [config] check-gradient-nan: false
[2023-06-27 08:01:10] [config] check-nan: false
[2023-06-27 08:01:10] [config] cite: false
[2023-06-27 08:01:10] [config] clip-norm: 1
[2023-06-27 08:01:10] [config] cost-scaling:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] cost-type: ce-sum
[2023-06-27 08:01:10] [config] cpu-threads: 0
[2023-06-27 08:01:10] [config] data-threads: 8
[2023-06-27 08:01:10] [config] data-weighting: ""
[2023-06-27 08:01:10] [config] data-weighting-type: sentence
[2023-06-27 08:01:10] [config] dec-cell: gru
[2023-06-27 08:01:10] [config] dec-cell-base-depth: 2
[2023-06-27 08:01:10] [config] dec-cell-high-depth: 1
[2023-06-27 08:01:10] [config] dec-depth: 1
[2023-06-27 08:01:10] [config] devices:
[2023-06-27 08:01:10] [config]   - 0
[2023-06-27 08:01:10] [config] dim-emb: 512
[2023-06-27 08:01:10] [config] dim-rnn: 1024
[2023-06-27 08:01:10] [config] dim-vocabs:
[2023-06-27 08:01:10] [config]   - 16384
[2023-06-27 08:01:10] [config]   - 16384
[2023-06-27 08:01:10] [config] disp-first: 0
[2023-06-27 08:01:10] [config] disp-freq: 1000u
[2023-06-27 08:01:10] [config] disp-label-counts: true
[2023-06-27 08:01:10] [config] dropout-rnn: 0.2
[2023-06-27 08:01:10] [config] dropout-src: 0.1
[2023-06-27 08:01:10] [config] dropout-trg: 0.1
[2023-06-27 08:01:10] [config] dump-config: ""
[2023-06-27 08:01:10] [config] dynamic-gradient-scaling:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] early-stopping: 10
[2023-06-27 08:01:10] [config] early-stopping-on: first
[2023-06-27 08:01:10] [config] embedding-fix-src: false
[2023-06-27 08:01:10] [config] embedding-fix-trg: false
[2023-06-27 08:01:10] [config] embedding-normalization: false
[2023-06-27 08:01:10] [config] embedding-vectors:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] enc-cell: gru
[2023-06-27 08:01:10] [config] enc-cell-depth: 1
[2023-06-27 08:01:10] [config] enc-depth: 1
[2023-06-27 08:01:10] [config] enc-type: bidirectional
[2023-06-27 08:01:10] [config] english-title-case-every: 0
[2023-06-27 08:01:10] [config] exponential-smoothing: 0
[2023-06-27 08:01:10] [config] factor-weight: 1
[2023-06-27 08:01:10] [config] factors-combine: sum
[2023-06-27 08:01:10] [config] factors-dim-emb: 0
[2023-06-27 08:01:10] [config] gradient-checkpointing: false
[2023-06-27 08:01:10] [config] gradient-norm-average-window: 100
[2023-06-27 08:01:10] [config] guided-alignment: none
[2023-06-27 08:01:10] [config] guided-alignment-cost: mse
[2023-06-27 08:01:10] [config] guided-alignment-weight: 0.1
[2023-06-27 08:01:10] [config] ignore-model-config: false
[2023-06-27 08:01:10] [config] input-types:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] interpolate-env-vars: false
[2023-06-27 08:01:10] [config] keep-best: false
[2023-06-27 08:01:10] [config] label-smoothing: 0
[2023-06-27 08:01:10] [config] layer-normalization: true
[2023-06-27 08:01:10] [config] learn-rate: 0.0001
[2023-06-27 08:01:10] [config] lemma-dependency: ""
[2023-06-27 08:01:10] [config] lemma-dim-emb: 0
[2023-06-27 08:01:10] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 08:01:10] [config] log-level: info
[2023-06-27 08:01:10] [config] log-time-zone: ""
[2023-06-27 08:01:10] [config] logical-epoch:
[2023-06-27 08:01:10] [config]   - 1e
[2023-06-27 08:01:10] [config]   - 0
[2023-06-27 08:01:10] [config] lr-decay: 0
[2023-06-27 08:01:10] [config] lr-decay-freq: 50000
[2023-06-27 08:01:10] [config] lr-decay-inv-sqrt:
[2023-06-27 08:01:10] [config]   - 0
[2023-06-27 08:01:10] [config] lr-decay-repeat-warmup: false
[2023-06-27 08:01:10] [config] lr-decay-reset-optimizer: false
[2023-06-27 08:01:10] [config] lr-decay-start:
[2023-06-27 08:01:10] [config]   - 10
[2023-06-27 08:01:10] [config]   - 1
[2023-06-27 08:01:10] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 08:01:10] [config] lr-report: false
[2023-06-27 08:01:10] [config] lr-warmup: 0
[2023-06-27 08:01:10] [config] lr-warmup-at-reload: false
[2023-06-27 08:01:10] [config] lr-warmup-cycle: false
[2023-06-27 08:01:10] [config] lr-warmup-start-rate: 0
[2023-06-27 08:01:10] [config] max-length: 50
[2023-06-27 08:01:10] [config] max-length-crop: false
[2023-06-27 08:01:10] [config] max-length-factor: 3
[2023-06-27 08:01:10] [config] maxi-batch: 100
[2023-06-27 08:01:10] [config] maxi-batch-sort: trg
[2023-06-27 08:01:10] [config] mini-batch: 64
[2023-06-27 08:01:10] [config] mini-batch-fit: true
[2023-06-27 08:01:10] [config] mini-batch-fit-step: 10
[2023-06-27 08:01:10] [config] mini-batch-round-up: true
[2023-06-27 08:01:10] [config] mini-batch-track-lr: false
[2023-06-27 08:01:10] [config] mini-batch-warmup: 0
[2023-06-27 08:01:10] [config] mini-batch-words: 0
[2023-06-27 08:01:10] [config] mini-batch-words-ref: 0
[2023-06-27 08:01:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:01:10] [config] multi-loss-type: sum
[2023-06-27 08:01:10] [config] n-best: false
[2023-06-27 08:01:10] [config] no-nccl: false
[2023-06-27 08:01:10] [config] no-reload: false
[2023-06-27 08:01:10] [config] no-restore-corpus: false
[2023-06-27 08:01:10] [config] normalize: 0.6
[2023-06-27 08:01:10] [config] normalize-gradient: false
[2023-06-27 08:01:10] [config] num-devices: 0
[2023-06-27 08:01:10] [config] optimizer: adam
[2023-06-27 08:01:10] [config] optimizer-delay: 1
[2023-06-27 08:01:10] [config] optimizer-params:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] output-omit-bias: false
[2023-06-27 08:01:10] [config] overwrite: false
[2023-06-27 08:01:10] [config] precision:
[2023-06-27 08:01:10] [config]   - float32
[2023-06-27 08:01:10] [config]   - float32
[2023-06-27 08:01:10] [config] pretrained-model: ""
[2023-06-27 08:01:10] [config] quantize-biases: false
[2023-06-27 08:01:10] [config] quantize-bits: 0
[2023-06-27 08:01:10] [config] quantize-log-based: false
[2023-06-27 08:01:10] [config] quantize-optimization-steps: 0
[2023-06-27 08:01:10] [config] quiet: false
[2023-06-27 08:01:10] [config] quiet-translation: true
[2023-06-27 08:01:10] [config] relative-paths: false
[2023-06-27 08:01:10] [config] right-left: false
[2023-06-27 08:01:10] [config] save-freq: 10000u
[2023-06-27 08:01:10] [config] seed: 1234
[2023-06-27 08:01:10] [config] sentencepiece-alphas:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] sentencepiece-max-lines: 2000000
[2023-06-27 08:01:10] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 08:01:10] [config] sharding: global
[2023-06-27 08:01:10] [config] shuffle: data
[2023-06-27 08:01:10] [config] shuffle-in-ram: false
[2023-06-27 08:01:10] [config] sigterm: save-and-exit
[2023-06-27 08:01:10] [config] skip: false
[2023-06-27 08:01:10] [config] sqlite: ""
[2023-06-27 08:01:10] [config] sqlite-drop: false
[2023-06-27 08:01:10] [config] sync-freq: 200u
[2023-06-27 08:01:10] [config] sync-sgd: false
[2023-06-27 08:01:10] [config] tempdir: /tmp
[2023-06-27 08:01:10] [config] tied-embeddings: false
[2023-06-27 08:01:10] [config] tied-embeddings-all: true
[2023-06-27 08:01:10] [config] tied-embeddings-src: false
[2023-06-27 08:01:10] [config] train-embedder-rank:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] train-sets:
[2023-06-27 08:01:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 08:01:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 08:01:10] [config] transformer-aan-activation: swish
[2023-06-27 08:01:10] [config] transformer-aan-depth: 2
[2023-06-27 08:01:10] [config] transformer-aan-nogate: false
[2023-06-27 08:01:10] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 08:01:10] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 08:01:10] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 08:01:10] [config] transformer-depth-scaling: false
[2023-06-27 08:01:10] [config] transformer-dim-aan: 2048
[2023-06-27 08:01:10] [config] transformer-dim-ffn: 2048
[2023-06-27 08:01:10] [config] transformer-dropout: 0
[2023-06-27 08:01:10] [config] transformer-dropout-attention: 0
[2023-06-27 08:01:10] [config] transformer-dropout-ffn: 0
[2023-06-27 08:01:10] [config] transformer-ffn-activation: swish
[2023-06-27 08:01:10] [config] transformer-ffn-depth: 2
[2023-06-27 08:01:10] [config] transformer-guided-alignment-layer: last
[2023-06-27 08:01:10] [config] transformer-heads: 8
[2023-06-27 08:01:10] [config] transformer-no-projection: false
[2023-06-27 08:01:10] [config] transformer-pool: false
[2023-06-27 08:01:10] [config] transformer-postprocess: dan
[2023-06-27 08:01:10] [config] transformer-postprocess-emb: d
[2023-06-27 08:01:10] [config] transformer-postprocess-top: ""
[2023-06-27 08:01:10] [config] transformer-preprocess: ""
[2023-06-27 08:01:10] [config] transformer-tied-layers:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] transformer-train-position-embeddings: false
[2023-06-27 08:01:10] [config] tsv: false
[2023-06-27 08:01:10] [config] tsv-fields: 0
[2023-06-27 08:01:10] [config] type: amun
[2023-06-27 08:01:10] [config] ulr: false
[2023-06-27 08:01:10] [config] ulr-dim-emb: 0
[2023-06-27 08:01:10] [config] ulr-dropout: 0
[2023-06-27 08:01:10] [config] ulr-keys-vectors: ""
[2023-06-27 08:01:10] [config] ulr-query-vectors: ""
[2023-06-27 08:01:10] [config] ulr-softmax-temperature: 1
[2023-06-27 08:01:10] [config] ulr-trainable-transformation: false
[2023-06-27 08:01:10] [config] unlikelihood-loss: false
[2023-06-27 08:01:10] [config] valid-freq: 5000000
[2023-06-27 08:01:10] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 08:01:10] [config] valid-max-length: 1000
[2023-06-27 08:01:10] [config] valid-metrics:
[2023-06-27 08:01:10] [config]   - cross-entropy
[2023-06-27 08:01:10] [config]   - translation
[2023-06-27 08:01:10] [config] valid-mini-batch: 32
[2023-06-27 08:01:10] [config] valid-reset-stalled: false
[2023-06-27 08:01:10] [config] valid-script-args:
[2023-06-27 08:01:10] [config]   []
[2023-06-27 08:01:10] [config] valid-script-path: ""
[2023-06-27 08:01:10] [config] valid-sets:
[2023-06-27 08:01:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 08:01:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 08:01:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 08:01:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:01:10] [config] vocabs:
[2023-06-27 08:01:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:01:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:01:10] [config] word-penalty: 0
[2023-06-27 08:01:10] [config] word-scores: false
[2023-06-27 08:01:10] [config] workspace: 3000
[2023-06-27 08:01:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:01:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:01:10] [training] Using single-device training
[2023-06-27 08:01:11] Synced seed 1234
[2023-06-27 08:01:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:01:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 08:01:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:01:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 08:01:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 08:01:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:01:12] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:01:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:01:12] [comm] Using global sharding
[2023-06-27 08:01:12] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:01:12] [training] Using 1 GPUs
[2023-06-27 08:01:12] [logits] Applying loss function for 1 factor(s)
[2023-06-27 08:01:12] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:01:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 08:01:13] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:01:25] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 08:01:25] [valid] No post-processing script given for validating translator
[2023-06-27 08:01:25] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:01:25] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:01:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:01:25] [comm] Using global sharding
[2023-06-27 08:01:25] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:01:25] [training] Using 1 GPUs
[2023-06-27 08:01:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:01:26] Loading Adam parameters
[2023-06-27 08:01:26] [memory] Reserving 322 MB, device gpu0
[2023-06-27 08:01:26] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:01:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:01:26] [data] Restoring the corpus state to epoch 21, batch 2065
[2023-06-27 08:01:26] [data] Shuffling data
[2023-06-27 08:01:26] [data] Done reading 20,192 sentences
[2023-06-27 08:01:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:01:26] Training started
[2023-06-27 08:01:26] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 08:01:26] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:01:27] Parameter type float32, optimization type float32, casting types false
[2023-06-27 08:02:03] Seen 16,611 samples
[2023-06-27 08:02:03] Starting data epoch 22 in logical epoch 22
[2023-06-27 08:02:03] [data] Shuffling data
[2023-06-27 08:02:03] [data] Done reading 20,192 sentences
[2023-06-27 08:02:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:02:42] Seen 16,611 samples
[2023-06-27 08:02:42] Starting data epoch 23 in logical epoch 23
[2023-06-27 08:02:42] [data] Shuffling data
[2023-06-27 08:02:42] [data] Done reading 20,192 sentences
[2023-06-27 08:02:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:03:23] Seen 16,611 samples
[2023-06-27 08:03:23] Starting data epoch 24 in logical epoch 24
[2023-06-27 08:03:23] [data] Shuffling data
[2023-06-27 08:03:23] [data] Done reading 20,192 sentences
[2023-06-27 08:03:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:04:03] Seen 16,611 samples
[2023-06-27 08:04:03] Starting data epoch 25 in logical epoch 25
[2023-06-27 08:04:03] [data] Shuffling data
[2023-06-27 08:04:03] [data] Done reading 20,192 sentences
[2023-06-27 08:04:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:04:44] Seen 16,611 samples
[2023-06-27 08:04:44] Starting data epoch 26 in logical epoch 26
[2023-06-27 08:04:44] [data] Shuffling data
[2023-06-27 08:04:44] [data] Done reading 20,192 sentences
[2023-06-27 08:04:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:05:24] Seen 16,611 samples
[2023-06-27 08:05:24] Starting data epoch 27 in logical epoch 27
[2023-06-27 08:05:24] [data] Shuffling data
[2023-06-27 08:05:24] [data] Done reading 20,192 sentences
[2023-06-27 08:05:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:06:05] Seen 16,611 samples
[2023-06-27 08:06:05] Starting data epoch 28 in logical epoch 28
[2023-06-27 08:06:05] [data] Shuffling data
[2023-06-27 08:06:05] [data] Done reading 20,192 sentences
[2023-06-27 08:06:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:06:45] Seen 16,611 samples
[2023-06-27 08:06:45] Starting data epoch 29 in logical epoch 29
[2023-06-27 08:06:45] [data] Shuffling data
[2023-06-27 08:06:46] [data] Done reading 20,192 sentences
[2023-06-27 08:06:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:07:26] Seen 16,611 samples
[2023-06-27 08:07:26] Starting data epoch 30 in logical epoch 30
[2023-06-27 08:07:26] [data] Shuffling data
[2023-06-27 08:07:26] [data] Done reading 20,192 sentences
[2023-06-27 08:07:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:07:28] Ep. 30 : Up. 3000 : Sen. 1,220 : Cost 3.50897908 * 3,769,090 @ 3,988 after 11,314,262 : Time 363.61s : 10365.82 words/s : gNorm 1.2508
[2023-06-27 08:08:06] Seen 16,611 samples
[2023-06-27 08:08:06] Starting data epoch 31 in logical epoch 31
[2023-06-27 08:08:06] Training finished
[2023-06-27 08:08:15] [valid] Ep. 31 : Up. 3096 : cross-entropy : 125.341 : new best
[2023-06-27 08:08:54] [valid] Ep. 31 : Up. 3096 : translation : 0 : new best
[2023-06-27 08:08:54] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:08:56] Saving Adam parameters
[2023-06-27 08:08:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:12:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:12:19] [marian] Running on node20.datos.cluster.uy as process 30719 with command line:
[2023-06-27 08:12:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 08:12:19] [config] after: 0e
[2023-06-27 08:12:19] [config] after-batches: 0
[2023-06-27 08:12:19] [config] after-epochs: 40
[2023-06-27 08:12:19] [config] all-caps-every: 0
[2023-06-27 08:12:19] [config] allow-unk: false
[2023-06-27 08:12:19] [config] authors: false
[2023-06-27 08:12:19] [config] beam-size: 6
[2023-06-27 08:12:19] [config] bert-class-symbol: "[CLS]"
[2023-06-27 08:12:19] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 08:12:19] [config] bert-masking-fraction: 0.15
[2023-06-27 08:12:19] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 08:12:19] [config] bert-train-type-embeddings: true
[2023-06-27 08:12:19] [config] bert-type-vocab-size: 2
[2023-06-27 08:12:19] [config] build-info: ""
[2023-06-27 08:12:19] [config] check-gradient-nan: false
[2023-06-27 08:12:19] [config] check-nan: false
[2023-06-27 08:12:19] [config] cite: false
[2023-06-27 08:12:19] [config] clip-norm: 1
[2023-06-27 08:12:19] [config] cost-scaling:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] cost-type: ce-sum
[2023-06-27 08:12:19] [config] cpu-threads: 0
[2023-06-27 08:12:19] [config] data-threads: 8
[2023-06-27 08:12:19] [config] data-weighting: ""
[2023-06-27 08:12:19] [config] data-weighting-type: sentence
[2023-06-27 08:12:19] [config] dec-cell: gru
[2023-06-27 08:12:19] [config] dec-cell-base-depth: 2
[2023-06-27 08:12:19] [config] dec-cell-high-depth: 1
[2023-06-27 08:12:19] [config] dec-depth: 1
[2023-06-27 08:12:19] [config] devices:
[2023-06-27 08:12:19] [config]   - 0
[2023-06-27 08:12:19] [config] dim-emb: 512
[2023-06-27 08:12:19] [config] dim-rnn: 1024
[2023-06-27 08:12:19] [config] dim-vocabs:
[2023-06-27 08:12:19] [config]   - 16384
[2023-06-27 08:12:19] [config]   - 16384
[2023-06-27 08:12:19] [config] disp-first: 0
[2023-06-27 08:12:19] [config] disp-freq: 1000u
[2023-06-27 08:12:19] [config] disp-label-counts: true
[2023-06-27 08:12:19] [config] dropout-rnn: 0.2
[2023-06-27 08:12:19] [config] dropout-src: 0.1
[2023-06-27 08:12:19] [config] dropout-trg: 0.1
[2023-06-27 08:12:19] [config] dump-config: ""
[2023-06-27 08:12:19] [config] dynamic-gradient-scaling:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] early-stopping: 10
[2023-06-27 08:12:19] [config] early-stopping-on: first
[2023-06-27 08:12:19] [config] embedding-fix-src: false
[2023-06-27 08:12:19] [config] embedding-fix-trg: false
[2023-06-27 08:12:19] [config] embedding-normalization: false
[2023-06-27 08:12:19] [config] embedding-vectors:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] enc-cell: gru
[2023-06-27 08:12:19] [config] enc-cell-depth: 1
[2023-06-27 08:12:19] [config] enc-depth: 1
[2023-06-27 08:12:19] [config] enc-type: bidirectional
[2023-06-27 08:12:19] [config] english-title-case-every: 0
[2023-06-27 08:12:19] [config] exponential-smoothing: 0
[2023-06-27 08:12:19] [config] factor-weight: 1
[2023-06-27 08:12:19] [config] factors-combine: sum
[2023-06-27 08:12:19] [config] factors-dim-emb: 0
[2023-06-27 08:12:19] [config] gradient-checkpointing: false
[2023-06-27 08:12:19] [config] gradient-norm-average-window: 100
[2023-06-27 08:12:19] [config] guided-alignment: none
[2023-06-27 08:12:19] [config] guided-alignment-cost: mse
[2023-06-27 08:12:19] [config] guided-alignment-weight: 0.1
[2023-06-27 08:12:19] [config] ignore-model-config: false
[2023-06-27 08:12:19] [config] input-types:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] interpolate-env-vars: false
[2023-06-27 08:12:19] [config] keep-best: false
[2023-06-27 08:12:19] [config] label-smoothing: 0
[2023-06-27 08:12:19] [config] layer-normalization: true
[2023-06-27 08:12:19] [config] learn-rate: 0.0001
[2023-06-27 08:12:19] [config] lemma-dependency: ""
[2023-06-27 08:12:19] [config] lemma-dim-emb: 0
[2023-06-27 08:12:19] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 08:12:19] [config] log-level: info
[2023-06-27 08:12:19] [config] log-time-zone: ""
[2023-06-27 08:12:19] [config] logical-epoch:
[2023-06-27 08:12:19] [config]   - 1e
[2023-06-27 08:12:19] [config]   - 0
[2023-06-27 08:12:19] [config] lr-decay: 0
[2023-06-27 08:12:19] [config] lr-decay-freq: 50000
[2023-06-27 08:12:19] [config] lr-decay-inv-sqrt:
[2023-06-27 08:12:19] [config]   - 0
[2023-06-27 08:12:19] [config] lr-decay-repeat-warmup: false
[2023-06-27 08:12:19] [config] lr-decay-reset-optimizer: false
[2023-06-27 08:12:19] [config] lr-decay-start:
[2023-06-27 08:12:19] [config]   - 10
[2023-06-27 08:12:19] [config]   - 1
[2023-06-27 08:12:19] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 08:12:19] [config] lr-report: false
[2023-06-27 08:12:19] [config] lr-warmup: 0
[2023-06-27 08:12:19] [config] lr-warmup-at-reload: false
[2023-06-27 08:12:19] [config] lr-warmup-cycle: false
[2023-06-27 08:12:19] [config] lr-warmup-start-rate: 0
[2023-06-27 08:12:19] [config] max-length: 50
[2023-06-27 08:12:19] [config] max-length-crop: false
[2023-06-27 08:12:19] [config] max-length-factor: 3
[2023-06-27 08:12:19] [config] maxi-batch: 100
[2023-06-27 08:12:19] [config] maxi-batch-sort: trg
[2023-06-27 08:12:19] [config] mini-batch: 64
[2023-06-27 08:12:19] [config] mini-batch-fit: true
[2023-06-27 08:12:19] [config] mini-batch-fit-step: 10
[2023-06-27 08:12:19] [config] mini-batch-round-up: true
[2023-06-27 08:12:19] [config] mini-batch-track-lr: false
[2023-06-27 08:12:19] [config] mini-batch-warmup: 0
[2023-06-27 08:12:19] [config] mini-batch-words: 0
[2023-06-27 08:12:19] [config] mini-batch-words-ref: 0
[2023-06-27 08:12:19] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:12:19] [config] multi-loss-type: sum
[2023-06-27 08:12:19] [config] n-best: false
[2023-06-27 08:12:19] [config] no-nccl: false
[2023-06-27 08:12:19] [config] no-reload: false
[2023-06-27 08:12:19] [config] no-restore-corpus: false
[2023-06-27 08:12:19] [config] normalize: 0.6
[2023-06-27 08:12:19] [config] normalize-gradient: false
[2023-06-27 08:12:19] [config] num-devices: 0
[2023-06-27 08:12:19] [config] optimizer: adam
[2023-06-27 08:12:19] [config] optimizer-delay: 1
[2023-06-27 08:12:19] [config] optimizer-params:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] output-omit-bias: false
[2023-06-27 08:12:19] [config] overwrite: false
[2023-06-27 08:12:19] [config] precision:
[2023-06-27 08:12:19] [config]   - float32
[2023-06-27 08:12:19] [config]   - float32
[2023-06-27 08:12:19] [config] pretrained-model: ""
[2023-06-27 08:12:19] [config] quantize-biases: false
[2023-06-27 08:12:19] [config] quantize-bits: 0
[2023-06-27 08:12:19] [config] quantize-log-based: false
[2023-06-27 08:12:19] [config] quantize-optimization-steps: 0
[2023-06-27 08:12:19] [config] quiet: false
[2023-06-27 08:12:19] [config] quiet-translation: true
[2023-06-27 08:12:19] [config] relative-paths: false
[2023-06-27 08:12:19] [config] right-left: false
[2023-06-27 08:12:19] [config] save-freq: 10000u
[2023-06-27 08:12:19] [config] seed: 1234
[2023-06-27 08:12:19] [config] sentencepiece-alphas:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] sentencepiece-max-lines: 2000000
[2023-06-27 08:12:19] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 08:12:19] [config] sharding: global
[2023-06-27 08:12:19] [config] shuffle: data
[2023-06-27 08:12:19] [config] shuffle-in-ram: false
[2023-06-27 08:12:19] [config] sigterm: save-and-exit
[2023-06-27 08:12:19] [config] skip: false
[2023-06-27 08:12:19] [config] sqlite: ""
[2023-06-27 08:12:19] [config] sqlite-drop: false
[2023-06-27 08:12:19] [config] sync-freq: 200u
[2023-06-27 08:12:19] [config] sync-sgd: false
[2023-06-27 08:12:19] [config] tempdir: /tmp
[2023-06-27 08:12:19] [config] tied-embeddings: false
[2023-06-27 08:12:19] [config] tied-embeddings-all: true
[2023-06-27 08:12:19] [config] tied-embeddings-src: false
[2023-06-27 08:12:19] [config] train-embedder-rank:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] train-sets:
[2023-06-27 08:12:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 08:12:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 08:12:19] [config] transformer-aan-activation: swish
[2023-06-27 08:12:19] [config] transformer-aan-depth: 2
[2023-06-27 08:12:19] [config] transformer-aan-nogate: false
[2023-06-27 08:12:19] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 08:12:19] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 08:12:19] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 08:12:19] [config] transformer-depth-scaling: false
[2023-06-27 08:12:19] [config] transformer-dim-aan: 2048
[2023-06-27 08:12:19] [config] transformer-dim-ffn: 2048
[2023-06-27 08:12:19] [config] transformer-dropout: 0
[2023-06-27 08:12:19] [config] transformer-dropout-attention: 0
[2023-06-27 08:12:19] [config] transformer-dropout-ffn: 0
[2023-06-27 08:12:19] [config] transformer-ffn-activation: swish
[2023-06-27 08:12:19] [config] transformer-ffn-depth: 2
[2023-06-27 08:12:19] [config] transformer-guided-alignment-layer: last
[2023-06-27 08:12:19] [config] transformer-heads: 8
[2023-06-27 08:12:19] [config] transformer-no-projection: false
[2023-06-27 08:12:19] [config] transformer-pool: false
[2023-06-27 08:12:19] [config] transformer-postprocess: dan
[2023-06-27 08:12:19] [config] transformer-postprocess-emb: d
[2023-06-27 08:12:19] [config] transformer-postprocess-top: ""
[2023-06-27 08:12:19] [config] transformer-preprocess: ""
[2023-06-27 08:12:19] [config] transformer-tied-layers:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] transformer-train-position-embeddings: false
[2023-06-27 08:12:19] [config] tsv: false
[2023-06-27 08:12:19] [config] tsv-fields: 0
[2023-06-27 08:12:19] [config] type: amun
[2023-06-27 08:12:19] [config] ulr: false
[2023-06-27 08:12:19] [config] ulr-dim-emb: 0
[2023-06-27 08:12:19] [config] ulr-dropout: 0
[2023-06-27 08:12:19] [config] ulr-keys-vectors: ""
[2023-06-27 08:12:19] [config] ulr-query-vectors: ""
[2023-06-27 08:12:19] [config] ulr-softmax-temperature: 1
[2023-06-27 08:12:19] [config] ulr-trainable-transformation: false
[2023-06-27 08:12:19] [config] unlikelihood-loss: false
[2023-06-27 08:12:19] [config] valid-freq: 5000000
[2023-06-27 08:12:19] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 08:12:19] [config] valid-max-length: 1000
[2023-06-27 08:12:19] [config] valid-metrics:
[2023-06-27 08:12:19] [config]   - cross-entropy
[2023-06-27 08:12:19] [config]   - translation
[2023-06-27 08:12:19] [config] valid-mini-batch: 32
[2023-06-27 08:12:19] [config] valid-reset-stalled: false
[2023-06-27 08:12:19] [config] valid-script-args:
[2023-06-27 08:12:19] [config]   []
[2023-06-27 08:12:19] [config] valid-script-path: ""
[2023-06-27 08:12:19] [config] valid-sets:
[2023-06-27 08:12:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 08:12:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 08:12:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 08:12:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:12:19] [config] vocabs:
[2023-06-27 08:12:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:12:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:12:19] [config] word-penalty: 0
[2023-06-27 08:12:19] [config] word-scores: false
[2023-06-27 08:12:19] [config] workspace: 3000
[2023-06-27 08:12:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:12:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:12:19] [training] Using single-device training
[2023-06-27 08:12:19] Synced seed 1234
[2023-06-27 08:12:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:12:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 08:12:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:12:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 08:12:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 08:12:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:12:20] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:12:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:12:20] [comm] Using global sharding
[2023-06-27 08:12:20] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:12:20] [training] Using 1 GPUs
[2023-06-27 08:12:20] [logits] Applying loss function for 1 factor(s)
[2023-06-27 08:12:20] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:12:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 08:12:21] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:12:33] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 08:12:33] [valid] No post-processing script given for validating translator
[2023-06-27 08:12:33] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:12:33] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:12:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:12:33] [comm] Using global sharding
[2023-06-27 08:12:33] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:12:33] [training] Using 1 GPUs
[2023-06-27 08:12:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:12:34] Loading Adam parameters
[2023-06-27 08:12:34] [memory] Reserving 322 MB, device gpu0
[2023-06-27 08:12:34] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:12:34] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:12:34] [data] Restoring the corpus state to epoch 31, batch 3096
[2023-06-27 08:12:34] [data] Shuffling data
[2023-06-27 08:12:34] [data] Done reading 20,192 sentences
[2023-06-27 08:12:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:12:34] Training started
[2023-06-27 08:12:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 08:12:34] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:12:35] Parameter type float32, optimization type float32, casting types false
[2023-06-27 08:13:11] Seen 16,611 samples
[2023-06-27 08:13:11] Starting data epoch 32 in logical epoch 32
[2023-06-27 08:13:11] [data] Shuffling data
[2023-06-27 08:13:11] [data] Done reading 20,192 sentences
[2023-06-27 08:13:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:13:51] Seen 16,611 samples
[2023-06-27 08:13:51] Starting data epoch 33 in logical epoch 33
[2023-06-27 08:13:51] [data] Shuffling data
[2023-06-27 08:13:51] [data] Done reading 20,192 sentences
[2023-06-27 08:13:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:14:31] Seen 16,611 samples
[2023-06-27 08:14:31] Starting data epoch 34 in logical epoch 34
[2023-06-27 08:14:31] [data] Shuffling data
[2023-06-27 08:14:32] [data] Done reading 20,192 sentences
[2023-06-27 08:14:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:15:12] Seen 16,611 samples
[2023-06-27 08:15:12] Starting data epoch 35 in logical epoch 35
[2023-06-27 08:15:12] [data] Shuffling data
[2023-06-27 08:15:12] [data] Done reading 20,192 sentences
[2023-06-27 08:15:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:15:53] Seen 16,611 samples
[2023-06-27 08:15:53] Starting data epoch 36 in logical epoch 36
[2023-06-27 08:15:53] [data] Shuffling data
[2023-06-27 08:15:53] [data] Done reading 20,192 sentences
[2023-06-27 08:15:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:16:33] Seen 16,611 samples
[2023-06-27 08:16:33] Starting data epoch 37 in logical epoch 37
[2023-06-27 08:16:33] [data] Shuffling data
[2023-06-27 08:16:33] [data] Done reading 20,192 sentences
[2023-06-27 08:16:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:17:14] Seen 16,611 samples
[2023-06-27 08:17:14] Starting data epoch 38 in logical epoch 38
[2023-06-27 08:17:14] [data] Shuffling data
[2023-06-27 08:17:14] [data] Done reading 20,192 sentences
[2023-06-27 08:17:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:17:54] Seen 16,611 samples
[2023-06-27 08:17:54] Starting data epoch 39 in logical epoch 39
[2023-06-27 08:17:54] [data] Shuffling data
[2023-06-27 08:17:54] [data] Done reading 20,192 sentences
[2023-06-27 08:17:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:18:26] Ep. 39 : Up. 4000 : Sen. 12,390 : Cost 2.92168641 * 3,781,080 @ 2,670 after 15,095,342 : Time 352.81s : 10717.10 words/s : gNorm 1.2180
[2023-06-27 08:18:35] Seen 16,611 samples
[2023-06-27 08:18:35] Starting data epoch 40 in logical epoch 40
[2023-06-27 08:18:35] [data] Shuffling data
[2023-06-27 08:18:35] [data] Done reading 20,192 sentences
[2023-06-27 08:18:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:19:16] Seen 16,611 samples
[2023-06-27 08:19:16] Starting data epoch 41 in logical epoch 41
[2023-06-27 08:19:16] Training finished
[2023-06-27 08:19:24] [valid] Ep. 41 : Up. 4128 : cross-entropy : 120.355 : new best
[2023-06-27 08:20:08] [valid] Ep. 41 : Up. 4128 : translation : 0 : new best
[2023-06-27 08:20:08] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:20:12] Saving Adam parameters
[2023-06-27 08:20:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:23:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:23:51] [marian] Running on node20.datos.cluster.uy as process 31391 with command line:
[2023-06-27 08:23:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 08:23:51] [config] after: 0e
[2023-06-27 08:23:51] [config] after-batches: 0
[2023-06-27 08:23:51] [config] after-epochs: 50
[2023-06-27 08:23:51] [config] all-caps-every: 0
[2023-06-27 08:23:51] [config] allow-unk: false
[2023-06-27 08:23:51] [config] authors: false
[2023-06-27 08:23:51] [config] beam-size: 6
[2023-06-27 08:23:51] [config] bert-class-symbol: "[CLS]"
[2023-06-27 08:23:51] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 08:23:51] [config] bert-masking-fraction: 0.15
[2023-06-27 08:23:51] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 08:23:51] [config] bert-train-type-embeddings: true
[2023-06-27 08:23:51] [config] bert-type-vocab-size: 2
[2023-06-27 08:23:51] [config] build-info: ""
[2023-06-27 08:23:51] [config] check-gradient-nan: false
[2023-06-27 08:23:51] [config] check-nan: false
[2023-06-27 08:23:51] [config] cite: false
[2023-06-27 08:23:51] [config] clip-norm: 1
[2023-06-27 08:23:51] [config] cost-scaling:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] cost-type: ce-sum
[2023-06-27 08:23:51] [config] cpu-threads: 0
[2023-06-27 08:23:51] [config] data-threads: 8
[2023-06-27 08:23:51] [config] data-weighting: ""
[2023-06-27 08:23:51] [config] data-weighting-type: sentence
[2023-06-27 08:23:51] [config] dec-cell: gru
[2023-06-27 08:23:51] [config] dec-cell-base-depth: 2
[2023-06-27 08:23:51] [config] dec-cell-high-depth: 1
[2023-06-27 08:23:51] [config] dec-depth: 1
[2023-06-27 08:23:51] [config] devices:
[2023-06-27 08:23:51] [config]   - 0
[2023-06-27 08:23:51] [config] dim-emb: 512
[2023-06-27 08:23:51] [config] dim-rnn: 1024
[2023-06-27 08:23:51] [config] dim-vocabs:
[2023-06-27 08:23:51] [config]   - 16384
[2023-06-27 08:23:51] [config]   - 16384
[2023-06-27 08:23:51] [config] disp-first: 0
[2023-06-27 08:23:51] [config] disp-freq: 1000u
[2023-06-27 08:23:51] [config] disp-label-counts: true
[2023-06-27 08:23:51] [config] dropout-rnn: 0.2
[2023-06-27 08:23:51] [config] dropout-src: 0.1
[2023-06-27 08:23:51] [config] dropout-trg: 0.1
[2023-06-27 08:23:51] [config] dump-config: ""
[2023-06-27 08:23:51] [config] dynamic-gradient-scaling:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] early-stopping: 10
[2023-06-27 08:23:51] [config] early-stopping-on: first
[2023-06-27 08:23:51] [config] embedding-fix-src: false
[2023-06-27 08:23:51] [config] embedding-fix-trg: false
[2023-06-27 08:23:51] [config] embedding-normalization: false
[2023-06-27 08:23:51] [config] embedding-vectors:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] enc-cell: gru
[2023-06-27 08:23:51] [config] enc-cell-depth: 1
[2023-06-27 08:23:51] [config] enc-depth: 1
[2023-06-27 08:23:51] [config] enc-type: bidirectional
[2023-06-27 08:23:51] [config] english-title-case-every: 0
[2023-06-27 08:23:51] [config] exponential-smoothing: 0
[2023-06-27 08:23:51] [config] factor-weight: 1
[2023-06-27 08:23:51] [config] factors-combine: sum
[2023-06-27 08:23:51] [config] factors-dim-emb: 0
[2023-06-27 08:23:51] [config] gradient-checkpointing: false
[2023-06-27 08:23:51] [config] gradient-norm-average-window: 100
[2023-06-27 08:23:51] [config] guided-alignment: none
[2023-06-27 08:23:51] [config] guided-alignment-cost: mse
[2023-06-27 08:23:51] [config] guided-alignment-weight: 0.1
[2023-06-27 08:23:51] [config] ignore-model-config: false
[2023-06-27 08:23:51] [config] input-types:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] interpolate-env-vars: false
[2023-06-27 08:23:51] [config] keep-best: false
[2023-06-27 08:23:51] [config] label-smoothing: 0
[2023-06-27 08:23:51] [config] layer-normalization: true
[2023-06-27 08:23:51] [config] learn-rate: 0.0001
[2023-06-27 08:23:51] [config] lemma-dependency: ""
[2023-06-27 08:23:51] [config] lemma-dim-emb: 0
[2023-06-27 08:23:51] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 08:23:51] [config] log-level: info
[2023-06-27 08:23:51] [config] log-time-zone: ""
[2023-06-27 08:23:51] [config] logical-epoch:
[2023-06-27 08:23:51] [config]   - 1e
[2023-06-27 08:23:51] [config]   - 0
[2023-06-27 08:23:51] [config] lr-decay: 0
[2023-06-27 08:23:51] [config] lr-decay-freq: 50000
[2023-06-27 08:23:51] [config] lr-decay-inv-sqrt:
[2023-06-27 08:23:51] [config]   - 0
[2023-06-27 08:23:51] [config] lr-decay-repeat-warmup: false
[2023-06-27 08:23:51] [config] lr-decay-reset-optimizer: false
[2023-06-27 08:23:51] [config] lr-decay-start:
[2023-06-27 08:23:51] [config]   - 10
[2023-06-27 08:23:51] [config]   - 1
[2023-06-27 08:23:51] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 08:23:51] [config] lr-report: false
[2023-06-27 08:23:51] [config] lr-warmup: 0
[2023-06-27 08:23:51] [config] lr-warmup-at-reload: false
[2023-06-27 08:23:51] [config] lr-warmup-cycle: false
[2023-06-27 08:23:51] [config] lr-warmup-start-rate: 0
[2023-06-27 08:23:51] [config] max-length: 50
[2023-06-27 08:23:51] [config] max-length-crop: false
[2023-06-27 08:23:51] [config] max-length-factor: 3
[2023-06-27 08:23:51] [config] maxi-batch: 100
[2023-06-27 08:23:51] [config] maxi-batch-sort: trg
[2023-06-27 08:23:51] [config] mini-batch: 64
[2023-06-27 08:23:51] [config] mini-batch-fit: true
[2023-06-27 08:23:51] [config] mini-batch-fit-step: 10
[2023-06-27 08:23:51] [config] mini-batch-round-up: true
[2023-06-27 08:23:51] [config] mini-batch-track-lr: false
[2023-06-27 08:23:51] [config] mini-batch-warmup: 0
[2023-06-27 08:23:51] [config] mini-batch-words: 0
[2023-06-27 08:23:51] [config] mini-batch-words-ref: 0
[2023-06-27 08:23:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:23:51] [config] multi-loss-type: sum
[2023-06-27 08:23:51] [config] n-best: false
[2023-06-27 08:23:51] [config] no-nccl: false
[2023-06-27 08:23:51] [config] no-reload: false
[2023-06-27 08:23:51] [config] no-restore-corpus: false
[2023-06-27 08:23:51] [config] normalize: 0.6
[2023-06-27 08:23:51] [config] normalize-gradient: false
[2023-06-27 08:23:51] [config] num-devices: 0
[2023-06-27 08:23:51] [config] optimizer: adam
[2023-06-27 08:23:51] [config] optimizer-delay: 1
[2023-06-27 08:23:51] [config] optimizer-params:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] output-omit-bias: false
[2023-06-27 08:23:51] [config] overwrite: false
[2023-06-27 08:23:51] [config] precision:
[2023-06-27 08:23:51] [config]   - float32
[2023-06-27 08:23:51] [config]   - float32
[2023-06-27 08:23:51] [config] pretrained-model: ""
[2023-06-27 08:23:51] [config] quantize-biases: false
[2023-06-27 08:23:51] [config] quantize-bits: 0
[2023-06-27 08:23:51] [config] quantize-log-based: false
[2023-06-27 08:23:51] [config] quantize-optimization-steps: 0
[2023-06-27 08:23:51] [config] quiet: false
[2023-06-27 08:23:51] [config] quiet-translation: true
[2023-06-27 08:23:51] [config] relative-paths: false
[2023-06-27 08:23:51] [config] right-left: false
[2023-06-27 08:23:51] [config] save-freq: 10000u
[2023-06-27 08:23:51] [config] seed: 1234
[2023-06-27 08:23:51] [config] sentencepiece-alphas:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] sentencepiece-max-lines: 2000000
[2023-06-27 08:23:51] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 08:23:51] [config] sharding: global
[2023-06-27 08:23:51] [config] shuffle: data
[2023-06-27 08:23:51] [config] shuffle-in-ram: false
[2023-06-27 08:23:51] [config] sigterm: save-and-exit
[2023-06-27 08:23:51] [config] skip: false
[2023-06-27 08:23:51] [config] sqlite: ""
[2023-06-27 08:23:51] [config] sqlite-drop: false
[2023-06-27 08:23:51] [config] sync-freq: 200u
[2023-06-27 08:23:51] [config] sync-sgd: false
[2023-06-27 08:23:51] [config] tempdir: /tmp
[2023-06-27 08:23:51] [config] tied-embeddings: false
[2023-06-27 08:23:51] [config] tied-embeddings-all: true
[2023-06-27 08:23:51] [config] tied-embeddings-src: false
[2023-06-27 08:23:51] [config] train-embedder-rank:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] train-sets:
[2023-06-27 08:23:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 08:23:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 08:23:51] [config] transformer-aan-activation: swish
[2023-06-27 08:23:51] [config] transformer-aan-depth: 2
[2023-06-27 08:23:51] [config] transformer-aan-nogate: false
[2023-06-27 08:23:51] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 08:23:51] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 08:23:51] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 08:23:51] [config] transformer-depth-scaling: false
[2023-06-27 08:23:51] [config] transformer-dim-aan: 2048
[2023-06-27 08:23:51] [config] transformer-dim-ffn: 2048
[2023-06-27 08:23:51] [config] transformer-dropout: 0
[2023-06-27 08:23:51] [config] transformer-dropout-attention: 0
[2023-06-27 08:23:51] [config] transformer-dropout-ffn: 0
[2023-06-27 08:23:51] [config] transformer-ffn-activation: swish
[2023-06-27 08:23:51] [config] transformer-ffn-depth: 2
[2023-06-27 08:23:51] [config] transformer-guided-alignment-layer: last
[2023-06-27 08:23:51] [config] transformer-heads: 8
[2023-06-27 08:23:51] [config] transformer-no-projection: false
[2023-06-27 08:23:51] [config] transformer-pool: false
[2023-06-27 08:23:51] [config] transformer-postprocess: dan
[2023-06-27 08:23:51] [config] transformer-postprocess-emb: d
[2023-06-27 08:23:51] [config] transformer-postprocess-top: ""
[2023-06-27 08:23:51] [config] transformer-preprocess: ""
[2023-06-27 08:23:51] [config] transformer-tied-layers:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] transformer-train-position-embeddings: false
[2023-06-27 08:23:51] [config] tsv: false
[2023-06-27 08:23:51] [config] tsv-fields: 0
[2023-06-27 08:23:51] [config] type: amun
[2023-06-27 08:23:51] [config] ulr: false
[2023-06-27 08:23:51] [config] ulr-dim-emb: 0
[2023-06-27 08:23:51] [config] ulr-dropout: 0
[2023-06-27 08:23:51] [config] ulr-keys-vectors: ""
[2023-06-27 08:23:51] [config] ulr-query-vectors: ""
[2023-06-27 08:23:51] [config] ulr-softmax-temperature: 1
[2023-06-27 08:23:51] [config] ulr-trainable-transformation: false
[2023-06-27 08:23:51] [config] unlikelihood-loss: false
[2023-06-27 08:23:51] [config] valid-freq: 5000000
[2023-06-27 08:23:51] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 08:23:51] [config] valid-max-length: 1000
[2023-06-27 08:23:51] [config] valid-metrics:
[2023-06-27 08:23:51] [config]   - cross-entropy
[2023-06-27 08:23:51] [config]   - translation
[2023-06-27 08:23:51] [config] valid-mini-batch: 32
[2023-06-27 08:23:51] [config] valid-reset-stalled: false
[2023-06-27 08:23:51] [config] valid-script-args:
[2023-06-27 08:23:51] [config]   []
[2023-06-27 08:23:51] [config] valid-script-path: ""
[2023-06-27 08:23:51] [config] valid-sets:
[2023-06-27 08:23:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 08:23:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 08:23:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 08:23:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:23:51] [config] vocabs:
[2023-06-27 08:23:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:23:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:23:51] [config] word-penalty: 0
[2023-06-27 08:23:51] [config] word-scores: false
[2023-06-27 08:23:51] [config] workspace: 3000
[2023-06-27 08:23:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:23:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:23:51] [training] Using single-device training
[2023-06-27 08:23:51] Synced seed 1234
[2023-06-27 08:23:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:23:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 08:23:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:23:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 08:23:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 08:23:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:23:52] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:23:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:23:52] [comm] Using global sharding
[2023-06-27 08:23:52] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:23:52] [training] Using 1 GPUs
[2023-06-27 08:23:52] [logits] Applying loss function for 1 factor(s)
[2023-06-27 08:23:52] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:23:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 08:23:53] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:24:05] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 08:24:05] [valid] No post-processing script given for validating translator
[2023-06-27 08:24:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:24:05] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:24:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:24:05] [comm] Using global sharding
[2023-06-27 08:24:05] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:24:05] [training] Using 1 GPUs
[2023-06-27 08:24:05] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:24:06] Loading Adam parameters
[2023-06-27 08:24:06] [memory] Reserving 322 MB, device gpu0
[2023-06-27 08:24:06] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:24:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:24:06] [data] Restoring the corpus state to epoch 41, batch 4128
[2023-06-27 08:24:06] [data] Shuffling data
[2023-06-27 08:24:06] [data] Done reading 20,192 sentences
[2023-06-27 08:24:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:24:07] Training started
[2023-06-27 08:24:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 08:24:07] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:24:07] Parameter type float32, optimization type float32, casting types false
[2023-06-27 08:24:43] Seen 16,611 samples
[2023-06-27 08:24:43] Starting data epoch 42 in logical epoch 42
[2023-06-27 08:24:43] [data] Shuffling data
[2023-06-27 08:24:43] [data] Done reading 20,192 sentences
[2023-06-27 08:24:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:25:23] Seen 16,611 samples
[2023-06-27 08:25:23] Starting data epoch 43 in logical epoch 43
[2023-06-27 08:25:23] [data] Shuffling data
[2023-06-27 08:25:23] [data] Done reading 20,192 sentences
[2023-06-27 08:25:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:26:04] Seen 16,611 samples
[2023-06-27 08:26:04] Starting data epoch 44 in logical epoch 44
[2023-06-27 08:26:04] [data] Shuffling data
[2023-06-27 08:26:04] [data] Done reading 20,192 sentences
[2023-06-27 08:26:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:26:44] Seen 16,611 samples
[2023-06-27 08:26:44] Starting data epoch 45 in logical epoch 45
[2023-06-27 08:26:44] [data] Shuffling data
[2023-06-27 08:26:44] [data] Done reading 20,192 sentences
[2023-06-27 08:26:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:27:25] Seen 16,611 samples
[2023-06-27 08:27:25] Starting data epoch 46 in logical epoch 46
[2023-06-27 08:27:25] [data] Shuffling data
[2023-06-27 08:27:25] [data] Done reading 20,192 sentences
[2023-06-27 08:27:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:28:05] Seen 16,611 samples
[2023-06-27 08:28:05] Starting data epoch 47 in logical epoch 47
[2023-06-27 08:28:05] [data] Shuffling data
[2023-06-27 08:28:05] [data] Done reading 20,192 sentences
[2023-06-27 08:28:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:28:46] Seen 16,611 samples
[2023-06-27 08:28:46] Starting data epoch 48 in logical epoch 48
[2023-06-27 08:28:46] [data] Shuffling data
[2023-06-27 08:28:46] [data] Done reading 20,192 sentences
[2023-06-27 08:28:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:29:26] Seen 16,611 samples
[2023-06-27 08:29:26] Starting data epoch 49 in logical epoch 49
[2023-06-27 08:29:26] [data] Shuffling data
[2023-06-27 08:29:26] [data] Done reading 20,192 sentences
[2023-06-27 08:29:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:29:45] Ep. 49 : Up. 5000 : Sen. 8,029 : Cost 2.44395876 * 3,779,862 @ 4,345 after 18,875,204 : Time 340.53s : 11099.80 words/s : gNorm 1.4464
[2023-06-27 08:30:07] Seen 16,611 samples
[2023-06-27 08:30:07] Starting data epoch 50 in logical epoch 50
[2023-06-27 08:30:07] [data] Shuffling data
[2023-06-27 08:30:07] [data] Done reading 20,192 sentences
[2023-06-27 08:30:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:30:48] Seen 16,611 samples
[2023-06-27 08:30:48] Starting data epoch 51 in logical epoch 51
[2023-06-27 08:30:48] Training finished
[2023-06-27 08:30:56] [valid] Ep. 51 : Up. 5157 : cross-entropy : 118.987 : new best
[2023-06-27 08:31:36] [valid] Ep. 51 : Up. 5157 : translation : 0 : new best
[2023-06-27 08:31:36] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:31:38] Saving Adam parameters
[2023-06-27 08:31:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:35:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:35:11] [marian] Running on node20.datos.cluster.uy as process 32056 with command line:
[2023-06-27 08:35:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 08:35:11] [config] after: 0e
[2023-06-27 08:35:11] [config] after-batches: 0
[2023-06-27 08:35:11] [config] after-epochs: 60
[2023-06-27 08:35:11] [config] all-caps-every: 0
[2023-06-27 08:35:11] [config] allow-unk: false
[2023-06-27 08:35:11] [config] authors: false
[2023-06-27 08:35:11] [config] beam-size: 6
[2023-06-27 08:35:11] [config] bert-class-symbol: "[CLS]"
[2023-06-27 08:35:11] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 08:35:11] [config] bert-masking-fraction: 0.15
[2023-06-27 08:35:11] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 08:35:11] [config] bert-train-type-embeddings: true
[2023-06-27 08:35:11] [config] bert-type-vocab-size: 2
[2023-06-27 08:35:11] [config] build-info: ""
[2023-06-27 08:35:11] [config] check-gradient-nan: false
[2023-06-27 08:35:11] [config] check-nan: false
[2023-06-27 08:35:11] [config] cite: false
[2023-06-27 08:35:11] [config] clip-norm: 1
[2023-06-27 08:35:11] [config] cost-scaling:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] cost-type: ce-sum
[2023-06-27 08:35:11] [config] cpu-threads: 0
[2023-06-27 08:35:11] [config] data-threads: 8
[2023-06-27 08:35:11] [config] data-weighting: ""
[2023-06-27 08:35:11] [config] data-weighting-type: sentence
[2023-06-27 08:35:11] [config] dec-cell: gru
[2023-06-27 08:35:11] [config] dec-cell-base-depth: 2
[2023-06-27 08:35:11] [config] dec-cell-high-depth: 1
[2023-06-27 08:35:11] [config] dec-depth: 1
[2023-06-27 08:35:11] [config] devices:
[2023-06-27 08:35:11] [config]   - 0
[2023-06-27 08:35:11] [config] dim-emb: 512
[2023-06-27 08:35:11] [config] dim-rnn: 1024
[2023-06-27 08:35:11] [config] dim-vocabs:
[2023-06-27 08:35:11] [config]   - 16384
[2023-06-27 08:35:11] [config]   - 16384
[2023-06-27 08:35:11] [config] disp-first: 0
[2023-06-27 08:35:11] [config] disp-freq: 1000u
[2023-06-27 08:35:11] [config] disp-label-counts: true
[2023-06-27 08:35:11] [config] dropout-rnn: 0.2
[2023-06-27 08:35:11] [config] dropout-src: 0.1
[2023-06-27 08:35:11] [config] dropout-trg: 0.1
[2023-06-27 08:35:11] [config] dump-config: ""
[2023-06-27 08:35:11] [config] dynamic-gradient-scaling:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] early-stopping: 10
[2023-06-27 08:35:11] [config] early-stopping-on: first
[2023-06-27 08:35:11] [config] embedding-fix-src: false
[2023-06-27 08:35:11] [config] embedding-fix-trg: false
[2023-06-27 08:35:11] [config] embedding-normalization: false
[2023-06-27 08:35:11] [config] embedding-vectors:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] enc-cell: gru
[2023-06-27 08:35:11] [config] enc-cell-depth: 1
[2023-06-27 08:35:11] [config] enc-depth: 1
[2023-06-27 08:35:11] [config] enc-type: bidirectional
[2023-06-27 08:35:11] [config] english-title-case-every: 0
[2023-06-27 08:35:11] [config] exponential-smoothing: 0
[2023-06-27 08:35:11] [config] factor-weight: 1
[2023-06-27 08:35:11] [config] factors-combine: sum
[2023-06-27 08:35:11] [config] factors-dim-emb: 0
[2023-06-27 08:35:11] [config] gradient-checkpointing: false
[2023-06-27 08:35:11] [config] gradient-norm-average-window: 100
[2023-06-27 08:35:11] [config] guided-alignment: none
[2023-06-27 08:35:11] [config] guided-alignment-cost: mse
[2023-06-27 08:35:11] [config] guided-alignment-weight: 0.1
[2023-06-27 08:35:11] [config] ignore-model-config: false
[2023-06-27 08:35:11] [config] input-types:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] interpolate-env-vars: false
[2023-06-27 08:35:11] [config] keep-best: false
[2023-06-27 08:35:11] [config] label-smoothing: 0
[2023-06-27 08:35:11] [config] layer-normalization: true
[2023-06-27 08:35:11] [config] learn-rate: 0.0001
[2023-06-27 08:35:11] [config] lemma-dependency: ""
[2023-06-27 08:35:11] [config] lemma-dim-emb: 0
[2023-06-27 08:35:11] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 08:35:11] [config] log-level: info
[2023-06-27 08:35:11] [config] log-time-zone: ""
[2023-06-27 08:35:11] [config] logical-epoch:
[2023-06-27 08:35:11] [config]   - 1e
[2023-06-27 08:35:11] [config]   - 0
[2023-06-27 08:35:11] [config] lr-decay: 0
[2023-06-27 08:35:11] [config] lr-decay-freq: 50000
[2023-06-27 08:35:11] [config] lr-decay-inv-sqrt:
[2023-06-27 08:35:11] [config]   - 0
[2023-06-27 08:35:11] [config] lr-decay-repeat-warmup: false
[2023-06-27 08:35:11] [config] lr-decay-reset-optimizer: false
[2023-06-27 08:35:11] [config] lr-decay-start:
[2023-06-27 08:35:11] [config]   - 10
[2023-06-27 08:35:11] [config]   - 1
[2023-06-27 08:35:11] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 08:35:11] [config] lr-report: false
[2023-06-27 08:35:11] [config] lr-warmup: 0
[2023-06-27 08:35:11] [config] lr-warmup-at-reload: false
[2023-06-27 08:35:11] [config] lr-warmup-cycle: false
[2023-06-27 08:35:11] [config] lr-warmup-start-rate: 0
[2023-06-27 08:35:11] [config] max-length: 50
[2023-06-27 08:35:11] [config] max-length-crop: false
[2023-06-27 08:35:11] [config] max-length-factor: 3
[2023-06-27 08:35:11] [config] maxi-batch: 100
[2023-06-27 08:35:11] [config] maxi-batch-sort: trg
[2023-06-27 08:35:11] [config] mini-batch: 64
[2023-06-27 08:35:11] [config] mini-batch-fit: true
[2023-06-27 08:35:11] [config] mini-batch-fit-step: 10
[2023-06-27 08:35:11] [config] mini-batch-round-up: true
[2023-06-27 08:35:11] [config] mini-batch-track-lr: false
[2023-06-27 08:35:11] [config] mini-batch-warmup: 0
[2023-06-27 08:35:11] [config] mini-batch-words: 0
[2023-06-27 08:35:11] [config] mini-batch-words-ref: 0
[2023-06-27 08:35:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:35:11] [config] multi-loss-type: sum
[2023-06-27 08:35:11] [config] n-best: false
[2023-06-27 08:35:11] [config] no-nccl: false
[2023-06-27 08:35:11] [config] no-reload: false
[2023-06-27 08:35:11] [config] no-restore-corpus: false
[2023-06-27 08:35:11] [config] normalize: 0.6
[2023-06-27 08:35:11] [config] normalize-gradient: false
[2023-06-27 08:35:11] [config] num-devices: 0
[2023-06-27 08:35:11] [config] optimizer: adam
[2023-06-27 08:35:11] [config] optimizer-delay: 1
[2023-06-27 08:35:11] [config] optimizer-params:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] output-omit-bias: false
[2023-06-27 08:35:11] [config] overwrite: false
[2023-06-27 08:35:11] [config] precision:
[2023-06-27 08:35:11] [config]   - float32
[2023-06-27 08:35:11] [config]   - float32
[2023-06-27 08:35:11] [config] pretrained-model: ""
[2023-06-27 08:35:11] [config] quantize-biases: false
[2023-06-27 08:35:11] [config] quantize-bits: 0
[2023-06-27 08:35:11] [config] quantize-log-based: false
[2023-06-27 08:35:11] [config] quantize-optimization-steps: 0
[2023-06-27 08:35:11] [config] quiet: false
[2023-06-27 08:35:11] [config] quiet-translation: true
[2023-06-27 08:35:11] [config] relative-paths: false
[2023-06-27 08:35:11] [config] right-left: false
[2023-06-27 08:35:11] [config] save-freq: 10000u
[2023-06-27 08:35:11] [config] seed: 1234
[2023-06-27 08:35:11] [config] sentencepiece-alphas:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] sentencepiece-max-lines: 2000000
[2023-06-27 08:35:11] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 08:35:11] [config] sharding: global
[2023-06-27 08:35:11] [config] shuffle: data
[2023-06-27 08:35:11] [config] shuffle-in-ram: false
[2023-06-27 08:35:11] [config] sigterm: save-and-exit
[2023-06-27 08:35:11] [config] skip: false
[2023-06-27 08:35:11] [config] sqlite: ""
[2023-06-27 08:35:11] [config] sqlite-drop: false
[2023-06-27 08:35:11] [config] sync-freq: 200u
[2023-06-27 08:35:11] [config] sync-sgd: false
[2023-06-27 08:35:11] [config] tempdir: /tmp
[2023-06-27 08:35:11] [config] tied-embeddings: false
[2023-06-27 08:35:11] [config] tied-embeddings-all: true
[2023-06-27 08:35:11] [config] tied-embeddings-src: false
[2023-06-27 08:35:11] [config] train-embedder-rank:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] train-sets:
[2023-06-27 08:35:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 08:35:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 08:35:11] [config] transformer-aan-activation: swish
[2023-06-27 08:35:11] [config] transformer-aan-depth: 2
[2023-06-27 08:35:11] [config] transformer-aan-nogate: false
[2023-06-27 08:35:11] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 08:35:11] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 08:35:11] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 08:35:11] [config] transformer-depth-scaling: false
[2023-06-27 08:35:11] [config] transformer-dim-aan: 2048
[2023-06-27 08:35:11] [config] transformer-dim-ffn: 2048
[2023-06-27 08:35:11] [config] transformer-dropout: 0
[2023-06-27 08:35:11] [config] transformer-dropout-attention: 0
[2023-06-27 08:35:11] [config] transformer-dropout-ffn: 0
[2023-06-27 08:35:11] [config] transformer-ffn-activation: swish
[2023-06-27 08:35:11] [config] transformer-ffn-depth: 2
[2023-06-27 08:35:11] [config] transformer-guided-alignment-layer: last
[2023-06-27 08:35:11] [config] transformer-heads: 8
[2023-06-27 08:35:11] [config] transformer-no-projection: false
[2023-06-27 08:35:11] [config] transformer-pool: false
[2023-06-27 08:35:11] [config] transformer-postprocess: dan
[2023-06-27 08:35:11] [config] transformer-postprocess-emb: d
[2023-06-27 08:35:11] [config] transformer-postprocess-top: ""
[2023-06-27 08:35:11] [config] transformer-preprocess: ""
[2023-06-27 08:35:11] [config] transformer-tied-layers:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] transformer-train-position-embeddings: false
[2023-06-27 08:35:11] [config] tsv: false
[2023-06-27 08:35:11] [config] tsv-fields: 0
[2023-06-27 08:35:11] [config] type: amun
[2023-06-27 08:35:11] [config] ulr: false
[2023-06-27 08:35:11] [config] ulr-dim-emb: 0
[2023-06-27 08:35:11] [config] ulr-dropout: 0
[2023-06-27 08:35:11] [config] ulr-keys-vectors: ""
[2023-06-27 08:35:11] [config] ulr-query-vectors: ""
[2023-06-27 08:35:11] [config] ulr-softmax-temperature: 1
[2023-06-27 08:35:11] [config] ulr-trainable-transformation: false
[2023-06-27 08:35:11] [config] unlikelihood-loss: false
[2023-06-27 08:35:11] [config] valid-freq: 5000000
[2023-06-27 08:35:11] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 08:35:11] [config] valid-max-length: 1000
[2023-06-27 08:35:11] [config] valid-metrics:
[2023-06-27 08:35:11] [config]   - cross-entropy
[2023-06-27 08:35:11] [config]   - translation
[2023-06-27 08:35:11] [config] valid-mini-batch: 32
[2023-06-27 08:35:11] [config] valid-reset-stalled: false
[2023-06-27 08:35:11] [config] valid-script-args:
[2023-06-27 08:35:11] [config]   []
[2023-06-27 08:35:11] [config] valid-script-path: ""
[2023-06-27 08:35:11] [config] valid-sets:
[2023-06-27 08:35:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 08:35:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 08:35:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 08:35:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:35:11] [config] vocabs:
[2023-06-27 08:35:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:35:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:35:11] [config] word-penalty: 0
[2023-06-27 08:35:11] [config] word-scores: false
[2023-06-27 08:35:11] [config] workspace: 3000
[2023-06-27 08:35:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:35:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:35:11] [training] Using single-device training
[2023-06-27 08:35:12] Synced seed 1234
[2023-06-27 08:35:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:35:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 08:35:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:35:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 08:35:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 08:35:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:35:13] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:35:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:35:13] [comm] Using global sharding
[2023-06-27 08:35:13] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:35:13] [training] Using 1 GPUs
[2023-06-27 08:35:13] [logits] Applying loss function for 1 factor(s)
[2023-06-27 08:35:13] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:35:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 08:35:13] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:35:25] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 08:35:25] [valid] No post-processing script given for validating translator
[2023-06-27 08:35:26] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:35:26] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:35:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:35:26] [comm] Using global sharding
[2023-06-27 08:35:26] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:35:26] [training] Using 1 GPUs
[2023-06-27 08:35:26] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:35:27] Loading Adam parameters
[2023-06-27 08:35:27] [memory] Reserving 322 MB, device gpu0
[2023-06-27 08:35:27] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:35:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:35:27] [data] Restoring the corpus state to epoch 51, batch 5157
[2023-06-27 08:35:27] [data] Shuffling data
[2023-06-27 08:35:27] [data] Done reading 20,192 sentences
[2023-06-27 08:35:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:35:27] Training started
[2023-06-27 08:35:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 08:35:27] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:35:27] Parameter type float32, optimization type float32, casting types false
[2023-06-27 08:36:04] Seen 16,611 samples
[2023-06-27 08:36:04] Starting data epoch 52 in logical epoch 52
[2023-06-27 08:36:04] [data] Shuffling data
[2023-06-27 08:36:04] [data] Done reading 20,192 sentences
[2023-06-27 08:36:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:36:44] Seen 16,611 samples
[2023-06-27 08:36:44] Starting data epoch 53 in logical epoch 53
[2023-06-27 08:36:44] [data] Shuffling data
[2023-06-27 08:36:44] [data] Done reading 20,192 sentences
[2023-06-27 08:36:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:37:25] Seen 16,611 samples
[2023-06-27 08:37:25] Starting data epoch 54 in logical epoch 54
[2023-06-27 08:37:25] [data] Shuffling data
[2023-06-27 08:37:25] [data] Done reading 20,192 sentences
[2023-06-27 08:37:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:38:05] Seen 16,611 samples
[2023-06-27 08:38:05] Starting data epoch 55 in logical epoch 55
[2023-06-27 08:38:05] [data] Shuffling data
[2023-06-27 08:38:05] [data] Done reading 20,192 sentences
[2023-06-27 08:38:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:38:46] Seen 16,611 samples
[2023-06-27 08:38:46] Starting data epoch 56 in logical epoch 56
[2023-06-27 08:38:46] [data] Shuffling data
[2023-06-27 08:38:46] [data] Done reading 20,192 sentences
[2023-06-27 08:38:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:39:26] Seen 16,611 samples
[2023-06-27 08:39:26] Starting data epoch 57 in logical epoch 57
[2023-06-27 08:39:26] [data] Shuffling data
[2023-06-27 08:39:26] [data] Done reading 20,192 sentences
[2023-06-27 08:39:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:40:07] Seen 16,611 samples
[2023-06-27 08:40:07] Starting data epoch 58 in logical epoch 58
[2023-06-27 08:40:07] [data] Shuffling data
[2023-06-27 08:40:07] [data] Done reading 20,192 sentences
[2023-06-27 08:40:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:40:48] Seen 16,611 samples
[2023-06-27 08:40:48] Starting data epoch 59 in logical epoch 59
[2023-06-27 08:40:48] [data] Shuffling data
[2023-06-27 08:40:48] [data] Done reading 20,192 sentences
[2023-06-27 08:40:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:40:55] Ep. 59 : Up. 6000 : Sen. 2,697 : Cost 2.06612468 * 3,775,325 @ 4,695 after 22,650,529 : Time 329.98s : 11441.04 words/s : gNorm 1.2315
[2023-06-27 08:41:29] Seen 16,611 samples
[2023-06-27 08:41:29] Starting data epoch 60 in logical epoch 60
[2023-06-27 08:41:29] [data] Shuffling data
[2023-06-27 08:41:29] [data] Done reading 20,192 sentences
[2023-06-27 08:41:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:42:09] Seen 16,611 samples
[2023-06-27 08:42:09] Starting data epoch 61 in logical epoch 61
[2023-06-27 08:42:09] Training finished
[2023-06-27 08:42:18] [valid] Ep. 61 : Up. 6188 : cross-entropy : 119.579 : stalled 1 times (last best: 118.987)
[2023-06-27 08:42:52] [valid] Ep. 61 : Up. 6188 : translation : 0 : new best
[2023-06-27 08:42:52] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:42:54] Saving Adam parameters
[2023-06-27 08:42:54] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:46:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:46:09] [marian] Running on node20.datos.cluster.uy as process 33031 with command line:
[2023-06-27 08:46:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 08:46:09] [config] after: 0e
[2023-06-27 08:46:09] [config] after-batches: 0
[2023-06-27 08:46:09] [config] after-epochs: 70
[2023-06-27 08:46:09] [config] all-caps-every: 0
[2023-06-27 08:46:09] [config] allow-unk: false
[2023-06-27 08:46:09] [config] authors: false
[2023-06-27 08:46:09] [config] beam-size: 6
[2023-06-27 08:46:09] [config] bert-class-symbol: "[CLS]"
[2023-06-27 08:46:09] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 08:46:09] [config] bert-masking-fraction: 0.15
[2023-06-27 08:46:09] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 08:46:09] [config] bert-train-type-embeddings: true
[2023-06-27 08:46:09] [config] bert-type-vocab-size: 2
[2023-06-27 08:46:09] [config] build-info: ""
[2023-06-27 08:46:09] [config] check-gradient-nan: false
[2023-06-27 08:46:09] [config] check-nan: false
[2023-06-27 08:46:09] [config] cite: false
[2023-06-27 08:46:09] [config] clip-norm: 1
[2023-06-27 08:46:09] [config] cost-scaling:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] cost-type: ce-sum
[2023-06-27 08:46:09] [config] cpu-threads: 0
[2023-06-27 08:46:09] [config] data-threads: 8
[2023-06-27 08:46:09] [config] data-weighting: ""
[2023-06-27 08:46:09] [config] data-weighting-type: sentence
[2023-06-27 08:46:09] [config] dec-cell: gru
[2023-06-27 08:46:09] [config] dec-cell-base-depth: 2
[2023-06-27 08:46:09] [config] dec-cell-high-depth: 1
[2023-06-27 08:46:09] [config] dec-depth: 1
[2023-06-27 08:46:09] [config] devices:
[2023-06-27 08:46:09] [config]   - 0
[2023-06-27 08:46:09] [config] dim-emb: 512
[2023-06-27 08:46:09] [config] dim-rnn: 1024
[2023-06-27 08:46:09] [config] dim-vocabs:
[2023-06-27 08:46:09] [config]   - 16384
[2023-06-27 08:46:09] [config]   - 16384
[2023-06-27 08:46:09] [config] disp-first: 0
[2023-06-27 08:46:09] [config] disp-freq: 1000u
[2023-06-27 08:46:09] [config] disp-label-counts: true
[2023-06-27 08:46:09] [config] dropout-rnn: 0.2
[2023-06-27 08:46:09] [config] dropout-src: 0.1
[2023-06-27 08:46:09] [config] dropout-trg: 0.1
[2023-06-27 08:46:09] [config] dump-config: ""
[2023-06-27 08:46:09] [config] dynamic-gradient-scaling:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] early-stopping: 10
[2023-06-27 08:46:09] [config] early-stopping-on: first
[2023-06-27 08:46:09] [config] embedding-fix-src: false
[2023-06-27 08:46:09] [config] embedding-fix-trg: false
[2023-06-27 08:46:09] [config] embedding-normalization: false
[2023-06-27 08:46:09] [config] embedding-vectors:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] enc-cell: gru
[2023-06-27 08:46:09] [config] enc-cell-depth: 1
[2023-06-27 08:46:09] [config] enc-depth: 1
[2023-06-27 08:46:09] [config] enc-type: bidirectional
[2023-06-27 08:46:09] [config] english-title-case-every: 0
[2023-06-27 08:46:09] [config] exponential-smoothing: 0
[2023-06-27 08:46:09] [config] factor-weight: 1
[2023-06-27 08:46:09] [config] factors-combine: sum
[2023-06-27 08:46:09] [config] factors-dim-emb: 0
[2023-06-27 08:46:09] [config] gradient-checkpointing: false
[2023-06-27 08:46:09] [config] gradient-norm-average-window: 100
[2023-06-27 08:46:09] [config] guided-alignment: none
[2023-06-27 08:46:09] [config] guided-alignment-cost: mse
[2023-06-27 08:46:09] [config] guided-alignment-weight: 0.1
[2023-06-27 08:46:09] [config] ignore-model-config: false
[2023-06-27 08:46:09] [config] input-types:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] interpolate-env-vars: false
[2023-06-27 08:46:09] [config] keep-best: false
[2023-06-27 08:46:09] [config] label-smoothing: 0
[2023-06-27 08:46:09] [config] layer-normalization: true
[2023-06-27 08:46:09] [config] learn-rate: 0.0001
[2023-06-27 08:46:09] [config] lemma-dependency: ""
[2023-06-27 08:46:09] [config] lemma-dim-emb: 0
[2023-06-27 08:46:09] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 08:46:09] [config] log-level: info
[2023-06-27 08:46:09] [config] log-time-zone: ""
[2023-06-27 08:46:09] [config] logical-epoch:
[2023-06-27 08:46:09] [config]   - 1e
[2023-06-27 08:46:09] [config]   - 0
[2023-06-27 08:46:09] [config] lr-decay: 0
[2023-06-27 08:46:09] [config] lr-decay-freq: 50000
[2023-06-27 08:46:09] [config] lr-decay-inv-sqrt:
[2023-06-27 08:46:09] [config]   - 0
[2023-06-27 08:46:09] [config] lr-decay-repeat-warmup: false
[2023-06-27 08:46:09] [config] lr-decay-reset-optimizer: false
[2023-06-27 08:46:09] [config] lr-decay-start:
[2023-06-27 08:46:09] [config]   - 10
[2023-06-27 08:46:09] [config]   - 1
[2023-06-27 08:46:09] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 08:46:09] [config] lr-report: false
[2023-06-27 08:46:09] [config] lr-warmup: 0
[2023-06-27 08:46:09] [config] lr-warmup-at-reload: false
[2023-06-27 08:46:09] [config] lr-warmup-cycle: false
[2023-06-27 08:46:09] [config] lr-warmup-start-rate: 0
[2023-06-27 08:46:09] [config] max-length: 50
[2023-06-27 08:46:09] [config] max-length-crop: false
[2023-06-27 08:46:09] [config] max-length-factor: 3
[2023-06-27 08:46:09] [config] maxi-batch: 100
[2023-06-27 08:46:09] [config] maxi-batch-sort: trg
[2023-06-27 08:46:09] [config] mini-batch: 64
[2023-06-27 08:46:09] [config] mini-batch-fit: true
[2023-06-27 08:46:09] [config] mini-batch-fit-step: 10
[2023-06-27 08:46:09] [config] mini-batch-round-up: true
[2023-06-27 08:46:09] [config] mini-batch-track-lr: false
[2023-06-27 08:46:09] [config] mini-batch-warmup: 0
[2023-06-27 08:46:09] [config] mini-batch-words: 0
[2023-06-27 08:46:09] [config] mini-batch-words-ref: 0
[2023-06-27 08:46:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:46:09] [config] multi-loss-type: sum
[2023-06-27 08:46:09] [config] n-best: false
[2023-06-27 08:46:09] [config] no-nccl: false
[2023-06-27 08:46:09] [config] no-reload: false
[2023-06-27 08:46:09] [config] no-restore-corpus: false
[2023-06-27 08:46:09] [config] normalize: 0.6
[2023-06-27 08:46:09] [config] normalize-gradient: false
[2023-06-27 08:46:09] [config] num-devices: 0
[2023-06-27 08:46:09] [config] optimizer: adam
[2023-06-27 08:46:09] [config] optimizer-delay: 1
[2023-06-27 08:46:09] [config] optimizer-params:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] output-omit-bias: false
[2023-06-27 08:46:09] [config] overwrite: false
[2023-06-27 08:46:09] [config] precision:
[2023-06-27 08:46:09] [config]   - float32
[2023-06-27 08:46:09] [config]   - float32
[2023-06-27 08:46:09] [config] pretrained-model: ""
[2023-06-27 08:46:09] [config] quantize-biases: false
[2023-06-27 08:46:09] [config] quantize-bits: 0
[2023-06-27 08:46:09] [config] quantize-log-based: false
[2023-06-27 08:46:09] [config] quantize-optimization-steps: 0
[2023-06-27 08:46:09] [config] quiet: false
[2023-06-27 08:46:09] [config] quiet-translation: true
[2023-06-27 08:46:09] [config] relative-paths: false
[2023-06-27 08:46:09] [config] right-left: false
[2023-06-27 08:46:09] [config] save-freq: 10000u
[2023-06-27 08:46:09] [config] seed: 1234
[2023-06-27 08:46:09] [config] sentencepiece-alphas:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] sentencepiece-max-lines: 2000000
[2023-06-27 08:46:09] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 08:46:09] [config] sharding: global
[2023-06-27 08:46:09] [config] shuffle: data
[2023-06-27 08:46:09] [config] shuffle-in-ram: false
[2023-06-27 08:46:09] [config] sigterm: save-and-exit
[2023-06-27 08:46:09] [config] skip: false
[2023-06-27 08:46:09] [config] sqlite: ""
[2023-06-27 08:46:09] [config] sqlite-drop: false
[2023-06-27 08:46:09] [config] sync-freq: 200u
[2023-06-27 08:46:09] [config] sync-sgd: false
[2023-06-27 08:46:09] [config] tempdir: /tmp
[2023-06-27 08:46:09] [config] tied-embeddings: false
[2023-06-27 08:46:09] [config] tied-embeddings-all: true
[2023-06-27 08:46:09] [config] tied-embeddings-src: false
[2023-06-27 08:46:09] [config] train-embedder-rank:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] train-sets:
[2023-06-27 08:46:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 08:46:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 08:46:09] [config] transformer-aan-activation: swish
[2023-06-27 08:46:09] [config] transformer-aan-depth: 2
[2023-06-27 08:46:09] [config] transformer-aan-nogate: false
[2023-06-27 08:46:09] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 08:46:09] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 08:46:09] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 08:46:09] [config] transformer-depth-scaling: false
[2023-06-27 08:46:09] [config] transformer-dim-aan: 2048
[2023-06-27 08:46:09] [config] transformer-dim-ffn: 2048
[2023-06-27 08:46:09] [config] transformer-dropout: 0
[2023-06-27 08:46:09] [config] transformer-dropout-attention: 0
[2023-06-27 08:46:09] [config] transformer-dropout-ffn: 0
[2023-06-27 08:46:09] [config] transformer-ffn-activation: swish
[2023-06-27 08:46:09] [config] transformer-ffn-depth: 2
[2023-06-27 08:46:09] [config] transformer-guided-alignment-layer: last
[2023-06-27 08:46:09] [config] transformer-heads: 8
[2023-06-27 08:46:09] [config] transformer-no-projection: false
[2023-06-27 08:46:09] [config] transformer-pool: false
[2023-06-27 08:46:09] [config] transformer-postprocess: dan
[2023-06-27 08:46:09] [config] transformer-postprocess-emb: d
[2023-06-27 08:46:09] [config] transformer-postprocess-top: ""
[2023-06-27 08:46:09] [config] transformer-preprocess: ""
[2023-06-27 08:46:09] [config] transformer-tied-layers:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] transformer-train-position-embeddings: false
[2023-06-27 08:46:09] [config] tsv: false
[2023-06-27 08:46:09] [config] tsv-fields: 0
[2023-06-27 08:46:09] [config] type: amun
[2023-06-27 08:46:09] [config] ulr: false
[2023-06-27 08:46:09] [config] ulr-dim-emb: 0
[2023-06-27 08:46:09] [config] ulr-dropout: 0
[2023-06-27 08:46:09] [config] ulr-keys-vectors: ""
[2023-06-27 08:46:09] [config] ulr-query-vectors: ""
[2023-06-27 08:46:09] [config] ulr-softmax-temperature: 1
[2023-06-27 08:46:09] [config] ulr-trainable-transformation: false
[2023-06-27 08:46:09] [config] unlikelihood-loss: false
[2023-06-27 08:46:09] [config] valid-freq: 5000000
[2023-06-27 08:46:09] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 08:46:09] [config] valid-max-length: 1000
[2023-06-27 08:46:09] [config] valid-metrics:
[2023-06-27 08:46:09] [config]   - cross-entropy
[2023-06-27 08:46:09] [config]   - translation
[2023-06-27 08:46:09] [config] valid-mini-batch: 32
[2023-06-27 08:46:09] [config] valid-reset-stalled: false
[2023-06-27 08:46:09] [config] valid-script-args:
[2023-06-27 08:46:09] [config]   []
[2023-06-27 08:46:09] [config] valid-script-path: ""
[2023-06-27 08:46:09] [config] valid-sets:
[2023-06-27 08:46:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 08:46:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 08:46:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 08:46:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:46:09] [config] vocabs:
[2023-06-27 08:46:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:46:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:46:09] [config] word-penalty: 0
[2023-06-27 08:46:09] [config] word-scores: false
[2023-06-27 08:46:09] [config] workspace: 3000
[2023-06-27 08:46:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:46:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:46:09] [training] Using single-device training
[2023-06-27 08:46:10] Synced seed 1234
[2023-06-27 08:46:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:46:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 08:46:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:46:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 08:46:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 08:46:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:46:10] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:46:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:46:11] [comm] Using global sharding
[2023-06-27 08:46:11] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:46:11] [training] Using 1 GPUs
[2023-06-27 08:46:11] [logits] Applying loss function for 1 factor(s)
[2023-06-27 08:46:11] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:46:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 08:46:11] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:46:23] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 08:46:23] [valid] No post-processing script given for validating translator
[2023-06-27 08:46:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:46:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:46:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:46:23] [comm] Using global sharding
[2023-06-27 08:46:23] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:46:23] [training] Using 1 GPUs
[2023-06-27 08:46:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:46:24] Loading Adam parameters
[2023-06-27 08:46:25] [memory] Reserving 322 MB, device gpu0
[2023-06-27 08:46:25] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:46:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:46:25] [data] Restoring the corpus state to epoch 61, batch 6188
[2023-06-27 08:46:25] [data] Shuffling data
[2023-06-27 08:46:25] [data] Done reading 20,192 sentences
[2023-06-27 08:46:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:46:25] Training started
[2023-06-27 08:46:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 08:46:25] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:46:25] Parameter type float32, optimization type float32, casting types false
[2023-06-27 08:47:02] Seen 16,611 samples
[2023-06-27 08:47:02] Starting data epoch 62 in logical epoch 62
[2023-06-27 08:47:02] [data] Shuffling data
[2023-06-27 08:47:02] [data] Done reading 20,192 sentences
[2023-06-27 08:47:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:47:42] Seen 16,611 samples
[2023-06-27 08:47:42] Starting data epoch 63 in logical epoch 63
[2023-06-27 08:47:42] [data] Shuffling data
[2023-06-27 08:47:42] [data] Done reading 20,192 sentences
[2023-06-27 08:47:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:48:23] Seen 16,611 samples
[2023-06-27 08:48:23] Starting data epoch 64 in logical epoch 64
[2023-06-27 08:48:23] [data] Shuffling data
[2023-06-27 08:48:23] [data] Done reading 20,192 sentences
[2023-06-27 08:48:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:49:03] Seen 16,611 samples
[2023-06-27 08:49:03] Starting data epoch 65 in logical epoch 65
[2023-06-27 08:49:03] [data] Shuffling data
[2023-06-27 08:49:03] [data] Done reading 20,192 sentences
[2023-06-27 08:49:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:49:44] Seen 16,611 samples
[2023-06-27 08:49:44] Starting data epoch 66 in logical epoch 66
[2023-06-27 08:49:44] [data] Shuffling data
[2023-06-27 08:49:44] [data] Done reading 20,192 sentences
[2023-06-27 08:49:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:50:25] Seen 16,611 samples
[2023-06-27 08:50:25] Starting data epoch 67 in logical epoch 67
[2023-06-27 08:50:25] [data] Shuffling data
[2023-06-27 08:50:25] [data] Done reading 20,192 sentences
[2023-06-27 08:50:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:51:05] Seen 16,611 samples
[2023-06-27 08:51:05] Starting data epoch 68 in logical epoch 68
[2023-06-27 08:51:05] [data] Shuffling data
[2023-06-27 08:51:05] [data] Done reading 20,192 sentences
[2023-06-27 08:51:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:51:39] Ep. 68 : Up. 7000 : Sen. 14,291 : Cost 1.77206087 * 3,761,836 @ 2,860 after 26,412,365 : Time 315.61s : 11919.14 words/s : gNorm 1.1632
[2023-06-27 08:51:45] Seen 16,611 samples
[2023-06-27 08:51:45] Starting data epoch 69 in logical epoch 69
[2023-06-27 08:51:45] [data] Shuffling data
[2023-06-27 08:51:46] [data] Done reading 20,192 sentences
[2023-06-27 08:51:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:52:26] Seen 16,611 samples
[2023-06-27 08:52:26] Starting data epoch 70 in logical epoch 70
[2023-06-27 08:52:26] [data] Shuffling data
[2023-06-27 08:52:26] [data] Done reading 20,192 sentences
[2023-06-27 08:52:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:53:07] Seen 16,611 samples
[2023-06-27 08:53:07] Starting data epoch 71 in logical epoch 71
[2023-06-27 08:53:07] Training finished
[2023-06-27 08:53:15] [valid] Ep. 71 : Up. 7221 : cross-entropy : 119.431 : stalled 2 times (last best: 118.987)
[2023-06-27 08:53:50] [valid] Ep. 71 : Up. 7221 : translation : 0 : new best
[2023-06-27 08:53:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:53:52] Saving Adam parameters
[2023-06-27 08:53:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:57:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:57:08] [marian] Running on node20.datos.cluster.uy as process 33675 with command line:
[2023-06-27 08:57:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 08:57:08] [config] after: 0e
[2023-06-27 08:57:08] [config] after-batches: 0
[2023-06-27 08:57:08] [config] after-epochs: 80
[2023-06-27 08:57:08] [config] all-caps-every: 0
[2023-06-27 08:57:08] [config] allow-unk: false
[2023-06-27 08:57:08] [config] authors: false
[2023-06-27 08:57:08] [config] beam-size: 6
[2023-06-27 08:57:08] [config] bert-class-symbol: "[CLS]"
[2023-06-27 08:57:08] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 08:57:08] [config] bert-masking-fraction: 0.15
[2023-06-27 08:57:08] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 08:57:08] [config] bert-train-type-embeddings: true
[2023-06-27 08:57:08] [config] bert-type-vocab-size: 2
[2023-06-27 08:57:08] [config] build-info: ""
[2023-06-27 08:57:08] [config] check-gradient-nan: false
[2023-06-27 08:57:08] [config] check-nan: false
[2023-06-27 08:57:08] [config] cite: false
[2023-06-27 08:57:08] [config] clip-norm: 1
[2023-06-27 08:57:08] [config] cost-scaling:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] cost-type: ce-sum
[2023-06-27 08:57:08] [config] cpu-threads: 0
[2023-06-27 08:57:08] [config] data-threads: 8
[2023-06-27 08:57:08] [config] data-weighting: ""
[2023-06-27 08:57:08] [config] data-weighting-type: sentence
[2023-06-27 08:57:08] [config] dec-cell: gru
[2023-06-27 08:57:08] [config] dec-cell-base-depth: 2
[2023-06-27 08:57:08] [config] dec-cell-high-depth: 1
[2023-06-27 08:57:08] [config] dec-depth: 1
[2023-06-27 08:57:08] [config] devices:
[2023-06-27 08:57:08] [config]   - 0
[2023-06-27 08:57:08] [config] dim-emb: 512
[2023-06-27 08:57:08] [config] dim-rnn: 1024
[2023-06-27 08:57:08] [config] dim-vocabs:
[2023-06-27 08:57:08] [config]   - 16384
[2023-06-27 08:57:08] [config]   - 16384
[2023-06-27 08:57:08] [config] disp-first: 0
[2023-06-27 08:57:08] [config] disp-freq: 1000u
[2023-06-27 08:57:08] [config] disp-label-counts: true
[2023-06-27 08:57:08] [config] dropout-rnn: 0.2
[2023-06-27 08:57:08] [config] dropout-src: 0.1
[2023-06-27 08:57:08] [config] dropout-trg: 0.1
[2023-06-27 08:57:08] [config] dump-config: ""
[2023-06-27 08:57:08] [config] dynamic-gradient-scaling:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] early-stopping: 10
[2023-06-27 08:57:08] [config] early-stopping-on: first
[2023-06-27 08:57:08] [config] embedding-fix-src: false
[2023-06-27 08:57:08] [config] embedding-fix-trg: false
[2023-06-27 08:57:08] [config] embedding-normalization: false
[2023-06-27 08:57:08] [config] embedding-vectors:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] enc-cell: gru
[2023-06-27 08:57:08] [config] enc-cell-depth: 1
[2023-06-27 08:57:08] [config] enc-depth: 1
[2023-06-27 08:57:08] [config] enc-type: bidirectional
[2023-06-27 08:57:08] [config] english-title-case-every: 0
[2023-06-27 08:57:08] [config] exponential-smoothing: 0
[2023-06-27 08:57:08] [config] factor-weight: 1
[2023-06-27 08:57:08] [config] factors-combine: sum
[2023-06-27 08:57:08] [config] factors-dim-emb: 0
[2023-06-27 08:57:08] [config] gradient-checkpointing: false
[2023-06-27 08:57:08] [config] gradient-norm-average-window: 100
[2023-06-27 08:57:08] [config] guided-alignment: none
[2023-06-27 08:57:08] [config] guided-alignment-cost: mse
[2023-06-27 08:57:08] [config] guided-alignment-weight: 0.1
[2023-06-27 08:57:08] [config] ignore-model-config: false
[2023-06-27 08:57:08] [config] input-types:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] interpolate-env-vars: false
[2023-06-27 08:57:08] [config] keep-best: false
[2023-06-27 08:57:08] [config] label-smoothing: 0
[2023-06-27 08:57:08] [config] layer-normalization: true
[2023-06-27 08:57:08] [config] learn-rate: 0.0001
[2023-06-27 08:57:08] [config] lemma-dependency: ""
[2023-06-27 08:57:08] [config] lemma-dim-emb: 0
[2023-06-27 08:57:08] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 08:57:08] [config] log-level: info
[2023-06-27 08:57:08] [config] log-time-zone: ""
[2023-06-27 08:57:08] [config] logical-epoch:
[2023-06-27 08:57:08] [config]   - 1e
[2023-06-27 08:57:08] [config]   - 0
[2023-06-27 08:57:08] [config] lr-decay: 0
[2023-06-27 08:57:08] [config] lr-decay-freq: 50000
[2023-06-27 08:57:08] [config] lr-decay-inv-sqrt:
[2023-06-27 08:57:08] [config]   - 0
[2023-06-27 08:57:08] [config] lr-decay-repeat-warmup: false
[2023-06-27 08:57:08] [config] lr-decay-reset-optimizer: false
[2023-06-27 08:57:08] [config] lr-decay-start:
[2023-06-27 08:57:08] [config]   - 10
[2023-06-27 08:57:08] [config]   - 1
[2023-06-27 08:57:08] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 08:57:08] [config] lr-report: false
[2023-06-27 08:57:08] [config] lr-warmup: 0
[2023-06-27 08:57:08] [config] lr-warmup-at-reload: false
[2023-06-27 08:57:08] [config] lr-warmup-cycle: false
[2023-06-27 08:57:08] [config] lr-warmup-start-rate: 0
[2023-06-27 08:57:08] [config] max-length: 50
[2023-06-27 08:57:08] [config] max-length-crop: false
[2023-06-27 08:57:08] [config] max-length-factor: 3
[2023-06-27 08:57:08] [config] maxi-batch: 100
[2023-06-27 08:57:08] [config] maxi-batch-sort: trg
[2023-06-27 08:57:08] [config] mini-batch: 64
[2023-06-27 08:57:08] [config] mini-batch-fit: true
[2023-06-27 08:57:08] [config] mini-batch-fit-step: 10
[2023-06-27 08:57:08] [config] mini-batch-round-up: true
[2023-06-27 08:57:08] [config] mini-batch-track-lr: false
[2023-06-27 08:57:08] [config] mini-batch-warmup: 0
[2023-06-27 08:57:08] [config] mini-batch-words: 0
[2023-06-27 08:57:08] [config] mini-batch-words-ref: 0
[2023-06-27 08:57:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:57:08] [config] multi-loss-type: sum
[2023-06-27 08:57:08] [config] n-best: false
[2023-06-27 08:57:08] [config] no-nccl: false
[2023-06-27 08:57:08] [config] no-reload: false
[2023-06-27 08:57:08] [config] no-restore-corpus: false
[2023-06-27 08:57:08] [config] normalize: 0.6
[2023-06-27 08:57:08] [config] normalize-gradient: false
[2023-06-27 08:57:08] [config] num-devices: 0
[2023-06-27 08:57:08] [config] optimizer: adam
[2023-06-27 08:57:08] [config] optimizer-delay: 1
[2023-06-27 08:57:08] [config] optimizer-params:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] output-omit-bias: false
[2023-06-27 08:57:08] [config] overwrite: false
[2023-06-27 08:57:08] [config] precision:
[2023-06-27 08:57:08] [config]   - float32
[2023-06-27 08:57:08] [config]   - float32
[2023-06-27 08:57:08] [config] pretrained-model: ""
[2023-06-27 08:57:08] [config] quantize-biases: false
[2023-06-27 08:57:08] [config] quantize-bits: 0
[2023-06-27 08:57:08] [config] quantize-log-based: false
[2023-06-27 08:57:08] [config] quantize-optimization-steps: 0
[2023-06-27 08:57:08] [config] quiet: false
[2023-06-27 08:57:08] [config] quiet-translation: true
[2023-06-27 08:57:08] [config] relative-paths: false
[2023-06-27 08:57:08] [config] right-left: false
[2023-06-27 08:57:08] [config] save-freq: 10000u
[2023-06-27 08:57:08] [config] seed: 1234
[2023-06-27 08:57:08] [config] sentencepiece-alphas:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] sentencepiece-max-lines: 2000000
[2023-06-27 08:57:08] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 08:57:08] [config] sharding: global
[2023-06-27 08:57:08] [config] shuffle: data
[2023-06-27 08:57:08] [config] shuffle-in-ram: false
[2023-06-27 08:57:08] [config] sigterm: save-and-exit
[2023-06-27 08:57:08] [config] skip: false
[2023-06-27 08:57:08] [config] sqlite: ""
[2023-06-27 08:57:08] [config] sqlite-drop: false
[2023-06-27 08:57:08] [config] sync-freq: 200u
[2023-06-27 08:57:08] [config] sync-sgd: false
[2023-06-27 08:57:08] [config] tempdir: /tmp
[2023-06-27 08:57:08] [config] tied-embeddings: false
[2023-06-27 08:57:08] [config] tied-embeddings-all: true
[2023-06-27 08:57:08] [config] tied-embeddings-src: false
[2023-06-27 08:57:08] [config] train-embedder-rank:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] train-sets:
[2023-06-27 08:57:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 08:57:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 08:57:08] [config] transformer-aan-activation: swish
[2023-06-27 08:57:08] [config] transformer-aan-depth: 2
[2023-06-27 08:57:08] [config] transformer-aan-nogate: false
[2023-06-27 08:57:08] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 08:57:08] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 08:57:08] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 08:57:08] [config] transformer-depth-scaling: false
[2023-06-27 08:57:08] [config] transformer-dim-aan: 2048
[2023-06-27 08:57:08] [config] transformer-dim-ffn: 2048
[2023-06-27 08:57:08] [config] transformer-dropout: 0
[2023-06-27 08:57:08] [config] transformer-dropout-attention: 0
[2023-06-27 08:57:08] [config] transformer-dropout-ffn: 0
[2023-06-27 08:57:08] [config] transformer-ffn-activation: swish
[2023-06-27 08:57:08] [config] transformer-ffn-depth: 2
[2023-06-27 08:57:08] [config] transformer-guided-alignment-layer: last
[2023-06-27 08:57:08] [config] transformer-heads: 8
[2023-06-27 08:57:08] [config] transformer-no-projection: false
[2023-06-27 08:57:08] [config] transformer-pool: false
[2023-06-27 08:57:08] [config] transformer-postprocess: dan
[2023-06-27 08:57:08] [config] transformer-postprocess-emb: d
[2023-06-27 08:57:08] [config] transformer-postprocess-top: ""
[2023-06-27 08:57:08] [config] transformer-preprocess: ""
[2023-06-27 08:57:08] [config] transformer-tied-layers:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] transformer-train-position-embeddings: false
[2023-06-27 08:57:08] [config] tsv: false
[2023-06-27 08:57:08] [config] tsv-fields: 0
[2023-06-27 08:57:08] [config] type: amun
[2023-06-27 08:57:08] [config] ulr: false
[2023-06-27 08:57:08] [config] ulr-dim-emb: 0
[2023-06-27 08:57:08] [config] ulr-dropout: 0
[2023-06-27 08:57:08] [config] ulr-keys-vectors: ""
[2023-06-27 08:57:08] [config] ulr-query-vectors: ""
[2023-06-27 08:57:08] [config] ulr-softmax-temperature: 1
[2023-06-27 08:57:08] [config] ulr-trainable-transformation: false
[2023-06-27 08:57:08] [config] unlikelihood-loss: false
[2023-06-27 08:57:08] [config] valid-freq: 5000000
[2023-06-27 08:57:08] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 08:57:08] [config] valid-max-length: 1000
[2023-06-27 08:57:08] [config] valid-metrics:
[2023-06-27 08:57:08] [config]   - cross-entropy
[2023-06-27 08:57:08] [config]   - translation
[2023-06-27 08:57:08] [config] valid-mini-batch: 32
[2023-06-27 08:57:08] [config] valid-reset-stalled: false
[2023-06-27 08:57:08] [config] valid-script-args:
[2023-06-27 08:57:08] [config]   []
[2023-06-27 08:57:08] [config] valid-script-path: ""
[2023-06-27 08:57:08] [config] valid-sets:
[2023-06-27 08:57:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 08:57:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 08:57:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 08:57:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:57:08] [config] vocabs:
[2023-06-27 08:57:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:57:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:57:08] [config] word-penalty: 0
[2023-06-27 08:57:08] [config] word-scores: false
[2023-06-27 08:57:08] [config] workspace: 3000
[2023-06-27 08:57:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 08:57:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:57:08] [training] Using single-device training
[2023-06-27 08:57:09] Synced seed 1234
[2023-06-27 08:57:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 08:57:09] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 08:57:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 08:57:09] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 08:57:09] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 08:57:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:57:10] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:57:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:57:10] [comm] Using global sharding
[2023-06-27 08:57:10] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:57:10] [training] Using 1 GPUs
[2023-06-27 08:57:10] [logits] Applying loss function for 1 factor(s)
[2023-06-27 08:57:10] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:57:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 08:57:10] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:57:22] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 08:57:22] [valid] No post-processing script given for validating translator
[2023-06-27 08:57:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 08:57:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 08:57:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 08:57:23] [comm] Using global sharding
[2023-06-27 08:57:23] [comm] NCCLCommunicators constructed successfully
[2023-06-27 08:57:23] [training] Using 1 GPUs
[2023-06-27 08:57:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 08:57:24] Loading Adam parameters
[2023-06-27 08:57:24] [memory] Reserving 322 MB, device gpu0
[2023-06-27 08:57:24] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:57:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 08:57:24] [data] Restoring the corpus state to epoch 71, batch 7221
[2023-06-27 08:57:24] [data] Shuffling data
[2023-06-27 08:57:24] [data] Done reading 20,192 sentences
[2023-06-27 08:57:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:57:24] Training started
[2023-06-27 08:57:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 08:57:24] [memory] Reserving 161 MB, device gpu0
[2023-06-27 08:57:24] Parameter type float32, optimization type float32, casting types false
[2023-06-27 08:58:01] Seen 16,611 samples
[2023-06-27 08:58:01] Starting data epoch 72 in logical epoch 72
[2023-06-27 08:58:01] [data] Shuffling data
[2023-06-27 08:58:01] [data] Done reading 20,192 sentences
[2023-06-27 08:58:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:58:41] Seen 16,611 samples
[2023-06-27 08:58:41] Starting data epoch 73 in logical epoch 73
[2023-06-27 08:58:41] [data] Shuffling data
[2023-06-27 08:58:41] [data] Done reading 20,192 sentences
[2023-06-27 08:58:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 08:59:21] Seen 16,611 samples
[2023-06-27 08:59:21] Starting data epoch 74 in logical epoch 74
[2023-06-27 08:59:21] [data] Shuffling data
[2023-06-27 08:59:21] [data] Done reading 20,192 sentences
[2023-06-27 08:59:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:00:02] Seen 16,611 samples
[2023-06-27 09:00:02] Starting data epoch 75 in logical epoch 75
[2023-06-27 09:00:02] [data] Shuffling data
[2023-06-27 09:00:02] [data] Done reading 20,192 sentences
[2023-06-27 09:00:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:00:42] Seen 16,611 samples
[2023-06-27 09:00:42] Starting data epoch 76 in logical epoch 76
[2023-06-27 09:00:42] [data] Shuffling data
[2023-06-27 09:00:42] [data] Done reading 20,192 sentences
[2023-06-27 09:00:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:01:23] Seen 16,611 samples
[2023-06-27 09:01:23] Starting data epoch 77 in logical epoch 77
[2023-06-27 09:01:23] [data] Shuffling data
[2023-06-27 09:01:23] [data] Done reading 20,192 sentences
[2023-06-27 09:01:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:02:04] Seen 16,611 samples
[2023-06-27 09:02:04] Starting data epoch 78 in logical epoch 78
[2023-06-27 09:02:04] [data] Shuffling data
[2023-06-27 09:02:04] [data] Done reading 20,192 sentences
[2023-06-27 09:02:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:02:25] Ep. 78 : Up. 8000 : Sen. 9,190 : Cost 1.49995589 * 3,767,396 @ 4,254 after 30,179,761 : Time 302.10s : 12470.84 words/s : gNorm 1.1676
[2023-06-27 09:02:44] Seen 16,611 samples
[2023-06-27 09:02:44] Starting data epoch 79 in logical epoch 79
[2023-06-27 09:02:44] [data] Shuffling data
[2023-06-27 09:02:44] [data] Done reading 20,192 sentences
[2023-06-27 09:02:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:03:25] Seen 16,611 samples
[2023-06-27 09:03:25] Starting data epoch 80 in logical epoch 80
[2023-06-27 09:03:25] [data] Shuffling data
[2023-06-27 09:03:25] [data] Done reading 20,192 sentences
[2023-06-27 09:03:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:04:05] Seen 16,611 samples
[2023-06-27 09:04:05] Starting data epoch 81 in logical epoch 81
[2023-06-27 09:04:05] Training finished
[2023-06-27 09:04:14] [valid] Ep. 81 : Up. 8253 : cross-entropy : 118.897 : new best
[2023-06-27 09:04:48] [valid] Ep. 81 : Up. 8253 : translation : 0 : new best
[2023-06-27 09:04:48] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:04:50] Saving Adam parameters
[2023-06-27 09:04:50] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:08:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:08:07] [marian] Running on node20.datos.cluster.uy as process 34660 with command line:
[2023-06-27 09:08:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 09:08:07] [config] after: 0e
[2023-06-27 09:08:07] [config] after-batches: 0
[2023-06-27 09:08:07] [config] after-epochs: 90
[2023-06-27 09:08:07] [config] all-caps-every: 0
[2023-06-27 09:08:07] [config] allow-unk: false
[2023-06-27 09:08:07] [config] authors: false
[2023-06-27 09:08:07] [config] beam-size: 6
[2023-06-27 09:08:07] [config] bert-class-symbol: "[CLS]"
[2023-06-27 09:08:07] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 09:08:07] [config] bert-masking-fraction: 0.15
[2023-06-27 09:08:07] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 09:08:07] [config] bert-train-type-embeddings: true
[2023-06-27 09:08:07] [config] bert-type-vocab-size: 2
[2023-06-27 09:08:07] [config] build-info: ""
[2023-06-27 09:08:07] [config] check-gradient-nan: false
[2023-06-27 09:08:07] [config] check-nan: false
[2023-06-27 09:08:07] [config] cite: false
[2023-06-27 09:08:07] [config] clip-norm: 1
[2023-06-27 09:08:07] [config] cost-scaling:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] cost-type: ce-sum
[2023-06-27 09:08:07] [config] cpu-threads: 0
[2023-06-27 09:08:07] [config] data-threads: 8
[2023-06-27 09:08:07] [config] data-weighting: ""
[2023-06-27 09:08:07] [config] data-weighting-type: sentence
[2023-06-27 09:08:07] [config] dec-cell: gru
[2023-06-27 09:08:07] [config] dec-cell-base-depth: 2
[2023-06-27 09:08:07] [config] dec-cell-high-depth: 1
[2023-06-27 09:08:07] [config] dec-depth: 1
[2023-06-27 09:08:07] [config] devices:
[2023-06-27 09:08:07] [config]   - 0
[2023-06-27 09:08:07] [config] dim-emb: 512
[2023-06-27 09:08:07] [config] dim-rnn: 1024
[2023-06-27 09:08:07] [config] dim-vocabs:
[2023-06-27 09:08:07] [config]   - 16384
[2023-06-27 09:08:07] [config]   - 16384
[2023-06-27 09:08:07] [config] disp-first: 0
[2023-06-27 09:08:07] [config] disp-freq: 1000u
[2023-06-27 09:08:07] [config] disp-label-counts: true
[2023-06-27 09:08:07] [config] dropout-rnn: 0.2
[2023-06-27 09:08:07] [config] dropout-src: 0.1
[2023-06-27 09:08:07] [config] dropout-trg: 0.1
[2023-06-27 09:08:07] [config] dump-config: ""
[2023-06-27 09:08:07] [config] dynamic-gradient-scaling:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] early-stopping: 10
[2023-06-27 09:08:07] [config] early-stopping-on: first
[2023-06-27 09:08:07] [config] embedding-fix-src: false
[2023-06-27 09:08:07] [config] embedding-fix-trg: false
[2023-06-27 09:08:07] [config] embedding-normalization: false
[2023-06-27 09:08:07] [config] embedding-vectors:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] enc-cell: gru
[2023-06-27 09:08:07] [config] enc-cell-depth: 1
[2023-06-27 09:08:07] [config] enc-depth: 1
[2023-06-27 09:08:07] [config] enc-type: bidirectional
[2023-06-27 09:08:07] [config] english-title-case-every: 0
[2023-06-27 09:08:07] [config] exponential-smoothing: 0
[2023-06-27 09:08:07] [config] factor-weight: 1
[2023-06-27 09:08:07] [config] factors-combine: sum
[2023-06-27 09:08:07] [config] factors-dim-emb: 0
[2023-06-27 09:08:07] [config] gradient-checkpointing: false
[2023-06-27 09:08:07] [config] gradient-norm-average-window: 100
[2023-06-27 09:08:07] [config] guided-alignment: none
[2023-06-27 09:08:07] [config] guided-alignment-cost: mse
[2023-06-27 09:08:07] [config] guided-alignment-weight: 0.1
[2023-06-27 09:08:07] [config] ignore-model-config: false
[2023-06-27 09:08:07] [config] input-types:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] interpolate-env-vars: false
[2023-06-27 09:08:07] [config] keep-best: false
[2023-06-27 09:08:07] [config] label-smoothing: 0
[2023-06-27 09:08:07] [config] layer-normalization: true
[2023-06-27 09:08:07] [config] learn-rate: 0.0001
[2023-06-27 09:08:07] [config] lemma-dependency: ""
[2023-06-27 09:08:07] [config] lemma-dim-emb: 0
[2023-06-27 09:08:07] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 09:08:07] [config] log-level: info
[2023-06-27 09:08:07] [config] log-time-zone: ""
[2023-06-27 09:08:07] [config] logical-epoch:
[2023-06-27 09:08:07] [config]   - 1e
[2023-06-27 09:08:07] [config]   - 0
[2023-06-27 09:08:07] [config] lr-decay: 0
[2023-06-27 09:08:07] [config] lr-decay-freq: 50000
[2023-06-27 09:08:07] [config] lr-decay-inv-sqrt:
[2023-06-27 09:08:07] [config]   - 0
[2023-06-27 09:08:07] [config] lr-decay-repeat-warmup: false
[2023-06-27 09:08:07] [config] lr-decay-reset-optimizer: false
[2023-06-27 09:08:07] [config] lr-decay-start:
[2023-06-27 09:08:07] [config]   - 10
[2023-06-27 09:08:07] [config]   - 1
[2023-06-27 09:08:07] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 09:08:07] [config] lr-report: false
[2023-06-27 09:08:07] [config] lr-warmup: 0
[2023-06-27 09:08:07] [config] lr-warmup-at-reload: false
[2023-06-27 09:08:07] [config] lr-warmup-cycle: false
[2023-06-27 09:08:07] [config] lr-warmup-start-rate: 0
[2023-06-27 09:08:07] [config] max-length: 50
[2023-06-27 09:08:07] [config] max-length-crop: false
[2023-06-27 09:08:07] [config] max-length-factor: 3
[2023-06-27 09:08:07] [config] maxi-batch: 100
[2023-06-27 09:08:07] [config] maxi-batch-sort: trg
[2023-06-27 09:08:07] [config] mini-batch: 64
[2023-06-27 09:08:07] [config] mini-batch-fit: true
[2023-06-27 09:08:07] [config] mini-batch-fit-step: 10
[2023-06-27 09:08:07] [config] mini-batch-round-up: true
[2023-06-27 09:08:07] [config] mini-batch-track-lr: false
[2023-06-27 09:08:07] [config] mini-batch-warmup: 0
[2023-06-27 09:08:07] [config] mini-batch-words: 0
[2023-06-27 09:08:07] [config] mini-batch-words-ref: 0
[2023-06-27 09:08:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:08:07] [config] multi-loss-type: sum
[2023-06-27 09:08:07] [config] n-best: false
[2023-06-27 09:08:07] [config] no-nccl: false
[2023-06-27 09:08:07] [config] no-reload: false
[2023-06-27 09:08:07] [config] no-restore-corpus: false
[2023-06-27 09:08:07] [config] normalize: 0.6
[2023-06-27 09:08:07] [config] normalize-gradient: false
[2023-06-27 09:08:07] [config] num-devices: 0
[2023-06-27 09:08:07] [config] optimizer: adam
[2023-06-27 09:08:07] [config] optimizer-delay: 1
[2023-06-27 09:08:07] [config] optimizer-params:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] output-omit-bias: false
[2023-06-27 09:08:07] [config] overwrite: false
[2023-06-27 09:08:07] [config] precision:
[2023-06-27 09:08:07] [config]   - float32
[2023-06-27 09:08:07] [config]   - float32
[2023-06-27 09:08:07] [config] pretrained-model: ""
[2023-06-27 09:08:07] [config] quantize-biases: false
[2023-06-27 09:08:07] [config] quantize-bits: 0
[2023-06-27 09:08:07] [config] quantize-log-based: false
[2023-06-27 09:08:07] [config] quantize-optimization-steps: 0
[2023-06-27 09:08:07] [config] quiet: false
[2023-06-27 09:08:07] [config] quiet-translation: true
[2023-06-27 09:08:07] [config] relative-paths: false
[2023-06-27 09:08:07] [config] right-left: false
[2023-06-27 09:08:07] [config] save-freq: 10000u
[2023-06-27 09:08:07] [config] seed: 1234
[2023-06-27 09:08:07] [config] sentencepiece-alphas:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] sentencepiece-max-lines: 2000000
[2023-06-27 09:08:07] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 09:08:07] [config] sharding: global
[2023-06-27 09:08:07] [config] shuffle: data
[2023-06-27 09:08:07] [config] shuffle-in-ram: false
[2023-06-27 09:08:07] [config] sigterm: save-and-exit
[2023-06-27 09:08:07] [config] skip: false
[2023-06-27 09:08:07] [config] sqlite: ""
[2023-06-27 09:08:07] [config] sqlite-drop: false
[2023-06-27 09:08:07] [config] sync-freq: 200u
[2023-06-27 09:08:07] [config] sync-sgd: false
[2023-06-27 09:08:07] [config] tempdir: /tmp
[2023-06-27 09:08:07] [config] tied-embeddings: false
[2023-06-27 09:08:07] [config] tied-embeddings-all: true
[2023-06-27 09:08:07] [config] tied-embeddings-src: false
[2023-06-27 09:08:07] [config] train-embedder-rank:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] train-sets:
[2023-06-27 09:08:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 09:08:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 09:08:07] [config] transformer-aan-activation: swish
[2023-06-27 09:08:07] [config] transformer-aan-depth: 2
[2023-06-27 09:08:07] [config] transformer-aan-nogate: false
[2023-06-27 09:08:07] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 09:08:07] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 09:08:07] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 09:08:07] [config] transformer-depth-scaling: false
[2023-06-27 09:08:07] [config] transformer-dim-aan: 2048
[2023-06-27 09:08:07] [config] transformer-dim-ffn: 2048
[2023-06-27 09:08:07] [config] transformer-dropout: 0
[2023-06-27 09:08:07] [config] transformer-dropout-attention: 0
[2023-06-27 09:08:07] [config] transformer-dropout-ffn: 0
[2023-06-27 09:08:07] [config] transformer-ffn-activation: swish
[2023-06-27 09:08:07] [config] transformer-ffn-depth: 2
[2023-06-27 09:08:07] [config] transformer-guided-alignment-layer: last
[2023-06-27 09:08:07] [config] transformer-heads: 8
[2023-06-27 09:08:07] [config] transformer-no-projection: false
[2023-06-27 09:08:07] [config] transformer-pool: false
[2023-06-27 09:08:07] [config] transformer-postprocess: dan
[2023-06-27 09:08:07] [config] transformer-postprocess-emb: d
[2023-06-27 09:08:07] [config] transformer-postprocess-top: ""
[2023-06-27 09:08:07] [config] transformer-preprocess: ""
[2023-06-27 09:08:07] [config] transformer-tied-layers:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] transformer-train-position-embeddings: false
[2023-06-27 09:08:07] [config] tsv: false
[2023-06-27 09:08:07] [config] tsv-fields: 0
[2023-06-27 09:08:07] [config] type: amun
[2023-06-27 09:08:07] [config] ulr: false
[2023-06-27 09:08:07] [config] ulr-dim-emb: 0
[2023-06-27 09:08:07] [config] ulr-dropout: 0
[2023-06-27 09:08:07] [config] ulr-keys-vectors: ""
[2023-06-27 09:08:07] [config] ulr-query-vectors: ""
[2023-06-27 09:08:07] [config] ulr-softmax-temperature: 1
[2023-06-27 09:08:07] [config] ulr-trainable-transformation: false
[2023-06-27 09:08:07] [config] unlikelihood-loss: false
[2023-06-27 09:08:07] [config] valid-freq: 5000000
[2023-06-27 09:08:07] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 09:08:07] [config] valid-max-length: 1000
[2023-06-27 09:08:07] [config] valid-metrics:
[2023-06-27 09:08:07] [config]   - cross-entropy
[2023-06-27 09:08:07] [config]   - translation
[2023-06-27 09:08:07] [config] valid-mini-batch: 32
[2023-06-27 09:08:07] [config] valid-reset-stalled: false
[2023-06-27 09:08:07] [config] valid-script-args:
[2023-06-27 09:08:07] [config]   []
[2023-06-27 09:08:07] [config] valid-script-path: ""
[2023-06-27 09:08:07] [config] valid-sets:
[2023-06-27 09:08:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 09:08:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 09:08:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 09:08:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:08:07] [config] vocabs:
[2023-06-27 09:08:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:08:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:08:07] [config] word-penalty: 0
[2023-06-27 09:08:07] [config] word-scores: false
[2023-06-27 09:08:07] [config] workspace: 3000
[2023-06-27 09:08:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:08:07] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:08:07] [training] Using single-device training
[2023-06-27 09:08:08] Synced seed 1234
[2023-06-27 09:08:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:08:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 09:08:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:08:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 09:08:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 09:08:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:08:08] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:08:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:08:09] [comm] Using global sharding
[2023-06-27 09:08:09] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:08:09] [training] Using 1 GPUs
[2023-06-27 09:08:09] [logits] Applying loss function for 1 factor(s)
[2023-06-27 09:08:09] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:08:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 09:08:09] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:08:21] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 09:08:21] [valid] No post-processing script given for validating translator
[2023-06-27 09:08:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:08:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:08:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:08:22] [comm] Using global sharding
[2023-06-27 09:08:22] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:08:22] [training] Using 1 GPUs
[2023-06-27 09:08:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:08:23] Loading Adam parameters
[2023-06-27 09:08:23] [memory] Reserving 322 MB, device gpu0
[2023-06-27 09:08:23] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:08:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:08:23] [data] Restoring the corpus state to epoch 81, batch 8253
[2023-06-27 09:08:23] [data] Shuffling data
[2023-06-27 09:08:23] [data] Done reading 20,192 sentences
[2023-06-27 09:08:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:08:23] Training started
[2023-06-27 09:08:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 09:08:23] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:08:24] Parameter type float32, optimization type float32, casting types false
[2023-06-27 09:09:00] Seen 16,611 samples
[2023-06-27 09:09:00] Starting data epoch 82 in logical epoch 82
[2023-06-27 09:09:00] [data] Shuffling data
[2023-06-27 09:09:00] [data] Done reading 20,192 sentences
[2023-06-27 09:09:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:09:40] Seen 16,611 samples
[2023-06-27 09:09:40] Starting data epoch 83 in logical epoch 83
[2023-06-27 09:09:40] [data] Shuffling data
[2023-06-27 09:09:40] [data] Done reading 20,192 sentences
[2023-06-27 09:09:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:10:20] Seen 16,611 samples
[2023-06-27 09:10:20] Starting data epoch 84 in logical epoch 84
[2023-06-27 09:10:20] [data] Shuffling data
[2023-06-27 09:10:20] [data] Done reading 20,192 sentences
[2023-06-27 09:10:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:11:01] Seen 16,611 samples
[2023-06-27 09:11:01] Starting data epoch 85 in logical epoch 85
[2023-06-27 09:11:01] [data] Shuffling data
[2023-06-27 09:11:01] [data] Done reading 20,192 sentences
[2023-06-27 09:11:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:11:41] Seen 16,611 samples
[2023-06-27 09:11:41] Starting data epoch 86 in logical epoch 86
[2023-06-27 09:11:41] [data] Shuffling data
[2023-06-27 09:11:41] [data] Done reading 20,192 sentences
[2023-06-27 09:11:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:12:22] Seen 16,611 samples
[2023-06-27 09:12:22] Starting data epoch 87 in logical epoch 87
[2023-06-27 09:12:22] [data] Shuffling data
[2023-06-27 09:12:22] [data] Done reading 20,192 sentences
[2023-06-27 09:12:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:13:02] Seen 16,611 samples
[2023-06-27 09:13:02] Starting data epoch 88 in logical epoch 88
[2023-06-27 09:13:02] [data] Shuffling data
[2023-06-27 09:13:02] [data] Done reading 20,192 sentences
[2023-06-27 09:13:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:13:13] Ep. 88 : Up. 9000 : Sen. 3,703 : Cost 1.30207360 * 3,787,934 @ 5,615 after 33,967,695 : Time 291.41s : 12998.79 words/s : gNorm 1.1069
[2023-06-27 09:13:43] Seen 16,611 samples
[2023-06-27 09:13:43] Starting data epoch 89 in logical epoch 89
[2023-06-27 09:13:43] [data] Shuffling data
[2023-06-27 09:13:43] [data] Done reading 20,192 sentences
[2023-06-27 09:13:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:14:23] Seen 16,611 samples
[2023-06-27 09:14:23] Starting data epoch 90 in logical epoch 90
[2023-06-27 09:14:23] [data] Shuffling data
[2023-06-27 09:14:23] [data] Done reading 20,192 sentences
[2023-06-27 09:14:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:15:04] Seen 16,611 samples
[2023-06-27 09:15:04] Starting data epoch 91 in logical epoch 91
[2023-06-27 09:15:04] Training finished
[2023-06-27 09:15:13] [valid] Ep. 91 : Up. 9285 : cross-entropy : 120.644 : stalled 1 times (last best: 118.897)
[2023-06-27 09:15:46] [valid] Ep. 91 : Up. 9285 : translation : 0 : new best
[2023-06-27 09:15:46] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:15:48] Saving Adam parameters
[2023-06-27 09:15:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:18:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:18:58] [marian] Running on node20.datos.cluster.uy as process 35301 with command line:
[2023-06-27 09:18:58] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 09:18:58] [config] after: 0e
[2023-06-27 09:18:58] [config] after-batches: 0
[2023-06-27 09:18:58] [config] after-epochs: 100
[2023-06-27 09:18:58] [config] all-caps-every: 0
[2023-06-27 09:18:58] [config] allow-unk: false
[2023-06-27 09:18:58] [config] authors: false
[2023-06-27 09:18:58] [config] beam-size: 6
[2023-06-27 09:18:58] [config] bert-class-symbol: "[CLS]"
[2023-06-27 09:18:58] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 09:18:58] [config] bert-masking-fraction: 0.15
[2023-06-27 09:18:58] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 09:18:58] [config] bert-train-type-embeddings: true
[2023-06-27 09:18:58] [config] bert-type-vocab-size: 2
[2023-06-27 09:18:58] [config] build-info: ""
[2023-06-27 09:18:58] [config] check-gradient-nan: false
[2023-06-27 09:18:58] [config] check-nan: false
[2023-06-27 09:18:58] [config] cite: false
[2023-06-27 09:18:58] [config] clip-norm: 1
[2023-06-27 09:18:58] [config] cost-scaling:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] cost-type: ce-sum
[2023-06-27 09:18:58] [config] cpu-threads: 0
[2023-06-27 09:18:58] [config] data-threads: 8
[2023-06-27 09:18:58] [config] data-weighting: ""
[2023-06-27 09:18:58] [config] data-weighting-type: sentence
[2023-06-27 09:18:58] [config] dec-cell: gru
[2023-06-27 09:18:58] [config] dec-cell-base-depth: 2
[2023-06-27 09:18:58] [config] dec-cell-high-depth: 1
[2023-06-27 09:18:58] [config] dec-depth: 1
[2023-06-27 09:18:58] [config] devices:
[2023-06-27 09:18:58] [config]   - 0
[2023-06-27 09:18:58] [config] dim-emb: 512
[2023-06-27 09:18:58] [config] dim-rnn: 1024
[2023-06-27 09:18:58] [config] dim-vocabs:
[2023-06-27 09:18:58] [config]   - 16384
[2023-06-27 09:18:58] [config]   - 16384
[2023-06-27 09:18:58] [config] disp-first: 0
[2023-06-27 09:18:58] [config] disp-freq: 1000u
[2023-06-27 09:18:58] [config] disp-label-counts: true
[2023-06-27 09:18:58] [config] dropout-rnn: 0.2
[2023-06-27 09:18:58] [config] dropout-src: 0.1
[2023-06-27 09:18:58] [config] dropout-trg: 0.1
[2023-06-27 09:18:58] [config] dump-config: ""
[2023-06-27 09:18:58] [config] dynamic-gradient-scaling:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] early-stopping: 10
[2023-06-27 09:18:58] [config] early-stopping-on: first
[2023-06-27 09:18:58] [config] embedding-fix-src: false
[2023-06-27 09:18:58] [config] embedding-fix-trg: false
[2023-06-27 09:18:58] [config] embedding-normalization: false
[2023-06-27 09:18:58] [config] embedding-vectors:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] enc-cell: gru
[2023-06-27 09:18:58] [config] enc-cell-depth: 1
[2023-06-27 09:18:58] [config] enc-depth: 1
[2023-06-27 09:18:58] [config] enc-type: bidirectional
[2023-06-27 09:18:58] [config] english-title-case-every: 0
[2023-06-27 09:18:58] [config] exponential-smoothing: 0
[2023-06-27 09:18:58] [config] factor-weight: 1
[2023-06-27 09:18:58] [config] factors-combine: sum
[2023-06-27 09:18:58] [config] factors-dim-emb: 0
[2023-06-27 09:18:58] [config] gradient-checkpointing: false
[2023-06-27 09:18:58] [config] gradient-norm-average-window: 100
[2023-06-27 09:18:58] [config] guided-alignment: none
[2023-06-27 09:18:58] [config] guided-alignment-cost: mse
[2023-06-27 09:18:58] [config] guided-alignment-weight: 0.1
[2023-06-27 09:18:58] [config] ignore-model-config: false
[2023-06-27 09:18:58] [config] input-types:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] interpolate-env-vars: false
[2023-06-27 09:18:58] [config] keep-best: false
[2023-06-27 09:18:58] [config] label-smoothing: 0
[2023-06-27 09:18:58] [config] layer-normalization: true
[2023-06-27 09:18:58] [config] learn-rate: 0.0001
[2023-06-27 09:18:58] [config] lemma-dependency: ""
[2023-06-27 09:18:58] [config] lemma-dim-emb: 0
[2023-06-27 09:18:58] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 09:18:58] [config] log-level: info
[2023-06-27 09:18:58] [config] log-time-zone: ""
[2023-06-27 09:18:58] [config] logical-epoch:
[2023-06-27 09:18:58] [config]   - 1e
[2023-06-27 09:18:58] [config]   - 0
[2023-06-27 09:18:58] [config] lr-decay: 0
[2023-06-27 09:18:58] [config] lr-decay-freq: 50000
[2023-06-27 09:18:58] [config] lr-decay-inv-sqrt:
[2023-06-27 09:18:58] [config]   - 0
[2023-06-27 09:18:58] [config] lr-decay-repeat-warmup: false
[2023-06-27 09:18:58] [config] lr-decay-reset-optimizer: false
[2023-06-27 09:18:58] [config] lr-decay-start:
[2023-06-27 09:18:58] [config]   - 10
[2023-06-27 09:18:58] [config]   - 1
[2023-06-27 09:18:58] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 09:18:58] [config] lr-report: false
[2023-06-27 09:18:58] [config] lr-warmup: 0
[2023-06-27 09:18:58] [config] lr-warmup-at-reload: false
[2023-06-27 09:18:58] [config] lr-warmup-cycle: false
[2023-06-27 09:18:58] [config] lr-warmup-start-rate: 0
[2023-06-27 09:18:58] [config] max-length: 50
[2023-06-27 09:18:58] [config] max-length-crop: false
[2023-06-27 09:18:58] [config] max-length-factor: 3
[2023-06-27 09:18:58] [config] maxi-batch: 100
[2023-06-27 09:18:58] [config] maxi-batch-sort: trg
[2023-06-27 09:18:58] [config] mini-batch: 64
[2023-06-27 09:18:58] [config] mini-batch-fit: true
[2023-06-27 09:18:58] [config] mini-batch-fit-step: 10
[2023-06-27 09:18:58] [config] mini-batch-round-up: true
[2023-06-27 09:18:58] [config] mini-batch-track-lr: false
[2023-06-27 09:18:58] [config] mini-batch-warmup: 0
[2023-06-27 09:18:58] [config] mini-batch-words: 0
[2023-06-27 09:18:58] [config] mini-batch-words-ref: 0
[2023-06-27 09:18:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:18:58] [config] multi-loss-type: sum
[2023-06-27 09:18:58] [config] n-best: false
[2023-06-27 09:18:58] [config] no-nccl: false
[2023-06-27 09:18:58] [config] no-reload: false
[2023-06-27 09:18:58] [config] no-restore-corpus: false
[2023-06-27 09:18:58] [config] normalize: 0.6
[2023-06-27 09:18:58] [config] normalize-gradient: false
[2023-06-27 09:18:58] [config] num-devices: 0
[2023-06-27 09:18:58] [config] optimizer: adam
[2023-06-27 09:18:58] [config] optimizer-delay: 1
[2023-06-27 09:18:58] [config] optimizer-params:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] output-omit-bias: false
[2023-06-27 09:18:58] [config] overwrite: false
[2023-06-27 09:18:58] [config] precision:
[2023-06-27 09:18:58] [config]   - float32
[2023-06-27 09:18:58] [config]   - float32
[2023-06-27 09:18:58] [config] pretrained-model: ""
[2023-06-27 09:18:58] [config] quantize-biases: false
[2023-06-27 09:18:58] [config] quantize-bits: 0
[2023-06-27 09:18:58] [config] quantize-log-based: false
[2023-06-27 09:18:58] [config] quantize-optimization-steps: 0
[2023-06-27 09:18:58] [config] quiet: false
[2023-06-27 09:18:58] [config] quiet-translation: true
[2023-06-27 09:18:58] [config] relative-paths: false
[2023-06-27 09:18:58] [config] right-left: false
[2023-06-27 09:18:58] [config] save-freq: 10000u
[2023-06-27 09:18:58] [config] seed: 1234
[2023-06-27 09:18:58] [config] sentencepiece-alphas:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] sentencepiece-max-lines: 2000000
[2023-06-27 09:18:58] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 09:18:58] [config] sharding: global
[2023-06-27 09:18:58] [config] shuffle: data
[2023-06-27 09:18:58] [config] shuffle-in-ram: false
[2023-06-27 09:18:58] [config] sigterm: save-and-exit
[2023-06-27 09:18:58] [config] skip: false
[2023-06-27 09:18:58] [config] sqlite: ""
[2023-06-27 09:18:58] [config] sqlite-drop: false
[2023-06-27 09:18:58] [config] sync-freq: 200u
[2023-06-27 09:18:58] [config] sync-sgd: false
[2023-06-27 09:18:58] [config] tempdir: /tmp
[2023-06-27 09:18:58] [config] tied-embeddings: false
[2023-06-27 09:18:58] [config] tied-embeddings-all: true
[2023-06-27 09:18:58] [config] tied-embeddings-src: false
[2023-06-27 09:18:58] [config] train-embedder-rank:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] train-sets:
[2023-06-27 09:18:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 09:18:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 09:18:58] [config] transformer-aan-activation: swish
[2023-06-27 09:18:58] [config] transformer-aan-depth: 2
[2023-06-27 09:18:58] [config] transformer-aan-nogate: false
[2023-06-27 09:18:58] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 09:18:58] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 09:18:58] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 09:18:58] [config] transformer-depth-scaling: false
[2023-06-27 09:18:58] [config] transformer-dim-aan: 2048
[2023-06-27 09:18:58] [config] transformer-dim-ffn: 2048
[2023-06-27 09:18:58] [config] transformer-dropout: 0
[2023-06-27 09:18:58] [config] transformer-dropout-attention: 0
[2023-06-27 09:18:58] [config] transformer-dropout-ffn: 0
[2023-06-27 09:18:58] [config] transformer-ffn-activation: swish
[2023-06-27 09:18:58] [config] transformer-ffn-depth: 2
[2023-06-27 09:18:58] [config] transformer-guided-alignment-layer: last
[2023-06-27 09:18:58] [config] transformer-heads: 8
[2023-06-27 09:18:58] [config] transformer-no-projection: false
[2023-06-27 09:18:58] [config] transformer-pool: false
[2023-06-27 09:18:58] [config] transformer-postprocess: dan
[2023-06-27 09:18:58] [config] transformer-postprocess-emb: d
[2023-06-27 09:18:58] [config] transformer-postprocess-top: ""
[2023-06-27 09:18:58] [config] transformer-preprocess: ""
[2023-06-27 09:18:58] [config] transformer-tied-layers:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] transformer-train-position-embeddings: false
[2023-06-27 09:18:58] [config] tsv: false
[2023-06-27 09:18:58] [config] tsv-fields: 0
[2023-06-27 09:18:58] [config] type: amun
[2023-06-27 09:18:58] [config] ulr: false
[2023-06-27 09:18:58] [config] ulr-dim-emb: 0
[2023-06-27 09:18:58] [config] ulr-dropout: 0
[2023-06-27 09:18:58] [config] ulr-keys-vectors: ""
[2023-06-27 09:18:58] [config] ulr-query-vectors: ""
[2023-06-27 09:18:58] [config] ulr-softmax-temperature: 1
[2023-06-27 09:18:58] [config] ulr-trainable-transformation: false
[2023-06-27 09:18:58] [config] unlikelihood-loss: false
[2023-06-27 09:18:58] [config] valid-freq: 5000000
[2023-06-27 09:18:58] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 09:18:58] [config] valid-max-length: 1000
[2023-06-27 09:18:58] [config] valid-metrics:
[2023-06-27 09:18:58] [config]   - cross-entropy
[2023-06-27 09:18:58] [config]   - translation
[2023-06-27 09:18:58] [config] valid-mini-batch: 32
[2023-06-27 09:18:58] [config] valid-reset-stalled: false
[2023-06-27 09:18:58] [config] valid-script-args:
[2023-06-27 09:18:58] [config]   []
[2023-06-27 09:18:58] [config] valid-script-path: ""
[2023-06-27 09:18:58] [config] valid-sets:
[2023-06-27 09:18:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 09:18:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 09:18:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 09:18:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:18:58] [config] vocabs:
[2023-06-27 09:18:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:18:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:18:58] [config] word-penalty: 0
[2023-06-27 09:18:58] [config] word-scores: false
[2023-06-27 09:18:58] [config] workspace: 3000
[2023-06-27 09:18:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:18:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:18:58] [training] Using single-device training
[2023-06-27 09:18:59] Synced seed 1234
[2023-06-27 09:18:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:18:59] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 09:18:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:18:59] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 09:18:59] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 09:18:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:19:00] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:19:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:19:00] [comm] Using global sharding
[2023-06-27 09:19:00] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:19:00] [training] Using 1 GPUs
[2023-06-27 09:19:00] [logits] Applying loss function for 1 factor(s)
[2023-06-27 09:19:00] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:19:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 09:19:00] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:19:12] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 09:19:12] [valid] No post-processing script given for validating translator
[2023-06-27 09:19:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:19:12] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:19:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:19:12] [comm] Using global sharding
[2023-06-27 09:19:13] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:19:13] [training] Using 1 GPUs
[2023-06-27 09:19:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:19:13] Loading Adam parameters
[2023-06-27 09:19:14] [memory] Reserving 322 MB, device gpu0
[2023-06-27 09:19:14] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:19:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:19:14] [data] Restoring the corpus state to epoch 91, batch 9285
[2023-06-27 09:19:14] [data] Shuffling data
[2023-06-27 09:19:14] [data] Done reading 20,192 sentences
[2023-06-27 09:19:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:19:14] Training started
[2023-06-27 09:19:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 09:19:14] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:19:14] Parameter type float32, optimization type float32, casting types false
[2023-06-27 09:19:51] Seen 16,611 samples
[2023-06-27 09:19:51] Starting data epoch 92 in logical epoch 92
[2023-06-27 09:19:51] [data] Shuffling data
[2023-06-27 09:19:51] [data] Done reading 20,192 sentences
[2023-06-27 09:19:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:20:31] Seen 16,611 samples
[2023-06-27 09:20:31] Starting data epoch 93 in logical epoch 93
[2023-06-27 09:20:31] [data] Shuffling data
[2023-06-27 09:20:31] [data] Done reading 20,192 sentences
[2023-06-27 09:20:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:21:11] Seen 16,611 samples
[2023-06-27 09:21:11] Starting data epoch 94 in logical epoch 94
[2023-06-27 09:21:11] [data] Shuffling data
[2023-06-27 09:21:11] [data] Done reading 20,192 sentences
[2023-06-27 09:21:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:21:52] Seen 16,611 samples
[2023-06-27 09:21:52] Starting data epoch 95 in logical epoch 95
[2023-06-27 09:21:52] [data] Shuffling data
[2023-06-27 09:21:52] [data] Done reading 20,192 sentences
[2023-06-27 09:21:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:22:33] Seen 16,611 samples
[2023-06-27 09:22:33] Starting data epoch 96 in logical epoch 96
[2023-06-27 09:22:33] [data] Shuffling data
[2023-06-27 09:22:33] [data] Done reading 20,192 sentences
[2023-06-27 09:22:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:23:13] Seen 16,611 samples
[2023-06-27 09:23:13] Starting data epoch 97 in logical epoch 97
[2023-06-27 09:23:13] [data] Shuffling data
[2023-06-27 09:23:13] [data] Done reading 20,192 sentences
[2023-06-27 09:23:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:23:50] Ep. 97 : Up. 10000 : Sen. 15,141 : Cost 1.10872293 * 3,756,616 @ 2,556 after 37,724,311 : Time 277.54s : 13535.30 words/s : gNorm 1.0776
[2023-06-27 09:23:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.iter10000.npz
[2023-06-27 09:23:52] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:23:53] Saving Adam parameters
[2023-06-27 09:23:54] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:24:02] Seen 16,611 samples
[2023-06-27 09:24:02] Starting data epoch 98 in logical epoch 98
[2023-06-27 09:24:02] [data] Shuffling data
[2023-06-27 09:24:02] [data] Done reading 20,192 sentences
[2023-06-27 09:24:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:24:41] Seen 16,611 samples
[2023-06-27 09:24:41] Starting data epoch 99 in logical epoch 99
[2023-06-27 09:24:41] [data] Shuffling data
[2023-06-27 09:24:41] [data] Done reading 20,192 sentences
[2023-06-27 09:24:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:25:22] Seen 16,611 samples
[2023-06-27 09:25:22] Starting data epoch 100 in logical epoch 100
[2023-06-27 09:25:22] [data] Shuffling data
[2023-06-27 09:25:22] [data] Done reading 20,192 sentences
[2023-06-27 09:25:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:26:02] Seen 16,611 samples
[2023-06-27 09:26:02] Starting data epoch 101 in logical epoch 101
[2023-06-27 09:26:02] Training finished
[2023-06-27 09:26:11] [valid] Ep. 101 : Up. 10321 : cross-entropy : 121.571 : stalled 2 times (last best: 118.897)
[2023-06-27 09:26:45] [valid] Ep. 101 : Up. 10321 : translation : 0 : new best
[2023-06-27 09:26:45] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:26:47] Saving Adam parameters
[2023-06-27 09:26:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:30:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:30:04] [marian] Running on node20.datos.cluster.uy as process 35950 with command line:
[2023-06-27 09:30:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 110 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 09:30:04] [config] after: 0e
[2023-06-27 09:30:04] [config] after-batches: 0
[2023-06-27 09:30:04] [config] after-epochs: 110
[2023-06-27 09:30:04] [config] all-caps-every: 0
[2023-06-27 09:30:04] [config] allow-unk: false
[2023-06-27 09:30:04] [config] authors: false
[2023-06-27 09:30:04] [config] beam-size: 6
[2023-06-27 09:30:04] [config] bert-class-symbol: "[CLS]"
[2023-06-27 09:30:04] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 09:30:04] [config] bert-masking-fraction: 0.15
[2023-06-27 09:30:04] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 09:30:04] [config] bert-train-type-embeddings: true
[2023-06-27 09:30:04] [config] bert-type-vocab-size: 2
[2023-06-27 09:30:04] [config] build-info: ""
[2023-06-27 09:30:04] [config] check-gradient-nan: false
[2023-06-27 09:30:04] [config] check-nan: false
[2023-06-27 09:30:04] [config] cite: false
[2023-06-27 09:30:04] [config] clip-norm: 1
[2023-06-27 09:30:04] [config] cost-scaling:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] cost-type: ce-sum
[2023-06-27 09:30:04] [config] cpu-threads: 0
[2023-06-27 09:30:04] [config] data-threads: 8
[2023-06-27 09:30:04] [config] data-weighting: ""
[2023-06-27 09:30:04] [config] data-weighting-type: sentence
[2023-06-27 09:30:04] [config] dec-cell: gru
[2023-06-27 09:30:04] [config] dec-cell-base-depth: 2
[2023-06-27 09:30:04] [config] dec-cell-high-depth: 1
[2023-06-27 09:30:04] [config] dec-depth: 1
[2023-06-27 09:30:04] [config] devices:
[2023-06-27 09:30:04] [config]   - 0
[2023-06-27 09:30:04] [config] dim-emb: 512
[2023-06-27 09:30:04] [config] dim-rnn: 1024
[2023-06-27 09:30:04] [config] dim-vocabs:
[2023-06-27 09:30:04] [config]   - 16384
[2023-06-27 09:30:04] [config]   - 16384
[2023-06-27 09:30:04] [config] disp-first: 0
[2023-06-27 09:30:04] [config] disp-freq: 1000u
[2023-06-27 09:30:04] [config] disp-label-counts: true
[2023-06-27 09:30:04] [config] dropout-rnn: 0.2
[2023-06-27 09:30:04] [config] dropout-src: 0.1
[2023-06-27 09:30:04] [config] dropout-trg: 0.1
[2023-06-27 09:30:04] [config] dump-config: ""
[2023-06-27 09:30:04] [config] dynamic-gradient-scaling:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] early-stopping: 10
[2023-06-27 09:30:04] [config] early-stopping-on: first
[2023-06-27 09:30:04] [config] embedding-fix-src: false
[2023-06-27 09:30:04] [config] embedding-fix-trg: false
[2023-06-27 09:30:04] [config] embedding-normalization: false
[2023-06-27 09:30:04] [config] embedding-vectors:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] enc-cell: gru
[2023-06-27 09:30:04] [config] enc-cell-depth: 1
[2023-06-27 09:30:04] [config] enc-depth: 1
[2023-06-27 09:30:04] [config] enc-type: bidirectional
[2023-06-27 09:30:04] [config] english-title-case-every: 0
[2023-06-27 09:30:04] [config] exponential-smoothing: 0
[2023-06-27 09:30:04] [config] factor-weight: 1
[2023-06-27 09:30:04] [config] factors-combine: sum
[2023-06-27 09:30:04] [config] factors-dim-emb: 0
[2023-06-27 09:30:04] [config] gradient-checkpointing: false
[2023-06-27 09:30:04] [config] gradient-norm-average-window: 100
[2023-06-27 09:30:04] [config] guided-alignment: none
[2023-06-27 09:30:04] [config] guided-alignment-cost: mse
[2023-06-27 09:30:04] [config] guided-alignment-weight: 0.1
[2023-06-27 09:30:04] [config] ignore-model-config: false
[2023-06-27 09:30:04] [config] input-types:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] interpolate-env-vars: false
[2023-06-27 09:30:04] [config] keep-best: false
[2023-06-27 09:30:04] [config] label-smoothing: 0
[2023-06-27 09:30:04] [config] layer-normalization: true
[2023-06-27 09:30:04] [config] learn-rate: 0.0001
[2023-06-27 09:30:04] [config] lemma-dependency: ""
[2023-06-27 09:30:04] [config] lemma-dim-emb: 0
[2023-06-27 09:30:04] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 09:30:04] [config] log-level: info
[2023-06-27 09:30:04] [config] log-time-zone: ""
[2023-06-27 09:30:04] [config] logical-epoch:
[2023-06-27 09:30:04] [config]   - 1e
[2023-06-27 09:30:04] [config]   - 0
[2023-06-27 09:30:04] [config] lr-decay: 0
[2023-06-27 09:30:04] [config] lr-decay-freq: 50000
[2023-06-27 09:30:04] [config] lr-decay-inv-sqrt:
[2023-06-27 09:30:04] [config]   - 0
[2023-06-27 09:30:04] [config] lr-decay-repeat-warmup: false
[2023-06-27 09:30:04] [config] lr-decay-reset-optimizer: false
[2023-06-27 09:30:04] [config] lr-decay-start:
[2023-06-27 09:30:04] [config]   - 10
[2023-06-27 09:30:04] [config]   - 1
[2023-06-27 09:30:04] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 09:30:04] [config] lr-report: false
[2023-06-27 09:30:04] [config] lr-warmup: 0
[2023-06-27 09:30:04] [config] lr-warmup-at-reload: false
[2023-06-27 09:30:04] [config] lr-warmup-cycle: false
[2023-06-27 09:30:04] [config] lr-warmup-start-rate: 0
[2023-06-27 09:30:04] [config] max-length: 50
[2023-06-27 09:30:04] [config] max-length-crop: false
[2023-06-27 09:30:04] [config] max-length-factor: 3
[2023-06-27 09:30:04] [config] maxi-batch: 100
[2023-06-27 09:30:04] [config] maxi-batch-sort: trg
[2023-06-27 09:30:04] [config] mini-batch: 64
[2023-06-27 09:30:04] [config] mini-batch-fit: true
[2023-06-27 09:30:04] [config] mini-batch-fit-step: 10
[2023-06-27 09:30:04] [config] mini-batch-round-up: true
[2023-06-27 09:30:04] [config] mini-batch-track-lr: false
[2023-06-27 09:30:04] [config] mini-batch-warmup: 0
[2023-06-27 09:30:04] [config] mini-batch-words: 0
[2023-06-27 09:30:04] [config] mini-batch-words-ref: 0
[2023-06-27 09:30:04] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:30:04] [config] multi-loss-type: sum
[2023-06-27 09:30:04] [config] n-best: false
[2023-06-27 09:30:04] [config] no-nccl: false
[2023-06-27 09:30:04] [config] no-reload: false
[2023-06-27 09:30:04] [config] no-restore-corpus: false
[2023-06-27 09:30:04] [config] normalize: 0.6
[2023-06-27 09:30:04] [config] normalize-gradient: false
[2023-06-27 09:30:04] [config] num-devices: 0
[2023-06-27 09:30:04] [config] optimizer: adam
[2023-06-27 09:30:04] [config] optimizer-delay: 1
[2023-06-27 09:30:04] [config] optimizer-params:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] output-omit-bias: false
[2023-06-27 09:30:04] [config] overwrite: false
[2023-06-27 09:30:04] [config] precision:
[2023-06-27 09:30:04] [config]   - float32
[2023-06-27 09:30:04] [config]   - float32
[2023-06-27 09:30:04] [config] pretrained-model: ""
[2023-06-27 09:30:04] [config] quantize-biases: false
[2023-06-27 09:30:04] [config] quantize-bits: 0
[2023-06-27 09:30:04] [config] quantize-log-based: false
[2023-06-27 09:30:04] [config] quantize-optimization-steps: 0
[2023-06-27 09:30:04] [config] quiet: false
[2023-06-27 09:30:04] [config] quiet-translation: true
[2023-06-27 09:30:04] [config] relative-paths: false
[2023-06-27 09:30:04] [config] right-left: false
[2023-06-27 09:30:04] [config] save-freq: 10000u
[2023-06-27 09:30:04] [config] seed: 1234
[2023-06-27 09:30:04] [config] sentencepiece-alphas:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] sentencepiece-max-lines: 2000000
[2023-06-27 09:30:04] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 09:30:04] [config] sharding: global
[2023-06-27 09:30:04] [config] shuffle: data
[2023-06-27 09:30:04] [config] shuffle-in-ram: false
[2023-06-27 09:30:04] [config] sigterm: save-and-exit
[2023-06-27 09:30:04] [config] skip: false
[2023-06-27 09:30:04] [config] sqlite: ""
[2023-06-27 09:30:04] [config] sqlite-drop: false
[2023-06-27 09:30:04] [config] sync-freq: 200u
[2023-06-27 09:30:04] [config] sync-sgd: false
[2023-06-27 09:30:04] [config] tempdir: /tmp
[2023-06-27 09:30:04] [config] tied-embeddings: false
[2023-06-27 09:30:04] [config] tied-embeddings-all: true
[2023-06-27 09:30:04] [config] tied-embeddings-src: false
[2023-06-27 09:30:04] [config] train-embedder-rank:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] train-sets:
[2023-06-27 09:30:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 09:30:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 09:30:04] [config] transformer-aan-activation: swish
[2023-06-27 09:30:04] [config] transformer-aan-depth: 2
[2023-06-27 09:30:04] [config] transformer-aan-nogate: false
[2023-06-27 09:30:04] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 09:30:04] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 09:30:04] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 09:30:04] [config] transformer-depth-scaling: false
[2023-06-27 09:30:04] [config] transformer-dim-aan: 2048
[2023-06-27 09:30:04] [config] transformer-dim-ffn: 2048
[2023-06-27 09:30:04] [config] transformer-dropout: 0
[2023-06-27 09:30:04] [config] transformer-dropout-attention: 0
[2023-06-27 09:30:04] [config] transformer-dropout-ffn: 0
[2023-06-27 09:30:04] [config] transformer-ffn-activation: swish
[2023-06-27 09:30:04] [config] transformer-ffn-depth: 2
[2023-06-27 09:30:04] [config] transformer-guided-alignment-layer: last
[2023-06-27 09:30:04] [config] transformer-heads: 8
[2023-06-27 09:30:04] [config] transformer-no-projection: false
[2023-06-27 09:30:04] [config] transformer-pool: false
[2023-06-27 09:30:04] [config] transformer-postprocess: dan
[2023-06-27 09:30:04] [config] transformer-postprocess-emb: d
[2023-06-27 09:30:04] [config] transformer-postprocess-top: ""
[2023-06-27 09:30:04] [config] transformer-preprocess: ""
[2023-06-27 09:30:04] [config] transformer-tied-layers:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] transformer-train-position-embeddings: false
[2023-06-27 09:30:04] [config] tsv: false
[2023-06-27 09:30:04] [config] tsv-fields: 0
[2023-06-27 09:30:04] [config] type: amun
[2023-06-27 09:30:04] [config] ulr: false
[2023-06-27 09:30:04] [config] ulr-dim-emb: 0
[2023-06-27 09:30:04] [config] ulr-dropout: 0
[2023-06-27 09:30:04] [config] ulr-keys-vectors: ""
[2023-06-27 09:30:04] [config] ulr-query-vectors: ""
[2023-06-27 09:30:04] [config] ulr-softmax-temperature: 1
[2023-06-27 09:30:04] [config] ulr-trainable-transformation: false
[2023-06-27 09:30:04] [config] unlikelihood-loss: false
[2023-06-27 09:30:04] [config] valid-freq: 5000000
[2023-06-27 09:30:04] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 09:30:04] [config] valid-max-length: 1000
[2023-06-27 09:30:04] [config] valid-metrics:
[2023-06-27 09:30:04] [config]   - cross-entropy
[2023-06-27 09:30:04] [config]   - translation
[2023-06-27 09:30:04] [config] valid-mini-batch: 32
[2023-06-27 09:30:04] [config] valid-reset-stalled: false
[2023-06-27 09:30:04] [config] valid-script-args:
[2023-06-27 09:30:04] [config]   []
[2023-06-27 09:30:04] [config] valid-script-path: ""
[2023-06-27 09:30:04] [config] valid-sets:
[2023-06-27 09:30:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 09:30:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 09:30:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 09:30:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:30:04] [config] vocabs:
[2023-06-27 09:30:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:30:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:30:04] [config] word-penalty: 0
[2023-06-27 09:30:04] [config] word-scores: false
[2023-06-27 09:30:04] [config] workspace: 3000
[2023-06-27 09:30:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:30:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:30:04] [training] Using single-device training
[2023-06-27 09:30:04] Synced seed 1234
[2023-06-27 09:30:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:30:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 09:30:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:30:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 09:30:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 09:30:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:30:05] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:30:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:30:05] [comm] Using global sharding
[2023-06-27 09:30:05] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:30:05] [training] Using 1 GPUs
[2023-06-27 09:30:05] [logits] Applying loss function for 1 factor(s)
[2023-06-27 09:30:05] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:30:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 09:30:06] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:30:18] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 09:30:18] [valid] No post-processing script given for validating translator
[2023-06-27 09:30:18] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:30:18] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:30:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:30:18] [comm] Using global sharding
[2023-06-27 09:30:18] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:30:18] [training] Using 1 GPUs
[2023-06-27 09:30:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:30:19] Loading Adam parameters
[2023-06-27 09:30:19] [memory] Reserving 322 MB, device gpu0
[2023-06-27 09:30:19] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:30:19] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:30:19] [data] Restoring the corpus state to epoch 101, batch 10321
[2023-06-27 09:30:19] [data] Shuffling data
[2023-06-27 09:30:19] [data] Done reading 20,192 sentences
[2023-06-27 09:30:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:30:19] Training started
[2023-06-27 09:30:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 09:30:19] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:30:20] Parameter type float32, optimization type float32, casting types false
[2023-06-27 09:30:56] Seen 16,611 samples
[2023-06-27 09:30:56] Starting data epoch 102 in logical epoch 102
[2023-06-27 09:30:56] [data] Shuffling data
[2023-06-27 09:30:56] [data] Done reading 20,192 sentences
[2023-06-27 09:30:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:31:36] Seen 16,611 samples
[2023-06-27 09:31:36] Starting data epoch 103 in logical epoch 103
[2023-06-27 09:31:36] [data] Shuffling data
[2023-06-27 09:31:36] [data] Done reading 20,192 sentences
[2023-06-27 09:31:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:32:17] Seen 16,611 samples
[2023-06-27 09:32:17] Starting data epoch 104 in logical epoch 104
[2023-06-27 09:32:17] [data] Shuffling data
[2023-06-27 09:32:17] [data] Done reading 20,192 sentences
[2023-06-27 09:32:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:32:57] Seen 16,611 samples
[2023-06-27 09:32:57] Starting data epoch 105 in logical epoch 105
[2023-06-27 09:32:57] [data] Shuffling data
[2023-06-27 09:32:57] [data] Done reading 20,192 sentences
[2023-06-27 09:32:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:33:38] Seen 16,611 samples
[2023-06-27 09:33:38] Starting data epoch 106 in logical epoch 106
[2023-06-27 09:33:38] [data] Shuffling data
[2023-06-27 09:33:38] [data] Done reading 20,192 sentences
[2023-06-27 09:33:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:34:18] Seen 16,611 samples
[2023-06-27 09:34:18] Starting data epoch 107 in logical epoch 107
[2023-06-27 09:34:18] [data] Shuffling data
[2023-06-27 09:34:18] [data] Done reading 20,192 sentences
[2023-06-27 09:34:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:34:42] Ep. 107 : Up. 11000 : Sen. 9,816 : Cost 0.96790016 * 3,772,650 @ 2,527 after 41,496,961 : Time 264.03s : 14288.76 words/s : gNorm 1.0100
[2023-06-27 09:34:59] Seen 16,611 samples
[2023-06-27 09:34:59] Starting data epoch 108 in logical epoch 108
[2023-06-27 09:34:59] [data] Shuffling data
[2023-06-27 09:34:59] [data] Done reading 20,192 sentences
[2023-06-27 09:34:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:35:40] Seen 16,611 samples
[2023-06-27 09:35:40] Starting data epoch 109 in logical epoch 109
[2023-06-27 09:35:40] [data] Shuffling data
[2023-06-27 09:35:40] [data] Done reading 20,192 sentences
[2023-06-27 09:35:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:36:20] Seen 16,611 samples
[2023-06-27 09:36:20] Starting data epoch 110 in logical epoch 110
[2023-06-27 09:36:20] [data] Shuffling data
[2023-06-27 09:36:20] [data] Done reading 20,192 sentences
[2023-06-27 09:36:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:37:01] Seen 16,611 samples
[2023-06-27 09:37:01] Starting data epoch 111 in logical epoch 111
[2023-06-27 09:37:01] Training finished
[2023-06-27 09:37:09] [valid] Ep. 111 : Up. 11355 : cross-entropy : 122.385 : stalled 3 times (last best: 118.897)
[2023-06-27 09:37:43] [valid] Ep. 111 : Up. 11355 : translation : 0 : new best
[2023-06-27 09:37:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:37:45] Saving Adam parameters
[2023-06-27 09:37:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:41:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:41:02] [marian] Running on node20.datos.cluster.uy as process 36919 with command line:
[2023-06-27 09:41:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 120 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 09:41:03] [config] after: 0e
[2023-06-27 09:41:03] [config] after-batches: 0
[2023-06-27 09:41:03] [config] after-epochs: 120
[2023-06-27 09:41:03] [config] all-caps-every: 0
[2023-06-27 09:41:03] [config] allow-unk: false
[2023-06-27 09:41:03] [config] authors: false
[2023-06-27 09:41:03] [config] beam-size: 6
[2023-06-27 09:41:03] [config] bert-class-symbol: "[CLS]"
[2023-06-27 09:41:03] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 09:41:03] [config] bert-masking-fraction: 0.15
[2023-06-27 09:41:03] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 09:41:03] [config] bert-train-type-embeddings: true
[2023-06-27 09:41:03] [config] bert-type-vocab-size: 2
[2023-06-27 09:41:03] [config] build-info: ""
[2023-06-27 09:41:03] [config] check-gradient-nan: false
[2023-06-27 09:41:03] [config] check-nan: false
[2023-06-27 09:41:03] [config] cite: false
[2023-06-27 09:41:03] [config] clip-norm: 1
[2023-06-27 09:41:03] [config] cost-scaling:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] cost-type: ce-sum
[2023-06-27 09:41:03] [config] cpu-threads: 0
[2023-06-27 09:41:03] [config] data-threads: 8
[2023-06-27 09:41:03] [config] data-weighting: ""
[2023-06-27 09:41:03] [config] data-weighting-type: sentence
[2023-06-27 09:41:03] [config] dec-cell: gru
[2023-06-27 09:41:03] [config] dec-cell-base-depth: 2
[2023-06-27 09:41:03] [config] dec-cell-high-depth: 1
[2023-06-27 09:41:03] [config] dec-depth: 1
[2023-06-27 09:41:03] [config] devices:
[2023-06-27 09:41:03] [config]   - 0
[2023-06-27 09:41:03] [config] dim-emb: 512
[2023-06-27 09:41:03] [config] dim-rnn: 1024
[2023-06-27 09:41:03] [config] dim-vocabs:
[2023-06-27 09:41:03] [config]   - 16384
[2023-06-27 09:41:03] [config]   - 16384
[2023-06-27 09:41:03] [config] disp-first: 0
[2023-06-27 09:41:03] [config] disp-freq: 1000u
[2023-06-27 09:41:03] [config] disp-label-counts: true
[2023-06-27 09:41:03] [config] dropout-rnn: 0.2
[2023-06-27 09:41:03] [config] dropout-src: 0.1
[2023-06-27 09:41:03] [config] dropout-trg: 0.1
[2023-06-27 09:41:03] [config] dump-config: ""
[2023-06-27 09:41:03] [config] dynamic-gradient-scaling:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] early-stopping: 10
[2023-06-27 09:41:03] [config] early-stopping-on: first
[2023-06-27 09:41:03] [config] embedding-fix-src: false
[2023-06-27 09:41:03] [config] embedding-fix-trg: false
[2023-06-27 09:41:03] [config] embedding-normalization: false
[2023-06-27 09:41:03] [config] embedding-vectors:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] enc-cell: gru
[2023-06-27 09:41:03] [config] enc-cell-depth: 1
[2023-06-27 09:41:03] [config] enc-depth: 1
[2023-06-27 09:41:03] [config] enc-type: bidirectional
[2023-06-27 09:41:03] [config] english-title-case-every: 0
[2023-06-27 09:41:03] [config] exponential-smoothing: 0
[2023-06-27 09:41:03] [config] factor-weight: 1
[2023-06-27 09:41:03] [config] factors-combine: sum
[2023-06-27 09:41:03] [config] factors-dim-emb: 0
[2023-06-27 09:41:03] [config] gradient-checkpointing: false
[2023-06-27 09:41:03] [config] gradient-norm-average-window: 100
[2023-06-27 09:41:03] [config] guided-alignment: none
[2023-06-27 09:41:03] [config] guided-alignment-cost: mse
[2023-06-27 09:41:03] [config] guided-alignment-weight: 0.1
[2023-06-27 09:41:03] [config] ignore-model-config: false
[2023-06-27 09:41:03] [config] input-types:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] interpolate-env-vars: false
[2023-06-27 09:41:03] [config] keep-best: false
[2023-06-27 09:41:03] [config] label-smoothing: 0
[2023-06-27 09:41:03] [config] layer-normalization: true
[2023-06-27 09:41:03] [config] learn-rate: 0.0001
[2023-06-27 09:41:03] [config] lemma-dependency: ""
[2023-06-27 09:41:03] [config] lemma-dim-emb: 0
[2023-06-27 09:41:03] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 09:41:03] [config] log-level: info
[2023-06-27 09:41:03] [config] log-time-zone: ""
[2023-06-27 09:41:03] [config] logical-epoch:
[2023-06-27 09:41:03] [config]   - 1e
[2023-06-27 09:41:03] [config]   - 0
[2023-06-27 09:41:03] [config] lr-decay: 0
[2023-06-27 09:41:03] [config] lr-decay-freq: 50000
[2023-06-27 09:41:03] [config] lr-decay-inv-sqrt:
[2023-06-27 09:41:03] [config]   - 0
[2023-06-27 09:41:03] [config] lr-decay-repeat-warmup: false
[2023-06-27 09:41:03] [config] lr-decay-reset-optimizer: false
[2023-06-27 09:41:03] [config] lr-decay-start:
[2023-06-27 09:41:03] [config]   - 10
[2023-06-27 09:41:03] [config]   - 1
[2023-06-27 09:41:03] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 09:41:03] [config] lr-report: false
[2023-06-27 09:41:03] [config] lr-warmup: 0
[2023-06-27 09:41:03] [config] lr-warmup-at-reload: false
[2023-06-27 09:41:03] [config] lr-warmup-cycle: false
[2023-06-27 09:41:03] [config] lr-warmup-start-rate: 0
[2023-06-27 09:41:03] [config] max-length: 50
[2023-06-27 09:41:03] [config] max-length-crop: false
[2023-06-27 09:41:03] [config] max-length-factor: 3
[2023-06-27 09:41:03] [config] maxi-batch: 100
[2023-06-27 09:41:03] [config] maxi-batch-sort: trg
[2023-06-27 09:41:03] [config] mini-batch: 64
[2023-06-27 09:41:03] [config] mini-batch-fit: true
[2023-06-27 09:41:03] [config] mini-batch-fit-step: 10
[2023-06-27 09:41:03] [config] mini-batch-round-up: true
[2023-06-27 09:41:03] [config] mini-batch-track-lr: false
[2023-06-27 09:41:03] [config] mini-batch-warmup: 0
[2023-06-27 09:41:03] [config] mini-batch-words: 0
[2023-06-27 09:41:03] [config] mini-batch-words-ref: 0
[2023-06-27 09:41:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:41:03] [config] multi-loss-type: sum
[2023-06-27 09:41:03] [config] n-best: false
[2023-06-27 09:41:03] [config] no-nccl: false
[2023-06-27 09:41:03] [config] no-reload: false
[2023-06-27 09:41:03] [config] no-restore-corpus: false
[2023-06-27 09:41:03] [config] normalize: 0.6
[2023-06-27 09:41:03] [config] normalize-gradient: false
[2023-06-27 09:41:03] [config] num-devices: 0
[2023-06-27 09:41:03] [config] optimizer: adam
[2023-06-27 09:41:03] [config] optimizer-delay: 1
[2023-06-27 09:41:03] [config] optimizer-params:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] output-omit-bias: false
[2023-06-27 09:41:03] [config] overwrite: false
[2023-06-27 09:41:03] [config] precision:
[2023-06-27 09:41:03] [config]   - float32
[2023-06-27 09:41:03] [config]   - float32
[2023-06-27 09:41:03] [config] pretrained-model: ""
[2023-06-27 09:41:03] [config] quantize-biases: false
[2023-06-27 09:41:03] [config] quantize-bits: 0
[2023-06-27 09:41:03] [config] quantize-log-based: false
[2023-06-27 09:41:03] [config] quantize-optimization-steps: 0
[2023-06-27 09:41:03] [config] quiet: false
[2023-06-27 09:41:03] [config] quiet-translation: true
[2023-06-27 09:41:03] [config] relative-paths: false
[2023-06-27 09:41:03] [config] right-left: false
[2023-06-27 09:41:03] [config] save-freq: 10000u
[2023-06-27 09:41:03] [config] seed: 1234
[2023-06-27 09:41:03] [config] sentencepiece-alphas:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] sentencepiece-max-lines: 2000000
[2023-06-27 09:41:03] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 09:41:03] [config] sharding: global
[2023-06-27 09:41:03] [config] shuffle: data
[2023-06-27 09:41:03] [config] shuffle-in-ram: false
[2023-06-27 09:41:03] [config] sigterm: save-and-exit
[2023-06-27 09:41:03] [config] skip: false
[2023-06-27 09:41:03] [config] sqlite: ""
[2023-06-27 09:41:03] [config] sqlite-drop: false
[2023-06-27 09:41:03] [config] sync-freq: 200u
[2023-06-27 09:41:03] [config] sync-sgd: false
[2023-06-27 09:41:03] [config] tempdir: /tmp
[2023-06-27 09:41:03] [config] tied-embeddings: false
[2023-06-27 09:41:03] [config] tied-embeddings-all: true
[2023-06-27 09:41:03] [config] tied-embeddings-src: false
[2023-06-27 09:41:03] [config] train-embedder-rank:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] train-sets:
[2023-06-27 09:41:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 09:41:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 09:41:03] [config] transformer-aan-activation: swish
[2023-06-27 09:41:03] [config] transformer-aan-depth: 2
[2023-06-27 09:41:03] [config] transformer-aan-nogate: false
[2023-06-27 09:41:03] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 09:41:03] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 09:41:03] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 09:41:03] [config] transformer-depth-scaling: false
[2023-06-27 09:41:03] [config] transformer-dim-aan: 2048
[2023-06-27 09:41:03] [config] transformer-dim-ffn: 2048
[2023-06-27 09:41:03] [config] transformer-dropout: 0
[2023-06-27 09:41:03] [config] transformer-dropout-attention: 0
[2023-06-27 09:41:03] [config] transformer-dropout-ffn: 0
[2023-06-27 09:41:03] [config] transformer-ffn-activation: swish
[2023-06-27 09:41:03] [config] transformer-ffn-depth: 2
[2023-06-27 09:41:03] [config] transformer-guided-alignment-layer: last
[2023-06-27 09:41:03] [config] transformer-heads: 8
[2023-06-27 09:41:03] [config] transformer-no-projection: false
[2023-06-27 09:41:03] [config] transformer-pool: false
[2023-06-27 09:41:03] [config] transformer-postprocess: dan
[2023-06-27 09:41:03] [config] transformer-postprocess-emb: d
[2023-06-27 09:41:03] [config] transformer-postprocess-top: ""
[2023-06-27 09:41:03] [config] transformer-preprocess: ""
[2023-06-27 09:41:03] [config] transformer-tied-layers:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] transformer-train-position-embeddings: false
[2023-06-27 09:41:03] [config] tsv: false
[2023-06-27 09:41:03] [config] tsv-fields: 0
[2023-06-27 09:41:03] [config] type: amun
[2023-06-27 09:41:03] [config] ulr: false
[2023-06-27 09:41:03] [config] ulr-dim-emb: 0
[2023-06-27 09:41:03] [config] ulr-dropout: 0
[2023-06-27 09:41:03] [config] ulr-keys-vectors: ""
[2023-06-27 09:41:03] [config] ulr-query-vectors: ""
[2023-06-27 09:41:03] [config] ulr-softmax-temperature: 1
[2023-06-27 09:41:03] [config] ulr-trainable-transformation: false
[2023-06-27 09:41:03] [config] unlikelihood-loss: false
[2023-06-27 09:41:03] [config] valid-freq: 5000000
[2023-06-27 09:41:03] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 09:41:03] [config] valid-max-length: 1000
[2023-06-27 09:41:03] [config] valid-metrics:
[2023-06-27 09:41:03] [config]   - cross-entropy
[2023-06-27 09:41:03] [config]   - translation
[2023-06-27 09:41:03] [config] valid-mini-batch: 32
[2023-06-27 09:41:03] [config] valid-reset-stalled: false
[2023-06-27 09:41:03] [config] valid-script-args:
[2023-06-27 09:41:03] [config]   []
[2023-06-27 09:41:03] [config] valid-script-path: ""
[2023-06-27 09:41:03] [config] valid-sets:
[2023-06-27 09:41:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 09:41:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 09:41:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 09:41:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:41:03] [config] vocabs:
[2023-06-27 09:41:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:41:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:41:03] [config] word-penalty: 0
[2023-06-27 09:41:03] [config] word-scores: false
[2023-06-27 09:41:03] [config] workspace: 3000
[2023-06-27 09:41:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:41:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:41:03] [training] Using single-device training
[2023-06-27 09:41:03] Synced seed 1234
[2023-06-27 09:41:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:41:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 09:41:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:41:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 09:41:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 09:41:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:41:04] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:41:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:41:04] [comm] Using global sharding
[2023-06-27 09:41:04] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:41:04] [training] Using 1 GPUs
[2023-06-27 09:41:04] [logits] Applying loss function for 1 factor(s)
[2023-06-27 09:41:04] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:41:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 09:41:04] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:41:16] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 09:41:16] [valid] No post-processing script given for validating translator
[2023-06-27 09:41:17] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:41:17] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:41:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:41:17] [comm] Using global sharding
[2023-06-27 09:41:17] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:41:17] [training] Using 1 GPUs
[2023-06-27 09:41:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:41:18] Loading Adam parameters
[2023-06-27 09:41:18] [memory] Reserving 322 MB, device gpu0
[2023-06-27 09:41:18] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:41:18] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:41:18] [data] Restoring the corpus state to epoch 111, batch 11355
[2023-06-27 09:41:18] [data] Shuffling data
[2023-06-27 09:41:18] [data] Done reading 20,192 sentences
[2023-06-27 09:41:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:41:18] Training started
[2023-06-27 09:41:18] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 09:41:18] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:41:18] Parameter type float32, optimization type float32, casting types false
[2023-06-27 09:41:55] Seen 16,611 samples
[2023-06-27 09:41:55] Starting data epoch 112 in logical epoch 112
[2023-06-27 09:41:55] [data] Shuffling data
[2023-06-27 09:41:55] [data] Done reading 20,192 sentences
[2023-06-27 09:41:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:42:35] Seen 16,611 samples
[2023-06-27 09:42:35] Starting data epoch 113 in logical epoch 113
[2023-06-27 09:42:35] [data] Shuffling data
[2023-06-27 09:42:35] [data] Done reading 20,192 sentences
[2023-06-27 09:42:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:43:16] Seen 16,611 samples
[2023-06-27 09:43:16] Starting data epoch 114 in logical epoch 114
[2023-06-27 09:43:16] [data] Shuffling data
[2023-06-27 09:43:16] [data] Done reading 20,192 sentences
[2023-06-27 09:43:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:43:56] Seen 16,611 samples
[2023-06-27 09:43:56] Starting data epoch 115 in logical epoch 115
[2023-06-27 09:43:56] [data] Shuffling data
[2023-06-27 09:43:56] [data] Done reading 20,192 sentences
[2023-06-27 09:43:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:44:37] Seen 16,611 samples
[2023-06-27 09:44:37] Starting data epoch 116 in logical epoch 116
[2023-06-27 09:44:37] [data] Shuffling data
[2023-06-27 09:44:37] [data] Done reading 20,192 sentences
[2023-06-27 09:44:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:45:18] Seen 16,611 samples
[2023-06-27 09:45:18] Starting data epoch 117 in logical epoch 117
[2023-06-27 09:45:18] [data] Shuffling data
[2023-06-27 09:45:18] [data] Done reading 20,192 sentences
[2023-06-27 09:45:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:45:28] Ep. 117 : Up. 12000 : Sen. 4,083 : Cost 0.84167081 * 3,760,246 @ 5,827 after 45,257,207 : Time 251.47s : 14952.77 words/s : gNorm 1.0328
[2023-06-27 09:45:58] Seen 16,611 samples
[2023-06-27 09:45:58] Starting data epoch 118 in logical epoch 118
[2023-06-27 09:45:58] [data] Shuffling data
[2023-06-27 09:45:58] [data] Done reading 20,192 sentences
[2023-06-27 09:45:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:46:39] Seen 16,611 samples
[2023-06-27 09:46:39] Starting data epoch 119 in logical epoch 119
[2023-06-27 09:46:39] [data] Shuffling data
[2023-06-27 09:46:39] [data] Done reading 20,192 sentences
[2023-06-27 09:46:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:47:20] Seen 16,611 samples
[2023-06-27 09:47:20] Starting data epoch 120 in logical epoch 120
[2023-06-27 09:47:20] [data] Shuffling data
[2023-06-27 09:47:20] [data] Done reading 20,192 sentences
[2023-06-27 09:47:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:48:01] Seen 16,611 samples
[2023-06-27 09:48:01] Starting data epoch 121 in logical epoch 121
[2023-06-27 09:48:01] Training finished
[2023-06-27 09:48:09] [valid] Ep. 121 : Up. 12388 : cross-entropy : 123.85 : stalled 4 times (last best: 118.897)
[2023-06-27 09:48:43] [valid] Ep. 121 : Up. 12388 : translation : 0 : new best
[2023-06-27 09:48:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:48:45] Saving Adam parameters
[2023-06-27 09:48:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:52:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:52:00] [marian] Running on node20.datos.cluster.uy as process 37560 with command line:
[2023-06-27 09:52:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 130 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 09:52:00] [config] after: 0e
[2023-06-27 09:52:00] [config] after-batches: 0
[2023-06-27 09:52:00] [config] after-epochs: 130
[2023-06-27 09:52:00] [config] all-caps-every: 0
[2023-06-27 09:52:00] [config] allow-unk: false
[2023-06-27 09:52:00] [config] authors: false
[2023-06-27 09:52:00] [config] beam-size: 6
[2023-06-27 09:52:00] [config] bert-class-symbol: "[CLS]"
[2023-06-27 09:52:00] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 09:52:00] [config] bert-masking-fraction: 0.15
[2023-06-27 09:52:00] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 09:52:00] [config] bert-train-type-embeddings: true
[2023-06-27 09:52:00] [config] bert-type-vocab-size: 2
[2023-06-27 09:52:00] [config] build-info: ""
[2023-06-27 09:52:00] [config] check-gradient-nan: false
[2023-06-27 09:52:00] [config] check-nan: false
[2023-06-27 09:52:00] [config] cite: false
[2023-06-27 09:52:00] [config] clip-norm: 1
[2023-06-27 09:52:00] [config] cost-scaling:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] cost-type: ce-sum
[2023-06-27 09:52:00] [config] cpu-threads: 0
[2023-06-27 09:52:00] [config] data-threads: 8
[2023-06-27 09:52:00] [config] data-weighting: ""
[2023-06-27 09:52:00] [config] data-weighting-type: sentence
[2023-06-27 09:52:00] [config] dec-cell: gru
[2023-06-27 09:52:00] [config] dec-cell-base-depth: 2
[2023-06-27 09:52:00] [config] dec-cell-high-depth: 1
[2023-06-27 09:52:00] [config] dec-depth: 1
[2023-06-27 09:52:00] [config] devices:
[2023-06-27 09:52:00] [config]   - 0
[2023-06-27 09:52:00] [config] dim-emb: 512
[2023-06-27 09:52:00] [config] dim-rnn: 1024
[2023-06-27 09:52:00] [config] dim-vocabs:
[2023-06-27 09:52:00] [config]   - 16384
[2023-06-27 09:52:00] [config]   - 16384
[2023-06-27 09:52:00] [config] disp-first: 0
[2023-06-27 09:52:00] [config] disp-freq: 1000u
[2023-06-27 09:52:00] [config] disp-label-counts: true
[2023-06-27 09:52:00] [config] dropout-rnn: 0.2
[2023-06-27 09:52:00] [config] dropout-src: 0.1
[2023-06-27 09:52:00] [config] dropout-trg: 0.1
[2023-06-27 09:52:00] [config] dump-config: ""
[2023-06-27 09:52:00] [config] dynamic-gradient-scaling:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] early-stopping: 10
[2023-06-27 09:52:00] [config] early-stopping-on: first
[2023-06-27 09:52:00] [config] embedding-fix-src: false
[2023-06-27 09:52:00] [config] embedding-fix-trg: false
[2023-06-27 09:52:00] [config] embedding-normalization: false
[2023-06-27 09:52:00] [config] embedding-vectors:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] enc-cell: gru
[2023-06-27 09:52:00] [config] enc-cell-depth: 1
[2023-06-27 09:52:00] [config] enc-depth: 1
[2023-06-27 09:52:00] [config] enc-type: bidirectional
[2023-06-27 09:52:00] [config] english-title-case-every: 0
[2023-06-27 09:52:00] [config] exponential-smoothing: 0
[2023-06-27 09:52:00] [config] factor-weight: 1
[2023-06-27 09:52:00] [config] factors-combine: sum
[2023-06-27 09:52:00] [config] factors-dim-emb: 0
[2023-06-27 09:52:00] [config] gradient-checkpointing: false
[2023-06-27 09:52:00] [config] gradient-norm-average-window: 100
[2023-06-27 09:52:00] [config] guided-alignment: none
[2023-06-27 09:52:00] [config] guided-alignment-cost: mse
[2023-06-27 09:52:00] [config] guided-alignment-weight: 0.1
[2023-06-27 09:52:00] [config] ignore-model-config: false
[2023-06-27 09:52:00] [config] input-types:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] interpolate-env-vars: false
[2023-06-27 09:52:00] [config] keep-best: false
[2023-06-27 09:52:00] [config] label-smoothing: 0
[2023-06-27 09:52:00] [config] layer-normalization: true
[2023-06-27 09:52:00] [config] learn-rate: 0.0001
[2023-06-27 09:52:00] [config] lemma-dependency: ""
[2023-06-27 09:52:00] [config] lemma-dim-emb: 0
[2023-06-27 09:52:00] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 09:52:00] [config] log-level: info
[2023-06-27 09:52:00] [config] log-time-zone: ""
[2023-06-27 09:52:00] [config] logical-epoch:
[2023-06-27 09:52:00] [config]   - 1e
[2023-06-27 09:52:00] [config]   - 0
[2023-06-27 09:52:00] [config] lr-decay: 0
[2023-06-27 09:52:00] [config] lr-decay-freq: 50000
[2023-06-27 09:52:00] [config] lr-decay-inv-sqrt:
[2023-06-27 09:52:00] [config]   - 0
[2023-06-27 09:52:00] [config] lr-decay-repeat-warmup: false
[2023-06-27 09:52:00] [config] lr-decay-reset-optimizer: false
[2023-06-27 09:52:00] [config] lr-decay-start:
[2023-06-27 09:52:00] [config]   - 10
[2023-06-27 09:52:00] [config]   - 1
[2023-06-27 09:52:00] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 09:52:00] [config] lr-report: false
[2023-06-27 09:52:00] [config] lr-warmup: 0
[2023-06-27 09:52:00] [config] lr-warmup-at-reload: false
[2023-06-27 09:52:00] [config] lr-warmup-cycle: false
[2023-06-27 09:52:00] [config] lr-warmup-start-rate: 0
[2023-06-27 09:52:00] [config] max-length: 50
[2023-06-27 09:52:00] [config] max-length-crop: false
[2023-06-27 09:52:00] [config] max-length-factor: 3
[2023-06-27 09:52:00] [config] maxi-batch: 100
[2023-06-27 09:52:00] [config] maxi-batch-sort: trg
[2023-06-27 09:52:00] [config] mini-batch: 64
[2023-06-27 09:52:00] [config] mini-batch-fit: true
[2023-06-27 09:52:00] [config] mini-batch-fit-step: 10
[2023-06-27 09:52:00] [config] mini-batch-round-up: true
[2023-06-27 09:52:00] [config] mini-batch-track-lr: false
[2023-06-27 09:52:00] [config] mini-batch-warmup: 0
[2023-06-27 09:52:00] [config] mini-batch-words: 0
[2023-06-27 09:52:00] [config] mini-batch-words-ref: 0
[2023-06-27 09:52:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:52:00] [config] multi-loss-type: sum
[2023-06-27 09:52:00] [config] n-best: false
[2023-06-27 09:52:00] [config] no-nccl: false
[2023-06-27 09:52:00] [config] no-reload: false
[2023-06-27 09:52:00] [config] no-restore-corpus: false
[2023-06-27 09:52:00] [config] normalize: 0.6
[2023-06-27 09:52:00] [config] normalize-gradient: false
[2023-06-27 09:52:00] [config] num-devices: 0
[2023-06-27 09:52:00] [config] optimizer: adam
[2023-06-27 09:52:00] [config] optimizer-delay: 1
[2023-06-27 09:52:00] [config] optimizer-params:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] output-omit-bias: false
[2023-06-27 09:52:00] [config] overwrite: false
[2023-06-27 09:52:00] [config] precision:
[2023-06-27 09:52:00] [config]   - float32
[2023-06-27 09:52:00] [config]   - float32
[2023-06-27 09:52:00] [config] pretrained-model: ""
[2023-06-27 09:52:00] [config] quantize-biases: false
[2023-06-27 09:52:00] [config] quantize-bits: 0
[2023-06-27 09:52:00] [config] quantize-log-based: false
[2023-06-27 09:52:00] [config] quantize-optimization-steps: 0
[2023-06-27 09:52:00] [config] quiet: false
[2023-06-27 09:52:00] [config] quiet-translation: true
[2023-06-27 09:52:00] [config] relative-paths: false
[2023-06-27 09:52:00] [config] right-left: false
[2023-06-27 09:52:00] [config] save-freq: 10000u
[2023-06-27 09:52:00] [config] seed: 1234
[2023-06-27 09:52:00] [config] sentencepiece-alphas:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] sentencepiece-max-lines: 2000000
[2023-06-27 09:52:00] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 09:52:00] [config] sharding: global
[2023-06-27 09:52:00] [config] shuffle: data
[2023-06-27 09:52:00] [config] shuffle-in-ram: false
[2023-06-27 09:52:00] [config] sigterm: save-and-exit
[2023-06-27 09:52:00] [config] skip: false
[2023-06-27 09:52:00] [config] sqlite: ""
[2023-06-27 09:52:00] [config] sqlite-drop: false
[2023-06-27 09:52:00] [config] sync-freq: 200u
[2023-06-27 09:52:00] [config] sync-sgd: false
[2023-06-27 09:52:00] [config] tempdir: /tmp
[2023-06-27 09:52:00] [config] tied-embeddings: false
[2023-06-27 09:52:00] [config] tied-embeddings-all: true
[2023-06-27 09:52:00] [config] tied-embeddings-src: false
[2023-06-27 09:52:00] [config] train-embedder-rank:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] train-sets:
[2023-06-27 09:52:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 09:52:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 09:52:00] [config] transformer-aan-activation: swish
[2023-06-27 09:52:00] [config] transformer-aan-depth: 2
[2023-06-27 09:52:00] [config] transformer-aan-nogate: false
[2023-06-27 09:52:00] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 09:52:00] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 09:52:00] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 09:52:00] [config] transformer-depth-scaling: false
[2023-06-27 09:52:00] [config] transformer-dim-aan: 2048
[2023-06-27 09:52:00] [config] transformer-dim-ffn: 2048
[2023-06-27 09:52:00] [config] transformer-dropout: 0
[2023-06-27 09:52:00] [config] transformer-dropout-attention: 0
[2023-06-27 09:52:00] [config] transformer-dropout-ffn: 0
[2023-06-27 09:52:00] [config] transformer-ffn-activation: swish
[2023-06-27 09:52:00] [config] transformer-ffn-depth: 2
[2023-06-27 09:52:00] [config] transformer-guided-alignment-layer: last
[2023-06-27 09:52:00] [config] transformer-heads: 8
[2023-06-27 09:52:00] [config] transformer-no-projection: false
[2023-06-27 09:52:00] [config] transformer-pool: false
[2023-06-27 09:52:00] [config] transformer-postprocess: dan
[2023-06-27 09:52:00] [config] transformer-postprocess-emb: d
[2023-06-27 09:52:00] [config] transformer-postprocess-top: ""
[2023-06-27 09:52:00] [config] transformer-preprocess: ""
[2023-06-27 09:52:00] [config] transformer-tied-layers:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] transformer-train-position-embeddings: false
[2023-06-27 09:52:00] [config] tsv: false
[2023-06-27 09:52:00] [config] tsv-fields: 0
[2023-06-27 09:52:00] [config] type: amun
[2023-06-27 09:52:00] [config] ulr: false
[2023-06-27 09:52:00] [config] ulr-dim-emb: 0
[2023-06-27 09:52:00] [config] ulr-dropout: 0
[2023-06-27 09:52:00] [config] ulr-keys-vectors: ""
[2023-06-27 09:52:00] [config] ulr-query-vectors: ""
[2023-06-27 09:52:00] [config] ulr-softmax-temperature: 1
[2023-06-27 09:52:00] [config] ulr-trainable-transformation: false
[2023-06-27 09:52:00] [config] unlikelihood-loss: false
[2023-06-27 09:52:00] [config] valid-freq: 5000000
[2023-06-27 09:52:00] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 09:52:00] [config] valid-max-length: 1000
[2023-06-27 09:52:00] [config] valid-metrics:
[2023-06-27 09:52:00] [config]   - cross-entropy
[2023-06-27 09:52:00] [config]   - translation
[2023-06-27 09:52:00] [config] valid-mini-batch: 32
[2023-06-27 09:52:00] [config] valid-reset-stalled: false
[2023-06-27 09:52:00] [config] valid-script-args:
[2023-06-27 09:52:00] [config]   []
[2023-06-27 09:52:00] [config] valid-script-path: ""
[2023-06-27 09:52:00] [config] valid-sets:
[2023-06-27 09:52:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 09:52:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 09:52:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 09:52:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:52:00] [config] vocabs:
[2023-06-27 09:52:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:52:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:52:00] [config] word-penalty: 0
[2023-06-27 09:52:00] [config] word-scores: false
[2023-06-27 09:52:00] [config] workspace: 3000
[2023-06-27 09:52:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 09:52:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:52:00] [training] Using single-device training
[2023-06-27 09:52:00] Synced seed 1234
[2023-06-27 09:52:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 09:52:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 09:52:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 09:52:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 09:52:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 09:52:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:52:01] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:52:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:52:01] [comm] Using global sharding
[2023-06-27 09:52:01] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:52:01] [training] Using 1 GPUs
[2023-06-27 09:52:01] [logits] Applying loss function for 1 factor(s)
[2023-06-27 09:52:01] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:52:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 09:52:01] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:52:13] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 09:52:14] [valid] No post-processing script given for validating translator
[2023-06-27 09:52:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 09:52:14] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 09:52:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 09:52:14] [comm] Using global sharding
[2023-06-27 09:52:14] [comm] NCCLCommunicators constructed successfully
[2023-06-27 09:52:14] [training] Using 1 GPUs
[2023-06-27 09:52:14] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:52:15] Loading Adam parameters
[2023-06-27 09:52:15] [memory] Reserving 322 MB, device gpu0
[2023-06-27 09:52:15] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:52:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 09:52:15] [data] Restoring the corpus state to epoch 121, batch 12388
[2023-06-27 09:52:15] [data] Shuffling data
[2023-06-27 09:52:15] [data] Done reading 20,192 sentences
[2023-06-27 09:52:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:52:15] Training started
[2023-06-27 09:52:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 09:52:15] [memory] Reserving 161 MB, device gpu0
[2023-06-27 09:52:15] Parameter type float32, optimization type float32, casting types false
[2023-06-27 09:52:52] Seen 16,611 samples
[2023-06-27 09:52:52] Starting data epoch 122 in logical epoch 122
[2023-06-27 09:52:52] [data] Shuffling data
[2023-06-27 09:52:52] [data] Done reading 20,192 sentences
[2023-06-27 09:52:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:53:32] Seen 16,611 samples
[2023-06-27 09:53:32] Starting data epoch 123 in logical epoch 123
[2023-06-27 09:53:32] [data] Shuffling data
[2023-06-27 09:53:32] [data] Done reading 20,192 sentences
[2023-06-27 09:53:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:54:13] Seen 16,611 samples
[2023-06-27 09:54:13] Starting data epoch 124 in logical epoch 124
[2023-06-27 09:54:13] [data] Shuffling data
[2023-06-27 09:54:13] [data] Done reading 20,192 sentences
[2023-06-27 09:54:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:54:53] Seen 16,611 samples
[2023-06-27 09:54:53] Starting data epoch 125 in logical epoch 125
[2023-06-27 09:54:53] [data] Shuffling data
[2023-06-27 09:54:53] [data] Done reading 20,192 sentences
[2023-06-27 09:54:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:55:34] Seen 16,611 samples
[2023-06-27 09:55:34] Starting data epoch 126 in logical epoch 126
[2023-06-27 09:55:34] [data] Shuffling data
[2023-06-27 09:55:34] [data] Done reading 20,192 sentences
[2023-06-27 09:55:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:56:12] Ep. 126 : Up. 13000 : Sen. 15,452 : Cost 0.74964267 * 3,773,077 @ 3,127 after 49,030,284 : Time 238.74s : 15804.07 words/s : gNorm 1.0572
[2023-06-27 09:56:15] Seen 16,611 samples
[2023-06-27 09:56:15] Starting data epoch 127 in logical epoch 127
[2023-06-27 09:56:15] [data] Shuffling data
[2023-06-27 09:56:15] [data] Done reading 20,192 sentences
[2023-06-27 09:56:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:56:55] Seen 16,611 samples
[2023-06-27 09:56:55] Starting data epoch 128 in logical epoch 128
[2023-06-27 09:56:55] [data] Shuffling data
[2023-06-27 09:56:56] [data] Done reading 20,192 sentences
[2023-06-27 09:56:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:57:36] Seen 16,611 samples
[2023-06-27 09:57:36] Starting data epoch 129 in logical epoch 129
[2023-06-27 09:57:36] [data] Shuffling data
[2023-06-27 09:57:36] [data] Done reading 20,192 sentences
[2023-06-27 09:57:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:58:17] Seen 16,611 samples
[2023-06-27 09:58:17] Starting data epoch 130 in logical epoch 130
[2023-06-27 09:58:17] [data] Shuffling data
[2023-06-27 09:58:17] [data] Done reading 20,192 sentences
[2023-06-27 09:58:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 09:58:58] Seen 16,611 samples
[2023-06-27 09:58:58] Starting data epoch 131 in logical epoch 131
[2023-06-27 09:58:58] Training finished
[2023-06-27 09:59:06] [valid] Ep. 131 : Up. 13421 : cross-entropy : 124.27 : stalled 5 times (last best: 118.897)
[2023-06-27 09:59:42] [valid] Ep. 131 : Up. 13421 : translation : 0 : new best
[2023-06-27 09:59:42] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 09:59:44] Saving Adam parameters
[2023-06-27 09:59:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:03:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:03:05] [marian] Running on node20.datos.cluster.uy as process 38226 with command line:
[2023-06-27 10:03:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 140 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 10:03:05] [config] after: 0e
[2023-06-27 10:03:05] [config] after-batches: 0
[2023-06-27 10:03:05] [config] after-epochs: 140
[2023-06-27 10:03:05] [config] all-caps-every: 0
[2023-06-27 10:03:05] [config] allow-unk: false
[2023-06-27 10:03:05] [config] authors: false
[2023-06-27 10:03:05] [config] beam-size: 6
[2023-06-27 10:03:05] [config] bert-class-symbol: "[CLS]"
[2023-06-27 10:03:05] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 10:03:05] [config] bert-masking-fraction: 0.15
[2023-06-27 10:03:05] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 10:03:05] [config] bert-train-type-embeddings: true
[2023-06-27 10:03:05] [config] bert-type-vocab-size: 2
[2023-06-27 10:03:05] [config] build-info: ""
[2023-06-27 10:03:05] [config] check-gradient-nan: false
[2023-06-27 10:03:05] [config] check-nan: false
[2023-06-27 10:03:05] [config] cite: false
[2023-06-27 10:03:05] [config] clip-norm: 1
[2023-06-27 10:03:05] [config] cost-scaling:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] cost-type: ce-sum
[2023-06-27 10:03:05] [config] cpu-threads: 0
[2023-06-27 10:03:05] [config] data-threads: 8
[2023-06-27 10:03:05] [config] data-weighting: ""
[2023-06-27 10:03:05] [config] data-weighting-type: sentence
[2023-06-27 10:03:05] [config] dec-cell: gru
[2023-06-27 10:03:05] [config] dec-cell-base-depth: 2
[2023-06-27 10:03:05] [config] dec-cell-high-depth: 1
[2023-06-27 10:03:05] [config] dec-depth: 1
[2023-06-27 10:03:05] [config] devices:
[2023-06-27 10:03:05] [config]   - 0
[2023-06-27 10:03:05] [config] dim-emb: 512
[2023-06-27 10:03:05] [config] dim-rnn: 1024
[2023-06-27 10:03:05] [config] dim-vocabs:
[2023-06-27 10:03:05] [config]   - 16384
[2023-06-27 10:03:05] [config]   - 16384
[2023-06-27 10:03:05] [config] disp-first: 0
[2023-06-27 10:03:05] [config] disp-freq: 1000u
[2023-06-27 10:03:05] [config] disp-label-counts: true
[2023-06-27 10:03:05] [config] dropout-rnn: 0.2
[2023-06-27 10:03:05] [config] dropout-src: 0.1
[2023-06-27 10:03:05] [config] dropout-trg: 0.1
[2023-06-27 10:03:05] [config] dump-config: ""
[2023-06-27 10:03:05] [config] dynamic-gradient-scaling:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] early-stopping: 10
[2023-06-27 10:03:05] [config] early-stopping-on: first
[2023-06-27 10:03:05] [config] embedding-fix-src: false
[2023-06-27 10:03:05] [config] embedding-fix-trg: false
[2023-06-27 10:03:05] [config] embedding-normalization: false
[2023-06-27 10:03:05] [config] embedding-vectors:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] enc-cell: gru
[2023-06-27 10:03:05] [config] enc-cell-depth: 1
[2023-06-27 10:03:05] [config] enc-depth: 1
[2023-06-27 10:03:05] [config] enc-type: bidirectional
[2023-06-27 10:03:05] [config] english-title-case-every: 0
[2023-06-27 10:03:05] [config] exponential-smoothing: 0
[2023-06-27 10:03:05] [config] factor-weight: 1
[2023-06-27 10:03:05] [config] factors-combine: sum
[2023-06-27 10:03:05] [config] factors-dim-emb: 0
[2023-06-27 10:03:05] [config] gradient-checkpointing: false
[2023-06-27 10:03:05] [config] gradient-norm-average-window: 100
[2023-06-27 10:03:05] [config] guided-alignment: none
[2023-06-27 10:03:05] [config] guided-alignment-cost: mse
[2023-06-27 10:03:05] [config] guided-alignment-weight: 0.1
[2023-06-27 10:03:05] [config] ignore-model-config: false
[2023-06-27 10:03:05] [config] input-types:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] interpolate-env-vars: false
[2023-06-27 10:03:05] [config] keep-best: false
[2023-06-27 10:03:05] [config] label-smoothing: 0
[2023-06-27 10:03:05] [config] layer-normalization: true
[2023-06-27 10:03:05] [config] learn-rate: 0.0001
[2023-06-27 10:03:05] [config] lemma-dependency: ""
[2023-06-27 10:03:05] [config] lemma-dim-emb: 0
[2023-06-27 10:03:05] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 10:03:05] [config] log-level: info
[2023-06-27 10:03:05] [config] log-time-zone: ""
[2023-06-27 10:03:05] [config] logical-epoch:
[2023-06-27 10:03:05] [config]   - 1e
[2023-06-27 10:03:05] [config]   - 0
[2023-06-27 10:03:05] [config] lr-decay: 0
[2023-06-27 10:03:05] [config] lr-decay-freq: 50000
[2023-06-27 10:03:05] [config] lr-decay-inv-sqrt:
[2023-06-27 10:03:05] [config]   - 0
[2023-06-27 10:03:05] [config] lr-decay-repeat-warmup: false
[2023-06-27 10:03:05] [config] lr-decay-reset-optimizer: false
[2023-06-27 10:03:05] [config] lr-decay-start:
[2023-06-27 10:03:05] [config]   - 10
[2023-06-27 10:03:05] [config]   - 1
[2023-06-27 10:03:05] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 10:03:05] [config] lr-report: false
[2023-06-27 10:03:05] [config] lr-warmup: 0
[2023-06-27 10:03:05] [config] lr-warmup-at-reload: false
[2023-06-27 10:03:05] [config] lr-warmup-cycle: false
[2023-06-27 10:03:05] [config] lr-warmup-start-rate: 0
[2023-06-27 10:03:05] [config] max-length: 50
[2023-06-27 10:03:05] [config] max-length-crop: false
[2023-06-27 10:03:05] [config] max-length-factor: 3
[2023-06-27 10:03:05] [config] maxi-batch: 100
[2023-06-27 10:03:05] [config] maxi-batch-sort: trg
[2023-06-27 10:03:05] [config] mini-batch: 64
[2023-06-27 10:03:05] [config] mini-batch-fit: true
[2023-06-27 10:03:05] [config] mini-batch-fit-step: 10
[2023-06-27 10:03:05] [config] mini-batch-round-up: true
[2023-06-27 10:03:05] [config] mini-batch-track-lr: false
[2023-06-27 10:03:05] [config] mini-batch-warmup: 0
[2023-06-27 10:03:05] [config] mini-batch-words: 0
[2023-06-27 10:03:05] [config] mini-batch-words-ref: 0
[2023-06-27 10:03:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:03:05] [config] multi-loss-type: sum
[2023-06-27 10:03:05] [config] n-best: false
[2023-06-27 10:03:05] [config] no-nccl: false
[2023-06-27 10:03:05] [config] no-reload: false
[2023-06-27 10:03:05] [config] no-restore-corpus: false
[2023-06-27 10:03:05] [config] normalize: 0.6
[2023-06-27 10:03:05] [config] normalize-gradient: false
[2023-06-27 10:03:05] [config] num-devices: 0
[2023-06-27 10:03:05] [config] optimizer: adam
[2023-06-27 10:03:05] [config] optimizer-delay: 1
[2023-06-27 10:03:05] [config] optimizer-params:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] output-omit-bias: false
[2023-06-27 10:03:05] [config] overwrite: false
[2023-06-27 10:03:05] [config] precision:
[2023-06-27 10:03:05] [config]   - float32
[2023-06-27 10:03:05] [config]   - float32
[2023-06-27 10:03:05] [config] pretrained-model: ""
[2023-06-27 10:03:05] [config] quantize-biases: false
[2023-06-27 10:03:05] [config] quantize-bits: 0
[2023-06-27 10:03:05] [config] quantize-log-based: false
[2023-06-27 10:03:05] [config] quantize-optimization-steps: 0
[2023-06-27 10:03:05] [config] quiet: false
[2023-06-27 10:03:05] [config] quiet-translation: true
[2023-06-27 10:03:05] [config] relative-paths: false
[2023-06-27 10:03:05] [config] right-left: false
[2023-06-27 10:03:05] [config] save-freq: 10000u
[2023-06-27 10:03:05] [config] seed: 1234
[2023-06-27 10:03:05] [config] sentencepiece-alphas:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] sentencepiece-max-lines: 2000000
[2023-06-27 10:03:05] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 10:03:05] [config] sharding: global
[2023-06-27 10:03:05] [config] shuffle: data
[2023-06-27 10:03:05] [config] shuffle-in-ram: false
[2023-06-27 10:03:05] [config] sigterm: save-and-exit
[2023-06-27 10:03:05] [config] skip: false
[2023-06-27 10:03:05] [config] sqlite: ""
[2023-06-27 10:03:05] [config] sqlite-drop: false
[2023-06-27 10:03:05] [config] sync-freq: 200u
[2023-06-27 10:03:05] [config] sync-sgd: false
[2023-06-27 10:03:05] [config] tempdir: /tmp
[2023-06-27 10:03:05] [config] tied-embeddings: false
[2023-06-27 10:03:05] [config] tied-embeddings-all: true
[2023-06-27 10:03:05] [config] tied-embeddings-src: false
[2023-06-27 10:03:05] [config] train-embedder-rank:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] train-sets:
[2023-06-27 10:03:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 10:03:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 10:03:05] [config] transformer-aan-activation: swish
[2023-06-27 10:03:05] [config] transformer-aan-depth: 2
[2023-06-27 10:03:05] [config] transformer-aan-nogate: false
[2023-06-27 10:03:05] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 10:03:05] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 10:03:05] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 10:03:05] [config] transformer-depth-scaling: false
[2023-06-27 10:03:05] [config] transformer-dim-aan: 2048
[2023-06-27 10:03:05] [config] transformer-dim-ffn: 2048
[2023-06-27 10:03:05] [config] transformer-dropout: 0
[2023-06-27 10:03:05] [config] transformer-dropout-attention: 0
[2023-06-27 10:03:05] [config] transformer-dropout-ffn: 0
[2023-06-27 10:03:05] [config] transformer-ffn-activation: swish
[2023-06-27 10:03:05] [config] transformer-ffn-depth: 2
[2023-06-27 10:03:05] [config] transformer-guided-alignment-layer: last
[2023-06-27 10:03:05] [config] transformer-heads: 8
[2023-06-27 10:03:05] [config] transformer-no-projection: false
[2023-06-27 10:03:05] [config] transformer-pool: false
[2023-06-27 10:03:05] [config] transformer-postprocess: dan
[2023-06-27 10:03:05] [config] transformer-postprocess-emb: d
[2023-06-27 10:03:05] [config] transformer-postprocess-top: ""
[2023-06-27 10:03:05] [config] transformer-preprocess: ""
[2023-06-27 10:03:05] [config] transformer-tied-layers:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] transformer-train-position-embeddings: false
[2023-06-27 10:03:05] [config] tsv: false
[2023-06-27 10:03:05] [config] tsv-fields: 0
[2023-06-27 10:03:05] [config] type: amun
[2023-06-27 10:03:05] [config] ulr: false
[2023-06-27 10:03:05] [config] ulr-dim-emb: 0
[2023-06-27 10:03:05] [config] ulr-dropout: 0
[2023-06-27 10:03:05] [config] ulr-keys-vectors: ""
[2023-06-27 10:03:05] [config] ulr-query-vectors: ""
[2023-06-27 10:03:05] [config] ulr-softmax-temperature: 1
[2023-06-27 10:03:05] [config] ulr-trainable-transformation: false
[2023-06-27 10:03:05] [config] unlikelihood-loss: false
[2023-06-27 10:03:05] [config] valid-freq: 5000000
[2023-06-27 10:03:05] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 10:03:05] [config] valid-max-length: 1000
[2023-06-27 10:03:05] [config] valid-metrics:
[2023-06-27 10:03:05] [config]   - cross-entropy
[2023-06-27 10:03:05] [config]   - translation
[2023-06-27 10:03:05] [config] valid-mini-batch: 32
[2023-06-27 10:03:05] [config] valid-reset-stalled: false
[2023-06-27 10:03:05] [config] valid-script-args:
[2023-06-27 10:03:05] [config]   []
[2023-06-27 10:03:05] [config] valid-script-path: ""
[2023-06-27 10:03:05] [config] valid-sets:
[2023-06-27 10:03:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 10:03:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 10:03:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 10:03:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:03:05] [config] vocabs:
[2023-06-27 10:03:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:03:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:03:05] [config] word-penalty: 0
[2023-06-27 10:03:05] [config] word-scores: false
[2023-06-27 10:03:05] [config] workspace: 3000
[2023-06-27 10:03:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:03:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:03:05] [training] Using single-device training
[2023-06-27 10:03:06] Synced seed 1234
[2023-06-27 10:03:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:03:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 10:03:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:03:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 10:03:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 10:03:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:03:07] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:03:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:03:07] [comm] Using global sharding
[2023-06-27 10:03:07] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:03:07] [training] Using 1 GPUs
[2023-06-27 10:03:07] [logits] Applying loss function for 1 factor(s)
[2023-06-27 10:03:07] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:03:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 10:03:07] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:03:19] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 10:03:19] [valid] No post-processing script given for validating translator
[2023-06-27 10:03:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:03:19] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:03:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:03:19] [comm] Using global sharding
[2023-06-27 10:03:20] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:03:20] [training] Using 1 GPUs
[2023-06-27 10:03:20] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:03:20] Loading Adam parameters
[2023-06-27 10:03:21] [memory] Reserving 322 MB, device gpu0
[2023-06-27 10:03:21] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:03:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:03:21] [data] Restoring the corpus state to epoch 131, batch 13421
[2023-06-27 10:03:21] [data] Shuffling data
[2023-06-27 10:03:21] [data] Done reading 20,192 sentences
[2023-06-27 10:03:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:03:21] Training started
[2023-06-27 10:03:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 10:03:21] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:03:21] Parameter type float32, optimization type float32, casting types false
[2023-06-27 10:03:58] Seen 16,611 samples
[2023-06-27 10:03:58] Starting data epoch 132 in logical epoch 132
[2023-06-27 10:03:58] [data] Shuffling data
[2023-06-27 10:03:58] [data] Done reading 20,192 sentences
[2023-06-27 10:03:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:04:38] Seen 16,611 samples
[2023-06-27 10:04:38] Starting data epoch 133 in logical epoch 133
[2023-06-27 10:04:38] [data] Shuffling data
[2023-06-27 10:04:38] [data] Done reading 20,192 sentences
[2023-06-27 10:04:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:05:18] Seen 16,611 samples
[2023-06-27 10:05:18] Starting data epoch 134 in logical epoch 134
[2023-06-27 10:05:18] [data] Shuffling data
[2023-06-27 10:05:18] [data] Done reading 20,192 sentences
[2023-06-27 10:05:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:05:59] Seen 16,611 samples
[2023-06-27 10:05:59] Starting data epoch 135 in logical epoch 135
[2023-06-27 10:05:59] [data] Shuffling data
[2023-06-27 10:05:59] [data] Done reading 20,192 sentences
[2023-06-27 10:05:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:06:39] Seen 16,611 samples
[2023-06-27 10:06:39] Starting data epoch 136 in logical epoch 136
[2023-06-27 10:06:39] [data] Shuffling data
[2023-06-27 10:06:39] [data] Done reading 20,192 sentences
[2023-06-27 10:06:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:07:04] Ep. 136 : Up. 14000 : Sen. 10,079 : Cost 0.66000783 * 3,764,955 @ 3,609 after 52,795,239 : Time 224.53s : 16768.20 words/s : gNorm 0.9479
[2023-06-27 10:07:20] Seen 16,611 samples
[2023-06-27 10:07:20] Starting data epoch 137 in logical epoch 137
[2023-06-27 10:07:20] [data] Shuffling data
[2023-06-27 10:07:20] [data] Done reading 20,192 sentences
[2023-06-27 10:07:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:08:00] Seen 16,611 samples
[2023-06-27 10:08:00] Starting data epoch 138 in logical epoch 138
[2023-06-27 10:08:00] [data] Shuffling data
[2023-06-27 10:08:00] [data] Done reading 20,192 sentences
[2023-06-27 10:08:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:08:40] Seen 16,611 samples
[2023-06-27 10:08:40] Starting data epoch 139 in logical epoch 139
[2023-06-27 10:08:40] [data] Shuffling data
[2023-06-27 10:08:40] [data] Done reading 20,192 sentences
[2023-06-27 10:08:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:09:21] Seen 16,611 samples
[2023-06-27 10:09:21] Starting data epoch 140 in logical epoch 140
[2023-06-27 10:09:21] [data] Shuffling data
[2023-06-27 10:09:21] [data] Done reading 20,192 sentences
[2023-06-27 10:09:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:10:02] Seen 16,611 samples
[2023-06-27 10:10:02] Starting data epoch 141 in logical epoch 141
[2023-06-27 10:10:02] Training finished
[2023-06-27 10:10:10] [valid] Ep. 141 : Up. 14454 : cross-entropy : 125.549 : stalled 6 times (last best: 118.897)
[2023-06-27 10:10:46] [valid] Ep. 141 : Up. 14454 : translation : 0 : new best
[2023-06-27 10:10:46] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:10:47] Saving Adam parameters
[2023-06-27 10:10:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:14:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:14:08] [marian] Running on node20.datos.cluster.uy as process 39202 with command line:
[2023-06-27 10:14:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 150 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 10:14:08] [config] after: 0e
[2023-06-27 10:14:08] [config] after-batches: 0
[2023-06-27 10:14:08] [config] after-epochs: 150
[2023-06-27 10:14:08] [config] all-caps-every: 0
[2023-06-27 10:14:08] [config] allow-unk: false
[2023-06-27 10:14:08] [config] authors: false
[2023-06-27 10:14:08] [config] beam-size: 6
[2023-06-27 10:14:08] [config] bert-class-symbol: "[CLS]"
[2023-06-27 10:14:08] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 10:14:08] [config] bert-masking-fraction: 0.15
[2023-06-27 10:14:08] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 10:14:08] [config] bert-train-type-embeddings: true
[2023-06-27 10:14:08] [config] bert-type-vocab-size: 2
[2023-06-27 10:14:08] [config] build-info: ""
[2023-06-27 10:14:08] [config] check-gradient-nan: false
[2023-06-27 10:14:08] [config] check-nan: false
[2023-06-27 10:14:08] [config] cite: false
[2023-06-27 10:14:08] [config] clip-norm: 1
[2023-06-27 10:14:08] [config] cost-scaling:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] cost-type: ce-sum
[2023-06-27 10:14:08] [config] cpu-threads: 0
[2023-06-27 10:14:08] [config] data-threads: 8
[2023-06-27 10:14:08] [config] data-weighting: ""
[2023-06-27 10:14:08] [config] data-weighting-type: sentence
[2023-06-27 10:14:08] [config] dec-cell: gru
[2023-06-27 10:14:08] [config] dec-cell-base-depth: 2
[2023-06-27 10:14:08] [config] dec-cell-high-depth: 1
[2023-06-27 10:14:08] [config] dec-depth: 1
[2023-06-27 10:14:08] [config] devices:
[2023-06-27 10:14:08] [config]   - 0
[2023-06-27 10:14:08] [config] dim-emb: 512
[2023-06-27 10:14:08] [config] dim-rnn: 1024
[2023-06-27 10:14:08] [config] dim-vocabs:
[2023-06-27 10:14:08] [config]   - 16384
[2023-06-27 10:14:08] [config]   - 16384
[2023-06-27 10:14:08] [config] disp-first: 0
[2023-06-27 10:14:08] [config] disp-freq: 1000u
[2023-06-27 10:14:08] [config] disp-label-counts: true
[2023-06-27 10:14:08] [config] dropout-rnn: 0.2
[2023-06-27 10:14:08] [config] dropout-src: 0.1
[2023-06-27 10:14:08] [config] dropout-trg: 0.1
[2023-06-27 10:14:08] [config] dump-config: ""
[2023-06-27 10:14:08] [config] dynamic-gradient-scaling:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] early-stopping: 10
[2023-06-27 10:14:08] [config] early-stopping-on: first
[2023-06-27 10:14:08] [config] embedding-fix-src: false
[2023-06-27 10:14:08] [config] embedding-fix-trg: false
[2023-06-27 10:14:08] [config] embedding-normalization: false
[2023-06-27 10:14:08] [config] embedding-vectors:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] enc-cell: gru
[2023-06-27 10:14:08] [config] enc-cell-depth: 1
[2023-06-27 10:14:08] [config] enc-depth: 1
[2023-06-27 10:14:08] [config] enc-type: bidirectional
[2023-06-27 10:14:08] [config] english-title-case-every: 0
[2023-06-27 10:14:08] [config] exponential-smoothing: 0
[2023-06-27 10:14:08] [config] factor-weight: 1
[2023-06-27 10:14:08] [config] factors-combine: sum
[2023-06-27 10:14:08] [config] factors-dim-emb: 0
[2023-06-27 10:14:08] [config] gradient-checkpointing: false
[2023-06-27 10:14:08] [config] gradient-norm-average-window: 100
[2023-06-27 10:14:08] [config] guided-alignment: none
[2023-06-27 10:14:08] [config] guided-alignment-cost: mse
[2023-06-27 10:14:08] [config] guided-alignment-weight: 0.1
[2023-06-27 10:14:08] [config] ignore-model-config: false
[2023-06-27 10:14:08] [config] input-types:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] interpolate-env-vars: false
[2023-06-27 10:14:08] [config] keep-best: false
[2023-06-27 10:14:08] [config] label-smoothing: 0
[2023-06-27 10:14:08] [config] layer-normalization: true
[2023-06-27 10:14:08] [config] learn-rate: 0.0001
[2023-06-27 10:14:08] [config] lemma-dependency: ""
[2023-06-27 10:14:08] [config] lemma-dim-emb: 0
[2023-06-27 10:14:08] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 10:14:08] [config] log-level: info
[2023-06-27 10:14:08] [config] log-time-zone: ""
[2023-06-27 10:14:08] [config] logical-epoch:
[2023-06-27 10:14:08] [config]   - 1e
[2023-06-27 10:14:08] [config]   - 0
[2023-06-27 10:14:08] [config] lr-decay: 0
[2023-06-27 10:14:08] [config] lr-decay-freq: 50000
[2023-06-27 10:14:08] [config] lr-decay-inv-sqrt:
[2023-06-27 10:14:08] [config]   - 0
[2023-06-27 10:14:08] [config] lr-decay-repeat-warmup: false
[2023-06-27 10:14:08] [config] lr-decay-reset-optimizer: false
[2023-06-27 10:14:08] [config] lr-decay-start:
[2023-06-27 10:14:08] [config]   - 10
[2023-06-27 10:14:08] [config]   - 1
[2023-06-27 10:14:08] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 10:14:08] [config] lr-report: false
[2023-06-27 10:14:08] [config] lr-warmup: 0
[2023-06-27 10:14:08] [config] lr-warmup-at-reload: false
[2023-06-27 10:14:08] [config] lr-warmup-cycle: false
[2023-06-27 10:14:08] [config] lr-warmup-start-rate: 0
[2023-06-27 10:14:08] [config] max-length: 50
[2023-06-27 10:14:08] [config] max-length-crop: false
[2023-06-27 10:14:08] [config] max-length-factor: 3
[2023-06-27 10:14:08] [config] maxi-batch: 100
[2023-06-27 10:14:08] [config] maxi-batch-sort: trg
[2023-06-27 10:14:08] [config] mini-batch: 64
[2023-06-27 10:14:08] [config] mini-batch-fit: true
[2023-06-27 10:14:08] [config] mini-batch-fit-step: 10
[2023-06-27 10:14:08] [config] mini-batch-round-up: true
[2023-06-27 10:14:08] [config] mini-batch-track-lr: false
[2023-06-27 10:14:08] [config] mini-batch-warmup: 0
[2023-06-27 10:14:08] [config] mini-batch-words: 0
[2023-06-27 10:14:08] [config] mini-batch-words-ref: 0
[2023-06-27 10:14:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:14:08] [config] multi-loss-type: sum
[2023-06-27 10:14:08] [config] n-best: false
[2023-06-27 10:14:08] [config] no-nccl: false
[2023-06-27 10:14:08] [config] no-reload: false
[2023-06-27 10:14:08] [config] no-restore-corpus: false
[2023-06-27 10:14:08] [config] normalize: 0.6
[2023-06-27 10:14:08] [config] normalize-gradient: false
[2023-06-27 10:14:08] [config] num-devices: 0
[2023-06-27 10:14:08] [config] optimizer: adam
[2023-06-27 10:14:08] [config] optimizer-delay: 1
[2023-06-27 10:14:08] [config] optimizer-params:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] output-omit-bias: false
[2023-06-27 10:14:08] [config] overwrite: false
[2023-06-27 10:14:08] [config] precision:
[2023-06-27 10:14:08] [config]   - float32
[2023-06-27 10:14:08] [config]   - float32
[2023-06-27 10:14:08] [config] pretrained-model: ""
[2023-06-27 10:14:08] [config] quantize-biases: false
[2023-06-27 10:14:08] [config] quantize-bits: 0
[2023-06-27 10:14:08] [config] quantize-log-based: false
[2023-06-27 10:14:08] [config] quantize-optimization-steps: 0
[2023-06-27 10:14:08] [config] quiet: false
[2023-06-27 10:14:08] [config] quiet-translation: true
[2023-06-27 10:14:08] [config] relative-paths: false
[2023-06-27 10:14:08] [config] right-left: false
[2023-06-27 10:14:08] [config] save-freq: 10000u
[2023-06-27 10:14:08] [config] seed: 1234
[2023-06-27 10:14:08] [config] sentencepiece-alphas:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] sentencepiece-max-lines: 2000000
[2023-06-27 10:14:08] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 10:14:08] [config] sharding: global
[2023-06-27 10:14:08] [config] shuffle: data
[2023-06-27 10:14:08] [config] shuffle-in-ram: false
[2023-06-27 10:14:08] [config] sigterm: save-and-exit
[2023-06-27 10:14:08] [config] skip: false
[2023-06-27 10:14:08] [config] sqlite: ""
[2023-06-27 10:14:08] [config] sqlite-drop: false
[2023-06-27 10:14:08] [config] sync-freq: 200u
[2023-06-27 10:14:08] [config] sync-sgd: false
[2023-06-27 10:14:08] [config] tempdir: /tmp
[2023-06-27 10:14:08] [config] tied-embeddings: false
[2023-06-27 10:14:08] [config] tied-embeddings-all: true
[2023-06-27 10:14:08] [config] tied-embeddings-src: false
[2023-06-27 10:14:08] [config] train-embedder-rank:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] train-sets:
[2023-06-27 10:14:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 10:14:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 10:14:08] [config] transformer-aan-activation: swish
[2023-06-27 10:14:08] [config] transformer-aan-depth: 2
[2023-06-27 10:14:08] [config] transformer-aan-nogate: false
[2023-06-27 10:14:08] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 10:14:08] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 10:14:08] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 10:14:08] [config] transformer-depth-scaling: false
[2023-06-27 10:14:08] [config] transformer-dim-aan: 2048
[2023-06-27 10:14:08] [config] transformer-dim-ffn: 2048
[2023-06-27 10:14:08] [config] transformer-dropout: 0
[2023-06-27 10:14:08] [config] transformer-dropout-attention: 0
[2023-06-27 10:14:08] [config] transformer-dropout-ffn: 0
[2023-06-27 10:14:08] [config] transformer-ffn-activation: swish
[2023-06-27 10:14:08] [config] transformer-ffn-depth: 2
[2023-06-27 10:14:08] [config] transformer-guided-alignment-layer: last
[2023-06-27 10:14:08] [config] transformer-heads: 8
[2023-06-27 10:14:08] [config] transformer-no-projection: false
[2023-06-27 10:14:08] [config] transformer-pool: false
[2023-06-27 10:14:08] [config] transformer-postprocess: dan
[2023-06-27 10:14:08] [config] transformer-postprocess-emb: d
[2023-06-27 10:14:08] [config] transformer-postprocess-top: ""
[2023-06-27 10:14:08] [config] transformer-preprocess: ""
[2023-06-27 10:14:08] [config] transformer-tied-layers:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] transformer-train-position-embeddings: false
[2023-06-27 10:14:08] [config] tsv: false
[2023-06-27 10:14:08] [config] tsv-fields: 0
[2023-06-27 10:14:08] [config] type: amun
[2023-06-27 10:14:08] [config] ulr: false
[2023-06-27 10:14:08] [config] ulr-dim-emb: 0
[2023-06-27 10:14:08] [config] ulr-dropout: 0
[2023-06-27 10:14:08] [config] ulr-keys-vectors: ""
[2023-06-27 10:14:08] [config] ulr-query-vectors: ""
[2023-06-27 10:14:08] [config] ulr-softmax-temperature: 1
[2023-06-27 10:14:08] [config] ulr-trainable-transformation: false
[2023-06-27 10:14:08] [config] unlikelihood-loss: false
[2023-06-27 10:14:08] [config] valid-freq: 5000000
[2023-06-27 10:14:08] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 10:14:08] [config] valid-max-length: 1000
[2023-06-27 10:14:08] [config] valid-metrics:
[2023-06-27 10:14:08] [config]   - cross-entropy
[2023-06-27 10:14:08] [config]   - translation
[2023-06-27 10:14:08] [config] valid-mini-batch: 32
[2023-06-27 10:14:08] [config] valid-reset-stalled: false
[2023-06-27 10:14:08] [config] valid-script-args:
[2023-06-27 10:14:08] [config]   []
[2023-06-27 10:14:08] [config] valid-script-path: ""
[2023-06-27 10:14:08] [config] valid-sets:
[2023-06-27 10:14:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 10:14:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 10:14:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 10:14:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:14:08] [config] vocabs:
[2023-06-27 10:14:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:14:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:14:08] [config] word-penalty: 0
[2023-06-27 10:14:08] [config] word-scores: false
[2023-06-27 10:14:08] [config] workspace: 3000
[2023-06-27 10:14:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:14:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:14:08] [training] Using single-device training
[2023-06-27 10:14:08] Synced seed 1234
[2023-06-27 10:14:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:14:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 10:14:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:14:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 10:14:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 10:14:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:14:09] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:14:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:14:09] [comm] Using global sharding
[2023-06-27 10:14:09] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:14:09] [training] Using 1 GPUs
[2023-06-27 10:14:09] [logits] Applying loss function for 1 factor(s)
[2023-06-27 10:14:09] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:14:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 10:14:09] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:14:22] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 10:14:22] [valid] No post-processing script given for validating translator
[2023-06-27 10:14:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:14:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:14:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:14:22] [comm] Using global sharding
[2023-06-27 10:14:22] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:14:22] [training] Using 1 GPUs
[2023-06-27 10:14:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:14:23] Loading Adam parameters
[2023-06-27 10:14:23] [memory] Reserving 322 MB, device gpu0
[2023-06-27 10:14:23] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:14:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:14:23] [data] Restoring the corpus state to epoch 141, batch 14454
[2023-06-27 10:14:23] [data] Shuffling data
[2023-06-27 10:14:23] [data] Done reading 20,192 sentences
[2023-06-27 10:14:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:14:23] Training started
[2023-06-27 10:14:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 10:14:23] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:14:23] Parameter type float32, optimization type float32, casting types false
[2023-06-27 10:15:00] Seen 16,611 samples
[2023-06-27 10:15:00] Starting data epoch 142 in logical epoch 142
[2023-06-27 10:15:00] [data] Shuffling data
[2023-06-27 10:15:00] [data] Done reading 20,192 sentences
[2023-06-27 10:15:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:15:40] Seen 16,611 samples
[2023-06-27 10:15:40] Starting data epoch 143 in logical epoch 143
[2023-06-27 10:15:40] [data] Shuffling data
[2023-06-27 10:15:40] [data] Done reading 20,192 sentences
[2023-06-27 10:15:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:16:21] Seen 16,611 samples
[2023-06-27 10:16:21] Starting data epoch 144 in logical epoch 144
[2023-06-27 10:16:21] [data] Shuffling data
[2023-06-27 10:16:21] [data] Done reading 20,192 sentences
[2023-06-27 10:16:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:17:01] Seen 16,611 samples
[2023-06-27 10:17:01] Starting data epoch 145 in logical epoch 145
[2023-06-27 10:17:01] [data] Shuffling data
[2023-06-27 10:17:01] [data] Done reading 20,192 sentences
[2023-06-27 10:17:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:17:42] Seen 16,611 samples
[2023-06-27 10:17:42] Starting data epoch 146 in logical epoch 146
[2023-06-27 10:17:42] [data] Shuffling data
[2023-06-27 10:17:42] [data] Done reading 20,192 sentences
[2023-06-27 10:17:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:17:54] Ep. 146 : Up. 15000 : Sen. 4,987 : Cost 0.59443766 * 3,770,380 @ 5,299 after 56,565,619 : Time 212.11s : 17775.19 words/s : gNorm 1.0442
[2023-06-27 10:18:22] Seen 16,611 samples
[2023-06-27 10:18:22] Starting data epoch 147 in logical epoch 147
[2023-06-27 10:18:22] [data] Shuffling data
[2023-06-27 10:18:22] [data] Done reading 20,192 sentences
[2023-06-27 10:18:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:19:03] Seen 16,611 samples
[2023-06-27 10:19:03] Starting data epoch 148 in logical epoch 148
[2023-06-27 10:19:03] [data] Shuffling data
[2023-06-27 10:19:03] [data] Done reading 20,192 sentences
[2023-06-27 10:19:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:19:43] Seen 16,611 samples
[2023-06-27 10:19:43] Starting data epoch 149 in logical epoch 149
[2023-06-27 10:19:43] [data] Shuffling data
[2023-06-27 10:19:43] [data] Done reading 20,192 sentences
[2023-06-27 10:19:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:20:24] Seen 16,611 samples
[2023-06-27 10:20:24] Starting data epoch 150 in logical epoch 150
[2023-06-27 10:20:24] [data] Shuffling data
[2023-06-27 10:20:24] [data] Done reading 20,192 sentences
[2023-06-27 10:20:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:21:04] Seen 16,611 samples
[2023-06-27 10:21:04] Starting data epoch 151 in logical epoch 151
[2023-06-27 10:21:04] Training finished
[2023-06-27 10:21:13] [valid] Ep. 151 : Up. 15488 : cross-entropy : 127.179 : stalled 7 times (last best: 118.897)
[2023-06-27 10:21:45] [valid] Ep. 151 : Up. 15488 : translation : 0 : new best
[2023-06-27 10:21:45] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:21:47] Saving Adam parameters
[2023-06-27 10:21:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:24:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:24:59] [marian] Running on node20.datos.cluster.uy as process 39842 with command line:
[2023-06-27 10:24:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 160 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 10:24:59] [config] after: 0e
[2023-06-27 10:24:59] [config] after-batches: 0
[2023-06-27 10:24:59] [config] after-epochs: 160
[2023-06-27 10:24:59] [config] all-caps-every: 0
[2023-06-27 10:24:59] [config] allow-unk: false
[2023-06-27 10:24:59] [config] authors: false
[2023-06-27 10:24:59] [config] beam-size: 6
[2023-06-27 10:24:59] [config] bert-class-symbol: "[CLS]"
[2023-06-27 10:24:59] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 10:24:59] [config] bert-masking-fraction: 0.15
[2023-06-27 10:24:59] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 10:24:59] [config] bert-train-type-embeddings: true
[2023-06-27 10:24:59] [config] bert-type-vocab-size: 2
[2023-06-27 10:24:59] [config] build-info: ""
[2023-06-27 10:24:59] [config] check-gradient-nan: false
[2023-06-27 10:24:59] [config] check-nan: false
[2023-06-27 10:24:59] [config] cite: false
[2023-06-27 10:24:59] [config] clip-norm: 1
[2023-06-27 10:24:59] [config] cost-scaling:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] cost-type: ce-sum
[2023-06-27 10:24:59] [config] cpu-threads: 0
[2023-06-27 10:24:59] [config] data-threads: 8
[2023-06-27 10:24:59] [config] data-weighting: ""
[2023-06-27 10:24:59] [config] data-weighting-type: sentence
[2023-06-27 10:24:59] [config] dec-cell: gru
[2023-06-27 10:24:59] [config] dec-cell-base-depth: 2
[2023-06-27 10:24:59] [config] dec-cell-high-depth: 1
[2023-06-27 10:24:59] [config] dec-depth: 1
[2023-06-27 10:24:59] [config] devices:
[2023-06-27 10:24:59] [config]   - 0
[2023-06-27 10:24:59] [config] dim-emb: 512
[2023-06-27 10:24:59] [config] dim-rnn: 1024
[2023-06-27 10:24:59] [config] dim-vocabs:
[2023-06-27 10:24:59] [config]   - 16384
[2023-06-27 10:24:59] [config]   - 16384
[2023-06-27 10:24:59] [config] disp-first: 0
[2023-06-27 10:24:59] [config] disp-freq: 1000u
[2023-06-27 10:24:59] [config] disp-label-counts: true
[2023-06-27 10:24:59] [config] dropout-rnn: 0.2
[2023-06-27 10:24:59] [config] dropout-src: 0.1
[2023-06-27 10:24:59] [config] dropout-trg: 0.1
[2023-06-27 10:24:59] [config] dump-config: ""
[2023-06-27 10:24:59] [config] dynamic-gradient-scaling:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] early-stopping: 10
[2023-06-27 10:24:59] [config] early-stopping-on: first
[2023-06-27 10:24:59] [config] embedding-fix-src: false
[2023-06-27 10:24:59] [config] embedding-fix-trg: false
[2023-06-27 10:24:59] [config] embedding-normalization: false
[2023-06-27 10:24:59] [config] embedding-vectors:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] enc-cell: gru
[2023-06-27 10:24:59] [config] enc-cell-depth: 1
[2023-06-27 10:24:59] [config] enc-depth: 1
[2023-06-27 10:24:59] [config] enc-type: bidirectional
[2023-06-27 10:24:59] [config] english-title-case-every: 0
[2023-06-27 10:24:59] [config] exponential-smoothing: 0
[2023-06-27 10:24:59] [config] factor-weight: 1
[2023-06-27 10:24:59] [config] factors-combine: sum
[2023-06-27 10:24:59] [config] factors-dim-emb: 0
[2023-06-27 10:24:59] [config] gradient-checkpointing: false
[2023-06-27 10:24:59] [config] gradient-norm-average-window: 100
[2023-06-27 10:24:59] [config] guided-alignment: none
[2023-06-27 10:24:59] [config] guided-alignment-cost: mse
[2023-06-27 10:24:59] [config] guided-alignment-weight: 0.1
[2023-06-27 10:24:59] [config] ignore-model-config: false
[2023-06-27 10:24:59] [config] input-types:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] interpolate-env-vars: false
[2023-06-27 10:24:59] [config] keep-best: false
[2023-06-27 10:24:59] [config] label-smoothing: 0
[2023-06-27 10:24:59] [config] layer-normalization: true
[2023-06-27 10:24:59] [config] learn-rate: 0.0001
[2023-06-27 10:24:59] [config] lemma-dependency: ""
[2023-06-27 10:24:59] [config] lemma-dim-emb: 0
[2023-06-27 10:24:59] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 10:24:59] [config] log-level: info
[2023-06-27 10:24:59] [config] log-time-zone: ""
[2023-06-27 10:24:59] [config] logical-epoch:
[2023-06-27 10:24:59] [config]   - 1e
[2023-06-27 10:24:59] [config]   - 0
[2023-06-27 10:24:59] [config] lr-decay: 0
[2023-06-27 10:24:59] [config] lr-decay-freq: 50000
[2023-06-27 10:24:59] [config] lr-decay-inv-sqrt:
[2023-06-27 10:24:59] [config]   - 0
[2023-06-27 10:24:59] [config] lr-decay-repeat-warmup: false
[2023-06-27 10:24:59] [config] lr-decay-reset-optimizer: false
[2023-06-27 10:24:59] [config] lr-decay-start:
[2023-06-27 10:24:59] [config]   - 10
[2023-06-27 10:24:59] [config]   - 1
[2023-06-27 10:24:59] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 10:24:59] [config] lr-report: false
[2023-06-27 10:24:59] [config] lr-warmup: 0
[2023-06-27 10:24:59] [config] lr-warmup-at-reload: false
[2023-06-27 10:24:59] [config] lr-warmup-cycle: false
[2023-06-27 10:24:59] [config] lr-warmup-start-rate: 0
[2023-06-27 10:24:59] [config] max-length: 50
[2023-06-27 10:24:59] [config] max-length-crop: false
[2023-06-27 10:24:59] [config] max-length-factor: 3
[2023-06-27 10:24:59] [config] maxi-batch: 100
[2023-06-27 10:24:59] [config] maxi-batch-sort: trg
[2023-06-27 10:24:59] [config] mini-batch: 64
[2023-06-27 10:24:59] [config] mini-batch-fit: true
[2023-06-27 10:24:59] [config] mini-batch-fit-step: 10
[2023-06-27 10:24:59] [config] mini-batch-round-up: true
[2023-06-27 10:24:59] [config] mini-batch-track-lr: false
[2023-06-27 10:24:59] [config] mini-batch-warmup: 0
[2023-06-27 10:24:59] [config] mini-batch-words: 0
[2023-06-27 10:24:59] [config] mini-batch-words-ref: 0
[2023-06-27 10:24:59] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:24:59] [config] multi-loss-type: sum
[2023-06-27 10:24:59] [config] n-best: false
[2023-06-27 10:24:59] [config] no-nccl: false
[2023-06-27 10:24:59] [config] no-reload: false
[2023-06-27 10:24:59] [config] no-restore-corpus: false
[2023-06-27 10:24:59] [config] normalize: 0.6
[2023-06-27 10:24:59] [config] normalize-gradient: false
[2023-06-27 10:24:59] [config] num-devices: 0
[2023-06-27 10:24:59] [config] optimizer: adam
[2023-06-27 10:24:59] [config] optimizer-delay: 1
[2023-06-27 10:24:59] [config] optimizer-params:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] output-omit-bias: false
[2023-06-27 10:24:59] [config] overwrite: false
[2023-06-27 10:24:59] [config] precision:
[2023-06-27 10:24:59] [config]   - float32
[2023-06-27 10:24:59] [config]   - float32
[2023-06-27 10:24:59] [config] pretrained-model: ""
[2023-06-27 10:24:59] [config] quantize-biases: false
[2023-06-27 10:24:59] [config] quantize-bits: 0
[2023-06-27 10:24:59] [config] quantize-log-based: false
[2023-06-27 10:24:59] [config] quantize-optimization-steps: 0
[2023-06-27 10:24:59] [config] quiet: false
[2023-06-27 10:24:59] [config] quiet-translation: true
[2023-06-27 10:24:59] [config] relative-paths: false
[2023-06-27 10:24:59] [config] right-left: false
[2023-06-27 10:24:59] [config] save-freq: 10000u
[2023-06-27 10:24:59] [config] seed: 1234
[2023-06-27 10:24:59] [config] sentencepiece-alphas:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] sentencepiece-max-lines: 2000000
[2023-06-27 10:24:59] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 10:24:59] [config] sharding: global
[2023-06-27 10:24:59] [config] shuffle: data
[2023-06-27 10:24:59] [config] shuffle-in-ram: false
[2023-06-27 10:24:59] [config] sigterm: save-and-exit
[2023-06-27 10:24:59] [config] skip: false
[2023-06-27 10:24:59] [config] sqlite: ""
[2023-06-27 10:24:59] [config] sqlite-drop: false
[2023-06-27 10:24:59] [config] sync-freq: 200u
[2023-06-27 10:24:59] [config] sync-sgd: false
[2023-06-27 10:24:59] [config] tempdir: /tmp
[2023-06-27 10:24:59] [config] tied-embeddings: false
[2023-06-27 10:24:59] [config] tied-embeddings-all: true
[2023-06-27 10:24:59] [config] tied-embeddings-src: false
[2023-06-27 10:24:59] [config] train-embedder-rank:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] train-sets:
[2023-06-27 10:24:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 10:24:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 10:24:59] [config] transformer-aan-activation: swish
[2023-06-27 10:24:59] [config] transformer-aan-depth: 2
[2023-06-27 10:24:59] [config] transformer-aan-nogate: false
[2023-06-27 10:24:59] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 10:24:59] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 10:24:59] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 10:24:59] [config] transformer-depth-scaling: false
[2023-06-27 10:24:59] [config] transformer-dim-aan: 2048
[2023-06-27 10:24:59] [config] transformer-dim-ffn: 2048
[2023-06-27 10:24:59] [config] transformer-dropout: 0
[2023-06-27 10:24:59] [config] transformer-dropout-attention: 0
[2023-06-27 10:24:59] [config] transformer-dropout-ffn: 0
[2023-06-27 10:24:59] [config] transformer-ffn-activation: swish
[2023-06-27 10:24:59] [config] transformer-ffn-depth: 2
[2023-06-27 10:24:59] [config] transformer-guided-alignment-layer: last
[2023-06-27 10:24:59] [config] transformer-heads: 8
[2023-06-27 10:24:59] [config] transformer-no-projection: false
[2023-06-27 10:24:59] [config] transformer-pool: false
[2023-06-27 10:24:59] [config] transformer-postprocess: dan
[2023-06-27 10:24:59] [config] transformer-postprocess-emb: d
[2023-06-27 10:24:59] [config] transformer-postprocess-top: ""
[2023-06-27 10:24:59] [config] transformer-preprocess: ""
[2023-06-27 10:24:59] [config] transformer-tied-layers:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] transformer-train-position-embeddings: false
[2023-06-27 10:24:59] [config] tsv: false
[2023-06-27 10:24:59] [config] tsv-fields: 0
[2023-06-27 10:24:59] [config] type: amun
[2023-06-27 10:24:59] [config] ulr: false
[2023-06-27 10:24:59] [config] ulr-dim-emb: 0
[2023-06-27 10:24:59] [config] ulr-dropout: 0
[2023-06-27 10:24:59] [config] ulr-keys-vectors: ""
[2023-06-27 10:24:59] [config] ulr-query-vectors: ""
[2023-06-27 10:24:59] [config] ulr-softmax-temperature: 1
[2023-06-27 10:24:59] [config] ulr-trainable-transformation: false
[2023-06-27 10:24:59] [config] unlikelihood-loss: false
[2023-06-27 10:24:59] [config] valid-freq: 5000000
[2023-06-27 10:24:59] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 10:24:59] [config] valid-max-length: 1000
[2023-06-27 10:24:59] [config] valid-metrics:
[2023-06-27 10:24:59] [config]   - cross-entropy
[2023-06-27 10:24:59] [config]   - translation
[2023-06-27 10:24:59] [config] valid-mini-batch: 32
[2023-06-27 10:24:59] [config] valid-reset-stalled: false
[2023-06-27 10:24:59] [config] valid-script-args:
[2023-06-27 10:24:59] [config]   []
[2023-06-27 10:24:59] [config] valid-script-path: ""
[2023-06-27 10:24:59] [config] valid-sets:
[2023-06-27 10:24:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 10:24:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 10:24:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 10:24:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:24:59] [config] vocabs:
[2023-06-27 10:24:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:24:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:24:59] [config] word-penalty: 0
[2023-06-27 10:24:59] [config] word-scores: false
[2023-06-27 10:24:59] [config] workspace: 3000
[2023-06-27 10:24:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:24:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:24:59] [training] Using single-device training
[2023-06-27 10:24:59] Synced seed 1234
[2023-06-27 10:24:59] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:25:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 10:25:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:25:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 10:25:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 10:25:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:25:00] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:25:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:25:00] [comm] Using global sharding
[2023-06-27 10:25:00] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:25:00] [training] Using 1 GPUs
[2023-06-27 10:25:00] [logits] Applying loss function for 1 factor(s)
[2023-06-27 10:25:00] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:25:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 10:25:01] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:25:13] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 10:25:13] [valid] No post-processing script given for validating translator
[2023-06-27 10:25:13] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:25:13] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:25:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:25:13] [comm] Using global sharding
[2023-06-27 10:25:13] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:25:13] [training] Using 1 GPUs
[2023-06-27 10:25:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:25:14] Loading Adam parameters
[2023-06-27 10:25:14] [memory] Reserving 322 MB, device gpu0
[2023-06-27 10:25:14] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:25:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:25:14] [data] Restoring the corpus state to epoch 151, batch 15488
[2023-06-27 10:25:14] [data] Shuffling data
[2023-06-27 10:25:14] [data] Done reading 20,192 sentences
[2023-06-27 10:25:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:25:15] Training started
[2023-06-27 10:25:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 10:25:15] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:25:15] Parameter type float32, optimization type float32, casting types false
[2023-06-27 10:25:52] Seen 16,611 samples
[2023-06-27 10:25:52] Starting data epoch 152 in logical epoch 152
[2023-06-27 10:25:52] [data] Shuffling data
[2023-06-27 10:25:52] [data] Done reading 20,192 sentences
[2023-06-27 10:25:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:26:32] Seen 16,611 samples
[2023-06-27 10:26:32] Starting data epoch 153 in logical epoch 153
[2023-06-27 10:26:32] [data] Shuffling data
[2023-06-27 10:26:32] [data] Done reading 20,192 sentences
[2023-06-27 10:26:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:27:12] Seen 16,611 samples
[2023-06-27 10:27:12] Starting data epoch 154 in logical epoch 154
[2023-06-27 10:27:12] [data] Shuffling data
[2023-06-27 10:27:12] [data] Done reading 20,192 sentences
[2023-06-27 10:27:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:27:52] Seen 16,611 samples
[2023-06-27 10:27:52] Starting data epoch 155 in logical epoch 155
[2023-06-27 10:27:52] [data] Shuffling data
[2023-06-27 10:27:52] [data] Done reading 20,192 sentences
[2023-06-27 10:27:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:28:32] Ep. 155 : Up. 16000 : Sen. 16,483 : Cost 0.53135216 * 3,773,589 @ 4,408 after 60,339,208 : Time 199.35s : 18929.11 words/s : gNorm 0.9378
[2023-06-27 10:28:33] Seen 16,611 samples
[2023-06-27 10:28:33] Starting data epoch 156 in logical epoch 156
[2023-06-27 10:28:33] [data] Shuffling data
[2023-06-27 10:28:33] [data] Done reading 20,192 sentences
[2023-06-27 10:28:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:29:14] Seen 16,611 samples
[2023-06-27 10:29:14] Starting data epoch 157 in logical epoch 157
[2023-06-27 10:29:14] [data] Shuffling data
[2023-06-27 10:29:14] [data] Done reading 20,192 sentences
[2023-06-27 10:29:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:29:54] Seen 16,611 samples
[2023-06-27 10:29:54] Starting data epoch 158 in logical epoch 158
[2023-06-27 10:29:54] [data] Shuffling data
[2023-06-27 10:29:54] [data] Done reading 20,192 sentences
[2023-06-27 10:29:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:30:35] Seen 16,611 samples
[2023-06-27 10:30:35] Starting data epoch 159 in logical epoch 159
[2023-06-27 10:30:35] [data] Shuffling data
[2023-06-27 10:30:35] [data] Done reading 20,192 sentences
[2023-06-27 10:30:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:31:15] Seen 16,611 samples
[2023-06-27 10:31:15] Starting data epoch 160 in logical epoch 160
[2023-06-27 10:31:15] [data] Shuffling data
[2023-06-27 10:31:15] [data] Done reading 20,192 sentences
[2023-06-27 10:31:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:31:56] Seen 16,611 samples
[2023-06-27 10:31:56] Starting data epoch 161 in logical epoch 161
[2023-06-27 10:31:56] Training finished
[2023-06-27 10:32:05] [valid] Ep. 161 : Up. 16517 : cross-entropy : 128.282 : stalled 8 times (last best: 118.897)
[2023-06-27 10:32:40] [valid] Ep. 161 : Up. 16517 : translation : 0 : new best
[2023-06-27 10:32:40] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:32:43] Saving Adam parameters
[2023-06-27 10:32:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:36:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:36:03] [marian] Running on node20.datos.cluster.uy as process 40492 with command line:
[2023-06-27 10:36:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 170 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 10:36:03] [config] after: 0e
[2023-06-27 10:36:03] [config] after-batches: 0
[2023-06-27 10:36:03] [config] after-epochs: 170
[2023-06-27 10:36:03] [config] all-caps-every: 0
[2023-06-27 10:36:03] [config] allow-unk: false
[2023-06-27 10:36:03] [config] authors: false
[2023-06-27 10:36:03] [config] beam-size: 6
[2023-06-27 10:36:03] [config] bert-class-symbol: "[CLS]"
[2023-06-27 10:36:03] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 10:36:03] [config] bert-masking-fraction: 0.15
[2023-06-27 10:36:03] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 10:36:03] [config] bert-train-type-embeddings: true
[2023-06-27 10:36:03] [config] bert-type-vocab-size: 2
[2023-06-27 10:36:03] [config] build-info: ""
[2023-06-27 10:36:03] [config] check-gradient-nan: false
[2023-06-27 10:36:03] [config] check-nan: false
[2023-06-27 10:36:03] [config] cite: false
[2023-06-27 10:36:03] [config] clip-norm: 1
[2023-06-27 10:36:03] [config] cost-scaling:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] cost-type: ce-sum
[2023-06-27 10:36:03] [config] cpu-threads: 0
[2023-06-27 10:36:03] [config] data-threads: 8
[2023-06-27 10:36:03] [config] data-weighting: ""
[2023-06-27 10:36:03] [config] data-weighting-type: sentence
[2023-06-27 10:36:03] [config] dec-cell: gru
[2023-06-27 10:36:03] [config] dec-cell-base-depth: 2
[2023-06-27 10:36:03] [config] dec-cell-high-depth: 1
[2023-06-27 10:36:03] [config] dec-depth: 1
[2023-06-27 10:36:03] [config] devices:
[2023-06-27 10:36:03] [config]   - 0
[2023-06-27 10:36:03] [config] dim-emb: 512
[2023-06-27 10:36:03] [config] dim-rnn: 1024
[2023-06-27 10:36:03] [config] dim-vocabs:
[2023-06-27 10:36:03] [config]   - 16384
[2023-06-27 10:36:03] [config]   - 16384
[2023-06-27 10:36:03] [config] disp-first: 0
[2023-06-27 10:36:03] [config] disp-freq: 1000u
[2023-06-27 10:36:03] [config] disp-label-counts: true
[2023-06-27 10:36:03] [config] dropout-rnn: 0.2
[2023-06-27 10:36:03] [config] dropout-src: 0.1
[2023-06-27 10:36:03] [config] dropout-trg: 0.1
[2023-06-27 10:36:03] [config] dump-config: ""
[2023-06-27 10:36:03] [config] dynamic-gradient-scaling:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] early-stopping: 10
[2023-06-27 10:36:03] [config] early-stopping-on: first
[2023-06-27 10:36:03] [config] embedding-fix-src: false
[2023-06-27 10:36:03] [config] embedding-fix-trg: false
[2023-06-27 10:36:03] [config] embedding-normalization: false
[2023-06-27 10:36:03] [config] embedding-vectors:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] enc-cell: gru
[2023-06-27 10:36:03] [config] enc-cell-depth: 1
[2023-06-27 10:36:03] [config] enc-depth: 1
[2023-06-27 10:36:03] [config] enc-type: bidirectional
[2023-06-27 10:36:03] [config] english-title-case-every: 0
[2023-06-27 10:36:03] [config] exponential-smoothing: 0
[2023-06-27 10:36:03] [config] factor-weight: 1
[2023-06-27 10:36:03] [config] factors-combine: sum
[2023-06-27 10:36:03] [config] factors-dim-emb: 0
[2023-06-27 10:36:03] [config] gradient-checkpointing: false
[2023-06-27 10:36:03] [config] gradient-norm-average-window: 100
[2023-06-27 10:36:03] [config] guided-alignment: none
[2023-06-27 10:36:03] [config] guided-alignment-cost: mse
[2023-06-27 10:36:03] [config] guided-alignment-weight: 0.1
[2023-06-27 10:36:03] [config] ignore-model-config: false
[2023-06-27 10:36:03] [config] input-types:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] interpolate-env-vars: false
[2023-06-27 10:36:03] [config] keep-best: false
[2023-06-27 10:36:03] [config] label-smoothing: 0
[2023-06-27 10:36:03] [config] layer-normalization: true
[2023-06-27 10:36:03] [config] learn-rate: 0.0001
[2023-06-27 10:36:03] [config] lemma-dependency: ""
[2023-06-27 10:36:03] [config] lemma-dim-emb: 0
[2023-06-27 10:36:03] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 10:36:03] [config] log-level: info
[2023-06-27 10:36:03] [config] log-time-zone: ""
[2023-06-27 10:36:03] [config] logical-epoch:
[2023-06-27 10:36:03] [config]   - 1e
[2023-06-27 10:36:03] [config]   - 0
[2023-06-27 10:36:03] [config] lr-decay: 0
[2023-06-27 10:36:03] [config] lr-decay-freq: 50000
[2023-06-27 10:36:03] [config] lr-decay-inv-sqrt:
[2023-06-27 10:36:03] [config]   - 0
[2023-06-27 10:36:03] [config] lr-decay-repeat-warmup: false
[2023-06-27 10:36:03] [config] lr-decay-reset-optimizer: false
[2023-06-27 10:36:03] [config] lr-decay-start:
[2023-06-27 10:36:03] [config]   - 10
[2023-06-27 10:36:03] [config]   - 1
[2023-06-27 10:36:03] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 10:36:03] [config] lr-report: false
[2023-06-27 10:36:03] [config] lr-warmup: 0
[2023-06-27 10:36:03] [config] lr-warmup-at-reload: false
[2023-06-27 10:36:03] [config] lr-warmup-cycle: false
[2023-06-27 10:36:03] [config] lr-warmup-start-rate: 0
[2023-06-27 10:36:03] [config] max-length: 50
[2023-06-27 10:36:03] [config] max-length-crop: false
[2023-06-27 10:36:03] [config] max-length-factor: 3
[2023-06-27 10:36:03] [config] maxi-batch: 100
[2023-06-27 10:36:03] [config] maxi-batch-sort: trg
[2023-06-27 10:36:03] [config] mini-batch: 64
[2023-06-27 10:36:03] [config] mini-batch-fit: true
[2023-06-27 10:36:03] [config] mini-batch-fit-step: 10
[2023-06-27 10:36:03] [config] mini-batch-round-up: true
[2023-06-27 10:36:03] [config] mini-batch-track-lr: false
[2023-06-27 10:36:03] [config] mini-batch-warmup: 0
[2023-06-27 10:36:03] [config] mini-batch-words: 0
[2023-06-27 10:36:03] [config] mini-batch-words-ref: 0
[2023-06-27 10:36:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:36:03] [config] multi-loss-type: sum
[2023-06-27 10:36:03] [config] n-best: false
[2023-06-27 10:36:03] [config] no-nccl: false
[2023-06-27 10:36:03] [config] no-reload: false
[2023-06-27 10:36:03] [config] no-restore-corpus: false
[2023-06-27 10:36:03] [config] normalize: 0.6
[2023-06-27 10:36:03] [config] normalize-gradient: false
[2023-06-27 10:36:03] [config] num-devices: 0
[2023-06-27 10:36:03] [config] optimizer: adam
[2023-06-27 10:36:03] [config] optimizer-delay: 1
[2023-06-27 10:36:03] [config] optimizer-params:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] output-omit-bias: false
[2023-06-27 10:36:03] [config] overwrite: false
[2023-06-27 10:36:03] [config] precision:
[2023-06-27 10:36:03] [config]   - float32
[2023-06-27 10:36:03] [config]   - float32
[2023-06-27 10:36:03] [config] pretrained-model: ""
[2023-06-27 10:36:03] [config] quantize-biases: false
[2023-06-27 10:36:03] [config] quantize-bits: 0
[2023-06-27 10:36:03] [config] quantize-log-based: false
[2023-06-27 10:36:03] [config] quantize-optimization-steps: 0
[2023-06-27 10:36:03] [config] quiet: false
[2023-06-27 10:36:03] [config] quiet-translation: true
[2023-06-27 10:36:03] [config] relative-paths: false
[2023-06-27 10:36:03] [config] right-left: false
[2023-06-27 10:36:03] [config] save-freq: 10000u
[2023-06-27 10:36:03] [config] seed: 1234
[2023-06-27 10:36:03] [config] sentencepiece-alphas:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] sentencepiece-max-lines: 2000000
[2023-06-27 10:36:03] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 10:36:03] [config] sharding: global
[2023-06-27 10:36:03] [config] shuffle: data
[2023-06-27 10:36:03] [config] shuffle-in-ram: false
[2023-06-27 10:36:03] [config] sigterm: save-and-exit
[2023-06-27 10:36:03] [config] skip: false
[2023-06-27 10:36:03] [config] sqlite: ""
[2023-06-27 10:36:03] [config] sqlite-drop: false
[2023-06-27 10:36:03] [config] sync-freq: 200u
[2023-06-27 10:36:03] [config] sync-sgd: false
[2023-06-27 10:36:03] [config] tempdir: /tmp
[2023-06-27 10:36:03] [config] tied-embeddings: false
[2023-06-27 10:36:03] [config] tied-embeddings-all: true
[2023-06-27 10:36:03] [config] tied-embeddings-src: false
[2023-06-27 10:36:03] [config] train-embedder-rank:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] train-sets:
[2023-06-27 10:36:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 10:36:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 10:36:03] [config] transformer-aan-activation: swish
[2023-06-27 10:36:03] [config] transformer-aan-depth: 2
[2023-06-27 10:36:03] [config] transformer-aan-nogate: false
[2023-06-27 10:36:03] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 10:36:03] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 10:36:03] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 10:36:03] [config] transformer-depth-scaling: false
[2023-06-27 10:36:03] [config] transformer-dim-aan: 2048
[2023-06-27 10:36:03] [config] transformer-dim-ffn: 2048
[2023-06-27 10:36:03] [config] transformer-dropout: 0
[2023-06-27 10:36:03] [config] transformer-dropout-attention: 0
[2023-06-27 10:36:03] [config] transformer-dropout-ffn: 0
[2023-06-27 10:36:03] [config] transformer-ffn-activation: swish
[2023-06-27 10:36:03] [config] transformer-ffn-depth: 2
[2023-06-27 10:36:03] [config] transformer-guided-alignment-layer: last
[2023-06-27 10:36:03] [config] transformer-heads: 8
[2023-06-27 10:36:03] [config] transformer-no-projection: false
[2023-06-27 10:36:03] [config] transformer-pool: false
[2023-06-27 10:36:03] [config] transformer-postprocess: dan
[2023-06-27 10:36:03] [config] transformer-postprocess-emb: d
[2023-06-27 10:36:03] [config] transformer-postprocess-top: ""
[2023-06-27 10:36:03] [config] transformer-preprocess: ""
[2023-06-27 10:36:03] [config] transformer-tied-layers:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] transformer-train-position-embeddings: false
[2023-06-27 10:36:03] [config] tsv: false
[2023-06-27 10:36:03] [config] tsv-fields: 0
[2023-06-27 10:36:03] [config] type: amun
[2023-06-27 10:36:03] [config] ulr: false
[2023-06-27 10:36:03] [config] ulr-dim-emb: 0
[2023-06-27 10:36:03] [config] ulr-dropout: 0
[2023-06-27 10:36:03] [config] ulr-keys-vectors: ""
[2023-06-27 10:36:03] [config] ulr-query-vectors: ""
[2023-06-27 10:36:03] [config] ulr-softmax-temperature: 1
[2023-06-27 10:36:03] [config] ulr-trainable-transformation: false
[2023-06-27 10:36:03] [config] unlikelihood-loss: false
[2023-06-27 10:36:03] [config] valid-freq: 5000000
[2023-06-27 10:36:03] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 10:36:03] [config] valid-max-length: 1000
[2023-06-27 10:36:03] [config] valid-metrics:
[2023-06-27 10:36:03] [config]   - cross-entropy
[2023-06-27 10:36:03] [config]   - translation
[2023-06-27 10:36:03] [config] valid-mini-batch: 32
[2023-06-27 10:36:03] [config] valid-reset-stalled: false
[2023-06-27 10:36:03] [config] valid-script-args:
[2023-06-27 10:36:03] [config]   []
[2023-06-27 10:36:03] [config] valid-script-path: ""
[2023-06-27 10:36:03] [config] valid-sets:
[2023-06-27 10:36:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 10:36:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 10:36:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 10:36:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:36:03] [config] vocabs:
[2023-06-27 10:36:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:36:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:36:03] [config] word-penalty: 0
[2023-06-27 10:36:03] [config] word-scores: false
[2023-06-27 10:36:03] [config] workspace: 3000
[2023-06-27 10:36:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:36:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:36:03] [training] Using single-device training
[2023-06-27 10:36:05] Synced seed 1234
[2023-06-27 10:36:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:36:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 10:36:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:36:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 10:36:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 10:36:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:36:05] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:36:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:36:05] [comm] Using global sharding
[2023-06-27 10:36:05] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:36:05] [training] Using 1 GPUs
[2023-06-27 10:36:05] [logits] Applying loss function for 1 factor(s)
[2023-06-27 10:36:05] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:36:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 10:36:06] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:36:18] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 10:36:18] [valid] No post-processing script given for validating translator
[2023-06-27 10:36:18] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:36:18] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:36:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:36:18] [comm] Using global sharding
[2023-06-27 10:36:18] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:36:18] [training] Using 1 GPUs
[2023-06-27 10:36:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:36:25] Loading Adam parameters
[2023-06-27 10:36:25] [memory] Reserving 322 MB, device gpu0
[2023-06-27 10:36:25] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:36:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:36:25] [data] Restoring the corpus state to epoch 161, batch 16517
[2023-06-27 10:36:25] [data] Shuffling data
[2023-06-27 10:36:25] [data] Done reading 20,192 sentences
[2023-06-27 10:36:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:36:25] Training started
[2023-06-27 10:36:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 10:36:26] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:36:26] Parameter type float32, optimization type float32, casting types false
[2023-06-27 10:37:02] Seen 16,611 samples
[2023-06-27 10:37:02] Starting data epoch 162 in logical epoch 162
[2023-06-27 10:37:02] [data] Shuffling data
[2023-06-27 10:37:02] [data] Done reading 20,192 sentences
[2023-06-27 10:37:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:37:41] Seen 16,611 samples
[2023-06-27 10:37:41] Starting data epoch 163 in logical epoch 163
[2023-06-27 10:37:41] [data] Shuffling data
[2023-06-27 10:37:41] [data] Done reading 20,192 sentences
[2023-06-27 10:37:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:38:21] Seen 16,611 samples
[2023-06-27 10:38:21] Starting data epoch 164 in logical epoch 164
[2023-06-27 10:38:21] [data] Shuffling data
[2023-06-27 10:38:21] [data] Done reading 20,192 sentences
[2023-06-27 10:38:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:39:02] Seen 16,611 samples
[2023-06-27 10:39:02] Starting data epoch 165 in logical epoch 165
[2023-06-27 10:39:02] [data] Shuffling data
[2023-06-27 10:39:02] [data] Done reading 20,192 sentences
[2023-06-27 10:39:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:39:30] Ep. 165 : Up. 17000 : Sen. 11,547 : Cost 0.48173106 * 3,780,126 @ 3,064 after 64,119,334 : Time 191.90s : 19698.60 words/s : gNorm 0.8702
[2023-06-27 10:39:42] Seen 16,611 samples
[2023-06-27 10:39:42] Starting data epoch 166 in logical epoch 166
[2023-06-27 10:39:42] [data] Shuffling data
[2023-06-27 10:39:42] [data] Done reading 20,192 sentences
[2023-06-27 10:39:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:40:23] Seen 16,611 samples
[2023-06-27 10:40:23] Starting data epoch 167 in logical epoch 167
[2023-06-27 10:40:23] [data] Shuffling data
[2023-06-27 10:40:24] [data] Done reading 20,192 sentences
[2023-06-27 10:40:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:41:04] Seen 16,611 samples
[2023-06-27 10:41:04] Starting data epoch 168 in logical epoch 168
[2023-06-27 10:41:04] [data] Shuffling data
[2023-06-27 10:41:04] [data] Done reading 20,192 sentences
[2023-06-27 10:41:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:41:45] Seen 16,611 samples
[2023-06-27 10:41:45] Starting data epoch 169 in logical epoch 169
[2023-06-27 10:41:45] [data] Shuffling data
[2023-06-27 10:41:45] [data] Done reading 20,192 sentences
[2023-06-27 10:41:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:42:26] Seen 16,611 samples
[2023-06-27 10:42:26] Starting data epoch 170 in logical epoch 170
[2023-06-27 10:42:26] [data] Shuffling data
[2023-06-27 10:42:26] [data] Done reading 20,192 sentences
[2023-06-27 10:42:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:43:06] Seen 16,611 samples
[2023-06-27 10:43:06] Starting data epoch 171 in logical epoch 171
[2023-06-27 10:43:06] Training finished
[2023-06-27 10:43:14] [valid] Ep. 171 : Up. 17548 : cross-entropy : 128.906 : stalled 9 times (last best: 118.897)
[2023-06-27 10:43:49] [valid] Ep. 171 : Up. 17548 : translation : 0 : new best
[2023-06-27 10:43:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:43:51] Saving Adam parameters
[2023-06-27 10:43:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:47:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:47:07] [marian] Running on node20.datos.cluster.uy as process 832 with command line:
[2023-06-27 10:47:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 180 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 10:47:07] [config] after: 0e
[2023-06-27 10:47:07] [config] after-batches: 0
[2023-06-27 10:47:07] [config] after-epochs: 180
[2023-06-27 10:47:07] [config] all-caps-every: 0
[2023-06-27 10:47:07] [config] allow-unk: false
[2023-06-27 10:47:07] [config] authors: false
[2023-06-27 10:47:07] [config] beam-size: 6
[2023-06-27 10:47:07] [config] bert-class-symbol: "[CLS]"
[2023-06-27 10:47:07] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 10:47:07] [config] bert-masking-fraction: 0.15
[2023-06-27 10:47:07] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 10:47:07] [config] bert-train-type-embeddings: true
[2023-06-27 10:47:07] [config] bert-type-vocab-size: 2
[2023-06-27 10:47:07] [config] build-info: ""
[2023-06-27 10:47:07] [config] check-gradient-nan: false
[2023-06-27 10:47:07] [config] check-nan: false
[2023-06-27 10:47:07] [config] cite: false
[2023-06-27 10:47:07] [config] clip-norm: 1
[2023-06-27 10:47:07] [config] cost-scaling:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] cost-type: ce-sum
[2023-06-27 10:47:07] [config] cpu-threads: 0
[2023-06-27 10:47:07] [config] data-threads: 8
[2023-06-27 10:47:07] [config] data-weighting: ""
[2023-06-27 10:47:07] [config] data-weighting-type: sentence
[2023-06-27 10:47:07] [config] dec-cell: gru
[2023-06-27 10:47:07] [config] dec-cell-base-depth: 2
[2023-06-27 10:47:07] [config] dec-cell-high-depth: 1
[2023-06-27 10:47:07] [config] dec-depth: 1
[2023-06-27 10:47:07] [config] devices:
[2023-06-27 10:47:07] [config]   - 0
[2023-06-27 10:47:07] [config] dim-emb: 512
[2023-06-27 10:47:07] [config] dim-rnn: 1024
[2023-06-27 10:47:07] [config] dim-vocabs:
[2023-06-27 10:47:07] [config]   - 16384
[2023-06-27 10:47:07] [config]   - 16384
[2023-06-27 10:47:07] [config] disp-first: 0
[2023-06-27 10:47:07] [config] disp-freq: 1000u
[2023-06-27 10:47:07] [config] disp-label-counts: true
[2023-06-27 10:47:07] [config] dropout-rnn: 0.2
[2023-06-27 10:47:07] [config] dropout-src: 0.1
[2023-06-27 10:47:07] [config] dropout-trg: 0.1
[2023-06-27 10:47:07] [config] dump-config: ""
[2023-06-27 10:47:07] [config] dynamic-gradient-scaling:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] early-stopping: 10
[2023-06-27 10:47:07] [config] early-stopping-on: first
[2023-06-27 10:47:07] [config] embedding-fix-src: false
[2023-06-27 10:47:07] [config] embedding-fix-trg: false
[2023-06-27 10:47:07] [config] embedding-normalization: false
[2023-06-27 10:47:07] [config] embedding-vectors:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] enc-cell: gru
[2023-06-27 10:47:07] [config] enc-cell-depth: 1
[2023-06-27 10:47:07] [config] enc-depth: 1
[2023-06-27 10:47:07] [config] enc-type: bidirectional
[2023-06-27 10:47:07] [config] english-title-case-every: 0
[2023-06-27 10:47:07] [config] exponential-smoothing: 0
[2023-06-27 10:47:07] [config] factor-weight: 1
[2023-06-27 10:47:07] [config] factors-combine: sum
[2023-06-27 10:47:07] [config] factors-dim-emb: 0
[2023-06-27 10:47:07] [config] gradient-checkpointing: false
[2023-06-27 10:47:07] [config] gradient-norm-average-window: 100
[2023-06-27 10:47:07] [config] guided-alignment: none
[2023-06-27 10:47:07] [config] guided-alignment-cost: mse
[2023-06-27 10:47:07] [config] guided-alignment-weight: 0.1
[2023-06-27 10:47:07] [config] ignore-model-config: false
[2023-06-27 10:47:07] [config] input-types:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] interpolate-env-vars: false
[2023-06-27 10:47:07] [config] keep-best: false
[2023-06-27 10:47:07] [config] label-smoothing: 0
[2023-06-27 10:47:07] [config] layer-normalization: true
[2023-06-27 10:47:07] [config] learn-rate: 0.0001
[2023-06-27 10:47:07] [config] lemma-dependency: ""
[2023-06-27 10:47:07] [config] lemma-dim-emb: 0
[2023-06-27 10:47:07] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 10:47:07] [config] log-level: info
[2023-06-27 10:47:07] [config] log-time-zone: ""
[2023-06-27 10:47:07] [config] logical-epoch:
[2023-06-27 10:47:07] [config]   - 1e
[2023-06-27 10:47:07] [config]   - 0
[2023-06-27 10:47:07] [config] lr-decay: 0
[2023-06-27 10:47:07] [config] lr-decay-freq: 50000
[2023-06-27 10:47:07] [config] lr-decay-inv-sqrt:
[2023-06-27 10:47:07] [config]   - 0
[2023-06-27 10:47:07] [config] lr-decay-repeat-warmup: false
[2023-06-27 10:47:07] [config] lr-decay-reset-optimizer: false
[2023-06-27 10:47:07] [config] lr-decay-start:
[2023-06-27 10:47:07] [config]   - 10
[2023-06-27 10:47:07] [config]   - 1
[2023-06-27 10:47:07] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 10:47:07] [config] lr-report: false
[2023-06-27 10:47:07] [config] lr-warmup: 0
[2023-06-27 10:47:07] [config] lr-warmup-at-reload: false
[2023-06-27 10:47:07] [config] lr-warmup-cycle: false
[2023-06-27 10:47:07] [config] lr-warmup-start-rate: 0
[2023-06-27 10:47:07] [config] max-length: 50
[2023-06-27 10:47:07] [config] max-length-crop: false
[2023-06-27 10:47:07] [config] max-length-factor: 3
[2023-06-27 10:47:07] [config] maxi-batch: 100
[2023-06-27 10:47:07] [config] maxi-batch-sort: trg
[2023-06-27 10:47:07] [config] mini-batch: 64
[2023-06-27 10:47:07] [config] mini-batch-fit: true
[2023-06-27 10:47:07] [config] mini-batch-fit-step: 10
[2023-06-27 10:47:07] [config] mini-batch-round-up: true
[2023-06-27 10:47:07] [config] mini-batch-track-lr: false
[2023-06-27 10:47:07] [config] mini-batch-warmup: 0
[2023-06-27 10:47:07] [config] mini-batch-words: 0
[2023-06-27 10:47:07] [config] mini-batch-words-ref: 0
[2023-06-27 10:47:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:47:07] [config] multi-loss-type: sum
[2023-06-27 10:47:07] [config] n-best: false
[2023-06-27 10:47:07] [config] no-nccl: false
[2023-06-27 10:47:07] [config] no-reload: false
[2023-06-27 10:47:07] [config] no-restore-corpus: false
[2023-06-27 10:47:07] [config] normalize: 0.6
[2023-06-27 10:47:07] [config] normalize-gradient: false
[2023-06-27 10:47:07] [config] num-devices: 0
[2023-06-27 10:47:07] [config] optimizer: adam
[2023-06-27 10:47:07] [config] optimizer-delay: 1
[2023-06-27 10:47:07] [config] optimizer-params:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] output-omit-bias: false
[2023-06-27 10:47:07] [config] overwrite: false
[2023-06-27 10:47:07] [config] precision:
[2023-06-27 10:47:07] [config]   - float32
[2023-06-27 10:47:07] [config]   - float32
[2023-06-27 10:47:07] [config] pretrained-model: ""
[2023-06-27 10:47:07] [config] quantize-biases: false
[2023-06-27 10:47:07] [config] quantize-bits: 0
[2023-06-27 10:47:07] [config] quantize-log-based: false
[2023-06-27 10:47:07] [config] quantize-optimization-steps: 0
[2023-06-27 10:47:07] [config] quiet: false
[2023-06-27 10:47:07] [config] quiet-translation: true
[2023-06-27 10:47:07] [config] relative-paths: false
[2023-06-27 10:47:07] [config] right-left: false
[2023-06-27 10:47:07] [config] save-freq: 10000u
[2023-06-27 10:47:07] [config] seed: 1234
[2023-06-27 10:47:07] [config] sentencepiece-alphas:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] sentencepiece-max-lines: 2000000
[2023-06-27 10:47:07] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 10:47:07] [config] sharding: global
[2023-06-27 10:47:07] [config] shuffle: data
[2023-06-27 10:47:07] [config] shuffle-in-ram: false
[2023-06-27 10:47:07] [config] sigterm: save-and-exit
[2023-06-27 10:47:07] [config] skip: false
[2023-06-27 10:47:07] [config] sqlite: ""
[2023-06-27 10:47:07] [config] sqlite-drop: false
[2023-06-27 10:47:07] [config] sync-freq: 200u
[2023-06-27 10:47:07] [config] sync-sgd: false
[2023-06-27 10:47:07] [config] tempdir: /tmp
[2023-06-27 10:47:07] [config] tied-embeddings: false
[2023-06-27 10:47:07] [config] tied-embeddings-all: true
[2023-06-27 10:47:07] [config] tied-embeddings-src: false
[2023-06-27 10:47:07] [config] train-embedder-rank:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] train-sets:
[2023-06-27 10:47:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 10:47:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 10:47:07] [config] transformer-aan-activation: swish
[2023-06-27 10:47:07] [config] transformer-aan-depth: 2
[2023-06-27 10:47:07] [config] transformer-aan-nogate: false
[2023-06-27 10:47:07] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 10:47:07] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 10:47:07] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 10:47:07] [config] transformer-depth-scaling: false
[2023-06-27 10:47:07] [config] transformer-dim-aan: 2048
[2023-06-27 10:47:07] [config] transformer-dim-ffn: 2048
[2023-06-27 10:47:07] [config] transformer-dropout: 0
[2023-06-27 10:47:07] [config] transformer-dropout-attention: 0
[2023-06-27 10:47:07] [config] transformer-dropout-ffn: 0
[2023-06-27 10:47:07] [config] transformer-ffn-activation: swish
[2023-06-27 10:47:07] [config] transformer-ffn-depth: 2
[2023-06-27 10:47:07] [config] transformer-guided-alignment-layer: last
[2023-06-27 10:47:07] [config] transformer-heads: 8
[2023-06-27 10:47:07] [config] transformer-no-projection: false
[2023-06-27 10:47:07] [config] transformer-pool: false
[2023-06-27 10:47:07] [config] transformer-postprocess: dan
[2023-06-27 10:47:07] [config] transformer-postprocess-emb: d
[2023-06-27 10:47:07] [config] transformer-postprocess-top: ""
[2023-06-27 10:47:07] [config] transformer-preprocess: ""
[2023-06-27 10:47:07] [config] transformer-tied-layers:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] transformer-train-position-embeddings: false
[2023-06-27 10:47:07] [config] tsv: false
[2023-06-27 10:47:07] [config] tsv-fields: 0
[2023-06-27 10:47:07] [config] type: amun
[2023-06-27 10:47:07] [config] ulr: false
[2023-06-27 10:47:07] [config] ulr-dim-emb: 0
[2023-06-27 10:47:07] [config] ulr-dropout: 0
[2023-06-27 10:47:07] [config] ulr-keys-vectors: ""
[2023-06-27 10:47:07] [config] ulr-query-vectors: ""
[2023-06-27 10:47:07] [config] ulr-softmax-temperature: 1
[2023-06-27 10:47:07] [config] ulr-trainable-transformation: false
[2023-06-27 10:47:07] [config] unlikelihood-loss: false
[2023-06-27 10:47:07] [config] valid-freq: 5000000
[2023-06-27 10:47:07] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 10:47:07] [config] valid-max-length: 1000
[2023-06-27 10:47:07] [config] valid-metrics:
[2023-06-27 10:47:07] [config]   - cross-entropy
[2023-06-27 10:47:07] [config]   - translation
[2023-06-27 10:47:07] [config] valid-mini-batch: 32
[2023-06-27 10:47:07] [config] valid-reset-stalled: false
[2023-06-27 10:47:07] [config] valid-script-args:
[2023-06-27 10:47:07] [config]   []
[2023-06-27 10:47:07] [config] valid-script-path: ""
[2023-06-27 10:47:07] [config] valid-sets:
[2023-06-27 10:47:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 10:47:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 10:47:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 10:47:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:47:07] [config] vocabs:
[2023-06-27 10:47:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:47:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:47:07] [config] word-penalty: 0
[2023-06-27 10:47:07] [config] word-scores: false
[2023-06-27 10:47:07] [config] workspace: 3000
[2023-06-27 10:47:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:47:07] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:47:07] [training] Using single-device training
[2023-06-27 10:47:08] Synced seed 1234
[2023-06-27 10:47:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:47:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 10:47:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:47:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 10:47:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 10:47:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:47:09] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:47:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:47:09] [comm] Using global sharding
[2023-06-27 10:47:09] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:47:09] [training] Using 1 GPUs
[2023-06-27 10:47:09] [logits] Applying loss function for 1 factor(s)
[2023-06-27 10:47:09] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:47:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 10:47:09] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:47:21] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 10:47:21] [valid] No post-processing script given for validating translator
[2023-06-27 10:47:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:47:21] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:47:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:47:21] [comm] Using global sharding
[2023-06-27 10:47:22] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:47:22] [training] Using 1 GPUs
[2023-06-27 10:47:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:47:22] Loading Adam parameters
[2023-06-27 10:47:23] [memory] Reserving 322 MB, device gpu0
[2023-06-27 10:47:23] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:47:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:47:23] [data] Restoring the corpus state to epoch 171, batch 17548
[2023-06-27 10:47:23] [data] Shuffling data
[2023-06-27 10:47:23] [data] Done reading 20,192 sentences
[2023-06-27 10:47:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:47:23] Training started
[2023-06-27 10:47:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-27 10:47:23] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:47:23] Parameter type float32, optimization type float32, casting types false
[2023-06-27 10:48:00] Seen 16,611 samples
[2023-06-27 10:48:00] Starting data epoch 172 in logical epoch 172
[2023-06-27 10:48:00] [data] Shuffling data
[2023-06-27 10:48:00] [data] Done reading 20,192 sentences
[2023-06-27 10:48:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:48:40] Seen 16,611 samples
[2023-06-27 10:48:40] Starting data epoch 173 in logical epoch 173
[2023-06-27 10:48:40] [data] Shuffling data
[2023-06-27 10:48:40] [data] Done reading 20,192 sentences
[2023-06-27 10:48:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:49:21] Seen 16,611 samples
[2023-06-27 10:49:21] Starting data epoch 174 in logical epoch 174
[2023-06-27 10:49:21] [data] Shuffling data
[2023-06-27 10:49:21] [data] Done reading 20,192 sentences
[2023-06-27 10:49:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:50:01] Seen 16,611 samples
[2023-06-27 10:50:01] Starting data epoch 175 in logical epoch 175
[2023-06-27 10:50:01] [data] Shuffling data
[2023-06-27 10:50:01] [data] Done reading 20,192 sentences
[2023-06-27 10:50:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:50:16] Ep. 175 : Up. 18000 : Sen. 6,352 : Cost 0.44229415 * 3,764,911 @ 3,300 after 67,884,245 : Time 174.56s : 21567.83 words/s : gNorm 0.8192
[2023-06-27 10:50:42] Seen 16,611 samples
[2023-06-27 10:50:42] Starting data epoch 176 in logical epoch 176
[2023-06-27 10:50:42] [data] Shuffling data
[2023-06-27 10:50:42] [data] Done reading 20,192 sentences
[2023-06-27 10:50:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:51:22] Seen 16,611 samples
[2023-06-27 10:51:22] Starting data epoch 177 in logical epoch 177
[2023-06-27 10:51:22] [data] Shuffling data
[2023-06-27 10:51:22] [data] Done reading 20,192 sentences
[2023-06-27 10:51:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:52:03] Seen 16,611 samples
[2023-06-27 10:52:03] Starting data epoch 178 in logical epoch 178
[2023-06-27 10:52:03] [data] Shuffling data
[2023-06-27 10:52:03] [data] Done reading 20,192 sentences
[2023-06-27 10:52:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:52:43] Seen 16,611 samples
[2023-06-27 10:52:43] Starting data epoch 179 in logical epoch 179
[2023-06-27 10:52:43] [data] Shuffling data
[2023-06-27 10:52:43] [data] Done reading 20,192 sentences
[2023-06-27 10:52:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:53:24] Seen 16,611 samples
[2023-06-27 10:53:24] Starting data epoch 180 in logical epoch 180
[2023-06-27 10:53:24] [data] Shuffling data
[2023-06-27 10:53:24] [data] Done reading 20,192 sentences
[2023-06-27 10:53:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:54:05] Seen 16,611 samples
[2023-06-27 10:54:05] Starting data epoch 181 in logical epoch 181
[2023-06-27 10:54:05] Training finished
[2023-06-27 10:54:13] [valid] Ep. 181 : Up. 18581 : cross-entropy : 130.192 : stalled 10 times (last best: 118.897)
[2023-06-27 10:54:49] [valid] Ep. 181 : Up. 18581 : translation : 0 : new best
[2023-06-27 10:54:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:54:50] Saving Adam parameters
[2023-06-27 10:54:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:58:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:58:08] [marian] Running on node20.datos.cluster.uy as process 1549 with command line:
[2023-06-27 10:58:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 190 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 10:58:08] [config] after: 0e
[2023-06-27 10:58:08] [config] after-batches: 0
[2023-06-27 10:58:08] [config] after-epochs: 190
[2023-06-27 10:58:08] [config] all-caps-every: 0
[2023-06-27 10:58:08] [config] allow-unk: false
[2023-06-27 10:58:08] [config] authors: false
[2023-06-27 10:58:08] [config] beam-size: 6
[2023-06-27 10:58:08] [config] bert-class-symbol: "[CLS]"
[2023-06-27 10:58:08] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 10:58:08] [config] bert-masking-fraction: 0.15
[2023-06-27 10:58:08] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 10:58:08] [config] bert-train-type-embeddings: true
[2023-06-27 10:58:08] [config] bert-type-vocab-size: 2
[2023-06-27 10:58:08] [config] build-info: ""
[2023-06-27 10:58:08] [config] check-gradient-nan: false
[2023-06-27 10:58:08] [config] check-nan: false
[2023-06-27 10:58:08] [config] cite: false
[2023-06-27 10:58:08] [config] clip-norm: 1
[2023-06-27 10:58:08] [config] cost-scaling:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] cost-type: ce-sum
[2023-06-27 10:58:08] [config] cpu-threads: 0
[2023-06-27 10:58:08] [config] data-threads: 8
[2023-06-27 10:58:08] [config] data-weighting: ""
[2023-06-27 10:58:08] [config] data-weighting-type: sentence
[2023-06-27 10:58:08] [config] dec-cell: gru
[2023-06-27 10:58:08] [config] dec-cell-base-depth: 2
[2023-06-27 10:58:08] [config] dec-cell-high-depth: 1
[2023-06-27 10:58:08] [config] dec-depth: 1
[2023-06-27 10:58:08] [config] devices:
[2023-06-27 10:58:08] [config]   - 0
[2023-06-27 10:58:08] [config] dim-emb: 512
[2023-06-27 10:58:08] [config] dim-rnn: 1024
[2023-06-27 10:58:08] [config] dim-vocabs:
[2023-06-27 10:58:08] [config]   - 16384
[2023-06-27 10:58:08] [config]   - 16384
[2023-06-27 10:58:08] [config] disp-first: 0
[2023-06-27 10:58:08] [config] disp-freq: 1000u
[2023-06-27 10:58:08] [config] disp-label-counts: true
[2023-06-27 10:58:08] [config] dropout-rnn: 0.2
[2023-06-27 10:58:08] [config] dropout-src: 0.1
[2023-06-27 10:58:08] [config] dropout-trg: 0.1
[2023-06-27 10:58:08] [config] dump-config: ""
[2023-06-27 10:58:08] [config] dynamic-gradient-scaling:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] early-stopping: 10
[2023-06-27 10:58:08] [config] early-stopping-on: first
[2023-06-27 10:58:08] [config] embedding-fix-src: false
[2023-06-27 10:58:08] [config] embedding-fix-trg: false
[2023-06-27 10:58:08] [config] embedding-normalization: false
[2023-06-27 10:58:08] [config] embedding-vectors:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] enc-cell: gru
[2023-06-27 10:58:08] [config] enc-cell-depth: 1
[2023-06-27 10:58:08] [config] enc-depth: 1
[2023-06-27 10:58:08] [config] enc-type: bidirectional
[2023-06-27 10:58:08] [config] english-title-case-every: 0
[2023-06-27 10:58:08] [config] exponential-smoothing: 0
[2023-06-27 10:58:08] [config] factor-weight: 1
[2023-06-27 10:58:08] [config] factors-combine: sum
[2023-06-27 10:58:08] [config] factors-dim-emb: 0
[2023-06-27 10:58:08] [config] gradient-checkpointing: false
[2023-06-27 10:58:08] [config] gradient-norm-average-window: 100
[2023-06-27 10:58:08] [config] guided-alignment: none
[2023-06-27 10:58:08] [config] guided-alignment-cost: mse
[2023-06-27 10:58:08] [config] guided-alignment-weight: 0.1
[2023-06-27 10:58:08] [config] ignore-model-config: false
[2023-06-27 10:58:08] [config] input-types:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] interpolate-env-vars: false
[2023-06-27 10:58:08] [config] keep-best: false
[2023-06-27 10:58:08] [config] label-smoothing: 0
[2023-06-27 10:58:08] [config] layer-normalization: true
[2023-06-27 10:58:08] [config] learn-rate: 0.0001
[2023-06-27 10:58:08] [config] lemma-dependency: ""
[2023-06-27 10:58:08] [config] lemma-dim-emb: 0
[2023-06-27 10:58:08] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 10:58:08] [config] log-level: info
[2023-06-27 10:58:08] [config] log-time-zone: ""
[2023-06-27 10:58:08] [config] logical-epoch:
[2023-06-27 10:58:08] [config]   - 1e
[2023-06-27 10:58:08] [config]   - 0
[2023-06-27 10:58:08] [config] lr-decay: 0
[2023-06-27 10:58:08] [config] lr-decay-freq: 50000
[2023-06-27 10:58:08] [config] lr-decay-inv-sqrt:
[2023-06-27 10:58:08] [config]   - 0
[2023-06-27 10:58:08] [config] lr-decay-repeat-warmup: false
[2023-06-27 10:58:08] [config] lr-decay-reset-optimizer: false
[2023-06-27 10:58:08] [config] lr-decay-start:
[2023-06-27 10:58:08] [config]   - 10
[2023-06-27 10:58:08] [config]   - 1
[2023-06-27 10:58:08] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 10:58:08] [config] lr-report: false
[2023-06-27 10:58:08] [config] lr-warmup: 0
[2023-06-27 10:58:08] [config] lr-warmup-at-reload: false
[2023-06-27 10:58:08] [config] lr-warmup-cycle: false
[2023-06-27 10:58:08] [config] lr-warmup-start-rate: 0
[2023-06-27 10:58:08] [config] max-length: 50
[2023-06-27 10:58:08] [config] max-length-crop: false
[2023-06-27 10:58:08] [config] max-length-factor: 3
[2023-06-27 10:58:08] [config] maxi-batch: 100
[2023-06-27 10:58:08] [config] maxi-batch-sort: trg
[2023-06-27 10:58:08] [config] mini-batch: 64
[2023-06-27 10:58:08] [config] mini-batch-fit: true
[2023-06-27 10:58:08] [config] mini-batch-fit-step: 10
[2023-06-27 10:58:08] [config] mini-batch-round-up: true
[2023-06-27 10:58:08] [config] mini-batch-track-lr: false
[2023-06-27 10:58:08] [config] mini-batch-warmup: 0
[2023-06-27 10:58:08] [config] mini-batch-words: 0
[2023-06-27 10:58:08] [config] mini-batch-words-ref: 0
[2023-06-27 10:58:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:58:08] [config] multi-loss-type: sum
[2023-06-27 10:58:08] [config] n-best: false
[2023-06-27 10:58:08] [config] no-nccl: false
[2023-06-27 10:58:08] [config] no-reload: false
[2023-06-27 10:58:08] [config] no-restore-corpus: false
[2023-06-27 10:58:08] [config] normalize: 0.6
[2023-06-27 10:58:08] [config] normalize-gradient: false
[2023-06-27 10:58:08] [config] num-devices: 0
[2023-06-27 10:58:08] [config] optimizer: adam
[2023-06-27 10:58:08] [config] optimizer-delay: 1
[2023-06-27 10:58:08] [config] optimizer-params:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] output-omit-bias: false
[2023-06-27 10:58:08] [config] overwrite: false
[2023-06-27 10:58:08] [config] precision:
[2023-06-27 10:58:08] [config]   - float32
[2023-06-27 10:58:08] [config]   - float32
[2023-06-27 10:58:08] [config] pretrained-model: ""
[2023-06-27 10:58:08] [config] quantize-biases: false
[2023-06-27 10:58:08] [config] quantize-bits: 0
[2023-06-27 10:58:08] [config] quantize-log-based: false
[2023-06-27 10:58:08] [config] quantize-optimization-steps: 0
[2023-06-27 10:58:08] [config] quiet: false
[2023-06-27 10:58:08] [config] quiet-translation: true
[2023-06-27 10:58:08] [config] relative-paths: false
[2023-06-27 10:58:08] [config] right-left: false
[2023-06-27 10:58:08] [config] save-freq: 10000u
[2023-06-27 10:58:08] [config] seed: 1234
[2023-06-27 10:58:08] [config] sentencepiece-alphas:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] sentencepiece-max-lines: 2000000
[2023-06-27 10:58:08] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 10:58:08] [config] sharding: global
[2023-06-27 10:58:08] [config] shuffle: data
[2023-06-27 10:58:08] [config] shuffle-in-ram: false
[2023-06-27 10:58:08] [config] sigterm: save-and-exit
[2023-06-27 10:58:08] [config] skip: false
[2023-06-27 10:58:08] [config] sqlite: ""
[2023-06-27 10:58:08] [config] sqlite-drop: false
[2023-06-27 10:58:08] [config] sync-freq: 200u
[2023-06-27 10:58:08] [config] sync-sgd: false
[2023-06-27 10:58:08] [config] tempdir: /tmp
[2023-06-27 10:58:08] [config] tied-embeddings: false
[2023-06-27 10:58:08] [config] tied-embeddings-all: true
[2023-06-27 10:58:08] [config] tied-embeddings-src: false
[2023-06-27 10:58:08] [config] train-embedder-rank:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] train-sets:
[2023-06-27 10:58:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 10:58:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 10:58:08] [config] transformer-aan-activation: swish
[2023-06-27 10:58:08] [config] transformer-aan-depth: 2
[2023-06-27 10:58:08] [config] transformer-aan-nogate: false
[2023-06-27 10:58:08] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 10:58:08] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 10:58:08] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 10:58:08] [config] transformer-depth-scaling: false
[2023-06-27 10:58:08] [config] transformer-dim-aan: 2048
[2023-06-27 10:58:08] [config] transformer-dim-ffn: 2048
[2023-06-27 10:58:08] [config] transformer-dropout: 0
[2023-06-27 10:58:08] [config] transformer-dropout-attention: 0
[2023-06-27 10:58:08] [config] transformer-dropout-ffn: 0
[2023-06-27 10:58:08] [config] transformer-ffn-activation: swish
[2023-06-27 10:58:08] [config] transformer-ffn-depth: 2
[2023-06-27 10:58:08] [config] transformer-guided-alignment-layer: last
[2023-06-27 10:58:08] [config] transformer-heads: 8
[2023-06-27 10:58:08] [config] transformer-no-projection: false
[2023-06-27 10:58:08] [config] transformer-pool: false
[2023-06-27 10:58:08] [config] transformer-postprocess: dan
[2023-06-27 10:58:08] [config] transformer-postprocess-emb: d
[2023-06-27 10:58:08] [config] transformer-postprocess-top: ""
[2023-06-27 10:58:08] [config] transformer-preprocess: ""
[2023-06-27 10:58:08] [config] transformer-tied-layers:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] transformer-train-position-embeddings: false
[2023-06-27 10:58:08] [config] tsv: false
[2023-06-27 10:58:08] [config] tsv-fields: 0
[2023-06-27 10:58:08] [config] type: amun
[2023-06-27 10:58:08] [config] ulr: false
[2023-06-27 10:58:08] [config] ulr-dim-emb: 0
[2023-06-27 10:58:08] [config] ulr-dropout: 0
[2023-06-27 10:58:08] [config] ulr-keys-vectors: ""
[2023-06-27 10:58:08] [config] ulr-query-vectors: ""
[2023-06-27 10:58:08] [config] ulr-softmax-temperature: 1
[2023-06-27 10:58:08] [config] ulr-trainable-transformation: false
[2023-06-27 10:58:08] [config] unlikelihood-loss: false
[2023-06-27 10:58:08] [config] valid-freq: 5000000
[2023-06-27 10:58:08] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 10:58:08] [config] valid-max-length: 1000
[2023-06-27 10:58:08] [config] valid-metrics:
[2023-06-27 10:58:08] [config]   - cross-entropy
[2023-06-27 10:58:08] [config]   - translation
[2023-06-27 10:58:08] [config] valid-mini-batch: 32
[2023-06-27 10:58:08] [config] valid-reset-stalled: false
[2023-06-27 10:58:08] [config] valid-script-args:
[2023-06-27 10:58:08] [config]   []
[2023-06-27 10:58:08] [config] valid-script-path: ""
[2023-06-27 10:58:08] [config] valid-sets:
[2023-06-27 10:58:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 10:58:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 10:58:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 10:58:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:58:08] [config] vocabs:
[2023-06-27 10:58:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:58:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:58:08] [config] word-penalty: 0
[2023-06-27 10:58:08] [config] word-scores: false
[2023-06-27 10:58:08] [config] workspace: 3000
[2023-06-27 10:58:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 10:58:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:58:08] [training] Using single-device training
[2023-06-27 10:58:10] Synced seed 1234
[2023-06-27 10:58:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 10:58:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 10:58:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 10:58:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 10:58:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 10:58:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:58:10] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:58:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:58:11] [comm] Using global sharding
[2023-06-27 10:58:11] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:58:11] [training] Using 1 GPUs
[2023-06-27 10:58:11] [logits] Applying loss function for 1 factor(s)
[2023-06-27 10:58:11] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:58:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 10:58:11] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:58:23] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 10:58:23] [valid] No post-processing script given for validating translator
[2023-06-27 10:58:24] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 10:58:24] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 10:58:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 10:58:24] [comm] Using global sharding
[2023-06-27 10:58:24] [comm] NCCLCommunicators constructed successfully
[2023-06-27 10:58:24] [training] Using 1 GPUs
[2023-06-27 10:58:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 10:58:25] Loading Adam parameters
[2023-06-27 10:58:25] [memory] Reserving 322 MB, device gpu0
[2023-06-27 10:58:25] [memory] Reserving 161 MB, device gpu0
[2023-06-27 10:58:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 10:58:25] [data] Restoring the corpus state to epoch 181, batch 18581
[2023-06-27 10:58:25] [data] Shuffling data
[2023-06-27 10:58:25] [data] Done reading 20,192 sentences
[2023-06-27 10:58:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 10:58:25] Training started
[2023-06-27 10:58:25] Training finished
[2023-06-27 11:01:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 11:01:39] [marian] Running on node20.datos.cluster.uy as process 1835 with command line:
[2023-06-27 11:01:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz --after-epochs 200 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-27 11:01:39] [config] after: 0e
[2023-06-27 11:01:39] [config] after-batches: 0
[2023-06-27 11:01:39] [config] after-epochs: 200
[2023-06-27 11:01:39] [config] all-caps-every: 0
[2023-06-27 11:01:39] [config] allow-unk: false
[2023-06-27 11:01:39] [config] authors: false
[2023-06-27 11:01:39] [config] beam-size: 6
[2023-06-27 11:01:39] [config] bert-class-symbol: "[CLS]"
[2023-06-27 11:01:39] [config] bert-mask-symbol: "[MASK]"
[2023-06-27 11:01:39] [config] bert-masking-fraction: 0.15
[2023-06-27 11:01:39] [config] bert-sep-symbol: "[SEP]"
[2023-06-27 11:01:39] [config] bert-train-type-embeddings: true
[2023-06-27 11:01:39] [config] bert-type-vocab-size: 2
[2023-06-27 11:01:39] [config] build-info: ""
[2023-06-27 11:01:39] [config] check-gradient-nan: false
[2023-06-27 11:01:39] [config] check-nan: false
[2023-06-27 11:01:39] [config] cite: false
[2023-06-27 11:01:39] [config] clip-norm: 1
[2023-06-27 11:01:39] [config] cost-scaling:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] cost-type: ce-sum
[2023-06-27 11:01:39] [config] cpu-threads: 0
[2023-06-27 11:01:39] [config] data-threads: 8
[2023-06-27 11:01:39] [config] data-weighting: ""
[2023-06-27 11:01:39] [config] data-weighting-type: sentence
[2023-06-27 11:01:39] [config] dec-cell: gru
[2023-06-27 11:01:39] [config] dec-cell-base-depth: 2
[2023-06-27 11:01:39] [config] dec-cell-high-depth: 1
[2023-06-27 11:01:39] [config] dec-depth: 1
[2023-06-27 11:01:39] [config] devices:
[2023-06-27 11:01:39] [config]   - 0
[2023-06-27 11:01:39] [config] dim-emb: 512
[2023-06-27 11:01:39] [config] dim-rnn: 1024
[2023-06-27 11:01:39] [config] dim-vocabs:
[2023-06-27 11:01:39] [config]   - 16384
[2023-06-27 11:01:39] [config]   - 16384
[2023-06-27 11:01:39] [config] disp-first: 0
[2023-06-27 11:01:39] [config] disp-freq: 1000u
[2023-06-27 11:01:39] [config] disp-label-counts: true
[2023-06-27 11:01:39] [config] dropout-rnn: 0.2
[2023-06-27 11:01:39] [config] dropout-src: 0.1
[2023-06-27 11:01:39] [config] dropout-trg: 0.1
[2023-06-27 11:01:39] [config] dump-config: ""
[2023-06-27 11:01:39] [config] dynamic-gradient-scaling:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] early-stopping: 10
[2023-06-27 11:01:39] [config] early-stopping-on: first
[2023-06-27 11:01:39] [config] embedding-fix-src: false
[2023-06-27 11:01:39] [config] embedding-fix-trg: false
[2023-06-27 11:01:39] [config] embedding-normalization: false
[2023-06-27 11:01:39] [config] embedding-vectors:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] enc-cell: gru
[2023-06-27 11:01:39] [config] enc-cell-depth: 1
[2023-06-27 11:01:39] [config] enc-depth: 1
[2023-06-27 11:01:39] [config] enc-type: bidirectional
[2023-06-27 11:01:39] [config] english-title-case-every: 0
[2023-06-27 11:01:39] [config] exponential-smoothing: 0
[2023-06-27 11:01:39] [config] factor-weight: 1
[2023-06-27 11:01:39] [config] factors-combine: sum
[2023-06-27 11:01:39] [config] factors-dim-emb: 0
[2023-06-27 11:01:39] [config] gradient-checkpointing: false
[2023-06-27 11:01:39] [config] gradient-norm-average-window: 100
[2023-06-27 11:01:39] [config] guided-alignment: none
[2023-06-27 11:01:39] [config] guided-alignment-cost: mse
[2023-06-27 11:01:39] [config] guided-alignment-weight: 0.1
[2023-06-27 11:01:39] [config] ignore-model-config: false
[2023-06-27 11:01:39] [config] input-types:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] interpolate-env-vars: false
[2023-06-27 11:01:39] [config] keep-best: false
[2023-06-27 11:01:39] [config] label-smoothing: 0
[2023-06-27 11:01:39] [config] layer-normalization: true
[2023-06-27 11:01:39] [config] learn-rate: 0.0001
[2023-06-27 11:01:39] [config] lemma-dependency: ""
[2023-06-27 11:01:39] [config] lemma-dim-emb: 0
[2023-06-27 11:01:39] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june_sp16.log
[2023-06-27 11:01:39] [config] log-level: info
[2023-06-27 11:01:39] [config] log-time-zone: ""
[2023-06-27 11:01:39] [config] logical-epoch:
[2023-06-27 11:01:39] [config]   - 1e
[2023-06-27 11:01:39] [config]   - 0
[2023-06-27 11:01:39] [config] lr-decay: 0
[2023-06-27 11:01:39] [config] lr-decay-freq: 50000
[2023-06-27 11:01:39] [config] lr-decay-inv-sqrt:
[2023-06-27 11:01:39] [config]   - 0
[2023-06-27 11:01:39] [config] lr-decay-repeat-warmup: false
[2023-06-27 11:01:39] [config] lr-decay-reset-optimizer: false
[2023-06-27 11:01:39] [config] lr-decay-start:
[2023-06-27 11:01:39] [config]   - 10
[2023-06-27 11:01:39] [config]   - 1
[2023-06-27 11:01:39] [config] lr-decay-strategy: epoch+stalled
[2023-06-27 11:01:39] [config] lr-report: false
[2023-06-27 11:01:39] [config] lr-warmup: 0
[2023-06-27 11:01:39] [config] lr-warmup-at-reload: false
[2023-06-27 11:01:39] [config] lr-warmup-cycle: false
[2023-06-27 11:01:39] [config] lr-warmup-start-rate: 0
[2023-06-27 11:01:39] [config] max-length: 50
[2023-06-27 11:01:39] [config] max-length-crop: false
[2023-06-27 11:01:39] [config] max-length-factor: 3
[2023-06-27 11:01:39] [config] maxi-batch: 100
[2023-06-27 11:01:39] [config] maxi-batch-sort: trg
[2023-06-27 11:01:39] [config] mini-batch: 64
[2023-06-27 11:01:39] [config] mini-batch-fit: true
[2023-06-27 11:01:39] [config] mini-batch-fit-step: 10
[2023-06-27 11:01:39] [config] mini-batch-round-up: true
[2023-06-27 11:01:39] [config] mini-batch-track-lr: false
[2023-06-27 11:01:39] [config] mini-batch-warmup: 0
[2023-06-27 11:01:39] [config] mini-batch-words: 0
[2023-06-27 11:01:39] [config] mini-batch-words-ref: 0
[2023-06-27 11:01:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 11:01:39] [config] multi-loss-type: sum
[2023-06-27 11:01:39] [config] n-best: false
[2023-06-27 11:01:39] [config] no-nccl: false
[2023-06-27 11:01:39] [config] no-reload: false
[2023-06-27 11:01:39] [config] no-restore-corpus: false
[2023-06-27 11:01:39] [config] normalize: 0.6
[2023-06-27 11:01:39] [config] normalize-gradient: false
[2023-06-27 11:01:39] [config] num-devices: 0
[2023-06-27 11:01:39] [config] optimizer: adam
[2023-06-27 11:01:39] [config] optimizer-delay: 1
[2023-06-27 11:01:39] [config] optimizer-params:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] output-omit-bias: false
[2023-06-27 11:01:39] [config] overwrite: false
[2023-06-27 11:01:39] [config] precision:
[2023-06-27 11:01:39] [config]   - float32
[2023-06-27 11:01:39] [config]   - float32
[2023-06-27 11:01:39] [config] pretrained-model: ""
[2023-06-27 11:01:39] [config] quantize-biases: false
[2023-06-27 11:01:39] [config] quantize-bits: 0
[2023-06-27 11:01:39] [config] quantize-log-based: false
[2023-06-27 11:01:39] [config] quantize-optimization-steps: 0
[2023-06-27 11:01:39] [config] quiet: false
[2023-06-27 11:01:39] [config] quiet-translation: true
[2023-06-27 11:01:39] [config] relative-paths: false
[2023-06-27 11:01:39] [config] right-left: false
[2023-06-27 11:01:39] [config] save-freq: 10000u
[2023-06-27 11:01:39] [config] seed: 1234
[2023-06-27 11:01:39] [config] sentencepiece-alphas:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] sentencepiece-max-lines: 2000000
[2023-06-27 11:01:39] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-27 11:01:39] [config] sharding: global
[2023-06-27 11:01:39] [config] shuffle: data
[2023-06-27 11:01:39] [config] shuffle-in-ram: false
[2023-06-27 11:01:39] [config] sigterm: save-and-exit
[2023-06-27 11:01:39] [config] skip: false
[2023-06-27 11:01:39] [config] sqlite: ""
[2023-06-27 11:01:39] [config] sqlite-drop: false
[2023-06-27 11:01:39] [config] sync-freq: 200u
[2023-06-27 11:01:39] [config] sync-sgd: false
[2023-06-27 11:01:39] [config] tempdir: /tmp
[2023-06-27 11:01:39] [config] tied-embeddings: false
[2023-06-27 11:01:39] [config] tied-embeddings-all: true
[2023-06-27 11:01:39] [config] tied-embeddings-src: false
[2023-06-27 11:01:39] [config] train-embedder-rank:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] train-sets:
[2023-06-27 11:01:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-27 11:01:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-27 11:01:39] [config] transformer-aan-activation: swish
[2023-06-27 11:01:39] [config] transformer-aan-depth: 2
[2023-06-27 11:01:39] [config] transformer-aan-nogate: false
[2023-06-27 11:01:39] [config] transformer-decoder-autoreg: self-attention
[2023-06-27 11:01:39] [config] transformer-decoder-dim-ffn: 0
[2023-06-27 11:01:39] [config] transformer-decoder-ffn-depth: 0
[2023-06-27 11:01:39] [config] transformer-depth-scaling: false
[2023-06-27 11:01:39] [config] transformer-dim-aan: 2048
[2023-06-27 11:01:39] [config] transformer-dim-ffn: 2048
[2023-06-27 11:01:39] [config] transformer-dropout: 0
[2023-06-27 11:01:39] [config] transformer-dropout-attention: 0
[2023-06-27 11:01:39] [config] transformer-dropout-ffn: 0
[2023-06-27 11:01:39] [config] transformer-ffn-activation: swish
[2023-06-27 11:01:39] [config] transformer-ffn-depth: 2
[2023-06-27 11:01:39] [config] transformer-guided-alignment-layer: last
[2023-06-27 11:01:39] [config] transformer-heads: 8
[2023-06-27 11:01:39] [config] transformer-no-projection: false
[2023-06-27 11:01:39] [config] transformer-pool: false
[2023-06-27 11:01:39] [config] transformer-postprocess: dan
[2023-06-27 11:01:39] [config] transformer-postprocess-emb: d
[2023-06-27 11:01:39] [config] transformer-postprocess-top: ""
[2023-06-27 11:01:39] [config] transformer-preprocess: ""
[2023-06-27 11:01:39] [config] transformer-tied-layers:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] transformer-train-position-embeddings: false
[2023-06-27 11:01:39] [config] tsv: false
[2023-06-27 11:01:39] [config] tsv-fields: 0
[2023-06-27 11:01:39] [config] type: amun
[2023-06-27 11:01:39] [config] ulr: false
[2023-06-27 11:01:39] [config] ulr-dim-emb: 0
[2023-06-27 11:01:39] [config] ulr-dropout: 0
[2023-06-27 11:01:39] [config] ulr-keys-vectors: ""
[2023-06-27 11:01:39] [config] ulr-query-vectors: ""
[2023-06-27 11:01:39] [config] ulr-softmax-temperature: 1
[2023-06-27 11:01:39] [config] ulr-trainable-transformation: false
[2023-06-27 11:01:39] [config] unlikelihood-loss: false
[2023-06-27 11:01:39] [config] valid-freq: 5000000
[2023-06-27 11:01:39] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june_sp16.log
[2023-06-27 11:01:39] [config] valid-max-length: 1000
[2023-06-27 11:01:39] [config] valid-metrics:
[2023-06-27 11:01:39] [config]   - cross-entropy
[2023-06-27 11:01:39] [config]   - translation
[2023-06-27 11:01:39] [config] valid-mini-batch: 32
[2023-06-27 11:01:39] [config] valid-reset-stalled: false
[2023-06-27 11:01:39] [config] valid-script-args:
[2023-06-27 11:01:39] [config]   []
[2023-06-27 11:01:39] [config] valid-script-path: ""
[2023-06-27 11:01:39] [config] valid-sets:
[2023-06-27 11:01:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-27 11:01:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-27 11:01:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-27 11:01:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 11:01:39] [config] vocabs:
[2023-06-27 11:01:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 11:01:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 11:01:39] [config] word-penalty: 0
[2023-06-27 11:01:39] [config] word-scores: false
[2023-06-27 11:01:39] [config] workspace: 3000
[2023-06-27 11:01:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-27 11:01:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 11:01:39] [training] Using single-device training
[2023-06-27 11:01:40] Synced seed 1234
[2023-06-27 11:01:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-27 11:01:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-27 11:01:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-27 11:01:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-27 11:01:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-27 11:01:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 11:01:40] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 11:01:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 11:01:40] [comm] Using global sharding
[2023-06-27 11:01:40] [comm] NCCLCommunicators constructed successfully
[2023-06-27 11:01:40] [training] Using 1 GPUs
[2023-06-27 11:01:40] [logits] Applying loss function for 1 factor(s)
[2023-06-27 11:01:40] [memory] Reserving 161 MB, device gpu0
[2023-06-27 11:01:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-27 11:01:41] [memory] Reserving 161 MB, device gpu0
[2023-06-27 11:01:53] [batching] Done. Typical MB size is 6,418 target words
[2023-06-27 11:01:53] [valid] No post-processing script given for validating translator
[2023-06-27 11:01:53] [MPI rank 0 out of 1]: GPU[0]
[2023-06-27 11:01:53] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-27 11:01:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-27 11:01:53] [comm] Using global sharding
[2023-06-27 11:01:53] [comm] NCCLCommunicators constructed successfully
[2023-06-27 11:01:53] [training] Using 1 GPUs
[2023-06-27 11:01:53] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz
[2023-06-27 11:01:54] Loading Adam parameters
[2023-06-27 11:01:54] [memory] Reserving 322 MB, device gpu0
[2023-06-27 11:01:54] [memory] Reserving 161 MB, device gpu0
[2023-06-27 11:01:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june_sp16/gn_es_scored_june_sp16.npz.optimizer.npz
[2023-06-27 11:01:55] [data] Restoring the corpus state to epoch 181, batch 18581
[2023-06-27 11:01:55] [data] Shuffling data
[2023-06-27 11:01:55] [data] Done reading 20,192 sentences
[2023-06-27 11:01:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-27 11:01:55] Training started
[2023-06-27 11:01:55] Training finished
