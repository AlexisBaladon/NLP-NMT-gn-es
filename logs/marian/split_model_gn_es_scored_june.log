[2023-06-20 14:28:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:28:40] [marian] Running on node07.datos.cluster.uy as process 26049 with command line:
[2023-06-20 14:28:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 5 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:28:40] [config] after: 0e
[2023-06-20 14:28:40] [config] after-batches: 0
[2023-06-20 14:28:40] [config] after-epochs: 5
[2023-06-20 14:28:40] [config] all-caps-every: 0
[2023-06-20 14:28:40] [config] allow-unk: false
[2023-06-20 14:28:40] [config] authors: false
[2023-06-20 14:28:40] [config] beam-size: 12
[2023-06-20 14:28:40] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:28:40] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:28:40] [config] bert-masking-fraction: 0.15
[2023-06-20 14:28:40] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:28:40] [config] bert-train-type-embeddings: true
[2023-06-20 14:28:40] [config] bert-type-vocab-size: 2
[2023-06-20 14:28:40] [config] build-info: ""
[2023-06-20 14:28:40] [config] check-gradient-nan: false
[2023-06-20 14:28:40] [config] check-nan: false
[2023-06-20 14:28:40] [config] cite: false
[2023-06-20 14:28:40] [config] clip-norm: 1
[2023-06-20 14:28:40] [config] cost-scaling:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] cost-type: ce-sum
[2023-06-20 14:28:40] [config] cpu-threads: 0
[2023-06-20 14:28:40] [config] data-threads: 8
[2023-06-20 14:28:40] [config] data-weighting: ""
[2023-06-20 14:28:40] [config] data-weighting-type: sentence
[2023-06-20 14:28:40] [config] dec-cell: gru
[2023-06-20 14:28:40] [config] dec-cell-base-depth: 2
[2023-06-20 14:28:40] [config] dec-cell-high-depth: 1
[2023-06-20 14:28:40] [config] dec-depth: 1
[2023-06-20 14:28:40] [config] devices:
[2023-06-20 14:28:40] [config]   - 0
[2023-06-20 14:28:40] [config] dim-emb: 512
[2023-06-20 14:28:40] [config] dim-rnn: 1024
[2023-06-20 14:28:40] [config] dim-vocabs:
[2023-06-20 14:28:40] [config]   - 0
[2023-06-20 14:28:40] [config]   - 0
[2023-06-20 14:28:40] [config] disp-first: 0
[2023-06-20 14:28:40] [config] disp-freq: 1000u
[2023-06-20 14:28:40] [config] disp-label-counts: true
[2023-06-20 14:28:40] [config] dropout-rnn: 0
[2023-06-20 14:28:40] [config] dropout-src: 0
[2023-06-20 14:28:40] [config] dropout-trg: 0
[2023-06-20 14:28:40] [config] dump-config: ""
[2023-06-20 14:28:40] [config] dynamic-gradient-scaling:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] early-stopping: 10
[2023-06-20 14:28:40] [config] early-stopping-on: first
[2023-06-20 14:28:40] [config] embedding-fix-src: false
[2023-06-20 14:28:40] [config] embedding-fix-trg: false
[2023-06-20 14:28:40] [config] embedding-normalization: false
[2023-06-20 14:28:40] [config] embedding-vectors:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] enc-cell: gru
[2023-06-20 14:28:40] [config] enc-cell-depth: 1
[2023-06-20 14:28:40] [config] enc-depth: 1
[2023-06-20 14:28:40] [config] enc-type: bidirectional
[2023-06-20 14:28:40] [config] english-title-case-every: 0
[2023-06-20 14:28:40] [config] exponential-smoothing: 0
[2023-06-20 14:28:40] [config] factor-weight: 1
[2023-06-20 14:28:40] [config] factors-combine: sum
[2023-06-20 14:28:40] [config] factors-dim-emb: 0
[2023-06-20 14:28:40] [config] gradient-checkpointing: false
[2023-06-20 14:28:40] [config] gradient-norm-average-window: 100
[2023-06-20 14:28:40] [config] guided-alignment: none
[2023-06-20 14:28:40] [config] guided-alignment-cost: mse
[2023-06-20 14:28:40] [config] guided-alignment-weight: 0.1
[2023-06-20 14:28:40] [config] ignore-model-config: false
[2023-06-20 14:28:40] [config] input-types:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] interpolate-env-vars: false
[2023-06-20 14:28:40] [config] keep-best: false
[2023-06-20 14:28:40] [config] label-smoothing: 0
[2023-06-20 14:28:40] [config] layer-normalization: false
[2023-06-20 14:28:40] [config] learn-rate: 0.0001
[2023-06-20 14:28:40] [config] lemma-dependency: ""
[2023-06-20 14:28:40] [config] lemma-dim-emb: 0
[2023-06-20 14:28:40] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:28:40] [config] log-level: info
[2023-06-20 14:28:40] [config] log-time-zone: ""
[2023-06-20 14:28:40] [config] logical-epoch:
[2023-06-20 14:28:40] [config]   - 1e
[2023-06-20 14:28:40] [config]   - 0
[2023-06-20 14:28:40] [config] lr-decay: 0
[2023-06-20 14:28:40] [config] lr-decay-freq: 50000
[2023-06-20 14:28:40] [config] lr-decay-inv-sqrt:
[2023-06-20 14:28:40] [config]   - 0
[2023-06-20 14:28:40] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:28:40] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:28:40] [config] lr-decay-start:
[2023-06-20 14:28:40] [config]   - 10
[2023-06-20 14:28:40] [config]   - 1
[2023-06-20 14:28:40] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:28:40] [config] lr-report: false
[2023-06-20 14:28:40] [config] lr-warmup: 0
[2023-06-20 14:28:40] [config] lr-warmup-at-reload: false
[2023-06-20 14:28:40] [config] lr-warmup-cycle: false
[2023-06-20 14:28:40] [config] lr-warmup-start-rate: 0
[2023-06-20 14:28:40] [config] max-length: 50
[2023-06-20 14:28:40] [config] max-length-crop: false
[2023-06-20 14:28:40] [config] max-length-factor: 3
[2023-06-20 14:28:40] [config] maxi-batch: 100
[2023-06-20 14:28:40] [config] maxi-batch-sort: trg
[2023-06-20 14:28:40] [config] mini-batch: 64
[2023-06-20 14:28:40] [config] mini-batch-fit: false
[2023-06-20 14:28:40] [config] mini-batch-fit-step: 10
[2023-06-20 14:28:40] [config] mini-batch-round-up: true
[2023-06-20 14:28:40] [config] mini-batch-track-lr: false
[2023-06-20 14:28:40] [config] mini-batch-warmup: 0
[2023-06-20 14:28:40] [config] mini-batch-words: 0
[2023-06-20 14:28:40] [config] mini-batch-words-ref: 0
[2023-06-20 14:28:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:28:40] [config] multi-loss-type: sum
[2023-06-20 14:28:40] [config] n-best: false
[2023-06-20 14:28:40] [config] no-nccl: false
[2023-06-20 14:28:40] [config] no-reload: false
[2023-06-20 14:28:40] [config] no-restore-corpus: false
[2023-06-20 14:28:40] [config] normalize: 0
[2023-06-20 14:28:40] [config] normalize-gradient: false
[2023-06-20 14:28:40] [config] num-devices: 0
[2023-06-20 14:28:40] [config] optimizer: adam
[2023-06-20 14:28:40] [config] optimizer-delay: 1
[2023-06-20 14:28:40] [config] optimizer-params:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] output-omit-bias: false
[2023-06-20 14:28:40] [config] overwrite: false
[2023-06-20 14:28:40] [config] precision:
[2023-06-20 14:28:40] [config]   - float32
[2023-06-20 14:28:40] [config]   - float32
[2023-06-20 14:28:40] [config] pretrained-model: ""
[2023-06-20 14:28:40] [config] quantize-biases: false
[2023-06-20 14:28:40] [config] quantize-bits: 0
[2023-06-20 14:28:40] [config] quantize-log-based: false
[2023-06-20 14:28:40] [config] quantize-optimization-steps: 0
[2023-06-20 14:28:40] [config] quiet: false
[2023-06-20 14:28:40] [config] quiet-translation: false
[2023-06-20 14:28:40] [config] relative-paths: false
[2023-06-20 14:28:40] [config] right-left: false
[2023-06-20 14:28:40] [config] save-freq: 10000u
[2023-06-20 14:28:40] [config] seed: 1234
[2023-06-20 14:28:40] [config] sentencepiece-alphas:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:28:40] [config] sentencepiece-options: ""
[2023-06-20 14:28:40] [config] sharding: global
[2023-06-20 14:28:40] [config] shuffle: data
[2023-06-20 14:28:40] [config] shuffle-in-ram: false
[2023-06-20 14:28:40] [config] sigterm: save-and-exit
[2023-06-20 14:28:40] [config] skip: false
[2023-06-20 14:28:40] [config] sqlite: ""
[2023-06-20 14:28:40] [config] sqlite-drop: false
[2023-06-20 14:28:40] [config] sync-freq: 200u
[2023-06-20 14:28:40] [config] sync-sgd: false
[2023-06-20 14:28:40] [config] tempdir: /tmp
[2023-06-20 14:28:40] [config] tied-embeddings: false
[2023-06-20 14:28:40] [config] tied-embeddings-all: false
[2023-06-20 14:28:40] [config] tied-embeddings-src: false
[2023-06-20 14:28:40] [config] train-embedder-rank:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] train-sets:
[2023-06-20 14:28:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:28:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:28:40] [config] transformer-aan-activation: swish
[2023-06-20 14:28:40] [config] transformer-aan-depth: 2
[2023-06-20 14:28:40] [config] transformer-aan-nogate: false
[2023-06-20 14:28:40] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:28:40] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:28:40] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:28:40] [config] transformer-depth-scaling: false
[2023-06-20 14:28:40] [config] transformer-dim-aan: 2048
[2023-06-20 14:28:40] [config] transformer-dim-ffn: 2048
[2023-06-20 14:28:40] [config] transformer-dropout: 0
[2023-06-20 14:28:40] [config] transformer-dropout-attention: 0
[2023-06-20 14:28:40] [config] transformer-dropout-ffn: 0
[2023-06-20 14:28:40] [config] transformer-ffn-activation: swish
[2023-06-20 14:28:40] [config] transformer-ffn-depth: 2
[2023-06-20 14:28:40] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:28:40] [config] transformer-heads: 8
[2023-06-20 14:28:40] [config] transformer-no-projection: false
[2023-06-20 14:28:40] [config] transformer-pool: false
[2023-06-20 14:28:40] [config] transformer-postprocess: dan
[2023-06-20 14:28:40] [config] transformer-postprocess-emb: d
[2023-06-20 14:28:40] [config] transformer-postprocess-top: ""
[2023-06-20 14:28:40] [config] transformer-preprocess: ""
[2023-06-20 14:28:40] [config] transformer-tied-layers:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] transformer-train-position-embeddings: false
[2023-06-20 14:28:40] [config] tsv: false
[2023-06-20 14:28:40] [config] tsv-fields: 0
[2023-06-20 14:28:40] [config] type: amun
[2023-06-20 14:28:40] [config] ulr: false
[2023-06-20 14:28:40] [config] ulr-dim-emb: 0
[2023-06-20 14:28:40] [config] ulr-dropout: 0
[2023-06-20 14:28:40] [config] ulr-keys-vectors: ""
[2023-06-20 14:28:40] [config] ulr-query-vectors: ""
[2023-06-20 14:28:40] [config] ulr-softmax-temperature: 1
[2023-06-20 14:28:40] [config] ulr-trainable-transformation: false
[2023-06-20 14:28:40] [config] unlikelihood-loss: false
[2023-06-20 14:28:40] [config] valid-freq: 5000000
[2023-06-20 14:28:40] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:28:40] [config] valid-max-length: 1000
[2023-06-20 14:28:40] [config] valid-metrics:
[2023-06-20 14:28:40] [config]   - cross-entropy
[2023-06-20 14:28:40] [config] valid-mini-batch: 32
[2023-06-20 14:28:40] [config] valid-reset-stalled: false
[2023-06-20 14:28:40] [config] valid-script-args:
[2023-06-20 14:28:40] [config]   []
[2023-06-20 14:28:40] [config] valid-script-path: ""
[2023-06-20 14:28:40] [config] valid-sets:
[2023-06-20 14:28:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:28:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:28:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:28:40] [config] vocabs:
[2023-06-20 14:28:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:28:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:28:40] [config] word-penalty: 0
[2023-06-20 14:28:40] [config] word-scores: false
[2023-06-20 14:28:40] [config] workspace: 2048
[2023-06-20 14:28:40] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:28:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:28:40] [training] Using single-device training
[2023-06-20 14:28:41] Synced seed 1234
[2023-06-20 14:28:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:28:41] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:28:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:28:41] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:28:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:28:42] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 14:28:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 14:28:43] [comm] Using global sharding
[2023-06-20 14:28:43] [comm] NCCLCommunicators constructed successfully
[2023-06-20 14:28:43] [training] Using 1 GPUs
[2023-06-20 14:28:43] Training started
[2023-06-20 14:28:43] [data] Shuffling data
[2023-06-20 14:28:43] [data] Done reading 20,192 sentences
[2023-06-20 14:28:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:28:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 14:28:43] [logits] Applying loss function for 1 factor(s)
[2023-06-20 14:28:43] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:28:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 14:28:46] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:28:46] Parameter type float32, optimization type float32, casting types false
[2023-06-20 14:28:46] Allocating memory for Adam-specific shards
[2023-06-20 14:28:46] [memory] Reserving 754 MB, device gpu0
[2023-06-20 14:29:26] Seen 18,843 samples
[2023-06-20 14:29:26] Starting data epoch 2 in logical epoch 2
[2023-06-20 14:29:26] [data] Shuffling data
[2023-06-20 14:29:26] [data] Done reading 20,192 sentences
[2023-06-20 14:29:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:30:05] Seen 18,843 samples
[2023-06-20 14:30:05] Starting data epoch 3 in logical epoch 3
[2023-06-20 14:30:05] [data] Shuffling data
[2023-06-20 14:30:05] [data] Done reading 20,192 sentences
[2023-06-20 14:30:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:30:44] Seen 18,843 samples
[2023-06-20 14:30:44] Starting data epoch 4 in logical epoch 4
[2023-06-20 14:30:44] [data] Shuffling data
[2023-06-20 14:30:44] [data] Done reading 20,192 sentences
[2023-06-20 14:30:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:30:59] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 6.20286703 * 1,343,216 @ 768 after 1,343,216 : Time 137.77s : 9749.71 words/s : gNorm 1.1963
[2023-06-20 14:31:24] Seen 18,843 samples
[2023-06-20 14:31:24] Starting data epoch 5 in logical epoch 5
[2023-06-20 14:31:24] [data] Shuffling data
[2023-06-20 14:31:24] [data] Done reading 20,192 sentences
[2023-06-20 14:31:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:32:07] Seen 18,843 samples
[2023-06-20 14:32:07] Starting data epoch 6 in logical epoch 6
[2023-06-20 14:32:07] Training finished
[2023-06-20 14:32:14] [valid] Ep. 6 : Up. 1485 : cross-entropy : 112.787 : new best
[2023-06-20 14:32:14] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:32:17] Saving Adam parameters
[2023-06-20 14:32:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 14:38:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:38:45] [marian] Running on node07.datos.cluster.uy as process 27020 with command line:
[2023-06-20 14:38:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 5 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:38:45] [config] after: 0e
[2023-06-20 14:38:45] [config] after-batches: 0
[2023-06-20 14:38:45] [config] after-epochs: 5
[2023-06-20 14:38:45] [config] all-caps-every: 0
[2023-06-20 14:38:45] [config] allow-unk: false
[2023-06-20 14:38:45] [config] authors: false
[2023-06-20 14:38:45] [config] beam-size: 12
[2023-06-20 14:38:45] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:38:45] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:38:45] [config] bert-masking-fraction: 0.15
[2023-06-20 14:38:45] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:38:45] [config] bert-train-type-embeddings: true
[2023-06-20 14:38:45] [config] bert-type-vocab-size: 2
[2023-06-20 14:38:45] [config] build-info: ""
[2023-06-20 14:38:45] [config] check-gradient-nan: false
[2023-06-20 14:38:45] [config] check-nan: false
[2023-06-20 14:38:45] [config] cite: false
[2023-06-20 14:38:45] [config] clip-norm: 1
[2023-06-20 14:38:45] [config] cost-scaling:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] cost-type: ce-sum
[2023-06-20 14:38:45] [config] cpu-threads: 0
[2023-06-20 14:38:45] [config] data-threads: 8
[2023-06-20 14:38:45] [config] data-weighting: ""
[2023-06-20 14:38:45] [config] data-weighting-type: sentence
[2023-06-20 14:38:45] [config] dec-cell: gru
[2023-06-20 14:38:45] [config] dec-cell-base-depth: 2
[2023-06-20 14:38:45] [config] dec-cell-high-depth: 1
[2023-06-20 14:38:45] [config] dec-depth: 1
[2023-06-20 14:38:45] [config] devices:
[2023-06-20 14:38:45] [config]   - 0
[2023-06-20 14:38:45] [config] dim-emb: 512
[2023-06-20 14:38:45] [config] dim-rnn: 1024
[2023-06-20 14:38:45] [config] dim-vocabs:
[2023-06-20 14:38:45] [config]   - 54042
[2023-06-20 14:38:45] [config]   - 36507
[2023-06-20 14:38:45] [config] disp-first: 0
[2023-06-20 14:38:45] [config] disp-freq: 1000u
[2023-06-20 14:38:45] [config] disp-label-counts: true
[2023-06-20 14:38:45] [config] dropout-rnn: 0
[2023-06-20 14:38:45] [config] dropout-src: 0
[2023-06-20 14:38:45] [config] dropout-trg: 0
[2023-06-20 14:38:45] [config] dump-config: ""
[2023-06-20 14:38:45] [config] dynamic-gradient-scaling:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] early-stopping: 10
[2023-06-20 14:38:45] [config] early-stopping-on: first
[2023-06-20 14:38:45] [config] embedding-fix-src: false
[2023-06-20 14:38:45] [config] embedding-fix-trg: false
[2023-06-20 14:38:45] [config] embedding-normalization: false
[2023-06-20 14:38:45] [config] embedding-vectors:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] enc-cell: gru
[2023-06-20 14:38:45] [config] enc-cell-depth: 1
[2023-06-20 14:38:45] [config] enc-depth: 1
[2023-06-20 14:38:45] [config] enc-type: bidirectional
[2023-06-20 14:38:45] [config] english-title-case-every: 0
[2023-06-20 14:38:45] [config] exponential-smoothing: 0
[2023-06-20 14:38:45] [config] factor-weight: 1
[2023-06-20 14:38:45] [config] factors-combine: sum
[2023-06-20 14:38:45] [config] factors-dim-emb: 0
[2023-06-20 14:38:45] [config] gradient-checkpointing: false
[2023-06-20 14:38:45] [config] gradient-norm-average-window: 100
[2023-06-20 14:38:45] [config] guided-alignment: none
[2023-06-20 14:38:45] [config] guided-alignment-cost: mse
[2023-06-20 14:38:45] [config] guided-alignment-weight: 0.1
[2023-06-20 14:38:45] [config] ignore-model-config: false
[2023-06-20 14:38:45] [config] input-types:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] interpolate-env-vars: false
[2023-06-20 14:38:45] [config] keep-best: false
[2023-06-20 14:38:45] [config] label-smoothing: 0
[2023-06-20 14:38:45] [config] layer-normalization: false
[2023-06-20 14:38:45] [config] learn-rate: 0.0001
[2023-06-20 14:38:45] [config] lemma-dependency: ""
[2023-06-20 14:38:45] [config] lemma-dim-emb: 0
[2023-06-20 14:38:45] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:38:45] [config] log-level: info
[2023-06-20 14:38:45] [config] log-time-zone: ""
[2023-06-20 14:38:45] [config] logical-epoch:
[2023-06-20 14:38:45] [config]   - 1e
[2023-06-20 14:38:45] [config]   - 0
[2023-06-20 14:38:45] [config] lr-decay: 0
[2023-06-20 14:38:45] [config] lr-decay-freq: 50000
[2023-06-20 14:38:45] [config] lr-decay-inv-sqrt:
[2023-06-20 14:38:45] [config]   - 0
[2023-06-20 14:38:45] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:38:45] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:38:45] [config] lr-decay-start:
[2023-06-20 14:38:45] [config]   - 10
[2023-06-20 14:38:45] [config]   - 1
[2023-06-20 14:38:45] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:38:45] [config] lr-report: false
[2023-06-20 14:38:45] [config] lr-warmup: 0
[2023-06-20 14:38:45] [config] lr-warmup-at-reload: false
[2023-06-20 14:38:45] [config] lr-warmup-cycle: false
[2023-06-20 14:38:45] [config] lr-warmup-start-rate: 0
[2023-06-20 14:38:45] [config] max-length: 50
[2023-06-20 14:38:45] [config] max-length-crop: false
[2023-06-20 14:38:45] [config] max-length-factor: 3
[2023-06-20 14:38:45] [config] maxi-batch: 100
[2023-06-20 14:38:45] [config] maxi-batch-sort: trg
[2023-06-20 14:38:45] [config] mini-batch: 64
[2023-06-20 14:38:45] [config] mini-batch-fit: false
[2023-06-20 14:38:45] [config] mini-batch-fit-step: 10
[2023-06-20 14:38:45] [config] mini-batch-round-up: true
[2023-06-20 14:38:45] [config] mini-batch-track-lr: false
[2023-06-20 14:38:45] [config] mini-batch-warmup: 0
[2023-06-20 14:38:45] [config] mini-batch-words: 0
[2023-06-20 14:38:45] [config] mini-batch-words-ref: 0
[2023-06-20 14:38:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:38:45] [config] multi-loss-type: sum
[2023-06-20 14:38:45] [config] n-best: false
[2023-06-20 14:38:45] [config] no-nccl: false
[2023-06-20 14:38:45] [config] no-reload: false
[2023-06-20 14:38:45] [config] no-restore-corpus: false
[2023-06-20 14:38:45] [config] normalize: 0
[2023-06-20 14:38:45] [config] normalize-gradient: false
[2023-06-20 14:38:45] [config] num-devices: 0
[2023-06-20 14:38:45] [config] optimizer: adam
[2023-06-20 14:38:45] [config] optimizer-delay: 1
[2023-06-20 14:38:45] [config] optimizer-params:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] output-omit-bias: false
[2023-06-20 14:38:45] [config] overwrite: false
[2023-06-20 14:38:45] [config] precision:
[2023-06-20 14:38:45] [config]   - float32
[2023-06-20 14:38:45] [config]   - float32
[2023-06-20 14:38:45] [config] pretrained-model: ""
[2023-06-20 14:38:45] [config] quantize-biases: false
[2023-06-20 14:38:45] [config] quantize-bits: 0
[2023-06-20 14:38:45] [config] quantize-log-based: false
[2023-06-20 14:38:45] [config] quantize-optimization-steps: 0
[2023-06-20 14:38:45] [config] quiet: false
[2023-06-20 14:38:45] [config] quiet-translation: false
[2023-06-20 14:38:45] [config] relative-paths: false
[2023-06-20 14:38:45] [config] right-left: false
[2023-06-20 14:38:45] [config] save-freq: 10000u
[2023-06-20 14:38:45] [config] seed: 1234
[2023-06-20 14:38:45] [config] sentencepiece-alphas:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:38:45] [config] sentencepiece-options: ""
[2023-06-20 14:38:45] [config] sharding: global
[2023-06-20 14:38:45] [config] shuffle: data
[2023-06-20 14:38:45] [config] shuffle-in-ram: false
[2023-06-20 14:38:45] [config] sigterm: save-and-exit
[2023-06-20 14:38:45] [config] skip: false
[2023-06-20 14:38:45] [config] sqlite: ""
[2023-06-20 14:38:45] [config] sqlite-drop: false
[2023-06-20 14:38:45] [config] sync-freq: 200u
[2023-06-20 14:38:45] [config] sync-sgd: false
[2023-06-20 14:38:45] [config] tempdir: /tmp
[2023-06-20 14:38:45] [config] tied-embeddings: false
[2023-06-20 14:38:45] [config] tied-embeddings-all: false
[2023-06-20 14:38:45] [config] tied-embeddings-src: false
[2023-06-20 14:38:45] [config] train-embedder-rank:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] train-sets:
[2023-06-20 14:38:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:38:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:38:45] [config] transformer-aan-activation: swish
[2023-06-20 14:38:45] [config] transformer-aan-depth: 2
[2023-06-20 14:38:45] [config] transformer-aan-nogate: false
[2023-06-20 14:38:45] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:38:45] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:38:45] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:38:45] [config] transformer-depth-scaling: false
[2023-06-20 14:38:45] [config] transformer-dim-aan: 2048
[2023-06-20 14:38:45] [config] transformer-dim-ffn: 2048
[2023-06-20 14:38:45] [config] transformer-dropout: 0
[2023-06-20 14:38:45] [config] transformer-dropout-attention: 0
[2023-06-20 14:38:45] [config] transformer-dropout-ffn: 0
[2023-06-20 14:38:45] [config] transformer-ffn-activation: swish
[2023-06-20 14:38:45] [config] transformer-ffn-depth: 2
[2023-06-20 14:38:45] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:38:45] [config] transformer-heads: 8
[2023-06-20 14:38:45] [config] transformer-no-projection: false
[2023-06-20 14:38:45] [config] transformer-pool: false
[2023-06-20 14:38:45] [config] transformer-postprocess: dan
[2023-06-20 14:38:45] [config] transformer-postprocess-emb: d
[2023-06-20 14:38:45] [config] transformer-postprocess-top: ""
[2023-06-20 14:38:45] [config] transformer-preprocess: ""
[2023-06-20 14:38:45] [config] transformer-tied-layers:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] transformer-train-position-embeddings: false
[2023-06-20 14:38:45] [config] tsv: false
[2023-06-20 14:38:45] [config] tsv-fields: 0
[2023-06-20 14:38:45] [config] type: amun
[2023-06-20 14:38:45] [config] ulr: false
[2023-06-20 14:38:45] [config] ulr-dim-emb: 0
[2023-06-20 14:38:45] [config] ulr-dropout: 0
[2023-06-20 14:38:45] [config] ulr-keys-vectors: ""
[2023-06-20 14:38:45] [config] ulr-query-vectors: ""
[2023-06-20 14:38:45] [config] ulr-softmax-temperature: 1
[2023-06-20 14:38:45] [config] ulr-trainable-transformation: false
[2023-06-20 14:38:45] [config] unlikelihood-loss: false
[2023-06-20 14:38:45] [config] valid-freq: 5000000
[2023-06-20 14:38:45] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:38:45] [config] valid-max-length: 1000
[2023-06-20 14:38:45] [config] valid-metrics:
[2023-06-20 14:38:45] [config]   - cross-entropy
[2023-06-20 14:38:45] [config] valid-mini-batch: 32
[2023-06-20 14:38:45] [config] valid-reset-stalled: false
[2023-06-20 14:38:45] [config] valid-script-args:
[2023-06-20 14:38:45] [config]   []
[2023-06-20 14:38:45] [config] valid-script-path: ""
[2023-06-20 14:38:45] [config] valid-sets:
[2023-06-20 14:38:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:38:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:38:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:38:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:38:45] [config] vocabs:
[2023-06-20 14:38:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:38:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:38:45] [config] word-penalty: 0
[2023-06-20 14:38:45] [config] word-scores: false
[2023-06-20 14:38:45] [config] workspace: 2048
[2023-06-20 14:38:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:38:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:38:45] [training] Using single-device training
[2023-06-20 14:38:45] Synced seed 1234
[2023-06-20 14:38:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:38:45] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:38:45] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:38:45] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:38:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:38:46] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 14:38:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 14:38:47] [comm] Using global sharding
[2023-06-20 14:38:47] [comm] NCCLCommunicators constructed successfully
[2023-06-20 14:38:47] [training] Using 1 GPUs
[2023-06-20 14:38:47] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:38:49] Loading Adam parameters
[2023-06-20 14:38:49] [memory] Reserving 754 MB, device gpu0
[2023-06-20 14:38:50] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:38:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 14:38:50] [data] Restoring the corpus state to epoch 6, batch 1485
[2023-06-20 14:38:50] [data] Shuffling data
[2023-06-20 14:38:50] [data] Done reading 20,192 sentences
[2023-06-20 14:38:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:38:50] Training started
[2023-06-20 14:38:50] Training finished
[2023-06-20 14:40:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:40:41] [marian] Running on node07.datos.cluster.uy as process 27341 with command line:
[2023-06-20 14:40:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 5 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:40:41] [config] after: 0e
[2023-06-20 14:40:41] [config] after-batches: 0
[2023-06-20 14:40:41] [config] after-epochs: 5
[2023-06-20 14:40:41] [config] all-caps-every: 0
[2023-06-20 14:40:41] [config] allow-unk: false
[2023-06-20 14:40:41] [config] authors: false
[2023-06-20 14:40:41] [config] beam-size: 12
[2023-06-20 14:40:41] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:40:41] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:40:41] [config] bert-masking-fraction: 0.15
[2023-06-20 14:40:41] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:40:41] [config] bert-train-type-embeddings: true
[2023-06-20 14:40:41] [config] bert-type-vocab-size: 2
[2023-06-20 14:40:41] [config] build-info: ""
[2023-06-20 14:40:41] [config] check-gradient-nan: false
[2023-06-20 14:40:41] [config] check-nan: false
[2023-06-20 14:40:41] [config] cite: false
[2023-06-20 14:40:41] [config] clip-norm: 1
[2023-06-20 14:40:41] [config] cost-scaling:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] cost-type: ce-sum
[2023-06-20 14:40:41] [config] cpu-threads: 0
[2023-06-20 14:40:41] [config] data-threads: 8
[2023-06-20 14:40:41] [config] data-weighting: ""
[2023-06-20 14:40:41] [config] data-weighting-type: sentence
[2023-06-20 14:40:41] [config] dec-cell: gru
[2023-06-20 14:40:41] [config] dec-cell-base-depth: 2
[2023-06-20 14:40:41] [config] dec-cell-high-depth: 1
[2023-06-20 14:40:41] [config] dec-depth: 1
[2023-06-20 14:40:41] [config] devices:
[2023-06-20 14:40:41] [config]   - 0
[2023-06-20 14:40:41] [config] dim-emb: 512
[2023-06-20 14:40:41] [config] dim-rnn: 1024
[2023-06-20 14:40:41] [config] dim-vocabs:
[2023-06-20 14:40:41] [config]   - 54042
[2023-06-20 14:40:41] [config]   - 36507
[2023-06-20 14:40:41] [config] disp-first: 0
[2023-06-20 14:40:41] [config] disp-freq: 1000u
[2023-06-20 14:40:41] [config] disp-label-counts: true
[2023-06-20 14:40:41] [config] dropout-rnn: 0
[2023-06-20 14:40:41] [config] dropout-src: 0
[2023-06-20 14:40:41] [config] dropout-trg: 0
[2023-06-20 14:40:41] [config] dump-config: ""
[2023-06-20 14:40:41] [config] dynamic-gradient-scaling:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] early-stopping: 10
[2023-06-20 14:40:41] [config] early-stopping-on: first
[2023-06-20 14:40:41] [config] embedding-fix-src: false
[2023-06-20 14:40:41] [config] embedding-fix-trg: false
[2023-06-20 14:40:41] [config] embedding-normalization: false
[2023-06-20 14:40:41] [config] embedding-vectors:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] enc-cell: gru
[2023-06-20 14:40:41] [config] enc-cell-depth: 1
[2023-06-20 14:40:41] [config] enc-depth: 1
[2023-06-20 14:40:41] [config] enc-type: bidirectional
[2023-06-20 14:40:41] [config] english-title-case-every: 0
[2023-06-20 14:40:41] [config] exponential-smoothing: 0
[2023-06-20 14:40:41] [config] factor-weight: 1
[2023-06-20 14:40:41] [config] factors-combine: sum
[2023-06-20 14:40:41] [config] factors-dim-emb: 0
[2023-06-20 14:40:41] [config] gradient-checkpointing: false
[2023-06-20 14:40:41] [config] gradient-norm-average-window: 100
[2023-06-20 14:40:41] [config] guided-alignment: none
[2023-06-20 14:40:41] [config] guided-alignment-cost: mse
[2023-06-20 14:40:41] [config] guided-alignment-weight: 0.1
[2023-06-20 14:40:41] [config] ignore-model-config: false
[2023-06-20 14:40:41] [config] input-types:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] interpolate-env-vars: false
[2023-06-20 14:40:41] [config] keep-best: false
[2023-06-20 14:40:41] [config] label-smoothing: 0
[2023-06-20 14:40:41] [config] layer-normalization: false
[2023-06-20 14:40:41] [config] learn-rate: 0.0001
[2023-06-20 14:40:41] [config] lemma-dependency: ""
[2023-06-20 14:40:41] [config] lemma-dim-emb: 0
[2023-06-20 14:40:41] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:40:41] [config] log-level: info
[2023-06-20 14:40:41] [config] log-time-zone: ""
[2023-06-20 14:40:41] [config] logical-epoch:
[2023-06-20 14:40:41] [config]   - 1e
[2023-06-20 14:40:41] [config]   - 0
[2023-06-20 14:40:41] [config] lr-decay: 0
[2023-06-20 14:40:41] [config] lr-decay-freq: 50000
[2023-06-20 14:40:41] [config] lr-decay-inv-sqrt:
[2023-06-20 14:40:41] [config]   - 0
[2023-06-20 14:40:41] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:40:41] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:40:41] [config] lr-decay-start:
[2023-06-20 14:40:41] [config]   - 10
[2023-06-20 14:40:41] [config]   - 1
[2023-06-20 14:40:41] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:40:41] [config] lr-report: false
[2023-06-20 14:40:41] [config] lr-warmup: 0
[2023-06-20 14:40:41] [config] lr-warmup-at-reload: false
[2023-06-20 14:40:41] [config] lr-warmup-cycle: false
[2023-06-20 14:40:41] [config] lr-warmup-start-rate: 0
[2023-06-20 14:40:41] [config] max-length: 50
[2023-06-20 14:40:41] [config] max-length-crop: false
[2023-06-20 14:40:41] [config] max-length-factor: 3
[2023-06-20 14:40:41] [config] maxi-batch: 100
[2023-06-20 14:40:41] [config] maxi-batch-sort: trg
[2023-06-20 14:40:41] [config] mini-batch: 64
[2023-06-20 14:40:41] [config] mini-batch-fit: false
[2023-06-20 14:40:41] [config] mini-batch-fit-step: 10
[2023-06-20 14:40:41] [config] mini-batch-round-up: true
[2023-06-20 14:40:41] [config] mini-batch-track-lr: false
[2023-06-20 14:40:41] [config] mini-batch-warmup: 0
[2023-06-20 14:40:41] [config] mini-batch-words: 0
[2023-06-20 14:40:41] [config] mini-batch-words-ref: 0
[2023-06-20 14:40:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:40:41] [config] multi-loss-type: sum
[2023-06-20 14:40:41] [config] n-best: false
[2023-06-20 14:40:41] [config] no-nccl: false
[2023-06-20 14:40:41] [config] no-reload: false
[2023-06-20 14:40:41] [config] no-restore-corpus: false
[2023-06-20 14:40:41] [config] normalize: 0
[2023-06-20 14:40:41] [config] normalize-gradient: false
[2023-06-20 14:40:41] [config] num-devices: 0
[2023-06-20 14:40:41] [config] optimizer: adam
[2023-06-20 14:40:41] [config] optimizer-delay: 1
[2023-06-20 14:40:41] [config] optimizer-params:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] output-omit-bias: false
[2023-06-20 14:40:41] [config] overwrite: false
[2023-06-20 14:40:41] [config] precision:
[2023-06-20 14:40:41] [config]   - float32
[2023-06-20 14:40:41] [config]   - float32
[2023-06-20 14:40:41] [config] pretrained-model: ""
[2023-06-20 14:40:41] [config] quantize-biases: false
[2023-06-20 14:40:41] [config] quantize-bits: 0
[2023-06-20 14:40:41] [config] quantize-log-based: false
[2023-06-20 14:40:41] [config] quantize-optimization-steps: 0
[2023-06-20 14:40:41] [config] quiet: false
[2023-06-20 14:40:41] [config] quiet-translation: false
[2023-06-20 14:40:41] [config] relative-paths: false
[2023-06-20 14:40:41] [config] right-left: false
[2023-06-20 14:40:41] [config] save-freq: 10000u
[2023-06-20 14:40:41] [config] seed: 1234
[2023-06-20 14:40:41] [config] sentencepiece-alphas:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:40:41] [config] sentencepiece-options: ""
[2023-06-20 14:40:41] [config] sharding: global
[2023-06-20 14:40:41] [config] shuffle: data
[2023-06-20 14:40:41] [config] shuffle-in-ram: false
[2023-06-20 14:40:41] [config] sigterm: save-and-exit
[2023-06-20 14:40:41] [config] skip: false
[2023-06-20 14:40:41] [config] sqlite: ""
[2023-06-20 14:40:41] [config] sqlite-drop: false
[2023-06-20 14:40:41] [config] sync-freq: 200u
[2023-06-20 14:40:41] [config] sync-sgd: false
[2023-06-20 14:40:41] [config] tempdir: /tmp
[2023-06-20 14:40:41] [config] tied-embeddings: false
[2023-06-20 14:40:41] [config] tied-embeddings-all: false
[2023-06-20 14:40:41] [config] tied-embeddings-src: false
[2023-06-20 14:40:41] [config] train-embedder-rank:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] train-sets:
[2023-06-20 14:40:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:40:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:40:41] [config] transformer-aan-activation: swish
[2023-06-20 14:40:41] [config] transformer-aan-depth: 2
[2023-06-20 14:40:41] [config] transformer-aan-nogate: false
[2023-06-20 14:40:41] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:40:41] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:40:41] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:40:41] [config] transformer-depth-scaling: false
[2023-06-20 14:40:41] [config] transformer-dim-aan: 2048
[2023-06-20 14:40:41] [config] transformer-dim-ffn: 2048
[2023-06-20 14:40:41] [config] transformer-dropout: 0
[2023-06-20 14:40:41] [config] transformer-dropout-attention: 0
[2023-06-20 14:40:41] [config] transformer-dropout-ffn: 0
[2023-06-20 14:40:41] [config] transformer-ffn-activation: swish
[2023-06-20 14:40:41] [config] transformer-ffn-depth: 2
[2023-06-20 14:40:41] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:40:41] [config] transformer-heads: 8
[2023-06-20 14:40:41] [config] transformer-no-projection: false
[2023-06-20 14:40:41] [config] transformer-pool: false
[2023-06-20 14:40:41] [config] transformer-postprocess: dan
[2023-06-20 14:40:41] [config] transformer-postprocess-emb: d
[2023-06-20 14:40:41] [config] transformer-postprocess-top: ""
[2023-06-20 14:40:41] [config] transformer-preprocess: ""
[2023-06-20 14:40:41] [config] transformer-tied-layers:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] transformer-train-position-embeddings: false
[2023-06-20 14:40:41] [config] tsv: false
[2023-06-20 14:40:41] [config] tsv-fields: 0
[2023-06-20 14:40:41] [config] type: amun
[2023-06-20 14:40:41] [config] ulr: false
[2023-06-20 14:40:41] [config] ulr-dim-emb: 0
[2023-06-20 14:40:41] [config] ulr-dropout: 0
[2023-06-20 14:40:41] [config] ulr-keys-vectors: ""
[2023-06-20 14:40:41] [config] ulr-query-vectors: ""
[2023-06-20 14:40:41] [config] ulr-softmax-temperature: 1
[2023-06-20 14:40:41] [config] ulr-trainable-transformation: false
[2023-06-20 14:40:41] [config] unlikelihood-loss: false
[2023-06-20 14:40:41] [config] valid-freq: 5000000
[2023-06-20 14:40:41] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:40:41] [config] valid-max-length: 1000
[2023-06-20 14:40:41] [config] valid-metrics:
[2023-06-20 14:40:41] [config]   - cross-entropy
[2023-06-20 14:40:41] [config] valid-mini-batch: 32
[2023-06-20 14:40:41] [config] valid-reset-stalled: false
[2023-06-20 14:40:41] [config] valid-script-args:
[2023-06-20 14:40:41] [config]   []
[2023-06-20 14:40:41] [config] valid-script-path: ""
[2023-06-20 14:40:41] [config] valid-sets:
[2023-06-20 14:40:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:40:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:40:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:40:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:40:41] [config] vocabs:
[2023-06-20 14:40:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:40:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:40:41] [config] word-penalty: 0
[2023-06-20 14:40:41] [config] word-scores: false
[2023-06-20 14:40:41] [config] workspace: 2048
[2023-06-20 14:40:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:40:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:40:41] [training] Using single-device training
[2023-06-20 14:40:41] Synced seed 1234
[2023-06-20 14:40:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:40:41] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:40:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:40:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:40:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:40:42] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 14:40:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 14:40:43] [comm] Using global sharding
[2023-06-20 14:40:43] [comm] NCCLCommunicators constructed successfully
[2023-06-20 14:40:43] [training] Using 1 GPUs
[2023-06-20 14:40:43] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:40:45] Loading Adam parameters
[2023-06-20 14:40:46] [memory] Reserving 754 MB, device gpu0
[2023-06-20 14:40:46] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:40:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 14:40:46] [data] Restoring the corpus state to epoch 6, batch 1485
[2023-06-20 14:40:46] [data] Shuffling data
[2023-06-20 14:40:46] [data] Done reading 20,192 sentences
[2023-06-20 14:40:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:40:46] Training started
[2023-06-20 14:40:46] Training finished
[2023-06-20 14:44:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:44:12] [marian] Running on node07.datos.cluster.uy as process 27847 with command line:
[2023-06-20 14:44:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:44:12] [config] after: 0e
[2023-06-20 14:44:12] [config] after-batches: 0
[2023-06-20 14:44:12] [config] after-epochs: 2
[2023-06-20 14:44:12] [config] all-caps-every: 0
[2023-06-20 14:44:12] [config] allow-unk: false
[2023-06-20 14:44:12] [config] authors: false
[2023-06-20 14:44:12] [config] beam-size: 12
[2023-06-20 14:44:12] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:44:12] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:44:12] [config] bert-masking-fraction: 0.15
[2023-06-20 14:44:12] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:44:12] [config] bert-train-type-embeddings: true
[2023-06-20 14:44:12] [config] bert-type-vocab-size: 2
[2023-06-20 14:44:12] [config] build-info: ""
[2023-06-20 14:44:12] [config] check-gradient-nan: false
[2023-06-20 14:44:12] [config] check-nan: false
[2023-06-20 14:44:12] [config] cite: false
[2023-06-20 14:44:12] [config] clip-norm: 1
[2023-06-20 14:44:12] [config] cost-scaling:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] cost-type: ce-sum
[2023-06-20 14:44:12] [config] cpu-threads: 0
[2023-06-20 14:44:12] [config] data-threads: 8
[2023-06-20 14:44:12] [config] data-weighting: ""
[2023-06-20 14:44:12] [config] data-weighting-type: sentence
[2023-06-20 14:44:12] [config] dec-cell: gru
[2023-06-20 14:44:12] [config] dec-cell-base-depth: 2
[2023-06-20 14:44:12] [config] dec-cell-high-depth: 1
[2023-06-20 14:44:12] [config] dec-depth: 1
[2023-06-20 14:44:12] [config] devices:
[2023-06-20 14:44:12] [config]   - 0
[2023-06-20 14:44:12] [config] dim-emb: 512
[2023-06-20 14:44:12] [config] dim-rnn: 1024
[2023-06-20 14:44:12] [config] dim-vocabs:
[2023-06-20 14:44:12] [config]   - 54042
[2023-06-20 14:44:12] [config]   - 36507
[2023-06-20 14:44:12] [config] disp-first: 0
[2023-06-20 14:44:12] [config] disp-freq: 1000u
[2023-06-20 14:44:12] [config] disp-label-counts: true
[2023-06-20 14:44:12] [config] dropout-rnn: 0
[2023-06-20 14:44:12] [config] dropout-src: 0
[2023-06-20 14:44:12] [config] dropout-trg: 0
[2023-06-20 14:44:12] [config] dump-config: ""
[2023-06-20 14:44:12] [config] dynamic-gradient-scaling:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] early-stopping: 10
[2023-06-20 14:44:12] [config] early-stopping-on: first
[2023-06-20 14:44:12] [config] embedding-fix-src: false
[2023-06-20 14:44:12] [config] embedding-fix-trg: false
[2023-06-20 14:44:12] [config] embedding-normalization: false
[2023-06-20 14:44:12] [config] embedding-vectors:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] enc-cell: gru
[2023-06-20 14:44:12] [config] enc-cell-depth: 1
[2023-06-20 14:44:12] [config] enc-depth: 1
[2023-06-20 14:44:12] [config] enc-type: bidirectional
[2023-06-20 14:44:12] [config] english-title-case-every: 0
[2023-06-20 14:44:12] [config] exponential-smoothing: 0
[2023-06-20 14:44:12] [config] factor-weight: 1
[2023-06-20 14:44:12] [config] factors-combine: sum
[2023-06-20 14:44:12] [config] factors-dim-emb: 0
[2023-06-20 14:44:12] [config] gradient-checkpointing: false
[2023-06-20 14:44:12] [config] gradient-norm-average-window: 100
[2023-06-20 14:44:12] [config] guided-alignment: none
[2023-06-20 14:44:12] [config] guided-alignment-cost: mse
[2023-06-20 14:44:12] [config] guided-alignment-weight: 0.1
[2023-06-20 14:44:12] [config] ignore-model-config: false
[2023-06-20 14:44:12] [config] input-types:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] interpolate-env-vars: false
[2023-06-20 14:44:12] [config] keep-best: false
[2023-06-20 14:44:12] [config] label-smoothing: 0
[2023-06-20 14:44:12] [config] layer-normalization: false
[2023-06-20 14:44:12] [config] learn-rate: 0.0001
[2023-06-20 14:44:12] [config] lemma-dependency: ""
[2023-06-20 14:44:12] [config] lemma-dim-emb: 0
[2023-06-20 14:44:12] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:44:12] [config] log-level: info
[2023-06-20 14:44:12] [config] log-time-zone: ""
[2023-06-20 14:44:12] [config] logical-epoch:
[2023-06-20 14:44:12] [config]   - 1e
[2023-06-20 14:44:12] [config]   - 0
[2023-06-20 14:44:12] [config] lr-decay: 0
[2023-06-20 14:44:12] [config] lr-decay-freq: 50000
[2023-06-20 14:44:12] [config] lr-decay-inv-sqrt:
[2023-06-20 14:44:12] [config]   - 0
[2023-06-20 14:44:12] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:44:12] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:44:12] [config] lr-decay-start:
[2023-06-20 14:44:12] [config]   - 10
[2023-06-20 14:44:12] [config]   - 1
[2023-06-20 14:44:12] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:44:12] [config] lr-report: false
[2023-06-20 14:44:12] [config] lr-warmup: 0
[2023-06-20 14:44:12] [config] lr-warmup-at-reload: false
[2023-06-20 14:44:12] [config] lr-warmup-cycle: false
[2023-06-20 14:44:12] [config] lr-warmup-start-rate: 0
[2023-06-20 14:44:12] [config] max-length: 50
[2023-06-20 14:44:12] [config] max-length-crop: false
[2023-06-20 14:44:12] [config] max-length-factor: 3
[2023-06-20 14:44:12] [config] maxi-batch: 100
[2023-06-20 14:44:12] [config] maxi-batch-sort: trg
[2023-06-20 14:44:12] [config] mini-batch: 64
[2023-06-20 14:44:12] [config] mini-batch-fit: false
[2023-06-20 14:44:12] [config] mini-batch-fit-step: 10
[2023-06-20 14:44:12] [config] mini-batch-round-up: true
[2023-06-20 14:44:12] [config] mini-batch-track-lr: false
[2023-06-20 14:44:12] [config] mini-batch-warmup: 0
[2023-06-20 14:44:12] [config] mini-batch-words: 0
[2023-06-20 14:44:12] [config] mini-batch-words-ref: 0
[2023-06-20 14:44:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:44:12] [config] multi-loss-type: sum
[2023-06-20 14:44:12] [config] n-best: false
[2023-06-20 14:44:12] [config] no-nccl: false
[2023-06-20 14:44:12] [config] no-reload: false
[2023-06-20 14:44:12] [config] no-restore-corpus: false
[2023-06-20 14:44:12] [config] normalize: 0
[2023-06-20 14:44:12] [config] normalize-gradient: false
[2023-06-20 14:44:12] [config] num-devices: 0
[2023-06-20 14:44:12] [config] optimizer: adam
[2023-06-20 14:44:12] [config] optimizer-delay: 1
[2023-06-20 14:44:12] [config] optimizer-params:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] output-omit-bias: false
[2023-06-20 14:44:12] [config] overwrite: false
[2023-06-20 14:44:12] [config] precision:
[2023-06-20 14:44:12] [config]   - float32
[2023-06-20 14:44:12] [config]   - float32
[2023-06-20 14:44:12] [config] pretrained-model: ""
[2023-06-20 14:44:12] [config] quantize-biases: false
[2023-06-20 14:44:12] [config] quantize-bits: 0
[2023-06-20 14:44:12] [config] quantize-log-based: false
[2023-06-20 14:44:12] [config] quantize-optimization-steps: 0
[2023-06-20 14:44:12] [config] quiet: false
[2023-06-20 14:44:12] [config] quiet-translation: false
[2023-06-20 14:44:12] [config] relative-paths: false
[2023-06-20 14:44:12] [config] right-left: false
[2023-06-20 14:44:12] [config] save-freq: 10000u
[2023-06-20 14:44:12] [config] seed: 1234
[2023-06-20 14:44:12] [config] sentencepiece-alphas:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:44:12] [config] sentencepiece-options: ""
[2023-06-20 14:44:12] [config] sharding: global
[2023-06-20 14:44:12] [config] shuffle: data
[2023-06-20 14:44:12] [config] shuffle-in-ram: false
[2023-06-20 14:44:12] [config] sigterm: save-and-exit
[2023-06-20 14:44:12] [config] skip: false
[2023-06-20 14:44:12] [config] sqlite: ""
[2023-06-20 14:44:12] [config] sqlite-drop: false
[2023-06-20 14:44:12] [config] sync-freq: 200u
[2023-06-20 14:44:12] [config] sync-sgd: false
[2023-06-20 14:44:12] [config] tempdir: /tmp
[2023-06-20 14:44:12] [config] tied-embeddings: false
[2023-06-20 14:44:12] [config] tied-embeddings-all: false
[2023-06-20 14:44:12] [config] tied-embeddings-src: false
[2023-06-20 14:44:12] [config] train-embedder-rank:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] train-sets:
[2023-06-20 14:44:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:44:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:44:12] [config] transformer-aan-activation: swish
[2023-06-20 14:44:12] [config] transformer-aan-depth: 2
[2023-06-20 14:44:12] [config] transformer-aan-nogate: false
[2023-06-20 14:44:12] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:44:12] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:44:12] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:44:12] [config] transformer-depth-scaling: false
[2023-06-20 14:44:12] [config] transformer-dim-aan: 2048
[2023-06-20 14:44:12] [config] transformer-dim-ffn: 2048
[2023-06-20 14:44:12] [config] transformer-dropout: 0
[2023-06-20 14:44:12] [config] transformer-dropout-attention: 0
[2023-06-20 14:44:12] [config] transformer-dropout-ffn: 0
[2023-06-20 14:44:12] [config] transformer-ffn-activation: swish
[2023-06-20 14:44:12] [config] transformer-ffn-depth: 2
[2023-06-20 14:44:12] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:44:12] [config] transformer-heads: 8
[2023-06-20 14:44:12] [config] transformer-no-projection: false
[2023-06-20 14:44:12] [config] transformer-pool: false
[2023-06-20 14:44:12] [config] transformer-postprocess: dan
[2023-06-20 14:44:12] [config] transformer-postprocess-emb: d
[2023-06-20 14:44:12] [config] transformer-postprocess-top: ""
[2023-06-20 14:44:12] [config] transformer-preprocess: ""
[2023-06-20 14:44:12] [config] transformer-tied-layers:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] transformer-train-position-embeddings: false
[2023-06-20 14:44:12] [config] tsv: false
[2023-06-20 14:44:12] [config] tsv-fields: 0
[2023-06-20 14:44:12] [config] type: amun
[2023-06-20 14:44:12] [config] ulr: false
[2023-06-20 14:44:12] [config] ulr-dim-emb: 0
[2023-06-20 14:44:12] [config] ulr-dropout: 0
[2023-06-20 14:44:12] [config] ulr-keys-vectors: ""
[2023-06-20 14:44:12] [config] ulr-query-vectors: ""
[2023-06-20 14:44:12] [config] ulr-softmax-temperature: 1
[2023-06-20 14:44:12] [config] ulr-trainable-transformation: false
[2023-06-20 14:44:12] [config] unlikelihood-loss: false
[2023-06-20 14:44:12] [config] valid-freq: 5000000
[2023-06-20 14:44:12] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:44:12] [config] valid-max-length: 1000
[2023-06-20 14:44:12] [config] valid-metrics:
[2023-06-20 14:44:12] [config]   - cross-entropy
[2023-06-20 14:44:12] [config] valid-mini-batch: 32
[2023-06-20 14:44:12] [config] valid-reset-stalled: false
[2023-06-20 14:44:12] [config] valid-script-args:
[2023-06-20 14:44:12] [config]   []
[2023-06-20 14:44:12] [config] valid-script-path: ""
[2023-06-20 14:44:12] [config] valid-sets:
[2023-06-20 14:44:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:44:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:44:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:44:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:44:12] [config] vocabs:
[2023-06-20 14:44:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:44:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:44:12] [config] word-penalty: 0
[2023-06-20 14:44:12] [config] word-scores: false
[2023-06-20 14:44:12] [config] workspace: 2048
[2023-06-20 14:44:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:44:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:44:12] [training] Using single-device training
[2023-06-20 14:44:13] Synced seed 1234
[2023-06-20 14:44:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:44:13] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:44:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:44:13] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:44:13] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:44:14] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 14:44:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 14:44:14] [comm] Using global sharding
[2023-06-20 14:44:14] [comm] NCCLCommunicators constructed successfully
[2023-06-20 14:44:14] [training] Using 1 GPUs
[2023-06-20 14:44:14] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:44:17] Loading Adam parameters
[2023-06-20 14:44:17] [memory] Reserving 754 MB, device gpu0
[2023-06-20 14:44:17] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:44:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 14:44:17] [data] Restoring the corpus state to epoch 6, batch 1485
[2023-06-20 14:44:17] [data] Shuffling data
[2023-06-20 14:44:17] [data] Done reading 20,192 sentences
[2023-06-20 14:44:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:44:17] Training started
[2023-06-20 14:44:17] Training finished
[2023-06-20 14:50:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:50:15] [marian] Running on node15.datos.cluster.uy as process 12982 with command line:
[2023-06-20 14:50:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:50:15] [config] after: 0e
[2023-06-20 14:50:15] [config] after-batches: 0
[2023-06-20 14:50:15] [config] after-epochs: 2
[2023-06-20 14:50:15] [config] all-caps-every: 0
[2023-06-20 14:50:15] [config] allow-unk: false
[2023-06-20 14:50:15] [config] authors: false
[2023-06-20 14:50:15] [config] beam-size: 12
[2023-06-20 14:50:15] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:50:15] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:50:15] [config] bert-masking-fraction: 0.15
[2023-06-20 14:50:15] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:50:15] [config] bert-train-type-embeddings: true
[2023-06-20 14:50:15] [config] bert-type-vocab-size: 2
[2023-06-20 14:50:15] [config] build-info: ""
[2023-06-20 14:50:15] [config] check-gradient-nan: false
[2023-06-20 14:50:15] [config] check-nan: false
[2023-06-20 14:50:15] [config] cite: false
[2023-06-20 14:50:15] [config] clip-norm: 1
[2023-06-20 14:50:15] [config] cost-scaling:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] cost-type: ce-sum
[2023-06-20 14:50:15] [config] cpu-threads: 0
[2023-06-20 14:50:15] [config] data-threads: 8
[2023-06-20 14:50:15] [config] data-weighting: ""
[2023-06-20 14:50:15] [config] data-weighting-type: sentence
[2023-06-20 14:50:15] [config] dec-cell: gru
[2023-06-20 14:50:15] [config] dec-cell-base-depth: 2
[2023-06-20 14:50:15] [config] dec-cell-high-depth: 1
[2023-06-20 14:50:15] [config] dec-depth: 1
[2023-06-20 14:50:15] [config] devices:
[2023-06-20 14:50:15] [config]   - 0
[2023-06-20 14:50:15] [config] dim-emb: 512
[2023-06-20 14:50:15] [config] dim-rnn: 1024
[2023-06-20 14:50:15] [config] dim-vocabs:
[2023-06-20 14:50:15] [config]   - 0
[2023-06-20 14:50:15] [config]   - 0
[2023-06-20 14:50:15] [config] disp-first: 0
[2023-06-20 14:50:15] [config] disp-freq: 1000u
[2023-06-20 14:50:15] [config] disp-label-counts: true
[2023-06-20 14:50:15] [config] dropout-rnn: 0
[2023-06-20 14:50:15] [config] dropout-src: 0
[2023-06-20 14:50:15] [config] dropout-trg: 0
[2023-06-20 14:50:15] [config] dump-config: ""
[2023-06-20 14:50:15] [config] dynamic-gradient-scaling:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] early-stopping: 10
[2023-06-20 14:50:15] [config] early-stopping-on: first
[2023-06-20 14:50:15] [config] embedding-fix-src: false
[2023-06-20 14:50:15] [config] embedding-fix-trg: false
[2023-06-20 14:50:15] [config] embedding-normalization: false
[2023-06-20 14:50:15] [config] embedding-vectors:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] enc-cell: gru
[2023-06-20 14:50:15] [config] enc-cell-depth: 1
[2023-06-20 14:50:15] [config] enc-depth: 1
[2023-06-20 14:50:15] [config] enc-type: bidirectional
[2023-06-20 14:50:15] [config] english-title-case-every: 0
[2023-06-20 14:50:15] [config] exponential-smoothing: 0
[2023-06-20 14:50:15] [config] factor-weight: 1
[2023-06-20 14:50:15] [config] factors-combine: sum
[2023-06-20 14:50:15] [config] factors-dim-emb: 0
[2023-06-20 14:50:15] [config] gradient-checkpointing: false
[2023-06-20 14:50:15] [config] gradient-norm-average-window: 100
[2023-06-20 14:50:15] [config] guided-alignment: none
[2023-06-20 14:50:15] [config] guided-alignment-cost: mse
[2023-06-20 14:50:15] [config] guided-alignment-weight: 0.1
[2023-06-20 14:50:15] [config] ignore-model-config: false
[2023-06-20 14:50:15] [config] input-types:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] interpolate-env-vars: false
[2023-06-20 14:50:15] [config] keep-best: false
[2023-06-20 14:50:15] [config] label-smoothing: 0
[2023-06-20 14:50:15] [config] layer-normalization: false
[2023-06-20 14:50:15] [config] learn-rate: 0.0001
[2023-06-20 14:50:15] [config] lemma-dependency: ""
[2023-06-20 14:50:15] [config] lemma-dim-emb: 0
[2023-06-20 14:50:15] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:50:15] [config] log-level: info
[2023-06-20 14:50:15] [config] log-time-zone: ""
[2023-06-20 14:50:15] [config] logical-epoch:
[2023-06-20 14:50:15] [config]   - 1e
[2023-06-20 14:50:15] [config]   - 0
[2023-06-20 14:50:15] [config] lr-decay: 0
[2023-06-20 14:50:15] [config] lr-decay-freq: 50000
[2023-06-20 14:50:15] [config] lr-decay-inv-sqrt:
[2023-06-20 14:50:15] [config]   - 0
[2023-06-20 14:50:15] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:50:15] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:50:15] [config] lr-decay-start:
[2023-06-20 14:50:15] [config]   - 10
[2023-06-20 14:50:15] [config]   - 1
[2023-06-20 14:50:15] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:50:15] [config] lr-report: false
[2023-06-20 14:50:15] [config] lr-warmup: 0
[2023-06-20 14:50:15] [config] lr-warmup-at-reload: false
[2023-06-20 14:50:15] [config] lr-warmup-cycle: false
[2023-06-20 14:50:15] [config] lr-warmup-start-rate: 0
[2023-06-20 14:50:15] [config] max-length: 50
[2023-06-20 14:50:15] [config] max-length-crop: false
[2023-06-20 14:50:15] [config] max-length-factor: 3
[2023-06-20 14:50:15] [config] maxi-batch: 100
[2023-06-20 14:50:15] [config] maxi-batch-sort: trg
[2023-06-20 14:50:15] [config] mini-batch: 64
[2023-06-20 14:50:15] [config] mini-batch-fit: false
[2023-06-20 14:50:15] [config] mini-batch-fit-step: 10
[2023-06-20 14:50:15] [config] mini-batch-round-up: true
[2023-06-20 14:50:15] [config] mini-batch-track-lr: false
[2023-06-20 14:50:15] [config] mini-batch-warmup: 0
[2023-06-20 14:50:15] [config] mini-batch-words: 0
[2023-06-20 14:50:15] [config] mini-batch-words-ref: 0
[2023-06-20 14:50:15] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:50:15] [config] multi-loss-type: sum
[2023-06-20 14:50:15] [config] n-best: false
[2023-06-20 14:50:15] [config] no-nccl: false
[2023-06-20 14:50:15] [config] no-reload: false
[2023-06-20 14:50:15] [config] no-restore-corpus: false
[2023-06-20 14:50:15] [config] normalize: 0
[2023-06-20 14:50:15] [config] normalize-gradient: false
[2023-06-20 14:50:15] [config] num-devices: 0
[2023-06-20 14:50:15] [config] optimizer: adam
[2023-06-20 14:50:15] [config] optimizer-delay: 1
[2023-06-20 14:50:15] [config] optimizer-params:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] output-omit-bias: false
[2023-06-20 14:50:15] [config] overwrite: false
[2023-06-20 14:50:15] [config] precision:
[2023-06-20 14:50:15] [config]   - float32
[2023-06-20 14:50:15] [config]   - float32
[2023-06-20 14:50:15] [config] pretrained-model: ""
[2023-06-20 14:50:15] [config] quantize-biases: false
[2023-06-20 14:50:15] [config] quantize-bits: 0
[2023-06-20 14:50:15] [config] quantize-log-based: false
[2023-06-20 14:50:15] [config] quantize-optimization-steps: 0
[2023-06-20 14:50:15] [config] quiet: false
[2023-06-20 14:50:15] [config] quiet-translation: false
[2023-06-20 14:50:15] [config] relative-paths: false
[2023-06-20 14:50:15] [config] right-left: false
[2023-06-20 14:50:15] [config] save-freq: 10000u
[2023-06-20 14:50:15] [config] seed: 1234
[2023-06-20 14:50:15] [config] sentencepiece-alphas:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:50:15] [config] sentencepiece-options: ""
[2023-06-20 14:50:15] [config] sharding: global
[2023-06-20 14:50:15] [config] shuffle: data
[2023-06-20 14:50:15] [config] shuffle-in-ram: false
[2023-06-20 14:50:15] [config] sigterm: save-and-exit
[2023-06-20 14:50:15] [config] skip: false
[2023-06-20 14:50:15] [config] sqlite: ""
[2023-06-20 14:50:15] [config] sqlite-drop: false
[2023-06-20 14:50:15] [config] sync-freq: 200u
[2023-06-20 14:50:15] [config] sync-sgd: false
[2023-06-20 14:50:15] [config] tempdir: /tmp
[2023-06-20 14:50:15] [config] tied-embeddings: false
[2023-06-20 14:50:15] [config] tied-embeddings-all: false
[2023-06-20 14:50:15] [config] tied-embeddings-src: false
[2023-06-20 14:50:15] [config] train-embedder-rank:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] train-sets:
[2023-06-20 14:50:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:50:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:50:15] [config] transformer-aan-activation: swish
[2023-06-20 14:50:15] [config] transformer-aan-depth: 2
[2023-06-20 14:50:15] [config] transformer-aan-nogate: false
[2023-06-20 14:50:15] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:50:15] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:50:15] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:50:15] [config] transformer-depth-scaling: false
[2023-06-20 14:50:15] [config] transformer-dim-aan: 2048
[2023-06-20 14:50:15] [config] transformer-dim-ffn: 2048
[2023-06-20 14:50:15] [config] transformer-dropout: 0
[2023-06-20 14:50:15] [config] transformer-dropout-attention: 0
[2023-06-20 14:50:15] [config] transformer-dropout-ffn: 0
[2023-06-20 14:50:15] [config] transformer-ffn-activation: swish
[2023-06-20 14:50:15] [config] transformer-ffn-depth: 2
[2023-06-20 14:50:15] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:50:15] [config] transformer-heads: 8
[2023-06-20 14:50:15] [config] transformer-no-projection: false
[2023-06-20 14:50:15] [config] transformer-pool: false
[2023-06-20 14:50:15] [config] transformer-postprocess: dan
[2023-06-20 14:50:15] [config] transformer-postprocess-emb: d
[2023-06-20 14:50:15] [config] transformer-postprocess-top: ""
[2023-06-20 14:50:15] [config] transformer-preprocess: ""
[2023-06-20 14:50:15] [config] transformer-tied-layers:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] transformer-train-position-embeddings: false
[2023-06-20 14:50:15] [config] tsv: false
[2023-06-20 14:50:15] [config] tsv-fields: 0
[2023-06-20 14:50:15] [config] type: amun
[2023-06-20 14:50:15] [config] ulr: false
[2023-06-20 14:50:15] [config] ulr-dim-emb: 0
[2023-06-20 14:50:15] [config] ulr-dropout: 0
[2023-06-20 14:50:15] [config] ulr-keys-vectors: ""
[2023-06-20 14:50:15] [config] ulr-query-vectors: ""
[2023-06-20 14:50:15] [config] ulr-softmax-temperature: 1
[2023-06-20 14:50:15] [config] ulr-trainable-transformation: false
[2023-06-20 14:50:15] [config] unlikelihood-loss: false
[2023-06-20 14:50:15] [config] valid-freq: 5000000
[2023-06-20 14:50:15] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:50:15] [config] valid-max-length: 1000
[2023-06-20 14:50:15] [config] valid-metrics:
[2023-06-20 14:50:15] [config]   - cross-entropy
[2023-06-20 14:50:15] [config] valid-mini-batch: 32
[2023-06-20 14:50:15] [config] valid-reset-stalled: false
[2023-06-20 14:50:15] [config] valid-script-args:
[2023-06-20 14:50:15] [config]   []
[2023-06-20 14:50:15] [config] valid-script-path: ""
[2023-06-20 14:50:15] [config] valid-sets:
[2023-06-20 14:50:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:50:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:50:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:50:15] [config] vocabs:
[2023-06-20 14:50:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:50:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:50:15] [config] word-penalty: 0
[2023-06-20 14:50:15] [config] word-scores: false
[2023-06-20 14:50:15] [config] workspace: 2048
[2023-06-20 14:50:15] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:50:15] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:50:15] [training] Using single-device training
[2023-06-20 14:50:17] Synced seed 1234
[2023-06-20 14:50:17] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:50:18] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:50:18] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:50:19] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:50:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:50:19] Error: Curand error 203 - /marian/src/tensors/rand.cpp:74: curandCreateGenerator(&generator_, CURAND_RNG_PSEUDO_DEFAULT)
[2023-06-20 14:50:19] Error: Aborted from marian::CurandRandomGenerator::CurandRandomGenerator(size_t, marian::DeviceId) in /marian/src/tensors/rand.cpp:74

[CALL STACK]
[0x556bd7f3e428]    marian::CurandRandomGenerator::  CurandRandomGenerator  (unsigned long,  marian::DeviceId) + 0x738
[0x556bd7f3ea8d]    marian::  createRandomGenerator  (unsigned long,  marian::DeviceId) + 0x5d
[0x556bd7f399c1]    marian::  BackendByDeviceId  (marian::DeviceId,  unsigned long) + 0x91
[0x556bd79cc79d]    marian::ExpressionGraph::  setDevice  (marian::DeviceId,  std::shared_ptr<marian::Device>) + 0x7d
[0x556bd7d03620]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x1f0
[0x556bd7d04a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x556bd7cddbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x556bd77e06ae]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x18de
[0x556bd77012c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556bd76b8b9c]    main                                               + 0x3c
[0x7f637fd9c0b3]    __libc_start_main                                  + 0xf3
[0x556bd76ffcbe]    _start                                             + 0x2e

[2023-06-20 14:54:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:54:09] [marian] Running on node15.datos.cluster.uy as process 13795 with command line:
[2023-06-20 14:54:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:54:09] [config] after: 0e
[2023-06-20 14:54:09] [config] after-batches: 0
[2023-06-20 14:54:09] [config] after-epochs: 2
[2023-06-20 14:54:09] [config] all-caps-every: 0
[2023-06-20 14:54:09] [config] allow-unk: false
[2023-06-20 14:54:09] [config] authors: false
[2023-06-20 14:54:09] [config] beam-size: 12
[2023-06-20 14:54:09] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:54:09] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:54:09] [config] bert-masking-fraction: 0.15
[2023-06-20 14:54:09] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:54:09] [config] bert-train-type-embeddings: true
[2023-06-20 14:54:09] [config] bert-type-vocab-size: 2
[2023-06-20 14:54:09] [config] build-info: ""
[2023-06-20 14:54:09] [config] check-gradient-nan: false
[2023-06-20 14:54:09] [config] check-nan: false
[2023-06-20 14:54:09] [config] cite: false
[2023-06-20 14:54:09] [config] clip-norm: 1
[2023-06-20 14:54:09] [config] cost-scaling:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] cost-type: ce-sum
[2023-06-20 14:54:09] [config] cpu-threads: 0
[2023-06-20 14:54:09] [config] data-threads: 8
[2023-06-20 14:54:09] [config] data-weighting: ""
[2023-06-20 14:54:09] [config] data-weighting-type: sentence
[2023-06-20 14:54:09] [config] dec-cell: gru
[2023-06-20 14:54:09] [config] dec-cell-base-depth: 2
[2023-06-20 14:54:09] [config] dec-cell-high-depth: 1
[2023-06-20 14:54:09] [config] dec-depth: 1
[2023-06-20 14:54:09] [config] devices:
[2023-06-20 14:54:09] [config]   - 0
[2023-06-20 14:54:09] [config] dim-emb: 512
[2023-06-20 14:54:09] [config] dim-rnn: 1024
[2023-06-20 14:54:09] [config] dim-vocabs:
[2023-06-20 14:54:09] [config]   - 0
[2023-06-20 14:54:09] [config]   - 0
[2023-06-20 14:54:09] [config] disp-first: 0
[2023-06-20 14:54:09] [config] disp-freq: 1000u
[2023-06-20 14:54:09] [config] disp-label-counts: true
[2023-06-20 14:54:09] [config] dropout-rnn: 0
[2023-06-20 14:54:09] [config] dropout-src: 0
[2023-06-20 14:54:09] [config] dropout-trg: 0
[2023-06-20 14:54:09] [config] dump-config: ""
[2023-06-20 14:54:09] [config] dynamic-gradient-scaling:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] early-stopping: 10
[2023-06-20 14:54:09] [config] early-stopping-on: first
[2023-06-20 14:54:09] [config] embedding-fix-src: false
[2023-06-20 14:54:09] [config] embedding-fix-trg: false
[2023-06-20 14:54:09] [config] embedding-normalization: false
[2023-06-20 14:54:09] [config] embedding-vectors:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] enc-cell: gru
[2023-06-20 14:54:09] [config] enc-cell-depth: 1
[2023-06-20 14:54:09] [config] enc-depth: 1
[2023-06-20 14:54:09] [config] enc-type: bidirectional
[2023-06-20 14:54:09] [config] english-title-case-every: 0
[2023-06-20 14:54:09] [config] exponential-smoothing: 0
[2023-06-20 14:54:09] [config] factor-weight: 1
[2023-06-20 14:54:09] [config] factors-combine: sum
[2023-06-20 14:54:09] [config] factors-dim-emb: 0
[2023-06-20 14:54:09] [config] gradient-checkpointing: false
[2023-06-20 14:54:09] [config] gradient-norm-average-window: 100
[2023-06-20 14:54:09] [config] guided-alignment: none
[2023-06-20 14:54:09] [config] guided-alignment-cost: mse
[2023-06-20 14:54:09] [config] guided-alignment-weight: 0.1
[2023-06-20 14:54:09] [config] ignore-model-config: false
[2023-06-20 14:54:09] [config] input-types:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] interpolate-env-vars: false
[2023-06-20 14:54:09] [config] keep-best: false
[2023-06-20 14:54:09] [config] label-smoothing: 0
[2023-06-20 14:54:09] [config] layer-normalization: false
[2023-06-20 14:54:09] [config] learn-rate: 0.0001
[2023-06-20 14:54:09] [config] lemma-dependency: ""
[2023-06-20 14:54:09] [config] lemma-dim-emb: 0
[2023-06-20 14:54:09] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:54:09] [config] log-level: info
[2023-06-20 14:54:09] [config] log-time-zone: ""
[2023-06-20 14:54:09] [config] logical-epoch:
[2023-06-20 14:54:09] [config]   - 1e
[2023-06-20 14:54:09] [config]   - 0
[2023-06-20 14:54:09] [config] lr-decay: 0
[2023-06-20 14:54:09] [config] lr-decay-freq: 50000
[2023-06-20 14:54:09] [config] lr-decay-inv-sqrt:
[2023-06-20 14:54:09] [config]   - 0
[2023-06-20 14:54:09] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:54:09] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:54:09] [config] lr-decay-start:
[2023-06-20 14:54:09] [config]   - 10
[2023-06-20 14:54:09] [config]   - 1
[2023-06-20 14:54:09] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:54:09] [config] lr-report: false
[2023-06-20 14:54:09] [config] lr-warmup: 0
[2023-06-20 14:54:09] [config] lr-warmup-at-reload: false
[2023-06-20 14:54:09] [config] lr-warmup-cycle: false
[2023-06-20 14:54:09] [config] lr-warmup-start-rate: 0
[2023-06-20 14:54:09] [config] max-length: 50
[2023-06-20 14:54:09] [config] max-length-crop: false
[2023-06-20 14:54:09] [config] max-length-factor: 3
[2023-06-20 14:54:09] [config] maxi-batch: 100
[2023-06-20 14:54:09] [config] maxi-batch-sort: trg
[2023-06-20 14:54:09] [config] mini-batch: 64
[2023-06-20 14:54:09] [config] mini-batch-fit: false
[2023-06-20 14:54:09] [config] mini-batch-fit-step: 10
[2023-06-20 14:54:09] [config] mini-batch-round-up: true
[2023-06-20 14:54:09] [config] mini-batch-track-lr: false
[2023-06-20 14:54:09] [config] mini-batch-warmup: 0
[2023-06-20 14:54:09] [config] mini-batch-words: 0
[2023-06-20 14:54:09] [config] mini-batch-words-ref: 0
[2023-06-20 14:54:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:54:09] [config] multi-loss-type: sum
[2023-06-20 14:54:09] [config] n-best: false
[2023-06-20 14:54:09] [config] no-nccl: false
[2023-06-20 14:54:09] [config] no-reload: false
[2023-06-20 14:54:09] [config] no-restore-corpus: false
[2023-06-20 14:54:09] [config] normalize: 0
[2023-06-20 14:54:09] [config] normalize-gradient: false
[2023-06-20 14:54:09] [config] num-devices: 0
[2023-06-20 14:54:09] [config] optimizer: adam
[2023-06-20 14:54:09] [config] optimizer-delay: 1
[2023-06-20 14:54:09] [config] optimizer-params:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] output-omit-bias: false
[2023-06-20 14:54:09] [config] overwrite: false
[2023-06-20 14:54:09] [config] precision:
[2023-06-20 14:54:09] [config]   - float32
[2023-06-20 14:54:09] [config]   - float32
[2023-06-20 14:54:09] [config] pretrained-model: ""
[2023-06-20 14:54:09] [config] quantize-biases: false
[2023-06-20 14:54:09] [config] quantize-bits: 0
[2023-06-20 14:54:09] [config] quantize-log-based: false
[2023-06-20 14:54:09] [config] quantize-optimization-steps: 0
[2023-06-20 14:54:09] [config] quiet: false
[2023-06-20 14:54:09] [config] quiet-translation: false
[2023-06-20 14:54:09] [config] relative-paths: false
[2023-06-20 14:54:09] [config] right-left: false
[2023-06-20 14:54:09] [config] save-freq: 10000u
[2023-06-20 14:54:09] [config] seed: 1234
[2023-06-20 14:54:09] [config] sentencepiece-alphas:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:54:09] [config] sentencepiece-options: ""
[2023-06-20 14:54:09] [config] sharding: global
[2023-06-20 14:54:09] [config] shuffle: data
[2023-06-20 14:54:09] [config] shuffle-in-ram: false
[2023-06-20 14:54:09] [config] sigterm: save-and-exit
[2023-06-20 14:54:09] [config] skip: false
[2023-06-20 14:54:09] [config] sqlite: ""
[2023-06-20 14:54:09] [config] sqlite-drop: false
[2023-06-20 14:54:09] [config] sync-freq: 200u
[2023-06-20 14:54:09] [config] sync-sgd: false
[2023-06-20 14:54:09] [config] tempdir: /tmp
[2023-06-20 14:54:09] [config] tied-embeddings: false
[2023-06-20 14:54:09] [config] tied-embeddings-all: false
[2023-06-20 14:54:09] [config] tied-embeddings-src: false
[2023-06-20 14:54:09] [config] train-embedder-rank:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] train-sets:
[2023-06-20 14:54:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:54:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:54:09] [config] transformer-aan-activation: swish
[2023-06-20 14:54:09] [config] transformer-aan-depth: 2
[2023-06-20 14:54:09] [config] transformer-aan-nogate: false
[2023-06-20 14:54:09] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:54:09] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:54:09] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:54:09] [config] transformer-depth-scaling: false
[2023-06-20 14:54:09] [config] transformer-dim-aan: 2048
[2023-06-20 14:54:09] [config] transformer-dim-ffn: 2048
[2023-06-20 14:54:09] [config] transformer-dropout: 0
[2023-06-20 14:54:09] [config] transformer-dropout-attention: 0
[2023-06-20 14:54:09] [config] transformer-dropout-ffn: 0
[2023-06-20 14:54:09] [config] transformer-ffn-activation: swish
[2023-06-20 14:54:09] [config] transformer-ffn-depth: 2
[2023-06-20 14:54:09] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:54:09] [config] transformer-heads: 8
[2023-06-20 14:54:09] [config] transformer-no-projection: false
[2023-06-20 14:54:09] [config] transformer-pool: false
[2023-06-20 14:54:09] [config] transformer-postprocess: dan
[2023-06-20 14:54:09] [config] transformer-postprocess-emb: d
[2023-06-20 14:54:09] [config] transformer-postprocess-top: ""
[2023-06-20 14:54:09] [config] transformer-preprocess: ""
[2023-06-20 14:54:09] [config] transformer-tied-layers:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] transformer-train-position-embeddings: false
[2023-06-20 14:54:09] [config] tsv: false
[2023-06-20 14:54:09] [config] tsv-fields: 0
[2023-06-20 14:54:09] [config] type: amun
[2023-06-20 14:54:09] [config] ulr: false
[2023-06-20 14:54:09] [config] ulr-dim-emb: 0
[2023-06-20 14:54:09] [config] ulr-dropout: 0
[2023-06-20 14:54:09] [config] ulr-keys-vectors: ""
[2023-06-20 14:54:09] [config] ulr-query-vectors: ""
[2023-06-20 14:54:09] [config] ulr-softmax-temperature: 1
[2023-06-20 14:54:09] [config] ulr-trainable-transformation: false
[2023-06-20 14:54:09] [config] unlikelihood-loss: false
[2023-06-20 14:54:09] [config] valid-freq: 5000000
[2023-06-20 14:54:09] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:54:09] [config] valid-max-length: 1000
[2023-06-20 14:54:09] [config] valid-metrics:
[2023-06-20 14:54:09] [config]   - cross-entropy
[2023-06-20 14:54:09] [config] valid-mini-batch: 32
[2023-06-20 14:54:09] [config] valid-reset-stalled: false
[2023-06-20 14:54:09] [config] valid-script-args:
[2023-06-20 14:54:09] [config]   []
[2023-06-20 14:54:09] [config] valid-script-path: ""
[2023-06-20 14:54:09] [config] valid-sets:
[2023-06-20 14:54:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:54:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:54:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:54:09] [config] vocabs:
[2023-06-20 14:54:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:54:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:54:09] [config] word-penalty: 0
[2023-06-20 14:54:09] [config] word-scores: false
[2023-06-20 14:54:09] [config] workspace: 2048
[2023-06-20 14:54:09] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:54:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:54:09] [training] Using single-device training
[2023-06-20 14:54:10] Synced seed 1234
[2023-06-20 14:54:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:54:10] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:54:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:54:10] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:54:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:54:10] Error: Curand error 203 - /marian/src/tensors/rand.cpp:74: curandCreateGenerator(&generator_, CURAND_RNG_PSEUDO_DEFAULT)
[2023-06-20 14:54:10] Error: Aborted from marian::CurandRandomGenerator::CurandRandomGenerator(size_t, marian::DeviceId) in /marian/src/tensors/rand.cpp:74

[CALL STACK]
[0x562f12522428]    marian::CurandRandomGenerator::  CurandRandomGenerator  (unsigned long,  marian::DeviceId) + 0x738
[0x562f12522a8d]    marian::  createRandomGenerator  (unsigned long,  marian::DeviceId) + 0x5d
[0x562f1251d9c1]    marian::  BackendByDeviceId  (marian::DeviceId,  unsigned long) + 0x91
[0x562f11fb079d]    marian::ExpressionGraph::  setDevice  (marian::DeviceId,  std::shared_ptr<marian::Device>) + 0x7d
[0x562f122e7620]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x1f0
[0x562f122e8a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x562f122c1bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x562f11dc46ae]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x18de
[0x562f11ce52c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x562f11c9cb9c]    main                                               + 0x3c
[0x7f1efba180b3]    __libc_start_main                                  + 0xf3
[0x562f11ce3cbe]    _start                                             + 0x2e

[2023-06-20 14:54:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:54:42] [marian] Running on node15.datos.cluster.uy as process 13961 with command line:
[2023-06-20 14:54:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:54:42] [config] after: 0e
[2023-06-20 14:54:42] [config] after-batches: 0
[2023-06-20 14:54:42] [config] after-epochs: 2
[2023-06-20 14:54:42] [config] all-caps-every: 0
[2023-06-20 14:54:42] [config] allow-unk: false
[2023-06-20 14:54:42] [config] authors: false
[2023-06-20 14:54:42] [config] beam-size: 12
[2023-06-20 14:54:42] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:54:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:54:42] [config] bert-masking-fraction: 0.15
[2023-06-20 14:54:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:54:42] [config] bert-train-type-embeddings: true
[2023-06-20 14:54:42] [config] bert-type-vocab-size: 2
[2023-06-20 14:54:42] [config] build-info: ""
[2023-06-20 14:54:42] [config] check-gradient-nan: false
[2023-06-20 14:54:42] [config] check-nan: false
[2023-06-20 14:54:42] [config] cite: false
[2023-06-20 14:54:42] [config] clip-norm: 1
[2023-06-20 14:54:42] [config] cost-scaling:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] cost-type: ce-sum
[2023-06-20 14:54:42] [config] cpu-threads: 0
[2023-06-20 14:54:42] [config] data-threads: 8
[2023-06-20 14:54:42] [config] data-weighting: ""
[2023-06-20 14:54:42] [config] data-weighting-type: sentence
[2023-06-20 14:54:42] [config] dec-cell: gru
[2023-06-20 14:54:42] [config] dec-cell-base-depth: 2
[2023-06-20 14:54:42] [config] dec-cell-high-depth: 1
[2023-06-20 14:54:42] [config] dec-depth: 1
[2023-06-20 14:54:42] [config] devices:
[2023-06-20 14:54:42] [config]   - 0
[2023-06-20 14:54:42] [config] dim-emb: 512
[2023-06-20 14:54:42] [config] dim-rnn: 1024
[2023-06-20 14:54:42] [config] dim-vocabs:
[2023-06-20 14:54:42] [config]   - 0
[2023-06-20 14:54:42] [config]   - 0
[2023-06-20 14:54:42] [config] disp-first: 0
[2023-06-20 14:54:42] [config] disp-freq: 1000u
[2023-06-20 14:54:42] [config] disp-label-counts: true
[2023-06-20 14:54:42] [config] dropout-rnn: 0
[2023-06-20 14:54:42] [config] dropout-src: 0
[2023-06-20 14:54:42] [config] dropout-trg: 0
[2023-06-20 14:54:42] [config] dump-config: ""
[2023-06-20 14:54:42] [config] dynamic-gradient-scaling:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] early-stopping: 10
[2023-06-20 14:54:42] [config] early-stopping-on: first
[2023-06-20 14:54:42] [config] embedding-fix-src: false
[2023-06-20 14:54:42] [config] embedding-fix-trg: false
[2023-06-20 14:54:42] [config] embedding-normalization: false
[2023-06-20 14:54:42] [config] embedding-vectors:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] enc-cell: gru
[2023-06-20 14:54:42] [config] enc-cell-depth: 1
[2023-06-20 14:54:42] [config] enc-depth: 1
[2023-06-20 14:54:42] [config] enc-type: bidirectional
[2023-06-20 14:54:42] [config] english-title-case-every: 0
[2023-06-20 14:54:42] [config] exponential-smoothing: 0
[2023-06-20 14:54:42] [config] factor-weight: 1
[2023-06-20 14:54:42] [config] factors-combine: sum
[2023-06-20 14:54:42] [config] factors-dim-emb: 0
[2023-06-20 14:54:42] [config] gradient-checkpointing: false
[2023-06-20 14:54:42] [config] gradient-norm-average-window: 100
[2023-06-20 14:54:42] [config] guided-alignment: none
[2023-06-20 14:54:42] [config] guided-alignment-cost: mse
[2023-06-20 14:54:42] [config] guided-alignment-weight: 0.1
[2023-06-20 14:54:42] [config] ignore-model-config: false
[2023-06-20 14:54:42] [config] input-types:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] interpolate-env-vars: false
[2023-06-20 14:54:42] [config] keep-best: false
[2023-06-20 14:54:42] [config] label-smoothing: 0
[2023-06-20 14:54:42] [config] layer-normalization: false
[2023-06-20 14:54:42] [config] learn-rate: 0.0001
[2023-06-20 14:54:42] [config] lemma-dependency: ""
[2023-06-20 14:54:42] [config] lemma-dim-emb: 0
[2023-06-20 14:54:42] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:54:42] [config] log-level: info
[2023-06-20 14:54:42] [config] log-time-zone: ""
[2023-06-20 14:54:42] [config] logical-epoch:
[2023-06-20 14:54:42] [config]   - 1e
[2023-06-20 14:54:42] [config]   - 0
[2023-06-20 14:54:42] [config] lr-decay: 0
[2023-06-20 14:54:42] [config] lr-decay-freq: 50000
[2023-06-20 14:54:42] [config] lr-decay-inv-sqrt:
[2023-06-20 14:54:42] [config]   - 0
[2023-06-20 14:54:42] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:54:42] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:54:42] [config] lr-decay-start:
[2023-06-20 14:54:42] [config]   - 10
[2023-06-20 14:54:42] [config]   - 1
[2023-06-20 14:54:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:54:42] [config] lr-report: false
[2023-06-20 14:54:42] [config] lr-warmup: 0
[2023-06-20 14:54:42] [config] lr-warmup-at-reload: false
[2023-06-20 14:54:42] [config] lr-warmup-cycle: false
[2023-06-20 14:54:42] [config] lr-warmup-start-rate: 0
[2023-06-20 14:54:42] [config] max-length: 50
[2023-06-20 14:54:42] [config] max-length-crop: false
[2023-06-20 14:54:42] [config] max-length-factor: 3
[2023-06-20 14:54:42] [config] maxi-batch: 100
[2023-06-20 14:54:42] [config] maxi-batch-sort: trg
[2023-06-20 14:54:42] [config] mini-batch: 64
[2023-06-20 14:54:42] [config] mini-batch-fit: false
[2023-06-20 14:54:42] [config] mini-batch-fit-step: 10
[2023-06-20 14:54:42] [config] mini-batch-round-up: true
[2023-06-20 14:54:42] [config] mini-batch-track-lr: false
[2023-06-20 14:54:42] [config] mini-batch-warmup: 0
[2023-06-20 14:54:42] [config] mini-batch-words: 0
[2023-06-20 14:54:42] [config] mini-batch-words-ref: 0
[2023-06-20 14:54:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:54:42] [config] multi-loss-type: sum
[2023-06-20 14:54:42] [config] n-best: false
[2023-06-20 14:54:42] [config] no-nccl: false
[2023-06-20 14:54:42] [config] no-reload: false
[2023-06-20 14:54:42] [config] no-restore-corpus: false
[2023-06-20 14:54:42] [config] normalize: 0
[2023-06-20 14:54:42] [config] normalize-gradient: false
[2023-06-20 14:54:42] [config] num-devices: 0
[2023-06-20 14:54:42] [config] optimizer: adam
[2023-06-20 14:54:42] [config] optimizer-delay: 1
[2023-06-20 14:54:42] [config] optimizer-params:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] output-omit-bias: false
[2023-06-20 14:54:42] [config] overwrite: false
[2023-06-20 14:54:42] [config] precision:
[2023-06-20 14:54:42] [config]   - float32
[2023-06-20 14:54:42] [config]   - float32
[2023-06-20 14:54:42] [config] pretrained-model: ""
[2023-06-20 14:54:42] [config] quantize-biases: false
[2023-06-20 14:54:42] [config] quantize-bits: 0
[2023-06-20 14:54:42] [config] quantize-log-based: false
[2023-06-20 14:54:42] [config] quantize-optimization-steps: 0
[2023-06-20 14:54:42] [config] quiet: false
[2023-06-20 14:54:42] [config] quiet-translation: false
[2023-06-20 14:54:42] [config] relative-paths: false
[2023-06-20 14:54:42] [config] right-left: false
[2023-06-20 14:54:42] [config] save-freq: 10000u
[2023-06-20 14:54:42] [config] seed: 1234
[2023-06-20 14:54:42] [config] sentencepiece-alphas:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:54:42] [config] sentencepiece-options: ""
[2023-06-20 14:54:42] [config] sharding: global
[2023-06-20 14:54:42] [config] shuffle: data
[2023-06-20 14:54:42] [config] shuffle-in-ram: false
[2023-06-20 14:54:42] [config] sigterm: save-and-exit
[2023-06-20 14:54:42] [config] skip: false
[2023-06-20 14:54:42] [config] sqlite: ""
[2023-06-20 14:54:42] [config] sqlite-drop: false
[2023-06-20 14:54:42] [config] sync-freq: 200u
[2023-06-20 14:54:42] [config] sync-sgd: false
[2023-06-20 14:54:42] [config] tempdir: /tmp
[2023-06-20 14:54:42] [config] tied-embeddings: false
[2023-06-20 14:54:42] [config] tied-embeddings-all: false
[2023-06-20 14:54:42] [config] tied-embeddings-src: false
[2023-06-20 14:54:42] [config] train-embedder-rank:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] train-sets:
[2023-06-20 14:54:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:54:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:54:42] [config] transformer-aan-activation: swish
[2023-06-20 14:54:42] [config] transformer-aan-depth: 2
[2023-06-20 14:54:42] [config] transformer-aan-nogate: false
[2023-06-20 14:54:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:54:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:54:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:54:42] [config] transformer-depth-scaling: false
[2023-06-20 14:54:42] [config] transformer-dim-aan: 2048
[2023-06-20 14:54:42] [config] transformer-dim-ffn: 2048
[2023-06-20 14:54:42] [config] transformer-dropout: 0
[2023-06-20 14:54:42] [config] transformer-dropout-attention: 0
[2023-06-20 14:54:42] [config] transformer-dropout-ffn: 0
[2023-06-20 14:54:42] [config] transformer-ffn-activation: swish
[2023-06-20 14:54:42] [config] transformer-ffn-depth: 2
[2023-06-20 14:54:42] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:54:42] [config] transformer-heads: 8
[2023-06-20 14:54:42] [config] transformer-no-projection: false
[2023-06-20 14:54:42] [config] transformer-pool: false
[2023-06-20 14:54:42] [config] transformer-postprocess: dan
[2023-06-20 14:54:42] [config] transformer-postprocess-emb: d
[2023-06-20 14:54:42] [config] transformer-postprocess-top: ""
[2023-06-20 14:54:42] [config] transformer-preprocess: ""
[2023-06-20 14:54:42] [config] transformer-tied-layers:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] transformer-train-position-embeddings: false
[2023-06-20 14:54:42] [config] tsv: false
[2023-06-20 14:54:42] [config] tsv-fields: 0
[2023-06-20 14:54:42] [config] type: amun
[2023-06-20 14:54:42] [config] ulr: false
[2023-06-20 14:54:42] [config] ulr-dim-emb: 0
[2023-06-20 14:54:42] [config] ulr-dropout: 0
[2023-06-20 14:54:42] [config] ulr-keys-vectors: ""
[2023-06-20 14:54:42] [config] ulr-query-vectors: ""
[2023-06-20 14:54:42] [config] ulr-softmax-temperature: 1
[2023-06-20 14:54:42] [config] ulr-trainable-transformation: false
[2023-06-20 14:54:42] [config] unlikelihood-loss: false
[2023-06-20 14:54:42] [config] valid-freq: 5000000
[2023-06-20 14:54:42] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:54:42] [config] valid-max-length: 1000
[2023-06-20 14:54:42] [config] valid-metrics:
[2023-06-20 14:54:42] [config]   - cross-entropy
[2023-06-20 14:54:42] [config] valid-mini-batch: 32
[2023-06-20 14:54:42] [config] valid-reset-stalled: false
[2023-06-20 14:54:42] [config] valid-script-args:
[2023-06-20 14:54:42] [config]   []
[2023-06-20 14:54:42] [config] valid-script-path: ""
[2023-06-20 14:54:42] [config] valid-sets:
[2023-06-20 14:54:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:54:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:54:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:54:42] [config] vocabs:
[2023-06-20 14:54:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:54:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:54:42] [config] word-penalty: 0
[2023-06-20 14:54:42] [config] word-scores: false
[2023-06-20 14:54:42] [config] workspace: 2048
[2023-06-20 14:54:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:54:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:54:42] [training] Using single-device training
[2023-06-20 14:54:42] Synced seed 1234
[2023-06-20 14:54:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:54:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:54:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:54:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:54:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:54:42] Error: Curand error 203 - /marian/src/tensors/rand.cpp:74: curandCreateGenerator(&generator_, CURAND_RNG_PSEUDO_DEFAULT)
[2023-06-20 14:54:42] Error: Aborted from marian::CurandRandomGenerator::CurandRandomGenerator(size_t, marian::DeviceId) in /marian/src/tensors/rand.cpp:74

[CALL STACK]
[0x5595a9b5a428]    marian::CurandRandomGenerator::  CurandRandomGenerator  (unsigned long,  marian::DeviceId) + 0x738
[0x5595a9b5aa8d]    marian::  createRandomGenerator  (unsigned long,  marian::DeviceId) + 0x5d
[0x5595a9b559c1]    marian::  BackendByDeviceId  (marian::DeviceId,  unsigned long) + 0x91
[0x5595a95e879d]    marian::ExpressionGraph::  setDevice  (marian::DeviceId,  std::shared_ptr<marian::Device>) + 0x7d
[0x5595a991f620]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x1f0
[0x5595a9920a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5595a98f9bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5595a93fc6ae]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x18de
[0x5595a931d2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5595a92d4b9c]    main                                               + 0x3c
[0x7f0a331a70b3]    __libc_start_main                                  + 0xf3
[0x5595a931bcbe]    _start                                             + 0x2e

[2023-06-20 14:57:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:57:11] [marian] Running on node18.datos.cluster.uy as process 31855 with command line:
[2023-06-20 14:57:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output '/docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt'
[2023-06-20 14:57:11] [config] after: 0e
[2023-06-20 14:57:11] [config] after-batches: 0
[2023-06-20 14:57:11] [config] after-epochs: 2
[2023-06-20 14:57:11] [config] all-caps-every: 0
[2023-06-20 14:57:11] [config] allow-unk: false
[2023-06-20 14:57:11] [config] authors: false
[2023-06-20 14:57:11] [config] beam-size: 12
[2023-06-20 14:57:11] [config] bert-class-symbol: "[CLS]"
[2023-06-20 14:57:11] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 14:57:11] [config] bert-masking-fraction: 0.15
[2023-06-20 14:57:11] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 14:57:11] [config] bert-train-type-embeddings: true
[2023-06-20 14:57:11] [config] bert-type-vocab-size: 2
[2023-06-20 14:57:11] [config] build-info: ""
[2023-06-20 14:57:11] [config] check-gradient-nan: false
[2023-06-20 14:57:11] [config] check-nan: false
[2023-06-20 14:57:11] [config] cite: false
[2023-06-20 14:57:11] [config] clip-norm: 1
[2023-06-20 14:57:11] [config] cost-scaling:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] cost-type: ce-sum
[2023-06-20 14:57:11] [config] cpu-threads: 0
[2023-06-20 14:57:11] [config] data-threads: 8
[2023-06-20 14:57:11] [config] data-weighting: ""
[2023-06-20 14:57:11] [config] data-weighting-type: sentence
[2023-06-20 14:57:11] [config] dec-cell: gru
[2023-06-20 14:57:11] [config] dec-cell-base-depth: 2
[2023-06-20 14:57:11] [config] dec-cell-high-depth: 1
[2023-06-20 14:57:11] [config] dec-depth: 1
[2023-06-20 14:57:11] [config] devices:
[2023-06-20 14:57:11] [config]   - 0
[2023-06-20 14:57:11] [config] dim-emb: 512
[2023-06-20 14:57:11] [config] dim-rnn: 1024
[2023-06-20 14:57:11] [config] dim-vocabs:
[2023-06-20 14:57:11] [config]   - 0
[2023-06-20 14:57:11] [config]   - 0
[2023-06-20 14:57:11] [config] disp-first: 0
[2023-06-20 14:57:11] [config] disp-freq: 1000u
[2023-06-20 14:57:11] [config] disp-label-counts: true
[2023-06-20 14:57:11] [config] dropout-rnn: 0
[2023-06-20 14:57:11] [config] dropout-src: 0
[2023-06-20 14:57:11] [config] dropout-trg: 0
[2023-06-20 14:57:11] [config] dump-config: ""
[2023-06-20 14:57:11] [config] dynamic-gradient-scaling:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] early-stopping: 10
[2023-06-20 14:57:11] [config] early-stopping-on: first
[2023-06-20 14:57:11] [config] embedding-fix-src: false
[2023-06-20 14:57:11] [config] embedding-fix-trg: false
[2023-06-20 14:57:11] [config] embedding-normalization: false
[2023-06-20 14:57:11] [config] embedding-vectors:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] enc-cell: gru
[2023-06-20 14:57:11] [config] enc-cell-depth: 1
[2023-06-20 14:57:11] [config] enc-depth: 1
[2023-06-20 14:57:11] [config] enc-type: bidirectional
[2023-06-20 14:57:11] [config] english-title-case-every: 0
[2023-06-20 14:57:11] [config] exponential-smoothing: 0
[2023-06-20 14:57:11] [config] factor-weight: 1
[2023-06-20 14:57:11] [config] factors-combine: sum
[2023-06-20 14:57:11] [config] factors-dim-emb: 0
[2023-06-20 14:57:11] [config] gradient-checkpointing: false
[2023-06-20 14:57:11] [config] gradient-norm-average-window: 100
[2023-06-20 14:57:11] [config] guided-alignment: none
[2023-06-20 14:57:11] [config] guided-alignment-cost: mse
[2023-06-20 14:57:11] [config] guided-alignment-weight: 0.1
[2023-06-20 14:57:11] [config] ignore-model-config: false
[2023-06-20 14:57:11] [config] input-types:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] interpolate-env-vars: false
[2023-06-20 14:57:11] [config] keep-best: false
[2023-06-20 14:57:11] [config] label-smoothing: 0
[2023-06-20 14:57:11] [config] layer-normalization: false
[2023-06-20 14:57:11] [config] learn-rate: 0.0001
[2023-06-20 14:57:11] [config] lemma-dependency: ""
[2023-06-20 14:57:11] [config] lemma-dim-emb: 0
[2023-06-20 14:57:11] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 14:57:11] [config] log-level: info
[2023-06-20 14:57:11] [config] log-time-zone: ""
[2023-06-20 14:57:11] [config] logical-epoch:
[2023-06-20 14:57:11] [config]   - 1e
[2023-06-20 14:57:11] [config]   - 0
[2023-06-20 14:57:11] [config] lr-decay: 0
[2023-06-20 14:57:11] [config] lr-decay-freq: 50000
[2023-06-20 14:57:11] [config] lr-decay-inv-sqrt:
[2023-06-20 14:57:11] [config]   - 0
[2023-06-20 14:57:11] [config] lr-decay-repeat-warmup: false
[2023-06-20 14:57:11] [config] lr-decay-reset-optimizer: false
[2023-06-20 14:57:11] [config] lr-decay-start:
[2023-06-20 14:57:11] [config]   - 10
[2023-06-20 14:57:11] [config]   - 1
[2023-06-20 14:57:11] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 14:57:11] [config] lr-report: false
[2023-06-20 14:57:11] [config] lr-warmup: 0
[2023-06-20 14:57:11] [config] lr-warmup-at-reload: false
[2023-06-20 14:57:11] [config] lr-warmup-cycle: false
[2023-06-20 14:57:11] [config] lr-warmup-start-rate: 0
[2023-06-20 14:57:11] [config] max-length: 50
[2023-06-20 14:57:11] [config] max-length-crop: false
[2023-06-20 14:57:11] [config] max-length-factor: 3
[2023-06-20 14:57:11] [config] maxi-batch: 100
[2023-06-20 14:57:11] [config] maxi-batch-sort: trg
[2023-06-20 14:57:11] [config] mini-batch: 64
[2023-06-20 14:57:11] [config] mini-batch-fit: false
[2023-06-20 14:57:11] [config] mini-batch-fit-step: 10
[2023-06-20 14:57:11] [config] mini-batch-round-up: true
[2023-06-20 14:57:11] [config] mini-batch-track-lr: false
[2023-06-20 14:57:11] [config] mini-batch-warmup: 0
[2023-06-20 14:57:11] [config] mini-batch-words: 0
[2023-06-20 14:57:11] [config] mini-batch-words-ref: 0
[2023-06-20 14:57:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:57:11] [config] multi-loss-type: sum
[2023-06-20 14:57:11] [config] n-best: false
[2023-06-20 14:57:11] [config] no-nccl: false
[2023-06-20 14:57:11] [config] no-reload: false
[2023-06-20 14:57:11] [config] no-restore-corpus: false
[2023-06-20 14:57:11] [config] normalize: 0
[2023-06-20 14:57:11] [config] normalize-gradient: false
[2023-06-20 14:57:11] [config] num-devices: 0
[2023-06-20 14:57:11] [config] optimizer: adam
[2023-06-20 14:57:11] [config] optimizer-delay: 1
[2023-06-20 14:57:11] [config] optimizer-params:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] output-omit-bias: false
[2023-06-20 14:57:11] [config] overwrite: false
[2023-06-20 14:57:11] [config] precision:
[2023-06-20 14:57:11] [config]   - float32
[2023-06-20 14:57:11] [config]   - float32
[2023-06-20 14:57:11] [config] pretrained-model: ""
[2023-06-20 14:57:11] [config] quantize-biases: false
[2023-06-20 14:57:11] [config] quantize-bits: 0
[2023-06-20 14:57:11] [config] quantize-log-based: false
[2023-06-20 14:57:11] [config] quantize-optimization-steps: 0
[2023-06-20 14:57:11] [config] quiet: false
[2023-06-20 14:57:11] [config] quiet-translation: false
[2023-06-20 14:57:11] [config] relative-paths: false
[2023-06-20 14:57:11] [config] right-left: false
[2023-06-20 14:57:11] [config] save-freq: 10000u
[2023-06-20 14:57:11] [config] seed: 1234
[2023-06-20 14:57:11] [config] sentencepiece-alphas:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] sentencepiece-max-lines: 2000000
[2023-06-20 14:57:11] [config] sentencepiece-options: ""
[2023-06-20 14:57:11] [config] sharding: global
[2023-06-20 14:57:11] [config] shuffle: data
[2023-06-20 14:57:11] [config] shuffle-in-ram: false
[2023-06-20 14:57:11] [config] sigterm: save-and-exit
[2023-06-20 14:57:11] [config] skip: false
[2023-06-20 14:57:11] [config] sqlite: ""
[2023-06-20 14:57:11] [config] sqlite-drop: false
[2023-06-20 14:57:11] [config] sync-freq: 200u
[2023-06-20 14:57:11] [config] sync-sgd: false
[2023-06-20 14:57:11] [config] tempdir: /tmp
[2023-06-20 14:57:11] [config] tied-embeddings: false
[2023-06-20 14:57:11] [config] tied-embeddings-all: false
[2023-06-20 14:57:11] [config] tied-embeddings-src: false
[2023-06-20 14:57:11] [config] train-embedder-rank:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] train-sets:
[2023-06-20 14:57:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 14:57:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 14:57:11] [config] transformer-aan-activation: swish
[2023-06-20 14:57:11] [config] transformer-aan-depth: 2
[2023-06-20 14:57:11] [config] transformer-aan-nogate: false
[2023-06-20 14:57:11] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 14:57:11] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 14:57:11] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 14:57:11] [config] transformer-depth-scaling: false
[2023-06-20 14:57:11] [config] transformer-dim-aan: 2048
[2023-06-20 14:57:11] [config] transformer-dim-ffn: 2048
[2023-06-20 14:57:11] [config] transformer-dropout: 0
[2023-06-20 14:57:11] [config] transformer-dropout-attention: 0
[2023-06-20 14:57:11] [config] transformer-dropout-ffn: 0
[2023-06-20 14:57:11] [config] transformer-ffn-activation: swish
[2023-06-20 14:57:11] [config] transformer-ffn-depth: 2
[2023-06-20 14:57:11] [config] transformer-guided-alignment-layer: last
[2023-06-20 14:57:11] [config] transformer-heads: 8
[2023-06-20 14:57:11] [config] transformer-no-projection: false
[2023-06-20 14:57:11] [config] transformer-pool: false
[2023-06-20 14:57:11] [config] transformer-postprocess: dan
[2023-06-20 14:57:11] [config] transformer-postprocess-emb: d
[2023-06-20 14:57:11] [config] transformer-postprocess-top: ""
[2023-06-20 14:57:11] [config] transformer-preprocess: ""
[2023-06-20 14:57:11] [config] transformer-tied-layers:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] transformer-train-position-embeddings: false
[2023-06-20 14:57:11] [config] tsv: false
[2023-06-20 14:57:11] [config] tsv-fields: 0
[2023-06-20 14:57:11] [config] type: amun
[2023-06-20 14:57:11] [config] ulr: false
[2023-06-20 14:57:11] [config] ulr-dim-emb: 0
[2023-06-20 14:57:11] [config] ulr-dropout: 0
[2023-06-20 14:57:11] [config] ulr-keys-vectors: ""
[2023-06-20 14:57:11] [config] ulr-query-vectors: ""
[2023-06-20 14:57:11] [config] ulr-softmax-temperature: 1
[2023-06-20 14:57:11] [config] ulr-trainable-transformation: false
[2023-06-20 14:57:11] [config] unlikelihood-loss: false
[2023-06-20 14:57:11] [config] valid-freq: 5000000
[2023-06-20 14:57:11] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 14:57:11] [config] valid-max-length: 1000
[2023-06-20 14:57:11] [config] valid-metrics:
[2023-06-20 14:57:11] [config]   - cross-entropy
[2023-06-20 14:57:11] [config] valid-mini-batch: 32
[2023-06-20 14:57:11] [config] valid-reset-stalled: false
[2023-06-20 14:57:11] [config] valid-script-args:
[2023-06-20 14:57:11] [config]   []
[2023-06-20 14:57:11] [config] valid-script-path: ""
[2023-06-20 14:57:11] [config] valid-sets:
[2023-06-20 14:57:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 14:57:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 14:57:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-{E}-epochs.txt
[2023-06-20 14:57:11] [config] vocabs:
[2023-06-20 14:57:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:57:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:57:11] [config] word-penalty: 0
[2023-06-20 14:57:11] [config] word-scores: false
[2023-06-20 14:57:11] [config] workspace: 2048
[2023-06-20 14:57:11] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 14:57:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:57:11] [training] Using single-device training
[2023-06-20 14:57:11] Synced seed 1234
[2023-06-20 14:57:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 14:57:11] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 14:57:11] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 14:57:11] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 14:57:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 14:57:12] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 14:57:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 14:57:12] [comm] Using global sharding
[2023-06-20 14:57:12] [comm] NCCLCommunicators constructed successfully
[2023-06-20 14:57:12] [training] Using 1 GPUs
[2023-06-20 14:57:12] Training started
[2023-06-20 14:57:12] [data] Shuffling data
[2023-06-20 14:57:12] [data] Done reading 20,192 sentences
[2023-06-20 14:57:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:57:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 14:57:13] [logits] Applying loss function for 1 factor(s)
[2023-06-20 14:57:13] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:57:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 14:57:14] [memory] Reserving 377 MB, device gpu0
[2023-06-20 14:57:15] Parameter type float32, optimization type float32, casting types false
[2023-06-20 14:57:15] Allocating memory for Adam-specific shards
[2023-06-20 14:57:15] [memory] Reserving 754 MB, device gpu0
[2023-06-20 14:57:53] Seen 18,843 samples
[2023-06-20 14:57:53] Starting data epoch 2 in logical epoch 2
[2023-06-20 14:57:53] [data] Shuffling data
[2023-06-20 14:57:53] [data] Done reading 20,192 sentences
[2023-06-20 14:57:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 14:58:32] Seen 18,843 samples
[2023-06-20 14:58:32] Starting data epoch 3 in logical epoch 3
[2023-06-20 14:58:32] Training finished
[2023-06-20 14:58:38] [valid] Ep. 3 : Up. 594 : cross-entropy : 122.182 : new best
[2023-06-20 14:58:39] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 14:58:42] Saving Adam parameters
[2023-06-20 14:58:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:12:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:12:11] [marian] Running on node18.datos.cluster.uy as process 33116 with command line:
[2023-06-20 15:12:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/gn_es_scored_june-epochs.txt
[2023-06-20 15:12:11] [config] after: 0e
[2023-06-20 15:12:11] [config] after-batches: 0
[2023-06-20 15:12:11] [config] after-epochs: 2
[2023-06-20 15:12:11] [config] all-caps-every: 0
[2023-06-20 15:12:11] [config] allow-unk: false
[2023-06-20 15:12:11] [config] authors: false
[2023-06-20 15:12:11] [config] beam-size: 12
[2023-06-20 15:12:11] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:12:11] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:12:11] [config] bert-masking-fraction: 0.15
[2023-06-20 15:12:11] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:12:11] [config] bert-train-type-embeddings: true
[2023-06-20 15:12:11] [config] bert-type-vocab-size: 2
[2023-06-20 15:12:11] [config] build-info: ""
[2023-06-20 15:12:11] [config] check-gradient-nan: false
[2023-06-20 15:12:11] [config] check-nan: false
[2023-06-20 15:12:11] [config] cite: false
[2023-06-20 15:12:11] [config] clip-norm: 1
[2023-06-20 15:12:11] [config] cost-scaling:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] cost-type: ce-sum
[2023-06-20 15:12:11] [config] cpu-threads: 0
[2023-06-20 15:12:11] [config] data-threads: 8
[2023-06-20 15:12:11] [config] data-weighting: ""
[2023-06-20 15:12:11] [config] data-weighting-type: sentence
[2023-06-20 15:12:11] [config] dec-cell: gru
[2023-06-20 15:12:11] [config] dec-cell-base-depth: 2
[2023-06-20 15:12:11] [config] dec-cell-high-depth: 1
[2023-06-20 15:12:11] [config] dec-depth: 1
[2023-06-20 15:12:11] [config] devices:
[2023-06-20 15:12:11] [config]   - 0
[2023-06-20 15:12:11] [config] dim-emb: 512
[2023-06-20 15:12:11] [config] dim-rnn: 1024
[2023-06-20 15:12:11] [config] dim-vocabs:
[2023-06-20 15:12:11] [config]   - 54042
[2023-06-20 15:12:11] [config]   - 36507
[2023-06-20 15:12:11] [config] disp-first: 0
[2023-06-20 15:12:11] [config] disp-freq: 1000u
[2023-06-20 15:12:11] [config] disp-label-counts: true
[2023-06-20 15:12:11] [config] dropout-rnn: 0
[2023-06-20 15:12:11] [config] dropout-src: 0
[2023-06-20 15:12:11] [config] dropout-trg: 0
[2023-06-20 15:12:11] [config] dump-config: ""
[2023-06-20 15:12:11] [config] dynamic-gradient-scaling:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] early-stopping: 10
[2023-06-20 15:12:11] [config] early-stopping-on: first
[2023-06-20 15:12:11] [config] embedding-fix-src: false
[2023-06-20 15:12:11] [config] embedding-fix-trg: false
[2023-06-20 15:12:11] [config] embedding-normalization: false
[2023-06-20 15:12:11] [config] embedding-vectors:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] enc-cell: gru
[2023-06-20 15:12:11] [config] enc-cell-depth: 1
[2023-06-20 15:12:11] [config] enc-depth: 1
[2023-06-20 15:12:11] [config] enc-type: bidirectional
[2023-06-20 15:12:11] [config] english-title-case-every: 0
[2023-06-20 15:12:11] [config] exponential-smoothing: 0
[2023-06-20 15:12:11] [config] factor-weight: 1
[2023-06-20 15:12:11] [config] factors-combine: sum
[2023-06-20 15:12:11] [config] factors-dim-emb: 0
[2023-06-20 15:12:11] [config] gradient-checkpointing: false
[2023-06-20 15:12:11] [config] gradient-norm-average-window: 100
[2023-06-20 15:12:11] [config] guided-alignment: none
[2023-06-20 15:12:11] [config] guided-alignment-cost: mse
[2023-06-20 15:12:11] [config] guided-alignment-weight: 0.1
[2023-06-20 15:12:11] [config] ignore-model-config: false
[2023-06-20 15:12:11] [config] input-types:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] interpolate-env-vars: false
[2023-06-20 15:12:11] [config] keep-best: false
[2023-06-20 15:12:11] [config] label-smoothing: 0
[2023-06-20 15:12:11] [config] layer-normalization: false
[2023-06-20 15:12:11] [config] learn-rate: 0.0001
[2023-06-20 15:12:11] [config] lemma-dependency: ""
[2023-06-20 15:12:11] [config] lemma-dim-emb: 0
[2023-06-20 15:12:11] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:12:11] [config] log-level: info
[2023-06-20 15:12:11] [config] log-time-zone: ""
[2023-06-20 15:12:11] [config] logical-epoch:
[2023-06-20 15:12:11] [config]   - 1e
[2023-06-20 15:12:11] [config]   - 0
[2023-06-20 15:12:11] [config] lr-decay: 0
[2023-06-20 15:12:11] [config] lr-decay-freq: 50000
[2023-06-20 15:12:11] [config] lr-decay-inv-sqrt:
[2023-06-20 15:12:11] [config]   - 0
[2023-06-20 15:12:11] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:12:11] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:12:11] [config] lr-decay-start:
[2023-06-20 15:12:11] [config]   - 10
[2023-06-20 15:12:11] [config]   - 1
[2023-06-20 15:12:11] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:12:11] [config] lr-report: false
[2023-06-20 15:12:11] [config] lr-warmup: 0
[2023-06-20 15:12:11] [config] lr-warmup-at-reload: false
[2023-06-20 15:12:11] [config] lr-warmup-cycle: false
[2023-06-20 15:12:11] [config] lr-warmup-start-rate: 0
[2023-06-20 15:12:11] [config] max-length: 50
[2023-06-20 15:12:11] [config] max-length-crop: false
[2023-06-20 15:12:11] [config] max-length-factor: 3
[2023-06-20 15:12:11] [config] maxi-batch: 100
[2023-06-20 15:12:11] [config] maxi-batch-sort: trg
[2023-06-20 15:12:11] [config] mini-batch: 64
[2023-06-20 15:12:11] [config] mini-batch-fit: false
[2023-06-20 15:12:11] [config] mini-batch-fit-step: 10
[2023-06-20 15:12:11] [config] mini-batch-round-up: true
[2023-06-20 15:12:11] [config] mini-batch-track-lr: false
[2023-06-20 15:12:11] [config] mini-batch-warmup: 0
[2023-06-20 15:12:11] [config] mini-batch-words: 0
[2023-06-20 15:12:11] [config] mini-batch-words-ref: 0
[2023-06-20 15:12:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:12:11] [config] multi-loss-type: sum
[2023-06-20 15:12:11] [config] n-best: false
[2023-06-20 15:12:11] [config] no-nccl: false
[2023-06-20 15:12:11] [config] no-reload: false
[2023-06-20 15:12:11] [config] no-restore-corpus: false
[2023-06-20 15:12:11] [config] normalize: 0
[2023-06-20 15:12:11] [config] normalize-gradient: false
[2023-06-20 15:12:11] [config] num-devices: 0
[2023-06-20 15:12:11] [config] optimizer: adam
[2023-06-20 15:12:11] [config] optimizer-delay: 1
[2023-06-20 15:12:11] [config] optimizer-params:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] output-omit-bias: false
[2023-06-20 15:12:11] [config] overwrite: false
[2023-06-20 15:12:11] [config] precision:
[2023-06-20 15:12:11] [config]   - float32
[2023-06-20 15:12:11] [config]   - float32
[2023-06-20 15:12:11] [config] pretrained-model: ""
[2023-06-20 15:12:11] [config] quantize-biases: false
[2023-06-20 15:12:11] [config] quantize-bits: 0
[2023-06-20 15:12:11] [config] quantize-log-based: false
[2023-06-20 15:12:11] [config] quantize-optimization-steps: 0
[2023-06-20 15:12:11] [config] quiet: false
[2023-06-20 15:12:11] [config] quiet-translation: false
[2023-06-20 15:12:11] [config] relative-paths: false
[2023-06-20 15:12:11] [config] right-left: false
[2023-06-20 15:12:11] [config] save-freq: 10000u
[2023-06-20 15:12:11] [config] seed: 1234
[2023-06-20 15:12:11] [config] sentencepiece-alphas:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:12:11] [config] sentencepiece-options: ""
[2023-06-20 15:12:11] [config] sharding: global
[2023-06-20 15:12:11] [config] shuffle: data
[2023-06-20 15:12:11] [config] shuffle-in-ram: false
[2023-06-20 15:12:11] [config] sigterm: save-and-exit
[2023-06-20 15:12:11] [config] skip: false
[2023-06-20 15:12:11] [config] sqlite: ""
[2023-06-20 15:12:11] [config] sqlite-drop: false
[2023-06-20 15:12:11] [config] sync-freq: 200u
[2023-06-20 15:12:11] [config] sync-sgd: false
[2023-06-20 15:12:11] [config] tempdir: /tmp
[2023-06-20 15:12:11] [config] tied-embeddings: false
[2023-06-20 15:12:11] [config] tied-embeddings-all: false
[2023-06-20 15:12:11] [config] tied-embeddings-src: false
[2023-06-20 15:12:11] [config] train-embedder-rank:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] train-sets:
[2023-06-20 15:12:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:12:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:12:11] [config] transformer-aan-activation: swish
[2023-06-20 15:12:11] [config] transformer-aan-depth: 2
[2023-06-20 15:12:11] [config] transformer-aan-nogate: false
[2023-06-20 15:12:11] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:12:11] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:12:11] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:12:11] [config] transformer-depth-scaling: false
[2023-06-20 15:12:11] [config] transformer-dim-aan: 2048
[2023-06-20 15:12:11] [config] transformer-dim-ffn: 2048
[2023-06-20 15:12:11] [config] transformer-dropout: 0
[2023-06-20 15:12:11] [config] transformer-dropout-attention: 0
[2023-06-20 15:12:11] [config] transformer-dropout-ffn: 0
[2023-06-20 15:12:11] [config] transformer-ffn-activation: swish
[2023-06-20 15:12:11] [config] transformer-ffn-depth: 2
[2023-06-20 15:12:11] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:12:11] [config] transformer-heads: 8
[2023-06-20 15:12:11] [config] transformer-no-projection: false
[2023-06-20 15:12:11] [config] transformer-pool: false
[2023-06-20 15:12:11] [config] transformer-postprocess: dan
[2023-06-20 15:12:11] [config] transformer-postprocess-emb: d
[2023-06-20 15:12:11] [config] transformer-postprocess-top: ""
[2023-06-20 15:12:11] [config] transformer-preprocess: ""
[2023-06-20 15:12:11] [config] transformer-tied-layers:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] transformer-train-position-embeddings: false
[2023-06-20 15:12:11] [config] tsv: false
[2023-06-20 15:12:11] [config] tsv-fields: 0
[2023-06-20 15:12:11] [config] type: amun
[2023-06-20 15:12:11] [config] ulr: false
[2023-06-20 15:12:11] [config] ulr-dim-emb: 0
[2023-06-20 15:12:11] [config] ulr-dropout: 0
[2023-06-20 15:12:11] [config] ulr-keys-vectors: ""
[2023-06-20 15:12:11] [config] ulr-query-vectors: ""
[2023-06-20 15:12:11] [config] ulr-softmax-temperature: 1
[2023-06-20 15:12:11] [config] ulr-trainable-transformation: false
[2023-06-20 15:12:11] [config] unlikelihood-loss: false
[2023-06-20 15:12:11] [config] valid-freq: 5000000
[2023-06-20 15:12:11] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:12:11] [config] valid-max-length: 1000
[2023-06-20 15:12:11] [config] valid-metrics:
[2023-06-20 15:12:11] [config]   - cross-entropy
[2023-06-20 15:12:11] [config] valid-mini-batch: 32
[2023-06-20 15:12:11] [config] valid-reset-stalled: false
[2023-06-20 15:12:11] [config] valid-script-args:
[2023-06-20 15:12:11] [config]   []
[2023-06-20 15:12:11] [config] valid-script-path: ""
[2023-06-20 15:12:11] [config] valid-sets:
[2023-06-20 15:12:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:12:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:12:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-epochs.txt
[2023-06-20 15:12:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:12:11] [config] vocabs:
[2023-06-20 15:12:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:12:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:12:11] [config] word-penalty: 0
[2023-06-20 15:12:11] [config] word-scores: false
[2023-06-20 15:12:11] [config] workspace: 2048
[2023-06-20 15:12:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:12:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:12:11] [training] Using single-device training
[2023-06-20 15:12:12] Synced seed 1234
[2023-06-20 15:12:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:12:12] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:12:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:12:12] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:12:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:12:13] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:12:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:12:13] [comm] Using global sharding
[2023-06-20 15:12:13] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:12:13] [training] Using 1 GPUs
[2023-06-20 15:12:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:12:16] Loading Adam parameters
[2023-06-20 15:12:16] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:12:16] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:12:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:12:16] [data] Restoring the corpus state to epoch 3, batch 594
[2023-06-20 15:12:16] [data] Shuffling data
[2023-06-20 15:12:16] [data] Done reading 20,192 sentences
[2023-06-20 15:12:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:12:16] Training started
[2023-06-20 15:12:16] Training finished
[2023-06-20 15:13:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:13:58] [marian] Running on node18.datos.cluster.uy as process 33329 with command line:
[2023-06-20 15:13:58] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/gn_es_scored_june-epochs.txt
[2023-06-20 15:13:58] [config] after: 0e
[2023-06-20 15:13:58] [config] after-batches: 0
[2023-06-20 15:13:58] [config] after-epochs: 2
[2023-06-20 15:13:58] [config] all-caps-every: 0
[2023-06-20 15:13:58] [config] allow-unk: false
[2023-06-20 15:13:58] [config] authors: false
[2023-06-20 15:13:58] [config] beam-size: 12
[2023-06-20 15:13:58] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:13:58] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:13:58] [config] bert-masking-fraction: 0.15
[2023-06-20 15:13:58] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:13:58] [config] bert-train-type-embeddings: true
[2023-06-20 15:13:58] [config] bert-type-vocab-size: 2
[2023-06-20 15:13:58] [config] build-info: ""
[2023-06-20 15:13:58] [config] check-gradient-nan: false
[2023-06-20 15:13:58] [config] check-nan: false
[2023-06-20 15:13:58] [config] cite: false
[2023-06-20 15:13:58] [config] clip-norm: 1
[2023-06-20 15:13:58] [config] cost-scaling:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] cost-type: ce-sum
[2023-06-20 15:13:58] [config] cpu-threads: 0
[2023-06-20 15:13:58] [config] data-threads: 8
[2023-06-20 15:13:58] [config] data-weighting: ""
[2023-06-20 15:13:58] [config] data-weighting-type: sentence
[2023-06-20 15:13:58] [config] dec-cell: gru
[2023-06-20 15:13:58] [config] dec-cell-base-depth: 2
[2023-06-20 15:13:58] [config] dec-cell-high-depth: 1
[2023-06-20 15:13:58] [config] dec-depth: 1
[2023-06-20 15:13:58] [config] devices:
[2023-06-20 15:13:58] [config]   - 0
[2023-06-20 15:13:58] [config] dim-emb: 512
[2023-06-20 15:13:58] [config] dim-rnn: 1024
[2023-06-20 15:13:58] [config] dim-vocabs:
[2023-06-20 15:13:58] [config]   - 0
[2023-06-20 15:13:58] [config]   - 0
[2023-06-20 15:13:58] [config] disp-first: 0
[2023-06-20 15:13:58] [config] disp-freq: 1000u
[2023-06-20 15:13:58] [config] disp-label-counts: true
[2023-06-20 15:13:58] [config] dropout-rnn: 0
[2023-06-20 15:13:58] [config] dropout-src: 0
[2023-06-20 15:13:58] [config] dropout-trg: 0
[2023-06-20 15:13:58] [config] dump-config: ""
[2023-06-20 15:13:58] [config] dynamic-gradient-scaling:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] early-stopping: 10
[2023-06-20 15:13:58] [config] early-stopping-on: first
[2023-06-20 15:13:58] [config] embedding-fix-src: false
[2023-06-20 15:13:58] [config] embedding-fix-trg: false
[2023-06-20 15:13:58] [config] embedding-normalization: false
[2023-06-20 15:13:58] [config] embedding-vectors:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] enc-cell: gru
[2023-06-20 15:13:58] [config] enc-cell-depth: 1
[2023-06-20 15:13:58] [config] enc-depth: 1
[2023-06-20 15:13:58] [config] enc-type: bidirectional
[2023-06-20 15:13:58] [config] english-title-case-every: 0
[2023-06-20 15:13:58] [config] exponential-smoothing: 0
[2023-06-20 15:13:58] [config] factor-weight: 1
[2023-06-20 15:13:58] [config] factors-combine: sum
[2023-06-20 15:13:58] [config] factors-dim-emb: 0
[2023-06-20 15:13:58] [config] gradient-checkpointing: false
[2023-06-20 15:13:58] [config] gradient-norm-average-window: 100
[2023-06-20 15:13:58] [config] guided-alignment: none
[2023-06-20 15:13:58] [config] guided-alignment-cost: mse
[2023-06-20 15:13:58] [config] guided-alignment-weight: 0.1
[2023-06-20 15:13:58] [config] ignore-model-config: false
[2023-06-20 15:13:58] [config] input-types:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] interpolate-env-vars: false
[2023-06-20 15:13:58] [config] keep-best: false
[2023-06-20 15:13:58] [config] label-smoothing: 0
[2023-06-20 15:13:58] [config] layer-normalization: false
[2023-06-20 15:13:58] [config] learn-rate: 0.0001
[2023-06-20 15:13:58] [config] lemma-dependency: ""
[2023-06-20 15:13:58] [config] lemma-dim-emb: 0
[2023-06-20 15:13:58] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:13:58] [config] log-level: info
[2023-06-20 15:13:58] [config] log-time-zone: ""
[2023-06-20 15:13:58] [config] logical-epoch:
[2023-06-20 15:13:58] [config]   - 1e
[2023-06-20 15:13:58] [config]   - 0
[2023-06-20 15:13:58] [config] lr-decay: 0
[2023-06-20 15:13:58] [config] lr-decay-freq: 50000
[2023-06-20 15:13:58] [config] lr-decay-inv-sqrt:
[2023-06-20 15:13:58] [config]   - 0
[2023-06-20 15:13:58] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:13:58] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:13:58] [config] lr-decay-start:
[2023-06-20 15:13:58] [config]   - 10
[2023-06-20 15:13:58] [config]   - 1
[2023-06-20 15:13:58] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:13:58] [config] lr-report: false
[2023-06-20 15:13:58] [config] lr-warmup: 0
[2023-06-20 15:13:58] [config] lr-warmup-at-reload: false
[2023-06-20 15:13:58] [config] lr-warmup-cycle: false
[2023-06-20 15:13:58] [config] lr-warmup-start-rate: 0
[2023-06-20 15:13:58] [config] max-length: 50
[2023-06-20 15:13:58] [config] max-length-crop: false
[2023-06-20 15:13:58] [config] max-length-factor: 3
[2023-06-20 15:13:58] [config] maxi-batch: 100
[2023-06-20 15:13:58] [config] maxi-batch-sort: trg
[2023-06-20 15:13:58] [config] mini-batch: 64
[2023-06-20 15:13:58] [config] mini-batch-fit: false
[2023-06-20 15:13:58] [config] mini-batch-fit-step: 10
[2023-06-20 15:13:58] [config] mini-batch-round-up: true
[2023-06-20 15:13:58] [config] mini-batch-track-lr: false
[2023-06-20 15:13:58] [config] mini-batch-warmup: 0
[2023-06-20 15:13:58] [config] mini-batch-words: 0
[2023-06-20 15:13:58] [config] mini-batch-words-ref: 0
[2023-06-20 15:13:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:13:58] [config] multi-loss-type: sum
[2023-06-20 15:13:58] [config] n-best: false
[2023-06-20 15:13:58] [config] no-nccl: false
[2023-06-20 15:13:58] [config] no-reload: false
[2023-06-20 15:13:58] [config] no-restore-corpus: false
[2023-06-20 15:13:58] [config] normalize: 0
[2023-06-20 15:13:58] [config] normalize-gradient: false
[2023-06-20 15:13:58] [config] num-devices: 0
[2023-06-20 15:13:58] [config] optimizer: adam
[2023-06-20 15:13:58] [config] optimizer-delay: 1
[2023-06-20 15:13:58] [config] optimizer-params:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] output-omit-bias: false
[2023-06-20 15:13:58] [config] overwrite: false
[2023-06-20 15:13:58] [config] precision:
[2023-06-20 15:13:58] [config]   - float32
[2023-06-20 15:13:58] [config]   - float32
[2023-06-20 15:13:58] [config] pretrained-model: ""
[2023-06-20 15:13:58] [config] quantize-biases: false
[2023-06-20 15:13:58] [config] quantize-bits: 0
[2023-06-20 15:13:58] [config] quantize-log-based: false
[2023-06-20 15:13:58] [config] quantize-optimization-steps: 0
[2023-06-20 15:13:58] [config] quiet: false
[2023-06-20 15:13:58] [config] quiet-translation: false
[2023-06-20 15:13:58] [config] relative-paths: false
[2023-06-20 15:13:58] [config] right-left: false
[2023-06-20 15:13:58] [config] save-freq: 10000u
[2023-06-20 15:13:58] [config] seed: 1234
[2023-06-20 15:13:58] [config] sentencepiece-alphas:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:13:58] [config] sentencepiece-options: ""
[2023-06-20 15:13:58] [config] sharding: global
[2023-06-20 15:13:58] [config] shuffle: data
[2023-06-20 15:13:58] [config] shuffle-in-ram: false
[2023-06-20 15:13:58] [config] sigterm: save-and-exit
[2023-06-20 15:13:58] [config] skip: false
[2023-06-20 15:13:58] [config] sqlite: ""
[2023-06-20 15:13:58] [config] sqlite-drop: false
[2023-06-20 15:13:58] [config] sync-freq: 200u
[2023-06-20 15:13:58] [config] sync-sgd: false
[2023-06-20 15:13:58] [config] tempdir: /tmp
[2023-06-20 15:13:58] [config] tied-embeddings: false
[2023-06-20 15:13:58] [config] tied-embeddings-all: false
[2023-06-20 15:13:58] [config] tied-embeddings-src: false
[2023-06-20 15:13:58] [config] train-embedder-rank:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] train-sets:
[2023-06-20 15:13:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:13:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:13:58] [config] transformer-aan-activation: swish
[2023-06-20 15:13:58] [config] transformer-aan-depth: 2
[2023-06-20 15:13:58] [config] transformer-aan-nogate: false
[2023-06-20 15:13:58] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:13:58] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:13:58] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:13:58] [config] transformer-depth-scaling: false
[2023-06-20 15:13:58] [config] transformer-dim-aan: 2048
[2023-06-20 15:13:58] [config] transformer-dim-ffn: 2048
[2023-06-20 15:13:58] [config] transformer-dropout: 0
[2023-06-20 15:13:58] [config] transformer-dropout-attention: 0
[2023-06-20 15:13:58] [config] transformer-dropout-ffn: 0
[2023-06-20 15:13:58] [config] transformer-ffn-activation: swish
[2023-06-20 15:13:58] [config] transformer-ffn-depth: 2
[2023-06-20 15:13:58] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:13:58] [config] transformer-heads: 8
[2023-06-20 15:13:58] [config] transformer-no-projection: false
[2023-06-20 15:13:58] [config] transformer-pool: false
[2023-06-20 15:13:58] [config] transformer-postprocess: dan
[2023-06-20 15:13:58] [config] transformer-postprocess-emb: d
[2023-06-20 15:13:58] [config] transformer-postprocess-top: ""
[2023-06-20 15:13:58] [config] transformer-preprocess: ""
[2023-06-20 15:13:58] [config] transformer-tied-layers:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] transformer-train-position-embeddings: false
[2023-06-20 15:13:58] [config] tsv: false
[2023-06-20 15:13:58] [config] tsv-fields: 0
[2023-06-20 15:13:58] [config] type: amun
[2023-06-20 15:13:58] [config] ulr: false
[2023-06-20 15:13:58] [config] ulr-dim-emb: 0
[2023-06-20 15:13:58] [config] ulr-dropout: 0
[2023-06-20 15:13:58] [config] ulr-keys-vectors: ""
[2023-06-20 15:13:58] [config] ulr-query-vectors: ""
[2023-06-20 15:13:58] [config] ulr-softmax-temperature: 1
[2023-06-20 15:13:58] [config] ulr-trainable-transformation: false
[2023-06-20 15:13:58] [config] unlikelihood-loss: false
[2023-06-20 15:13:58] [config] valid-freq: 5000000
[2023-06-20 15:13:58] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:13:58] [config] valid-max-length: 1000
[2023-06-20 15:13:58] [config] valid-metrics:
[2023-06-20 15:13:58] [config]   - cross-entropy
[2023-06-20 15:13:58] [config] valid-mini-batch: 32
[2023-06-20 15:13:58] [config] valid-reset-stalled: false
[2023-06-20 15:13:58] [config] valid-script-args:
[2023-06-20 15:13:58] [config]   []
[2023-06-20 15:13:58] [config] valid-script-path: ""
[2023-06-20 15:13:58] [config] valid-sets:
[2023-06-20 15:13:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:13:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:13:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-epochs.txt
[2023-06-20 15:13:58] [config] vocabs:
[2023-06-20 15:13:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:13:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:13:58] [config] word-penalty: 0
[2023-06-20 15:13:58] [config] word-scores: false
[2023-06-20 15:13:58] [config] workspace: 2048
[2023-06-20 15:13:58] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:13:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:13:58] [training] Using single-device training
[2023-06-20 15:13:58] Synced seed 1234
[2023-06-20 15:13:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:13:58] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:13:58] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:13:58] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:13:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:13:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:14:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:14:00] [comm] Using global sharding
[2023-06-20 15:14:00] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:14:00] [training] Using 1 GPUs
[2023-06-20 15:14:00] Training started
[2023-06-20 15:14:00] [data] Shuffling data
[2023-06-20 15:14:00] [data] Done reading 20,192 sentences
[2023-06-20 15:14:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:14:00] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 15:14:00] [logits] Applying loss function for 1 factor(s)
[2023-06-20 15:14:00] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:14:01] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 15:14:02] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:14:02] Parameter type float32, optimization type float32, casting types false
[2023-06-20 15:14:02] Allocating memory for Adam-specific shards
[2023-06-20 15:14:02] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:14:40] Seen 18,843 samples
[2023-06-20 15:14:40] Starting data epoch 2 in logical epoch 2
[2023-06-20 15:14:40] [data] Shuffling data
[2023-06-20 15:14:40] [data] Done reading 20,192 sentences
[2023-06-20 15:14:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:15:20] Seen 18,843 samples
[2023-06-20 15:15:21] Starting data epoch 3 in logical epoch 3
[2023-06-20 15:15:21] Training finished
[2023-06-20 15:15:27] [valid] Ep. 3 : Up. 594 : cross-entropy : 122.183 : new best
[2023-06-20 15:15:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:15:31] Saving Adam parameters
[2023-06-20 15:15:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:17:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:17:55] [marian] Running on node18.datos.cluster.uy as process 33659 with command line:
[2023-06-20 15:17:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/gn_es_scored_june-epochs.txt
[2023-06-20 15:17:55] [config] after: 0e
[2023-06-20 15:17:55] [config] after-batches: 0
[2023-06-20 15:17:55] [config] after-epochs: 1
[2023-06-20 15:17:55] [config] all-caps-every: 0
[2023-06-20 15:17:55] [config] allow-unk: false
[2023-06-20 15:17:55] [config] authors: false
[2023-06-20 15:17:55] [config] beam-size: 12
[2023-06-20 15:17:55] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:17:55] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:17:55] [config] bert-masking-fraction: 0.15
[2023-06-20 15:17:55] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:17:55] [config] bert-train-type-embeddings: true
[2023-06-20 15:17:55] [config] bert-type-vocab-size: 2
[2023-06-20 15:17:55] [config] build-info: ""
[2023-06-20 15:17:55] [config] check-gradient-nan: false
[2023-06-20 15:17:55] [config] check-nan: false
[2023-06-20 15:17:55] [config] cite: false
[2023-06-20 15:17:55] [config] clip-norm: 1
[2023-06-20 15:17:55] [config] cost-scaling:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] cost-type: ce-sum
[2023-06-20 15:17:55] [config] cpu-threads: 0
[2023-06-20 15:17:55] [config] data-threads: 8
[2023-06-20 15:17:55] [config] data-weighting: ""
[2023-06-20 15:17:55] [config] data-weighting-type: sentence
[2023-06-20 15:17:55] [config] dec-cell: gru
[2023-06-20 15:17:55] [config] dec-cell-base-depth: 2
[2023-06-20 15:17:55] [config] dec-cell-high-depth: 1
[2023-06-20 15:17:55] [config] dec-depth: 1
[2023-06-20 15:17:55] [config] devices:
[2023-06-20 15:17:55] [config]   - 0
[2023-06-20 15:17:55] [config] dim-emb: 512
[2023-06-20 15:17:55] [config] dim-rnn: 1024
[2023-06-20 15:17:55] [config] dim-vocabs:
[2023-06-20 15:17:55] [config]   - 0
[2023-06-20 15:17:55] [config]   - 0
[2023-06-20 15:17:55] [config] disp-first: 0
[2023-06-20 15:17:55] [config] disp-freq: 1000u
[2023-06-20 15:17:55] [config] disp-label-counts: true
[2023-06-20 15:17:55] [config] dropout-rnn: 0
[2023-06-20 15:17:55] [config] dropout-src: 0
[2023-06-20 15:17:55] [config] dropout-trg: 0
[2023-06-20 15:17:55] [config] dump-config: ""
[2023-06-20 15:17:55] [config] dynamic-gradient-scaling:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] early-stopping: 10
[2023-06-20 15:17:55] [config] early-stopping-on: first
[2023-06-20 15:17:55] [config] embedding-fix-src: false
[2023-06-20 15:17:55] [config] embedding-fix-trg: false
[2023-06-20 15:17:55] [config] embedding-normalization: false
[2023-06-20 15:17:55] [config] embedding-vectors:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] enc-cell: gru
[2023-06-20 15:17:55] [config] enc-cell-depth: 1
[2023-06-20 15:17:55] [config] enc-depth: 1
[2023-06-20 15:17:55] [config] enc-type: bidirectional
[2023-06-20 15:17:55] [config] english-title-case-every: 0
[2023-06-20 15:17:55] [config] exponential-smoothing: 0
[2023-06-20 15:17:55] [config] factor-weight: 1
[2023-06-20 15:17:55] [config] factors-combine: sum
[2023-06-20 15:17:55] [config] factors-dim-emb: 0
[2023-06-20 15:17:55] [config] gradient-checkpointing: false
[2023-06-20 15:17:55] [config] gradient-norm-average-window: 100
[2023-06-20 15:17:55] [config] guided-alignment: none
[2023-06-20 15:17:55] [config] guided-alignment-cost: mse
[2023-06-20 15:17:55] [config] guided-alignment-weight: 0.1
[2023-06-20 15:17:55] [config] ignore-model-config: false
[2023-06-20 15:17:55] [config] input-types:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] interpolate-env-vars: false
[2023-06-20 15:17:55] [config] keep-best: false
[2023-06-20 15:17:55] [config] label-smoothing: 0
[2023-06-20 15:17:55] [config] layer-normalization: false
[2023-06-20 15:17:55] [config] learn-rate: 0.0001
[2023-06-20 15:17:55] [config] lemma-dependency: ""
[2023-06-20 15:17:55] [config] lemma-dim-emb: 0
[2023-06-20 15:17:55] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:17:55] [config] log-level: info
[2023-06-20 15:17:55] [config] log-time-zone: ""
[2023-06-20 15:17:55] [config] logical-epoch:
[2023-06-20 15:17:55] [config]   - 1e
[2023-06-20 15:17:55] [config]   - 0
[2023-06-20 15:17:55] [config] lr-decay: 0
[2023-06-20 15:17:55] [config] lr-decay-freq: 50000
[2023-06-20 15:17:55] [config] lr-decay-inv-sqrt:
[2023-06-20 15:17:55] [config]   - 0
[2023-06-20 15:17:55] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:17:55] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:17:55] [config] lr-decay-start:
[2023-06-20 15:17:55] [config]   - 10
[2023-06-20 15:17:55] [config]   - 1
[2023-06-20 15:17:55] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:17:55] [config] lr-report: false
[2023-06-20 15:17:55] [config] lr-warmup: 0
[2023-06-20 15:17:55] [config] lr-warmup-at-reload: false
[2023-06-20 15:17:55] [config] lr-warmup-cycle: false
[2023-06-20 15:17:55] [config] lr-warmup-start-rate: 0
[2023-06-20 15:17:55] [config] max-length: 50
[2023-06-20 15:17:55] [config] max-length-crop: false
[2023-06-20 15:17:55] [config] max-length-factor: 3
[2023-06-20 15:17:55] [config] maxi-batch: 100
[2023-06-20 15:17:55] [config] maxi-batch-sort: trg
[2023-06-20 15:17:55] [config] mini-batch: 64
[2023-06-20 15:17:55] [config] mini-batch-fit: false
[2023-06-20 15:17:55] [config] mini-batch-fit-step: 10
[2023-06-20 15:17:55] [config] mini-batch-round-up: true
[2023-06-20 15:17:55] [config] mini-batch-track-lr: false
[2023-06-20 15:17:55] [config] mini-batch-warmup: 0
[2023-06-20 15:17:55] [config] mini-batch-words: 0
[2023-06-20 15:17:55] [config] mini-batch-words-ref: 0
[2023-06-20 15:17:55] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:17:55] [config] multi-loss-type: sum
[2023-06-20 15:17:55] [config] n-best: false
[2023-06-20 15:17:55] [config] no-nccl: false
[2023-06-20 15:17:55] [config] no-reload: false
[2023-06-20 15:17:55] [config] no-restore-corpus: false
[2023-06-20 15:17:55] [config] normalize: 0
[2023-06-20 15:17:55] [config] normalize-gradient: false
[2023-06-20 15:17:55] [config] num-devices: 0
[2023-06-20 15:17:55] [config] optimizer: adam
[2023-06-20 15:17:55] [config] optimizer-delay: 1
[2023-06-20 15:17:55] [config] optimizer-params:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] output-omit-bias: false
[2023-06-20 15:17:55] [config] overwrite: false
[2023-06-20 15:17:55] [config] precision:
[2023-06-20 15:17:55] [config]   - float32
[2023-06-20 15:17:55] [config]   - float32
[2023-06-20 15:17:55] [config] pretrained-model: ""
[2023-06-20 15:17:55] [config] quantize-biases: false
[2023-06-20 15:17:55] [config] quantize-bits: 0
[2023-06-20 15:17:55] [config] quantize-log-based: false
[2023-06-20 15:17:55] [config] quantize-optimization-steps: 0
[2023-06-20 15:17:55] [config] quiet: false
[2023-06-20 15:17:55] [config] quiet-translation: false
[2023-06-20 15:17:55] [config] relative-paths: false
[2023-06-20 15:17:55] [config] right-left: false
[2023-06-20 15:17:55] [config] save-freq: 10000u
[2023-06-20 15:17:55] [config] seed: 1234
[2023-06-20 15:17:55] [config] sentencepiece-alphas:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:17:55] [config] sentencepiece-options: ""
[2023-06-20 15:17:55] [config] sharding: global
[2023-06-20 15:17:55] [config] shuffle: data
[2023-06-20 15:17:55] [config] shuffle-in-ram: false
[2023-06-20 15:17:55] [config] sigterm: save-and-exit
[2023-06-20 15:17:55] [config] skip: false
[2023-06-20 15:17:55] [config] sqlite: ""
[2023-06-20 15:17:55] [config] sqlite-drop: false
[2023-06-20 15:17:55] [config] sync-freq: 200u
[2023-06-20 15:17:55] [config] sync-sgd: false
[2023-06-20 15:17:55] [config] tempdir: /tmp
[2023-06-20 15:17:55] [config] tied-embeddings: false
[2023-06-20 15:17:55] [config] tied-embeddings-all: false
[2023-06-20 15:17:55] [config] tied-embeddings-src: false
[2023-06-20 15:17:55] [config] train-embedder-rank:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] train-sets:
[2023-06-20 15:17:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:17:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:17:55] [config] transformer-aan-activation: swish
[2023-06-20 15:17:55] [config] transformer-aan-depth: 2
[2023-06-20 15:17:55] [config] transformer-aan-nogate: false
[2023-06-20 15:17:55] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:17:55] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:17:55] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:17:55] [config] transformer-depth-scaling: false
[2023-06-20 15:17:55] [config] transformer-dim-aan: 2048
[2023-06-20 15:17:55] [config] transformer-dim-ffn: 2048
[2023-06-20 15:17:55] [config] transformer-dropout: 0
[2023-06-20 15:17:55] [config] transformer-dropout-attention: 0
[2023-06-20 15:17:55] [config] transformer-dropout-ffn: 0
[2023-06-20 15:17:55] [config] transformer-ffn-activation: swish
[2023-06-20 15:17:55] [config] transformer-ffn-depth: 2
[2023-06-20 15:17:55] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:17:55] [config] transformer-heads: 8
[2023-06-20 15:17:55] [config] transformer-no-projection: false
[2023-06-20 15:17:55] [config] transformer-pool: false
[2023-06-20 15:17:55] [config] transformer-postprocess: dan
[2023-06-20 15:17:55] [config] transformer-postprocess-emb: d
[2023-06-20 15:17:55] [config] transformer-postprocess-top: ""
[2023-06-20 15:17:55] [config] transformer-preprocess: ""
[2023-06-20 15:17:55] [config] transformer-tied-layers:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] transformer-train-position-embeddings: false
[2023-06-20 15:17:55] [config] tsv: false
[2023-06-20 15:17:55] [config] tsv-fields: 0
[2023-06-20 15:17:55] [config] type: amun
[2023-06-20 15:17:55] [config] ulr: false
[2023-06-20 15:17:55] [config] ulr-dim-emb: 0
[2023-06-20 15:17:55] [config] ulr-dropout: 0
[2023-06-20 15:17:55] [config] ulr-keys-vectors: ""
[2023-06-20 15:17:55] [config] ulr-query-vectors: ""
[2023-06-20 15:17:55] [config] ulr-softmax-temperature: 1
[2023-06-20 15:17:55] [config] ulr-trainable-transformation: false
[2023-06-20 15:17:55] [config] unlikelihood-loss: false
[2023-06-20 15:17:55] [config] valid-freq: 5000000
[2023-06-20 15:17:55] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:17:55] [config] valid-max-length: 1000
[2023-06-20 15:17:55] [config] valid-metrics:
[2023-06-20 15:17:55] [config]   - cross-entropy
[2023-06-20 15:17:55] [config] valid-mini-batch: 32
[2023-06-20 15:17:55] [config] valid-reset-stalled: false
[2023-06-20 15:17:55] [config] valid-script-args:
[2023-06-20 15:17:55] [config]   []
[2023-06-20 15:17:55] [config] valid-script-path: ""
[2023-06-20 15:17:55] [config] valid-sets:
[2023-06-20 15:17:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:17:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:17:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/gn_es_scored_june-epochs.txt
[2023-06-20 15:17:55] [config] vocabs:
[2023-06-20 15:17:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:17:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:17:55] [config] word-penalty: 0
[2023-06-20 15:17:55] [config] word-scores: false
[2023-06-20 15:17:55] [config] workspace: 2048
[2023-06-20 15:17:55] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:17:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:17:55] [training] Using single-device training
[2023-06-20 15:17:55] Synced seed 1234
[2023-06-20 15:17:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:17:55] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:17:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:17:55] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:17:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:17:56] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:17:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:17:56] [comm] Using global sharding
[2023-06-20 15:17:57] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:17:57] [training] Using 1 GPUs
[2023-06-20 15:17:57] Training started
[2023-06-20 15:17:57] [data] Shuffling data
[2023-06-20 15:17:57] [data] Done reading 20,192 sentences
[2023-06-20 15:17:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:17:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 15:17:57] [logits] Applying loss function for 1 factor(s)
[2023-06-20 15:17:57] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:17:58] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 15:17:58] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:17:58] Parameter type float32, optimization type float32, casting types false
[2023-06-20 15:17:58] Allocating memory for Adam-specific shards
[2023-06-20 15:17:58] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:18:38] Seen 18,843 samples
[2023-06-20 15:18:38] Starting data epoch 2 in logical epoch 2
[2023-06-20 15:18:38] Training finished
[2023-06-20 15:18:45] [valid] Ep. 2 : Up. 297 : cross-entropy : 128.187 : new best
[2023-06-20 15:18:45] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:18:49] Saving Adam parameters
[2023-06-20 15:18:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:23:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:23:23] [marian] Running on node18.datos.cluster.uy as process 34061 with command line:
[2023-06-20 15:23:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 15:23:23] [config] after: 0e
[2023-06-20 15:23:23] [config] after-batches: 0
[2023-06-20 15:23:23] [config] after-epochs: 1
[2023-06-20 15:23:23] [config] all-caps-every: 0
[2023-06-20 15:23:23] [config] allow-unk: false
[2023-06-20 15:23:23] [config] authors: false
[2023-06-20 15:23:23] [config] beam-size: 12
[2023-06-20 15:23:23] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:23:23] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:23:23] [config] bert-masking-fraction: 0.15
[2023-06-20 15:23:23] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:23:23] [config] bert-train-type-embeddings: true
[2023-06-20 15:23:23] [config] bert-type-vocab-size: 2
[2023-06-20 15:23:23] [config] build-info: ""
[2023-06-20 15:23:23] [config] check-gradient-nan: false
[2023-06-20 15:23:23] [config] check-nan: false
[2023-06-20 15:23:23] [config] cite: false
[2023-06-20 15:23:23] [config] clip-norm: 1
[2023-06-20 15:23:23] [config] cost-scaling:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] cost-type: ce-sum
[2023-06-20 15:23:23] [config] cpu-threads: 0
[2023-06-20 15:23:23] [config] data-threads: 8
[2023-06-20 15:23:23] [config] data-weighting: ""
[2023-06-20 15:23:23] [config] data-weighting-type: sentence
[2023-06-20 15:23:23] [config] dec-cell: gru
[2023-06-20 15:23:23] [config] dec-cell-base-depth: 2
[2023-06-20 15:23:23] [config] dec-cell-high-depth: 1
[2023-06-20 15:23:23] [config] dec-depth: 1
[2023-06-20 15:23:23] [config] devices:
[2023-06-20 15:23:23] [config]   - 0
[2023-06-20 15:23:23] [config] dim-emb: 512
[2023-06-20 15:23:23] [config] dim-rnn: 1024
[2023-06-20 15:23:23] [config] dim-vocabs:
[2023-06-20 15:23:23] [config]   - 0
[2023-06-20 15:23:23] [config]   - 0
[2023-06-20 15:23:23] [config] disp-first: 0
[2023-06-20 15:23:23] [config] disp-freq: 1000u
[2023-06-20 15:23:23] [config] disp-label-counts: true
[2023-06-20 15:23:23] [config] dropout-rnn: 0
[2023-06-20 15:23:23] [config] dropout-src: 0
[2023-06-20 15:23:23] [config] dropout-trg: 0
[2023-06-20 15:23:23] [config] dump-config: ""
[2023-06-20 15:23:23] [config] dynamic-gradient-scaling:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] early-stopping: 10
[2023-06-20 15:23:23] [config] early-stopping-on: first
[2023-06-20 15:23:23] [config] embedding-fix-src: false
[2023-06-20 15:23:23] [config] embedding-fix-trg: false
[2023-06-20 15:23:23] [config] embedding-normalization: false
[2023-06-20 15:23:23] [config] embedding-vectors:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] enc-cell: gru
[2023-06-20 15:23:23] [config] enc-cell-depth: 1
[2023-06-20 15:23:23] [config] enc-depth: 1
[2023-06-20 15:23:23] [config] enc-type: bidirectional
[2023-06-20 15:23:23] [config] english-title-case-every: 0
[2023-06-20 15:23:23] [config] exponential-smoothing: 0
[2023-06-20 15:23:23] [config] factor-weight: 1
[2023-06-20 15:23:23] [config] factors-combine: sum
[2023-06-20 15:23:23] [config] factors-dim-emb: 0
[2023-06-20 15:23:23] [config] gradient-checkpointing: false
[2023-06-20 15:23:23] [config] gradient-norm-average-window: 100
[2023-06-20 15:23:23] [config] guided-alignment: none
[2023-06-20 15:23:23] [config] guided-alignment-cost: mse
[2023-06-20 15:23:23] [config] guided-alignment-weight: 0.1
[2023-06-20 15:23:23] [config] ignore-model-config: false
[2023-06-20 15:23:23] [config] input-types:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] interpolate-env-vars: false
[2023-06-20 15:23:23] [config] keep-best: false
[2023-06-20 15:23:23] [config] label-smoothing: 0
[2023-06-20 15:23:23] [config] layer-normalization: false
[2023-06-20 15:23:23] [config] learn-rate: 0.0001
[2023-06-20 15:23:23] [config] lemma-dependency: ""
[2023-06-20 15:23:23] [config] lemma-dim-emb: 0
[2023-06-20 15:23:23] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:23:23] [config] log-level: info
[2023-06-20 15:23:23] [config] log-time-zone: ""
[2023-06-20 15:23:23] [config] logical-epoch:
[2023-06-20 15:23:23] [config]   - 1e
[2023-06-20 15:23:23] [config]   - 0
[2023-06-20 15:23:23] [config] lr-decay: 0
[2023-06-20 15:23:23] [config] lr-decay-freq: 50000
[2023-06-20 15:23:23] [config] lr-decay-inv-sqrt:
[2023-06-20 15:23:23] [config]   - 0
[2023-06-20 15:23:23] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:23:23] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:23:23] [config] lr-decay-start:
[2023-06-20 15:23:23] [config]   - 10
[2023-06-20 15:23:23] [config]   - 1
[2023-06-20 15:23:23] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:23:23] [config] lr-report: false
[2023-06-20 15:23:23] [config] lr-warmup: 0
[2023-06-20 15:23:23] [config] lr-warmup-at-reload: false
[2023-06-20 15:23:23] [config] lr-warmup-cycle: false
[2023-06-20 15:23:23] [config] lr-warmup-start-rate: 0
[2023-06-20 15:23:23] [config] max-length: 50
[2023-06-20 15:23:23] [config] max-length-crop: false
[2023-06-20 15:23:23] [config] max-length-factor: 3
[2023-06-20 15:23:23] [config] maxi-batch: 100
[2023-06-20 15:23:23] [config] maxi-batch-sort: trg
[2023-06-20 15:23:23] [config] mini-batch: 64
[2023-06-20 15:23:23] [config] mini-batch-fit: false
[2023-06-20 15:23:23] [config] mini-batch-fit-step: 10
[2023-06-20 15:23:23] [config] mini-batch-round-up: true
[2023-06-20 15:23:23] [config] mini-batch-track-lr: false
[2023-06-20 15:23:23] [config] mini-batch-warmup: 0
[2023-06-20 15:23:23] [config] mini-batch-words: 0
[2023-06-20 15:23:23] [config] mini-batch-words-ref: 0
[2023-06-20 15:23:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:23:23] [config] multi-loss-type: sum
[2023-06-20 15:23:23] [config] n-best: false
[2023-06-20 15:23:23] [config] no-nccl: false
[2023-06-20 15:23:23] [config] no-reload: false
[2023-06-20 15:23:23] [config] no-restore-corpus: false
[2023-06-20 15:23:23] [config] normalize: 0
[2023-06-20 15:23:23] [config] normalize-gradient: false
[2023-06-20 15:23:23] [config] num-devices: 0
[2023-06-20 15:23:23] [config] optimizer: adam
[2023-06-20 15:23:23] [config] optimizer-delay: 1
[2023-06-20 15:23:23] [config] optimizer-params:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] output-omit-bias: false
[2023-06-20 15:23:23] [config] overwrite: false
[2023-06-20 15:23:23] [config] precision:
[2023-06-20 15:23:23] [config]   - float32
[2023-06-20 15:23:23] [config]   - float32
[2023-06-20 15:23:23] [config] pretrained-model: ""
[2023-06-20 15:23:23] [config] quantize-biases: false
[2023-06-20 15:23:23] [config] quantize-bits: 0
[2023-06-20 15:23:23] [config] quantize-log-based: false
[2023-06-20 15:23:23] [config] quantize-optimization-steps: 0
[2023-06-20 15:23:23] [config] quiet: false
[2023-06-20 15:23:23] [config] quiet-translation: false
[2023-06-20 15:23:23] [config] relative-paths: false
[2023-06-20 15:23:23] [config] right-left: false
[2023-06-20 15:23:23] [config] save-freq: 10000u
[2023-06-20 15:23:23] [config] seed: 1234
[2023-06-20 15:23:23] [config] sentencepiece-alphas:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:23:23] [config] sentencepiece-options: ""
[2023-06-20 15:23:23] [config] sharding: global
[2023-06-20 15:23:23] [config] shuffle: data
[2023-06-20 15:23:23] [config] shuffle-in-ram: false
[2023-06-20 15:23:23] [config] sigterm: save-and-exit
[2023-06-20 15:23:23] [config] skip: false
[2023-06-20 15:23:23] [config] sqlite: ""
[2023-06-20 15:23:23] [config] sqlite-drop: false
[2023-06-20 15:23:23] [config] sync-freq: 200u
[2023-06-20 15:23:23] [config] sync-sgd: false
[2023-06-20 15:23:23] [config] tempdir: /tmp
[2023-06-20 15:23:23] [config] tied-embeddings: false
[2023-06-20 15:23:23] [config] tied-embeddings-all: false
[2023-06-20 15:23:23] [config] tied-embeddings-src: false
[2023-06-20 15:23:23] [config] train-embedder-rank:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] train-sets:
[2023-06-20 15:23:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:23:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:23:23] [config] transformer-aan-activation: swish
[2023-06-20 15:23:23] [config] transformer-aan-depth: 2
[2023-06-20 15:23:23] [config] transformer-aan-nogate: false
[2023-06-20 15:23:23] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:23:23] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:23:23] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:23:23] [config] transformer-depth-scaling: false
[2023-06-20 15:23:23] [config] transformer-dim-aan: 2048
[2023-06-20 15:23:23] [config] transformer-dim-ffn: 2048
[2023-06-20 15:23:23] [config] transformer-dropout: 0
[2023-06-20 15:23:23] [config] transformer-dropout-attention: 0
[2023-06-20 15:23:23] [config] transformer-dropout-ffn: 0
[2023-06-20 15:23:23] [config] transformer-ffn-activation: swish
[2023-06-20 15:23:23] [config] transformer-ffn-depth: 2
[2023-06-20 15:23:23] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:23:23] [config] transformer-heads: 8
[2023-06-20 15:23:23] [config] transformer-no-projection: false
[2023-06-20 15:23:23] [config] transformer-pool: false
[2023-06-20 15:23:23] [config] transformer-postprocess: dan
[2023-06-20 15:23:23] [config] transformer-postprocess-emb: d
[2023-06-20 15:23:23] [config] transformer-postprocess-top: ""
[2023-06-20 15:23:23] [config] transformer-preprocess: ""
[2023-06-20 15:23:23] [config] transformer-tied-layers:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] transformer-train-position-embeddings: false
[2023-06-20 15:23:23] [config] tsv: false
[2023-06-20 15:23:23] [config] tsv-fields: 0
[2023-06-20 15:23:23] [config] type: amun
[2023-06-20 15:23:23] [config] ulr: false
[2023-06-20 15:23:23] [config] ulr-dim-emb: 0
[2023-06-20 15:23:23] [config] ulr-dropout: 0
[2023-06-20 15:23:23] [config] ulr-keys-vectors: ""
[2023-06-20 15:23:23] [config] ulr-query-vectors: ""
[2023-06-20 15:23:23] [config] ulr-softmax-temperature: 1
[2023-06-20 15:23:23] [config] ulr-trainable-transformation: false
[2023-06-20 15:23:23] [config] unlikelihood-loss: false
[2023-06-20 15:23:23] [config] valid-freq: 5000000
[2023-06-20 15:23:23] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:23:23] [config] valid-max-length: 1000
[2023-06-20 15:23:23] [config] valid-metrics:
[2023-06-20 15:23:23] [config]   - cross-entropy
[2023-06-20 15:23:23] [config] valid-mini-batch: 32
[2023-06-20 15:23:23] [config] valid-reset-stalled: false
[2023-06-20 15:23:23] [config] valid-script-args:
[2023-06-20 15:23:23] [config]   []
[2023-06-20 15:23:23] [config] valid-script-path: ""
[2023-06-20 15:23:23] [config] valid-sets:
[2023-06-20 15:23:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:23:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:23:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 15:23:23] [config] vocabs:
[2023-06-20 15:23:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:23:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:23:23] [config] word-penalty: 0
[2023-06-20 15:23:23] [config] word-scores: false
[2023-06-20 15:23:23] [config] workspace: 2048
[2023-06-20 15:23:23] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:23:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:23:23] [training] Using single-device training
[2023-06-20 15:23:23] Synced seed 1234
[2023-06-20 15:23:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:23:23] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:23:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:23:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:23:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:23:24] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:23:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:23:24] [comm] Using global sharding
[2023-06-20 15:23:24] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:23:24] [training] Using 1 GPUs
[2023-06-20 15:23:24] Training started
[2023-06-20 15:23:24] [data] Shuffling data
[2023-06-20 15:23:24] [data] Done reading 20,192 sentences
[2023-06-20 15:23:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:23:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 15:23:24] [logits] Applying loss function for 1 factor(s)
[2023-06-20 15:23:24] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:23:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 15:23:26] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:23:26] Parameter type float32, optimization type float32, casting types false
[2023-06-20 15:23:26] Allocating memory for Adam-specific shards
[2023-06-20 15:23:26] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:24:05] Seen 18,843 samples
[2023-06-20 15:24:05] Starting data epoch 2 in logical epoch 2
[2023-06-20 15:24:05] Training finished
[2023-06-20 15:24:11] [valid] Ep. 2 : Up. 297 : cross-entropy : 128.188 : new best
[2023-06-20 15:24:11] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:24:14] Saving Adam parameters
[2023-06-20 15:24:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:25:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:25:46] [marian] Running on node18.datos.cluster.uy as process 34310 with command line:
[2023-06-20 15:25:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 15:25:46] [config] after: 0e
[2023-06-20 15:25:46] [config] after-batches: 0
[2023-06-20 15:25:46] [config] after-epochs: 1
[2023-06-20 15:25:46] [config] all-caps-every: 0
[2023-06-20 15:25:46] [config] allow-unk: false
[2023-06-20 15:25:46] [config] authors: false
[2023-06-20 15:25:46] [config] beam-size: 12
[2023-06-20 15:25:46] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:25:46] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:25:46] [config] bert-masking-fraction: 0.15
[2023-06-20 15:25:46] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:25:46] [config] bert-train-type-embeddings: true
[2023-06-20 15:25:46] [config] bert-type-vocab-size: 2
[2023-06-20 15:25:46] [config] build-info: ""
[2023-06-20 15:25:46] [config] check-gradient-nan: false
[2023-06-20 15:25:46] [config] check-nan: false
[2023-06-20 15:25:46] [config] cite: false
[2023-06-20 15:25:46] [config] clip-norm: 1
[2023-06-20 15:25:46] [config] cost-scaling:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] cost-type: ce-sum
[2023-06-20 15:25:46] [config] cpu-threads: 0
[2023-06-20 15:25:46] [config] data-threads: 8
[2023-06-20 15:25:46] [config] data-weighting: ""
[2023-06-20 15:25:46] [config] data-weighting-type: sentence
[2023-06-20 15:25:46] [config] dec-cell: gru
[2023-06-20 15:25:46] [config] dec-cell-base-depth: 2
[2023-06-20 15:25:46] [config] dec-cell-high-depth: 1
[2023-06-20 15:25:46] [config] dec-depth: 1
[2023-06-20 15:25:46] [config] devices:
[2023-06-20 15:25:46] [config]   - 0
[2023-06-20 15:25:46] [config] dim-emb: 512
[2023-06-20 15:25:46] [config] dim-rnn: 1024
[2023-06-20 15:25:46] [config] dim-vocabs:
[2023-06-20 15:25:46] [config]   - 0
[2023-06-20 15:25:46] [config]   - 0
[2023-06-20 15:25:46] [config] disp-first: 0
[2023-06-20 15:25:46] [config] disp-freq: 1000u
[2023-06-20 15:25:46] [config] disp-label-counts: true
[2023-06-20 15:25:46] [config] dropout-rnn: 0
[2023-06-20 15:25:46] [config] dropout-src: 0
[2023-06-20 15:25:46] [config] dropout-trg: 0
[2023-06-20 15:25:46] [config] dump-config: ""
[2023-06-20 15:25:46] [config] dynamic-gradient-scaling:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] early-stopping: 10
[2023-06-20 15:25:46] [config] early-stopping-on: first
[2023-06-20 15:25:46] [config] embedding-fix-src: false
[2023-06-20 15:25:46] [config] embedding-fix-trg: false
[2023-06-20 15:25:46] [config] embedding-normalization: false
[2023-06-20 15:25:46] [config] embedding-vectors:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] enc-cell: gru
[2023-06-20 15:25:46] [config] enc-cell-depth: 1
[2023-06-20 15:25:46] [config] enc-depth: 1
[2023-06-20 15:25:46] [config] enc-type: bidirectional
[2023-06-20 15:25:46] [config] english-title-case-every: 0
[2023-06-20 15:25:46] [config] exponential-smoothing: 0
[2023-06-20 15:25:46] [config] factor-weight: 1
[2023-06-20 15:25:46] [config] factors-combine: sum
[2023-06-20 15:25:46] [config] factors-dim-emb: 0
[2023-06-20 15:25:46] [config] gradient-checkpointing: false
[2023-06-20 15:25:46] [config] gradient-norm-average-window: 100
[2023-06-20 15:25:46] [config] guided-alignment: none
[2023-06-20 15:25:46] [config] guided-alignment-cost: mse
[2023-06-20 15:25:46] [config] guided-alignment-weight: 0.1
[2023-06-20 15:25:46] [config] ignore-model-config: false
[2023-06-20 15:25:46] [config] input-types:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] interpolate-env-vars: false
[2023-06-20 15:25:46] [config] keep-best: false
[2023-06-20 15:25:46] [config] label-smoothing: 0
[2023-06-20 15:25:46] [config] layer-normalization: false
[2023-06-20 15:25:46] [config] learn-rate: 0.0001
[2023-06-20 15:25:46] [config] lemma-dependency: ""
[2023-06-20 15:25:46] [config] lemma-dim-emb: 0
[2023-06-20 15:25:46] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:25:46] [config] log-level: info
[2023-06-20 15:25:46] [config] log-time-zone: ""
[2023-06-20 15:25:46] [config] logical-epoch:
[2023-06-20 15:25:46] [config]   - 1e
[2023-06-20 15:25:46] [config]   - 0
[2023-06-20 15:25:46] [config] lr-decay: 0
[2023-06-20 15:25:46] [config] lr-decay-freq: 50000
[2023-06-20 15:25:46] [config] lr-decay-inv-sqrt:
[2023-06-20 15:25:46] [config]   - 0
[2023-06-20 15:25:46] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:25:46] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:25:46] [config] lr-decay-start:
[2023-06-20 15:25:46] [config]   - 10
[2023-06-20 15:25:46] [config]   - 1
[2023-06-20 15:25:46] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:25:46] [config] lr-report: false
[2023-06-20 15:25:46] [config] lr-warmup: 0
[2023-06-20 15:25:46] [config] lr-warmup-at-reload: false
[2023-06-20 15:25:46] [config] lr-warmup-cycle: false
[2023-06-20 15:25:46] [config] lr-warmup-start-rate: 0
[2023-06-20 15:25:46] [config] max-length: 50
[2023-06-20 15:25:46] [config] max-length-crop: false
[2023-06-20 15:25:46] [config] max-length-factor: 3
[2023-06-20 15:25:46] [config] maxi-batch: 100
[2023-06-20 15:25:46] [config] maxi-batch-sort: trg
[2023-06-20 15:25:46] [config] mini-batch: 64
[2023-06-20 15:25:46] [config] mini-batch-fit: false
[2023-06-20 15:25:46] [config] mini-batch-fit-step: 10
[2023-06-20 15:25:46] [config] mini-batch-round-up: true
[2023-06-20 15:25:46] [config] mini-batch-track-lr: false
[2023-06-20 15:25:46] [config] mini-batch-warmup: 0
[2023-06-20 15:25:46] [config] mini-batch-words: 0
[2023-06-20 15:25:46] [config] mini-batch-words-ref: 0
[2023-06-20 15:25:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:25:46] [config] multi-loss-type: sum
[2023-06-20 15:25:46] [config] n-best: false
[2023-06-20 15:25:46] [config] no-nccl: false
[2023-06-20 15:25:46] [config] no-reload: false
[2023-06-20 15:25:46] [config] no-restore-corpus: false
[2023-06-20 15:25:46] [config] normalize: 0
[2023-06-20 15:25:46] [config] normalize-gradient: false
[2023-06-20 15:25:46] [config] num-devices: 0
[2023-06-20 15:25:46] [config] optimizer: adam
[2023-06-20 15:25:46] [config] optimizer-delay: 1
[2023-06-20 15:25:46] [config] optimizer-params:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] output-omit-bias: false
[2023-06-20 15:25:46] [config] overwrite: false
[2023-06-20 15:25:46] [config] precision:
[2023-06-20 15:25:46] [config]   - float32
[2023-06-20 15:25:46] [config]   - float32
[2023-06-20 15:25:46] [config] pretrained-model: ""
[2023-06-20 15:25:46] [config] quantize-biases: false
[2023-06-20 15:25:46] [config] quantize-bits: 0
[2023-06-20 15:25:46] [config] quantize-log-based: false
[2023-06-20 15:25:46] [config] quantize-optimization-steps: 0
[2023-06-20 15:25:46] [config] quiet: false
[2023-06-20 15:25:46] [config] quiet-translation: true
[2023-06-20 15:25:46] [config] relative-paths: false
[2023-06-20 15:25:46] [config] right-left: false
[2023-06-20 15:25:46] [config] save-freq: 10000u
[2023-06-20 15:25:46] [config] seed: 1234
[2023-06-20 15:25:46] [config] sentencepiece-alphas:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:25:46] [config] sentencepiece-options: ""
[2023-06-20 15:25:46] [config] sharding: global
[2023-06-20 15:25:46] [config] shuffle: data
[2023-06-20 15:25:46] [config] shuffle-in-ram: false
[2023-06-20 15:25:46] [config] sigterm: save-and-exit
[2023-06-20 15:25:46] [config] skip: false
[2023-06-20 15:25:46] [config] sqlite: ""
[2023-06-20 15:25:46] [config] sqlite-drop: false
[2023-06-20 15:25:46] [config] sync-freq: 200u
[2023-06-20 15:25:46] [config] sync-sgd: false
[2023-06-20 15:25:46] [config] tempdir: /tmp
[2023-06-20 15:25:46] [config] tied-embeddings: false
[2023-06-20 15:25:46] [config] tied-embeddings-all: false
[2023-06-20 15:25:46] [config] tied-embeddings-src: false
[2023-06-20 15:25:46] [config] train-embedder-rank:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] train-sets:
[2023-06-20 15:25:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:25:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:25:46] [config] transformer-aan-activation: swish
[2023-06-20 15:25:46] [config] transformer-aan-depth: 2
[2023-06-20 15:25:46] [config] transformer-aan-nogate: false
[2023-06-20 15:25:46] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:25:46] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:25:46] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:25:46] [config] transformer-depth-scaling: false
[2023-06-20 15:25:46] [config] transformer-dim-aan: 2048
[2023-06-20 15:25:46] [config] transformer-dim-ffn: 2048
[2023-06-20 15:25:46] [config] transformer-dropout: 0
[2023-06-20 15:25:46] [config] transformer-dropout-attention: 0
[2023-06-20 15:25:46] [config] transformer-dropout-ffn: 0
[2023-06-20 15:25:46] [config] transformer-ffn-activation: swish
[2023-06-20 15:25:46] [config] transformer-ffn-depth: 2
[2023-06-20 15:25:46] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:25:46] [config] transformer-heads: 8
[2023-06-20 15:25:46] [config] transformer-no-projection: false
[2023-06-20 15:25:46] [config] transformer-pool: false
[2023-06-20 15:25:46] [config] transformer-postprocess: dan
[2023-06-20 15:25:46] [config] transformer-postprocess-emb: d
[2023-06-20 15:25:46] [config] transformer-postprocess-top: ""
[2023-06-20 15:25:46] [config] transformer-preprocess: ""
[2023-06-20 15:25:46] [config] transformer-tied-layers:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] transformer-train-position-embeddings: false
[2023-06-20 15:25:46] [config] tsv: false
[2023-06-20 15:25:46] [config] tsv-fields: 0
[2023-06-20 15:25:46] [config] type: amun
[2023-06-20 15:25:46] [config] ulr: false
[2023-06-20 15:25:46] [config] ulr-dim-emb: 0
[2023-06-20 15:25:46] [config] ulr-dropout: 0
[2023-06-20 15:25:46] [config] ulr-keys-vectors: ""
[2023-06-20 15:25:46] [config] ulr-query-vectors: ""
[2023-06-20 15:25:46] [config] ulr-softmax-temperature: 1
[2023-06-20 15:25:46] [config] ulr-trainable-transformation: false
[2023-06-20 15:25:46] [config] unlikelihood-loss: false
[2023-06-20 15:25:46] [config] valid-freq: 5000000
[2023-06-20 15:25:46] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:25:46] [config] valid-max-length: 1000
[2023-06-20 15:25:46] [config] valid-metrics:
[2023-06-20 15:25:46] [config]   - cross-entropy
[2023-06-20 15:25:46] [config] valid-mini-batch: 32
[2023-06-20 15:25:46] [config] valid-reset-stalled: false
[2023-06-20 15:25:46] [config] valid-script-args:
[2023-06-20 15:25:46] [config]   []
[2023-06-20 15:25:46] [config] valid-script-path: ""
[2023-06-20 15:25:46] [config] valid-sets:
[2023-06-20 15:25:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:25:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:25:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 15:25:46] [config] vocabs:
[2023-06-20 15:25:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:25:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:25:46] [config] word-penalty: 0
[2023-06-20 15:25:46] [config] word-scores: false
[2023-06-20 15:25:46] [config] workspace: 2048
[2023-06-20 15:25:46] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:25:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:25:46] [training] Using single-device training
[2023-06-20 15:25:47] Synced seed 1234
[2023-06-20 15:25:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:25:47] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:25:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:25:47] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:25:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:25:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:25:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:25:48] [comm] Using global sharding
[2023-06-20 15:25:48] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:25:48] [training] Using 1 GPUs
[2023-06-20 15:25:48] Training started
[2023-06-20 15:25:48] [data] Shuffling data
[2023-06-20 15:25:48] [data] Done reading 20,192 sentences
[2023-06-20 15:25:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:25:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 15:25:48] [logits] Applying loss function for 1 factor(s)
[2023-06-20 15:25:48] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:25:50] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 15:25:50] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:25:50] Parameter type float32, optimization type float32, casting types false
[2023-06-20 15:25:50] Allocating memory for Adam-specific shards
[2023-06-20 15:25:50] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:26:32] Seen 18,843 samples
[2023-06-20 15:26:32] Starting data epoch 2 in logical epoch 2
[2023-06-20 15:26:32] Training finished
[2023-06-20 15:26:40] [valid] Ep. 2 : Up. 297 : cross-entropy : 128.186 : new best
[2023-06-20 15:26:40] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:26:44] Saving Adam parameters
[2023-06-20 15:26:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:43:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:43:21] [marian] Running on node18.datos.cluster.uy as process 35682 with command line:
[2023-06-20 15:43:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 15:43:22] [config] after: 0e
[2023-06-20 15:43:22] [config] after-batches: 0
[2023-06-20 15:43:22] [config] after-epochs: 1
[2023-06-20 15:43:22] [config] all-caps-every: 0
[2023-06-20 15:43:22] [config] allow-unk: false
[2023-06-20 15:43:22] [config] authors: false
[2023-06-20 15:43:22] [config] beam-size: 12
[2023-06-20 15:43:22] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:43:22] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:43:22] [config] bert-masking-fraction: 0.15
[2023-06-20 15:43:22] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:43:22] [config] bert-train-type-embeddings: true
[2023-06-20 15:43:22] [config] bert-type-vocab-size: 2
[2023-06-20 15:43:22] [config] build-info: ""
[2023-06-20 15:43:22] [config] check-gradient-nan: false
[2023-06-20 15:43:22] [config] check-nan: false
[2023-06-20 15:43:22] [config] cite: false
[2023-06-20 15:43:22] [config] clip-norm: 1
[2023-06-20 15:43:22] [config] cost-scaling:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] cost-type: ce-sum
[2023-06-20 15:43:22] [config] cpu-threads: 0
[2023-06-20 15:43:22] [config] data-threads: 8
[2023-06-20 15:43:22] [config] data-weighting: ""
[2023-06-20 15:43:22] [config] data-weighting-type: sentence
[2023-06-20 15:43:22] [config] dec-cell: gru
[2023-06-20 15:43:22] [config] dec-cell-base-depth: 2
[2023-06-20 15:43:22] [config] dec-cell-high-depth: 1
[2023-06-20 15:43:22] [config] dec-depth: 1
[2023-06-20 15:43:22] [config] devices:
[2023-06-20 15:43:22] [config]   - 0
[2023-06-20 15:43:22] [config] dim-emb: 512
[2023-06-20 15:43:22] [config] dim-rnn: 1024
[2023-06-20 15:43:22] [config] dim-vocabs:
[2023-06-20 15:43:22] [config]   - 54042
[2023-06-20 15:43:22] [config]   - 36507
[2023-06-20 15:43:22] [config] disp-first: 0
[2023-06-20 15:43:22] [config] disp-freq: 1000u
[2023-06-20 15:43:22] [config] disp-label-counts: true
[2023-06-20 15:43:22] [config] dropout-rnn: 0
[2023-06-20 15:43:22] [config] dropout-src: 0
[2023-06-20 15:43:22] [config] dropout-trg: 0
[2023-06-20 15:43:22] [config] dump-config: ""
[2023-06-20 15:43:22] [config] dynamic-gradient-scaling:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] early-stopping: 10
[2023-06-20 15:43:22] [config] early-stopping-on: first
[2023-06-20 15:43:22] [config] embedding-fix-src: false
[2023-06-20 15:43:22] [config] embedding-fix-trg: false
[2023-06-20 15:43:22] [config] embedding-normalization: false
[2023-06-20 15:43:22] [config] embedding-vectors:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] enc-cell: gru
[2023-06-20 15:43:22] [config] enc-cell-depth: 1
[2023-06-20 15:43:22] [config] enc-depth: 1
[2023-06-20 15:43:22] [config] enc-type: bidirectional
[2023-06-20 15:43:22] [config] english-title-case-every: 0
[2023-06-20 15:43:22] [config] exponential-smoothing: 0
[2023-06-20 15:43:22] [config] factor-weight: 1
[2023-06-20 15:43:22] [config] factors-combine: sum
[2023-06-20 15:43:22] [config] factors-dim-emb: 0
[2023-06-20 15:43:22] [config] gradient-checkpointing: false
[2023-06-20 15:43:22] [config] gradient-norm-average-window: 100
[2023-06-20 15:43:22] [config] guided-alignment: none
[2023-06-20 15:43:22] [config] guided-alignment-cost: mse
[2023-06-20 15:43:22] [config] guided-alignment-weight: 0.1
[2023-06-20 15:43:22] [config] ignore-model-config: false
[2023-06-20 15:43:22] [config] input-types:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] interpolate-env-vars: false
[2023-06-20 15:43:22] [config] keep-best: false
[2023-06-20 15:43:22] [config] label-smoothing: 0
[2023-06-20 15:43:22] [config] layer-normalization: false
[2023-06-20 15:43:22] [config] learn-rate: 0.0001
[2023-06-20 15:43:22] [config] lemma-dependency: ""
[2023-06-20 15:43:22] [config] lemma-dim-emb: 0
[2023-06-20 15:43:22] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:43:22] [config] log-level: info
[2023-06-20 15:43:22] [config] log-time-zone: ""
[2023-06-20 15:43:22] [config] logical-epoch:
[2023-06-20 15:43:22] [config]   - 1e
[2023-06-20 15:43:22] [config]   - 0
[2023-06-20 15:43:22] [config] lr-decay: 0
[2023-06-20 15:43:22] [config] lr-decay-freq: 50000
[2023-06-20 15:43:22] [config] lr-decay-inv-sqrt:
[2023-06-20 15:43:22] [config]   - 0
[2023-06-20 15:43:22] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:43:22] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:43:22] [config] lr-decay-start:
[2023-06-20 15:43:22] [config]   - 10
[2023-06-20 15:43:22] [config]   - 1
[2023-06-20 15:43:22] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:43:22] [config] lr-report: false
[2023-06-20 15:43:22] [config] lr-warmup: 0
[2023-06-20 15:43:22] [config] lr-warmup-at-reload: false
[2023-06-20 15:43:22] [config] lr-warmup-cycle: false
[2023-06-20 15:43:22] [config] lr-warmup-start-rate: 0
[2023-06-20 15:43:22] [config] max-length: 50
[2023-06-20 15:43:22] [config] max-length-crop: false
[2023-06-20 15:43:22] [config] max-length-factor: 3
[2023-06-20 15:43:22] [config] maxi-batch: 100
[2023-06-20 15:43:22] [config] maxi-batch-sort: trg
[2023-06-20 15:43:22] [config] mini-batch: 64
[2023-06-20 15:43:22] [config] mini-batch-fit: false
[2023-06-20 15:43:22] [config] mini-batch-fit-step: 10
[2023-06-20 15:43:22] [config] mini-batch-round-up: true
[2023-06-20 15:43:22] [config] mini-batch-track-lr: false
[2023-06-20 15:43:22] [config] mini-batch-warmup: 0
[2023-06-20 15:43:22] [config] mini-batch-words: 0
[2023-06-20 15:43:22] [config] mini-batch-words-ref: 0
[2023-06-20 15:43:22] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:43:22] [config] multi-loss-type: sum
[2023-06-20 15:43:22] [config] n-best: false
[2023-06-20 15:43:22] [config] no-nccl: false
[2023-06-20 15:43:22] [config] no-reload: false
[2023-06-20 15:43:22] [config] no-restore-corpus: false
[2023-06-20 15:43:22] [config] normalize: 0
[2023-06-20 15:43:22] [config] normalize-gradient: false
[2023-06-20 15:43:22] [config] num-devices: 0
[2023-06-20 15:43:22] [config] optimizer: adam
[2023-06-20 15:43:22] [config] optimizer-delay: 1
[2023-06-20 15:43:22] [config] optimizer-params:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] output-omit-bias: false
[2023-06-20 15:43:22] [config] overwrite: false
[2023-06-20 15:43:22] [config] precision:
[2023-06-20 15:43:22] [config]   - float32
[2023-06-20 15:43:22] [config]   - float32
[2023-06-20 15:43:22] [config] pretrained-model: ""
[2023-06-20 15:43:22] [config] quantize-biases: false
[2023-06-20 15:43:22] [config] quantize-bits: 0
[2023-06-20 15:43:22] [config] quantize-log-based: false
[2023-06-20 15:43:22] [config] quantize-optimization-steps: 0
[2023-06-20 15:43:22] [config] quiet: false
[2023-06-20 15:43:22] [config] quiet-translation: true
[2023-06-20 15:43:22] [config] relative-paths: false
[2023-06-20 15:43:22] [config] right-left: false
[2023-06-20 15:43:22] [config] save-freq: 10000u
[2023-06-20 15:43:22] [config] seed: 1234
[2023-06-20 15:43:22] [config] sentencepiece-alphas:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:43:22] [config] sentencepiece-options: ""
[2023-06-20 15:43:22] [config] sharding: global
[2023-06-20 15:43:22] [config] shuffle: data
[2023-06-20 15:43:22] [config] shuffle-in-ram: false
[2023-06-20 15:43:22] [config] sigterm: save-and-exit
[2023-06-20 15:43:22] [config] skip: false
[2023-06-20 15:43:22] [config] sqlite: ""
[2023-06-20 15:43:22] [config] sqlite-drop: false
[2023-06-20 15:43:22] [config] sync-freq: 200u
[2023-06-20 15:43:22] [config] sync-sgd: false
[2023-06-20 15:43:22] [config] tempdir: /tmp
[2023-06-20 15:43:22] [config] tied-embeddings: false
[2023-06-20 15:43:22] [config] tied-embeddings-all: false
[2023-06-20 15:43:22] [config] tied-embeddings-src: false
[2023-06-20 15:43:22] [config] train-embedder-rank:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] train-sets:
[2023-06-20 15:43:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:43:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:43:22] [config] transformer-aan-activation: swish
[2023-06-20 15:43:22] [config] transformer-aan-depth: 2
[2023-06-20 15:43:22] [config] transformer-aan-nogate: false
[2023-06-20 15:43:22] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:43:22] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:43:22] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:43:22] [config] transformer-depth-scaling: false
[2023-06-20 15:43:22] [config] transformer-dim-aan: 2048
[2023-06-20 15:43:22] [config] transformer-dim-ffn: 2048
[2023-06-20 15:43:22] [config] transformer-dropout: 0
[2023-06-20 15:43:22] [config] transformer-dropout-attention: 0
[2023-06-20 15:43:22] [config] transformer-dropout-ffn: 0
[2023-06-20 15:43:22] [config] transformer-ffn-activation: swish
[2023-06-20 15:43:22] [config] transformer-ffn-depth: 2
[2023-06-20 15:43:22] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:43:22] [config] transformer-heads: 8
[2023-06-20 15:43:22] [config] transformer-no-projection: false
[2023-06-20 15:43:22] [config] transformer-pool: false
[2023-06-20 15:43:22] [config] transformer-postprocess: dan
[2023-06-20 15:43:22] [config] transformer-postprocess-emb: d
[2023-06-20 15:43:22] [config] transformer-postprocess-top: ""
[2023-06-20 15:43:22] [config] transformer-preprocess: ""
[2023-06-20 15:43:22] [config] transformer-tied-layers:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] transformer-train-position-embeddings: false
[2023-06-20 15:43:22] [config] tsv: false
[2023-06-20 15:43:22] [config] tsv-fields: 0
[2023-06-20 15:43:22] [config] type: amun
[2023-06-20 15:43:22] [config] ulr: false
[2023-06-20 15:43:22] [config] ulr-dim-emb: 0
[2023-06-20 15:43:22] [config] ulr-dropout: 0
[2023-06-20 15:43:22] [config] ulr-keys-vectors: ""
[2023-06-20 15:43:22] [config] ulr-query-vectors: ""
[2023-06-20 15:43:22] [config] ulr-softmax-temperature: 1
[2023-06-20 15:43:22] [config] ulr-trainable-transformation: false
[2023-06-20 15:43:22] [config] unlikelihood-loss: false
[2023-06-20 15:43:22] [config] valid-freq: 5000000
[2023-06-20 15:43:22] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:43:22] [config] valid-max-length: 1000
[2023-06-20 15:43:22] [config] valid-metrics:
[2023-06-20 15:43:22] [config]   - cross-entropy
[2023-06-20 15:43:22] [config] valid-mini-batch: 32
[2023-06-20 15:43:22] [config] valid-reset-stalled: false
[2023-06-20 15:43:22] [config] valid-script-args:
[2023-06-20 15:43:22] [config]   []
[2023-06-20 15:43:22] [config] valid-script-path: ""
[2023-06-20 15:43:22] [config] valid-sets:
[2023-06-20 15:43:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:43:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:43:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 15:43:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:43:22] [config] vocabs:
[2023-06-20 15:43:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:43:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:43:22] [config] word-penalty: 0
[2023-06-20 15:43:22] [config] word-scores: false
[2023-06-20 15:43:22] [config] workspace: 2048
[2023-06-20 15:43:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:43:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:43:22] [training] Using single-device training
[2023-06-20 15:43:22] Synced seed 1234
[2023-06-20 15:43:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:43:22] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:43:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:43:22] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:43:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:43:23] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:43:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:43:23] [comm] Using global sharding
[2023-06-20 15:43:23] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:43:23] [training] Using 1 GPUs
[2023-06-20 15:43:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:43:38] Loading Adam parameters
[2023-06-20 15:43:38] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:43:38] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:43:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:43:39] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-20 15:43:39] [data] Shuffling data
[2023-06-20 15:43:39] [data] Done reading 20,192 sentences
[2023-06-20 15:43:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:43:39] Training started
[2023-06-20 15:43:39] Training finished
[2023-06-20 15:48:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:48:28] [marian] Running on node18.datos.cluster.uy as process 36070 with command line:
[2023-06-20 15:48:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 15:48:28] [config] after: 0e
[2023-06-20 15:48:28] [config] after-batches: 0
[2023-06-20 15:48:28] [config] after-epochs: 1
[2023-06-20 15:48:28] [config] all-caps-every: 0
[2023-06-20 15:48:28] [config] allow-unk: false
[2023-06-20 15:48:28] [config] authors: false
[2023-06-20 15:48:28] [config] beam-size: 12
[2023-06-20 15:48:28] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:48:28] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:48:28] [config] bert-masking-fraction: 0.15
[2023-06-20 15:48:28] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:48:28] [config] bert-train-type-embeddings: true
[2023-06-20 15:48:28] [config] bert-type-vocab-size: 2
[2023-06-20 15:48:28] [config] build-info: ""
[2023-06-20 15:48:28] [config] check-gradient-nan: false
[2023-06-20 15:48:28] [config] check-nan: false
[2023-06-20 15:48:28] [config] cite: false
[2023-06-20 15:48:28] [config] clip-norm: 1
[2023-06-20 15:48:28] [config] cost-scaling:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] cost-type: ce-sum
[2023-06-20 15:48:28] [config] cpu-threads: 0
[2023-06-20 15:48:28] [config] data-threads: 8
[2023-06-20 15:48:28] [config] data-weighting: ""
[2023-06-20 15:48:28] [config] data-weighting-type: sentence
[2023-06-20 15:48:28] [config] dec-cell: gru
[2023-06-20 15:48:28] [config] dec-cell-base-depth: 2
[2023-06-20 15:48:28] [config] dec-cell-high-depth: 1
[2023-06-20 15:48:28] [config] dec-depth: 1
[2023-06-20 15:48:28] [config] devices:
[2023-06-20 15:48:28] [config]   - 0
[2023-06-20 15:48:28] [config] dim-emb: 512
[2023-06-20 15:48:28] [config] dim-rnn: 1024
[2023-06-20 15:48:28] [config] dim-vocabs:
[2023-06-20 15:48:28] [config]   - 54042
[2023-06-20 15:48:28] [config]   - 36507
[2023-06-20 15:48:28] [config] disp-first: 0
[2023-06-20 15:48:28] [config] disp-freq: 1000u
[2023-06-20 15:48:28] [config] disp-label-counts: true
[2023-06-20 15:48:28] [config] dropout-rnn: 0
[2023-06-20 15:48:28] [config] dropout-src: 0
[2023-06-20 15:48:28] [config] dropout-trg: 0
[2023-06-20 15:48:28] [config] dump-config: ""
[2023-06-20 15:48:28] [config] dynamic-gradient-scaling:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] early-stopping: 10
[2023-06-20 15:48:28] [config] early-stopping-on: first
[2023-06-20 15:48:28] [config] embedding-fix-src: false
[2023-06-20 15:48:28] [config] embedding-fix-trg: false
[2023-06-20 15:48:28] [config] embedding-normalization: false
[2023-06-20 15:48:28] [config] embedding-vectors:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] enc-cell: gru
[2023-06-20 15:48:28] [config] enc-cell-depth: 1
[2023-06-20 15:48:28] [config] enc-depth: 1
[2023-06-20 15:48:28] [config] enc-type: bidirectional
[2023-06-20 15:48:28] [config] english-title-case-every: 0
[2023-06-20 15:48:28] [config] exponential-smoothing: 0
[2023-06-20 15:48:28] [config] factor-weight: 1
[2023-06-20 15:48:28] [config] factors-combine: sum
[2023-06-20 15:48:28] [config] factors-dim-emb: 0
[2023-06-20 15:48:28] [config] gradient-checkpointing: false
[2023-06-20 15:48:28] [config] gradient-norm-average-window: 100
[2023-06-20 15:48:28] [config] guided-alignment: none
[2023-06-20 15:48:28] [config] guided-alignment-cost: mse
[2023-06-20 15:48:28] [config] guided-alignment-weight: 0.1
[2023-06-20 15:48:28] [config] ignore-model-config: false
[2023-06-20 15:48:28] [config] input-types:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] interpolate-env-vars: false
[2023-06-20 15:48:28] [config] keep-best: false
[2023-06-20 15:48:28] [config] label-smoothing: 0
[2023-06-20 15:48:28] [config] layer-normalization: false
[2023-06-20 15:48:28] [config] learn-rate: 0.0001
[2023-06-20 15:48:28] [config] lemma-dependency: ""
[2023-06-20 15:48:28] [config] lemma-dim-emb: 0
[2023-06-20 15:48:28] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:48:28] [config] log-level: info
[2023-06-20 15:48:28] [config] log-time-zone: ""
[2023-06-20 15:48:28] [config] logical-epoch:
[2023-06-20 15:48:28] [config]   - 1e
[2023-06-20 15:48:28] [config]   - 0
[2023-06-20 15:48:28] [config] lr-decay: 0
[2023-06-20 15:48:28] [config] lr-decay-freq: 50000
[2023-06-20 15:48:28] [config] lr-decay-inv-sqrt:
[2023-06-20 15:48:28] [config]   - 0
[2023-06-20 15:48:28] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:48:28] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:48:28] [config] lr-decay-start:
[2023-06-20 15:48:28] [config]   - 10
[2023-06-20 15:48:28] [config]   - 1
[2023-06-20 15:48:28] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:48:28] [config] lr-report: false
[2023-06-20 15:48:28] [config] lr-warmup: 0
[2023-06-20 15:48:28] [config] lr-warmup-at-reload: false
[2023-06-20 15:48:28] [config] lr-warmup-cycle: false
[2023-06-20 15:48:28] [config] lr-warmup-start-rate: 0
[2023-06-20 15:48:28] [config] max-length: 50
[2023-06-20 15:48:28] [config] max-length-crop: false
[2023-06-20 15:48:28] [config] max-length-factor: 3
[2023-06-20 15:48:28] [config] maxi-batch: 100
[2023-06-20 15:48:28] [config] maxi-batch-sort: trg
[2023-06-20 15:48:28] [config] mini-batch: 64
[2023-06-20 15:48:28] [config] mini-batch-fit: false
[2023-06-20 15:48:28] [config] mini-batch-fit-step: 10
[2023-06-20 15:48:28] [config] mini-batch-round-up: true
[2023-06-20 15:48:28] [config] mini-batch-track-lr: false
[2023-06-20 15:48:28] [config] mini-batch-warmup: 0
[2023-06-20 15:48:28] [config] mini-batch-words: 0
[2023-06-20 15:48:28] [config] mini-batch-words-ref: 0
[2023-06-20 15:48:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:48:28] [config] multi-loss-type: sum
[2023-06-20 15:48:28] [config] n-best: false
[2023-06-20 15:48:28] [config] no-nccl: false
[2023-06-20 15:48:28] [config] no-reload: false
[2023-06-20 15:48:28] [config] no-restore-corpus: false
[2023-06-20 15:48:28] [config] normalize: 0
[2023-06-20 15:48:28] [config] normalize-gradient: false
[2023-06-20 15:48:28] [config] num-devices: 0
[2023-06-20 15:48:28] [config] optimizer: adam
[2023-06-20 15:48:28] [config] optimizer-delay: 1
[2023-06-20 15:48:28] [config] optimizer-params:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] output-omit-bias: false
[2023-06-20 15:48:28] [config] overwrite: false
[2023-06-20 15:48:28] [config] precision:
[2023-06-20 15:48:28] [config]   - float32
[2023-06-20 15:48:28] [config]   - float32
[2023-06-20 15:48:28] [config] pretrained-model: ""
[2023-06-20 15:48:28] [config] quantize-biases: false
[2023-06-20 15:48:28] [config] quantize-bits: 0
[2023-06-20 15:48:28] [config] quantize-log-based: false
[2023-06-20 15:48:28] [config] quantize-optimization-steps: 0
[2023-06-20 15:48:28] [config] quiet: false
[2023-06-20 15:48:28] [config] quiet-translation: true
[2023-06-20 15:48:28] [config] relative-paths: false
[2023-06-20 15:48:28] [config] right-left: false
[2023-06-20 15:48:28] [config] save-freq: 10000u
[2023-06-20 15:48:28] [config] seed: 1234
[2023-06-20 15:48:28] [config] sentencepiece-alphas:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:48:28] [config] sentencepiece-options: ""
[2023-06-20 15:48:28] [config] sharding: global
[2023-06-20 15:48:28] [config] shuffle: data
[2023-06-20 15:48:28] [config] shuffle-in-ram: false
[2023-06-20 15:48:28] [config] sigterm: save-and-exit
[2023-06-20 15:48:28] [config] skip: false
[2023-06-20 15:48:28] [config] sqlite: ""
[2023-06-20 15:48:28] [config] sqlite-drop: false
[2023-06-20 15:48:28] [config] sync-freq: 200u
[2023-06-20 15:48:28] [config] sync-sgd: false
[2023-06-20 15:48:28] [config] tempdir: /tmp
[2023-06-20 15:48:28] [config] tied-embeddings: false
[2023-06-20 15:48:28] [config] tied-embeddings-all: false
[2023-06-20 15:48:28] [config] tied-embeddings-src: false
[2023-06-20 15:48:28] [config] train-embedder-rank:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] train-sets:
[2023-06-20 15:48:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:48:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:48:28] [config] transformer-aan-activation: swish
[2023-06-20 15:48:28] [config] transformer-aan-depth: 2
[2023-06-20 15:48:28] [config] transformer-aan-nogate: false
[2023-06-20 15:48:28] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:48:28] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:48:28] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:48:28] [config] transformer-depth-scaling: false
[2023-06-20 15:48:28] [config] transformer-dim-aan: 2048
[2023-06-20 15:48:28] [config] transformer-dim-ffn: 2048
[2023-06-20 15:48:28] [config] transformer-dropout: 0
[2023-06-20 15:48:28] [config] transformer-dropout-attention: 0
[2023-06-20 15:48:28] [config] transformer-dropout-ffn: 0
[2023-06-20 15:48:28] [config] transformer-ffn-activation: swish
[2023-06-20 15:48:28] [config] transformer-ffn-depth: 2
[2023-06-20 15:48:28] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:48:28] [config] transformer-heads: 8
[2023-06-20 15:48:28] [config] transformer-no-projection: false
[2023-06-20 15:48:28] [config] transformer-pool: false
[2023-06-20 15:48:28] [config] transformer-postprocess: dan
[2023-06-20 15:48:28] [config] transformer-postprocess-emb: d
[2023-06-20 15:48:28] [config] transformer-postprocess-top: ""
[2023-06-20 15:48:28] [config] transformer-preprocess: ""
[2023-06-20 15:48:28] [config] transformer-tied-layers:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] transformer-train-position-embeddings: false
[2023-06-20 15:48:28] [config] tsv: false
[2023-06-20 15:48:28] [config] tsv-fields: 0
[2023-06-20 15:48:28] [config] type: amun
[2023-06-20 15:48:28] [config] ulr: false
[2023-06-20 15:48:28] [config] ulr-dim-emb: 0
[2023-06-20 15:48:28] [config] ulr-dropout: 0
[2023-06-20 15:48:28] [config] ulr-keys-vectors: ""
[2023-06-20 15:48:28] [config] ulr-query-vectors: ""
[2023-06-20 15:48:28] [config] ulr-softmax-temperature: 1
[2023-06-20 15:48:28] [config] ulr-trainable-transformation: false
[2023-06-20 15:48:28] [config] unlikelihood-loss: false
[2023-06-20 15:48:28] [config] valid-freq: 5000000
[2023-06-20 15:48:28] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:48:28] [config] valid-max-length: 1000
[2023-06-20 15:48:28] [config] valid-metrics:
[2023-06-20 15:48:28] [config]   - cross-entropy
[2023-06-20 15:48:28] [config] valid-mini-batch: 32
[2023-06-20 15:48:28] [config] valid-reset-stalled: false
[2023-06-20 15:48:28] [config] valid-script-args:
[2023-06-20 15:48:28] [config]   []
[2023-06-20 15:48:28] [config] valid-script-path: ""
[2023-06-20 15:48:28] [config] valid-sets:
[2023-06-20 15:48:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:48:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:48:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 15:48:28] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:48:28] [config] vocabs:
[2023-06-20 15:48:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:48:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:48:28] [config] word-penalty: 0
[2023-06-20 15:48:28] [config] word-scores: false
[2023-06-20 15:48:28] [config] workspace: 2048
[2023-06-20 15:48:28] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:48:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:48:28] [training] Using single-device training
[2023-06-20 15:48:29] Synced seed 1234
[2023-06-20 15:48:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:48:29] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:48:29] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:48:29] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:48:29] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:48:30] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:48:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:48:30] [comm] Using global sharding
[2023-06-20 15:48:30] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:48:30] [training] Using 1 GPUs
[2023-06-20 15:48:30] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:48:32] Loading Adam parameters
[2023-06-20 15:48:33] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:48:33] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:48:33] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:48:33] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-20 15:48:33] [data] Shuffling data
[2023-06-20 15:48:33] [data] Done reading 20,192 sentences
[2023-06-20 15:48:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:48:33] Training started
[2023-06-20 15:48:33] Training finished
[2023-06-20 15:58:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:58:55] [marian] Running on node18.datos.cluster.uy as process 36770 with command line:
[2023-06-20 15:58:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 15:58:55] [config] after: 0e
[2023-06-20 15:58:55] [config] after-batches: 0
[2023-06-20 15:58:55] [config] after-epochs: 1
[2023-06-20 15:58:55] [config] all-caps-every: 0
[2023-06-20 15:58:55] [config] allow-unk: false
[2023-06-20 15:58:55] [config] authors: false
[2023-06-20 15:58:55] [config] beam-size: 12
[2023-06-20 15:58:55] [config] bert-class-symbol: "[CLS]"
[2023-06-20 15:58:55] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 15:58:55] [config] bert-masking-fraction: 0.15
[2023-06-20 15:58:55] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 15:58:55] [config] bert-train-type-embeddings: true
[2023-06-20 15:58:55] [config] bert-type-vocab-size: 2
[2023-06-20 15:58:55] [config] build-info: ""
[2023-06-20 15:58:55] [config] check-gradient-nan: false
[2023-06-20 15:58:55] [config] check-nan: false
[2023-06-20 15:58:55] [config] cite: false
[2023-06-20 15:58:55] [config] clip-norm: 1
[2023-06-20 15:58:55] [config] cost-scaling:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] cost-type: ce-sum
[2023-06-20 15:58:55] [config] cpu-threads: 0
[2023-06-20 15:58:55] [config] data-threads: 8
[2023-06-20 15:58:55] [config] data-weighting: ""
[2023-06-20 15:58:55] [config] data-weighting-type: sentence
[2023-06-20 15:58:55] [config] dec-cell: gru
[2023-06-20 15:58:55] [config] dec-cell-base-depth: 2
[2023-06-20 15:58:55] [config] dec-cell-high-depth: 1
[2023-06-20 15:58:55] [config] dec-depth: 1
[2023-06-20 15:58:55] [config] devices:
[2023-06-20 15:58:55] [config]   - 0
[2023-06-20 15:58:55] [config] dim-emb: 512
[2023-06-20 15:58:55] [config] dim-rnn: 1024
[2023-06-20 15:58:55] [config] dim-vocabs:
[2023-06-20 15:58:55] [config]   - 54042
[2023-06-20 15:58:55] [config]   - 36507
[2023-06-20 15:58:55] [config] disp-first: 0
[2023-06-20 15:58:55] [config] disp-freq: 1000u
[2023-06-20 15:58:55] [config] disp-label-counts: true
[2023-06-20 15:58:55] [config] dropout-rnn: 0
[2023-06-20 15:58:55] [config] dropout-src: 0
[2023-06-20 15:58:55] [config] dropout-trg: 0
[2023-06-20 15:58:55] [config] dump-config: ""
[2023-06-20 15:58:55] [config] dynamic-gradient-scaling:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] early-stopping: 10
[2023-06-20 15:58:55] [config] early-stopping-on: first
[2023-06-20 15:58:55] [config] embedding-fix-src: false
[2023-06-20 15:58:55] [config] embedding-fix-trg: false
[2023-06-20 15:58:55] [config] embedding-normalization: false
[2023-06-20 15:58:55] [config] embedding-vectors:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] enc-cell: gru
[2023-06-20 15:58:55] [config] enc-cell-depth: 1
[2023-06-20 15:58:55] [config] enc-depth: 1
[2023-06-20 15:58:55] [config] enc-type: bidirectional
[2023-06-20 15:58:55] [config] english-title-case-every: 0
[2023-06-20 15:58:55] [config] exponential-smoothing: 0
[2023-06-20 15:58:55] [config] factor-weight: 1
[2023-06-20 15:58:55] [config] factors-combine: sum
[2023-06-20 15:58:55] [config] factors-dim-emb: 0
[2023-06-20 15:58:55] [config] gradient-checkpointing: false
[2023-06-20 15:58:55] [config] gradient-norm-average-window: 100
[2023-06-20 15:58:55] [config] guided-alignment: none
[2023-06-20 15:58:55] [config] guided-alignment-cost: mse
[2023-06-20 15:58:55] [config] guided-alignment-weight: 0.1
[2023-06-20 15:58:55] [config] ignore-model-config: false
[2023-06-20 15:58:55] [config] input-types:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] interpolate-env-vars: false
[2023-06-20 15:58:55] [config] keep-best: false
[2023-06-20 15:58:55] [config] label-smoothing: 0
[2023-06-20 15:58:55] [config] layer-normalization: false
[2023-06-20 15:58:55] [config] learn-rate: 0.0001
[2023-06-20 15:58:55] [config] lemma-dependency: ""
[2023-06-20 15:58:55] [config] lemma-dim-emb: 0
[2023-06-20 15:58:55] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 15:58:55] [config] log-level: info
[2023-06-20 15:58:55] [config] log-time-zone: ""
[2023-06-20 15:58:55] [config] logical-epoch:
[2023-06-20 15:58:55] [config]   - 1e
[2023-06-20 15:58:55] [config]   - 0
[2023-06-20 15:58:55] [config] lr-decay: 0
[2023-06-20 15:58:55] [config] lr-decay-freq: 50000
[2023-06-20 15:58:55] [config] lr-decay-inv-sqrt:
[2023-06-20 15:58:55] [config]   - 0
[2023-06-20 15:58:55] [config] lr-decay-repeat-warmup: false
[2023-06-20 15:58:55] [config] lr-decay-reset-optimizer: false
[2023-06-20 15:58:55] [config] lr-decay-start:
[2023-06-20 15:58:55] [config]   - 10
[2023-06-20 15:58:55] [config]   - 1
[2023-06-20 15:58:55] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 15:58:55] [config] lr-report: false
[2023-06-20 15:58:55] [config] lr-warmup: 0
[2023-06-20 15:58:55] [config] lr-warmup-at-reload: false
[2023-06-20 15:58:55] [config] lr-warmup-cycle: false
[2023-06-20 15:58:55] [config] lr-warmup-start-rate: 0
[2023-06-20 15:58:55] [config] max-length: 50
[2023-06-20 15:58:55] [config] max-length-crop: false
[2023-06-20 15:58:55] [config] max-length-factor: 3
[2023-06-20 15:58:55] [config] maxi-batch: 100
[2023-06-20 15:58:55] [config] maxi-batch-sort: trg
[2023-06-20 15:58:55] [config] mini-batch: 64
[2023-06-20 15:58:55] [config] mini-batch-fit: false
[2023-06-20 15:58:55] [config] mini-batch-fit-step: 10
[2023-06-20 15:58:55] [config] mini-batch-round-up: true
[2023-06-20 15:58:55] [config] mini-batch-track-lr: false
[2023-06-20 15:58:55] [config] mini-batch-warmup: 0
[2023-06-20 15:58:55] [config] mini-batch-words: 0
[2023-06-20 15:58:55] [config] mini-batch-words-ref: 0
[2023-06-20 15:58:55] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:58:55] [config] multi-loss-type: sum
[2023-06-20 15:58:55] [config] n-best: false
[2023-06-20 15:58:55] [config] no-nccl: false
[2023-06-20 15:58:55] [config] no-reload: false
[2023-06-20 15:58:55] [config] no-restore-corpus: false
[2023-06-20 15:58:55] [config] normalize: 0
[2023-06-20 15:58:55] [config] normalize-gradient: false
[2023-06-20 15:58:55] [config] num-devices: 0
[2023-06-20 15:58:55] [config] optimizer: adam
[2023-06-20 15:58:55] [config] optimizer-delay: 1
[2023-06-20 15:58:55] [config] optimizer-params:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] output-omit-bias: false
[2023-06-20 15:58:55] [config] overwrite: false
[2023-06-20 15:58:55] [config] precision:
[2023-06-20 15:58:55] [config]   - float32
[2023-06-20 15:58:55] [config]   - float32
[2023-06-20 15:58:55] [config] pretrained-model: ""
[2023-06-20 15:58:55] [config] quantize-biases: false
[2023-06-20 15:58:55] [config] quantize-bits: 0
[2023-06-20 15:58:55] [config] quantize-log-based: false
[2023-06-20 15:58:55] [config] quantize-optimization-steps: 0
[2023-06-20 15:58:55] [config] quiet: false
[2023-06-20 15:58:55] [config] quiet-translation: true
[2023-06-20 15:58:55] [config] relative-paths: false
[2023-06-20 15:58:55] [config] right-left: false
[2023-06-20 15:58:55] [config] save-freq: 10000u
[2023-06-20 15:58:55] [config] seed: 1234
[2023-06-20 15:58:55] [config] sentencepiece-alphas:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] sentencepiece-max-lines: 2000000
[2023-06-20 15:58:55] [config] sentencepiece-options: ""
[2023-06-20 15:58:55] [config] sharding: global
[2023-06-20 15:58:55] [config] shuffle: data
[2023-06-20 15:58:55] [config] shuffle-in-ram: false
[2023-06-20 15:58:55] [config] sigterm: save-and-exit
[2023-06-20 15:58:55] [config] skip: false
[2023-06-20 15:58:55] [config] sqlite: ""
[2023-06-20 15:58:55] [config] sqlite-drop: false
[2023-06-20 15:58:55] [config] sync-freq: 200u
[2023-06-20 15:58:55] [config] sync-sgd: false
[2023-06-20 15:58:55] [config] tempdir: /tmp
[2023-06-20 15:58:55] [config] tied-embeddings: false
[2023-06-20 15:58:55] [config] tied-embeddings-all: false
[2023-06-20 15:58:55] [config] tied-embeddings-src: false
[2023-06-20 15:58:55] [config] train-embedder-rank:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] train-sets:
[2023-06-20 15:58:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 15:58:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 15:58:55] [config] transformer-aan-activation: swish
[2023-06-20 15:58:55] [config] transformer-aan-depth: 2
[2023-06-20 15:58:55] [config] transformer-aan-nogate: false
[2023-06-20 15:58:55] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 15:58:55] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 15:58:55] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 15:58:55] [config] transformer-depth-scaling: false
[2023-06-20 15:58:55] [config] transformer-dim-aan: 2048
[2023-06-20 15:58:55] [config] transformer-dim-ffn: 2048
[2023-06-20 15:58:55] [config] transformer-dropout: 0
[2023-06-20 15:58:55] [config] transformer-dropout-attention: 0
[2023-06-20 15:58:55] [config] transformer-dropout-ffn: 0
[2023-06-20 15:58:55] [config] transformer-ffn-activation: swish
[2023-06-20 15:58:55] [config] transformer-ffn-depth: 2
[2023-06-20 15:58:55] [config] transformer-guided-alignment-layer: last
[2023-06-20 15:58:55] [config] transformer-heads: 8
[2023-06-20 15:58:55] [config] transformer-no-projection: false
[2023-06-20 15:58:55] [config] transformer-pool: false
[2023-06-20 15:58:55] [config] transformer-postprocess: dan
[2023-06-20 15:58:55] [config] transformer-postprocess-emb: d
[2023-06-20 15:58:55] [config] transformer-postprocess-top: ""
[2023-06-20 15:58:55] [config] transformer-preprocess: ""
[2023-06-20 15:58:55] [config] transformer-tied-layers:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] transformer-train-position-embeddings: false
[2023-06-20 15:58:55] [config] tsv: false
[2023-06-20 15:58:55] [config] tsv-fields: 0
[2023-06-20 15:58:55] [config] type: amun
[2023-06-20 15:58:55] [config] ulr: false
[2023-06-20 15:58:55] [config] ulr-dim-emb: 0
[2023-06-20 15:58:55] [config] ulr-dropout: 0
[2023-06-20 15:58:55] [config] ulr-keys-vectors: ""
[2023-06-20 15:58:55] [config] ulr-query-vectors: ""
[2023-06-20 15:58:55] [config] ulr-softmax-temperature: 1
[2023-06-20 15:58:55] [config] ulr-trainable-transformation: false
[2023-06-20 15:58:55] [config] unlikelihood-loss: false
[2023-06-20 15:58:55] [config] valid-freq: 5000000
[2023-06-20 15:58:55] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 15:58:55] [config] valid-max-length: 1000
[2023-06-20 15:58:55] [config] valid-metrics:
[2023-06-20 15:58:55] [config]   - cross-entropy
[2023-06-20 15:58:55] [config] valid-mini-batch: 32
[2023-06-20 15:58:55] [config] valid-reset-stalled: false
[2023-06-20 15:58:55] [config] valid-script-args:
[2023-06-20 15:58:55] [config]   []
[2023-06-20 15:58:55] [config] valid-script-path: ""
[2023-06-20 15:58:55] [config] valid-sets:
[2023-06-20 15:58:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 15:58:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 15:58:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 15:58:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:58:55] [config] vocabs:
[2023-06-20 15:58:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:58:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:58:55] [config] word-penalty: 0
[2023-06-20 15:58:55] [config] word-scores: false
[2023-06-20 15:58:55] [config] workspace: 2048
[2023-06-20 15:58:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 15:58:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:58:55] [training] Using single-device training
[2023-06-20 15:58:55] Synced seed 1234
[2023-06-20 15:58:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 15:58:55] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 15:58:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 15:58:55] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 15:58:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 15:58:56] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 15:58:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 15:58:56] [comm] Using global sharding
[2023-06-20 15:58:56] [comm] NCCLCommunicators constructed successfully
[2023-06-20 15:58:56] [training] Using 1 GPUs
[2023-06-20 15:58:57] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 15:58:59] Loading Adam parameters
[2023-06-20 15:58:59] [memory] Reserving 754 MB, device gpu0
[2023-06-20 15:58:59] [memory] Reserving 377 MB, device gpu0
[2023-06-20 15:59:00] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 15:59:00] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-20 15:59:00] [data] Shuffling data
[2023-06-20 15:59:00] [data] Done reading 20,192 sentences
[2023-06-20 15:59:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 15:59:00] Training started
[2023-06-20 15:59:00] Training finished
[2023-06-20 16:17:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:17:36] [marian] Running on node18.datos.cluster.uy as process 38424 with command line:
[2023-06-20 16:17:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 16:17:36] [config] after: 0e
[2023-06-20 16:17:36] [config] after-batches: 0
[2023-06-20 16:17:36] [config] after-epochs: 1
[2023-06-20 16:17:36] [config] all-caps-every: 0
[2023-06-20 16:17:36] [config] allow-unk: false
[2023-06-20 16:17:36] [config] authors: false
[2023-06-20 16:17:36] [config] beam-size: 12
[2023-06-20 16:17:36] [config] bert-class-symbol: "[CLS]"
[2023-06-20 16:17:36] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 16:17:36] [config] bert-masking-fraction: 0.15
[2023-06-20 16:17:36] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 16:17:36] [config] bert-train-type-embeddings: true
[2023-06-20 16:17:36] [config] bert-type-vocab-size: 2
[2023-06-20 16:17:36] [config] build-info: ""
[2023-06-20 16:17:36] [config] check-gradient-nan: false
[2023-06-20 16:17:36] [config] check-nan: false
[2023-06-20 16:17:36] [config] cite: false
[2023-06-20 16:17:36] [config] clip-norm: 1
[2023-06-20 16:17:36] [config] cost-scaling:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] cost-type: ce-sum
[2023-06-20 16:17:36] [config] cpu-threads: 0
[2023-06-20 16:17:36] [config] data-threads: 8
[2023-06-20 16:17:36] [config] data-weighting: ""
[2023-06-20 16:17:36] [config] data-weighting-type: sentence
[2023-06-20 16:17:36] [config] dec-cell: gru
[2023-06-20 16:17:36] [config] dec-cell-base-depth: 2
[2023-06-20 16:17:36] [config] dec-cell-high-depth: 1
[2023-06-20 16:17:36] [config] dec-depth: 1
[2023-06-20 16:17:36] [config] devices:
[2023-06-20 16:17:36] [config]   - 0
[2023-06-20 16:17:36] [config] dim-emb: 512
[2023-06-20 16:17:36] [config] dim-rnn: 1024
[2023-06-20 16:17:36] [config] dim-vocabs:
[2023-06-20 16:17:36] [config]   - 54042
[2023-06-20 16:17:36] [config]   - 36507
[2023-06-20 16:17:36] [config] disp-first: 0
[2023-06-20 16:17:36] [config] disp-freq: 1000u
[2023-06-20 16:17:36] [config] disp-label-counts: true
[2023-06-20 16:17:36] [config] dropout-rnn: 0
[2023-06-20 16:17:36] [config] dropout-src: 0
[2023-06-20 16:17:36] [config] dropout-trg: 0
[2023-06-20 16:17:36] [config] dump-config: ""
[2023-06-20 16:17:36] [config] dynamic-gradient-scaling:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] early-stopping: 10
[2023-06-20 16:17:36] [config] early-stopping-on: first
[2023-06-20 16:17:36] [config] embedding-fix-src: false
[2023-06-20 16:17:36] [config] embedding-fix-trg: false
[2023-06-20 16:17:36] [config] embedding-normalization: false
[2023-06-20 16:17:36] [config] embedding-vectors:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] enc-cell: gru
[2023-06-20 16:17:36] [config] enc-cell-depth: 1
[2023-06-20 16:17:36] [config] enc-depth: 1
[2023-06-20 16:17:36] [config] enc-type: bidirectional
[2023-06-20 16:17:36] [config] english-title-case-every: 0
[2023-06-20 16:17:36] [config] exponential-smoothing: 0
[2023-06-20 16:17:36] [config] factor-weight: 1
[2023-06-20 16:17:36] [config] factors-combine: sum
[2023-06-20 16:17:36] [config] factors-dim-emb: 0
[2023-06-20 16:17:36] [config] gradient-checkpointing: false
[2023-06-20 16:17:36] [config] gradient-norm-average-window: 100
[2023-06-20 16:17:36] [config] guided-alignment: none
[2023-06-20 16:17:36] [config] guided-alignment-cost: mse
[2023-06-20 16:17:36] [config] guided-alignment-weight: 0.1
[2023-06-20 16:17:36] [config] ignore-model-config: false
[2023-06-20 16:17:36] [config] input-types:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] interpolate-env-vars: false
[2023-06-20 16:17:36] [config] keep-best: false
[2023-06-20 16:17:36] [config] label-smoothing: 0
[2023-06-20 16:17:36] [config] layer-normalization: false
[2023-06-20 16:17:36] [config] learn-rate: 0.0001
[2023-06-20 16:17:36] [config] lemma-dependency: ""
[2023-06-20 16:17:36] [config] lemma-dim-emb: 0
[2023-06-20 16:17:36] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 16:17:36] [config] log-level: info
[2023-06-20 16:17:36] [config] log-time-zone: ""
[2023-06-20 16:17:36] [config] logical-epoch:
[2023-06-20 16:17:36] [config]   - 1e
[2023-06-20 16:17:36] [config]   - 0
[2023-06-20 16:17:36] [config] lr-decay: 0
[2023-06-20 16:17:36] [config] lr-decay-freq: 50000
[2023-06-20 16:17:36] [config] lr-decay-inv-sqrt:
[2023-06-20 16:17:36] [config]   - 0
[2023-06-20 16:17:36] [config] lr-decay-repeat-warmup: false
[2023-06-20 16:17:36] [config] lr-decay-reset-optimizer: false
[2023-06-20 16:17:36] [config] lr-decay-start:
[2023-06-20 16:17:36] [config]   - 10
[2023-06-20 16:17:36] [config]   - 1
[2023-06-20 16:17:36] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 16:17:36] [config] lr-report: false
[2023-06-20 16:17:36] [config] lr-warmup: 0
[2023-06-20 16:17:36] [config] lr-warmup-at-reload: false
[2023-06-20 16:17:36] [config] lr-warmup-cycle: false
[2023-06-20 16:17:36] [config] lr-warmup-start-rate: 0
[2023-06-20 16:17:36] [config] max-length: 50
[2023-06-20 16:17:36] [config] max-length-crop: false
[2023-06-20 16:17:36] [config] max-length-factor: 3
[2023-06-20 16:17:36] [config] maxi-batch: 100
[2023-06-20 16:17:36] [config] maxi-batch-sort: trg
[2023-06-20 16:17:36] [config] mini-batch: 64
[2023-06-20 16:17:36] [config] mini-batch-fit: false
[2023-06-20 16:17:36] [config] mini-batch-fit-step: 10
[2023-06-20 16:17:36] [config] mini-batch-round-up: true
[2023-06-20 16:17:36] [config] mini-batch-track-lr: false
[2023-06-20 16:17:36] [config] mini-batch-warmup: 0
[2023-06-20 16:17:36] [config] mini-batch-words: 0
[2023-06-20 16:17:36] [config] mini-batch-words-ref: 0
[2023-06-20 16:17:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:17:36] [config] multi-loss-type: sum
[2023-06-20 16:17:36] [config] n-best: false
[2023-06-20 16:17:36] [config] no-nccl: false
[2023-06-20 16:17:36] [config] no-reload: false
[2023-06-20 16:17:36] [config] no-restore-corpus: false
[2023-06-20 16:17:36] [config] normalize: 0
[2023-06-20 16:17:36] [config] normalize-gradient: false
[2023-06-20 16:17:36] [config] num-devices: 0
[2023-06-20 16:17:36] [config] optimizer: adam
[2023-06-20 16:17:36] [config] optimizer-delay: 1
[2023-06-20 16:17:36] [config] optimizer-params:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] output-omit-bias: false
[2023-06-20 16:17:36] [config] overwrite: false
[2023-06-20 16:17:36] [config] precision:
[2023-06-20 16:17:36] [config]   - float32
[2023-06-20 16:17:36] [config]   - float32
[2023-06-20 16:17:36] [config] pretrained-model: ""
[2023-06-20 16:17:36] [config] quantize-biases: false
[2023-06-20 16:17:36] [config] quantize-bits: 0
[2023-06-20 16:17:36] [config] quantize-log-based: false
[2023-06-20 16:17:36] [config] quantize-optimization-steps: 0
[2023-06-20 16:17:36] [config] quiet: false
[2023-06-20 16:17:36] [config] quiet-translation: true
[2023-06-20 16:17:36] [config] relative-paths: false
[2023-06-20 16:17:36] [config] right-left: false
[2023-06-20 16:17:36] [config] save-freq: 10000u
[2023-06-20 16:17:36] [config] seed: 1234
[2023-06-20 16:17:36] [config] sentencepiece-alphas:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] sentencepiece-max-lines: 2000000
[2023-06-20 16:17:36] [config] sentencepiece-options: ""
[2023-06-20 16:17:36] [config] sharding: global
[2023-06-20 16:17:36] [config] shuffle: data
[2023-06-20 16:17:36] [config] shuffle-in-ram: false
[2023-06-20 16:17:36] [config] sigterm: save-and-exit
[2023-06-20 16:17:36] [config] skip: false
[2023-06-20 16:17:36] [config] sqlite: ""
[2023-06-20 16:17:36] [config] sqlite-drop: false
[2023-06-20 16:17:36] [config] sync-freq: 200u
[2023-06-20 16:17:36] [config] sync-sgd: false
[2023-06-20 16:17:36] [config] tempdir: /tmp
[2023-06-20 16:17:36] [config] tied-embeddings: false
[2023-06-20 16:17:36] [config] tied-embeddings-all: false
[2023-06-20 16:17:36] [config] tied-embeddings-src: false
[2023-06-20 16:17:36] [config] train-embedder-rank:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] train-sets:
[2023-06-20 16:17:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 16:17:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 16:17:36] [config] transformer-aan-activation: swish
[2023-06-20 16:17:36] [config] transformer-aan-depth: 2
[2023-06-20 16:17:36] [config] transformer-aan-nogate: false
[2023-06-20 16:17:36] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 16:17:36] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 16:17:36] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 16:17:36] [config] transformer-depth-scaling: false
[2023-06-20 16:17:36] [config] transformer-dim-aan: 2048
[2023-06-20 16:17:36] [config] transformer-dim-ffn: 2048
[2023-06-20 16:17:36] [config] transformer-dropout: 0
[2023-06-20 16:17:36] [config] transformer-dropout-attention: 0
[2023-06-20 16:17:36] [config] transformer-dropout-ffn: 0
[2023-06-20 16:17:36] [config] transformer-ffn-activation: swish
[2023-06-20 16:17:36] [config] transformer-ffn-depth: 2
[2023-06-20 16:17:36] [config] transformer-guided-alignment-layer: last
[2023-06-20 16:17:36] [config] transformer-heads: 8
[2023-06-20 16:17:36] [config] transformer-no-projection: false
[2023-06-20 16:17:36] [config] transformer-pool: false
[2023-06-20 16:17:36] [config] transformer-postprocess: dan
[2023-06-20 16:17:36] [config] transformer-postprocess-emb: d
[2023-06-20 16:17:36] [config] transformer-postprocess-top: ""
[2023-06-20 16:17:36] [config] transformer-preprocess: ""
[2023-06-20 16:17:36] [config] transformer-tied-layers:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] transformer-train-position-embeddings: false
[2023-06-20 16:17:36] [config] tsv: false
[2023-06-20 16:17:36] [config] tsv-fields: 0
[2023-06-20 16:17:36] [config] type: amun
[2023-06-20 16:17:36] [config] ulr: false
[2023-06-20 16:17:36] [config] ulr-dim-emb: 0
[2023-06-20 16:17:36] [config] ulr-dropout: 0
[2023-06-20 16:17:36] [config] ulr-keys-vectors: ""
[2023-06-20 16:17:36] [config] ulr-query-vectors: ""
[2023-06-20 16:17:36] [config] ulr-softmax-temperature: 1
[2023-06-20 16:17:36] [config] ulr-trainable-transformation: false
[2023-06-20 16:17:36] [config] unlikelihood-loss: false
[2023-06-20 16:17:36] [config] valid-freq: 5000000
[2023-06-20 16:17:36] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 16:17:36] [config] valid-max-length: 1000
[2023-06-20 16:17:36] [config] valid-metrics:
[2023-06-20 16:17:36] [config]   - cross-entropy
[2023-06-20 16:17:36] [config] valid-mini-batch: 32
[2023-06-20 16:17:36] [config] valid-reset-stalled: false
[2023-06-20 16:17:36] [config] valid-script-args:
[2023-06-20 16:17:36] [config]   []
[2023-06-20 16:17:36] [config] valid-script-path: ""
[2023-06-20 16:17:36] [config] valid-sets:
[2023-06-20 16:17:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 16:17:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 16:17:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 16:17:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:17:36] [config] vocabs:
[2023-06-20 16:17:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:17:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:17:36] [config] word-penalty: 0
[2023-06-20 16:17:36] [config] word-scores: false
[2023-06-20 16:17:36] [config] workspace: 2048
[2023-06-20 16:17:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:17:36] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:17:36] [training] Using single-device training
[2023-06-20 16:17:37] Synced seed 1234
[2023-06-20 16:17:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:17:37] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 16:17:37] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:17:37] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 16:17:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:17:38] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 16:17:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 16:17:38] [comm] Using global sharding
[2023-06-20 16:17:38] [comm] NCCLCommunicators constructed successfully
[2023-06-20 16:17:38] [training] Using 1 GPUs
[2023-06-20 16:17:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:17:40] Loading Adam parameters
[2023-06-20 16:17:41] [memory] Reserving 754 MB, device gpu0
[2023-06-20 16:17:41] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:17:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 16:17:41] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-20 16:17:41] [data] Shuffling data
[2023-06-20 16:17:41] [data] Done reading 20,192 sentences
[2023-06-20 16:17:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:17:41] Training started
[2023-06-20 16:17:41] Training finished
[2023-06-20 16:29:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:29:06] [marian] Running on node18.datos.cluster.uy as process 39089 with command line:
[2023-06-20 16:29:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 16:29:06] [config] after: 0e
[2023-06-20 16:29:06] [config] after-batches: 0
[2023-06-20 16:29:06] [config] after-epochs: 2
[2023-06-20 16:29:06] [config] all-caps-every: 0
[2023-06-20 16:29:06] [config] allow-unk: false
[2023-06-20 16:29:06] [config] authors: false
[2023-06-20 16:29:06] [config] beam-size: 12
[2023-06-20 16:29:06] [config] bert-class-symbol: "[CLS]"
[2023-06-20 16:29:06] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 16:29:06] [config] bert-masking-fraction: 0.15
[2023-06-20 16:29:06] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 16:29:06] [config] bert-train-type-embeddings: true
[2023-06-20 16:29:06] [config] bert-type-vocab-size: 2
[2023-06-20 16:29:06] [config] build-info: ""
[2023-06-20 16:29:06] [config] check-gradient-nan: false
[2023-06-20 16:29:06] [config] check-nan: false
[2023-06-20 16:29:06] [config] cite: false
[2023-06-20 16:29:06] [config] clip-norm: 1
[2023-06-20 16:29:06] [config] cost-scaling:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] cost-type: ce-sum
[2023-06-20 16:29:06] [config] cpu-threads: 0
[2023-06-20 16:29:06] [config] data-threads: 8
[2023-06-20 16:29:06] [config] data-weighting: ""
[2023-06-20 16:29:06] [config] data-weighting-type: sentence
[2023-06-20 16:29:06] [config] dec-cell: gru
[2023-06-20 16:29:06] [config] dec-cell-base-depth: 2
[2023-06-20 16:29:06] [config] dec-cell-high-depth: 1
[2023-06-20 16:29:06] [config] dec-depth: 1
[2023-06-20 16:29:06] [config] devices:
[2023-06-20 16:29:06] [config]   - 0
[2023-06-20 16:29:06] [config] dim-emb: 512
[2023-06-20 16:29:06] [config] dim-rnn: 1024
[2023-06-20 16:29:06] [config] dim-vocabs:
[2023-06-20 16:29:06] [config]   - 54042
[2023-06-20 16:29:06] [config]   - 36507
[2023-06-20 16:29:06] [config] disp-first: 0
[2023-06-20 16:29:06] [config] disp-freq: 1000u
[2023-06-20 16:29:06] [config] disp-label-counts: true
[2023-06-20 16:29:06] [config] dropout-rnn: 0
[2023-06-20 16:29:06] [config] dropout-src: 0
[2023-06-20 16:29:06] [config] dropout-trg: 0
[2023-06-20 16:29:06] [config] dump-config: ""
[2023-06-20 16:29:06] [config] dynamic-gradient-scaling:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] early-stopping: 10
[2023-06-20 16:29:06] [config] early-stopping-on: first
[2023-06-20 16:29:06] [config] embedding-fix-src: false
[2023-06-20 16:29:06] [config] embedding-fix-trg: false
[2023-06-20 16:29:06] [config] embedding-normalization: false
[2023-06-20 16:29:06] [config] embedding-vectors:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] enc-cell: gru
[2023-06-20 16:29:06] [config] enc-cell-depth: 1
[2023-06-20 16:29:06] [config] enc-depth: 1
[2023-06-20 16:29:06] [config] enc-type: bidirectional
[2023-06-20 16:29:06] [config] english-title-case-every: 0
[2023-06-20 16:29:06] [config] exponential-smoothing: 0
[2023-06-20 16:29:06] [config] factor-weight: 1
[2023-06-20 16:29:06] [config] factors-combine: sum
[2023-06-20 16:29:06] [config] factors-dim-emb: 0
[2023-06-20 16:29:06] [config] gradient-checkpointing: false
[2023-06-20 16:29:06] [config] gradient-norm-average-window: 100
[2023-06-20 16:29:06] [config] guided-alignment: none
[2023-06-20 16:29:06] [config] guided-alignment-cost: mse
[2023-06-20 16:29:06] [config] guided-alignment-weight: 0.1
[2023-06-20 16:29:06] [config] ignore-model-config: false
[2023-06-20 16:29:06] [config] input-types:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] interpolate-env-vars: false
[2023-06-20 16:29:06] [config] keep-best: false
[2023-06-20 16:29:06] [config] label-smoothing: 0
[2023-06-20 16:29:06] [config] layer-normalization: false
[2023-06-20 16:29:06] [config] learn-rate: 0.0001
[2023-06-20 16:29:06] [config] lemma-dependency: ""
[2023-06-20 16:29:06] [config] lemma-dim-emb: 0
[2023-06-20 16:29:06] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 16:29:06] [config] log-level: info
[2023-06-20 16:29:06] [config] log-time-zone: ""
[2023-06-20 16:29:06] [config] logical-epoch:
[2023-06-20 16:29:06] [config]   - 1e
[2023-06-20 16:29:06] [config]   - 0
[2023-06-20 16:29:06] [config] lr-decay: 0
[2023-06-20 16:29:06] [config] lr-decay-freq: 50000
[2023-06-20 16:29:06] [config] lr-decay-inv-sqrt:
[2023-06-20 16:29:06] [config]   - 0
[2023-06-20 16:29:06] [config] lr-decay-repeat-warmup: false
[2023-06-20 16:29:06] [config] lr-decay-reset-optimizer: false
[2023-06-20 16:29:06] [config] lr-decay-start:
[2023-06-20 16:29:06] [config]   - 10
[2023-06-20 16:29:06] [config]   - 1
[2023-06-20 16:29:06] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 16:29:06] [config] lr-report: false
[2023-06-20 16:29:06] [config] lr-warmup: 0
[2023-06-20 16:29:06] [config] lr-warmup-at-reload: false
[2023-06-20 16:29:06] [config] lr-warmup-cycle: false
[2023-06-20 16:29:06] [config] lr-warmup-start-rate: 0
[2023-06-20 16:29:06] [config] max-length: 50
[2023-06-20 16:29:06] [config] max-length-crop: false
[2023-06-20 16:29:06] [config] max-length-factor: 3
[2023-06-20 16:29:06] [config] maxi-batch: 100
[2023-06-20 16:29:06] [config] maxi-batch-sort: trg
[2023-06-20 16:29:06] [config] mini-batch: 64
[2023-06-20 16:29:06] [config] mini-batch-fit: false
[2023-06-20 16:29:06] [config] mini-batch-fit-step: 10
[2023-06-20 16:29:06] [config] mini-batch-round-up: true
[2023-06-20 16:29:06] [config] mini-batch-track-lr: false
[2023-06-20 16:29:06] [config] mini-batch-warmup: 0
[2023-06-20 16:29:06] [config] mini-batch-words: 0
[2023-06-20 16:29:06] [config] mini-batch-words-ref: 0
[2023-06-20 16:29:06] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:29:06] [config] multi-loss-type: sum
[2023-06-20 16:29:06] [config] n-best: false
[2023-06-20 16:29:06] [config] no-nccl: false
[2023-06-20 16:29:06] [config] no-reload: false
[2023-06-20 16:29:06] [config] no-restore-corpus: false
[2023-06-20 16:29:06] [config] normalize: 0
[2023-06-20 16:29:06] [config] normalize-gradient: false
[2023-06-20 16:29:06] [config] num-devices: 0
[2023-06-20 16:29:06] [config] optimizer: adam
[2023-06-20 16:29:06] [config] optimizer-delay: 1
[2023-06-20 16:29:06] [config] optimizer-params:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] output-omit-bias: false
[2023-06-20 16:29:06] [config] overwrite: false
[2023-06-20 16:29:06] [config] precision:
[2023-06-20 16:29:06] [config]   - float32
[2023-06-20 16:29:06] [config]   - float32
[2023-06-20 16:29:06] [config] pretrained-model: ""
[2023-06-20 16:29:06] [config] quantize-biases: false
[2023-06-20 16:29:06] [config] quantize-bits: 0
[2023-06-20 16:29:06] [config] quantize-log-based: false
[2023-06-20 16:29:06] [config] quantize-optimization-steps: 0
[2023-06-20 16:29:06] [config] quiet: false
[2023-06-20 16:29:06] [config] quiet-translation: true
[2023-06-20 16:29:06] [config] relative-paths: false
[2023-06-20 16:29:06] [config] right-left: false
[2023-06-20 16:29:06] [config] save-freq: 10000u
[2023-06-20 16:29:06] [config] seed: 1234
[2023-06-20 16:29:06] [config] sentencepiece-alphas:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] sentencepiece-max-lines: 2000000
[2023-06-20 16:29:06] [config] sentencepiece-options: ""
[2023-06-20 16:29:06] [config] sharding: global
[2023-06-20 16:29:06] [config] shuffle: data
[2023-06-20 16:29:06] [config] shuffle-in-ram: false
[2023-06-20 16:29:06] [config] sigterm: save-and-exit
[2023-06-20 16:29:06] [config] skip: false
[2023-06-20 16:29:06] [config] sqlite: ""
[2023-06-20 16:29:06] [config] sqlite-drop: false
[2023-06-20 16:29:06] [config] sync-freq: 200u
[2023-06-20 16:29:06] [config] sync-sgd: false
[2023-06-20 16:29:06] [config] tempdir: /tmp
[2023-06-20 16:29:06] [config] tied-embeddings: false
[2023-06-20 16:29:06] [config] tied-embeddings-all: false
[2023-06-20 16:29:06] [config] tied-embeddings-src: false
[2023-06-20 16:29:06] [config] train-embedder-rank:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] train-sets:
[2023-06-20 16:29:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 16:29:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 16:29:06] [config] transformer-aan-activation: swish
[2023-06-20 16:29:06] [config] transformer-aan-depth: 2
[2023-06-20 16:29:06] [config] transformer-aan-nogate: false
[2023-06-20 16:29:06] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 16:29:06] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 16:29:06] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 16:29:06] [config] transformer-depth-scaling: false
[2023-06-20 16:29:06] [config] transformer-dim-aan: 2048
[2023-06-20 16:29:06] [config] transformer-dim-ffn: 2048
[2023-06-20 16:29:06] [config] transformer-dropout: 0
[2023-06-20 16:29:06] [config] transformer-dropout-attention: 0
[2023-06-20 16:29:06] [config] transformer-dropout-ffn: 0
[2023-06-20 16:29:06] [config] transformer-ffn-activation: swish
[2023-06-20 16:29:06] [config] transformer-ffn-depth: 2
[2023-06-20 16:29:06] [config] transformer-guided-alignment-layer: last
[2023-06-20 16:29:06] [config] transformer-heads: 8
[2023-06-20 16:29:06] [config] transformer-no-projection: false
[2023-06-20 16:29:06] [config] transformer-pool: false
[2023-06-20 16:29:06] [config] transformer-postprocess: dan
[2023-06-20 16:29:06] [config] transformer-postprocess-emb: d
[2023-06-20 16:29:06] [config] transformer-postprocess-top: ""
[2023-06-20 16:29:06] [config] transformer-preprocess: ""
[2023-06-20 16:29:06] [config] transformer-tied-layers:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] transformer-train-position-embeddings: false
[2023-06-20 16:29:06] [config] tsv: false
[2023-06-20 16:29:06] [config] tsv-fields: 0
[2023-06-20 16:29:06] [config] type: amun
[2023-06-20 16:29:06] [config] ulr: false
[2023-06-20 16:29:06] [config] ulr-dim-emb: 0
[2023-06-20 16:29:06] [config] ulr-dropout: 0
[2023-06-20 16:29:06] [config] ulr-keys-vectors: ""
[2023-06-20 16:29:06] [config] ulr-query-vectors: ""
[2023-06-20 16:29:06] [config] ulr-softmax-temperature: 1
[2023-06-20 16:29:06] [config] ulr-trainable-transformation: false
[2023-06-20 16:29:06] [config] unlikelihood-loss: false
[2023-06-20 16:29:06] [config] valid-freq: 5000000
[2023-06-20 16:29:06] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 16:29:06] [config] valid-max-length: 1000
[2023-06-20 16:29:06] [config] valid-metrics:
[2023-06-20 16:29:06] [config]   - cross-entropy
[2023-06-20 16:29:06] [config] valid-mini-batch: 32
[2023-06-20 16:29:06] [config] valid-reset-stalled: false
[2023-06-20 16:29:06] [config] valid-script-args:
[2023-06-20 16:29:06] [config]   []
[2023-06-20 16:29:06] [config] valid-script-path: ""
[2023-06-20 16:29:06] [config] valid-sets:
[2023-06-20 16:29:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 16:29:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 16:29:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 16:29:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:29:06] [config] vocabs:
[2023-06-20 16:29:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:29:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:29:06] [config] word-penalty: 0
[2023-06-20 16:29:06] [config] word-scores: false
[2023-06-20 16:29:06] [config] workspace: 2048
[2023-06-20 16:29:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:29:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:29:06] [training] Using single-device training
[2023-06-20 16:29:06] Synced seed 1234
[2023-06-20 16:29:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:29:06] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 16:29:06] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:29:06] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 16:29:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:29:07] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 16:29:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 16:29:07] [comm] Using global sharding
[2023-06-20 16:29:07] [comm] NCCLCommunicators constructed successfully
[2023-06-20 16:29:07] [training] Using 1 GPUs
[2023-06-20 16:29:07] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:29:09] Loading Adam parameters
[2023-06-20 16:29:09] [memory] Reserving 754 MB, device gpu0
[2023-06-20 16:29:09] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:29:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 16:29:09] [data] Restoring the corpus state to epoch 2, batch 297
[2023-06-20 16:29:09] [data] Shuffling data
[2023-06-20 16:29:09] [data] Done reading 20,192 sentences
[2023-06-20 16:29:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:29:09] Training started
[2023-06-20 16:29:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 16:29:09] [logits] Applying loss function for 1 factor(s)
[2023-06-20 16:29:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 16:29:10] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:29:10] Parameter type float32, optimization type float32, casting types false
[2023-06-20 16:31:28] Seen 18,843 samples
[2023-06-20 16:31:28] Starting data epoch 3 in logical epoch 3
[2023-06-20 16:31:28] Training finished
[2023-06-20 16:31:42] [valid] Ep. 3 : Up. 594 : cross-entropy : 122.173 : new best
[2023-06-20 16:31:42] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:31:46] Saving Adam parameters
[2023-06-20 16:31:47] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 16:39:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:39:54] [marian] Running on node21.datos.cluster.uy as process 30580 with command line:
[2023-06-20 16:39:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 16:39:54] [config] after: 0e
[2023-06-20 16:39:54] [config] after-batches: 0
[2023-06-20 16:39:54] [config] after-epochs: 10
[2023-06-20 16:39:54] [config] all-caps-every: 0
[2023-06-20 16:39:54] [config] allow-unk: false
[2023-06-20 16:39:54] [config] authors: false
[2023-06-20 16:39:54] [config] beam-size: 12
[2023-06-20 16:39:54] [config] bert-class-symbol: "[CLS]"
[2023-06-20 16:39:54] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 16:39:54] [config] bert-masking-fraction: 0.15
[2023-06-20 16:39:54] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 16:39:54] [config] bert-train-type-embeddings: true
[2023-06-20 16:39:54] [config] bert-type-vocab-size: 2
[2023-06-20 16:39:54] [config] build-info: ""
[2023-06-20 16:39:54] [config] check-gradient-nan: false
[2023-06-20 16:39:54] [config] check-nan: false
[2023-06-20 16:39:54] [config] cite: false
[2023-06-20 16:39:54] [config] clip-norm: 1
[2023-06-20 16:39:54] [config] cost-scaling:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] cost-type: ce-sum
[2023-06-20 16:39:54] [config] cpu-threads: 0
[2023-06-20 16:39:54] [config] data-threads: 8
[2023-06-20 16:39:54] [config] data-weighting: ""
[2023-06-20 16:39:54] [config] data-weighting-type: sentence
[2023-06-20 16:39:54] [config] dec-cell: gru
[2023-06-20 16:39:54] [config] dec-cell-base-depth: 2
[2023-06-20 16:39:54] [config] dec-cell-high-depth: 1
[2023-06-20 16:39:54] [config] dec-depth: 1
[2023-06-20 16:39:54] [config] devices:
[2023-06-20 16:39:54] [config]   - 0
[2023-06-20 16:39:54] [config] dim-emb: 512
[2023-06-20 16:39:54] [config] dim-rnn: 1024
[2023-06-20 16:39:54] [config] dim-vocabs:
[2023-06-20 16:39:54] [config]   - 0
[2023-06-20 16:39:54] [config]   - 0
[2023-06-20 16:39:54] [config] disp-first: 0
[2023-06-20 16:39:54] [config] disp-freq: 1000u
[2023-06-20 16:39:54] [config] disp-label-counts: true
[2023-06-20 16:39:54] [config] dropout-rnn: 0
[2023-06-20 16:39:54] [config] dropout-src: 0
[2023-06-20 16:39:54] [config] dropout-trg: 0
[2023-06-20 16:39:54] [config] dump-config: ""
[2023-06-20 16:39:54] [config] dynamic-gradient-scaling:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] early-stopping: 10
[2023-06-20 16:39:54] [config] early-stopping-on: first
[2023-06-20 16:39:54] [config] embedding-fix-src: false
[2023-06-20 16:39:54] [config] embedding-fix-trg: false
[2023-06-20 16:39:54] [config] embedding-normalization: false
[2023-06-20 16:39:54] [config] embedding-vectors:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] enc-cell: gru
[2023-06-20 16:39:54] [config] enc-cell-depth: 1
[2023-06-20 16:39:54] [config] enc-depth: 1
[2023-06-20 16:39:54] [config] enc-type: bidirectional
[2023-06-20 16:39:54] [config] english-title-case-every: 0
[2023-06-20 16:39:54] [config] exponential-smoothing: 0
[2023-06-20 16:39:54] [config] factor-weight: 1
[2023-06-20 16:39:54] [config] factors-combine: sum
[2023-06-20 16:39:54] [config] factors-dim-emb: 0
[2023-06-20 16:39:54] [config] gradient-checkpointing: false
[2023-06-20 16:39:54] [config] gradient-norm-average-window: 100
[2023-06-20 16:39:54] [config] guided-alignment: none
[2023-06-20 16:39:54] [config] guided-alignment-cost: mse
[2023-06-20 16:39:54] [config] guided-alignment-weight: 0.1
[2023-06-20 16:39:54] [config] ignore-model-config: false
[2023-06-20 16:39:54] [config] input-types:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] interpolate-env-vars: false
[2023-06-20 16:39:54] [config] keep-best: false
[2023-06-20 16:39:54] [config] label-smoothing: 0
[2023-06-20 16:39:54] [config] layer-normalization: false
[2023-06-20 16:39:54] [config] learn-rate: 0.0001
[2023-06-20 16:39:54] [config] lemma-dependency: ""
[2023-06-20 16:39:54] [config] lemma-dim-emb: 0
[2023-06-20 16:39:54] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 16:39:54] [config] log-level: info
[2023-06-20 16:39:54] [config] log-time-zone: ""
[2023-06-20 16:39:54] [config] logical-epoch:
[2023-06-20 16:39:54] [config]   - 1e
[2023-06-20 16:39:54] [config]   - 0
[2023-06-20 16:39:54] [config] lr-decay: 0
[2023-06-20 16:39:54] [config] lr-decay-freq: 50000
[2023-06-20 16:39:54] [config] lr-decay-inv-sqrt:
[2023-06-20 16:39:54] [config]   - 0
[2023-06-20 16:39:54] [config] lr-decay-repeat-warmup: false
[2023-06-20 16:39:54] [config] lr-decay-reset-optimizer: false
[2023-06-20 16:39:54] [config] lr-decay-start:
[2023-06-20 16:39:54] [config]   - 10
[2023-06-20 16:39:54] [config]   - 1
[2023-06-20 16:39:54] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 16:39:54] [config] lr-report: false
[2023-06-20 16:39:54] [config] lr-warmup: 0
[2023-06-20 16:39:54] [config] lr-warmup-at-reload: false
[2023-06-20 16:39:54] [config] lr-warmup-cycle: false
[2023-06-20 16:39:54] [config] lr-warmup-start-rate: 0
[2023-06-20 16:39:54] [config] max-length: 50
[2023-06-20 16:39:54] [config] max-length-crop: false
[2023-06-20 16:39:54] [config] max-length-factor: 3
[2023-06-20 16:39:54] [config] maxi-batch: 100
[2023-06-20 16:39:54] [config] maxi-batch-sort: trg
[2023-06-20 16:39:54] [config] mini-batch: 64
[2023-06-20 16:39:54] [config] mini-batch-fit: false
[2023-06-20 16:39:54] [config] mini-batch-fit-step: 10
[2023-06-20 16:39:54] [config] mini-batch-round-up: true
[2023-06-20 16:39:54] [config] mini-batch-track-lr: false
[2023-06-20 16:39:54] [config] mini-batch-warmup: 0
[2023-06-20 16:39:54] [config] mini-batch-words: 0
[2023-06-20 16:39:54] [config] mini-batch-words-ref: 0
[2023-06-20 16:39:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:39:54] [config] multi-loss-type: sum
[2023-06-20 16:39:54] [config] n-best: false
[2023-06-20 16:39:54] [config] no-nccl: false
[2023-06-20 16:39:54] [config] no-reload: false
[2023-06-20 16:39:54] [config] no-restore-corpus: false
[2023-06-20 16:39:54] [config] normalize: 0
[2023-06-20 16:39:54] [config] normalize-gradient: false
[2023-06-20 16:39:54] [config] num-devices: 0
[2023-06-20 16:39:54] [config] optimizer: adam
[2023-06-20 16:39:54] [config] optimizer-delay: 1
[2023-06-20 16:39:54] [config] optimizer-params:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] output-omit-bias: false
[2023-06-20 16:39:54] [config] overwrite: false
[2023-06-20 16:39:54] [config] precision:
[2023-06-20 16:39:54] [config]   - float32
[2023-06-20 16:39:54] [config]   - float32
[2023-06-20 16:39:54] [config] pretrained-model: ""
[2023-06-20 16:39:54] [config] quantize-biases: false
[2023-06-20 16:39:54] [config] quantize-bits: 0
[2023-06-20 16:39:54] [config] quantize-log-based: false
[2023-06-20 16:39:54] [config] quantize-optimization-steps: 0
[2023-06-20 16:39:54] [config] quiet: false
[2023-06-20 16:39:54] [config] quiet-translation: true
[2023-06-20 16:39:54] [config] relative-paths: false
[2023-06-20 16:39:54] [config] right-left: false
[2023-06-20 16:39:54] [config] save-freq: 10000u
[2023-06-20 16:39:54] [config] seed: 1234
[2023-06-20 16:39:54] [config] sentencepiece-alphas:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] sentencepiece-max-lines: 2000000
[2023-06-20 16:39:54] [config] sentencepiece-options: ""
[2023-06-20 16:39:54] [config] sharding: global
[2023-06-20 16:39:54] [config] shuffle: data
[2023-06-20 16:39:54] [config] shuffle-in-ram: false
[2023-06-20 16:39:54] [config] sigterm: save-and-exit
[2023-06-20 16:39:54] [config] skip: false
[2023-06-20 16:39:54] [config] sqlite: ""
[2023-06-20 16:39:54] [config] sqlite-drop: false
[2023-06-20 16:39:54] [config] sync-freq: 200u
[2023-06-20 16:39:54] [config] sync-sgd: false
[2023-06-20 16:39:54] [config] tempdir: /tmp
[2023-06-20 16:39:54] [config] tied-embeddings: false
[2023-06-20 16:39:54] [config] tied-embeddings-all: false
[2023-06-20 16:39:54] [config] tied-embeddings-src: false
[2023-06-20 16:39:54] [config] train-embedder-rank:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] train-sets:
[2023-06-20 16:39:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 16:39:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 16:39:54] [config] transformer-aan-activation: swish
[2023-06-20 16:39:54] [config] transformer-aan-depth: 2
[2023-06-20 16:39:54] [config] transformer-aan-nogate: false
[2023-06-20 16:39:54] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 16:39:54] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 16:39:54] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 16:39:54] [config] transformer-depth-scaling: false
[2023-06-20 16:39:54] [config] transformer-dim-aan: 2048
[2023-06-20 16:39:54] [config] transformer-dim-ffn: 2048
[2023-06-20 16:39:54] [config] transformer-dropout: 0
[2023-06-20 16:39:54] [config] transformer-dropout-attention: 0
[2023-06-20 16:39:54] [config] transformer-dropout-ffn: 0
[2023-06-20 16:39:54] [config] transformer-ffn-activation: swish
[2023-06-20 16:39:54] [config] transformer-ffn-depth: 2
[2023-06-20 16:39:54] [config] transformer-guided-alignment-layer: last
[2023-06-20 16:39:54] [config] transformer-heads: 8
[2023-06-20 16:39:54] [config] transformer-no-projection: false
[2023-06-20 16:39:54] [config] transformer-pool: false
[2023-06-20 16:39:54] [config] transformer-postprocess: dan
[2023-06-20 16:39:54] [config] transformer-postprocess-emb: d
[2023-06-20 16:39:54] [config] transformer-postprocess-top: ""
[2023-06-20 16:39:54] [config] transformer-preprocess: ""
[2023-06-20 16:39:54] [config] transformer-tied-layers:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] transformer-train-position-embeddings: false
[2023-06-20 16:39:54] [config] tsv: false
[2023-06-20 16:39:54] [config] tsv-fields: 0
[2023-06-20 16:39:54] [config] type: amun
[2023-06-20 16:39:54] [config] ulr: false
[2023-06-20 16:39:54] [config] ulr-dim-emb: 0
[2023-06-20 16:39:54] [config] ulr-dropout: 0
[2023-06-20 16:39:54] [config] ulr-keys-vectors: ""
[2023-06-20 16:39:54] [config] ulr-query-vectors: ""
[2023-06-20 16:39:54] [config] ulr-softmax-temperature: 1
[2023-06-20 16:39:54] [config] ulr-trainable-transformation: false
[2023-06-20 16:39:54] [config] unlikelihood-loss: false
[2023-06-20 16:39:54] [config] valid-freq: 5000000
[2023-06-20 16:39:54] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 16:39:54] [config] valid-max-length: 1000
[2023-06-20 16:39:54] [config] valid-metrics:
[2023-06-20 16:39:54] [config]   - cross-entropy
[2023-06-20 16:39:54] [config] valid-mini-batch: 32
[2023-06-20 16:39:54] [config] valid-reset-stalled: false
[2023-06-20 16:39:54] [config] valid-script-args:
[2023-06-20 16:39:54] [config]   []
[2023-06-20 16:39:54] [config] valid-script-path: ""
[2023-06-20 16:39:54] [config] valid-sets:
[2023-06-20 16:39:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 16:39:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 16:39:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 16:39:54] [config] vocabs:
[2023-06-20 16:39:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:39:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:39:54] [config] word-penalty: 0
[2023-06-20 16:39:54] [config] word-scores: false
[2023-06-20 16:39:54] [config] workspace: 2048
[2023-06-20 16:39:54] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:39:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:39:54] [training] Using single-device training
[2023-06-20 16:39:55] Synced seed 1234
[2023-06-20 16:39:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:39:55] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 16:39:55] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:39:55] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 16:39:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:39:56] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 16:39:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 16:39:57] [comm] Using global sharding
[2023-06-20 16:39:57] [comm] NCCLCommunicators constructed successfully
[2023-06-20 16:39:57] [training] Using 1 GPUs
[2023-06-20 16:39:57] Training started
[2023-06-20 16:39:57] [data] Shuffling data
[2023-06-20 16:39:57] [data] Done reading 20,192 sentences
[2023-06-20 16:39:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:39:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 16:39:57] [logits] Applying loss function for 1 factor(s)
[2023-06-20 16:39:57] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:39:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 16:39:59] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:39:59] Parameter type float32, optimization type float32, casting types false
[2023-06-20 16:39:59] Allocating memory for Adam-specific shards
[2023-06-20 16:39:59] [memory] Reserving 754 MB, device gpu0
[2023-06-20 16:40:38] Seen 18,843 samples
[2023-06-20 16:40:38] Starting data epoch 2 in logical epoch 2
[2023-06-20 16:40:38] [data] Shuffling data
[2023-06-20 16:40:38] [data] Done reading 20,192 sentences
[2023-06-20 16:40:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:41:17] Seen 18,843 samples
[2023-06-20 16:41:17] Starting data epoch 3 in logical epoch 3
[2023-06-20 16:41:17] [data] Shuffling data
[2023-06-20 16:41:17] [data] Done reading 20,192 sentences
[2023-06-20 16:41:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:41:56] Seen 18,843 samples
[2023-06-20 16:41:56] Starting data epoch 4 in logical epoch 4
[2023-06-20 16:41:56] [data] Shuffling data
[2023-06-20 16:41:56] [data] Done reading 20,192 sentences
[2023-06-20 16:41:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:42:10] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 6.20279074 * 1,343,216 @ 768 after 1,343,216 : Time 135.07s : 9944.66 words/s : gNorm 1.2055
[2023-06-20 16:42:35] Seen 18,843 samples
[2023-06-20 16:42:35] Starting data epoch 5 in logical epoch 5
[2023-06-20 16:42:35] [data] Shuffling data
[2023-06-20 16:42:35] [data] Done reading 20,192 sentences
[2023-06-20 16:42:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:43:14] Seen 18,843 samples
[2023-06-20 16:43:14] Starting data epoch 6 in logical epoch 6
[2023-06-20 16:43:14] [data] Shuffling data
[2023-06-20 16:43:14] [data] Done reading 20,192 sentences
[2023-06-20 16:43:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:43:57] Seen 18,843 samples
[2023-06-20 16:43:57] Starting data epoch 7 in logical epoch 7
[2023-06-20 16:43:57] [data] Shuffling data
[2023-06-20 16:43:57] [data] Done reading 20,192 sentences
[2023-06-20 16:43:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:44:28] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 5.28677034 * 1,334,929 @ 2,976 after 2,678,145 : Time 137.87s : 9682.47 words/s : gNorm 1.0628
[2023-06-20 16:44:40] Seen 18,843 samples
[2023-06-20 16:44:40] Starting data epoch 8 in logical epoch 8
[2023-06-20 16:44:40] [data] Shuffling data
[2023-06-20 16:44:40] [data] Done reading 20,192 sentences
[2023-06-20 16:44:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:45:24] Seen 18,843 samples
[2023-06-20 16:45:24] Starting data epoch 9 in logical epoch 9
[2023-06-20 16:45:24] [data] Shuffling data
[2023-06-20 16:45:24] [data] Done reading 20,192 sentences
[2023-06-20 16:45:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:46:07] Seen 18,843 samples
[2023-06-20 16:46:07] Starting data epoch 10 in logical epoch 10
[2023-06-20 16:46:07] [data] Shuffling data
[2023-06-20 16:46:07] [data] Done reading 20,192 sentences
[2023-06-20 16:46:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:46:52] Seen 18,843 samples
[2023-06-20 16:46:52] Starting data epoch 11 in logical epoch 11
[2023-06-20 16:46:52] Training finished
[2023-06-20 16:46:58] [valid] Ep. 11 : Up. 2968 : cross-entropy : 108.422 : new best
[2023-06-20 16:46:59] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:47:02] Saving Adam parameters
[2023-06-20 16:47:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 16:52:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:52:09] [marian] Running on node21.datos.cluster.uy as process 31295 with command line:
[2023-06-20 16:52:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 16:52:09] [config] after: 0e
[2023-06-20 16:52:09] [config] after-batches: 0
[2023-06-20 16:52:09] [config] after-epochs: 20
[2023-06-20 16:52:09] [config] all-caps-every: 0
[2023-06-20 16:52:09] [config] allow-unk: false
[2023-06-20 16:52:09] [config] authors: false
[2023-06-20 16:52:09] [config] beam-size: 12
[2023-06-20 16:52:09] [config] bert-class-symbol: "[CLS]"
[2023-06-20 16:52:09] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 16:52:09] [config] bert-masking-fraction: 0.15
[2023-06-20 16:52:09] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 16:52:09] [config] bert-train-type-embeddings: true
[2023-06-20 16:52:09] [config] bert-type-vocab-size: 2
[2023-06-20 16:52:09] [config] build-info: ""
[2023-06-20 16:52:09] [config] check-gradient-nan: false
[2023-06-20 16:52:09] [config] check-nan: false
[2023-06-20 16:52:09] [config] cite: false
[2023-06-20 16:52:09] [config] clip-norm: 1
[2023-06-20 16:52:09] [config] cost-scaling:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] cost-type: ce-sum
[2023-06-20 16:52:09] [config] cpu-threads: 0
[2023-06-20 16:52:09] [config] data-threads: 8
[2023-06-20 16:52:09] [config] data-weighting: ""
[2023-06-20 16:52:09] [config] data-weighting-type: sentence
[2023-06-20 16:52:09] [config] dec-cell: gru
[2023-06-20 16:52:09] [config] dec-cell-base-depth: 2
[2023-06-20 16:52:09] [config] dec-cell-high-depth: 1
[2023-06-20 16:52:09] [config] dec-depth: 1
[2023-06-20 16:52:09] [config] devices:
[2023-06-20 16:52:09] [config]   - 0
[2023-06-20 16:52:09] [config] dim-emb: 512
[2023-06-20 16:52:09] [config] dim-rnn: 1024
[2023-06-20 16:52:09] [config] dim-vocabs:
[2023-06-20 16:52:09] [config]   - 54042
[2023-06-20 16:52:09] [config]   - 36507
[2023-06-20 16:52:09] [config] disp-first: 0
[2023-06-20 16:52:09] [config] disp-freq: 1000u
[2023-06-20 16:52:09] [config] disp-label-counts: true
[2023-06-20 16:52:09] [config] dropout-rnn: 0
[2023-06-20 16:52:09] [config] dropout-src: 0
[2023-06-20 16:52:09] [config] dropout-trg: 0
[2023-06-20 16:52:09] [config] dump-config: ""
[2023-06-20 16:52:09] [config] dynamic-gradient-scaling:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] early-stopping: 10
[2023-06-20 16:52:09] [config] early-stopping-on: first
[2023-06-20 16:52:09] [config] embedding-fix-src: false
[2023-06-20 16:52:09] [config] embedding-fix-trg: false
[2023-06-20 16:52:09] [config] embedding-normalization: false
[2023-06-20 16:52:09] [config] embedding-vectors:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] enc-cell: gru
[2023-06-20 16:52:09] [config] enc-cell-depth: 1
[2023-06-20 16:52:09] [config] enc-depth: 1
[2023-06-20 16:52:09] [config] enc-type: bidirectional
[2023-06-20 16:52:09] [config] english-title-case-every: 0
[2023-06-20 16:52:09] [config] exponential-smoothing: 0
[2023-06-20 16:52:09] [config] factor-weight: 1
[2023-06-20 16:52:09] [config] factors-combine: sum
[2023-06-20 16:52:09] [config] factors-dim-emb: 0
[2023-06-20 16:52:09] [config] gradient-checkpointing: false
[2023-06-20 16:52:09] [config] gradient-norm-average-window: 100
[2023-06-20 16:52:09] [config] guided-alignment: none
[2023-06-20 16:52:09] [config] guided-alignment-cost: mse
[2023-06-20 16:52:09] [config] guided-alignment-weight: 0.1
[2023-06-20 16:52:09] [config] ignore-model-config: false
[2023-06-20 16:52:09] [config] input-types:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] interpolate-env-vars: false
[2023-06-20 16:52:09] [config] keep-best: false
[2023-06-20 16:52:09] [config] label-smoothing: 0
[2023-06-20 16:52:09] [config] layer-normalization: false
[2023-06-20 16:52:09] [config] learn-rate: 0.0001
[2023-06-20 16:52:09] [config] lemma-dependency: ""
[2023-06-20 16:52:09] [config] lemma-dim-emb: 0
[2023-06-20 16:52:09] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 16:52:09] [config] log-level: info
[2023-06-20 16:52:09] [config] log-time-zone: ""
[2023-06-20 16:52:09] [config] logical-epoch:
[2023-06-20 16:52:09] [config]   - 1e
[2023-06-20 16:52:09] [config]   - 0
[2023-06-20 16:52:09] [config] lr-decay: 0
[2023-06-20 16:52:09] [config] lr-decay-freq: 50000
[2023-06-20 16:52:09] [config] lr-decay-inv-sqrt:
[2023-06-20 16:52:09] [config]   - 0
[2023-06-20 16:52:09] [config] lr-decay-repeat-warmup: false
[2023-06-20 16:52:09] [config] lr-decay-reset-optimizer: false
[2023-06-20 16:52:09] [config] lr-decay-start:
[2023-06-20 16:52:09] [config]   - 10
[2023-06-20 16:52:09] [config]   - 1
[2023-06-20 16:52:09] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 16:52:09] [config] lr-report: false
[2023-06-20 16:52:09] [config] lr-warmup: 0
[2023-06-20 16:52:09] [config] lr-warmup-at-reload: false
[2023-06-20 16:52:09] [config] lr-warmup-cycle: false
[2023-06-20 16:52:09] [config] lr-warmup-start-rate: 0
[2023-06-20 16:52:09] [config] max-length: 50
[2023-06-20 16:52:09] [config] max-length-crop: false
[2023-06-20 16:52:09] [config] max-length-factor: 3
[2023-06-20 16:52:09] [config] maxi-batch: 100
[2023-06-20 16:52:09] [config] maxi-batch-sort: trg
[2023-06-20 16:52:09] [config] mini-batch: 64
[2023-06-20 16:52:09] [config] mini-batch-fit: false
[2023-06-20 16:52:09] [config] mini-batch-fit-step: 10
[2023-06-20 16:52:09] [config] mini-batch-round-up: true
[2023-06-20 16:52:09] [config] mini-batch-track-lr: false
[2023-06-20 16:52:09] [config] mini-batch-warmup: 0
[2023-06-20 16:52:09] [config] mini-batch-words: 0
[2023-06-20 16:52:09] [config] mini-batch-words-ref: 0
[2023-06-20 16:52:09] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:52:09] [config] multi-loss-type: sum
[2023-06-20 16:52:09] [config] n-best: false
[2023-06-20 16:52:09] [config] no-nccl: false
[2023-06-20 16:52:09] [config] no-reload: false
[2023-06-20 16:52:09] [config] no-restore-corpus: false
[2023-06-20 16:52:09] [config] normalize: 0
[2023-06-20 16:52:09] [config] normalize-gradient: false
[2023-06-20 16:52:09] [config] num-devices: 0
[2023-06-20 16:52:09] [config] optimizer: adam
[2023-06-20 16:52:09] [config] optimizer-delay: 1
[2023-06-20 16:52:09] [config] optimizer-params:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] output-omit-bias: false
[2023-06-20 16:52:09] [config] overwrite: false
[2023-06-20 16:52:09] [config] precision:
[2023-06-20 16:52:09] [config]   - float32
[2023-06-20 16:52:09] [config]   - float32
[2023-06-20 16:52:09] [config] pretrained-model: ""
[2023-06-20 16:52:09] [config] quantize-biases: false
[2023-06-20 16:52:09] [config] quantize-bits: 0
[2023-06-20 16:52:09] [config] quantize-log-based: false
[2023-06-20 16:52:09] [config] quantize-optimization-steps: 0
[2023-06-20 16:52:09] [config] quiet: false
[2023-06-20 16:52:09] [config] quiet-translation: true
[2023-06-20 16:52:09] [config] relative-paths: false
[2023-06-20 16:52:09] [config] right-left: false
[2023-06-20 16:52:09] [config] save-freq: 10000u
[2023-06-20 16:52:09] [config] seed: 1234
[2023-06-20 16:52:09] [config] sentencepiece-alphas:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] sentencepiece-max-lines: 2000000
[2023-06-20 16:52:09] [config] sentencepiece-options: ""
[2023-06-20 16:52:09] [config] sharding: global
[2023-06-20 16:52:09] [config] shuffle: data
[2023-06-20 16:52:09] [config] shuffle-in-ram: false
[2023-06-20 16:52:09] [config] sigterm: save-and-exit
[2023-06-20 16:52:09] [config] skip: false
[2023-06-20 16:52:09] [config] sqlite: ""
[2023-06-20 16:52:09] [config] sqlite-drop: false
[2023-06-20 16:52:09] [config] sync-freq: 200u
[2023-06-20 16:52:09] [config] sync-sgd: false
[2023-06-20 16:52:09] [config] tempdir: /tmp
[2023-06-20 16:52:09] [config] tied-embeddings: false
[2023-06-20 16:52:09] [config] tied-embeddings-all: false
[2023-06-20 16:52:09] [config] tied-embeddings-src: false
[2023-06-20 16:52:09] [config] train-embedder-rank:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] train-sets:
[2023-06-20 16:52:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 16:52:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 16:52:09] [config] transformer-aan-activation: swish
[2023-06-20 16:52:09] [config] transformer-aan-depth: 2
[2023-06-20 16:52:09] [config] transformer-aan-nogate: false
[2023-06-20 16:52:09] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 16:52:09] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 16:52:09] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 16:52:09] [config] transformer-depth-scaling: false
[2023-06-20 16:52:09] [config] transformer-dim-aan: 2048
[2023-06-20 16:52:09] [config] transformer-dim-ffn: 2048
[2023-06-20 16:52:09] [config] transformer-dropout: 0
[2023-06-20 16:52:09] [config] transformer-dropout-attention: 0
[2023-06-20 16:52:09] [config] transformer-dropout-ffn: 0
[2023-06-20 16:52:09] [config] transformer-ffn-activation: swish
[2023-06-20 16:52:09] [config] transformer-ffn-depth: 2
[2023-06-20 16:52:09] [config] transformer-guided-alignment-layer: last
[2023-06-20 16:52:09] [config] transformer-heads: 8
[2023-06-20 16:52:09] [config] transformer-no-projection: false
[2023-06-20 16:52:09] [config] transformer-pool: false
[2023-06-20 16:52:09] [config] transformer-postprocess: dan
[2023-06-20 16:52:09] [config] transformer-postprocess-emb: d
[2023-06-20 16:52:09] [config] transformer-postprocess-top: ""
[2023-06-20 16:52:09] [config] transformer-preprocess: ""
[2023-06-20 16:52:09] [config] transformer-tied-layers:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] transformer-train-position-embeddings: false
[2023-06-20 16:52:09] [config] tsv: false
[2023-06-20 16:52:09] [config] tsv-fields: 0
[2023-06-20 16:52:09] [config] type: amun
[2023-06-20 16:52:09] [config] ulr: false
[2023-06-20 16:52:09] [config] ulr-dim-emb: 0
[2023-06-20 16:52:09] [config] ulr-dropout: 0
[2023-06-20 16:52:09] [config] ulr-keys-vectors: ""
[2023-06-20 16:52:09] [config] ulr-query-vectors: ""
[2023-06-20 16:52:09] [config] ulr-softmax-temperature: 1
[2023-06-20 16:52:09] [config] ulr-trainable-transformation: false
[2023-06-20 16:52:09] [config] unlikelihood-loss: false
[2023-06-20 16:52:09] [config] valid-freq: 5000000
[2023-06-20 16:52:09] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 16:52:09] [config] valid-max-length: 1000
[2023-06-20 16:52:09] [config] valid-metrics:
[2023-06-20 16:52:09] [config]   - cross-entropy
[2023-06-20 16:52:09] [config] valid-mini-batch: 32
[2023-06-20 16:52:09] [config] valid-reset-stalled: false
[2023-06-20 16:52:09] [config] valid-script-args:
[2023-06-20 16:52:09] [config]   []
[2023-06-20 16:52:09] [config] valid-script-path: ""
[2023-06-20 16:52:09] [config] valid-sets:
[2023-06-20 16:52:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 16:52:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 16:52:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 16:52:09] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:52:09] [config] vocabs:
[2023-06-20 16:52:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:52:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:52:09] [config] word-penalty: 0
[2023-06-20 16:52:09] [config] word-scores: false
[2023-06-20 16:52:09] [config] workspace: 2048
[2023-06-20 16:52:09] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 16:52:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:52:09] [training] Using single-device training
[2023-06-20 16:52:09] Synced seed 1234
[2023-06-20 16:52:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 16:52:09] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 16:52:09] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 16:52:09] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 16:52:09] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 16:52:10] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 16:52:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 16:52:10] [comm] Using global sharding
[2023-06-20 16:52:10] [comm] NCCLCommunicators constructed successfully
[2023-06-20 16:52:10] [training] Using 1 GPUs
[2023-06-20 16:52:10] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:52:13] Loading Adam parameters
[2023-06-20 16:52:13] [memory] Reserving 754 MB, device gpu0
[2023-06-20 16:52:13] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:52:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 16:52:13] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-06-20 16:52:13] [data] Shuffling data
[2023-06-20 16:52:13] [data] Done reading 20,192 sentences
[2023-06-20 16:52:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:52:13] Training started
[2023-06-20 16:52:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 16:52:13] [logits] Applying loss function for 1 factor(s)
[2023-06-20 16:52:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 16:52:14] [memory] Reserving 377 MB, device gpu0
[2023-06-20 16:52:14] Parameter type float32, optimization type float32, casting types false
[2023-06-20 16:52:18] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 4.78844738 * 1,343,919 @ 1,536 after 4,022,064 : Time 8.50s : 158190.96 words/s : gNorm 1.0249
[2023-06-20 16:52:56] Seen 18,843 samples
[2023-06-20 16:52:56] Starting data epoch 12 in logical epoch 12
[2023-06-20 16:52:56] [data] Shuffling data
[2023-06-20 16:52:56] [data] Done reading 20,192 sentences
[2023-06-20 16:52:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:53:41] Seen 18,843 samples
[2023-06-20 16:53:41] Starting data epoch 13 in logical epoch 13
[2023-06-20 16:53:41] [data] Shuffling data
[2023-06-20 16:53:41] [data] Done reading 20,192 sentences
[2023-06-20 16:53:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:54:26] Seen 18,843 samples
[2023-06-20 16:54:26] Starting data epoch 14 in logical epoch 14
[2023-06-20 16:54:26] [data] Shuffling data
[2023-06-20 16:54:26] [data] Done reading 20,192 sentences
[2023-06-20 16:54:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:54:48] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 4.41205502 * 1,354,393 @ 2,176 after 5,376,457 : Time 150.58s : 8994.72 words/s : gNorm 1.1053
[2023-06-20 16:55:10] Seen 18,843 samples
[2023-06-20 16:55:10] Starting data epoch 15 in logical epoch 15
[2023-06-20 16:55:10] [data] Shuffling data
[2023-06-20 16:55:10] [data] Done reading 20,192 sentences
[2023-06-20 16:55:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:55:55] Seen 18,843 samples
[2023-06-20 16:55:55] Starting data epoch 16 in logical epoch 16
[2023-06-20 16:55:55] [data] Shuffling data
[2023-06-20 16:55:55] [data] Done reading 20,192 sentences
[2023-06-20 16:55:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:56:40] Seen 18,843 samples
[2023-06-20 16:56:40] Starting data epoch 17 in logical epoch 17
[2023-06-20 16:56:40] [data] Shuffling data
[2023-06-20 16:56:40] [data] Done reading 20,192 sentences
[2023-06-20 16:56:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:57:18] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 4.09350443 * 1,331,522 @ 1,216 after 6,707,979 : Time 149.54s : 8903.92 words/s : gNorm 1.2411
[2023-06-20 16:57:24] Seen 18,843 samples
[2023-06-20 16:57:24] Starting data epoch 18 in logical epoch 18
[2023-06-20 16:57:24] [data] Shuffling data
[2023-06-20 16:57:24] [data] Done reading 20,192 sentences
[2023-06-20 16:57:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:58:09] Seen 18,843 samples
[2023-06-20 16:58:09] Starting data epoch 19 in logical epoch 19
[2023-06-20 16:58:09] [data] Shuffling data
[2023-06-20 16:58:10] [data] Done reading 20,192 sentences
[2023-06-20 16:58:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:58:54] Seen 18,843 samples
[2023-06-20 16:58:54] Starting data epoch 20 in logical epoch 20
[2023-06-20 16:58:54] [data] Shuffling data
[2023-06-20 16:58:54] [data] Done reading 20,192 sentences
[2023-06-20 16:58:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 16:59:39] Seen 18,843 samples
[2023-06-20 16:59:39] Starting data epoch 21 in logical epoch 21
[2023-06-20 16:59:39] Training finished
[2023-06-20 16:59:45] [valid] Ep. 21 : Up. 5933 : cross-entropy : 110.201 : stalled 1 times (last best: 108.422)
[2023-06-20 16:59:45] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 16:59:49] Saving Adam parameters
[2023-06-20 16:59:50] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:04:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:04:47] [marian] Running on node21.datos.cluster.uy as process 32384 with command line:
[2023-06-20 17:04:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 17:04:47] [config] after: 0e
[2023-06-20 17:04:47] [config] after-batches: 0
[2023-06-20 17:04:47] [config] after-epochs: 30
[2023-06-20 17:04:47] [config] all-caps-every: 0
[2023-06-20 17:04:47] [config] allow-unk: false
[2023-06-20 17:04:47] [config] authors: false
[2023-06-20 17:04:47] [config] beam-size: 12
[2023-06-20 17:04:47] [config] bert-class-symbol: "[CLS]"
[2023-06-20 17:04:47] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 17:04:47] [config] bert-masking-fraction: 0.15
[2023-06-20 17:04:47] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 17:04:47] [config] bert-train-type-embeddings: true
[2023-06-20 17:04:47] [config] bert-type-vocab-size: 2
[2023-06-20 17:04:47] [config] build-info: ""
[2023-06-20 17:04:47] [config] check-gradient-nan: false
[2023-06-20 17:04:47] [config] check-nan: false
[2023-06-20 17:04:47] [config] cite: false
[2023-06-20 17:04:47] [config] clip-norm: 1
[2023-06-20 17:04:47] [config] cost-scaling:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] cost-type: ce-sum
[2023-06-20 17:04:47] [config] cpu-threads: 0
[2023-06-20 17:04:47] [config] data-threads: 8
[2023-06-20 17:04:47] [config] data-weighting: ""
[2023-06-20 17:04:47] [config] data-weighting-type: sentence
[2023-06-20 17:04:47] [config] dec-cell: gru
[2023-06-20 17:04:47] [config] dec-cell-base-depth: 2
[2023-06-20 17:04:47] [config] dec-cell-high-depth: 1
[2023-06-20 17:04:47] [config] dec-depth: 1
[2023-06-20 17:04:47] [config] devices:
[2023-06-20 17:04:47] [config]   - 0
[2023-06-20 17:04:47] [config] dim-emb: 512
[2023-06-20 17:04:47] [config] dim-rnn: 1024
[2023-06-20 17:04:47] [config] dim-vocabs:
[2023-06-20 17:04:47] [config]   - 54042
[2023-06-20 17:04:47] [config]   - 36507
[2023-06-20 17:04:47] [config] disp-first: 0
[2023-06-20 17:04:47] [config] disp-freq: 1000u
[2023-06-20 17:04:47] [config] disp-label-counts: true
[2023-06-20 17:04:47] [config] dropout-rnn: 0
[2023-06-20 17:04:47] [config] dropout-src: 0
[2023-06-20 17:04:47] [config] dropout-trg: 0
[2023-06-20 17:04:47] [config] dump-config: ""
[2023-06-20 17:04:47] [config] dynamic-gradient-scaling:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] early-stopping: 10
[2023-06-20 17:04:47] [config] early-stopping-on: first
[2023-06-20 17:04:47] [config] embedding-fix-src: false
[2023-06-20 17:04:47] [config] embedding-fix-trg: false
[2023-06-20 17:04:47] [config] embedding-normalization: false
[2023-06-20 17:04:47] [config] embedding-vectors:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] enc-cell: gru
[2023-06-20 17:04:47] [config] enc-cell-depth: 1
[2023-06-20 17:04:47] [config] enc-depth: 1
[2023-06-20 17:04:47] [config] enc-type: bidirectional
[2023-06-20 17:04:47] [config] english-title-case-every: 0
[2023-06-20 17:04:47] [config] exponential-smoothing: 0
[2023-06-20 17:04:47] [config] factor-weight: 1
[2023-06-20 17:04:47] [config] factors-combine: sum
[2023-06-20 17:04:47] [config] factors-dim-emb: 0
[2023-06-20 17:04:47] [config] gradient-checkpointing: false
[2023-06-20 17:04:47] [config] gradient-norm-average-window: 100
[2023-06-20 17:04:47] [config] guided-alignment: none
[2023-06-20 17:04:47] [config] guided-alignment-cost: mse
[2023-06-20 17:04:47] [config] guided-alignment-weight: 0.1
[2023-06-20 17:04:47] [config] ignore-model-config: false
[2023-06-20 17:04:47] [config] input-types:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] interpolate-env-vars: false
[2023-06-20 17:04:47] [config] keep-best: false
[2023-06-20 17:04:47] [config] label-smoothing: 0
[2023-06-20 17:04:47] [config] layer-normalization: false
[2023-06-20 17:04:47] [config] learn-rate: 0.0001
[2023-06-20 17:04:47] [config] lemma-dependency: ""
[2023-06-20 17:04:47] [config] lemma-dim-emb: 0
[2023-06-20 17:04:47] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 17:04:47] [config] log-level: info
[2023-06-20 17:04:47] [config] log-time-zone: ""
[2023-06-20 17:04:47] [config] logical-epoch:
[2023-06-20 17:04:47] [config]   - 1e
[2023-06-20 17:04:47] [config]   - 0
[2023-06-20 17:04:47] [config] lr-decay: 0
[2023-06-20 17:04:47] [config] lr-decay-freq: 50000
[2023-06-20 17:04:47] [config] lr-decay-inv-sqrt:
[2023-06-20 17:04:47] [config]   - 0
[2023-06-20 17:04:47] [config] lr-decay-repeat-warmup: false
[2023-06-20 17:04:47] [config] lr-decay-reset-optimizer: false
[2023-06-20 17:04:47] [config] lr-decay-start:
[2023-06-20 17:04:47] [config]   - 10
[2023-06-20 17:04:47] [config]   - 1
[2023-06-20 17:04:47] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 17:04:47] [config] lr-report: false
[2023-06-20 17:04:47] [config] lr-warmup: 0
[2023-06-20 17:04:47] [config] lr-warmup-at-reload: false
[2023-06-20 17:04:47] [config] lr-warmup-cycle: false
[2023-06-20 17:04:47] [config] lr-warmup-start-rate: 0
[2023-06-20 17:04:47] [config] max-length: 50
[2023-06-20 17:04:47] [config] max-length-crop: false
[2023-06-20 17:04:47] [config] max-length-factor: 3
[2023-06-20 17:04:47] [config] maxi-batch: 100
[2023-06-20 17:04:47] [config] maxi-batch-sort: trg
[2023-06-20 17:04:47] [config] mini-batch: 64
[2023-06-20 17:04:47] [config] mini-batch-fit: false
[2023-06-20 17:04:47] [config] mini-batch-fit-step: 10
[2023-06-20 17:04:47] [config] mini-batch-round-up: true
[2023-06-20 17:04:47] [config] mini-batch-track-lr: false
[2023-06-20 17:04:47] [config] mini-batch-warmup: 0
[2023-06-20 17:04:47] [config] mini-batch-words: 0
[2023-06-20 17:04:47] [config] mini-batch-words-ref: 0
[2023-06-20 17:04:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:04:47] [config] multi-loss-type: sum
[2023-06-20 17:04:47] [config] n-best: false
[2023-06-20 17:04:47] [config] no-nccl: false
[2023-06-20 17:04:47] [config] no-reload: false
[2023-06-20 17:04:47] [config] no-restore-corpus: false
[2023-06-20 17:04:47] [config] normalize: 0
[2023-06-20 17:04:47] [config] normalize-gradient: false
[2023-06-20 17:04:47] [config] num-devices: 0
[2023-06-20 17:04:47] [config] optimizer: adam
[2023-06-20 17:04:47] [config] optimizer-delay: 1
[2023-06-20 17:04:47] [config] optimizer-params:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] output-omit-bias: false
[2023-06-20 17:04:47] [config] overwrite: false
[2023-06-20 17:04:47] [config] precision:
[2023-06-20 17:04:47] [config]   - float32
[2023-06-20 17:04:47] [config]   - float32
[2023-06-20 17:04:47] [config] pretrained-model: ""
[2023-06-20 17:04:47] [config] quantize-biases: false
[2023-06-20 17:04:47] [config] quantize-bits: 0
[2023-06-20 17:04:47] [config] quantize-log-based: false
[2023-06-20 17:04:47] [config] quantize-optimization-steps: 0
[2023-06-20 17:04:47] [config] quiet: false
[2023-06-20 17:04:47] [config] quiet-translation: true
[2023-06-20 17:04:47] [config] relative-paths: false
[2023-06-20 17:04:47] [config] right-left: false
[2023-06-20 17:04:47] [config] save-freq: 10000u
[2023-06-20 17:04:47] [config] seed: 1234
[2023-06-20 17:04:47] [config] sentencepiece-alphas:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] sentencepiece-max-lines: 2000000
[2023-06-20 17:04:47] [config] sentencepiece-options: ""
[2023-06-20 17:04:47] [config] sharding: global
[2023-06-20 17:04:47] [config] shuffle: data
[2023-06-20 17:04:47] [config] shuffle-in-ram: false
[2023-06-20 17:04:47] [config] sigterm: save-and-exit
[2023-06-20 17:04:47] [config] skip: false
[2023-06-20 17:04:47] [config] sqlite: ""
[2023-06-20 17:04:47] [config] sqlite-drop: false
[2023-06-20 17:04:47] [config] sync-freq: 200u
[2023-06-20 17:04:47] [config] sync-sgd: false
[2023-06-20 17:04:47] [config] tempdir: /tmp
[2023-06-20 17:04:47] [config] tied-embeddings: false
[2023-06-20 17:04:47] [config] tied-embeddings-all: false
[2023-06-20 17:04:47] [config] tied-embeddings-src: false
[2023-06-20 17:04:47] [config] train-embedder-rank:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] train-sets:
[2023-06-20 17:04:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 17:04:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 17:04:47] [config] transformer-aan-activation: swish
[2023-06-20 17:04:47] [config] transformer-aan-depth: 2
[2023-06-20 17:04:47] [config] transformer-aan-nogate: false
[2023-06-20 17:04:47] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 17:04:47] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 17:04:47] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 17:04:47] [config] transformer-depth-scaling: false
[2023-06-20 17:04:47] [config] transformer-dim-aan: 2048
[2023-06-20 17:04:47] [config] transformer-dim-ffn: 2048
[2023-06-20 17:04:47] [config] transformer-dropout: 0
[2023-06-20 17:04:47] [config] transformer-dropout-attention: 0
[2023-06-20 17:04:47] [config] transformer-dropout-ffn: 0
[2023-06-20 17:04:47] [config] transformer-ffn-activation: swish
[2023-06-20 17:04:47] [config] transformer-ffn-depth: 2
[2023-06-20 17:04:47] [config] transformer-guided-alignment-layer: last
[2023-06-20 17:04:47] [config] transformer-heads: 8
[2023-06-20 17:04:47] [config] transformer-no-projection: false
[2023-06-20 17:04:47] [config] transformer-pool: false
[2023-06-20 17:04:47] [config] transformer-postprocess: dan
[2023-06-20 17:04:47] [config] transformer-postprocess-emb: d
[2023-06-20 17:04:47] [config] transformer-postprocess-top: ""
[2023-06-20 17:04:47] [config] transformer-preprocess: ""
[2023-06-20 17:04:47] [config] transformer-tied-layers:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] transformer-train-position-embeddings: false
[2023-06-20 17:04:47] [config] tsv: false
[2023-06-20 17:04:47] [config] tsv-fields: 0
[2023-06-20 17:04:47] [config] type: amun
[2023-06-20 17:04:47] [config] ulr: false
[2023-06-20 17:04:47] [config] ulr-dim-emb: 0
[2023-06-20 17:04:47] [config] ulr-dropout: 0
[2023-06-20 17:04:47] [config] ulr-keys-vectors: ""
[2023-06-20 17:04:47] [config] ulr-query-vectors: ""
[2023-06-20 17:04:47] [config] ulr-softmax-temperature: 1
[2023-06-20 17:04:47] [config] ulr-trainable-transformation: false
[2023-06-20 17:04:47] [config] unlikelihood-loss: false
[2023-06-20 17:04:47] [config] valid-freq: 5000000
[2023-06-20 17:04:47] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 17:04:47] [config] valid-max-length: 1000
[2023-06-20 17:04:47] [config] valid-metrics:
[2023-06-20 17:04:47] [config]   - cross-entropy
[2023-06-20 17:04:47] [config] valid-mini-batch: 32
[2023-06-20 17:04:47] [config] valid-reset-stalled: false
[2023-06-20 17:04:47] [config] valid-script-args:
[2023-06-20 17:04:47] [config]   []
[2023-06-20 17:04:47] [config] valid-script-path: ""
[2023-06-20 17:04:47] [config] valid-sets:
[2023-06-20 17:04:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 17:04:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 17:04:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 17:04:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:04:47] [config] vocabs:
[2023-06-20 17:04:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:04:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:04:47] [config] word-penalty: 0
[2023-06-20 17:04:47] [config] word-scores: false
[2023-06-20 17:04:47] [config] workspace: 2048
[2023-06-20 17:04:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:04:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:04:47] [training] Using single-device training
[2023-06-20 17:04:47] Synced seed 1234
[2023-06-20 17:04:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:04:47] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 17:04:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:04:47] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 17:04:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:04:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 17:04:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 17:04:48] [comm] Using global sharding
[2023-06-20 17:04:48] [comm] NCCLCommunicators constructed successfully
[2023-06-20 17:04:48] [training] Using 1 GPUs
[2023-06-20 17:04:48] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:04:51] Loading Adam parameters
[2023-06-20 17:04:51] [memory] Reserving 754 MB, device gpu0
[2023-06-20 17:04:51] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:04:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:04:51] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-06-20 17:04:51] [data] Shuffling data
[2023-06-20 17:04:51] [data] Done reading 20,192 sentences
[2023-06-20 17:04:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:04:51] Training started
[2023-06-20 17:04:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 17:04:51] [logits] Applying loss function for 1 factor(s)
[2023-06-20 17:04:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 17:04:52] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:04:52] Parameter type float32, optimization type float32, casting types false
[2023-06-20 17:05:01] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 3.82352757 * 1,344,567 @ 1,231 after 8,052,546 : Time 13.61s : 98766.94 words/s : gNorm 1.1701
[2023-06-20 17:05:34] Seen 18,843 samples
[2023-06-20 17:05:34] Starting data epoch 22 in logical epoch 22
[2023-06-20 17:05:34] [data] Shuffling data
[2023-06-20 17:05:34] [data] Done reading 20,192 sentences
[2023-06-20 17:05:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:06:19] Seen 18,843 samples
[2023-06-20 17:06:19] Starting data epoch 23 in logical epoch 23
[2023-06-20 17:06:19] [data] Shuffling data
[2023-06-20 17:06:19] [data] Done reading 20,192 sentences
[2023-06-20 17:06:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:07:03] Seen 18,843 samples
[2023-06-20 17:07:03] Starting data epoch 24 in logical epoch 24
[2023-06-20 17:07:03] [data] Shuffling data
[2023-06-20 17:07:03] [data] Done reading 20,192 sentences
[2023-06-20 17:07:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:07:30] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 3.56257653 * 1,339,673 @ 704 after 9,392,219 : Time 149.40s : 8967.19 words/s : gNorm 1.2281
[2023-06-20 17:07:48] Seen 18,843 samples
[2023-06-20 17:07:48] Starting data epoch 25 in logical epoch 25
[2023-06-20 17:07:48] [data] Shuffling data
[2023-06-20 17:07:48] [data] Done reading 20,192 sentences
[2023-06-20 17:07:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:08:33] Seen 18,843 samples
[2023-06-20 17:08:33] Starting data epoch 26 in logical epoch 26
[2023-06-20 17:08:33] [data] Shuffling data
[2023-06-20 17:08:33] [data] Done reading 20,192 sentences
[2023-06-20 17:08:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:09:18] Seen 18,843 samples
[2023-06-20 17:09:18] Starting data epoch 27 in logical epoch 27
[2023-06-20 17:09:18] [data] Shuffling data
[2023-06-20 17:09:18] [data] Done reading 20,192 sentences
[2023-06-20 17:09:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:10:01] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 3.32698798 * 1,339,074 @ 1,034 after 10,731,293 : Time 150.59s : 8892.45 words/s : gNorm 1.2910
[2023-06-20 17:10:02] Seen 18,843 samples
[2023-06-20 17:10:02] Starting data epoch 28 in logical epoch 28
[2023-06-20 17:10:02] [data] Shuffling data
[2023-06-20 17:10:02] [data] Done reading 20,192 sentences
[2023-06-20 17:10:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:10:47] Seen 18,843 samples
[2023-06-20 17:10:47] Starting data epoch 29 in logical epoch 29
[2023-06-20 17:10:47] [data] Shuffling data
[2023-06-20 17:10:47] [data] Done reading 20,192 sentences
[2023-06-20 17:10:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:11:31] Seen 18,843 samples
[2023-06-20 17:11:31] Starting data epoch 30 in logical epoch 30
[2023-06-20 17:11:31] [data] Shuffling data
[2023-06-20 17:11:31] [data] Done reading 20,192 sentences
[2023-06-20 17:11:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:12:16] Seen 18,843 samples
[2023-06-20 17:12:16] Starting data epoch 31 in logical epoch 31
[2023-06-20 17:12:16] Training finished
[2023-06-20 17:12:22] [valid] Ep. 31 : Up. 8898 : cross-entropy : 119.77 : stalled 2 times (last best: 108.422)
[2023-06-20 17:12:22] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:12:25] Saving Adam parameters
[2023-06-20 17:12:26] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:17:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:17:11] [marian] Running on node21.datos.cluster.uy as process 33112 with command line:
[2023-06-20 17:17:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 17:17:11] [config] after: 0e
[2023-06-20 17:17:11] [config] after-batches: 0
[2023-06-20 17:17:11] [config] after-epochs: 40
[2023-06-20 17:17:11] [config] all-caps-every: 0
[2023-06-20 17:17:11] [config] allow-unk: false
[2023-06-20 17:17:11] [config] authors: false
[2023-06-20 17:17:11] [config] beam-size: 12
[2023-06-20 17:17:11] [config] bert-class-symbol: "[CLS]"
[2023-06-20 17:17:11] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 17:17:11] [config] bert-masking-fraction: 0.15
[2023-06-20 17:17:11] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 17:17:11] [config] bert-train-type-embeddings: true
[2023-06-20 17:17:11] [config] bert-type-vocab-size: 2
[2023-06-20 17:17:11] [config] build-info: ""
[2023-06-20 17:17:11] [config] check-gradient-nan: false
[2023-06-20 17:17:11] [config] check-nan: false
[2023-06-20 17:17:11] [config] cite: false
[2023-06-20 17:17:11] [config] clip-norm: 1
[2023-06-20 17:17:11] [config] cost-scaling:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] cost-type: ce-sum
[2023-06-20 17:17:11] [config] cpu-threads: 0
[2023-06-20 17:17:11] [config] data-threads: 8
[2023-06-20 17:17:11] [config] data-weighting: ""
[2023-06-20 17:17:11] [config] data-weighting-type: sentence
[2023-06-20 17:17:11] [config] dec-cell: gru
[2023-06-20 17:17:11] [config] dec-cell-base-depth: 2
[2023-06-20 17:17:11] [config] dec-cell-high-depth: 1
[2023-06-20 17:17:11] [config] dec-depth: 1
[2023-06-20 17:17:11] [config] devices:
[2023-06-20 17:17:11] [config]   - 0
[2023-06-20 17:17:11] [config] dim-emb: 512
[2023-06-20 17:17:11] [config] dim-rnn: 1024
[2023-06-20 17:17:11] [config] dim-vocabs:
[2023-06-20 17:17:11] [config]   - 54042
[2023-06-20 17:17:11] [config]   - 36507
[2023-06-20 17:17:11] [config] disp-first: 0
[2023-06-20 17:17:11] [config] disp-freq: 1000u
[2023-06-20 17:17:11] [config] disp-label-counts: true
[2023-06-20 17:17:11] [config] dropout-rnn: 0
[2023-06-20 17:17:11] [config] dropout-src: 0
[2023-06-20 17:17:11] [config] dropout-trg: 0
[2023-06-20 17:17:11] [config] dump-config: ""
[2023-06-20 17:17:11] [config] dynamic-gradient-scaling:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] early-stopping: 10
[2023-06-20 17:17:11] [config] early-stopping-on: first
[2023-06-20 17:17:11] [config] embedding-fix-src: false
[2023-06-20 17:17:11] [config] embedding-fix-trg: false
[2023-06-20 17:17:11] [config] embedding-normalization: false
[2023-06-20 17:17:11] [config] embedding-vectors:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] enc-cell: gru
[2023-06-20 17:17:11] [config] enc-cell-depth: 1
[2023-06-20 17:17:11] [config] enc-depth: 1
[2023-06-20 17:17:11] [config] enc-type: bidirectional
[2023-06-20 17:17:11] [config] english-title-case-every: 0
[2023-06-20 17:17:11] [config] exponential-smoothing: 0
[2023-06-20 17:17:11] [config] factor-weight: 1
[2023-06-20 17:17:11] [config] factors-combine: sum
[2023-06-20 17:17:11] [config] factors-dim-emb: 0
[2023-06-20 17:17:11] [config] gradient-checkpointing: false
[2023-06-20 17:17:11] [config] gradient-norm-average-window: 100
[2023-06-20 17:17:11] [config] guided-alignment: none
[2023-06-20 17:17:11] [config] guided-alignment-cost: mse
[2023-06-20 17:17:11] [config] guided-alignment-weight: 0.1
[2023-06-20 17:17:11] [config] ignore-model-config: false
[2023-06-20 17:17:11] [config] input-types:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] interpolate-env-vars: false
[2023-06-20 17:17:11] [config] keep-best: false
[2023-06-20 17:17:11] [config] label-smoothing: 0
[2023-06-20 17:17:11] [config] layer-normalization: false
[2023-06-20 17:17:11] [config] learn-rate: 0.0001
[2023-06-20 17:17:11] [config] lemma-dependency: ""
[2023-06-20 17:17:11] [config] lemma-dim-emb: 0
[2023-06-20 17:17:11] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 17:17:11] [config] log-level: info
[2023-06-20 17:17:11] [config] log-time-zone: ""
[2023-06-20 17:17:11] [config] logical-epoch:
[2023-06-20 17:17:11] [config]   - 1e
[2023-06-20 17:17:11] [config]   - 0
[2023-06-20 17:17:11] [config] lr-decay: 0
[2023-06-20 17:17:11] [config] lr-decay-freq: 50000
[2023-06-20 17:17:11] [config] lr-decay-inv-sqrt:
[2023-06-20 17:17:11] [config]   - 0
[2023-06-20 17:17:11] [config] lr-decay-repeat-warmup: false
[2023-06-20 17:17:11] [config] lr-decay-reset-optimizer: false
[2023-06-20 17:17:11] [config] lr-decay-start:
[2023-06-20 17:17:11] [config]   - 10
[2023-06-20 17:17:11] [config]   - 1
[2023-06-20 17:17:11] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 17:17:11] [config] lr-report: false
[2023-06-20 17:17:11] [config] lr-warmup: 0
[2023-06-20 17:17:11] [config] lr-warmup-at-reload: false
[2023-06-20 17:17:11] [config] lr-warmup-cycle: false
[2023-06-20 17:17:11] [config] lr-warmup-start-rate: 0
[2023-06-20 17:17:11] [config] max-length: 50
[2023-06-20 17:17:11] [config] max-length-crop: false
[2023-06-20 17:17:11] [config] max-length-factor: 3
[2023-06-20 17:17:11] [config] maxi-batch: 100
[2023-06-20 17:17:11] [config] maxi-batch-sort: trg
[2023-06-20 17:17:11] [config] mini-batch: 64
[2023-06-20 17:17:11] [config] mini-batch-fit: false
[2023-06-20 17:17:11] [config] mini-batch-fit-step: 10
[2023-06-20 17:17:11] [config] mini-batch-round-up: true
[2023-06-20 17:17:11] [config] mini-batch-track-lr: false
[2023-06-20 17:17:11] [config] mini-batch-warmup: 0
[2023-06-20 17:17:11] [config] mini-batch-words: 0
[2023-06-20 17:17:11] [config] mini-batch-words-ref: 0
[2023-06-20 17:17:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:17:11] [config] multi-loss-type: sum
[2023-06-20 17:17:11] [config] n-best: false
[2023-06-20 17:17:11] [config] no-nccl: false
[2023-06-20 17:17:11] [config] no-reload: false
[2023-06-20 17:17:11] [config] no-restore-corpus: false
[2023-06-20 17:17:11] [config] normalize: 0
[2023-06-20 17:17:11] [config] normalize-gradient: false
[2023-06-20 17:17:11] [config] num-devices: 0
[2023-06-20 17:17:11] [config] optimizer: adam
[2023-06-20 17:17:11] [config] optimizer-delay: 1
[2023-06-20 17:17:11] [config] optimizer-params:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] output-omit-bias: false
[2023-06-20 17:17:11] [config] overwrite: false
[2023-06-20 17:17:11] [config] precision:
[2023-06-20 17:17:11] [config]   - float32
[2023-06-20 17:17:11] [config]   - float32
[2023-06-20 17:17:11] [config] pretrained-model: ""
[2023-06-20 17:17:11] [config] quantize-biases: false
[2023-06-20 17:17:11] [config] quantize-bits: 0
[2023-06-20 17:17:11] [config] quantize-log-based: false
[2023-06-20 17:17:11] [config] quantize-optimization-steps: 0
[2023-06-20 17:17:11] [config] quiet: false
[2023-06-20 17:17:11] [config] quiet-translation: true
[2023-06-20 17:17:11] [config] relative-paths: false
[2023-06-20 17:17:11] [config] right-left: false
[2023-06-20 17:17:11] [config] save-freq: 10000u
[2023-06-20 17:17:11] [config] seed: 1234
[2023-06-20 17:17:11] [config] sentencepiece-alphas:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] sentencepiece-max-lines: 2000000
[2023-06-20 17:17:11] [config] sentencepiece-options: ""
[2023-06-20 17:17:11] [config] sharding: global
[2023-06-20 17:17:11] [config] shuffle: data
[2023-06-20 17:17:11] [config] shuffle-in-ram: false
[2023-06-20 17:17:11] [config] sigterm: save-and-exit
[2023-06-20 17:17:11] [config] skip: false
[2023-06-20 17:17:11] [config] sqlite: ""
[2023-06-20 17:17:11] [config] sqlite-drop: false
[2023-06-20 17:17:11] [config] sync-freq: 200u
[2023-06-20 17:17:11] [config] sync-sgd: false
[2023-06-20 17:17:11] [config] tempdir: /tmp
[2023-06-20 17:17:11] [config] tied-embeddings: false
[2023-06-20 17:17:11] [config] tied-embeddings-all: false
[2023-06-20 17:17:11] [config] tied-embeddings-src: false
[2023-06-20 17:17:11] [config] train-embedder-rank:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] train-sets:
[2023-06-20 17:17:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 17:17:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 17:17:11] [config] transformer-aan-activation: swish
[2023-06-20 17:17:11] [config] transformer-aan-depth: 2
[2023-06-20 17:17:11] [config] transformer-aan-nogate: false
[2023-06-20 17:17:11] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 17:17:11] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 17:17:11] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 17:17:11] [config] transformer-depth-scaling: false
[2023-06-20 17:17:11] [config] transformer-dim-aan: 2048
[2023-06-20 17:17:11] [config] transformer-dim-ffn: 2048
[2023-06-20 17:17:11] [config] transformer-dropout: 0
[2023-06-20 17:17:11] [config] transformer-dropout-attention: 0
[2023-06-20 17:17:11] [config] transformer-dropout-ffn: 0
[2023-06-20 17:17:11] [config] transformer-ffn-activation: swish
[2023-06-20 17:17:11] [config] transformer-ffn-depth: 2
[2023-06-20 17:17:11] [config] transformer-guided-alignment-layer: last
[2023-06-20 17:17:11] [config] transformer-heads: 8
[2023-06-20 17:17:11] [config] transformer-no-projection: false
[2023-06-20 17:17:11] [config] transformer-pool: false
[2023-06-20 17:17:11] [config] transformer-postprocess: dan
[2023-06-20 17:17:11] [config] transformer-postprocess-emb: d
[2023-06-20 17:17:11] [config] transformer-postprocess-top: ""
[2023-06-20 17:17:11] [config] transformer-preprocess: ""
[2023-06-20 17:17:11] [config] transformer-tied-layers:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] transformer-train-position-embeddings: false
[2023-06-20 17:17:11] [config] tsv: false
[2023-06-20 17:17:11] [config] tsv-fields: 0
[2023-06-20 17:17:11] [config] type: amun
[2023-06-20 17:17:11] [config] ulr: false
[2023-06-20 17:17:11] [config] ulr-dim-emb: 0
[2023-06-20 17:17:11] [config] ulr-dropout: 0
[2023-06-20 17:17:11] [config] ulr-keys-vectors: ""
[2023-06-20 17:17:11] [config] ulr-query-vectors: ""
[2023-06-20 17:17:11] [config] ulr-softmax-temperature: 1
[2023-06-20 17:17:11] [config] ulr-trainable-transformation: false
[2023-06-20 17:17:11] [config] unlikelihood-loss: false
[2023-06-20 17:17:11] [config] valid-freq: 5000000
[2023-06-20 17:17:11] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 17:17:11] [config] valid-max-length: 1000
[2023-06-20 17:17:11] [config] valid-metrics:
[2023-06-20 17:17:11] [config]   - cross-entropy
[2023-06-20 17:17:11] [config] valid-mini-batch: 32
[2023-06-20 17:17:11] [config] valid-reset-stalled: false
[2023-06-20 17:17:11] [config] valid-script-args:
[2023-06-20 17:17:11] [config]   []
[2023-06-20 17:17:11] [config] valid-script-path: ""
[2023-06-20 17:17:11] [config] valid-sets:
[2023-06-20 17:17:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 17:17:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 17:17:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 17:17:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:17:11] [config] vocabs:
[2023-06-20 17:17:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:17:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:17:11] [config] word-penalty: 0
[2023-06-20 17:17:11] [config] word-scores: false
[2023-06-20 17:17:11] [config] workspace: 2048
[2023-06-20 17:17:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:17:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:17:11] [training] Using single-device training
[2023-06-20 17:17:12] Synced seed 1234
[2023-06-20 17:17:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:17:12] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 17:17:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:17:12] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 17:17:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:17:13] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 17:17:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 17:17:13] [comm] Using global sharding
[2023-06-20 17:17:13] [comm] NCCLCommunicators constructed successfully
[2023-06-20 17:17:13] [training] Using 1 GPUs
[2023-06-20 17:17:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:17:15] Loading Adam parameters
[2023-06-20 17:17:15] [memory] Reserving 754 MB, device gpu0
[2023-06-20 17:17:16] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:17:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:17:16] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-06-20 17:17:16] [data] Shuffling data
[2023-06-20 17:17:16] [data] Done reading 20,192 sentences
[2023-06-20 17:17:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:17:16] Training started
[2023-06-20 17:17:16] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 17:17:16] [logits] Applying loss function for 1 factor(s)
[2023-06-20 17:17:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 17:17:16] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:17:16] Parameter type float32, optimization type float32, casting types false
[2023-06-20 17:17:30] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 3.08929467 * 1,341,072 @ 320 after 12,072,365 : Time 18.20s : 73671.30 words/s : gNorm 1.4102
[2023-06-20 17:17:59] Seen 18,843 samples
[2023-06-20 17:17:59] Starting data epoch 32 in logical epoch 32
[2023-06-20 17:17:59] [data] Shuffling data
[2023-06-20 17:17:59] [data] Done reading 20,192 sentences
[2023-06-20 17:17:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:18:44] Seen 18,843 samples
[2023-06-20 17:18:44] Starting data epoch 33 in logical epoch 33
[2023-06-20 17:18:44] [data] Shuffling data
[2023-06-20 17:18:44] [data] Done reading 20,192 sentences
[2023-06-20 17:18:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:19:28] Seen 18,843 samples
[2023-06-20 17:19:28] Starting data epoch 34 in logical epoch 34
[2023-06-20 17:19:28] [data] Shuffling data
[2023-06-20 17:19:28] [data] Done reading 20,192 sentences
[2023-06-20 17:19:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:20:00] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 2.87351894 * 1,347,521 @ 882 after 13,419,886 : Time 150.27s : 8967.10 words/s : gNorm 1.3073
[2023-06-20 17:20:00] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.iter10000.npz
[2023-06-20 17:20:04] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:20:07] Saving Adam parameters
[2023-06-20 17:20:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:20:35] Seen 18,843 samples
[2023-06-20 17:20:35] Starting data epoch 35 in logical epoch 35
[2023-06-20 17:20:35] [data] Shuffling data
[2023-06-20 17:20:35] [data] Done reading 20,192 sentences
[2023-06-20 17:20:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:21:17] Seen 18,843 samples
[2023-06-20 17:21:17] Starting data epoch 36 in logical epoch 36
[2023-06-20 17:21:17] [data] Shuffling data
[2023-06-20 17:21:17] [data] Done reading 20,192 sentences
[2023-06-20 17:21:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:22:01] Seen 18,843 samples
[2023-06-20 17:22:01] Starting data epoch 37 in logical epoch 37
[2023-06-20 17:22:01] [data] Shuffling data
[2023-06-20 17:22:01] [data] Done reading 20,192 sentences
[2023-06-20 17:22:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:22:47] Seen 18,843 samples
[2023-06-20 17:22:47] Starting data epoch 38 in logical epoch 38
[2023-06-20 17:22:47] [data] Shuffling data
[2023-06-20 17:22:47] [data] Done reading 20,192 sentences
[2023-06-20 17:22:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:22:51] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 2.65321946 * 1,344,952 @ 1,403 after 14,764,838 : Time 171.12s : 7859.86 words/s : gNorm 1.3626
[2023-06-20 17:23:31] Seen 18,843 samples
[2023-06-20 17:23:31] Starting data epoch 39 in logical epoch 39
[2023-06-20 17:23:31] [data] Shuffling data
[2023-06-20 17:23:31] [data] Done reading 20,192 sentences
[2023-06-20 17:23:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:24:16] Seen 18,843 samples
[2023-06-20 17:24:16] Starting data epoch 40 in logical epoch 40
[2023-06-20 17:24:16] [data] Shuffling data
[2023-06-20 17:24:16] [data] Done reading 20,192 sentences
[2023-06-20 17:24:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:25:01] Seen 18,843 samples
[2023-06-20 17:25:01] Starting data epoch 41 in logical epoch 41
[2023-06-20 17:25:01] Training finished
[2023-06-20 17:25:07] [valid] Ep. 41 : Up. 11864 : cross-entropy : 130.5 : stalled 3 times (last best: 108.422)
[2023-06-20 17:25:07] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:25:11] Saving Adam parameters
[2023-06-20 17:25:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:30:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:30:07] [marian] Running on node21.datos.cluster.uy as process 34202 with command line:
[2023-06-20 17:30:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 17:30:07] [config] after: 0e
[2023-06-20 17:30:07] [config] after-batches: 0
[2023-06-20 17:30:07] [config] after-epochs: 50
[2023-06-20 17:30:07] [config] all-caps-every: 0
[2023-06-20 17:30:07] [config] allow-unk: false
[2023-06-20 17:30:07] [config] authors: false
[2023-06-20 17:30:07] [config] beam-size: 12
[2023-06-20 17:30:07] [config] bert-class-symbol: "[CLS]"
[2023-06-20 17:30:07] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 17:30:07] [config] bert-masking-fraction: 0.15
[2023-06-20 17:30:07] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 17:30:07] [config] bert-train-type-embeddings: true
[2023-06-20 17:30:07] [config] bert-type-vocab-size: 2
[2023-06-20 17:30:07] [config] build-info: ""
[2023-06-20 17:30:07] [config] check-gradient-nan: false
[2023-06-20 17:30:07] [config] check-nan: false
[2023-06-20 17:30:07] [config] cite: false
[2023-06-20 17:30:07] [config] clip-norm: 1
[2023-06-20 17:30:07] [config] cost-scaling:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] cost-type: ce-sum
[2023-06-20 17:30:07] [config] cpu-threads: 0
[2023-06-20 17:30:07] [config] data-threads: 8
[2023-06-20 17:30:07] [config] data-weighting: ""
[2023-06-20 17:30:07] [config] data-weighting-type: sentence
[2023-06-20 17:30:07] [config] dec-cell: gru
[2023-06-20 17:30:07] [config] dec-cell-base-depth: 2
[2023-06-20 17:30:07] [config] dec-cell-high-depth: 1
[2023-06-20 17:30:07] [config] dec-depth: 1
[2023-06-20 17:30:07] [config] devices:
[2023-06-20 17:30:07] [config]   - 0
[2023-06-20 17:30:07] [config] dim-emb: 512
[2023-06-20 17:30:07] [config] dim-rnn: 1024
[2023-06-20 17:30:07] [config] dim-vocabs:
[2023-06-20 17:30:07] [config]   - 54042
[2023-06-20 17:30:07] [config]   - 36507
[2023-06-20 17:30:07] [config] disp-first: 0
[2023-06-20 17:30:07] [config] disp-freq: 1000u
[2023-06-20 17:30:07] [config] disp-label-counts: true
[2023-06-20 17:30:07] [config] dropout-rnn: 0
[2023-06-20 17:30:07] [config] dropout-src: 0
[2023-06-20 17:30:07] [config] dropout-trg: 0
[2023-06-20 17:30:07] [config] dump-config: ""
[2023-06-20 17:30:07] [config] dynamic-gradient-scaling:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] early-stopping: 10
[2023-06-20 17:30:07] [config] early-stopping-on: first
[2023-06-20 17:30:07] [config] embedding-fix-src: false
[2023-06-20 17:30:07] [config] embedding-fix-trg: false
[2023-06-20 17:30:07] [config] embedding-normalization: false
[2023-06-20 17:30:07] [config] embedding-vectors:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] enc-cell: gru
[2023-06-20 17:30:07] [config] enc-cell-depth: 1
[2023-06-20 17:30:07] [config] enc-depth: 1
[2023-06-20 17:30:07] [config] enc-type: bidirectional
[2023-06-20 17:30:07] [config] english-title-case-every: 0
[2023-06-20 17:30:07] [config] exponential-smoothing: 0
[2023-06-20 17:30:07] [config] factor-weight: 1
[2023-06-20 17:30:07] [config] factors-combine: sum
[2023-06-20 17:30:07] [config] factors-dim-emb: 0
[2023-06-20 17:30:07] [config] gradient-checkpointing: false
[2023-06-20 17:30:07] [config] gradient-norm-average-window: 100
[2023-06-20 17:30:07] [config] guided-alignment: none
[2023-06-20 17:30:07] [config] guided-alignment-cost: mse
[2023-06-20 17:30:07] [config] guided-alignment-weight: 0.1
[2023-06-20 17:30:07] [config] ignore-model-config: false
[2023-06-20 17:30:07] [config] input-types:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] interpolate-env-vars: false
[2023-06-20 17:30:07] [config] keep-best: false
[2023-06-20 17:30:07] [config] label-smoothing: 0
[2023-06-20 17:30:07] [config] layer-normalization: false
[2023-06-20 17:30:07] [config] learn-rate: 0.0001
[2023-06-20 17:30:07] [config] lemma-dependency: ""
[2023-06-20 17:30:07] [config] lemma-dim-emb: 0
[2023-06-20 17:30:07] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 17:30:07] [config] log-level: info
[2023-06-20 17:30:07] [config] log-time-zone: ""
[2023-06-20 17:30:07] [config] logical-epoch:
[2023-06-20 17:30:07] [config]   - 1e
[2023-06-20 17:30:07] [config]   - 0
[2023-06-20 17:30:07] [config] lr-decay: 0
[2023-06-20 17:30:07] [config] lr-decay-freq: 50000
[2023-06-20 17:30:07] [config] lr-decay-inv-sqrt:
[2023-06-20 17:30:07] [config]   - 0
[2023-06-20 17:30:07] [config] lr-decay-repeat-warmup: false
[2023-06-20 17:30:07] [config] lr-decay-reset-optimizer: false
[2023-06-20 17:30:07] [config] lr-decay-start:
[2023-06-20 17:30:07] [config]   - 10
[2023-06-20 17:30:07] [config]   - 1
[2023-06-20 17:30:07] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 17:30:07] [config] lr-report: false
[2023-06-20 17:30:07] [config] lr-warmup: 0
[2023-06-20 17:30:07] [config] lr-warmup-at-reload: false
[2023-06-20 17:30:07] [config] lr-warmup-cycle: false
[2023-06-20 17:30:07] [config] lr-warmup-start-rate: 0
[2023-06-20 17:30:07] [config] max-length: 50
[2023-06-20 17:30:07] [config] max-length-crop: false
[2023-06-20 17:30:07] [config] max-length-factor: 3
[2023-06-20 17:30:07] [config] maxi-batch: 100
[2023-06-20 17:30:07] [config] maxi-batch-sort: trg
[2023-06-20 17:30:07] [config] mini-batch: 64
[2023-06-20 17:30:07] [config] mini-batch-fit: false
[2023-06-20 17:30:07] [config] mini-batch-fit-step: 10
[2023-06-20 17:30:07] [config] mini-batch-round-up: true
[2023-06-20 17:30:07] [config] mini-batch-track-lr: false
[2023-06-20 17:30:07] [config] mini-batch-warmup: 0
[2023-06-20 17:30:07] [config] mini-batch-words: 0
[2023-06-20 17:30:07] [config] mini-batch-words-ref: 0
[2023-06-20 17:30:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:30:07] [config] multi-loss-type: sum
[2023-06-20 17:30:07] [config] n-best: false
[2023-06-20 17:30:07] [config] no-nccl: false
[2023-06-20 17:30:07] [config] no-reload: false
[2023-06-20 17:30:07] [config] no-restore-corpus: false
[2023-06-20 17:30:07] [config] normalize: 0
[2023-06-20 17:30:07] [config] normalize-gradient: false
[2023-06-20 17:30:07] [config] num-devices: 0
[2023-06-20 17:30:07] [config] optimizer: adam
[2023-06-20 17:30:07] [config] optimizer-delay: 1
[2023-06-20 17:30:07] [config] optimizer-params:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] output-omit-bias: false
[2023-06-20 17:30:07] [config] overwrite: false
[2023-06-20 17:30:07] [config] precision:
[2023-06-20 17:30:07] [config]   - float32
[2023-06-20 17:30:07] [config]   - float32
[2023-06-20 17:30:07] [config] pretrained-model: ""
[2023-06-20 17:30:07] [config] quantize-biases: false
[2023-06-20 17:30:07] [config] quantize-bits: 0
[2023-06-20 17:30:07] [config] quantize-log-based: false
[2023-06-20 17:30:07] [config] quantize-optimization-steps: 0
[2023-06-20 17:30:07] [config] quiet: false
[2023-06-20 17:30:07] [config] quiet-translation: true
[2023-06-20 17:30:07] [config] relative-paths: false
[2023-06-20 17:30:07] [config] right-left: false
[2023-06-20 17:30:07] [config] save-freq: 10000u
[2023-06-20 17:30:07] [config] seed: 1234
[2023-06-20 17:30:07] [config] sentencepiece-alphas:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] sentencepiece-max-lines: 2000000
[2023-06-20 17:30:07] [config] sentencepiece-options: ""
[2023-06-20 17:30:07] [config] sharding: global
[2023-06-20 17:30:07] [config] shuffle: data
[2023-06-20 17:30:07] [config] shuffle-in-ram: false
[2023-06-20 17:30:07] [config] sigterm: save-and-exit
[2023-06-20 17:30:07] [config] skip: false
[2023-06-20 17:30:07] [config] sqlite: ""
[2023-06-20 17:30:07] [config] sqlite-drop: false
[2023-06-20 17:30:07] [config] sync-freq: 200u
[2023-06-20 17:30:07] [config] sync-sgd: false
[2023-06-20 17:30:07] [config] tempdir: /tmp
[2023-06-20 17:30:07] [config] tied-embeddings: false
[2023-06-20 17:30:07] [config] tied-embeddings-all: false
[2023-06-20 17:30:07] [config] tied-embeddings-src: false
[2023-06-20 17:30:07] [config] train-embedder-rank:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] train-sets:
[2023-06-20 17:30:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 17:30:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 17:30:07] [config] transformer-aan-activation: swish
[2023-06-20 17:30:07] [config] transformer-aan-depth: 2
[2023-06-20 17:30:07] [config] transformer-aan-nogate: false
[2023-06-20 17:30:07] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 17:30:07] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 17:30:07] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 17:30:07] [config] transformer-depth-scaling: false
[2023-06-20 17:30:07] [config] transformer-dim-aan: 2048
[2023-06-20 17:30:07] [config] transformer-dim-ffn: 2048
[2023-06-20 17:30:07] [config] transformer-dropout: 0
[2023-06-20 17:30:07] [config] transformer-dropout-attention: 0
[2023-06-20 17:30:07] [config] transformer-dropout-ffn: 0
[2023-06-20 17:30:07] [config] transformer-ffn-activation: swish
[2023-06-20 17:30:07] [config] transformer-ffn-depth: 2
[2023-06-20 17:30:07] [config] transformer-guided-alignment-layer: last
[2023-06-20 17:30:07] [config] transformer-heads: 8
[2023-06-20 17:30:07] [config] transformer-no-projection: false
[2023-06-20 17:30:07] [config] transformer-pool: false
[2023-06-20 17:30:07] [config] transformer-postprocess: dan
[2023-06-20 17:30:07] [config] transformer-postprocess-emb: d
[2023-06-20 17:30:07] [config] transformer-postprocess-top: ""
[2023-06-20 17:30:07] [config] transformer-preprocess: ""
[2023-06-20 17:30:07] [config] transformer-tied-layers:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] transformer-train-position-embeddings: false
[2023-06-20 17:30:07] [config] tsv: false
[2023-06-20 17:30:07] [config] tsv-fields: 0
[2023-06-20 17:30:07] [config] type: amun
[2023-06-20 17:30:07] [config] ulr: false
[2023-06-20 17:30:07] [config] ulr-dim-emb: 0
[2023-06-20 17:30:07] [config] ulr-dropout: 0
[2023-06-20 17:30:07] [config] ulr-keys-vectors: ""
[2023-06-20 17:30:07] [config] ulr-query-vectors: ""
[2023-06-20 17:30:07] [config] ulr-softmax-temperature: 1
[2023-06-20 17:30:07] [config] ulr-trainable-transformation: false
[2023-06-20 17:30:07] [config] unlikelihood-loss: false
[2023-06-20 17:30:07] [config] valid-freq: 5000000
[2023-06-20 17:30:07] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 17:30:07] [config] valid-max-length: 1000
[2023-06-20 17:30:07] [config] valid-metrics:
[2023-06-20 17:30:07] [config]   - cross-entropy
[2023-06-20 17:30:07] [config] valid-mini-batch: 32
[2023-06-20 17:30:07] [config] valid-reset-stalled: false
[2023-06-20 17:30:07] [config] valid-script-args:
[2023-06-20 17:30:07] [config]   []
[2023-06-20 17:30:07] [config] valid-script-path: ""
[2023-06-20 17:30:07] [config] valid-sets:
[2023-06-20 17:30:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 17:30:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 17:30:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 17:30:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:30:07] [config] vocabs:
[2023-06-20 17:30:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:30:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:30:07] [config] word-penalty: 0
[2023-06-20 17:30:07] [config] word-scores: false
[2023-06-20 17:30:07] [config] workspace: 2048
[2023-06-20 17:30:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:30:07] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:30:07] [training] Using single-device training
[2023-06-20 17:30:08] Synced seed 1234
[2023-06-20 17:30:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:30:08] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 17:30:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:30:08] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 17:30:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:30:09] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 17:30:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 17:30:09] [comm] Using global sharding
[2023-06-20 17:30:09] [comm] NCCLCommunicators constructed successfully
[2023-06-20 17:30:09] [training] Using 1 GPUs
[2023-06-20 17:30:09] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:30:11] Loading Adam parameters
[2023-06-20 17:30:12] [memory] Reserving 754 MB, device gpu0
[2023-06-20 17:30:12] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:30:12] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:30:12] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-06-20 17:30:12] [data] Shuffling data
[2023-06-20 17:30:12] [data] Done reading 20,192 sentences
[2023-06-20 17:30:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:30:12] Training started
[2023-06-20 17:30:12] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 17:30:12] [logits] Applying loss function for 1 factor(s)
[2023-06-20 17:30:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 17:30:12] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:30:13] Parameter type float32, optimization type float32, casting types false
[2023-06-20 17:30:31] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 2.43165922 * 1,335,380 @ 968 after 16,100,218 : Time 23.03s : 57978.53 words/s : gNorm 1.2781
[2023-06-20 17:30:55] Seen 18,843 samples
[2023-06-20 17:30:55] Starting data epoch 42 in logical epoch 42
[2023-06-20 17:30:55] [data] Shuffling data
[2023-06-20 17:30:55] [data] Done reading 20,192 sentences
[2023-06-20 17:30:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:31:39] Seen 18,843 samples
[2023-06-20 17:31:39] Starting data epoch 43 in logical epoch 43
[2023-06-20 17:31:39] [data] Shuffling data
[2023-06-20 17:31:39] [data] Done reading 20,192 sentences
[2023-06-20 17:31:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:32:24] Seen 18,843 samples
[2023-06-20 17:32:24] Starting data epoch 44 in logical epoch 44
[2023-06-20 17:32:24] [data] Shuffling data
[2023-06-20 17:32:24] [data] Done reading 20,192 sentences
[2023-06-20 17:32:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:33:01] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 2.24191475 * 1,337,866 @ 718 after 17,438,084 : Time 149.69s : 8937.73 words/s : gNorm 1.2818
[2023-06-20 17:33:09] Seen 18,843 samples
[2023-06-20 17:33:09] Starting data epoch 45 in logical epoch 45
[2023-06-20 17:33:09] [data] Shuffling data
[2023-06-20 17:33:09] [data] Done reading 20,192 sentences
[2023-06-20 17:33:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:33:53] Seen 18,843 samples
[2023-06-20 17:33:53] Starting data epoch 46 in logical epoch 46
[2023-06-20 17:33:53] [data] Shuffling data
[2023-06-20 17:33:53] [data] Done reading 20,192 sentences
[2023-06-20 17:33:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:34:38] Seen 18,843 samples
[2023-06-20 17:34:38] Starting data epoch 47 in logical epoch 47
[2023-06-20 17:34:38] [data] Shuffling data
[2023-06-20 17:34:38] [data] Done reading 20,192 sentences
[2023-06-20 17:34:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:35:22] Seen 18,843 samples
[2023-06-20 17:35:22] Starting data epoch 48 in logical epoch 48
[2023-06-20 17:35:22] [data] Shuffling data
[2023-06-20 17:35:22] [data] Done reading 20,192 sentences
[2023-06-20 17:35:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:35:32] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 2.05961609 * 1,348,446 @ 1,408 after 18,786,530 : Time 150.97s : 8932.08 words/s : gNorm 1.3576
[2023-06-20 17:36:07] Seen 18,843 samples
[2023-06-20 17:36:07] Starting data epoch 49 in logical epoch 49
[2023-06-20 17:36:07] [data] Shuffling data
[2023-06-20 17:36:07] [data] Done reading 20,192 sentences
[2023-06-20 17:36:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:36:51] Seen 18,843 samples
[2023-06-20 17:36:51] Starting data epoch 50 in logical epoch 50
[2023-06-20 17:36:51] [data] Shuffling data
[2023-06-20 17:36:51] [data] Done reading 20,192 sentences
[2023-06-20 17:36:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:37:36] Seen 18,843 samples
[2023-06-20 17:37:36] Starting data epoch 51 in logical epoch 51
[2023-06-20 17:37:36] Training finished
[2023-06-20 17:37:42] [valid] Ep. 51 : Up. 14829 : cross-entropy : 142.91 : stalled 4 times (last best: 108.422)
[2023-06-20 17:37:42] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:37:46] Saving Adam parameters
[2023-06-20 17:37:47] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:42:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:42:35] [marian] Running on node21.datos.cluster.uy as process 34928 with command line:
[2023-06-20 17:42:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 17:42:35] [config] after: 0e
[2023-06-20 17:42:35] [config] after-batches: 0
[2023-06-20 17:42:35] [config] after-epochs: 60
[2023-06-20 17:42:35] [config] all-caps-every: 0
[2023-06-20 17:42:35] [config] allow-unk: false
[2023-06-20 17:42:35] [config] authors: false
[2023-06-20 17:42:35] [config] beam-size: 12
[2023-06-20 17:42:35] [config] bert-class-symbol: "[CLS]"
[2023-06-20 17:42:35] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 17:42:35] [config] bert-masking-fraction: 0.15
[2023-06-20 17:42:35] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 17:42:35] [config] bert-train-type-embeddings: true
[2023-06-20 17:42:35] [config] bert-type-vocab-size: 2
[2023-06-20 17:42:35] [config] build-info: ""
[2023-06-20 17:42:35] [config] check-gradient-nan: false
[2023-06-20 17:42:35] [config] check-nan: false
[2023-06-20 17:42:35] [config] cite: false
[2023-06-20 17:42:35] [config] clip-norm: 1
[2023-06-20 17:42:35] [config] cost-scaling:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] cost-type: ce-sum
[2023-06-20 17:42:35] [config] cpu-threads: 0
[2023-06-20 17:42:35] [config] data-threads: 8
[2023-06-20 17:42:35] [config] data-weighting: ""
[2023-06-20 17:42:35] [config] data-weighting-type: sentence
[2023-06-20 17:42:35] [config] dec-cell: gru
[2023-06-20 17:42:35] [config] dec-cell-base-depth: 2
[2023-06-20 17:42:35] [config] dec-cell-high-depth: 1
[2023-06-20 17:42:35] [config] dec-depth: 1
[2023-06-20 17:42:35] [config] devices:
[2023-06-20 17:42:35] [config]   - 0
[2023-06-20 17:42:35] [config] dim-emb: 512
[2023-06-20 17:42:35] [config] dim-rnn: 1024
[2023-06-20 17:42:35] [config] dim-vocabs:
[2023-06-20 17:42:35] [config]   - 54042
[2023-06-20 17:42:35] [config]   - 36507
[2023-06-20 17:42:35] [config] disp-first: 0
[2023-06-20 17:42:35] [config] disp-freq: 1000u
[2023-06-20 17:42:35] [config] disp-label-counts: true
[2023-06-20 17:42:35] [config] dropout-rnn: 0
[2023-06-20 17:42:35] [config] dropout-src: 0
[2023-06-20 17:42:35] [config] dropout-trg: 0
[2023-06-20 17:42:35] [config] dump-config: ""
[2023-06-20 17:42:35] [config] dynamic-gradient-scaling:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] early-stopping: 10
[2023-06-20 17:42:35] [config] early-stopping-on: first
[2023-06-20 17:42:35] [config] embedding-fix-src: false
[2023-06-20 17:42:35] [config] embedding-fix-trg: false
[2023-06-20 17:42:35] [config] embedding-normalization: false
[2023-06-20 17:42:35] [config] embedding-vectors:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] enc-cell: gru
[2023-06-20 17:42:35] [config] enc-cell-depth: 1
[2023-06-20 17:42:35] [config] enc-depth: 1
[2023-06-20 17:42:35] [config] enc-type: bidirectional
[2023-06-20 17:42:35] [config] english-title-case-every: 0
[2023-06-20 17:42:35] [config] exponential-smoothing: 0
[2023-06-20 17:42:35] [config] factor-weight: 1
[2023-06-20 17:42:35] [config] factors-combine: sum
[2023-06-20 17:42:35] [config] factors-dim-emb: 0
[2023-06-20 17:42:35] [config] gradient-checkpointing: false
[2023-06-20 17:42:35] [config] gradient-norm-average-window: 100
[2023-06-20 17:42:35] [config] guided-alignment: none
[2023-06-20 17:42:35] [config] guided-alignment-cost: mse
[2023-06-20 17:42:35] [config] guided-alignment-weight: 0.1
[2023-06-20 17:42:35] [config] ignore-model-config: false
[2023-06-20 17:42:35] [config] input-types:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] interpolate-env-vars: false
[2023-06-20 17:42:35] [config] keep-best: false
[2023-06-20 17:42:35] [config] label-smoothing: 0
[2023-06-20 17:42:35] [config] layer-normalization: false
[2023-06-20 17:42:35] [config] learn-rate: 0.0001
[2023-06-20 17:42:35] [config] lemma-dependency: ""
[2023-06-20 17:42:35] [config] lemma-dim-emb: 0
[2023-06-20 17:42:35] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 17:42:35] [config] log-level: info
[2023-06-20 17:42:35] [config] log-time-zone: ""
[2023-06-20 17:42:35] [config] logical-epoch:
[2023-06-20 17:42:35] [config]   - 1e
[2023-06-20 17:42:35] [config]   - 0
[2023-06-20 17:42:35] [config] lr-decay: 0
[2023-06-20 17:42:35] [config] lr-decay-freq: 50000
[2023-06-20 17:42:35] [config] lr-decay-inv-sqrt:
[2023-06-20 17:42:35] [config]   - 0
[2023-06-20 17:42:35] [config] lr-decay-repeat-warmup: false
[2023-06-20 17:42:35] [config] lr-decay-reset-optimizer: false
[2023-06-20 17:42:35] [config] lr-decay-start:
[2023-06-20 17:42:35] [config]   - 10
[2023-06-20 17:42:35] [config]   - 1
[2023-06-20 17:42:35] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 17:42:35] [config] lr-report: false
[2023-06-20 17:42:35] [config] lr-warmup: 0
[2023-06-20 17:42:35] [config] lr-warmup-at-reload: false
[2023-06-20 17:42:35] [config] lr-warmup-cycle: false
[2023-06-20 17:42:35] [config] lr-warmup-start-rate: 0
[2023-06-20 17:42:35] [config] max-length: 50
[2023-06-20 17:42:35] [config] max-length-crop: false
[2023-06-20 17:42:35] [config] max-length-factor: 3
[2023-06-20 17:42:35] [config] maxi-batch: 100
[2023-06-20 17:42:35] [config] maxi-batch-sort: trg
[2023-06-20 17:42:35] [config] mini-batch: 64
[2023-06-20 17:42:35] [config] mini-batch-fit: false
[2023-06-20 17:42:35] [config] mini-batch-fit-step: 10
[2023-06-20 17:42:35] [config] mini-batch-round-up: true
[2023-06-20 17:42:35] [config] mini-batch-track-lr: false
[2023-06-20 17:42:35] [config] mini-batch-warmup: 0
[2023-06-20 17:42:35] [config] mini-batch-words: 0
[2023-06-20 17:42:35] [config] mini-batch-words-ref: 0
[2023-06-20 17:42:35] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:42:35] [config] multi-loss-type: sum
[2023-06-20 17:42:35] [config] n-best: false
[2023-06-20 17:42:35] [config] no-nccl: false
[2023-06-20 17:42:35] [config] no-reload: false
[2023-06-20 17:42:35] [config] no-restore-corpus: false
[2023-06-20 17:42:35] [config] normalize: 0
[2023-06-20 17:42:35] [config] normalize-gradient: false
[2023-06-20 17:42:35] [config] num-devices: 0
[2023-06-20 17:42:35] [config] optimizer: adam
[2023-06-20 17:42:35] [config] optimizer-delay: 1
[2023-06-20 17:42:35] [config] optimizer-params:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] output-omit-bias: false
[2023-06-20 17:42:35] [config] overwrite: false
[2023-06-20 17:42:35] [config] precision:
[2023-06-20 17:42:35] [config]   - float32
[2023-06-20 17:42:35] [config]   - float32
[2023-06-20 17:42:35] [config] pretrained-model: ""
[2023-06-20 17:42:35] [config] quantize-biases: false
[2023-06-20 17:42:35] [config] quantize-bits: 0
[2023-06-20 17:42:35] [config] quantize-log-based: false
[2023-06-20 17:42:35] [config] quantize-optimization-steps: 0
[2023-06-20 17:42:35] [config] quiet: false
[2023-06-20 17:42:35] [config] quiet-translation: true
[2023-06-20 17:42:35] [config] relative-paths: false
[2023-06-20 17:42:35] [config] right-left: false
[2023-06-20 17:42:35] [config] save-freq: 10000u
[2023-06-20 17:42:35] [config] seed: 1234
[2023-06-20 17:42:35] [config] sentencepiece-alphas:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] sentencepiece-max-lines: 2000000
[2023-06-20 17:42:35] [config] sentencepiece-options: ""
[2023-06-20 17:42:35] [config] sharding: global
[2023-06-20 17:42:35] [config] shuffle: data
[2023-06-20 17:42:35] [config] shuffle-in-ram: false
[2023-06-20 17:42:35] [config] sigterm: save-and-exit
[2023-06-20 17:42:35] [config] skip: false
[2023-06-20 17:42:35] [config] sqlite: ""
[2023-06-20 17:42:35] [config] sqlite-drop: false
[2023-06-20 17:42:35] [config] sync-freq: 200u
[2023-06-20 17:42:35] [config] sync-sgd: false
[2023-06-20 17:42:35] [config] tempdir: /tmp
[2023-06-20 17:42:35] [config] tied-embeddings: false
[2023-06-20 17:42:35] [config] tied-embeddings-all: false
[2023-06-20 17:42:35] [config] tied-embeddings-src: false
[2023-06-20 17:42:35] [config] train-embedder-rank:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] train-sets:
[2023-06-20 17:42:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 17:42:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 17:42:35] [config] transformer-aan-activation: swish
[2023-06-20 17:42:35] [config] transformer-aan-depth: 2
[2023-06-20 17:42:35] [config] transformer-aan-nogate: false
[2023-06-20 17:42:35] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 17:42:35] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 17:42:35] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 17:42:35] [config] transformer-depth-scaling: false
[2023-06-20 17:42:35] [config] transformer-dim-aan: 2048
[2023-06-20 17:42:35] [config] transformer-dim-ffn: 2048
[2023-06-20 17:42:35] [config] transformer-dropout: 0
[2023-06-20 17:42:35] [config] transformer-dropout-attention: 0
[2023-06-20 17:42:35] [config] transformer-dropout-ffn: 0
[2023-06-20 17:42:35] [config] transformer-ffn-activation: swish
[2023-06-20 17:42:35] [config] transformer-ffn-depth: 2
[2023-06-20 17:42:35] [config] transformer-guided-alignment-layer: last
[2023-06-20 17:42:35] [config] transformer-heads: 8
[2023-06-20 17:42:35] [config] transformer-no-projection: false
[2023-06-20 17:42:35] [config] transformer-pool: false
[2023-06-20 17:42:35] [config] transformer-postprocess: dan
[2023-06-20 17:42:35] [config] transformer-postprocess-emb: d
[2023-06-20 17:42:35] [config] transformer-postprocess-top: ""
[2023-06-20 17:42:35] [config] transformer-preprocess: ""
[2023-06-20 17:42:35] [config] transformer-tied-layers:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] transformer-train-position-embeddings: false
[2023-06-20 17:42:35] [config] tsv: false
[2023-06-20 17:42:35] [config] tsv-fields: 0
[2023-06-20 17:42:35] [config] type: amun
[2023-06-20 17:42:35] [config] ulr: false
[2023-06-20 17:42:35] [config] ulr-dim-emb: 0
[2023-06-20 17:42:35] [config] ulr-dropout: 0
[2023-06-20 17:42:35] [config] ulr-keys-vectors: ""
[2023-06-20 17:42:35] [config] ulr-query-vectors: ""
[2023-06-20 17:42:35] [config] ulr-softmax-temperature: 1
[2023-06-20 17:42:35] [config] ulr-trainable-transformation: false
[2023-06-20 17:42:35] [config] unlikelihood-loss: false
[2023-06-20 17:42:35] [config] valid-freq: 5000000
[2023-06-20 17:42:35] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 17:42:35] [config] valid-max-length: 1000
[2023-06-20 17:42:35] [config] valid-metrics:
[2023-06-20 17:42:35] [config]   - cross-entropy
[2023-06-20 17:42:35] [config] valid-mini-batch: 32
[2023-06-20 17:42:35] [config] valid-reset-stalled: false
[2023-06-20 17:42:35] [config] valid-script-args:
[2023-06-20 17:42:35] [config]   []
[2023-06-20 17:42:35] [config] valid-script-path: ""
[2023-06-20 17:42:35] [config] valid-sets:
[2023-06-20 17:42:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 17:42:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 17:42:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 17:42:35] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:42:35] [config] vocabs:
[2023-06-20 17:42:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:42:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:42:35] [config] word-penalty: 0
[2023-06-20 17:42:35] [config] word-scores: false
[2023-06-20 17:42:35] [config] workspace: 2048
[2023-06-20 17:42:35] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:42:35] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:42:35] [training] Using single-device training
[2023-06-20 17:42:35] Synced seed 1234
[2023-06-20 17:42:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:42:35] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 17:42:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:42:35] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 17:42:35] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:42:36] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 17:42:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 17:42:36] [comm] Using global sharding
[2023-06-20 17:42:36] [comm] NCCLCommunicators constructed successfully
[2023-06-20 17:42:36] [training] Using 1 GPUs
[2023-06-20 17:42:36] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:42:38] Loading Adam parameters
[2023-06-20 17:42:39] [memory] Reserving 754 MB, device gpu0
[2023-06-20 17:42:39] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:42:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:42:39] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-06-20 17:42:39] [data] Shuffling data
[2023-06-20 17:42:39] [data] Done reading 20,192 sentences
[2023-06-20 17:42:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:42:39] Training started
[2023-06-20 17:42:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 17:42:39] [logits] Applying loss function for 1 factor(s)
[2023-06-20 17:42:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 17:42:39] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:42:39] Parameter type float32, optimization type float32, casting types false
[2023-06-20 17:43:03] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 1.86249244 * 1,333,303 @ 559 after 20,119,833 : Time 27.70s : 48129.46 words/s : gNorm 1.2085
[2023-06-20 17:43:22] Seen 18,843 samples
[2023-06-20 17:43:22] Starting data epoch 52 in logical epoch 52
[2023-06-20 17:43:22] [data] Shuffling data
[2023-06-20 17:43:22] [data] Done reading 20,192 sentences
[2023-06-20 17:43:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:44:06] Seen 18,843 samples
[2023-06-20 17:44:06] Starting data epoch 53 in logical epoch 53
[2023-06-20 17:44:06] [data] Shuffling data
[2023-06-20 17:44:06] [data] Done reading 20,192 sentences
[2023-06-20 17:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:44:51] Seen 18,843 samples
[2023-06-20 17:44:51] Starting data epoch 54 in logical epoch 54
[2023-06-20 17:44:51] [data] Shuffling data
[2023-06-20 17:44:51] [data] Done reading 20,192 sentences
[2023-06-20 17:44:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:45:33] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 1.70626938 * 1,343,441 @ 128 after 21,463,274 : Time 150.68s : 8916.02 words/s : gNorm 1.1846
[2023-06-20 17:45:36] Seen 18,843 samples
[2023-06-20 17:45:36] Starting data epoch 55 in logical epoch 55
[2023-06-20 17:45:36] [data] Shuffling data
[2023-06-20 17:45:36] [data] Done reading 20,192 sentences
[2023-06-20 17:45:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:46:21] Seen 18,843 samples
[2023-06-20 17:46:21] Starting data epoch 56 in logical epoch 56
[2023-06-20 17:46:21] [data] Shuffling data
[2023-06-20 17:46:21] [data] Done reading 20,192 sentences
[2023-06-20 17:46:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:47:05] Seen 18,843 samples
[2023-06-20 17:47:05] Starting data epoch 57 in logical epoch 57
[2023-06-20 17:47:05] [data] Shuffling data
[2023-06-20 17:47:05] [data] Done reading 20,192 sentences
[2023-06-20 17:47:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:47:50] Seen 18,843 samples
[2023-06-20 17:47:50] Starting data epoch 58 in logical epoch 58
[2023-06-20 17:47:50] [data] Shuffling data
[2023-06-20 17:47:50] [data] Done reading 20,192 sentences
[2023-06-20 17:47:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:48:04] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 1.53812170 * 1,347,361 @ 2,048 after 22,810,635 : Time 151.06s : 8919.63 words/s : gNorm 1.1032
[2023-06-20 17:48:35] Seen 18,843 samples
[2023-06-20 17:48:35] Starting data epoch 59 in logical epoch 59
[2023-06-20 17:48:35] [data] Shuffling data
[2023-06-20 17:48:35] [data] Done reading 20,192 sentences
[2023-06-20 17:48:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:49:20] Seen 18,843 samples
[2023-06-20 17:49:20] Starting data epoch 60 in logical epoch 60
[2023-06-20 17:49:20] [data] Shuffling data
[2023-06-20 17:49:20] [data] Done reading 20,192 sentences
[2023-06-20 17:49:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:50:05] Seen 18,843 samples
[2023-06-20 17:50:05] Starting data epoch 61 in logical epoch 61
[2023-06-20 17:50:05] Training finished
[2023-06-20 17:50:11] [valid] Ep. 61 : Up. 17795 : cross-entropy : 154.915 : stalled 5 times (last best: 108.422)
[2023-06-20 17:50:11] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:50:20] Saving Adam parameters
[2023-06-20 17:50:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:55:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:55:08] [marian] Running on node21.datos.cluster.uy as process 35654 with command line:
[2023-06-20 17:55:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 17:55:08] [config] after: 0e
[2023-06-20 17:55:08] [config] after-batches: 0
[2023-06-20 17:55:08] [config] after-epochs: 70
[2023-06-20 17:55:08] [config] all-caps-every: 0
[2023-06-20 17:55:08] [config] allow-unk: false
[2023-06-20 17:55:08] [config] authors: false
[2023-06-20 17:55:08] [config] beam-size: 12
[2023-06-20 17:55:08] [config] bert-class-symbol: "[CLS]"
[2023-06-20 17:55:08] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 17:55:08] [config] bert-masking-fraction: 0.15
[2023-06-20 17:55:08] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 17:55:08] [config] bert-train-type-embeddings: true
[2023-06-20 17:55:08] [config] bert-type-vocab-size: 2
[2023-06-20 17:55:08] [config] build-info: ""
[2023-06-20 17:55:08] [config] check-gradient-nan: false
[2023-06-20 17:55:08] [config] check-nan: false
[2023-06-20 17:55:08] [config] cite: false
[2023-06-20 17:55:08] [config] clip-norm: 1
[2023-06-20 17:55:08] [config] cost-scaling:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] cost-type: ce-sum
[2023-06-20 17:55:08] [config] cpu-threads: 0
[2023-06-20 17:55:08] [config] data-threads: 8
[2023-06-20 17:55:08] [config] data-weighting: ""
[2023-06-20 17:55:08] [config] data-weighting-type: sentence
[2023-06-20 17:55:08] [config] dec-cell: gru
[2023-06-20 17:55:08] [config] dec-cell-base-depth: 2
[2023-06-20 17:55:08] [config] dec-cell-high-depth: 1
[2023-06-20 17:55:08] [config] dec-depth: 1
[2023-06-20 17:55:08] [config] devices:
[2023-06-20 17:55:08] [config]   - 0
[2023-06-20 17:55:08] [config] dim-emb: 512
[2023-06-20 17:55:08] [config] dim-rnn: 1024
[2023-06-20 17:55:08] [config] dim-vocabs:
[2023-06-20 17:55:08] [config]   - 54042
[2023-06-20 17:55:08] [config]   - 36507
[2023-06-20 17:55:08] [config] disp-first: 0
[2023-06-20 17:55:08] [config] disp-freq: 1000u
[2023-06-20 17:55:08] [config] disp-label-counts: true
[2023-06-20 17:55:08] [config] dropout-rnn: 0
[2023-06-20 17:55:08] [config] dropout-src: 0
[2023-06-20 17:55:08] [config] dropout-trg: 0
[2023-06-20 17:55:08] [config] dump-config: ""
[2023-06-20 17:55:08] [config] dynamic-gradient-scaling:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] early-stopping: 10
[2023-06-20 17:55:08] [config] early-stopping-on: first
[2023-06-20 17:55:08] [config] embedding-fix-src: false
[2023-06-20 17:55:08] [config] embedding-fix-trg: false
[2023-06-20 17:55:08] [config] embedding-normalization: false
[2023-06-20 17:55:08] [config] embedding-vectors:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] enc-cell: gru
[2023-06-20 17:55:08] [config] enc-cell-depth: 1
[2023-06-20 17:55:08] [config] enc-depth: 1
[2023-06-20 17:55:08] [config] enc-type: bidirectional
[2023-06-20 17:55:08] [config] english-title-case-every: 0
[2023-06-20 17:55:08] [config] exponential-smoothing: 0
[2023-06-20 17:55:08] [config] factor-weight: 1
[2023-06-20 17:55:08] [config] factors-combine: sum
[2023-06-20 17:55:08] [config] factors-dim-emb: 0
[2023-06-20 17:55:08] [config] gradient-checkpointing: false
[2023-06-20 17:55:08] [config] gradient-norm-average-window: 100
[2023-06-20 17:55:08] [config] guided-alignment: none
[2023-06-20 17:55:08] [config] guided-alignment-cost: mse
[2023-06-20 17:55:08] [config] guided-alignment-weight: 0.1
[2023-06-20 17:55:08] [config] ignore-model-config: false
[2023-06-20 17:55:08] [config] input-types:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] interpolate-env-vars: false
[2023-06-20 17:55:08] [config] keep-best: false
[2023-06-20 17:55:08] [config] label-smoothing: 0
[2023-06-20 17:55:08] [config] layer-normalization: false
[2023-06-20 17:55:08] [config] learn-rate: 0.0001
[2023-06-20 17:55:08] [config] lemma-dependency: ""
[2023-06-20 17:55:08] [config] lemma-dim-emb: 0
[2023-06-20 17:55:08] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 17:55:08] [config] log-level: info
[2023-06-20 17:55:08] [config] log-time-zone: ""
[2023-06-20 17:55:08] [config] logical-epoch:
[2023-06-20 17:55:08] [config]   - 1e
[2023-06-20 17:55:08] [config]   - 0
[2023-06-20 17:55:08] [config] lr-decay: 0
[2023-06-20 17:55:08] [config] lr-decay-freq: 50000
[2023-06-20 17:55:08] [config] lr-decay-inv-sqrt:
[2023-06-20 17:55:08] [config]   - 0
[2023-06-20 17:55:08] [config] lr-decay-repeat-warmup: false
[2023-06-20 17:55:08] [config] lr-decay-reset-optimizer: false
[2023-06-20 17:55:08] [config] lr-decay-start:
[2023-06-20 17:55:08] [config]   - 10
[2023-06-20 17:55:08] [config]   - 1
[2023-06-20 17:55:08] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 17:55:08] [config] lr-report: false
[2023-06-20 17:55:08] [config] lr-warmup: 0
[2023-06-20 17:55:08] [config] lr-warmup-at-reload: false
[2023-06-20 17:55:08] [config] lr-warmup-cycle: false
[2023-06-20 17:55:08] [config] lr-warmup-start-rate: 0
[2023-06-20 17:55:08] [config] max-length: 50
[2023-06-20 17:55:08] [config] max-length-crop: false
[2023-06-20 17:55:08] [config] max-length-factor: 3
[2023-06-20 17:55:08] [config] maxi-batch: 100
[2023-06-20 17:55:08] [config] maxi-batch-sort: trg
[2023-06-20 17:55:08] [config] mini-batch: 64
[2023-06-20 17:55:08] [config] mini-batch-fit: false
[2023-06-20 17:55:08] [config] mini-batch-fit-step: 10
[2023-06-20 17:55:08] [config] mini-batch-round-up: true
[2023-06-20 17:55:08] [config] mini-batch-track-lr: false
[2023-06-20 17:55:08] [config] mini-batch-warmup: 0
[2023-06-20 17:55:08] [config] mini-batch-words: 0
[2023-06-20 17:55:08] [config] mini-batch-words-ref: 0
[2023-06-20 17:55:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:55:08] [config] multi-loss-type: sum
[2023-06-20 17:55:08] [config] n-best: false
[2023-06-20 17:55:08] [config] no-nccl: false
[2023-06-20 17:55:08] [config] no-reload: false
[2023-06-20 17:55:08] [config] no-restore-corpus: false
[2023-06-20 17:55:08] [config] normalize: 0
[2023-06-20 17:55:08] [config] normalize-gradient: false
[2023-06-20 17:55:08] [config] num-devices: 0
[2023-06-20 17:55:08] [config] optimizer: adam
[2023-06-20 17:55:08] [config] optimizer-delay: 1
[2023-06-20 17:55:08] [config] optimizer-params:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] output-omit-bias: false
[2023-06-20 17:55:08] [config] overwrite: false
[2023-06-20 17:55:08] [config] precision:
[2023-06-20 17:55:08] [config]   - float32
[2023-06-20 17:55:08] [config]   - float32
[2023-06-20 17:55:08] [config] pretrained-model: ""
[2023-06-20 17:55:08] [config] quantize-biases: false
[2023-06-20 17:55:08] [config] quantize-bits: 0
[2023-06-20 17:55:08] [config] quantize-log-based: false
[2023-06-20 17:55:08] [config] quantize-optimization-steps: 0
[2023-06-20 17:55:08] [config] quiet: false
[2023-06-20 17:55:08] [config] quiet-translation: true
[2023-06-20 17:55:08] [config] relative-paths: false
[2023-06-20 17:55:08] [config] right-left: false
[2023-06-20 17:55:08] [config] save-freq: 10000u
[2023-06-20 17:55:08] [config] seed: 1234
[2023-06-20 17:55:08] [config] sentencepiece-alphas:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] sentencepiece-max-lines: 2000000
[2023-06-20 17:55:08] [config] sentencepiece-options: ""
[2023-06-20 17:55:08] [config] sharding: global
[2023-06-20 17:55:08] [config] shuffle: data
[2023-06-20 17:55:08] [config] shuffle-in-ram: false
[2023-06-20 17:55:08] [config] sigterm: save-and-exit
[2023-06-20 17:55:08] [config] skip: false
[2023-06-20 17:55:08] [config] sqlite: ""
[2023-06-20 17:55:08] [config] sqlite-drop: false
[2023-06-20 17:55:08] [config] sync-freq: 200u
[2023-06-20 17:55:08] [config] sync-sgd: false
[2023-06-20 17:55:08] [config] tempdir: /tmp
[2023-06-20 17:55:08] [config] tied-embeddings: false
[2023-06-20 17:55:08] [config] tied-embeddings-all: false
[2023-06-20 17:55:08] [config] tied-embeddings-src: false
[2023-06-20 17:55:08] [config] train-embedder-rank:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] train-sets:
[2023-06-20 17:55:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 17:55:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 17:55:08] [config] transformer-aan-activation: swish
[2023-06-20 17:55:08] [config] transformer-aan-depth: 2
[2023-06-20 17:55:08] [config] transformer-aan-nogate: false
[2023-06-20 17:55:08] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 17:55:08] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 17:55:08] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 17:55:08] [config] transformer-depth-scaling: false
[2023-06-20 17:55:08] [config] transformer-dim-aan: 2048
[2023-06-20 17:55:08] [config] transformer-dim-ffn: 2048
[2023-06-20 17:55:08] [config] transformer-dropout: 0
[2023-06-20 17:55:08] [config] transformer-dropout-attention: 0
[2023-06-20 17:55:08] [config] transformer-dropout-ffn: 0
[2023-06-20 17:55:08] [config] transformer-ffn-activation: swish
[2023-06-20 17:55:08] [config] transformer-ffn-depth: 2
[2023-06-20 17:55:08] [config] transformer-guided-alignment-layer: last
[2023-06-20 17:55:08] [config] transformer-heads: 8
[2023-06-20 17:55:08] [config] transformer-no-projection: false
[2023-06-20 17:55:08] [config] transformer-pool: false
[2023-06-20 17:55:08] [config] transformer-postprocess: dan
[2023-06-20 17:55:08] [config] transformer-postprocess-emb: d
[2023-06-20 17:55:08] [config] transformer-postprocess-top: ""
[2023-06-20 17:55:08] [config] transformer-preprocess: ""
[2023-06-20 17:55:08] [config] transformer-tied-layers:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] transformer-train-position-embeddings: false
[2023-06-20 17:55:08] [config] tsv: false
[2023-06-20 17:55:08] [config] tsv-fields: 0
[2023-06-20 17:55:08] [config] type: amun
[2023-06-20 17:55:08] [config] ulr: false
[2023-06-20 17:55:08] [config] ulr-dim-emb: 0
[2023-06-20 17:55:08] [config] ulr-dropout: 0
[2023-06-20 17:55:08] [config] ulr-keys-vectors: ""
[2023-06-20 17:55:08] [config] ulr-query-vectors: ""
[2023-06-20 17:55:08] [config] ulr-softmax-temperature: 1
[2023-06-20 17:55:08] [config] ulr-trainable-transformation: false
[2023-06-20 17:55:08] [config] unlikelihood-loss: false
[2023-06-20 17:55:08] [config] valid-freq: 5000000
[2023-06-20 17:55:08] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 17:55:08] [config] valid-max-length: 1000
[2023-06-20 17:55:08] [config] valid-metrics:
[2023-06-20 17:55:08] [config]   - cross-entropy
[2023-06-20 17:55:08] [config] valid-mini-batch: 32
[2023-06-20 17:55:08] [config] valid-reset-stalled: false
[2023-06-20 17:55:08] [config] valid-script-args:
[2023-06-20 17:55:08] [config]   []
[2023-06-20 17:55:08] [config] valid-script-path: ""
[2023-06-20 17:55:08] [config] valid-sets:
[2023-06-20 17:55:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 17:55:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 17:55:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 17:55:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:55:08] [config] vocabs:
[2023-06-20 17:55:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:55:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:55:08] [config] word-penalty: 0
[2023-06-20 17:55:08] [config] word-scores: false
[2023-06-20 17:55:08] [config] workspace: 2048
[2023-06-20 17:55:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 17:55:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:55:08] [training] Using single-device training
[2023-06-20 17:55:08] Synced seed 1234
[2023-06-20 17:55:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 17:55:08] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 17:55:08] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 17:55:08] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 17:55:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 17:55:09] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 17:55:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 17:55:09] [comm] Using global sharding
[2023-06-20 17:55:09] [comm] NCCLCommunicators constructed successfully
[2023-06-20 17:55:09] [training] Using 1 GPUs
[2023-06-20 17:55:09] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 17:55:11] Loading Adam parameters
[2023-06-20 17:55:12] [memory] Reserving 754 MB, device gpu0
[2023-06-20 17:55:12] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:55:12] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 17:55:12] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-06-20 17:55:12] [data] Shuffling data
[2023-06-20 17:55:12] [data] Done reading 20,192 sentences
[2023-06-20 17:55:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:55:12] Training started
[2023-06-20 17:55:12] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 17:55:12] [logits] Applying loss function for 1 factor(s)
[2023-06-20 17:55:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 17:55:12] [memory] Reserving 377 MB, device gpu0
[2023-06-20 17:55:13] Parameter type float32, optimization type float32, casting types false
[2023-06-20 17:55:41] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 1.38185859 * 1,335,891 @ 1,435 after 24,146,526 : Time 32.80s : 40730.39 words/s : gNorm 1.0668
[2023-06-20 17:55:55] Seen 18,843 samples
[2023-06-20 17:55:55] Starting data epoch 62 in logical epoch 62
[2023-06-20 17:55:55] [data] Shuffling data
[2023-06-20 17:55:55] [data] Done reading 20,192 sentences
[2023-06-20 17:55:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:56:40] Seen 18,843 samples
[2023-06-20 17:56:40] Starting data epoch 63 in logical epoch 63
[2023-06-20 17:56:40] [data] Shuffling data
[2023-06-20 17:56:40] [data] Done reading 20,192 sentences
[2023-06-20 17:56:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:57:24] Seen 18,843 samples
[2023-06-20 17:57:24] Starting data epoch 64 in logical epoch 64
[2023-06-20 17:57:24] [data] Shuffling data
[2023-06-20 17:57:24] [data] Done reading 20,192 sentences
[2023-06-20 17:57:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:58:09] Seen 18,843 samples
[2023-06-20 17:58:09] Starting data epoch 65 in logical epoch 65
[2023-06-20 17:58:09] [data] Shuffling data
[2023-06-20 17:58:10] [data] Done reading 20,192 sentences
[2023-06-20 17:58:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:58:12] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 1.25210631 * 1,337,858 @ 479 after 25,484,384 : Time 150.77s : 8873.72 words/s : gNorm 1.0946
[2023-06-20 17:58:54] Seen 18,843 samples
[2023-06-20 17:58:54] Starting data epoch 66 in logical epoch 66
[2023-06-20 17:58:54] [data] Shuffling data
[2023-06-20 17:58:54] [data] Done reading 20,192 sentences
[2023-06-20 17:58:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 17:59:38] Seen 18,843 samples
[2023-06-20 17:59:38] Starting data epoch 67 in logical epoch 67
[2023-06-20 17:59:38] [data] Shuffling data
[2023-06-20 17:59:38] [data] Done reading 20,192 sentences
[2023-06-20 17:59:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:00:23] Seen 18,843 samples
[2023-06-20 18:00:23] Starting data epoch 68 in logical epoch 68
[2023-06-20 18:00:23] [data] Shuffling data
[2023-06-20 18:00:23] [data] Done reading 20,192 sentences
[2023-06-20 18:00:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:00:43] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 1.11981201 * 1,354,931 @ 1,600 after 26,839,315 : Time 151.40s : 8949.27 words/s : gNorm 1.0507
[2023-06-20 18:00:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.iter20000.npz
[2023-06-20 18:00:46] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:00:49] Saving Adam parameters
[2023-06-20 18:00:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:01:22] Seen 18,843 samples
[2023-06-20 18:01:22] Starting data epoch 69 in logical epoch 69
[2023-06-20 18:01:22] [data] Shuffling data
[2023-06-20 18:01:22] [data] Done reading 20,192 sentences
[2023-06-20 18:01:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:02:06] Seen 18,843 samples
[2023-06-20 18:02:06] Starting data epoch 70 in logical epoch 70
[2023-06-20 18:02:06] [data] Shuffling data
[2023-06-20 18:02:06] [data] Done reading 20,192 sentences
[2023-06-20 18:02:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:02:51] Seen 18,843 samples
[2023-06-20 18:02:51] Starting data epoch 71 in logical epoch 71
[2023-06-20 18:02:51] Training finished
[2023-06-20 18:02:57] [valid] Ep. 71 : Up. 20760 : cross-entropy : 165.964 : stalled 6 times (last best: 108.422)
[2023-06-20 18:02:57] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:03:00] Saving Adam parameters
[2023-06-20 18:03:01] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:07:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:07:47] [marian] Running on node21.datos.cluster.uy as process 36742 with command line:
[2023-06-20 18:07:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 18:07:47] [config] after: 0e
[2023-06-20 18:07:47] [config] after-batches: 0
[2023-06-20 18:07:47] [config] after-epochs: 80
[2023-06-20 18:07:47] [config] all-caps-every: 0
[2023-06-20 18:07:47] [config] allow-unk: false
[2023-06-20 18:07:47] [config] authors: false
[2023-06-20 18:07:47] [config] beam-size: 12
[2023-06-20 18:07:47] [config] bert-class-symbol: "[CLS]"
[2023-06-20 18:07:47] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 18:07:47] [config] bert-masking-fraction: 0.15
[2023-06-20 18:07:47] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 18:07:47] [config] bert-train-type-embeddings: true
[2023-06-20 18:07:47] [config] bert-type-vocab-size: 2
[2023-06-20 18:07:47] [config] build-info: ""
[2023-06-20 18:07:47] [config] check-gradient-nan: false
[2023-06-20 18:07:47] [config] check-nan: false
[2023-06-20 18:07:47] [config] cite: false
[2023-06-20 18:07:47] [config] clip-norm: 1
[2023-06-20 18:07:47] [config] cost-scaling:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] cost-type: ce-sum
[2023-06-20 18:07:47] [config] cpu-threads: 0
[2023-06-20 18:07:47] [config] data-threads: 8
[2023-06-20 18:07:47] [config] data-weighting: ""
[2023-06-20 18:07:47] [config] data-weighting-type: sentence
[2023-06-20 18:07:47] [config] dec-cell: gru
[2023-06-20 18:07:47] [config] dec-cell-base-depth: 2
[2023-06-20 18:07:47] [config] dec-cell-high-depth: 1
[2023-06-20 18:07:47] [config] dec-depth: 1
[2023-06-20 18:07:47] [config] devices:
[2023-06-20 18:07:47] [config]   - 0
[2023-06-20 18:07:47] [config] dim-emb: 512
[2023-06-20 18:07:47] [config] dim-rnn: 1024
[2023-06-20 18:07:47] [config] dim-vocabs:
[2023-06-20 18:07:47] [config]   - 54042
[2023-06-20 18:07:47] [config]   - 36507
[2023-06-20 18:07:47] [config] disp-first: 0
[2023-06-20 18:07:47] [config] disp-freq: 1000u
[2023-06-20 18:07:47] [config] disp-label-counts: true
[2023-06-20 18:07:47] [config] dropout-rnn: 0
[2023-06-20 18:07:47] [config] dropout-src: 0
[2023-06-20 18:07:47] [config] dropout-trg: 0
[2023-06-20 18:07:47] [config] dump-config: ""
[2023-06-20 18:07:47] [config] dynamic-gradient-scaling:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] early-stopping: 10
[2023-06-20 18:07:47] [config] early-stopping-on: first
[2023-06-20 18:07:47] [config] embedding-fix-src: false
[2023-06-20 18:07:47] [config] embedding-fix-trg: false
[2023-06-20 18:07:47] [config] embedding-normalization: false
[2023-06-20 18:07:47] [config] embedding-vectors:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] enc-cell: gru
[2023-06-20 18:07:47] [config] enc-cell-depth: 1
[2023-06-20 18:07:47] [config] enc-depth: 1
[2023-06-20 18:07:47] [config] enc-type: bidirectional
[2023-06-20 18:07:47] [config] english-title-case-every: 0
[2023-06-20 18:07:47] [config] exponential-smoothing: 0
[2023-06-20 18:07:47] [config] factor-weight: 1
[2023-06-20 18:07:47] [config] factors-combine: sum
[2023-06-20 18:07:47] [config] factors-dim-emb: 0
[2023-06-20 18:07:47] [config] gradient-checkpointing: false
[2023-06-20 18:07:47] [config] gradient-norm-average-window: 100
[2023-06-20 18:07:47] [config] guided-alignment: none
[2023-06-20 18:07:47] [config] guided-alignment-cost: mse
[2023-06-20 18:07:47] [config] guided-alignment-weight: 0.1
[2023-06-20 18:07:47] [config] ignore-model-config: false
[2023-06-20 18:07:47] [config] input-types:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] interpolate-env-vars: false
[2023-06-20 18:07:47] [config] keep-best: false
[2023-06-20 18:07:47] [config] label-smoothing: 0
[2023-06-20 18:07:47] [config] layer-normalization: false
[2023-06-20 18:07:47] [config] learn-rate: 0.0001
[2023-06-20 18:07:47] [config] lemma-dependency: ""
[2023-06-20 18:07:47] [config] lemma-dim-emb: 0
[2023-06-20 18:07:47] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 18:07:47] [config] log-level: info
[2023-06-20 18:07:47] [config] log-time-zone: ""
[2023-06-20 18:07:47] [config] logical-epoch:
[2023-06-20 18:07:47] [config]   - 1e
[2023-06-20 18:07:47] [config]   - 0
[2023-06-20 18:07:47] [config] lr-decay: 0
[2023-06-20 18:07:47] [config] lr-decay-freq: 50000
[2023-06-20 18:07:47] [config] lr-decay-inv-sqrt:
[2023-06-20 18:07:47] [config]   - 0
[2023-06-20 18:07:47] [config] lr-decay-repeat-warmup: false
[2023-06-20 18:07:47] [config] lr-decay-reset-optimizer: false
[2023-06-20 18:07:47] [config] lr-decay-start:
[2023-06-20 18:07:47] [config]   - 10
[2023-06-20 18:07:47] [config]   - 1
[2023-06-20 18:07:47] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 18:07:47] [config] lr-report: false
[2023-06-20 18:07:47] [config] lr-warmup: 0
[2023-06-20 18:07:47] [config] lr-warmup-at-reload: false
[2023-06-20 18:07:47] [config] lr-warmup-cycle: false
[2023-06-20 18:07:47] [config] lr-warmup-start-rate: 0
[2023-06-20 18:07:47] [config] max-length: 50
[2023-06-20 18:07:47] [config] max-length-crop: false
[2023-06-20 18:07:47] [config] max-length-factor: 3
[2023-06-20 18:07:47] [config] maxi-batch: 100
[2023-06-20 18:07:47] [config] maxi-batch-sort: trg
[2023-06-20 18:07:47] [config] mini-batch: 64
[2023-06-20 18:07:47] [config] mini-batch-fit: false
[2023-06-20 18:07:47] [config] mini-batch-fit-step: 10
[2023-06-20 18:07:47] [config] mini-batch-round-up: true
[2023-06-20 18:07:47] [config] mini-batch-track-lr: false
[2023-06-20 18:07:47] [config] mini-batch-warmup: 0
[2023-06-20 18:07:47] [config] mini-batch-words: 0
[2023-06-20 18:07:47] [config] mini-batch-words-ref: 0
[2023-06-20 18:07:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:07:47] [config] multi-loss-type: sum
[2023-06-20 18:07:47] [config] n-best: false
[2023-06-20 18:07:47] [config] no-nccl: false
[2023-06-20 18:07:47] [config] no-reload: false
[2023-06-20 18:07:47] [config] no-restore-corpus: false
[2023-06-20 18:07:47] [config] normalize: 0
[2023-06-20 18:07:47] [config] normalize-gradient: false
[2023-06-20 18:07:47] [config] num-devices: 0
[2023-06-20 18:07:47] [config] optimizer: adam
[2023-06-20 18:07:47] [config] optimizer-delay: 1
[2023-06-20 18:07:47] [config] optimizer-params:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] output-omit-bias: false
[2023-06-20 18:07:47] [config] overwrite: false
[2023-06-20 18:07:47] [config] precision:
[2023-06-20 18:07:47] [config]   - float32
[2023-06-20 18:07:47] [config]   - float32
[2023-06-20 18:07:47] [config] pretrained-model: ""
[2023-06-20 18:07:47] [config] quantize-biases: false
[2023-06-20 18:07:47] [config] quantize-bits: 0
[2023-06-20 18:07:47] [config] quantize-log-based: false
[2023-06-20 18:07:47] [config] quantize-optimization-steps: 0
[2023-06-20 18:07:47] [config] quiet: false
[2023-06-20 18:07:47] [config] quiet-translation: true
[2023-06-20 18:07:47] [config] relative-paths: false
[2023-06-20 18:07:47] [config] right-left: false
[2023-06-20 18:07:47] [config] save-freq: 10000u
[2023-06-20 18:07:47] [config] seed: 1234
[2023-06-20 18:07:47] [config] sentencepiece-alphas:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] sentencepiece-max-lines: 2000000
[2023-06-20 18:07:47] [config] sentencepiece-options: ""
[2023-06-20 18:07:47] [config] sharding: global
[2023-06-20 18:07:47] [config] shuffle: data
[2023-06-20 18:07:47] [config] shuffle-in-ram: false
[2023-06-20 18:07:47] [config] sigterm: save-and-exit
[2023-06-20 18:07:47] [config] skip: false
[2023-06-20 18:07:47] [config] sqlite: ""
[2023-06-20 18:07:47] [config] sqlite-drop: false
[2023-06-20 18:07:47] [config] sync-freq: 200u
[2023-06-20 18:07:47] [config] sync-sgd: false
[2023-06-20 18:07:47] [config] tempdir: /tmp
[2023-06-20 18:07:47] [config] tied-embeddings: false
[2023-06-20 18:07:47] [config] tied-embeddings-all: false
[2023-06-20 18:07:47] [config] tied-embeddings-src: false
[2023-06-20 18:07:47] [config] train-embedder-rank:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] train-sets:
[2023-06-20 18:07:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 18:07:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 18:07:47] [config] transformer-aan-activation: swish
[2023-06-20 18:07:47] [config] transformer-aan-depth: 2
[2023-06-20 18:07:47] [config] transformer-aan-nogate: false
[2023-06-20 18:07:47] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 18:07:47] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 18:07:47] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 18:07:47] [config] transformer-depth-scaling: false
[2023-06-20 18:07:47] [config] transformer-dim-aan: 2048
[2023-06-20 18:07:47] [config] transformer-dim-ffn: 2048
[2023-06-20 18:07:47] [config] transformer-dropout: 0
[2023-06-20 18:07:47] [config] transformer-dropout-attention: 0
[2023-06-20 18:07:47] [config] transformer-dropout-ffn: 0
[2023-06-20 18:07:47] [config] transformer-ffn-activation: swish
[2023-06-20 18:07:47] [config] transformer-ffn-depth: 2
[2023-06-20 18:07:47] [config] transformer-guided-alignment-layer: last
[2023-06-20 18:07:47] [config] transformer-heads: 8
[2023-06-20 18:07:47] [config] transformer-no-projection: false
[2023-06-20 18:07:47] [config] transformer-pool: false
[2023-06-20 18:07:47] [config] transformer-postprocess: dan
[2023-06-20 18:07:47] [config] transformer-postprocess-emb: d
[2023-06-20 18:07:47] [config] transformer-postprocess-top: ""
[2023-06-20 18:07:47] [config] transformer-preprocess: ""
[2023-06-20 18:07:47] [config] transformer-tied-layers:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] transformer-train-position-embeddings: false
[2023-06-20 18:07:47] [config] tsv: false
[2023-06-20 18:07:47] [config] tsv-fields: 0
[2023-06-20 18:07:47] [config] type: amun
[2023-06-20 18:07:47] [config] ulr: false
[2023-06-20 18:07:47] [config] ulr-dim-emb: 0
[2023-06-20 18:07:47] [config] ulr-dropout: 0
[2023-06-20 18:07:47] [config] ulr-keys-vectors: ""
[2023-06-20 18:07:47] [config] ulr-query-vectors: ""
[2023-06-20 18:07:47] [config] ulr-softmax-temperature: 1
[2023-06-20 18:07:47] [config] ulr-trainable-transformation: false
[2023-06-20 18:07:47] [config] unlikelihood-loss: false
[2023-06-20 18:07:47] [config] valid-freq: 5000000
[2023-06-20 18:07:47] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 18:07:47] [config] valid-max-length: 1000
[2023-06-20 18:07:47] [config] valid-metrics:
[2023-06-20 18:07:47] [config]   - cross-entropy
[2023-06-20 18:07:47] [config] valid-mini-batch: 32
[2023-06-20 18:07:47] [config] valid-reset-stalled: false
[2023-06-20 18:07:47] [config] valid-script-args:
[2023-06-20 18:07:47] [config]   []
[2023-06-20 18:07:47] [config] valid-script-path: ""
[2023-06-20 18:07:47] [config] valid-sets:
[2023-06-20 18:07:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 18:07:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 18:07:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 18:07:47] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:07:47] [config] vocabs:
[2023-06-20 18:07:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:07:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:07:47] [config] word-penalty: 0
[2023-06-20 18:07:47] [config] word-scores: false
[2023-06-20 18:07:47] [config] workspace: 2048
[2023-06-20 18:07:47] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:07:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:07:47] [training] Using single-device training
[2023-06-20 18:07:47] Synced seed 1234
[2023-06-20 18:07:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:07:47] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 18:07:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:07:47] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 18:07:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:07:48] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 18:07:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 18:07:48] [comm] Using global sharding
[2023-06-20 18:07:48] [comm] NCCLCommunicators constructed successfully
[2023-06-20 18:07:48] [training] Using 1 GPUs
[2023-06-20 18:07:48] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:07:50] Loading Adam parameters
[2023-06-20 18:07:51] [memory] Reserving 754 MB, device gpu0
[2023-06-20 18:07:51] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:07:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:07:51] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-06-20 18:07:51] [data] Shuffling data
[2023-06-20 18:07:51] [data] Done reading 20,192 sentences
[2023-06-20 18:07:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:07:51] Training started
[2023-06-20 18:07:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 18:07:51] [logits] Applying loss function for 1 factor(s)
[2023-06-20 18:07:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 18:07:51] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:07:51] Parameter type float32, optimization type float32, casting types false
[2023-06-20 18:08:25] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.99339169 * 1,330,991 @ 1,562 after 28,170,306 : Time 37.91s : 35110.96 words/s : gNorm 0.9689
[2023-06-20 18:08:34] Seen 18,843 samples
[2023-06-20 18:08:34] Starting data epoch 72 in logical epoch 72
[2023-06-20 18:08:34] [data] Shuffling data
[2023-06-20 18:08:34] [data] Done reading 20,192 sentences
[2023-06-20 18:08:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:09:19] Seen 18,843 samples
[2023-06-20 18:09:19] Starting data epoch 73 in logical epoch 73
[2023-06-20 18:09:19] [data] Shuffling data
[2023-06-20 18:09:19] [data] Done reading 20,192 sentences
[2023-06-20 18:09:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:10:03] Seen 18,843 samples
[2023-06-20 18:10:03] Starting data epoch 74 in logical epoch 74
[2023-06-20 18:10:03] [data] Shuffling data
[2023-06-20 18:10:03] [data] Done reading 20,192 sentences
[2023-06-20 18:10:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:10:47] Seen 18,843 samples
[2023-06-20 18:10:47] Starting data epoch 75 in logical epoch 75
[2023-06-20 18:10:47] [data] Shuffling data
[2023-06-20 18:10:47] [data] Done reading 20,192 sentences
[2023-06-20 18:10:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:10:55] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.88290989 * 1,344,658 @ 2,757 after 29,514,964 : Time 150.39s : 8941.06 words/s : gNorm 0.8981
[2023-06-20 18:11:32] Seen 18,843 samples
[2023-06-20 18:11:32] Starting data epoch 76 in logical epoch 76
[2023-06-20 18:11:32] [data] Shuffling data
[2023-06-20 18:11:32] [data] Done reading 20,192 sentences
[2023-06-20 18:11:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:12:17] Seen 18,843 samples
[2023-06-20 18:12:17] Starting data epoch 77 in logical epoch 77
[2023-06-20 18:12:17] [data] Shuffling data
[2023-06-20 18:12:17] [data] Done reading 20,192 sentences
[2023-06-20 18:12:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:13:01] Seen 18,843 samples
[2023-06-20 18:13:01] Starting data epoch 78 in logical epoch 78
[2023-06-20 18:13:01] [data] Shuffling data
[2023-06-20 18:13:01] [data] Done reading 20,192 sentences
[2023-06-20 18:13:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:13:25] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.78003842 * 1,340,855 @ 527 after 30,855,819 : Time 149.82s : 8949.83 words/s : gNorm 0.7987
[2023-06-20 18:13:46] Seen 18,843 samples
[2023-06-20 18:13:46] Starting data epoch 79 in logical epoch 79
[2023-06-20 18:13:46] [data] Shuffling data
[2023-06-20 18:13:46] [data] Done reading 20,192 sentences
[2023-06-20 18:13:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:14:31] Seen 18,843 samples
[2023-06-20 18:14:31] Starting data epoch 80 in logical epoch 80
[2023-06-20 18:14:31] [data] Shuffling data
[2023-06-20 18:14:31] [data] Done reading 20,192 sentences
[2023-06-20 18:14:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:15:15] Seen 18,843 samples
[2023-06-20 18:15:15] Starting data epoch 81 in logical epoch 81
[2023-06-20 18:15:15] Training finished
[2023-06-20 18:15:21] [valid] Ep. 81 : Up. 23727 : cross-entropy : 177.629 : stalled 7 times (last best: 108.422)
[2023-06-20 18:15:21] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:15:25] Saving Adam parameters
[2023-06-20 18:15:26] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:20:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:20:16] [marian] Running on node21.datos.cluster.uy as process 37470 with command line:
[2023-06-20 18:20:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 18:20:16] [config] after: 0e
[2023-06-20 18:20:16] [config] after-batches: 0
[2023-06-20 18:20:16] [config] after-epochs: 90
[2023-06-20 18:20:16] [config] all-caps-every: 0
[2023-06-20 18:20:16] [config] allow-unk: false
[2023-06-20 18:20:16] [config] authors: false
[2023-06-20 18:20:16] [config] beam-size: 12
[2023-06-20 18:20:16] [config] bert-class-symbol: "[CLS]"
[2023-06-20 18:20:16] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 18:20:16] [config] bert-masking-fraction: 0.15
[2023-06-20 18:20:16] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 18:20:16] [config] bert-train-type-embeddings: true
[2023-06-20 18:20:16] [config] bert-type-vocab-size: 2
[2023-06-20 18:20:16] [config] build-info: ""
[2023-06-20 18:20:16] [config] check-gradient-nan: false
[2023-06-20 18:20:16] [config] check-nan: false
[2023-06-20 18:20:16] [config] cite: false
[2023-06-20 18:20:16] [config] clip-norm: 1
[2023-06-20 18:20:16] [config] cost-scaling:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] cost-type: ce-sum
[2023-06-20 18:20:16] [config] cpu-threads: 0
[2023-06-20 18:20:16] [config] data-threads: 8
[2023-06-20 18:20:16] [config] data-weighting: ""
[2023-06-20 18:20:16] [config] data-weighting-type: sentence
[2023-06-20 18:20:16] [config] dec-cell: gru
[2023-06-20 18:20:16] [config] dec-cell-base-depth: 2
[2023-06-20 18:20:16] [config] dec-cell-high-depth: 1
[2023-06-20 18:20:16] [config] dec-depth: 1
[2023-06-20 18:20:16] [config] devices:
[2023-06-20 18:20:16] [config]   - 0
[2023-06-20 18:20:16] [config] dim-emb: 512
[2023-06-20 18:20:16] [config] dim-rnn: 1024
[2023-06-20 18:20:16] [config] dim-vocabs:
[2023-06-20 18:20:16] [config]   - 54042
[2023-06-20 18:20:16] [config]   - 36507
[2023-06-20 18:20:16] [config] disp-first: 0
[2023-06-20 18:20:16] [config] disp-freq: 1000u
[2023-06-20 18:20:16] [config] disp-label-counts: true
[2023-06-20 18:20:16] [config] dropout-rnn: 0
[2023-06-20 18:20:16] [config] dropout-src: 0
[2023-06-20 18:20:16] [config] dropout-trg: 0
[2023-06-20 18:20:16] [config] dump-config: ""
[2023-06-20 18:20:16] [config] dynamic-gradient-scaling:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] early-stopping: 10
[2023-06-20 18:20:16] [config] early-stopping-on: first
[2023-06-20 18:20:16] [config] embedding-fix-src: false
[2023-06-20 18:20:16] [config] embedding-fix-trg: false
[2023-06-20 18:20:16] [config] embedding-normalization: false
[2023-06-20 18:20:16] [config] embedding-vectors:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] enc-cell: gru
[2023-06-20 18:20:16] [config] enc-cell-depth: 1
[2023-06-20 18:20:16] [config] enc-depth: 1
[2023-06-20 18:20:16] [config] enc-type: bidirectional
[2023-06-20 18:20:16] [config] english-title-case-every: 0
[2023-06-20 18:20:16] [config] exponential-smoothing: 0
[2023-06-20 18:20:16] [config] factor-weight: 1
[2023-06-20 18:20:16] [config] factors-combine: sum
[2023-06-20 18:20:16] [config] factors-dim-emb: 0
[2023-06-20 18:20:16] [config] gradient-checkpointing: false
[2023-06-20 18:20:16] [config] gradient-norm-average-window: 100
[2023-06-20 18:20:16] [config] guided-alignment: none
[2023-06-20 18:20:16] [config] guided-alignment-cost: mse
[2023-06-20 18:20:16] [config] guided-alignment-weight: 0.1
[2023-06-20 18:20:16] [config] ignore-model-config: false
[2023-06-20 18:20:16] [config] input-types:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] interpolate-env-vars: false
[2023-06-20 18:20:16] [config] keep-best: false
[2023-06-20 18:20:16] [config] label-smoothing: 0
[2023-06-20 18:20:16] [config] layer-normalization: false
[2023-06-20 18:20:16] [config] learn-rate: 0.0001
[2023-06-20 18:20:16] [config] lemma-dependency: ""
[2023-06-20 18:20:16] [config] lemma-dim-emb: 0
[2023-06-20 18:20:16] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 18:20:16] [config] log-level: info
[2023-06-20 18:20:16] [config] log-time-zone: ""
[2023-06-20 18:20:16] [config] logical-epoch:
[2023-06-20 18:20:16] [config]   - 1e
[2023-06-20 18:20:16] [config]   - 0
[2023-06-20 18:20:16] [config] lr-decay: 0
[2023-06-20 18:20:16] [config] lr-decay-freq: 50000
[2023-06-20 18:20:16] [config] lr-decay-inv-sqrt:
[2023-06-20 18:20:16] [config]   - 0
[2023-06-20 18:20:16] [config] lr-decay-repeat-warmup: false
[2023-06-20 18:20:16] [config] lr-decay-reset-optimizer: false
[2023-06-20 18:20:16] [config] lr-decay-start:
[2023-06-20 18:20:16] [config]   - 10
[2023-06-20 18:20:16] [config]   - 1
[2023-06-20 18:20:16] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 18:20:16] [config] lr-report: false
[2023-06-20 18:20:16] [config] lr-warmup: 0
[2023-06-20 18:20:16] [config] lr-warmup-at-reload: false
[2023-06-20 18:20:16] [config] lr-warmup-cycle: false
[2023-06-20 18:20:16] [config] lr-warmup-start-rate: 0
[2023-06-20 18:20:16] [config] max-length: 50
[2023-06-20 18:20:16] [config] max-length-crop: false
[2023-06-20 18:20:16] [config] max-length-factor: 3
[2023-06-20 18:20:16] [config] maxi-batch: 100
[2023-06-20 18:20:16] [config] maxi-batch-sort: trg
[2023-06-20 18:20:16] [config] mini-batch: 64
[2023-06-20 18:20:16] [config] mini-batch-fit: false
[2023-06-20 18:20:16] [config] mini-batch-fit-step: 10
[2023-06-20 18:20:16] [config] mini-batch-round-up: true
[2023-06-20 18:20:16] [config] mini-batch-track-lr: false
[2023-06-20 18:20:16] [config] mini-batch-warmup: 0
[2023-06-20 18:20:16] [config] mini-batch-words: 0
[2023-06-20 18:20:16] [config] mini-batch-words-ref: 0
[2023-06-20 18:20:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:20:16] [config] multi-loss-type: sum
[2023-06-20 18:20:16] [config] n-best: false
[2023-06-20 18:20:16] [config] no-nccl: false
[2023-06-20 18:20:16] [config] no-reload: false
[2023-06-20 18:20:16] [config] no-restore-corpus: false
[2023-06-20 18:20:16] [config] normalize: 0
[2023-06-20 18:20:16] [config] normalize-gradient: false
[2023-06-20 18:20:16] [config] num-devices: 0
[2023-06-20 18:20:16] [config] optimizer: adam
[2023-06-20 18:20:16] [config] optimizer-delay: 1
[2023-06-20 18:20:16] [config] optimizer-params:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] output-omit-bias: false
[2023-06-20 18:20:16] [config] overwrite: false
[2023-06-20 18:20:16] [config] precision:
[2023-06-20 18:20:16] [config]   - float32
[2023-06-20 18:20:16] [config]   - float32
[2023-06-20 18:20:16] [config] pretrained-model: ""
[2023-06-20 18:20:16] [config] quantize-biases: false
[2023-06-20 18:20:16] [config] quantize-bits: 0
[2023-06-20 18:20:16] [config] quantize-log-based: false
[2023-06-20 18:20:16] [config] quantize-optimization-steps: 0
[2023-06-20 18:20:16] [config] quiet: false
[2023-06-20 18:20:16] [config] quiet-translation: true
[2023-06-20 18:20:16] [config] relative-paths: false
[2023-06-20 18:20:16] [config] right-left: false
[2023-06-20 18:20:16] [config] save-freq: 10000u
[2023-06-20 18:20:16] [config] seed: 1234
[2023-06-20 18:20:16] [config] sentencepiece-alphas:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] sentencepiece-max-lines: 2000000
[2023-06-20 18:20:16] [config] sentencepiece-options: ""
[2023-06-20 18:20:16] [config] sharding: global
[2023-06-20 18:20:16] [config] shuffle: data
[2023-06-20 18:20:16] [config] shuffle-in-ram: false
[2023-06-20 18:20:16] [config] sigterm: save-and-exit
[2023-06-20 18:20:16] [config] skip: false
[2023-06-20 18:20:16] [config] sqlite: ""
[2023-06-20 18:20:16] [config] sqlite-drop: false
[2023-06-20 18:20:16] [config] sync-freq: 200u
[2023-06-20 18:20:16] [config] sync-sgd: false
[2023-06-20 18:20:16] [config] tempdir: /tmp
[2023-06-20 18:20:16] [config] tied-embeddings: false
[2023-06-20 18:20:16] [config] tied-embeddings-all: false
[2023-06-20 18:20:16] [config] tied-embeddings-src: false
[2023-06-20 18:20:16] [config] train-embedder-rank:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] train-sets:
[2023-06-20 18:20:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 18:20:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 18:20:16] [config] transformer-aan-activation: swish
[2023-06-20 18:20:16] [config] transformer-aan-depth: 2
[2023-06-20 18:20:16] [config] transformer-aan-nogate: false
[2023-06-20 18:20:16] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 18:20:16] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 18:20:16] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 18:20:16] [config] transformer-depth-scaling: false
[2023-06-20 18:20:16] [config] transformer-dim-aan: 2048
[2023-06-20 18:20:16] [config] transformer-dim-ffn: 2048
[2023-06-20 18:20:16] [config] transformer-dropout: 0
[2023-06-20 18:20:16] [config] transformer-dropout-attention: 0
[2023-06-20 18:20:16] [config] transformer-dropout-ffn: 0
[2023-06-20 18:20:16] [config] transformer-ffn-activation: swish
[2023-06-20 18:20:16] [config] transformer-ffn-depth: 2
[2023-06-20 18:20:16] [config] transformer-guided-alignment-layer: last
[2023-06-20 18:20:16] [config] transformer-heads: 8
[2023-06-20 18:20:16] [config] transformer-no-projection: false
[2023-06-20 18:20:16] [config] transformer-pool: false
[2023-06-20 18:20:16] [config] transformer-postprocess: dan
[2023-06-20 18:20:16] [config] transformer-postprocess-emb: d
[2023-06-20 18:20:16] [config] transformer-postprocess-top: ""
[2023-06-20 18:20:16] [config] transformer-preprocess: ""
[2023-06-20 18:20:16] [config] transformer-tied-layers:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] transformer-train-position-embeddings: false
[2023-06-20 18:20:16] [config] tsv: false
[2023-06-20 18:20:16] [config] tsv-fields: 0
[2023-06-20 18:20:16] [config] type: amun
[2023-06-20 18:20:16] [config] ulr: false
[2023-06-20 18:20:16] [config] ulr-dim-emb: 0
[2023-06-20 18:20:16] [config] ulr-dropout: 0
[2023-06-20 18:20:16] [config] ulr-keys-vectors: ""
[2023-06-20 18:20:16] [config] ulr-query-vectors: ""
[2023-06-20 18:20:16] [config] ulr-softmax-temperature: 1
[2023-06-20 18:20:16] [config] ulr-trainable-transformation: false
[2023-06-20 18:20:16] [config] unlikelihood-loss: false
[2023-06-20 18:20:16] [config] valid-freq: 5000000
[2023-06-20 18:20:16] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 18:20:16] [config] valid-max-length: 1000
[2023-06-20 18:20:16] [config] valid-metrics:
[2023-06-20 18:20:16] [config]   - cross-entropy
[2023-06-20 18:20:16] [config] valid-mini-batch: 32
[2023-06-20 18:20:16] [config] valid-reset-stalled: false
[2023-06-20 18:20:16] [config] valid-script-args:
[2023-06-20 18:20:16] [config]   []
[2023-06-20 18:20:16] [config] valid-script-path: ""
[2023-06-20 18:20:16] [config] valid-sets:
[2023-06-20 18:20:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 18:20:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 18:20:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 18:20:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:20:16] [config] vocabs:
[2023-06-20 18:20:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:20:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:20:16] [config] word-penalty: 0
[2023-06-20 18:20:16] [config] word-scores: false
[2023-06-20 18:20:16] [config] workspace: 2048
[2023-06-20 18:20:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:20:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:20:16] [training] Using single-device training
[2023-06-20 18:20:21] Synced seed 1234
[2023-06-20 18:20:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:20:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 18:20:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:20:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 18:20:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:20:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 18:20:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 18:20:22] [comm] Using global sharding
[2023-06-20 18:20:22] [comm] NCCLCommunicators constructed successfully
[2023-06-20 18:20:22] [training] Using 1 GPUs
[2023-06-20 18:20:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:20:24] Loading Adam parameters
[2023-06-20 18:20:24] [memory] Reserving 754 MB, device gpu0
[2023-06-20 18:20:25] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:20:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:20:25] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-06-20 18:20:25] [data] Shuffling data
[2023-06-20 18:20:25] [data] Done reading 20,192 sentences
[2023-06-20 18:20:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:20:25] Training started
[2023-06-20 18:20:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 18:20:25] [logits] Applying loss function for 1 factor(s)
[2023-06-20 18:20:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 18:20:25] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:20:25] Parameter type float32, optimization type float32, casting types false
[2023-06-20 18:21:03] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.68264359 * 1,343,267 @ 832 after 32,199,086 : Time 42.77s : 31404.74 words/s : gNorm 0.8424
[2023-06-20 18:21:07] Seen 18,843 samples
[2023-06-20 18:21:07] Starting data epoch 82 in logical epoch 82
[2023-06-20 18:21:07] [data] Shuffling data
[2023-06-20 18:21:07] [data] Done reading 20,192 sentences
[2023-06-20 18:21:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:21:52] Seen 18,843 samples
[2023-06-20 18:21:52] Starting data epoch 83 in logical epoch 83
[2023-06-20 18:21:52] [data] Shuffling data
[2023-06-20 18:21:52] [data] Done reading 20,192 sentences
[2023-06-20 18:21:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:22:36] Seen 18,843 samples
[2023-06-20 18:22:36] Starting data epoch 84 in logical epoch 84
[2023-06-20 18:22:36] [data] Shuffling data
[2023-06-20 18:22:36] [data] Done reading 20,192 sentences
[2023-06-20 18:22:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:23:21] Seen 18,843 samples
[2023-06-20 18:23:21] Starting data epoch 85 in logical epoch 85
[2023-06-20 18:23:21] [data] Shuffling data
[2023-06-20 18:23:21] [data] Done reading 20,192 sentences
[2023-06-20 18:23:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:23:34] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.59069800 * 1,339,320 @ 1,280 after 33,538,406 : Time 150.31s : 8910.45 words/s : gNorm 0.8335
[2023-06-20 18:24:06] Seen 18,843 samples
[2023-06-20 18:24:06] Starting data epoch 86 in logical epoch 86
[2023-06-20 18:24:06] [data] Shuffling data
[2023-06-20 18:24:06] [data] Done reading 20,192 sentences
[2023-06-20 18:24:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:24:51] Seen 18,843 samples
[2023-06-20 18:24:51] Starting data epoch 87 in logical epoch 87
[2023-06-20 18:24:51] [data] Shuffling data
[2023-06-20 18:24:51] [data] Done reading 20,192 sentences
[2023-06-20 18:24:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:25:36] Seen 18,843 samples
[2023-06-20 18:25:36] Starting data epoch 88 in logical epoch 88
[2023-06-20 18:25:36] [data] Shuffling data
[2023-06-20 18:25:36] [data] Done reading 20,192 sentences
[2023-06-20 18:25:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:26:05] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.51936340 * 1,346,822 @ 896 after 34,885,228 : Time 151.68s : 8879.24 words/s : gNorm 0.8073
[2023-06-20 18:26:21] Seen 18,843 samples
[2023-06-20 18:26:21] Starting data epoch 89 in logical epoch 89
[2023-06-20 18:26:21] [data] Shuffling data
[2023-06-20 18:26:21] [data] Done reading 20,192 sentences
[2023-06-20 18:26:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:27:05] Seen 18,843 samples
[2023-06-20 18:27:05] Starting data epoch 90 in logical epoch 90
[2023-06-20 18:27:05] [data] Shuffling data
[2023-06-20 18:27:05] [data] Done reading 20,192 sentences
[2023-06-20 18:27:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:27:50] Seen 18,843 samples
[2023-06-20 18:27:50] Starting data epoch 91 in logical epoch 91
[2023-06-20 18:27:50] Training finished
[2023-06-20 18:27:56] [valid] Ep. 91 : Up. 26693 : cross-entropy : 185.084 : stalled 8 times (last best: 108.422)
[2023-06-20 18:27:56] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:27:59] Saving Adam parameters
[2023-06-20 18:28:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:32:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:32:46] [marian] Running on node21.datos.cluster.uy as process 38537 with command line:
[2023-06-20 18:32:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 18:32:46] [config] after: 0e
[2023-06-20 18:32:46] [config] after-batches: 0
[2023-06-20 18:32:46] [config] after-epochs: 100
[2023-06-20 18:32:46] [config] all-caps-every: 0
[2023-06-20 18:32:46] [config] allow-unk: false
[2023-06-20 18:32:46] [config] authors: false
[2023-06-20 18:32:46] [config] beam-size: 12
[2023-06-20 18:32:46] [config] bert-class-symbol: "[CLS]"
[2023-06-20 18:32:46] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 18:32:46] [config] bert-masking-fraction: 0.15
[2023-06-20 18:32:46] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 18:32:46] [config] bert-train-type-embeddings: true
[2023-06-20 18:32:46] [config] bert-type-vocab-size: 2
[2023-06-20 18:32:46] [config] build-info: ""
[2023-06-20 18:32:46] [config] check-gradient-nan: false
[2023-06-20 18:32:46] [config] check-nan: false
[2023-06-20 18:32:46] [config] cite: false
[2023-06-20 18:32:46] [config] clip-norm: 1
[2023-06-20 18:32:46] [config] cost-scaling:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] cost-type: ce-sum
[2023-06-20 18:32:46] [config] cpu-threads: 0
[2023-06-20 18:32:46] [config] data-threads: 8
[2023-06-20 18:32:46] [config] data-weighting: ""
[2023-06-20 18:32:46] [config] data-weighting-type: sentence
[2023-06-20 18:32:46] [config] dec-cell: gru
[2023-06-20 18:32:46] [config] dec-cell-base-depth: 2
[2023-06-20 18:32:46] [config] dec-cell-high-depth: 1
[2023-06-20 18:32:46] [config] dec-depth: 1
[2023-06-20 18:32:46] [config] devices:
[2023-06-20 18:32:46] [config]   - 0
[2023-06-20 18:32:46] [config] dim-emb: 512
[2023-06-20 18:32:46] [config] dim-rnn: 1024
[2023-06-20 18:32:46] [config] dim-vocabs:
[2023-06-20 18:32:46] [config]   - 54042
[2023-06-20 18:32:46] [config]   - 36507
[2023-06-20 18:32:46] [config] disp-first: 0
[2023-06-20 18:32:46] [config] disp-freq: 1000u
[2023-06-20 18:32:46] [config] disp-label-counts: true
[2023-06-20 18:32:46] [config] dropout-rnn: 0
[2023-06-20 18:32:46] [config] dropout-src: 0
[2023-06-20 18:32:46] [config] dropout-trg: 0
[2023-06-20 18:32:46] [config] dump-config: ""
[2023-06-20 18:32:46] [config] dynamic-gradient-scaling:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] early-stopping: 10
[2023-06-20 18:32:46] [config] early-stopping-on: first
[2023-06-20 18:32:46] [config] embedding-fix-src: false
[2023-06-20 18:32:46] [config] embedding-fix-trg: false
[2023-06-20 18:32:46] [config] embedding-normalization: false
[2023-06-20 18:32:46] [config] embedding-vectors:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] enc-cell: gru
[2023-06-20 18:32:46] [config] enc-cell-depth: 1
[2023-06-20 18:32:46] [config] enc-depth: 1
[2023-06-20 18:32:46] [config] enc-type: bidirectional
[2023-06-20 18:32:46] [config] english-title-case-every: 0
[2023-06-20 18:32:46] [config] exponential-smoothing: 0
[2023-06-20 18:32:46] [config] factor-weight: 1
[2023-06-20 18:32:46] [config] factors-combine: sum
[2023-06-20 18:32:46] [config] factors-dim-emb: 0
[2023-06-20 18:32:46] [config] gradient-checkpointing: false
[2023-06-20 18:32:46] [config] gradient-norm-average-window: 100
[2023-06-20 18:32:46] [config] guided-alignment: none
[2023-06-20 18:32:46] [config] guided-alignment-cost: mse
[2023-06-20 18:32:46] [config] guided-alignment-weight: 0.1
[2023-06-20 18:32:46] [config] ignore-model-config: false
[2023-06-20 18:32:46] [config] input-types:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] interpolate-env-vars: false
[2023-06-20 18:32:46] [config] keep-best: false
[2023-06-20 18:32:46] [config] label-smoothing: 0
[2023-06-20 18:32:46] [config] layer-normalization: false
[2023-06-20 18:32:46] [config] learn-rate: 0.0001
[2023-06-20 18:32:46] [config] lemma-dependency: ""
[2023-06-20 18:32:46] [config] lemma-dim-emb: 0
[2023-06-20 18:32:46] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 18:32:46] [config] log-level: info
[2023-06-20 18:32:46] [config] log-time-zone: ""
[2023-06-20 18:32:46] [config] logical-epoch:
[2023-06-20 18:32:46] [config]   - 1e
[2023-06-20 18:32:46] [config]   - 0
[2023-06-20 18:32:46] [config] lr-decay: 0
[2023-06-20 18:32:46] [config] lr-decay-freq: 50000
[2023-06-20 18:32:46] [config] lr-decay-inv-sqrt:
[2023-06-20 18:32:46] [config]   - 0
[2023-06-20 18:32:46] [config] lr-decay-repeat-warmup: false
[2023-06-20 18:32:46] [config] lr-decay-reset-optimizer: false
[2023-06-20 18:32:46] [config] lr-decay-start:
[2023-06-20 18:32:46] [config]   - 10
[2023-06-20 18:32:46] [config]   - 1
[2023-06-20 18:32:46] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 18:32:46] [config] lr-report: false
[2023-06-20 18:32:46] [config] lr-warmup: 0
[2023-06-20 18:32:46] [config] lr-warmup-at-reload: false
[2023-06-20 18:32:46] [config] lr-warmup-cycle: false
[2023-06-20 18:32:46] [config] lr-warmup-start-rate: 0
[2023-06-20 18:32:46] [config] max-length: 50
[2023-06-20 18:32:46] [config] max-length-crop: false
[2023-06-20 18:32:46] [config] max-length-factor: 3
[2023-06-20 18:32:46] [config] maxi-batch: 100
[2023-06-20 18:32:46] [config] maxi-batch-sort: trg
[2023-06-20 18:32:46] [config] mini-batch: 64
[2023-06-20 18:32:46] [config] mini-batch-fit: false
[2023-06-20 18:32:46] [config] mini-batch-fit-step: 10
[2023-06-20 18:32:46] [config] mini-batch-round-up: true
[2023-06-20 18:32:46] [config] mini-batch-track-lr: false
[2023-06-20 18:32:46] [config] mini-batch-warmup: 0
[2023-06-20 18:32:46] [config] mini-batch-words: 0
[2023-06-20 18:32:46] [config] mini-batch-words-ref: 0
[2023-06-20 18:32:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:32:46] [config] multi-loss-type: sum
[2023-06-20 18:32:46] [config] n-best: false
[2023-06-20 18:32:46] [config] no-nccl: false
[2023-06-20 18:32:46] [config] no-reload: false
[2023-06-20 18:32:46] [config] no-restore-corpus: false
[2023-06-20 18:32:46] [config] normalize: 0
[2023-06-20 18:32:46] [config] normalize-gradient: false
[2023-06-20 18:32:46] [config] num-devices: 0
[2023-06-20 18:32:46] [config] optimizer: adam
[2023-06-20 18:32:46] [config] optimizer-delay: 1
[2023-06-20 18:32:46] [config] optimizer-params:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] output-omit-bias: false
[2023-06-20 18:32:46] [config] overwrite: false
[2023-06-20 18:32:46] [config] precision:
[2023-06-20 18:32:46] [config]   - float32
[2023-06-20 18:32:46] [config]   - float32
[2023-06-20 18:32:46] [config] pretrained-model: ""
[2023-06-20 18:32:46] [config] quantize-biases: false
[2023-06-20 18:32:46] [config] quantize-bits: 0
[2023-06-20 18:32:46] [config] quantize-log-based: false
[2023-06-20 18:32:46] [config] quantize-optimization-steps: 0
[2023-06-20 18:32:46] [config] quiet: false
[2023-06-20 18:32:46] [config] quiet-translation: true
[2023-06-20 18:32:46] [config] relative-paths: false
[2023-06-20 18:32:46] [config] right-left: false
[2023-06-20 18:32:46] [config] save-freq: 10000u
[2023-06-20 18:32:46] [config] seed: 1234
[2023-06-20 18:32:46] [config] sentencepiece-alphas:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] sentencepiece-max-lines: 2000000
[2023-06-20 18:32:46] [config] sentencepiece-options: ""
[2023-06-20 18:32:46] [config] sharding: global
[2023-06-20 18:32:46] [config] shuffle: data
[2023-06-20 18:32:46] [config] shuffle-in-ram: false
[2023-06-20 18:32:46] [config] sigterm: save-and-exit
[2023-06-20 18:32:46] [config] skip: false
[2023-06-20 18:32:46] [config] sqlite: ""
[2023-06-20 18:32:46] [config] sqlite-drop: false
[2023-06-20 18:32:46] [config] sync-freq: 200u
[2023-06-20 18:32:46] [config] sync-sgd: false
[2023-06-20 18:32:46] [config] tempdir: /tmp
[2023-06-20 18:32:46] [config] tied-embeddings: false
[2023-06-20 18:32:46] [config] tied-embeddings-all: false
[2023-06-20 18:32:46] [config] tied-embeddings-src: false
[2023-06-20 18:32:46] [config] train-embedder-rank:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] train-sets:
[2023-06-20 18:32:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 18:32:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 18:32:46] [config] transformer-aan-activation: swish
[2023-06-20 18:32:46] [config] transformer-aan-depth: 2
[2023-06-20 18:32:46] [config] transformer-aan-nogate: false
[2023-06-20 18:32:46] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 18:32:46] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 18:32:46] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 18:32:46] [config] transformer-depth-scaling: false
[2023-06-20 18:32:46] [config] transformer-dim-aan: 2048
[2023-06-20 18:32:46] [config] transformer-dim-ffn: 2048
[2023-06-20 18:32:46] [config] transformer-dropout: 0
[2023-06-20 18:32:46] [config] transformer-dropout-attention: 0
[2023-06-20 18:32:46] [config] transformer-dropout-ffn: 0
[2023-06-20 18:32:46] [config] transformer-ffn-activation: swish
[2023-06-20 18:32:46] [config] transformer-ffn-depth: 2
[2023-06-20 18:32:46] [config] transformer-guided-alignment-layer: last
[2023-06-20 18:32:46] [config] transformer-heads: 8
[2023-06-20 18:32:46] [config] transformer-no-projection: false
[2023-06-20 18:32:46] [config] transformer-pool: false
[2023-06-20 18:32:46] [config] transformer-postprocess: dan
[2023-06-20 18:32:46] [config] transformer-postprocess-emb: d
[2023-06-20 18:32:46] [config] transformer-postprocess-top: ""
[2023-06-20 18:32:46] [config] transformer-preprocess: ""
[2023-06-20 18:32:46] [config] transformer-tied-layers:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] transformer-train-position-embeddings: false
[2023-06-20 18:32:46] [config] tsv: false
[2023-06-20 18:32:46] [config] tsv-fields: 0
[2023-06-20 18:32:46] [config] type: amun
[2023-06-20 18:32:46] [config] ulr: false
[2023-06-20 18:32:46] [config] ulr-dim-emb: 0
[2023-06-20 18:32:46] [config] ulr-dropout: 0
[2023-06-20 18:32:46] [config] ulr-keys-vectors: ""
[2023-06-20 18:32:46] [config] ulr-query-vectors: ""
[2023-06-20 18:32:46] [config] ulr-softmax-temperature: 1
[2023-06-20 18:32:46] [config] ulr-trainable-transformation: false
[2023-06-20 18:32:46] [config] unlikelihood-loss: false
[2023-06-20 18:32:46] [config] valid-freq: 5000000
[2023-06-20 18:32:46] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 18:32:46] [config] valid-max-length: 1000
[2023-06-20 18:32:46] [config] valid-metrics:
[2023-06-20 18:32:46] [config]   - cross-entropy
[2023-06-20 18:32:46] [config] valid-mini-batch: 32
[2023-06-20 18:32:46] [config] valid-reset-stalled: false
[2023-06-20 18:32:46] [config] valid-script-args:
[2023-06-20 18:32:46] [config]   []
[2023-06-20 18:32:46] [config] valid-script-path: ""
[2023-06-20 18:32:46] [config] valid-sets:
[2023-06-20 18:32:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 18:32:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 18:32:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 18:32:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:32:46] [config] vocabs:
[2023-06-20 18:32:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:32:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:32:46] [config] word-penalty: 0
[2023-06-20 18:32:46] [config] word-scores: false
[2023-06-20 18:32:46] [config] workspace: 2048
[2023-06-20 18:32:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:32:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:32:46] [training] Using single-device training
[2023-06-20 18:32:47] Synced seed 1234
[2023-06-20 18:32:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:32:47] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 18:32:47] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:32:47] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 18:32:47] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:32:47] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 18:32:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 18:32:48] [comm] Using global sharding
[2023-06-20 18:32:48] [comm] NCCLCommunicators constructed successfully
[2023-06-20 18:32:48] [training] Using 1 GPUs
[2023-06-20 18:32:48] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:32:50] Loading Adam parameters
[2023-06-20 18:32:50] [memory] Reserving 754 MB, device gpu0
[2023-06-20 18:32:51] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:32:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:32:51] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-06-20 18:32:51] [data] Shuffling data
[2023-06-20 18:32:51] [data] Done reading 20,192 sentences
[2023-06-20 18:32:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:32:51] Training started
[2023-06-20 18:32:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 18:32:51] [logits] Applying loss function for 1 factor(s)
[2023-06-20 18:32:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 18:32:51] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:32:51] Parameter type float32, optimization type float32, casting types false
[2023-06-20 18:33:34] Seen 18,843 samples
[2023-06-20 18:33:34] Starting data epoch 92 in logical epoch 92
[2023-06-20 18:33:34] [data] Shuffling data
[2023-06-20 18:33:34] [data] Done reading 20,192 sentences
[2023-06-20 18:33:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:33:35] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.44126144 * 1,333,196 @ 488 after 36,218,424 : Time 48.31s : 27598.37 words/s : gNorm 0.6261
[2023-06-20 18:34:18] Seen 18,843 samples
[2023-06-20 18:34:18] Starting data epoch 93 in logical epoch 93
[2023-06-20 18:34:18] [data] Shuffling data
[2023-06-20 18:34:18] [data] Done reading 20,192 sentences
[2023-06-20 18:34:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:35:03] Seen 18,843 samples
[2023-06-20 18:35:03] Starting data epoch 94 in logical epoch 94
[2023-06-20 18:35:03] [data] Shuffling data
[2023-06-20 18:35:03] [data] Done reading 20,192 sentences
[2023-06-20 18:35:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:35:48] Seen 18,843 samples
[2023-06-20 18:35:48] Starting data epoch 95 in logical epoch 95
[2023-06-20 18:35:48] [data] Shuffling data
[2023-06-20 18:35:48] [data] Done reading 20,192 sentences
[2023-06-20 18:35:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:36:07] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.37681255 * 1,349,095 @ 2,048 after 37,567,519 : Time 151.62s : 8897.62 words/s : gNorm 0.6924
[2023-06-20 18:36:33] Seen 18,843 samples
[2023-06-20 18:36:33] Starting data epoch 96 in logical epoch 96
[2023-06-20 18:36:33] [data] Shuffling data
[2023-06-20 18:36:33] [data] Done reading 20,192 sentences
[2023-06-20 18:36:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:37:17] Seen 18,843 samples
[2023-06-20 18:37:17] Starting data epoch 97 in logical epoch 97
[2023-06-20 18:37:17] [data] Shuffling data
[2023-06-20 18:37:17] [data] Done reading 20,192 sentences
[2023-06-20 18:37:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:38:02] Seen 18,843 samples
[2023-06-20 18:38:02] Starting data epoch 98 in logical epoch 98
[2023-06-20 18:38:02] [data] Shuffling data
[2023-06-20 18:38:03] [data] Done reading 20,192 sentences
[2023-06-20 18:38:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:38:37] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.31538022 * 1,338,821 @ 2,572 after 38,906,340 : Time 150.16s : 8916.10 words/s : gNorm 0.6066
[2023-06-20 18:38:48] Seen 18,843 samples
[2023-06-20 18:38:48] Starting data epoch 99 in logical epoch 99
[2023-06-20 18:38:48] [data] Shuffling data
[2023-06-20 18:38:48] [data] Done reading 20,192 sentences
[2023-06-20 18:38:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:39:33] Seen 18,843 samples
[2023-06-20 18:39:33] Starting data epoch 100 in logical epoch 100
[2023-06-20 18:39:33] [data] Shuffling data
[2023-06-20 18:39:33] [data] Done reading 20,192 sentences
[2023-06-20 18:39:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:40:18] Seen 18,843 samples
[2023-06-20 18:40:18] Starting data epoch 101 in logical epoch 101
[2023-06-20 18:40:18] Training finished
[2023-06-20 18:40:24] [valid] Ep. 101 : Up. 29659 : cross-entropy : 194.321 : stalled 9 times (last best: 108.422)
[2023-06-20 18:40:24] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:40:27] Saving Adam parameters
[2023-06-20 18:40:28] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:45:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:45:19] [marian] Running on node21.datos.cluster.uy as process 39264 with command line:
[2023-06-20 18:45:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 110 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 18:45:19] [config] after: 0e
[2023-06-20 18:45:19] [config] after-batches: 0
[2023-06-20 18:45:19] [config] after-epochs: 110
[2023-06-20 18:45:19] [config] all-caps-every: 0
[2023-06-20 18:45:19] [config] allow-unk: false
[2023-06-20 18:45:19] [config] authors: false
[2023-06-20 18:45:19] [config] beam-size: 12
[2023-06-20 18:45:19] [config] bert-class-symbol: "[CLS]"
[2023-06-20 18:45:19] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 18:45:19] [config] bert-masking-fraction: 0.15
[2023-06-20 18:45:19] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 18:45:19] [config] bert-train-type-embeddings: true
[2023-06-20 18:45:19] [config] bert-type-vocab-size: 2
[2023-06-20 18:45:19] [config] build-info: ""
[2023-06-20 18:45:19] [config] check-gradient-nan: false
[2023-06-20 18:45:19] [config] check-nan: false
[2023-06-20 18:45:19] [config] cite: false
[2023-06-20 18:45:19] [config] clip-norm: 1
[2023-06-20 18:45:19] [config] cost-scaling:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] cost-type: ce-sum
[2023-06-20 18:45:19] [config] cpu-threads: 0
[2023-06-20 18:45:19] [config] data-threads: 8
[2023-06-20 18:45:19] [config] data-weighting: ""
[2023-06-20 18:45:19] [config] data-weighting-type: sentence
[2023-06-20 18:45:19] [config] dec-cell: gru
[2023-06-20 18:45:19] [config] dec-cell-base-depth: 2
[2023-06-20 18:45:19] [config] dec-cell-high-depth: 1
[2023-06-20 18:45:19] [config] dec-depth: 1
[2023-06-20 18:45:19] [config] devices:
[2023-06-20 18:45:19] [config]   - 0
[2023-06-20 18:45:19] [config] dim-emb: 512
[2023-06-20 18:45:19] [config] dim-rnn: 1024
[2023-06-20 18:45:19] [config] dim-vocabs:
[2023-06-20 18:45:19] [config]   - 54042
[2023-06-20 18:45:19] [config]   - 36507
[2023-06-20 18:45:19] [config] disp-first: 0
[2023-06-20 18:45:19] [config] disp-freq: 1000u
[2023-06-20 18:45:19] [config] disp-label-counts: true
[2023-06-20 18:45:19] [config] dropout-rnn: 0
[2023-06-20 18:45:19] [config] dropout-src: 0
[2023-06-20 18:45:19] [config] dropout-trg: 0
[2023-06-20 18:45:19] [config] dump-config: ""
[2023-06-20 18:45:19] [config] dynamic-gradient-scaling:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] early-stopping: 10
[2023-06-20 18:45:19] [config] early-stopping-on: first
[2023-06-20 18:45:19] [config] embedding-fix-src: false
[2023-06-20 18:45:19] [config] embedding-fix-trg: false
[2023-06-20 18:45:19] [config] embedding-normalization: false
[2023-06-20 18:45:19] [config] embedding-vectors:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] enc-cell: gru
[2023-06-20 18:45:19] [config] enc-cell-depth: 1
[2023-06-20 18:45:19] [config] enc-depth: 1
[2023-06-20 18:45:19] [config] enc-type: bidirectional
[2023-06-20 18:45:19] [config] english-title-case-every: 0
[2023-06-20 18:45:19] [config] exponential-smoothing: 0
[2023-06-20 18:45:19] [config] factor-weight: 1
[2023-06-20 18:45:19] [config] factors-combine: sum
[2023-06-20 18:45:19] [config] factors-dim-emb: 0
[2023-06-20 18:45:19] [config] gradient-checkpointing: false
[2023-06-20 18:45:19] [config] gradient-norm-average-window: 100
[2023-06-20 18:45:19] [config] guided-alignment: none
[2023-06-20 18:45:19] [config] guided-alignment-cost: mse
[2023-06-20 18:45:19] [config] guided-alignment-weight: 0.1
[2023-06-20 18:45:19] [config] ignore-model-config: false
[2023-06-20 18:45:19] [config] input-types:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] interpolate-env-vars: false
[2023-06-20 18:45:19] [config] keep-best: false
[2023-06-20 18:45:19] [config] label-smoothing: 0
[2023-06-20 18:45:19] [config] layer-normalization: false
[2023-06-20 18:45:19] [config] learn-rate: 0.0001
[2023-06-20 18:45:19] [config] lemma-dependency: ""
[2023-06-20 18:45:19] [config] lemma-dim-emb: 0
[2023-06-20 18:45:19] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 18:45:19] [config] log-level: info
[2023-06-20 18:45:19] [config] log-time-zone: ""
[2023-06-20 18:45:19] [config] logical-epoch:
[2023-06-20 18:45:19] [config]   - 1e
[2023-06-20 18:45:19] [config]   - 0
[2023-06-20 18:45:19] [config] lr-decay: 0
[2023-06-20 18:45:19] [config] lr-decay-freq: 50000
[2023-06-20 18:45:19] [config] lr-decay-inv-sqrt:
[2023-06-20 18:45:19] [config]   - 0
[2023-06-20 18:45:19] [config] lr-decay-repeat-warmup: false
[2023-06-20 18:45:19] [config] lr-decay-reset-optimizer: false
[2023-06-20 18:45:19] [config] lr-decay-start:
[2023-06-20 18:45:19] [config]   - 10
[2023-06-20 18:45:19] [config]   - 1
[2023-06-20 18:45:19] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 18:45:19] [config] lr-report: false
[2023-06-20 18:45:19] [config] lr-warmup: 0
[2023-06-20 18:45:19] [config] lr-warmup-at-reload: false
[2023-06-20 18:45:19] [config] lr-warmup-cycle: false
[2023-06-20 18:45:19] [config] lr-warmup-start-rate: 0
[2023-06-20 18:45:19] [config] max-length: 50
[2023-06-20 18:45:19] [config] max-length-crop: false
[2023-06-20 18:45:19] [config] max-length-factor: 3
[2023-06-20 18:45:19] [config] maxi-batch: 100
[2023-06-20 18:45:19] [config] maxi-batch-sort: trg
[2023-06-20 18:45:19] [config] mini-batch: 64
[2023-06-20 18:45:19] [config] mini-batch-fit: false
[2023-06-20 18:45:19] [config] mini-batch-fit-step: 10
[2023-06-20 18:45:19] [config] mini-batch-round-up: true
[2023-06-20 18:45:19] [config] mini-batch-track-lr: false
[2023-06-20 18:45:19] [config] mini-batch-warmup: 0
[2023-06-20 18:45:19] [config] mini-batch-words: 0
[2023-06-20 18:45:19] [config] mini-batch-words-ref: 0
[2023-06-20 18:45:19] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:45:19] [config] multi-loss-type: sum
[2023-06-20 18:45:19] [config] n-best: false
[2023-06-20 18:45:19] [config] no-nccl: false
[2023-06-20 18:45:19] [config] no-reload: false
[2023-06-20 18:45:19] [config] no-restore-corpus: false
[2023-06-20 18:45:19] [config] normalize: 0
[2023-06-20 18:45:19] [config] normalize-gradient: false
[2023-06-20 18:45:19] [config] num-devices: 0
[2023-06-20 18:45:19] [config] optimizer: adam
[2023-06-20 18:45:19] [config] optimizer-delay: 1
[2023-06-20 18:45:19] [config] optimizer-params:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] output-omit-bias: false
[2023-06-20 18:45:19] [config] overwrite: false
[2023-06-20 18:45:19] [config] precision:
[2023-06-20 18:45:19] [config]   - float32
[2023-06-20 18:45:19] [config]   - float32
[2023-06-20 18:45:19] [config] pretrained-model: ""
[2023-06-20 18:45:19] [config] quantize-biases: false
[2023-06-20 18:45:19] [config] quantize-bits: 0
[2023-06-20 18:45:19] [config] quantize-log-based: false
[2023-06-20 18:45:19] [config] quantize-optimization-steps: 0
[2023-06-20 18:45:19] [config] quiet: false
[2023-06-20 18:45:19] [config] quiet-translation: true
[2023-06-20 18:45:19] [config] relative-paths: false
[2023-06-20 18:45:19] [config] right-left: false
[2023-06-20 18:45:19] [config] save-freq: 10000u
[2023-06-20 18:45:19] [config] seed: 1234
[2023-06-20 18:45:19] [config] sentencepiece-alphas:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] sentencepiece-max-lines: 2000000
[2023-06-20 18:45:19] [config] sentencepiece-options: ""
[2023-06-20 18:45:19] [config] sharding: global
[2023-06-20 18:45:19] [config] shuffle: data
[2023-06-20 18:45:19] [config] shuffle-in-ram: false
[2023-06-20 18:45:19] [config] sigterm: save-and-exit
[2023-06-20 18:45:19] [config] skip: false
[2023-06-20 18:45:19] [config] sqlite: ""
[2023-06-20 18:45:19] [config] sqlite-drop: false
[2023-06-20 18:45:19] [config] sync-freq: 200u
[2023-06-20 18:45:19] [config] sync-sgd: false
[2023-06-20 18:45:19] [config] tempdir: /tmp
[2023-06-20 18:45:19] [config] tied-embeddings: false
[2023-06-20 18:45:19] [config] tied-embeddings-all: false
[2023-06-20 18:45:19] [config] tied-embeddings-src: false
[2023-06-20 18:45:19] [config] train-embedder-rank:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] train-sets:
[2023-06-20 18:45:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 18:45:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 18:45:19] [config] transformer-aan-activation: swish
[2023-06-20 18:45:19] [config] transformer-aan-depth: 2
[2023-06-20 18:45:19] [config] transformer-aan-nogate: false
[2023-06-20 18:45:19] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 18:45:19] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 18:45:19] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 18:45:19] [config] transformer-depth-scaling: false
[2023-06-20 18:45:19] [config] transformer-dim-aan: 2048
[2023-06-20 18:45:19] [config] transformer-dim-ffn: 2048
[2023-06-20 18:45:19] [config] transformer-dropout: 0
[2023-06-20 18:45:19] [config] transformer-dropout-attention: 0
[2023-06-20 18:45:19] [config] transformer-dropout-ffn: 0
[2023-06-20 18:45:19] [config] transformer-ffn-activation: swish
[2023-06-20 18:45:19] [config] transformer-ffn-depth: 2
[2023-06-20 18:45:19] [config] transformer-guided-alignment-layer: last
[2023-06-20 18:45:19] [config] transformer-heads: 8
[2023-06-20 18:45:19] [config] transformer-no-projection: false
[2023-06-20 18:45:19] [config] transformer-pool: false
[2023-06-20 18:45:19] [config] transformer-postprocess: dan
[2023-06-20 18:45:19] [config] transformer-postprocess-emb: d
[2023-06-20 18:45:19] [config] transformer-postprocess-top: ""
[2023-06-20 18:45:19] [config] transformer-preprocess: ""
[2023-06-20 18:45:19] [config] transformer-tied-layers:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] transformer-train-position-embeddings: false
[2023-06-20 18:45:19] [config] tsv: false
[2023-06-20 18:45:19] [config] tsv-fields: 0
[2023-06-20 18:45:19] [config] type: amun
[2023-06-20 18:45:19] [config] ulr: false
[2023-06-20 18:45:19] [config] ulr-dim-emb: 0
[2023-06-20 18:45:19] [config] ulr-dropout: 0
[2023-06-20 18:45:19] [config] ulr-keys-vectors: ""
[2023-06-20 18:45:19] [config] ulr-query-vectors: ""
[2023-06-20 18:45:19] [config] ulr-softmax-temperature: 1
[2023-06-20 18:45:19] [config] ulr-trainable-transformation: false
[2023-06-20 18:45:19] [config] unlikelihood-loss: false
[2023-06-20 18:45:19] [config] valid-freq: 5000000
[2023-06-20 18:45:19] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 18:45:19] [config] valid-max-length: 1000
[2023-06-20 18:45:19] [config] valid-metrics:
[2023-06-20 18:45:19] [config]   - cross-entropy
[2023-06-20 18:45:19] [config] valid-mini-batch: 32
[2023-06-20 18:45:19] [config] valid-reset-stalled: false
[2023-06-20 18:45:19] [config] valid-script-args:
[2023-06-20 18:45:19] [config]   []
[2023-06-20 18:45:19] [config] valid-script-path: ""
[2023-06-20 18:45:19] [config] valid-sets:
[2023-06-20 18:45:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 18:45:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 18:45:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 18:45:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:45:19] [config] vocabs:
[2023-06-20 18:45:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:45:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:45:19] [config] word-penalty: 0
[2023-06-20 18:45:19] [config] word-scores: false
[2023-06-20 18:45:19] [config] workspace: 2048
[2023-06-20 18:45:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:45:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:45:19] [training] Using single-device training
[2023-06-20 18:45:20] Synced seed 1234
[2023-06-20 18:45:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:45:20] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 18:45:20] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:45:20] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 18:45:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:45:21] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 18:45:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 18:45:21] [comm] Using global sharding
[2023-06-20 18:45:21] [comm] NCCLCommunicators constructed successfully
[2023-06-20 18:45:21] [training] Using 1 GPUs
[2023-06-20 18:45:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:45:24] Loading Adam parameters
[2023-06-20 18:45:24] [memory] Reserving 754 MB, device gpu0
[2023-06-20 18:45:24] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:45:24] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:45:24] [data] Restoring the corpus state to epoch 101, batch 29659
[2023-06-20 18:45:24] [data] Shuffling data
[2023-06-20 18:45:24] [data] Done reading 20,192 sentences
[2023-06-20 18:45:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:45:24] Training started
[2023-06-20 18:45:24] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 18:45:24] [logits] Applying loss function for 1 factor(s)
[2023-06-20 18:45:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 18:45:25] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:45:25] Parameter type float32, optimization type float32, casting types false
[2023-06-20 18:46:07] Seen 18,843 samples
[2023-06-20 18:46:07] Starting data epoch 102 in logical epoch 102
[2023-06-20 18:46:07] [data] Shuffling data
[2023-06-20 18:46:07] [data] Done reading 20,192 sentences
[2023-06-20 18:46:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:46:13] Ep. 102 : Up. 30000 : Sen. 2,816 : Cost 0.26705581 * 1,341,254 @ 2,240 after 40,247,594 : Time 52.74s : 25430.49 words/s : gNorm 0.4880
[2023-06-20 18:46:13] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.iter30000.npz
[2023-06-20 18:46:16] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:46:19] Saving Adam parameters
[2023-06-20 18:46:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:47:03] Seen 18,843 samples
[2023-06-20 18:47:03] Starting data epoch 103 in logical epoch 103
[2023-06-20 18:47:03] [data] Shuffling data
[2023-06-20 18:47:03] [data] Done reading 20,192 sentences
[2023-06-20 18:47:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:47:47] Seen 18,843 samples
[2023-06-20 18:47:47] Starting data epoch 104 in logical epoch 104
[2023-06-20 18:47:47] [data] Shuffling data
[2023-06-20 18:47:47] [data] Done reading 20,192 sentences
[2023-06-20 18:47:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:48:32] Seen 18,843 samples
[2023-06-20 18:48:32] Starting data epoch 105 in logical epoch 105
[2023-06-20 18:48:32] [data] Shuffling data
[2023-06-20 18:48:32] [data] Done reading 20,192 sentences
[2023-06-20 18:48:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:48:55] Ep. 105 : Up. 31000 : Sen. 9,742 : Cost 0.22300778 * 1,341,970 @ 1,536 after 41,589,564 : Time 161.69s : 8299.61 words/s : gNorm 0.5152
[2023-06-20 18:49:16] Seen 18,843 samples
[2023-06-20 18:49:16] Starting data epoch 106 in logical epoch 106
[2023-06-20 18:49:16] [data] Shuffling data
[2023-06-20 18:49:16] [data] Done reading 20,192 sentences
[2023-06-20 18:49:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:50:00] Seen 18,843 samples
[2023-06-20 18:50:00] Starting data epoch 107 in logical epoch 107
[2023-06-20 18:50:00] [data] Shuffling data
[2023-06-20 18:50:00] [data] Done reading 20,192 sentences
[2023-06-20 18:50:00] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:50:45] Seen 18,843 samples
[2023-06-20 18:50:45] Starting data epoch 108 in logical epoch 108
[2023-06-20 18:50:45] [data] Shuffling data
[2023-06-20 18:50:45] [data] Done reading 20,192 sentences
[2023-06-20 18:50:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:51:24] Ep. 108 : Up. 32000 : Sen. 16,655 : Cost 0.18039937 * 1,331,544 @ 948 after 42,921,108 : Time 149.17s : 8926.57 words/s : gNorm 0.4760
[2023-06-20 18:51:30] Seen 18,843 samples
[2023-06-20 18:51:30] Starting data epoch 109 in logical epoch 109
[2023-06-20 18:51:30] [data] Shuffling data
[2023-06-20 18:51:30] [data] Done reading 20,192 sentences
[2023-06-20 18:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:52:15] Seen 18,843 samples
[2023-06-20 18:52:15] Starting data epoch 110 in logical epoch 110
[2023-06-20 18:52:15] [data] Shuffling data
[2023-06-20 18:52:15] [data] Done reading 20,192 sentences
[2023-06-20 18:52:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:53:00] Seen 18,843 samples
[2023-06-20 18:53:00] Starting data epoch 111 in logical epoch 111
[2023-06-20 18:53:00] Training finished
[2023-06-20 18:53:06] [valid] Ep. 111 : Up. 32628 : cross-entropy : 202.487 : stalled 10 times (last best: 108.422)
[2023-06-20 18:53:06] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:53:09] Saving Adam parameters
[2023-06-20 18:53:11] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:57:58] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:57:58] [marian] Running on node21.datos.cluster.uy as process 40344 with command line:
[2023-06-20 18:57:58] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 120 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 18:57:58] [config] after: 0e
[2023-06-20 18:57:58] [config] after-batches: 0
[2023-06-20 18:57:58] [config] after-epochs: 120
[2023-06-20 18:57:58] [config] all-caps-every: 0
[2023-06-20 18:57:58] [config] allow-unk: false
[2023-06-20 18:57:58] [config] authors: false
[2023-06-20 18:57:58] [config] beam-size: 12
[2023-06-20 18:57:58] [config] bert-class-symbol: "[CLS]"
[2023-06-20 18:57:58] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 18:57:58] [config] bert-masking-fraction: 0.15
[2023-06-20 18:57:58] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 18:57:58] [config] bert-train-type-embeddings: true
[2023-06-20 18:57:58] [config] bert-type-vocab-size: 2
[2023-06-20 18:57:58] [config] build-info: ""
[2023-06-20 18:57:58] [config] check-gradient-nan: false
[2023-06-20 18:57:58] [config] check-nan: false
[2023-06-20 18:57:58] [config] cite: false
[2023-06-20 18:57:58] [config] clip-norm: 1
[2023-06-20 18:57:58] [config] cost-scaling:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] cost-type: ce-sum
[2023-06-20 18:57:58] [config] cpu-threads: 0
[2023-06-20 18:57:58] [config] data-threads: 8
[2023-06-20 18:57:58] [config] data-weighting: ""
[2023-06-20 18:57:58] [config] data-weighting-type: sentence
[2023-06-20 18:57:58] [config] dec-cell: gru
[2023-06-20 18:57:58] [config] dec-cell-base-depth: 2
[2023-06-20 18:57:58] [config] dec-cell-high-depth: 1
[2023-06-20 18:57:58] [config] dec-depth: 1
[2023-06-20 18:57:58] [config] devices:
[2023-06-20 18:57:58] [config]   - 0
[2023-06-20 18:57:58] [config] dim-emb: 512
[2023-06-20 18:57:58] [config] dim-rnn: 1024
[2023-06-20 18:57:58] [config] dim-vocabs:
[2023-06-20 18:57:58] [config]   - 54042
[2023-06-20 18:57:58] [config]   - 36507
[2023-06-20 18:57:58] [config] disp-first: 0
[2023-06-20 18:57:58] [config] disp-freq: 1000u
[2023-06-20 18:57:58] [config] disp-label-counts: true
[2023-06-20 18:57:58] [config] dropout-rnn: 0
[2023-06-20 18:57:58] [config] dropout-src: 0
[2023-06-20 18:57:58] [config] dropout-trg: 0
[2023-06-20 18:57:58] [config] dump-config: ""
[2023-06-20 18:57:58] [config] dynamic-gradient-scaling:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] early-stopping: 10
[2023-06-20 18:57:58] [config] early-stopping-on: first
[2023-06-20 18:57:58] [config] embedding-fix-src: false
[2023-06-20 18:57:58] [config] embedding-fix-trg: false
[2023-06-20 18:57:58] [config] embedding-normalization: false
[2023-06-20 18:57:58] [config] embedding-vectors:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] enc-cell: gru
[2023-06-20 18:57:58] [config] enc-cell-depth: 1
[2023-06-20 18:57:58] [config] enc-depth: 1
[2023-06-20 18:57:58] [config] enc-type: bidirectional
[2023-06-20 18:57:58] [config] english-title-case-every: 0
[2023-06-20 18:57:58] [config] exponential-smoothing: 0
[2023-06-20 18:57:58] [config] factor-weight: 1
[2023-06-20 18:57:58] [config] factors-combine: sum
[2023-06-20 18:57:58] [config] factors-dim-emb: 0
[2023-06-20 18:57:58] [config] gradient-checkpointing: false
[2023-06-20 18:57:58] [config] gradient-norm-average-window: 100
[2023-06-20 18:57:58] [config] guided-alignment: none
[2023-06-20 18:57:58] [config] guided-alignment-cost: mse
[2023-06-20 18:57:58] [config] guided-alignment-weight: 0.1
[2023-06-20 18:57:58] [config] ignore-model-config: false
[2023-06-20 18:57:58] [config] input-types:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] interpolate-env-vars: false
[2023-06-20 18:57:58] [config] keep-best: false
[2023-06-20 18:57:58] [config] label-smoothing: 0
[2023-06-20 18:57:58] [config] layer-normalization: false
[2023-06-20 18:57:58] [config] learn-rate: 0.0001
[2023-06-20 18:57:58] [config] lemma-dependency: ""
[2023-06-20 18:57:58] [config] lemma-dim-emb: 0
[2023-06-20 18:57:58] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 18:57:58] [config] log-level: info
[2023-06-20 18:57:58] [config] log-time-zone: ""
[2023-06-20 18:57:58] [config] logical-epoch:
[2023-06-20 18:57:58] [config]   - 1e
[2023-06-20 18:57:58] [config]   - 0
[2023-06-20 18:57:58] [config] lr-decay: 0
[2023-06-20 18:57:58] [config] lr-decay-freq: 50000
[2023-06-20 18:57:58] [config] lr-decay-inv-sqrt:
[2023-06-20 18:57:58] [config]   - 0
[2023-06-20 18:57:58] [config] lr-decay-repeat-warmup: false
[2023-06-20 18:57:58] [config] lr-decay-reset-optimizer: false
[2023-06-20 18:57:58] [config] lr-decay-start:
[2023-06-20 18:57:58] [config]   - 10
[2023-06-20 18:57:58] [config]   - 1
[2023-06-20 18:57:58] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 18:57:58] [config] lr-report: false
[2023-06-20 18:57:58] [config] lr-warmup: 0
[2023-06-20 18:57:58] [config] lr-warmup-at-reload: false
[2023-06-20 18:57:58] [config] lr-warmup-cycle: false
[2023-06-20 18:57:58] [config] lr-warmup-start-rate: 0
[2023-06-20 18:57:58] [config] max-length: 50
[2023-06-20 18:57:58] [config] max-length-crop: false
[2023-06-20 18:57:58] [config] max-length-factor: 3
[2023-06-20 18:57:58] [config] maxi-batch: 100
[2023-06-20 18:57:58] [config] maxi-batch-sort: trg
[2023-06-20 18:57:58] [config] mini-batch: 64
[2023-06-20 18:57:58] [config] mini-batch-fit: false
[2023-06-20 18:57:58] [config] mini-batch-fit-step: 10
[2023-06-20 18:57:58] [config] mini-batch-round-up: true
[2023-06-20 18:57:58] [config] mini-batch-track-lr: false
[2023-06-20 18:57:58] [config] mini-batch-warmup: 0
[2023-06-20 18:57:58] [config] mini-batch-words: 0
[2023-06-20 18:57:58] [config] mini-batch-words-ref: 0
[2023-06-20 18:57:58] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:57:58] [config] multi-loss-type: sum
[2023-06-20 18:57:58] [config] n-best: false
[2023-06-20 18:57:58] [config] no-nccl: false
[2023-06-20 18:57:58] [config] no-reload: false
[2023-06-20 18:57:58] [config] no-restore-corpus: false
[2023-06-20 18:57:58] [config] normalize: 0
[2023-06-20 18:57:58] [config] normalize-gradient: false
[2023-06-20 18:57:58] [config] num-devices: 0
[2023-06-20 18:57:58] [config] optimizer: adam
[2023-06-20 18:57:58] [config] optimizer-delay: 1
[2023-06-20 18:57:58] [config] optimizer-params:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] output-omit-bias: false
[2023-06-20 18:57:58] [config] overwrite: false
[2023-06-20 18:57:58] [config] precision:
[2023-06-20 18:57:58] [config]   - float32
[2023-06-20 18:57:58] [config]   - float32
[2023-06-20 18:57:58] [config] pretrained-model: ""
[2023-06-20 18:57:58] [config] quantize-biases: false
[2023-06-20 18:57:58] [config] quantize-bits: 0
[2023-06-20 18:57:58] [config] quantize-log-based: false
[2023-06-20 18:57:58] [config] quantize-optimization-steps: 0
[2023-06-20 18:57:58] [config] quiet: false
[2023-06-20 18:57:58] [config] quiet-translation: true
[2023-06-20 18:57:58] [config] relative-paths: false
[2023-06-20 18:57:58] [config] right-left: false
[2023-06-20 18:57:58] [config] save-freq: 10000u
[2023-06-20 18:57:58] [config] seed: 1234
[2023-06-20 18:57:58] [config] sentencepiece-alphas:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] sentencepiece-max-lines: 2000000
[2023-06-20 18:57:58] [config] sentencepiece-options: ""
[2023-06-20 18:57:58] [config] sharding: global
[2023-06-20 18:57:58] [config] shuffle: data
[2023-06-20 18:57:58] [config] shuffle-in-ram: false
[2023-06-20 18:57:58] [config] sigterm: save-and-exit
[2023-06-20 18:57:58] [config] skip: false
[2023-06-20 18:57:58] [config] sqlite: ""
[2023-06-20 18:57:58] [config] sqlite-drop: false
[2023-06-20 18:57:58] [config] sync-freq: 200u
[2023-06-20 18:57:58] [config] sync-sgd: false
[2023-06-20 18:57:58] [config] tempdir: /tmp
[2023-06-20 18:57:58] [config] tied-embeddings: false
[2023-06-20 18:57:58] [config] tied-embeddings-all: false
[2023-06-20 18:57:58] [config] tied-embeddings-src: false
[2023-06-20 18:57:58] [config] train-embedder-rank:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] train-sets:
[2023-06-20 18:57:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 18:57:58] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 18:57:58] [config] transformer-aan-activation: swish
[2023-06-20 18:57:58] [config] transformer-aan-depth: 2
[2023-06-20 18:57:58] [config] transformer-aan-nogate: false
[2023-06-20 18:57:58] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 18:57:58] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 18:57:58] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 18:57:58] [config] transformer-depth-scaling: false
[2023-06-20 18:57:58] [config] transformer-dim-aan: 2048
[2023-06-20 18:57:58] [config] transformer-dim-ffn: 2048
[2023-06-20 18:57:58] [config] transformer-dropout: 0
[2023-06-20 18:57:58] [config] transformer-dropout-attention: 0
[2023-06-20 18:57:58] [config] transformer-dropout-ffn: 0
[2023-06-20 18:57:58] [config] transformer-ffn-activation: swish
[2023-06-20 18:57:58] [config] transformer-ffn-depth: 2
[2023-06-20 18:57:58] [config] transformer-guided-alignment-layer: last
[2023-06-20 18:57:58] [config] transformer-heads: 8
[2023-06-20 18:57:58] [config] transformer-no-projection: false
[2023-06-20 18:57:58] [config] transformer-pool: false
[2023-06-20 18:57:58] [config] transformer-postprocess: dan
[2023-06-20 18:57:58] [config] transformer-postprocess-emb: d
[2023-06-20 18:57:58] [config] transformer-postprocess-top: ""
[2023-06-20 18:57:58] [config] transformer-preprocess: ""
[2023-06-20 18:57:58] [config] transformer-tied-layers:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] transformer-train-position-embeddings: false
[2023-06-20 18:57:58] [config] tsv: false
[2023-06-20 18:57:58] [config] tsv-fields: 0
[2023-06-20 18:57:58] [config] type: amun
[2023-06-20 18:57:58] [config] ulr: false
[2023-06-20 18:57:58] [config] ulr-dim-emb: 0
[2023-06-20 18:57:58] [config] ulr-dropout: 0
[2023-06-20 18:57:58] [config] ulr-keys-vectors: ""
[2023-06-20 18:57:58] [config] ulr-query-vectors: ""
[2023-06-20 18:57:58] [config] ulr-softmax-temperature: 1
[2023-06-20 18:57:58] [config] ulr-trainable-transformation: false
[2023-06-20 18:57:58] [config] unlikelihood-loss: false
[2023-06-20 18:57:58] [config] valid-freq: 5000000
[2023-06-20 18:57:58] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 18:57:58] [config] valid-max-length: 1000
[2023-06-20 18:57:58] [config] valid-metrics:
[2023-06-20 18:57:58] [config]   - cross-entropy
[2023-06-20 18:57:58] [config] valid-mini-batch: 32
[2023-06-20 18:57:58] [config] valid-reset-stalled: false
[2023-06-20 18:57:58] [config] valid-script-args:
[2023-06-20 18:57:58] [config]   []
[2023-06-20 18:57:58] [config] valid-script-path: ""
[2023-06-20 18:57:58] [config] valid-sets:
[2023-06-20 18:57:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 18:57:58] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 18:57:58] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 18:57:58] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:57:58] [config] vocabs:
[2023-06-20 18:57:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:57:58] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:57:58] [config] word-penalty: 0
[2023-06-20 18:57:58] [config] word-scores: false
[2023-06-20 18:57:58] [config] workspace: 2048
[2023-06-20 18:57:58] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 18:57:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:57:58] [training] Using single-device training
[2023-06-20 18:57:59] Synced seed 1234
[2023-06-20 18:57:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 18:57:59] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 18:57:59] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 18:57:59] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 18:57:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 18:57:59] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 18:57:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 18:57:59] [comm] Using global sharding
[2023-06-20 18:57:59] [comm] NCCLCommunicators constructed successfully
[2023-06-20 18:57:59] [training] Using 1 GPUs
[2023-06-20 18:57:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 18:58:02] Loading Adam parameters
[2023-06-20 18:58:02] [memory] Reserving 754 MB, device gpu0
[2023-06-20 18:58:02] [memory] Reserving 377 MB, device gpu0
[2023-06-20 18:58:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 18:58:03] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 18:58:03] [data] Shuffling data
[2023-06-20 18:58:03] [data] Done reading 20,192 sentences
[2023-06-20 18:58:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 18:58:03] Training started
[2023-06-20 18:58:03] Training finished
[2023-06-20 19:02:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:02:44] [marian] Running on node21.datos.cluster.uy as process 40668 with command line:
[2023-06-20 19:02:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 130 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:02:44] [config] after: 0e
[2023-06-20 19:02:44] [config] after-batches: 0
[2023-06-20 19:02:44] [config] after-epochs: 130
[2023-06-20 19:02:44] [config] all-caps-every: 0
[2023-06-20 19:02:44] [config] allow-unk: false
[2023-06-20 19:02:44] [config] authors: false
[2023-06-20 19:02:44] [config] beam-size: 12
[2023-06-20 19:02:44] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:02:44] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:02:44] [config] bert-masking-fraction: 0.15
[2023-06-20 19:02:44] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:02:44] [config] bert-train-type-embeddings: true
[2023-06-20 19:02:44] [config] bert-type-vocab-size: 2
[2023-06-20 19:02:44] [config] build-info: ""
[2023-06-20 19:02:44] [config] check-gradient-nan: false
[2023-06-20 19:02:44] [config] check-nan: false
[2023-06-20 19:02:44] [config] cite: false
[2023-06-20 19:02:44] [config] clip-norm: 1
[2023-06-20 19:02:44] [config] cost-scaling:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] cost-type: ce-sum
[2023-06-20 19:02:44] [config] cpu-threads: 0
[2023-06-20 19:02:44] [config] data-threads: 8
[2023-06-20 19:02:44] [config] data-weighting: ""
[2023-06-20 19:02:44] [config] data-weighting-type: sentence
[2023-06-20 19:02:44] [config] dec-cell: gru
[2023-06-20 19:02:44] [config] dec-cell-base-depth: 2
[2023-06-20 19:02:44] [config] dec-cell-high-depth: 1
[2023-06-20 19:02:44] [config] dec-depth: 1
[2023-06-20 19:02:44] [config] devices:
[2023-06-20 19:02:44] [config]   - 0
[2023-06-20 19:02:44] [config] dim-emb: 512
[2023-06-20 19:02:44] [config] dim-rnn: 1024
[2023-06-20 19:02:44] [config] dim-vocabs:
[2023-06-20 19:02:44] [config]   - 54042
[2023-06-20 19:02:44] [config]   - 36507
[2023-06-20 19:02:44] [config] disp-first: 0
[2023-06-20 19:02:44] [config] disp-freq: 1000u
[2023-06-20 19:02:44] [config] disp-label-counts: true
[2023-06-20 19:02:44] [config] dropout-rnn: 0
[2023-06-20 19:02:44] [config] dropout-src: 0
[2023-06-20 19:02:44] [config] dropout-trg: 0
[2023-06-20 19:02:44] [config] dump-config: ""
[2023-06-20 19:02:44] [config] dynamic-gradient-scaling:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] early-stopping: 10
[2023-06-20 19:02:44] [config] early-stopping-on: first
[2023-06-20 19:02:44] [config] embedding-fix-src: false
[2023-06-20 19:02:44] [config] embedding-fix-trg: false
[2023-06-20 19:02:44] [config] embedding-normalization: false
[2023-06-20 19:02:44] [config] embedding-vectors:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] enc-cell: gru
[2023-06-20 19:02:44] [config] enc-cell-depth: 1
[2023-06-20 19:02:44] [config] enc-depth: 1
[2023-06-20 19:02:44] [config] enc-type: bidirectional
[2023-06-20 19:02:44] [config] english-title-case-every: 0
[2023-06-20 19:02:44] [config] exponential-smoothing: 0
[2023-06-20 19:02:44] [config] factor-weight: 1
[2023-06-20 19:02:44] [config] factors-combine: sum
[2023-06-20 19:02:44] [config] factors-dim-emb: 0
[2023-06-20 19:02:44] [config] gradient-checkpointing: false
[2023-06-20 19:02:44] [config] gradient-norm-average-window: 100
[2023-06-20 19:02:44] [config] guided-alignment: none
[2023-06-20 19:02:44] [config] guided-alignment-cost: mse
[2023-06-20 19:02:44] [config] guided-alignment-weight: 0.1
[2023-06-20 19:02:44] [config] ignore-model-config: false
[2023-06-20 19:02:44] [config] input-types:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] interpolate-env-vars: false
[2023-06-20 19:02:44] [config] keep-best: false
[2023-06-20 19:02:44] [config] label-smoothing: 0
[2023-06-20 19:02:44] [config] layer-normalization: false
[2023-06-20 19:02:44] [config] learn-rate: 0.0001
[2023-06-20 19:02:44] [config] lemma-dependency: ""
[2023-06-20 19:02:44] [config] lemma-dim-emb: 0
[2023-06-20 19:02:44] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:02:44] [config] log-level: info
[2023-06-20 19:02:44] [config] log-time-zone: ""
[2023-06-20 19:02:44] [config] logical-epoch:
[2023-06-20 19:02:44] [config]   - 1e
[2023-06-20 19:02:44] [config]   - 0
[2023-06-20 19:02:44] [config] lr-decay: 0
[2023-06-20 19:02:44] [config] lr-decay-freq: 50000
[2023-06-20 19:02:44] [config] lr-decay-inv-sqrt:
[2023-06-20 19:02:44] [config]   - 0
[2023-06-20 19:02:44] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:02:44] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:02:44] [config] lr-decay-start:
[2023-06-20 19:02:44] [config]   - 10
[2023-06-20 19:02:44] [config]   - 1
[2023-06-20 19:02:44] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:02:44] [config] lr-report: false
[2023-06-20 19:02:44] [config] lr-warmup: 0
[2023-06-20 19:02:44] [config] lr-warmup-at-reload: false
[2023-06-20 19:02:44] [config] lr-warmup-cycle: false
[2023-06-20 19:02:44] [config] lr-warmup-start-rate: 0
[2023-06-20 19:02:44] [config] max-length: 50
[2023-06-20 19:02:44] [config] max-length-crop: false
[2023-06-20 19:02:44] [config] max-length-factor: 3
[2023-06-20 19:02:44] [config] maxi-batch: 100
[2023-06-20 19:02:44] [config] maxi-batch-sort: trg
[2023-06-20 19:02:44] [config] mini-batch: 64
[2023-06-20 19:02:44] [config] mini-batch-fit: false
[2023-06-20 19:02:44] [config] mini-batch-fit-step: 10
[2023-06-20 19:02:44] [config] mini-batch-round-up: true
[2023-06-20 19:02:44] [config] mini-batch-track-lr: false
[2023-06-20 19:02:44] [config] mini-batch-warmup: 0
[2023-06-20 19:02:44] [config] mini-batch-words: 0
[2023-06-20 19:02:44] [config] mini-batch-words-ref: 0
[2023-06-20 19:02:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:02:44] [config] multi-loss-type: sum
[2023-06-20 19:02:44] [config] n-best: false
[2023-06-20 19:02:44] [config] no-nccl: false
[2023-06-20 19:02:44] [config] no-reload: false
[2023-06-20 19:02:44] [config] no-restore-corpus: false
[2023-06-20 19:02:44] [config] normalize: 0
[2023-06-20 19:02:44] [config] normalize-gradient: false
[2023-06-20 19:02:44] [config] num-devices: 0
[2023-06-20 19:02:44] [config] optimizer: adam
[2023-06-20 19:02:44] [config] optimizer-delay: 1
[2023-06-20 19:02:44] [config] optimizer-params:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] output-omit-bias: false
[2023-06-20 19:02:44] [config] overwrite: false
[2023-06-20 19:02:44] [config] precision:
[2023-06-20 19:02:44] [config]   - float32
[2023-06-20 19:02:44] [config]   - float32
[2023-06-20 19:02:44] [config] pretrained-model: ""
[2023-06-20 19:02:44] [config] quantize-biases: false
[2023-06-20 19:02:44] [config] quantize-bits: 0
[2023-06-20 19:02:44] [config] quantize-log-based: false
[2023-06-20 19:02:44] [config] quantize-optimization-steps: 0
[2023-06-20 19:02:44] [config] quiet: false
[2023-06-20 19:02:44] [config] quiet-translation: true
[2023-06-20 19:02:44] [config] relative-paths: false
[2023-06-20 19:02:44] [config] right-left: false
[2023-06-20 19:02:44] [config] save-freq: 10000u
[2023-06-20 19:02:44] [config] seed: 1234
[2023-06-20 19:02:44] [config] sentencepiece-alphas:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:02:44] [config] sentencepiece-options: ""
[2023-06-20 19:02:44] [config] sharding: global
[2023-06-20 19:02:44] [config] shuffle: data
[2023-06-20 19:02:44] [config] shuffle-in-ram: false
[2023-06-20 19:02:44] [config] sigterm: save-and-exit
[2023-06-20 19:02:44] [config] skip: false
[2023-06-20 19:02:44] [config] sqlite: ""
[2023-06-20 19:02:44] [config] sqlite-drop: false
[2023-06-20 19:02:44] [config] sync-freq: 200u
[2023-06-20 19:02:44] [config] sync-sgd: false
[2023-06-20 19:02:44] [config] tempdir: /tmp
[2023-06-20 19:02:44] [config] tied-embeddings: false
[2023-06-20 19:02:44] [config] tied-embeddings-all: false
[2023-06-20 19:02:44] [config] tied-embeddings-src: false
[2023-06-20 19:02:44] [config] train-embedder-rank:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] train-sets:
[2023-06-20 19:02:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:02:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:02:44] [config] transformer-aan-activation: swish
[2023-06-20 19:02:44] [config] transformer-aan-depth: 2
[2023-06-20 19:02:44] [config] transformer-aan-nogate: false
[2023-06-20 19:02:44] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:02:44] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:02:44] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:02:44] [config] transformer-depth-scaling: false
[2023-06-20 19:02:44] [config] transformer-dim-aan: 2048
[2023-06-20 19:02:44] [config] transformer-dim-ffn: 2048
[2023-06-20 19:02:44] [config] transformer-dropout: 0
[2023-06-20 19:02:44] [config] transformer-dropout-attention: 0
[2023-06-20 19:02:44] [config] transformer-dropout-ffn: 0
[2023-06-20 19:02:44] [config] transformer-ffn-activation: swish
[2023-06-20 19:02:44] [config] transformer-ffn-depth: 2
[2023-06-20 19:02:44] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:02:44] [config] transformer-heads: 8
[2023-06-20 19:02:44] [config] transformer-no-projection: false
[2023-06-20 19:02:44] [config] transformer-pool: false
[2023-06-20 19:02:44] [config] transformer-postprocess: dan
[2023-06-20 19:02:44] [config] transformer-postprocess-emb: d
[2023-06-20 19:02:44] [config] transformer-postprocess-top: ""
[2023-06-20 19:02:44] [config] transformer-preprocess: ""
[2023-06-20 19:02:44] [config] transformer-tied-layers:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] transformer-train-position-embeddings: false
[2023-06-20 19:02:44] [config] tsv: false
[2023-06-20 19:02:44] [config] tsv-fields: 0
[2023-06-20 19:02:44] [config] type: amun
[2023-06-20 19:02:44] [config] ulr: false
[2023-06-20 19:02:44] [config] ulr-dim-emb: 0
[2023-06-20 19:02:44] [config] ulr-dropout: 0
[2023-06-20 19:02:44] [config] ulr-keys-vectors: ""
[2023-06-20 19:02:44] [config] ulr-query-vectors: ""
[2023-06-20 19:02:44] [config] ulr-softmax-temperature: 1
[2023-06-20 19:02:44] [config] ulr-trainable-transformation: false
[2023-06-20 19:02:44] [config] unlikelihood-loss: false
[2023-06-20 19:02:44] [config] valid-freq: 5000000
[2023-06-20 19:02:44] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:02:44] [config] valid-max-length: 1000
[2023-06-20 19:02:44] [config] valid-metrics:
[2023-06-20 19:02:44] [config]   - cross-entropy
[2023-06-20 19:02:44] [config] valid-mini-batch: 32
[2023-06-20 19:02:44] [config] valid-reset-stalled: false
[2023-06-20 19:02:44] [config] valid-script-args:
[2023-06-20 19:02:44] [config]   []
[2023-06-20 19:02:44] [config] valid-script-path: ""
[2023-06-20 19:02:44] [config] valid-sets:
[2023-06-20 19:02:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:02:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:02:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:02:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:02:44] [config] vocabs:
[2023-06-20 19:02:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:02:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:02:44] [config] word-penalty: 0
[2023-06-20 19:02:44] [config] word-scores: false
[2023-06-20 19:02:44] [config] workspace: 2048
[2023-06-20 19:02:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:02:44] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:02:44] [training] Using single-device training
[2023-06-20 19:02:44] Synced seed 1234
[2023-06-20 19:02:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:02:44] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:02:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:02:44] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:02:44] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:02:45] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:02:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:02:45] [comm] Using global sharding
[2023-06-20 19:02:45] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:02:45] [training] Using 1 GPUs
[2023-06-20 19:02:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:02:48] Loading Adam parameters
[2023-06-20 19:02:48] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:02:48] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:02:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:02:48] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:02:48] [data] Shuffling data
[2023-06-20 19:02:48] [data] Done reading 20,192 sentences
[2023-06-20 19:02:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:02:48] Training started
[2023-06-20 19:02:48] Training finished
[2023-06-20 19:07:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:07:30] [marian] Running on node21.datos.cluster.uy as process 319 with command line:
[2023-06-20 19:07:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 140 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:07:30] [config] after: 0e
[2023-06-20 19:07:30] [config] after-batches: 0
[2023-06-20 19:07:30] [config] after-epochs: 140
[2023-06-20 19:07:30] [config] all-caps-every: 0
[2023-06-20 19:07:30] [config] allow-unk: false
[2023-06-20 19:07:30] [config] authors: false
[2023-06-20 19:07:30] [config] beam-size: 12
[2023-06-20 19:07:30] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:07:30] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:07:30] [config] bert-masking-fraction: 0.15
[2023-06-20 19:07:30] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:07:30] [config] bert-train-type-embeddings: true
[2023-06-20 19:07:30] [config] bert-type-vocab-size: 2
[2023-06-20 19:07:30] [config] build-info: ""
[2023-06-20 19:07:30] [config] check-gradient-nan: false
[2023-06-20 19:07:30] [config] check-nan: false
[2023-06-20 19:07:30] [config] cite: false
[2023-06-20 19:07:30] [config] clip-norm: 1
[2023-06-20 19:07:30] [config] cost-scaling:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] cost-type: ce-sum
[2023-06-20 19:07:30] [config] cpu-threads: 0
[2023-06-20 19:07:30] [config] data-threads: 8
[2023-06-20 19:07:30] [config] data-weighting: ""
[2023-06-20 19:07:30] [config] data-weighting-type: sentence
[2023-06-20 19:07:30] [config] dec-cell: gru
[2023-06-20 19:07:30] [config] dec-cell-base-depth: 2
[2023-06-20 19:07:30] [config] dec-cell-high-depth: 1
[2023-06-20 19:07:30] [config] dec-depth: 1
[2023-06-20 19:07:30] [config] devices:
[2023-06-20 19:07:30] [config]   - 0
[2023-06-20 19:07:30] [config] dim-emb: 512
[2023-06-20 19:07:30] [config] dim-rnn: 1024
[2023-06-20 19:07:30] [config] dim-vocabs:
[2023-06-20 19:07:30] [config]   - 54042
[2023-06-20 19:07:30] [config]   - 36507
[2023-06-20 19:07:30] [config] disp-first: 0
[2023-06-20 19:07:30] [config] disp-freq: 1000u
[2023-06-20 19:07:30] [config] disp-label-counts: true
[2023-06-20 19:07:30] [config] dropout-rnn: 0
[2023-06-20 19:07:30] [config] dropout-src: 0
[2023-06-20 19:07:30] [config] dropout-trg: 0
[2023-06-20 19:07:30] [config] dump-config: ""
[2023-06-20 19:07:30] [config] dynamic-gradient-scaling:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] early-stopping: 10
[2023-06-20 19:07:30] [config] early-stopping-on: first
[2023-06-20 19:07:30] [config] embedding-fix-src: false
[2023-06-20 19:07:30] [config] embedding-fix-trg: false
[2023-06-20 19:07:30] [config] embedding-normalization: false
[2023-06-20 19:07:30] [config] embedding-vectors:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] enc-cell: gru
[2023-06-20 19:07:30] [config] enc-cell-depth: 1
[2023-06-20 19:07:30] [config] enc-depth: 1
[2023-06-20 19:07:30] [config] enc-type: bidirectional
[2023-06-20 19:07:30] [config] english-title-case-every: 0
[2023-06-20 19:07:30] [config] exponential-smoothing: 0
[2023-06-20 19:07:30] [config] factor-weight: 1
[2023-06-20 19:07:30] [config] factors-combine: sum
[2023-06-20 19:07:30] [config] factors-dim-emb: 0
[2023-06-20 19:07:30] [config] gradient-checkpointing: false
[2023-06-20 19:07:30] [config] gradient-norm-average-window: 100
[2023-06-20 19:07:30] [config] guided-alignment: none
[2023-06-20 19:07:30] [config] guided-alignment-cost: mse
[2023-06-20 19:07:30] [config] guided-alignment-weight: 0.1
[2023-06-20 19:07:30] [config] ignore-model-config: false
[2023-06-20 19:07:30] [config] input-types:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] interpolate-env-vars: false
[2023-06-20 19:07:30] [config] keep-best: false
[2023-06-20 19:07:30] [config] label-smoothing: 0
[2023-06-20 19:07:30] [config] layer-normalization: false
[2023-06-20 19:07:30] [config] learn-rate: 0.0001
[2023-06-20 19:07:30] [config] lemma-dependency: ""
[2023-06-20 19:07:30] [config] lemma-dim-emb: 0
[2023-06-20 19:07:30] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:07:30] [config] log-level: info
[2023-06-20 19:07:30] [config] log-time-zone: ""
[2023-06-20 19:07:30] [config] logical-epoch:
[2023-06-20 19:07:30] [config]   - 1e
[2023-06-20 19:07:30] [config]   - 0
[2023-06-20 19:07:30] [config] lr-decay: 0
[2023-06-20 19:07:30] [config] lr-decay-freq: 50000
[2023-06-20 19:07:30] [config] lr-decay-inv-sqrt:
[2023-06-20 19:07:30] [config]   - 0
[2023-06-20 19:07:30] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:07:30] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:07:30] [config] lr-decay-start:
[2023-06-20 19:07:30] [config]   - 10
[2023-06-20 19:07:30] [config]   - 1
[2023-06-20 19:07:30] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:07:30] [config] lr-report: false
[2023-06-20 19:07:30] [config] lr-warmup: 0
[2023-06-20 19:07:30] [config] lr-warmup-at-reload: false
[2023-06-20 19:07:30] [config] lr-warmup-cycle: false
[2023-06-20 19:07:30] [config] lr-warmup-start-rate: 0
[2023-06-20 19:07:30] [config] max-length: 50
[2023-06-20 19:07:30] [config] max-length-crop: false
[2023-06-20 19:07:30] [config] max-length-factor: 3
[2023-06-20 19:07:30] [config] maxi-batch: 100
[2023-06-20 19:07:30] [config] maxi-batch-sort: trg
[2023-06-20 19:07:30] [config] mini-batch: 64
[2023-06-20 19:07:30] [config] mini-batch-fit: false
[2023-06-20 19:07:30] [config] mini-batch-fit-step: 10
[2023-06-20 19:07:30] [config] mini-batch-round-up: true
[2023-06-20 19:07:30] [config] mini-batch-track-lr: false
[2023-06-20 19:07:30] [config] mini-batch-warmup: 0
[2023-06-20 19:07:30] [config] mini-batch-words: 0
[2023-06-20 19:07:30] [config] mini-batch-words-ref: 0
[2023-06-20 19:07:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:07:30] [config] multi-loss-type: sum
[2023-06-20 19:07:30] [config] n-best: false
[2023-06-20 19:07:30] [config] no-nccl: false
[2023-06-20 19:07:30] [config] no-reload: false
[2023-06-20 19:07:30] [config] no-restore-corpus: false
[2023-06-20 19:07:30] [config] normalize: 0
[2023-06-20 19:07:30] [config] normalize-gradient: false
[2023-06-20 19:07:30] [config] num-devices: 0
[2023-06-20 19:07:30] [config] optimizer: adam
[2023-06-20 19:07:30] [config] optimizer-delay: 1
[2023-06-20 19:07:30] [config] optimizer-params:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] output-omit-bias: false
[2023-06-20 19:07:30] [config] overwrite: false
[2023-06-20 19:07:30] [config] precision:
[2023-06-20 19:07:30] [config]   - float32
[2023-06-20 19:07:30] [config]   - float32
[2023-06-20 19:07:30] [config] pretrained-model: ""
[2023-06-20 19:07:30] [config] quantize-biases: false
[2023-06-20 19:07:30] [config] quantize-bits: 0
[2023-06-20 19:07:30] [config] quantize-log-based: false
[2023-06-20 19:07:30] [config] quantize-optimization-steps: 0
[2023-06-20 19:07:30] [config] quiet: false
[2023-06-20 19:07:30] [config] quiet-translation: true
[2023-06-20 19:07:30] [config] relative-paths: false
[2023-06-20 19:07:30] [config] right-left: false
[2023-06-20 19:07:30] [config] save-freq: 10000u
[2023-06-20 19:07:30] [config] seed: 1234
[2023-06-20 19:07:30] [config] sentencepiece-alphas:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:07:30] [config] sentencepiece-options: ""
[2023-06-20 19:07:30] [config] sharding: global
[2023-06-20 19:07:30] [config] shuffle: data
[2023-06-20 19:07:30] [config] shuffle-in-ram: false
[2023-06-20 19:07:30] [config] sigterm: save-and-exit
[2023-06-20 19:07:30] [config] skip: false
[2023-06-20 19:07:30] [config] sqlite: ""
[2023-06-20 19:07:30] [config] sqlite-drop: false
[2023-06-20 19:07:30] [config] sync-freq: 200u
[2023-06-20 19:07:30] [config] sync-sgd: false
[2023-06-20 19:07:30] [config] tempdir: /tmp
[2023-06-20 19:07:30] [config] tied-embeddings: false
[2023-06-20 19:07:30] [config] tied-embeddings-all: false
[2023-06-20 19:07:30] [config] tied-embeddings-src: false
[2023-06-20 19:07:30] [config] train-embedder-rank:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] train-sets:
[2023-06-20 19:07:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:07:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:07:30] [config] transformer-aan-activation: swish
[2023-06-20 19:07:30] [config] transformer-aan-depth: 2
[2023-06-20 19:07:30] [config] transformer-aan-nogate: false
[2023-06-20 19:07:30] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:07:30] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:07:30] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:07:30] [config] transformer-depth-scaling: false
[2023-06-20 19:07:30] [config] transformer-dim-aan: 2048
[2023-06-20 19:07:30] [config] transformer-dim-ffn: 2048
[2023-06-20 19:07:30] [config] transformer-dropout: 0
[2023-06-20 19:07:30] [config] transformer-dropout-attention: 0
[2023-06-20 19:07:30] [config] transformer-dropout-ffn: 0
[2023-06-20 19:07:30] [config] transformer-ffn-activation: swish
[2023-06-20 19:07:30] [config] transformer-ffn-depth: 2
[2023-06-20 19:07:30] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:07:30] [config] transformer-heads: 8
[2023-06-20 19:07:30] [config] transformer-no-projection: false
[2023-06-20 19:07:30] [config] transformer-pool: false
[2023-06-20 19:07:30] [config] transformer-postprocess: dan
[2023-06-20 19:07:30] [config] transformer-postprocess-emb: d
[2023-06-20 19:07:30] [config] transformer-postprocess-top: ""
[2023-06-20 19:07:30] [config] transformer-preprocess: ""
[2023-06-20 19:07:30] [config] transformer-tied-layers:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] transformer-train-position-embeddings: false
[2023-06-20 19:07:30] [config] tsv: false
[2023-06-20 19:07:30] [config] tsv-fields: 0
[2023-06-20 19:07:30] [config] type: amun
[2023-06-20 19:07:30] [config] ulr: false
[2023-06-20 19:07:30] [config] ulr-dim-emb: 0
[2023-06-20 19:07:30] [config] ulr-dropout: 0
[2023-06-20 19:07:30] [config] ulr-keys-vectors: ""
[2023-06-20 19:07:30] [config] ulr-query-vectors: ""
[2023-06-20 19:07:30] [config] ulr-softmax-temperature: 1
[2023-06-20 19:07:30] [config] ulr-trainable-transformation: false
[2023-06-20 19:07:30] [config] unlikelihood-loss: false
[2023-06-20 19:07:30] [config] valid-freq: 5000000
[2023-06-20 19:07:30] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:07:30] [config] valid-max-length: 1000
[2023-06-20 19:07:30] [config] valid-metrics:
[2023-06-20 19:07:30] [config]   - cross-entropy
[2023-06-20 19:07:30] [config] valid-mini-batch: 32
[2023-06-20 19:07:30] [config] valid-reset-stalled: false
[2023-06-20 19:07:30] [config] valid-script-args:
[2023-06-20 19:07:30] [config]   []
[2023-06-20 19:07:30] [config] valid-script-path: ""
[2023-06-20 19:07:30] [config] valid-sets:
[2023-06-20 19:07:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:07:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:07:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:07:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:07:30] [config] vocabs:
[2023-06-20 19:07:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:07:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:07:30] [config] word-penalty: 0
[2023-06-20 19:07:30] [config] word-scores: false
[2023-06-20 19:07:30] [config] workspace: 2048
[2023-06-20 19:07:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:07:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:07:30] [training] Using single-device training
[2023-06-20 19:07:31] Synced seed 1234
[2023-06-20 19:07:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:07:31] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:07:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:07:31] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:07:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:07:31] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:07:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:07:32] [comm] Using global sharding
[2023-06-20 19:07:32] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:07:32] [training] Using 1 GPUs
[2023-06-20 19:07:32] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:07:33] Loading Adam parameters
[2023-06-20 19:07:33] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:07:34] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:07:34] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:07:34] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:07:34] [data] Shuffling data
[2023-06-20 19:07:34] [data] Done reading 20,192 sentences
[2023-06-20 19:07:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:07:34] Training started
[2023-06-20 19:07:34] Training finished
[2023-06-20 19:12:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:12:20] [marian] Running on node21.datos.cluster.uy as process 740 with command line:
[2023-06-20 19:12:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 150 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:12:20] [config] after: 0e
[2023-06-20 19:12:20] [config] after-batches: 0
[2023-06-20 19:12:20] [config] after-epochs: 150
[2023-06-20 19:12:20] [config] all-caps-every: 0
[2023-06-20 19:12:20] [config] allow-unk: false
[2023-06-20 19:12:20] [config] authors: false
[2023-06-20 19:12:20] [config] beam-size: 12
[2023-06-20 19:12:20] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:12:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:12:20] [config] bert-masking-fraction: 0.15
[2023-06-20 19:12:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:12:20] [config] bert-train-type-embeddings: true
[2023-06-20 19:12:20] [config] bert-type-vocab-size: 2
[2023-06-20 19:12:20] [config] build-info: ""
[2023-06-20 19:12:20] [config] check-gradient-nan: false
[2023-06-20 19:12:20] [config] check-nan: false
[2023-06-20 19:12:20] [config] cite: false
[2023-06-20 19:12:20] [config] clip-norm: 1
[2023-06-20 19:12:20] [config] cost-scaling:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] cost-type: ce-sum
[2023-06-20 19:12:20] [config] cpu-threads: 0
[2023-06-20 19:12:20] [config] data-threads: 8
[2023-06-20 19:12:20] [config] data-weighting: ""
[2023-06-20 19:12:20] [config] data-weighting-type: sentence
[2023-06-20 19:12:20] [config] dec-cell: gru
[2023-06-20 19:12:20] [config] dec-cell-base-depth: 2
[2023-06-20 19:12:20] [config] dec-cell-high-depth: 1
[2023-06-20 19:12:20] [config] dec-depth: 1
[2023-06-20 19:12:20] [config] devices:
[2023-06-20 19:12:20] [config]   - 0
[2023-06-20 19:12:20] [config] dim-emb: 512
[2023-06-20 19:12:20] [config] dim-rnn: 1024
[2023-06-20 19:12:20] [config] dim-vocabs:
[2023-06-20 19:12:20] [config]   - 54042
[2023-06-20 19:12:20] [config]   - 36507
[2023-06-20 19:12:20] [config] disp-first: 0
[2023-06-20 19:12:20] [config] disp-freq: 1000u
[2023-06-20 19:12:20] [config] disp-label-counts: true
[2023-06-20 19:12:20] [config] dropout-rnn: 0
[2023-06-20 19:12:20] [config] dropout-src: 0
[2023-06-20 19:12:20] [config] dropout-trg: 0
[2023-06-20 19:12:20] [config] dump-config: ""
[2023-06-20 19:12:20] [config] dynamic-gradient-scaling:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] early-stopping: 10
[2023-06-20 19:12:20] [config] early-stopping-on: first
[2023-06-20 19:12:20] [config] embedding-fix-src: false
[2023-06-20 19:12:20] [config] embedding-fix-trg: false
[2023-06-20 19:12:20] [config] embedding-normalization: false
[2023-06-20 19:12:20] [config] embedding-vectors:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] enc-cell: gru
[2023-06-20 19:12:20] [config] enc-cell-depth: 1
[2023-06-20 19:12:20] [config] enc-depth: 1
[2023-06-20 19:12:20] [config] enc-type: bidirectional
[2023-06-20 19:12:20] [config] english-title-case-every: 0
[2023-06-20 19:12:20] [config] exponential-smoothing: 0
[2023-06-20 19:12:20] [config] factor-weight: 1
[2023-06-20 19:12:20] [config] factors-combine: sum
[2023-06-20 19:12:20] [config] factors-dim-emb: 0
[2023-06-20 19:12:20] [config] gradient-checkpointing: false
[2023-06-20 19:12:20] [config] gradient-norm-average-window: 100
[2023-06-20 19:12:20] [config] guided-alignment: none
[2023-06-20 19:12:20] [config] guided-alignment-cost: mse
[2023-06-20 19:12:20] [config] guided-alignment-weight: 0.1
[2023-06-20 19:12:20] [config] ignore-model-config: false
[2023-06-20 19:12:20] [config] input-types:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] interpolate-env-vars: false
[2023-06-20 19:12:20] [config] keep-best: false
[2023-06-20 19:12:20] [config] label-smoothing: 0
[2023-06-20 19:12:20] [config] layer-normalization: false
[2023-06-20 19:12:20] [config] learn-rate: 0.0001
[2023-06-20 19:12:20] [config] lemma-dependency: ""
[2023-06-20 19:12:20] [config] lemma-dim-emb: 0
[2023-06-20 19:12:20] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:12:20] [config] log-level: info
[2023-06-20 19:12:20] [config] log-time-zone: ""
[2023-06-20 19:12:20] [config] logical-epoch:
[2023-06-20 19:12:20] [config]   - 1e
[2023-06-20 19:12:20] [config]   - 0
[2023-06-20 19:12:20] [config] lr-decay: 0
[2023-06-20 19:12:20] [config] lr-decay-freq: 50000
[2023-06-20 19:12:20] [config] lr-decay-inv-sqrt:
[2023-06-20 19:12:20] [config]   - 0
[2023-06-20 19:12:20] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:12:20] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:12:20] [config] lr-decay-start:
[2023-06-20 19:12:20] [config]   - 10
[2023-06-20 19:12:20] [config]   - 1
[2023-06-20 19:12:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:12:20] [config] lr-report: false
[2023-06-20 19:12:20] [config] lr-warmup: 0
[2023-06-20 19:12:20] [config] lr-warmup-at-reload: false
[2023-06-20 19:12:20] [config] lr-warmup-cycle: false
[2023-06-20 19:12:20] [config] lr-warmup-start-rate: 0
[2023-06-20 19:12:20] [config] max-length: 50
[2023-06-20 19:12:20] [config] max-length-crop: false
[2023-06-20 19:12:20] [config] max-length-factor: 3
[2023-06-20 19:12:20] [config] maxi-batch: 100
[2023-06-20 19:12:20] [config] maxi-batch-sort: trg
[2023-06-20 19:12:20] [config] mini-batch: 64
[2023-06-20 19:12:20] [config] mini-batch-fit: false
[2023-06-20 19:12:20] [config] mini-batch-fit-step: 10
[2023-06-20 19:12:20] [config] mini-batch-round-up: true
[2023-06-20 19:12:20] [config] mini-batch-track-lr: false
[2023-06-20 19:12:20] [config] mini-batch-warmup: 0
[2023-06-20 19:12:20] [config] mini-batch-words: 0
[2023-06-20 19:12:20] [config] mini-batch-words-ref: 0
[2023-06-20 19:12:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:12:20] [config] multi-loss-type: sum
[2023-06-20 19:12:20] [config] n-best: false
[2023-06-20 19:12:20] [config] no-nccl: false
[2023-06-20 19:12:20] [config] no-reload: false
[2023-06-20 19:12:20] [config] no-restore-corpus: false
[2023-06-20 19:12:20] [config] normalize: 0
[2023-06-20 19:12:20] [config] normalize-gradient: false
[2023-06-20 19:12:20] [config] num-devices: 0
[2023-06-20 19:12:20] [config] optimizer: adam
[2023-06-20 19:12:20] [config] optimizer-delay: 1
[2023-06-20 19:12:20] [config] optimizer-params:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] output-omit-bias: false
[2023-06-20 19:12:20] [config] overwrite: false
[2023-06-20 19:12:20] [config] precision:
[2023-06-20 19:12:20] [config]   - float32
[2023-06-20 19:12:20] [config]   - float32
[2023-06-20 19:12:20] [config] pretrained-model: ""
[2023-06-20 19:12:20] [config] quantize-biases: false
[2023-06-20 19:12:20] [config] quantize-bits: 0
[2023-06-20 19:12:20] [config] quantize-log-based: false
[2023-06-20 19:12:20] [config] quantize-optimization-steps: 0
[2023-06-20 19:12:20] [config] quiet: false
[2023-06-20 19:12:20] [config] quiet-translation: true
[2023-06-20 19:12:20] [config] relative-paths: false
[2023-06-20 19:12:20] [config] right-left: false
[2023-06-20 19:12:20] [config] save-freq: 10000u
[2023-06-20 19:12:20] [config] seed: 1234
[2023-06-20 19:12:20] [config] sentencepiece-alphas:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:12:20] [config] sentencepiece-options: ""
[2023-06-20 19:12:20] [config] sharding: global
[2023-06-20 19:12:20] [config] shuffle: data
[2023-06-20 19:12:20] [config] shuffle-in-ram: false
[2023-06-20 19:12:20] [config] sigterm: save-and-exit
[2023-06-20 19:12:20] [config] skip: false
[2023-06-20 19:12:20] [config] sqlite: ""
[2023-06-20 19:12:20] [config] sqlite-drop: false
[2023-06-20 19:12:20] [config] sync-freq: 200u
[2023-06-20 19:12:20] [config] sync-sgd: false
[2023-06-20 19:12:20] [config] tempdir: /tmp
[2023-06-20 19:12:20] [config] tied-embeddings: false
[2023-06-20 19:12:20] [config] tied-embeddings-all: false
[2023-06-20 19:12:20] [config] tied-embeddings-src: false
[2023-06-20 19:12:20] [config] train-embedder-rank:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] train-sets:
[2023-06-20 19:12:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:12:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:12:20] [config] transformer-aan-activation: swish
[2023-06-20 19:12:20] [config] transformer-aan-depth: 2
[2023-06-20 19:12:20] [config] transformer-aan-nogate: false
[2023-06-20 19:12:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:12:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:12:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:12:20] [config] transformer-depth-scaling: false
[2023-06-20 19:12:20] [config] transformer-dim-aan: 2048
[2023-06-20 19:12:20] [config] transformer-dim-ffn: 2048
[2023-06-20 19:12:20] [config] transformer-dropout: 0
[2023-06-20 19:12:20] [config] transformer-dropout-attention: 0
[2023-06-20 19:12:20] [config] transformer-dropout-ffn: 0
[2023-06-20 19:12:20] [config] transformer-ffn-activation: swish
[2023-06-20 19:12:20] [config] transformer-ffn-depth: 2
[2023-06-20 19:12:20] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:12:20] [config] transformer-heads: 8
[2023-06-20 19:12:20] [config] transformer-no-projection: false
[2023-06-20 19:12:20] [config] transformer-pool: false
[2023-06-20 19:12:20] [config] transformer-postprocess: dan
[2023-06-20 19:12:20] [config] transformer-postprocess-emb: d
[2023-06-20 19:12:20] [config] transformer-postprocess-top: ""
[2023-06-20 19:12:20] [config] transformer-preprocess: ""
[2023-06-20 19:12:20] [config] transformer-tied-layers:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] transformer-train-position-embeddings: false
[2023-06-20 19:12:20] [config] tsv: false
[2023-06-20 19:12:20] [config] tsv-fields: 0
[2023-06-20 19:12:20] [config] type: amun
[2023-06-20 19:12:20] [config] ulr: false
[2023-06-20 19:12:20] [config] ulr-dim-emb: 0
[2023-06-20 19:12:20] [config] ulr-dropout: 0
[2023-06-20 19:12:20] [config] ulr-keys-vectors: ""
[2023-06-20 19:12:20] [config] ulr-query-vectors: ""
[2023-06-20 19:12:20] [config] ulr-softmax-temperature: 1
[2023-06-20 19:12:20] [config] ulr-trainable-transformation: false
[2023-06-20 19:12:20] [config] unlikelihood-loss: false
[2023-06-20 19:12:20] [config] valid-freq: 5000000
[2023-06-20 19:12:20] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:12:20] [config] valid-max-length: 1000
[2023-06-20 19:12:20] [config] valid-metrics:
[2023-06-20 19:12:20] [config]   - cross-entropy
[2023-06-20 19:12:20] [config] valid-mini-batch: 32
[2023-06-20 19:12:20] [config] valid-reset-stalled: false
[2023-06-20 19:12:20] [config] valid-script-args:
[2023-06-20 19:12:20] [config]   []
[2023-06-20 19:12:20] [config] valid-script-path: ""
[2023-06-20 19:12:20] [config] valid-sets:
[2023-06-20 19:12:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:12:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:12:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:12:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:12:20] [config] vocabs:
[2023-06-20 19:12:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:12:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:12:20] [config] word-penalty: 0
[2023-06-20 19:12:20] [config] word-scores: false
[2023-06-20 19:12:20] [config] workspace: 2048
[2023-06-20 19:12:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:12:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:12:20] [training] Using single-device training
[2023-06-20 19:12:21] Synced seed 1234
[2023-06-20 19:12:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:12:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:12:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:12:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:12:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:12:22] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:12:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:12:22] [comm] Using global sharding
[2023-06-20 19:12:22] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:12:22] [training] Using 1 GPUs
[2023-06-20 19:12:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:12:25] Loading Adam parameters
[2023-06-20 19:12:25] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:12:25] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:12:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:12:25] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:12:25] [data] Shuffling data
[2023-06-20 19:12:25] [data] Done reading 20,192 sentences
[2023-06-20 19:12:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:12:25] Training started
[2023-06-20 19:12:25] Training finished
[2023-06-20 19:17:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:17:10] [marian] Running on node21.datos.cluster.uy as process 1069 with command line:
[2023-06-20 19:17:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 160 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:17:10] [config] after: 0e
[2023-06-20 19:17:10] [config] after-batches: 0
[2023-06-20 19:17:10] [config] after-epochs: 160
[2023-06-20 19:17:10] [config] all-caps-every: 0
[2023-06-20 19:17:10] [config] allow-unk: false
[2023-06-20 19:17:10] [config] authors: false
[2023-06-20 19:17:10] [config] beam-size: 12
[2023-06-20 19:17:10] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:17:10] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:17:10] [config] bert-masking-fraction: 0.15
[2023-06-20 19:17:10] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:17:10] [config] bert-train-type-embeddings: true
[2023-06-20 19:17:10] [config] bert-type-vocab-size: 2
[2023-06-20 19:17:10] [config] build-info: ""
[2023-06-20 19:17:10] [config] check-gradient-nan: false
[2023-06-20 19:17:10] [config] check-nan: false
[2023-06-20 19:17:10] [config] cite: false
[2023-06-20 19:17:10] [config] clip-norm: 1
[2023-06-20 19:17:10] [config] cost-scaling:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] cost-type: ce-sum
[2023-06-20 19:17:10] [config] cpu-threads: 0
[2023-06-20 19:17:10] [config] data-threads: 8
[2023-06-20 19:17:10] [config] data-weighting: ""
[2023-06-20 19:17:10] [config] data-weighting-type: sentence
[2023-06-20 19:17:10] [config] dec-cell: gru
[2023-06-20 19:17:10] [config] dec-cell-base-depth: 2
[2023-06-20 19:17:10] [config] dec-cell-high-depth: 1
[2023-06-20 19:17:10] [config] dec-depth: 1
[2023-06-20 19:17:10] [config] devices:
[2023-06-20 19:17:10] [config]   - 0
[2023-06-20 19:17:10] [config] dim-emb: 512
[2023-06-20 19:17:10] [config] dim-rnn: 1024
[2023-06-20 19:17:10] [config] dim-vocabs:
[2023-06-20 19:17:10] [config]   - 54042
[2023-06-20 19:17:10] [config]   - 36507
[2023-06-20 19:17:10] [config] disp-first: 0
[2023-06-20 19:17:10] [config] disp-freq: 1000u
[2023-06-20 19:17:10] [config] disp-label-counts: true
[2023-06-20 19:17:10] [config] dropout-rnn: 0
[2023-06-20 19:17:10] [config] dropout-src: 0
[2023-06-20 19:17:10] [config] dropout-trg: 0
[2023-06-20 19:17:10] [config] dump-config: ""
[2023-06-20 19:17:10] [config] dynamic-gradient-scaling:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] early-stopping: 10
[2023-06-20 19:17:10] [config] early-stopping-on: first
[2023-06-20 19:17:10] [config] embedding-fix-src: false
[2023-06-20 19:17:10] [config] embedding-fix-trg: false
[2023-06-20 19:17:10] [config] embedding-normalization: false
[2023-06-20 19:17:10] [config] embedding-vectors:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] enc-cell: gru
[2023-06-20 19:17:10] [config] enc-cell-depth: 1
[2023-06-20 19:17:10] [config] enc-depth: 1
[2023-06-20 19:17:10] [config] enc-type: bidirectional
[2023-06-20 19:17:10] [config] english-title-case-every: 0
[2023-06-20 19:17:10] [config] exponential-smoothing: 0
[2023-06-20 19:17:10] [config] factor-weight: 1
[2023-06-20 19:17:10] [config] factors-combine: sum
[2023-06-20 19:17:10] [config] factors-dim-emb: 0
[2023-06-20 19:17:10] [config] gradient-checkpointing: false
[2023-06-20 19:17:10] [config] gradient-norm-average-window: 100
[2023-06-20 19:17:10] [config] guided-alignment: none
[2023-06-20 19:17:10] [config] guided-alignment-cost: mse
[2023-06-20 19:17:10] [config] guided-alignment-weight: 0.1
[2023-06-20 19:17:10] [config] ignore-model-config: false
[2023-06-20 19:17:10] [config] input-types:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] interpolate-env-vars: false
[2023-06-20 19:17:10] [config] keep-best: false
[2023-06-20 19:17:10] [config] label-smoothing: 0
[2023-06-20 19:17:10] [config] layer-normalization: false
[2023-06-20 19:17:10] [config] learn-rate: 0.0001
[2023-06-20 19:17:10] [config] lemma-dependency: ""
[2023-06-20 19:17:10] [config] lemma-dim-emb: 0
[2023-06-20 19:17:10] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:17:10] [config] log-level: info
[2023-06-20 19:17:10] [config] log-time-zone: ""
[2023-06-20 19:17:10] [config] logical-epoch:
[2023-06-20 19:17:10] [config]   - 1e
[2023-06-20 19:17:10] [config]   - 0
[2023-06-20 19:17:10] [config] lr-decay: 0
[2023-06-20 19:17:10] [config] lr-decay-freq: 50000
[2023-06-20 19:17:10] [config] lr-decay-inv-sqrt:
[2023-06-20 19:17:10] [config]   - 0
[2023-06-20 19:17:10] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:17:10] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:17:10] [config] lr-decay-start:
[2023-06-20 19:17:10] [config]   - 10
[2023-06-20 19:17:10] [config]   - 1
[2023-06-20 19:17:10] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:17:10] [config] lr-report: false
[2023-06-20 19:17:10] [config] lr-warmup: 0
[2023-06-20 19:17:10] [config] lr-warmup-at-reload: false
[2023-06-20 19:17:10] [config] lr-warmup-cycle: false
[2023-06-20 19:17:10] [config] lr-warmup-start-rate: 0
[2023-06-20 19:17:10] [config] max-length: 50
[2023-06-20 19:17:10] [config] max-length-crop: false
[2023-06-20 19:17:10] [config] max-length-factor: 3
[2023-06-20 19:17:10] [config] maxi-batch: 100
[2023-06-20 19:17:10] [config] maxi-batch-sort: trg
[2023-06-20 19:17:10] [config] mini-batch: 64
[2023-06-20 19:17:10] [config] mini-batch-fit: false
[2023-06-20 19:17:10] [config] mini-batch-fit-step: 10
[2023-06-20 19:17:10] [config] mini-batch-round-up: true
[2023-06-20 19:17:10] [config] mini-batch-track-lr: false
[2023-06-20 19:17:10] [config] mini-batch-warmup: 0
[2023-06-20 19:17:10] [config] mini-batch-words: 0
[2023-06-20 19:17:10] [config] mini-batch-words-ref: 0
[2023-06-20 19:17:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:17:10] [config] multi-loss-type: sum
[2023-06-20 19:17:10] [config] n-best: false
[2023-06-20 19:17:10] [config] no-nccl: false
[2023-06-20 19:17:10] [config] no-reload: false
[2023-06-20 19:17:10] [config] no-restore-corpus: false
[2023-06-20 19:17:10] [config] normalize: 0
[2023-06-20 19:17:10] [config] normalize-gradient: false
[2023-06-20 19:17:10] [config] num-devices: 0
[2023-06-20 19:17:10] [config] optimizer: adam
[2023-06-20 19:17:10] [config] optimizer-delay: 1
[2023-06-20 19:17:10] [config] optimizer-params:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] output-omit-bias: false
[2023-06-20 19:17:10] [config] overwrite: false
[2023-06-20 19:17:10] [config] precision:
[2023-06-20 19:17:10] [config]   - float32
[2023-06-20 19:17:10] [config]   - float32
[2023-06-20 19:17:10] [config] pretrained-model: ""
[2023-06-20 19:17:10] [config] quantize-biases: false
[2023-06-20 19:17:10] [config] quantize-bits: 0
[2023-06-20 19:17:10] [config] quantize-log-based: false
[2023-06-20 19:17:10] [config] quantize-optimization-steps: 0
[2023-06-20 19:17:10] [config] quiet: false
[2023-06-20 19:17:10] [config] quiet-translation: true
[2023-06-20 19:17:10] [config] relative-paths: false
[2023-06-20 19:17:10] [config] right-left: false
[2023-06-20 19:17:10] [config] save-freq: 10000u
[2023-06-20 19:17:10] [config] seed: 1234
[2023-06-20 19:17:10] [config] sentencepiece-alphas:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:17:10] [config] sentencepiece-options: ""
[2023-06-20 19:17:10] [config] sharding: global
[2023-06-20 19:17:10] [config] shuffle: data
[2023-06-20 19:17:10] [config] shuffle-in-ram: false
[2023-06-20 19:17:10] [config] sigterm: save-and-exit
[2023-06-20 19:17:10] [config] skip: false
[2023-06-20 19:17:10] [config] sqlite: ""
[2023-06-20 19:17:10] [config] sqlite-drop: false
[2023-06-20 19:17:10] [config] sync-freq: 200u
[2023-06-20 19:17:10] [config] sync-sgd: false
[2023-06-20 19:17:10] [config] tempdir: /tmp
[2023-06-20 19:17:10] [config] tied-embeddings: false
[2023-06-20 19:17:10] [config] tied-embeddings-all: false
[2023-06-20 19:17:10] [config] tied-embeddings-src: false
[2023-06-20 19:17:10] [config] train-embedder-rank:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] train-sets:
[2023-06-20 19:17:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:17:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:17:10] [config] transformer-aan-activation: swish
[2023-06-20 19:17:10] [config] transformer-aan-depth: 2
[2023-06-20 19:17:10] [config] transformer-aan-nogate: false
[2023-06-20 19:17:10] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:17:10] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:17:10] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:17:10] [config] transformer-depth-scaling: false
[2023-06-20 19:17:10] [config] transformer-dim-aan: 2048
[2023-06-20 19:17:10] [config] transformer-dim-ffn: 2048
[2023-06-20 19:17:10] [config] transformer-dropout: 0
[2023-06-20 19:17:10] [config] transformer-dropout-attention: 0
[2023-06-20 19:17:10] [config] transformer-dropout-ffn: 0
[2023-06-20 19:17:10] [config] transformer-ffn-activation: swish
[2023-06-20 19:17:10] [config] transformer-ffn-depth: 2
[2023-06-20 19:17:10] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:17:10] [config] transformer-heads: 8
[2023-06-20 19:17:10] [config] transformer-no-projection: false
[2023-06-20 19:17:10] [config] transformer-pool: false
[2023-06-20 19:17:10] [config] transformer-postprocess: dan
[2023-06-20 19:17:10] [config] transformer-postprocess-emb: d
[2023-06-20 19:17:10] [config] transformer-postprocess-top: ""
[2023-06-20 19:17:10] [config] transformer-preprocess: ""
[2023-06-20 19:17:10] [config] transformer-tied-layers:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] transformer-train-position-embeddings: false
[2023-06-20 19:17:10] [config] tsv: false
[2023-06-20 19:17:10] [config] tsv-fields: 0
[2023-06-20 19:17:10] [config] type: amun
[2023-06-20 19:17:10] [config] ulr: false
[2023-06-20 19:17:10] [config] ulr-dim-emb: 0
[2023-06-20 19:17:10] [config] ulr-dropout: 0
[2023-06-20 19:17:10] [config] ulr-keys-vectors: ""
[2023-06-20 19:17:10] [config] ulr-query-vectors: ""
[2023-06-20 19:17:10] [config] ulr-softmax-temperature: 1
[2023-06-20 19:17:10] [config] ulr-trainable-transformation: false
[2023-06-20 19:17:10] [config] unlikelihood-loss: false
[2023-06-20 19:17:10] [config] valid-freq: 5000000
[2023-06-20 19:17:10] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:17:10] [config] valid-max-length: 1000
[2023-06-20 19:17:10] [config] valid-metrics:
[2023-06-20 19:17:10] [config]   - cross-entropy
[2023-06-20 19:17:10] [config] valid-mini-batch: 32
[2023-06-20 19:17:10] [config] valid-reset-stalled: false
[2023-06-20 19:17:10] [config] valid-script-args:
[2023-06-20 19:17:10] [config]   []
[2023-06-20 19:17:10] [config] valid-script-path: ""
[2023-06-20 19:17:10] [config] valid-sets:
[2023-06-20 19:17:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:17:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:17:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:17:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:17:10] [config] vocabs:
[2023-06-20 19:17:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:17:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:17:10] [config] word-penalty: 0
[2023-06-20 19:17:10] [config] word-scores: false
[2023-06-20 19:17:10] [config] workspace: 2048
[2023-06-20 19:17:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:17:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:17:10] [training] Using single-device training
[2023-06-20 19:17:10] Synced seed 1234
[2023-06-20 19:17:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:17:10] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:17:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:17:10] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:17:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:17:11] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:17:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:17:11] [comm] Using global sharding
[2023-06-20 19:17:11] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:17:11] [training] Using 1 GPUs
[2023-06-20 19:17:11] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:17:13] Loading Adam parameters
[2023-06-20 19:17:13] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:17:13] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:17:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:17:13] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:17:13] [data] Shuffling data
[2023-06-20 19:17:14] [data] Done reading 20,192 sentences
[2023-06-20 19:17:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:17:14] Training started
[2023-06-20 19:17:14] Training finished
[2023-06-20 19:21:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:21:59] [marian] Running on node21.datos.cluster.uy as process 1438 with command line:
[2023-06-20 19:21:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 170 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:22:00] [config] after: 0e
[2023-06-20 19:22:00] [config] after-batches: 0
[2023-06-20 19:22:00] [config] after-epochs: 170
[2023-06-20 19:22:00] [config] all-caps-every: 0
[2023-06-20 19:22:00] [config] allow-unk: false
[2023-06-20 19:22:00] [config] authors: false
[2023-06-20 19:22:00] [config] beam-size: 12
[2023-06-20 19:22:00] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:22:00] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:22:00] [config] bert-masking-fraction: 0.15
[2023-06-20 19:22:00] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:22:00] [config] bert-train-type-embeddings: true
[2023-06-20 19:22:00] [config] bert-type-vocab-size: 2
[2023-06-20 19:22:00] [config] build-info: ""
[2023-06-20 19:22:00] [config] check-gradient-nan: false
[2023-06-20 19:22:00] [config] check-nan: false
[2023-06-20 19:22:00] [config] cite: false
[2023-06-20 19:22:00] [config] clip-norm: 1
[2023-06-20 19:22:00] [config] cost-scaling:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] cost-type: ce-sum
[2023-06-20 19:22:00] [config] cpu-threads: 0
[2023-06-20 19:22:00] [config] data-threads: 8
[2023-06-20 19:22:00] [config] data-weighting: ""
[2023-06-20 19:22:00] [config] data-weighting-type: sentence
[2023-06-20 19:22:00] [config] dec-cell: gru
[2023-06-20 19:22:00] [config] dec-cell-base-depth: 2
[2023-06-20 19:22:00] [config] dec-cell-high-depth: 1
[2023-06-20 19:22:00] [config] dec-depth: 1
[2023-06-20 19:22:00] [config] devices:
[2023-06-20 19:22:00] [config]   - 0
[2023-06-20 19:22:00] [config] dim-emb: 512
[2023-06-20 19:22:00] [config] dim-rnn: 1024
[2023-06-20 19:22:00] [config] dim-vocabs:
[2023-06-20 19:22:00] [config]   - 54042
[2023-06-20 19:22:00] [config]   - 36507
[2023-06-20 19:22:00] [config] disp-first: 0
[2023-06-20 19:22:00] [config] disp-freq: 1000u
[2023-06-20 19:22:00] [config] disp-label-counts: true
[2023-06-20 19:22:00] [config] dropout-rnn: 0
[2023-06-20 19:22:00] [config] dropout-src: 0
[2023-06-20 19:22:00] [config] dropout-trg: 0
[2023-06-20 19:22:00] [config] dump-config: ""
[2023-06-20 19:22:00] [config] dynamic-gradient-scaling:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] early-stopping: 10
[2023-06-20 19:22:00] [config] early-stopping-on: first
[2023-06-20 19:22:00] [config] embedding-fix-src: false
[2023-06-20 19:22:00] [config] embedding-fix-trg: false
[2023-06-20 19:22:00] [config] embedding-normalization: false
[2023-06-20 19:22:00] [config] embedding-vectors:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] enc-cell: gru
[2023-06-20 19:22:00] [config] enc-cell-depth: 1
[2023-06-20 19:22:00] [config] enc-depth: 1
[2023-06-20 19:22:00] [config] enc-type: bidirectional
[2023-06-20 19:22:00] [config] english-title-case-every: 0
[2023-06-20 19:22:00] [config] exponential-smoothing: 0
[2023-06-20 19:22:00] [config] factor-weight: 1
[2023-06-20 19:22:00] [config] factors-combine: sum
[2023-06-20 19:22:00] [config] factors-dim-emb: 0
[2023-06-20 19:22:00] [config] gradient-checkpointing: false
[2023-06-20 19:22:00] [config] gradient-norm-average-window: 100
[2023-06-20 19:22:00] [config] guided-alignment: none
[2023-06-20 19:22:00] [config] guided-alignment-cost: mse
[2023-06-20 19:22:00] [config] guided-alignment-weight: 0.1
[2023-06-20 19:22:00] [config] ignore-model-config: false
[2023-06-20 19:22:00] [config] input-types:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] interpolate-env-vars: false
[2023-06-20 19:22:00] [config] keep-best: false
[2023-06-20 19:22:00] [config] label-smoothing: 0
[2023-06-20 19:22:00] [config] layer-normalization: false
[2023-06-20 19:22:00] [config] learn-rate: 0.0001
[2023-06-20 19:22:00] [config] lemma-dependency: ""
[2023-06-20 19:22:00] [config] lemma-dim-emb: 0
[2023-06-20 19:22:00] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:22:00] [config] log-level: info
[2023-06-20 19:22:00] [config] log-time-zone: ""
[2023-06-20 19:22:00] [config] logical-epoch:
[2023-06-20 19:22:00] [config]   - 1e
[2023-06-20 19:22:00] [config]   - 0
[2023-06-20 19:22:00] [config] lr-decay: 0
[2023-06-20 19:22:00] [config] lr-decay-freq: 50000
[2023-06-20 19:22:00] [config] lr-decay-inv-sqrt:
[2023-06-20 19:22:00] [config]   - 0
[2023-06-20 19:22:00] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:22:00] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:22:00] [config] lr-decay-start:
[2023-06-20 19:22:00] [config]   - 10
[2023-06-20 19:22:00] [config]   - 1
[2023-06-20 19:22:00] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:22:00] [config] lr-report: false
[2023-06-20 19:22:00] [config] lr-warmup: 0
[2023-06-20 19:22:00] [config] lr-warmup-at-reload: false
[2023-06-20 19:22:00] [config] lr-warmup-cycle: false
[2023-06-20 19:22:00] [config] lr-warmup-start-rate: 0
[2023-06-20 19:22:00] [config] max-length: 50
[2023-06-20 19:22:00] [config] max-length-crop: false
[2023-06-20 19:22:00] [config] max-length-factor: 3
[2023-06-20 19:22:00] [config] maxi-batch: 100
[2023-06-20 19:22:00] [config] maxi-batch-sort: trg
[2023-06-20 19:22:00] [config] mini-batch: 64
[2023-06-20 19:22:00] [config] mini-batch-fit: false
[2023-06-20 19:22:00] [config] mini-batch-fit-step: 10
[2023-06-20 19:22:00] [config] mini-batch-round-up: true
[2023-06-20 19:22:00] [config] mini-batch-track-lr: false
[2023-06-20 19:22:00] [config] mini-batch-warmup: 0
[2023-06-20 19:22:00] [config] mini-batch-words: 0
[2023-06-20 19:22:00] [config] mini-batch-words-ref: 0
[2023-06-20 19:22:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:22:00] [config] multi-loss-type: sum
[2023-06-20 19:22:00] [config] n-best: false
[2023-06-20 19:22:00] [config] no-nccl: false
[2023-06-20 19:22:00] [config] no-reload: false
[2023-06-20 19:22:00] [config] no-restore-corpus: false
[2023-06-20 19:22:00] [config] normalize: 0
[2023-06-20 19:22:00] [config] normalize-gradient: false
[2023-06-20 19:22:00] [config] num-devices: 0
[2023-06-20 19:22:00] [config] optimizer: adam
[2023-06-20 19:22:00] [config] optimizer-delay: 1
[2023-06-20 19:22:00] [config] optimizer-params:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] output-omit-bias: false
[2023-06-20 19:22:00] [config] overwrite: false
[2023-06-20 19:22:00] [config] precision:
[2023-06-20 19:22:00] [config]   - float32
[2023-06-20 19:22:00] [config]   - float32
[2023-06-20 19:22:00] [config] pretrained-model: ""
[2023-06-20 19:22:00] [config] quantize-biases: false
[2023-06-20 19:22:00] [config] quantize-bits: 0
[2023-06-20 19:22:00] [config] quantize-log-based: false
[2023-06-20 19:22:00] [config] quantize-optimization-steps: 0
[2023-06-20 19:22:00] [config] quiet: false
[2023-06-20 19:22:00] [config] quiet-translation: true
[2023-06-20 19:22:00] [config] relative-paths: false
[2023-06-20 19:22:00] [config] right-left: false
[2023-06-20 19:22:00] [config] save-freq: 10000u
[2023-06-20 19:22:00] [config] seed: 1234
[2023-06-20 19:22:00] [config] sentencepiece-alphas:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:22:00] [config] sentencepiece-options: ""
[2023-06-20 19:22:00] [config] sharding: global
[2023-06-20 19:22:00] [config] shuffle: data
[2023-06-20 19:22:00] [config] shuffle-in-ram: false
[2023-06-20 19:22:00] [config] sigterm: save-and-exit
[2023-06-20 19:22:00] [config] skip: false
[2023-06-20 19:22:00] [config] sqlite: ""
[2023-06-20 19:22:00] [config] sqlite-drop: false
[2023-06-20 19:22:00] [config] sync-freq: 200u
[2023-06-20 19:22:00] [config] sync-sgd: false
[2023-06-20 19:22:00] [config] tempdir: /tmp
[2023-06-20 19:22:00] [config] tied-embeddings: false
[2023-06-20 19:22:00] [config] tied-embeddings-all: false
[2023-06-20 19:22:00] [config] tied-embeddings-src: false
[2023-06-20 19:22:00] [config] train-embedder-rank:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] train-sets:
[2023-06-20 19:22:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:22:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:22:00] [config] transformer-aan-activation: swish
[2023-06-20 19:22:00] [config] transformer-aan-depth: 2
[2023-06-20 19:22:00] [config] transformer-aan-nogate: false
[2023-06-20 19:22:00] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:22:00] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:22:00] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:22:00] [config] transformer-depth-scaling: false
[2023-06-20 19:22:00] [config] transformer-dim-aan: 2048
[2023-06-20 19:22:00] [config] transformer-dim-ffn: 2048
[2023-06-20 19:22:00] [config] transformer-dropout: 0
[2023-06-20 19:22:00] [config] transformer-dropout-attention: 0
[2023-06-20 19:22:00] [config] transformer-dropout-ffn: 0
[2023-06-20 19:22:00] [config] transformer-ffn-activation: swish
[2023-06-20 19:22:00] [config] transformer-ffn-depth: 2
[2023-06-20 19:22:00] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:22:00] [config] transformer-heads: 8
[2023-06-20 19:22:00] [config] transformer-no-projection: false
[2023-06-20 19:22:00] [config] transformer-pool: false
[2023-06-20 19:22:00] [config] transformer-postprocess: dan
[2023-06-20 19:22:00] [config] transformer-postprocess-emb: d
[2023-06-20 19:22:00] [config] transformer-postprocess-top: ""
[2023-06-20 19:22:00] [config] transformer-preprocess: ""
[2023-06-20 19:22:00] [config] transformer-tied-layers:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] transformer-train-position-embeddings: false
[2023-06-20 19:22:00] [config] tsv: false
[2023-06-20 19:22:00] [config] tsv-fields: 0
[2023-06-20 19:22:00] [config] type: amun
[2023-06-20 19:22:00] [config] ulr: false
[2023-06-20 19:22:00] [config] ulr-dim-emb: 0
[2023-06-20 19:22:00] [config] ulr-dropout: 0
[2023-06-20 19:22:00] [config] ulr-keys-vectors: ""
[2023-06-20 19:22:00] [config] ulr-query-vectors: ""
[2023-06-20 19:22:00] [config] ulr-softmax-temperature: 1
[2023-06-20 19:22:00] [config] ulr-trainable-transformation: false
[2023-06-20 19:22:00] [config] unlikelihood-loss: false
[2023-06-20 19:22:00] [config] valid-freq: 5000000
[2023-06-20 19:22:00] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:22:00] [config] valid-max-length: 1000
[2023-06-20 19:22:00] [config] valid-metrics:
[2023-06-20 19:22:00] [config]   - cross-entropy
[2023-06-20 19:22:00] [config] valid-mini-batch: 32
[2023-06-20 19:22:00] [config] valid-reset-stalled: false
[2023-06-20 19:22:00] [config] valid-script-args:
[2023-06-20 19:22:00] [config]   []
[2023-06-20 19:22:00] [config] valid-script-path: ""
[2023-06-20 19:22:00] [config] valid-sets:
[2023-06-20 19:22:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:22:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:22:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:22:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:22:00] [config] vocabs:
[2023-06-20 19:22:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:22:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:22:00] [config] word-penalty: 0
[2023-06-20 19:22:00] [config] word-scores: false
[2023-06-20 19:22:00] [config] workspace: 2048
[2023-06-20 19:22:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:22:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:22:00] [training] Using single-device training
[2023-06-20 19:22:02] Synced seed 1234
[2023-06-20 19:22:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:22:02] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:22:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:22:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:22:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:22:03] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:22:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:22:03] [comm] Using global sharding
[2023-06-20 19:22:03] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:22:03] [training] Using 1 GPUs
[2023-06-20 19:22:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:22:04] Loading Adam parameters
[2023-06-20 19:22:05] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:22:05] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:22:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:22:05] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:22:05] [data] Shuffling data
[2023-06-20 19:22:05] [data] Done reading 20,192 sentences
[2023-06-20 19:22:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:22:05] Training started
[2023-06-20 19:22:05] Training finished
[2023-06-20 19:26:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:26:48] [marian] Running on node21.datos.cluster.uy as process 2118 with command line:
[2023-06-20 19:26:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 180 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:26:48] [config] after: 0e
[2023-06-20 19:26:48] [config] after-batches: 0
[2023-06-20 19:26:48] [config] after-epochs: 180
[2023-06-20 19:26:48] [config] all-caps-every: 0
[2023-06-20 19:26:48] [config] allow-unk: false
[2023-06-20 19:26:48] [config] authors: false
[2023-06-20 19:26:48] [config] beam-size: 12
[2023-06-20 19:26:48] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:26:48] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:26:48] [config] bert-masking-fraction: 0.15
[2023-06-20 19:26:48] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:26:48] [config] bert-train-type-embeddings: true
[2023-06-20 19:26:48] [config] bert-type-vocab-size: 2
[2023-06-20 19:26:48] [config] build-info: ""
[2023-06-20 19:26:48] [config] check-gradient-nan: false
[2023-06-20 19:26:48] [config] check-nan: false
[2023-06-20 19:26:48] [config] cite: false
[2023-06-20 19:26:48] [config] clip-norm: 1
[2023-06-20 19:26:48] [config] cost-scaling:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] cost-type: ce-sum
[2023-06-20 19:26:48] [config] cpu-threads: 0
[2023-06-20 19:26:48] [config] data-threads: 8
[2023-06-20 19:26:48] [config] data-weighting: ""
[2023-06-20 19:26:48] [config] data-weighting-type: sentence
[2023-06-20 19:26:48] [config] dec-cell: gru
[2023-06-20 19:26:48] [config] dec-cell-base-depth: 2
[2023-06-20 19:26:48] [config] dec-cell-high-depth: 1
[2023-06-20 19:26:48] [config] dec-depth: 1
[2023-06-20 19:26:48] [config] devices:
[2023-06-20 19:26:48] [config]   - 0
[2023-06-20 19:26:48] [config] dim-emb: 512
[2023-06-20 19:26:48] [config] dim-rnn: 1024
[2023-06-20 19:26:48] [config] dim-vocabs:
[2023-06-20 19:26:48] [config]   - 54042
[2023-06-20 19:26:48] [config]   - 36507
[2023-06-20 19:26:48] [config] disp-first: 0
[2023-06-20 19:26:48] [config] disp-freq: 1000u
[2023-06-20 19:26:48] [config] disp-label-counts: true
[2023-06-20 19:26:48] [config] dropout-rnn: 0
[2023-06-20 19:26:48] [config] dropout-src: 0
[2023-06-20 19:26:48] [config] dropout-trg: 0
[2023-06-20 19:26:48] [config] dump-config: ""
[2023-06-20 19:26:48] [config] dynamic-gradient-scaling:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] early-stopping: 10
[2023-06-20 19:26:48] [config] early-stopping-on: first
[2023-06-20 19:26:48] [config] embedding-fix-src: false
[2023-06-20 19:26:48] [config] embedding-fix-trg: false
[2023-06-20 19:26:48] [config] embedding-normalization: false
[2023-06-20 19:26:48] [config] embedding-vectors:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] enc-cell: gru
[2023-06-20 19:26:48] [config] enc-cell-depth: 1
[2023-06-20 19:26:48] [config] enc-depth: 1
[2023-06-20 19:26:48] [config] enc-type: bidirectional
[2023-06-20 19:26:48] [config] english-title-case-every: 0
[2023-06-20 19:26:48] [config] exponential-smoothing: 0
[2023-06-20 19:26:48] [config] factor-weight: 1
[2023-06-20 19:26:48] [config] factors-combine: sum
[2023-06-20 19:26:48] [config] factors-dim-emb: 0
[2023-06-20 19:26:48] [config] gradient-checkpointing: false
[2023-06-20 19:26:48] [config] gradient-norm-average-window: 100
[2023-06-20 19:26:48] [config] guided-alignment: none
[2023-06-20 19:26:48] [config] guided-alignment-cost: mse
[2023-06-20 19:26:48] [config] guided-alignment-weight: 0.1
[2023-06-20 19:26:48] [config] ignore-model-config: false
[2023-06-20 19:26:48] [config] input-types:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] interpolate-env-vars: false
[2023-06-20 19:26:48] [config] keep-best: false
[2023-06-20 19:26:48] [config] label-smoothing: 0
[2023-06-20 19:26:48] [config] layer-normalization: false
[2023-06-20 19:26:48] [config] learn-rate: 0.0001
[2023-06-20 19:26:48] [config] lemma-dependency: ""
[2023-06-20 19:26:48] [config] lemma-dim-emb: 0
[2023-06-20 19:26:48] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:26:48] [config] log-level: info
[2023-06-20 19:26:48] [config] log-time-zone: ""
[2023-06-20 19:26:48] [config] logical-epoch:
[2023-06-20 19:26:48] [config]   - 1e
[2023-06-20 19:26:48] [config]   - 0
[2023-06-20 19:26:48] [config] lr-decay: 0
[2023-06-20 19:26:48] [config] lr-decay-freq: 50000
[2023-06-20 19:26:48] [config] lr-decay-inv-sqrt:
[2023-06-20 19:26:48] [config]   - 0
[2023-06-20 19:26:48] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:26:48] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:26:48] [config] lr-decay-start:
[2023-06-20 19:26:48] [config]   - 10
[2023-06-20 19:26:48] [config]   - 1
[2023-06-20 19:26:48] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:26:48] [config] lr-report: false
[2023-06-20 19:26:48] [config] lr-warmup: 0
[2023-06-20 19:26:48] [config] lr-warmup-at-reload: false
[2023-06-20 19:26:48] [config] lr-warmup-cycle: false
[2023-06-20 19:26:48] [config] lr-warmup-start-rate: 0
[2023-06-20 19:26:48] [config] max-length: 50
[2023-06-20 19:26:48] [config] max-length-crop: false
[2023-06-20 19:26:48] [config] max-length-factor: 3
[2023-06-20 19:26:48] [config] maxi-batch: 100
[2023-06-20 19:26:48] [config] maxi-batch-sort: trg
[2023-06-20 19:26:48] [config] mini-batch: 64
[2023-06-20 19:26:48] [config] mini-batch-fit: false
[2023-06-20 19:26:48] [config] mini-batch-fit-step: 10
[2023-06-20 19:26:48] [config] mini-batch-round-up: true
[2023-06-20 19:26:48] [config] mini-batch-track-lr: false
[2023-06-20 19:26:48] [config] mini-batch-warmup: 0
[2023-06-20 19:26:48] [config] mini-batch-words: 0
[2023-06-20 19:26:48] [config] mini-batch-words-ref: 0
[2023-06-20 19:26:48] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:26:48] [config] multi-loss-type: sum
[2023-06-20 19:26:48] [config] n-best: false
[2023-06-20 19:26:48] [config] no-nccl: false
[2023-06-20 19:26:48] [config] no-reload: false
[2023-06-20 19:26:48] [config] no-restore-corpus: false
[2023-06-20 19:26:48] [config] normalize: 0
[2023-06-20 19:26:48] [config] normalize-gradient: false
[2023-06-20 19:26:48] [config] num-devices: 0
[2023-06-20 19:26:48] [config] optimizer: adam
[2023-06-20 19:26:48] [config] optimizer-delay: 1
[2023-06-20 19:26:48] [config] optimizer-params:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] output-omit-bias: false
[2023-06-20 19:26:48] [config] overwrite: false
[2023-06-20 19:26:48] [config] precision:
[2023-06-20 19:26:48] [config]   - float32
[2023-06-20 19:26:48] [config]   - float32
[2023-06-20 19:26:48] [config] pretrained-model: ""
[2023-06-20 19:26:48] [config] quantize-biases: false
[2023-06-20 19:26:48] [config] quantize-bits: 0
[2023-06-20 19:26:48] [config] quantize-log-based: false
[2023-06-20 19:26:48] [config] quantize-optimization-steps: 0
[2023-06-20 19:26:48] [config] quiet: false
[2023-06-20 19:26:48] [config] quiet-translation: true
[2023-06-20 19:26:48] [config] relative-paths: false
[2023-06-20 19:26:48] [config] right-left: false
[2023-06-20 19:26:48] [config] save-freq: 10000u
[2023-06-20 19:26:48] [config] seed: 1234
[2023-06-20 19:26:48] [config] sentencepiece-alphas:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:26:48] [config] sentencepiece-options: ""
[2023-06-20 19:26:48] [config] sharding: global
[2023-06-20 19:26:48] [config] shuffle: data
[2023-06-20 19:26:48] [config] shuffle-in-ram: false
[2023-06-20 19:26:48] [config] sigterm: save-and-exit
[2023-06-20 19:26:48] [config] skip: false
[2023-06-20 19:26:48] [config] sqlite: ""
[2023-06-20 19:26:48] [config] sqlite-drop: false
[2023-06-20 19:26:48] [config] sync-freq: 200u
[2023-06-20 19:26:48] [config] sync-sgd: false
[2023-06-20 19:26:48] [config] tempdir: /tmp
[2023-06-20 19:26:48] [config] tied-embeddings: false
[2023-06-20 19:26:48] [config] tied-embeddings-all: false
[2023-06-20 19:26:48] [config] tied-embeddings-src: false
[2023-06-20 19:26:48] [config] train-embedder-rank:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] train-sets:
[2023-06-20 19:26:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:26:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:26:48] [config] transformer-aan-activation: swish
[2023-06-20 19:26:48] [config] transformer-aan-depth: 2
[2023-06-20 19:26:48] [config] transformer-aan-nogate: false
[2023-06-20 19:26:48] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:26:48] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:26:48] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:26:48] [config] transformer-depth-scaling: false
[2023-06-20 19:26:48] [config] transformer-dim-aan: 2048
[2023-06-20 19:26:48] [config] transformer-dim-ffn: 2048
[2023-06-20 19:26:48] [config] transformer-dropout: 0
[2023-06-20 19:26:48] [config] transformer-dropout-attention: 0
[2023-06-20 19:26:48] [config] transformer-dropout-ffn: 0
[2023-06-20 19:26:48] [config] transformer-ffn-activation: swish
[2023-06-20 19:26:48] [config] transformer-ffn-depth: 2
[2023-06-20 19:26:48] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:26:48] [config] transformer-heads: 8
[2023-06-20 19:26:48] [config] transformer-no-projection: false
[2023-06-20 19:26:48] [config] transformer-pool: false
[2023-06-20 19:26:48] [config] transformer-postprocess: dan
[2023-06-20 19:26:48] [config] transformer-postprocess-emb: d
[2023-06-20 19:26:48] [config] transformer-postprocess-top: ""
[2023-06-20 19:26:48] [config] transformer-preprocess: ""
[2023-06-20 19:26:48] [config] transformer-tied-layers:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] transformer-train-position-embeddings: false
[2023-06-20 19:26:48] [config] tsv: false
[2023-06-20 19:26:48] [config] tsv-fields: 0
[2023-06-20 19:26:48] [config] type: amun
[2023-06-20 19:26:48] [config] ulr: false
[2023-06-20 19:26:48] [config] ulr-dim-emb: 0
[2023-06-20 19:26:48] [config] ulr-dropout: 0
[2023-06-20 19:26:48] [config] ulr-keys-vectors: ""
[2023-06-20 19:26:48] [config] ulr-query-vectors: ""
[2023-06-20 19:26:48] [config] ulr-softmax-temperature: 1
[2023-06-20 19:26:48] [config] ulr-trainable-transformation: false
[2023-06-20 19:26:48] [config] unlikelihood-loss: false
[2023-06-20 19:26:48] [config] valid-freq: 5000000
[2023-06-20 19:26:48] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:26:48] [config] valid-max-length: 1000
[2023-06-20 19:26:48] [config] valid-metrics:
[2023-06-20 19:26:48] [config]   - cross-entropy
[2023-06-20 19:26:48] [config] valid-mini-batch: 32
[2023-06-20 19:26:48] [config] valid-reset-stalled: false
[2023-06-20 19:26:48] [config] valid-script-args:
[2023-06-20 19:26:48] [config]   []
[2023-06-20 19:26:48] [config] valid-script-path: ""
[2023-06-20 19:26:48] [config] valid-sets:
[2023-06-20 19:26:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:26:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:26:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:26:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:26:48] [config] vocabs:
[2023-06-20 19:26:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:26:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:26:48] [config] word-penalty: 0
[2023-06-20 19:26:48] [config] word-scores: false
[2023-06-20 19:26:48] [config] workspace: 2048
[2023-06-20 19:26:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:26:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:26:48] [training] Using single-device training
[2023-06-20 19:26:48] Synced seed 1234
[2023-06-20 19:26:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:26:48] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:26:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:26:48] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:26:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:26:49] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:26:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:26:49] [comm] Using global sharding
[2023-06-20 19:26:49] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:26:49] [training] Using 1 GPUs
[2023-06-20 19:26:49] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:26:50] Loading Adam parameters
[2023-06-20 19:26:51] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:26:51] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:26:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:26:51] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:26:51] [data] Shuffling data
[2023-06-20 19:26:51] [data] Done reading 20,192 sentences
[2023-06-20 19:26:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:26:51] Training started
[2023-06-20 19:26:51] Training finished
[2023-06-20 19:31:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:31:38] [marian] Running on node21.datos.cluster.uy as process 2458 with command line:
[2023-06-20 19:31:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 190 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:31:38] [config] after: 0e
[2023-06-20 19:31:38] [config] after-batches: 0
[2023-06-20 19:31:38] [config] after-epochs: 190
[2023-06-20 19:31:38] [config] all-caps-every: 0
[2023-06-20 19:31:38] [config] allow-unk: false
[2023-06-20 19:31:38] [config] authors: false
[2023-06-20 19:31:38] [config] beam-size: 12
[2023-06-20 19:31:38] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:31:38] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:31:38] [config] bert-masking-fraction: 0.15
[2023-06-20 19:31:38] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:31:38] [config] bert-train-type-embeddings: true
[2023-06-20 19:31:38] [config] bert-type-vocab-size: 2
[2023-06-20 19:31:38] [config] build-info: ""
[2023-06-20 19:31:38] [config] check-gradient-nan: false
[2023-06-20 19:31:38] [config] check-nan: false
[2023-06-20 19:31:38] [config] cite: false
[2023-06-20 19:31:38] [config] clip-norm: 1
[2023-06-20 19:31:38] [config] cost-scaling:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] cost-type: ce-sum
[2023-06-20 19:31:38] [config] cpu-threads: 0
[2023-06-20 19:31:38] [config] data-threads: 8
[2023-06-20 19:31:38] [config] data-weighting: ""
[2023-06-20 19:31:38] [config] data-weighting-type: sentence
[2023-06-20 19:31:38] [config] dec-cell: gru
[2023-06-20 19:31:38] [config] dec-cell-base-depth: 2
[2023-06-20 19:31:38] [config] dec-cell-high-depth: 1
[2023-06-20 19:31:38] [config] dec-depth: 1
[2023-06-20 19:31:38] [config] devices:
[2023-06-20 19:31:38] [config]   - 0
[2023-06-20 19:31:38] [config] dim-emb: 512
[2023-06-20 19:31:38] [config] dim-rnn: 1024
[2023-06-20 19:31:38] [config] dim-vocabs:
[2023-06-20 19:31:38] [config]   - 54042
[2023-06-20 19:31:38] [config]   - 36507
[2023-06-20 19:31:38] [config] disp-first: 0
[2023-06-20 19:31:38] [config] disp-freq: 1000u
[2023-06-20 19:31:38] [config] disp-label-counts: true
[2023-06-20 19:31:38] [config] dropout-rnn: 0
[2023-06-20 19:31:38] [config] dropout-src: 0
[2023-06-20 19:31:38] [config] dropout-trg: 0
[2023-06-20 19:31:38] [config] dump-config: ""
[2023-06-20 19:31:38] [config] dynamic-gradient-scaling:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] early-stopping: 10
[2023-06-20 19:31:38] [config] early-stopping-on: first
[2023-06-20 19:31:38] [config] embedding-fix-src: false
[2023-06-20 19:31:38] [config] embedding-fix-trg: false
[2023-06-20 19:31:38] [config] embedding-normalization: false
[2023-06-20 19:31:38] [config] embedding-vectors:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] enc-cell: gru
[2023-06-20 19:31:38] [config] enc-cell-depth: 1
[2023-06-20 19:31:38] [config] enc-depth: 1
[2023-06-20 19:31:38] [config] enc-type: bidirectional
[2023-06-20 19:31:38] [config] english-title-case-every: 0
[2023-06-20 19:31:38] [config] exponential-smoothing: 0
[2023-06-20 19:31:38] [config] factor-weight: 1
[2023-06-20 19:31:38] [config] factors-combine: sum
[2023-06-20 19:31:38] [config] factors-dim-emb: 0
[2023-06-20 19:31:38] [config] gradient-checkpointing: false
[2023-06-20 19:31:38] [config] gradient-norm-average-window: 100
[2023-06-20 19:31:38] [config] guided-alignment: none
[2023-06-20 19:31:38] [config] guided-alignment-cost: mse
[2023-06-20 19:31:38] [config] guided-alignment-weight: 0.1
[2023-06-20 19:31:38] [config] ignore-model-config: false
[2023-06-20 19:31:38] [config] input-types:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] interpolate-env-vars: false
[2023-06-20 19:31:38] [config] keep-best: false
[2023-06-20 19:31:38] [config] label-smoothing: 0
[2023-06-20 19:31:38] [config] layer-normalization: false
[2023-06-20 19:31:38] [config] learn-rate: 0.0001
[2023-06-20 19:31:38] [config] lemma-dependency: ""
[2023-06-20 19:31:38] [config] lemma-dim-emb: 0
[2023-06-20 19:31:38] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:31:38] [config] log-level: info
[2023-06-20 19:31:38] [config] log-time-zone: ""
[2023-06-20 19:31:38] [config] logical-epoch:
[2023-06-20 19:31:38] [config]   - 1e
[2023-06-20 19:31:38] [config]   - 0
[2023-06-20 19:31:38] [config] lr-decay: 0
[2023-06-20 19:31:38] [config] lr-decay-freq: 50000
[2023-06-20 19:31:38] [config] lr-decay-inv-sqrt:
[2023-06-20 19:31:38] [config]   - 0
[2023-06-20 19:31:38] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:31:38] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:31:38] [config] lr-decay-start:
[2023-06-20 19:31:38] [config]   - 10
[2023-06-20 19:31:38] [config]   - 1
[2023-06-20 19:31:38] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:31:38] [config] lr-report: false
[2023-06-20 19:31:38] [config] lr-warmup: 0
[2023-06-20 19:31:38] [config] lr-warmup-at-reload: false
[2023-06-20 19:31:38] [config] lr-warmup-cycle: false
[2023-06-20 19:31:38] [config] lr-warmup-start-rate: 0
[2023-06-20 19:31:38] [config] max-length: 50
[2023-06-20 19:31:38] [config] max-length-crop: false
[2023-06-20 19:31:38] [config] max-length-factor: 3
[2023-06-20 19:31:38] [config] maxi-batch: 100
[2023-06-20 19:31:38] [config] maxi-batch-sort: trg
[2023-06-20 19:31:38] [config] mini-batch: 64
[2023-06-20 19:31:38] [config] mini-batch-fit: false
[2023-06-20 19:31:38] [config] mini-batch-fit-step: 10
[2023-06-20 19:31:38] [config] mini-batch-round-up: true
[2023-06-20 19:31:38] [config] mini-batch-track-lr: false
[2023-06-20 19:31:38] [config] mini-batch-warmup: 0
[2023-06-20 19:31:38] [config] mini-batch-words: 0
[2023-06-20 19:31:38] [config] mini-batch-words-ref: 0
[2023-06-20 19:31:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:31:38] [config] multi-loss-type: sum
[2023-06-20 19:31:38] [config] n-best: false
[2023-06-20 19:31:38] [config] no-nccl: false
[2023-06-20 19:31:38] [config] no-reload: false
[2023-06-20 19:31:38] [config] no-restore-corpus: false
[2023-06-20 19:31:38] [config] normalize: 0
[2023-06-20 19:31:38] [config] normalize-gradient: false
[2023-06-20 19:31:38] [config] num-devices: 0
[2023-06-20 19:31:38] [config] optimizer: adam
[2023-06-20 19:31:38] [config] optimizer-delay: 1
[2023-06-20 19:31:38] [config] optimizer-params:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] output-omit-bias: false
[2023-06-20 19:31:38] [config] overwrite: false
[2023-06-20 19:31:38] [config] precision:
[2023-06-20 19:31:38] [config]   - float32
[2023-06-20 19:31:38] [config]   - float32
[2023-06-20 19:31:38] [config] pretrained-model: ""
[2023-06-20 19:31:38] [config] quantize-biases: false
[2023-06-20 19:31:38] [config] quantize-bits: 0
[2023-06-20 19:31:38] [config] quantize-log-based: false
[2023-06-20 19:31:38] [config] quantize-optimization-steps: 0
[2023-06-20 19:31:38] [config] quiet: false
[2023-06-20 19:31:38] [config] quiet-translation: true
[2023-06-20 19:31:38] [config] relative-paths: false
[2023-06-20 19:31:38] [config] right-left: false
[2023-06-20 19:31:38] [config] save-freq: 10000u
[2023-06-20 19:31:38] [config] seed: 1234
[2023-06-20 19:31:38] [config] sentencepiece-alphas:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:31:38] [config] sentencepiece-options: ""
[2023-06-20 19:31:38] [config] sharding: global
[2023-06-20 19:31:38] [config] shuffle: data
[2023-06-20 19:31:38] [config] shuffle-in-ram: false
[2023-06-20 19:31:38] [config] sigterm: save-and-exit
[2023-06-20 19:31:38] [config] skip: false
[2023-06-20 19:31:38] [config] sqlite: ""
[2023-06-20 19:31:38] [config] sqlite-drop: false
[2023-06-20 19:31:38] [config] sync-freq: 200u
[2023-06-20 19:31:38] [config] sync-sgd: false
[2023-06-20 19:31:38] [config] tempdir: /tmp
[2023-06-20 19:31:38] [config] tied-embeddings: false
[2023-06-20 19:31:38] [config] tied-embeddings-all: false
[2023-06-20 19:31:38] [config] tied-embeddings-src: false
[2023-06-20 19:31:38] [config] train-embedder-rank:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] train-sets:
[2023-06-20 19:31:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:31:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:31:38] [config] transformer-aan-activation: swish
[2023-06-20 19:31:38] [config] transformer-aan-depth: 2
[2023-06-20 19:31:38] [config] transformer-aan-nogate: false
[2023-06-20 19:31:38] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:31:38] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:31:38] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:31:38] [config] transformer-depth-scaling: false
[2023-06-20 19:31:38] [config] transformer-dim-aan: 2048
[2023-06-20 19:31:38] [config] transformer-dim-ffn: 2048
[2023-06-20 19:31:38] [config] transformer-dropout: 0
[2023-06-20 19:31:38] [config] transformer-dropout-attention: 0
[2023-06-20 19:31:38] [config] transformer-dropout-ffn: 0
[2023-06-20 19:31:38] [config] transformer-ffn-activation: swish
[2023-06-20 19:31:38] [config] transformer-ffn-depth: 2
[2023-06-20 19:31:38] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:31:38] [config] transformer-heads: 8
[2023-06-20 19:31:38] [config] transformer-no-projection: false
[2023-06-20 19:31:38] [config] transformer-pool: false
[2023-06-20 19:31:38] [config] transformer-postprocess: dan
[2023-06-20 19:31:38] [config] transformer-postprocess-emb: d
[2023-06-20 19:31:38] [config] transformer-postprocess-top: ""
[2023-06-20 19:31:38] [config] transformer-preprocess: ""
[2023-06-20 19:31:38] [config] transformer-tied-layers:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] transformer-train-position-embeddings: false
[2023-06-20 19:31:38] [config] tsv: false
[2023-06-20 19:31:38] [config] tsv-fields: 0
[2023-06-20 19:31:38] [config] type: amun
[2023-06-20 19:31:38] [config] ulr: false
[2023-06-20 19:31:38] [config] ulr-dim-emb: 0
[2023-06-20 19:31:38] [config] ulr-dropout: 0
[2023-06-20 19:31:38] [config] ulr-keys-vectors: ""
[2023-06-20 19:31:38] [config] ulr-query-vectors: ""
[2023-06-20 19:31:38] [config] ulr-softmax-temperature: 1
[2023-06-20 19:31:38] [config] ulr-trainable-transformation: false
[2023-06-20 19:31:38] [config] unlikelihood-loss: false
[2023-06-20 19:31:38] [config] valid-freq: 5000000
[2023-06-20 19:31:38] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:31:38] [config] valid-max-length: 1000
[2023-06-20 19:31:38] [config] valid-metrics:
[2023-06-20 19:31:38] [config]   - cross-entropy
[2023-06-20 19:31:38] [config] valid-mini-batch: 32
[2023-06-20 19:31:38] [config] valid-reset-stalled: false
[2023-06-20 19:31:38] [config] valid-script-args:
[2023-06-20 19:31:38] [config]   []
[2023-06-20 19:31:38] [config] valid-script-path: ""
[2023-06-20 19:31:38] [config] valid-sets:
[2023-06-20 19:31:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:31:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:31:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:31:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:31:38] [config] vocabs:
[2023-06-20 19:31:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:31:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:31:38] [config] word-penalty: 0
[2023-06-20 19:31:38] [config] word-scores: false
[2023-06-20 19:31:38] [config] workspace: 2048
[2023-06-20 19:31:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:31:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:31:38] [training] Using single-device training
[2023-06-20 19:31:38] Synced seed 1234
[2023-06-20 19:31:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:31:39] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:31:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:31:39] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:31:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:31:39] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:31:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:31:39] [comm] Using global sharding
[2023-06-20 19:31:39] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:31:39] [training] Using 1 GPUs
[2023-06-20 19:31:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:31:41] Loading Adam parameters
[2023-06-20 19:31:41] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:31:41] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:31:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:31:42] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:31:42] [data] Shuffling data
[2023-06-20 19:31:42] [data] Done reading 20,192 sentences
[2023-06-20 19:31:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:31:42] Training started
[2023-06-20 19:31:42] Training finished
[2023-06-20 19:36:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:36:25] [marian] Running on node21.datos.cluster.uy as process 2766 with command line:
[2023-06-20 19:36:25] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 200 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 19:36:25] [config] after: 0e
[2023-06-20 19:36:25] [config] after-batches: 0
[2023-06-20 19:36:25] [config] after-epochs: 200
[2023-06-20 19:36:25] [config] all-caps-every: 0
[2023-06-20 19:36:25] [config] allow-unk: false
[2023-06-20 19:36:25] [config] authors: false
[2023-06-20 19:36:25] [config] beam-size: 12
[2023-06-20 19:36:25] [config] bert-class-symbol: "[CLS]"
[2023-06-20 19:36:25] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 19:36:25] [config] bert-masking-fraction: 0.15
[2023-06-20 19:36:25] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 19:36:25] [config] bert-train-type-embeddings: true
[2023-06-20 19:36:25] [config] bert-type-vocab-size: 2
[2023-06-20 19:36:25] [config] build-info: ""
[2023-06-20 19:36:25] [config] check-gradient-nan: false
[2023-06-20 19:36:25] [config] check-nan: false
[2023-06-20 19:36:25] [config] cite: false
[2023-06-20 19:36:25] [config] clip-norm: 1
[2023-06-20 19:36:25] [config] cost-scaling:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] cost-type: ce-sum
[2023-06-20 19:36:25] [config] cpu-threads: 0
[2023-06-20 19:36:25] [config] data-threads: 8
[2023-06-20 19:36:25] [config] data-weighting: ""
[2023-06-20 19:36:25] [config] data-weighting-type: sentence
[2023-06-20 19:36:25] [config] dec-cell: gru
[2023-06-20 19:36:25] [config] dec-cell-base-depth: 2
[2023-06-20 19:36:25] [config] dec-cell-high-depth: 1
[2023-06-20 19:36:25] [config] dec-depth: 1
[2023-06-20 19:36:25] [config] devices:
[2023-06-20 19:36:25] [config]   - 0
[2023-06-20 19:36:25] [config] dim-emb: 512
[2023-06-20 19:36:25] [config] dim-rnn: 1024
[2023-06-20 19:36:25] [config] dim-vocabs:
[2023-06-20 19:36:25] [config]   - 54042
[2023-06-20 19:36:25] [config]   - 36507
[2023-06-20 19:36:25] [config] disp-first: 0
[2023-06-20 19:36:25] [config] disp-freq: 1000u
[2023-06-20 19:36:25] [config] disp-label-counts: true
[2023-06-20 19:36:25] [config] dropout-rnn: 0
[2023-06-20 19:36:25] [config] dropout-src: 0
[2023-06-20 19:36:25] [config] dropout-trg: 0
[2023-06-20 19:36:25] [config] dump-config: ""
[2023-06-20 19:36:25] [config] dynamic-gradient-scaling:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] early-stopping: 10
[2023-06-20 19:36:25] [config] early-stopping-on: first
[2023-06-20 19:36:25] [config] embedding-fix-src: false
[2023-06-20 19:36:25] [config] embedding-fix-trg: false
[2023-06-20 19:36:25] [config] embedding-normalization: false
[2023-06-20 19:36:25] [config] embedding-vectors:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] enc-cell: gru
[2023-06-20 19:36:25] [config] enc-cell-depth: 1
[2023-06-20 19:36:25] [config] enc-depth: 1
[2023-06-20 19:36:25] [config] enc-type: bidirectional
[2023-06-20 19:36:25] [config] english-title-case-every: 0
[2023-06-20 19:36:25] [config] exponential-smoothing: 0
[2023-06-20 19:36:25] [config] factor-weight: 1
[2023-06-20 19:36:25] [config] factors-combine: sum
[2023-06-20 19:36:25] [config] factors-dim-emb: 0
[2023-06-20 19:36:25] [config] gradient-checkpointing: false
[2023-06-20 19:36:25] [config] gradient-norm-average-window: 100
[2023-06-20 19:36:25] [config] guided-alignment: none
[2023-06-20 19:36:25] [config] guided-alignment-cost: mse
[2023-06-20 19:36:25] [config] guided-alignment-weight: 0.1
[2023-06-20 19:36:25] [config] ignore-model-config: false
[2023-06-20 19:36:25] [config] input-types:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] interpolate-env-vars: false
[2023-06-20 19:36:25] [config] keep-best: false
[2023-06-20 19:36:25] [config] label-smoothing: 0
[2023-06-20 19:36:25] [config] layer-normalization: false
[2023-06-20 19:36:25] [config] learn-rate: 0.0001
[2023-06-20 19:36:25] [config] lemma-dependency: ""
[2023-06-20 19:36:25] [config] lemma-dim-emb: 0
[2023-06-20 19:36:25] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 19:36:25] [config] log-level: info
[2023-06-20 19:36:25] [config] log-time-zone: ""
[2023-06-20 19:36:25] [config] logical-epoch:
[2023-06-20 19:36:25] [config]   - 1e
[2023-06-20 19:36:25] [config]   - 0
[2023-06-20 19:36:25] [config] lr-decay: 0
[2023-06-20 19:36:25] [config] lr-decay-freq: 50000
[2023-06-20 19:36:25] [config] lr-decay-inv-sqrt:
[2023-06-20 19:36:25] [config]   - 0
[2023-06-20 19:36:25] [config] lr-decay-repeat-warmup: false
[2023-06-20 19:36:25] [config] lr-decay-reset-optimizer: false
[2023-06-20 19:36:25] [config] lr-decay-start:
[2023-06-20 19:36:25] [config]   - 10
[2023-06-20 19:36:25] [config]   - 1
[2023-06-20 19:36:25] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 19:36:25] [config] lr-report: false
[2023-06-20 19:36:25] [config] lr-warmup: 0
[2023-06-20 19:36:25] [config] lr-warmup-at-reload: false
[2023-06-20 19:36:25] [config] lr-warmup-cycle: false
[2023-06-20 19:36:25] [config] lr-warmup-start-rate: 0
[2023-06-20 19:36:25] [config] max-length: 50
[2023-06-20 19:36:25] [config] max-length-crop: false
[2023-06-20 19:36:25] [config] max-length-factor: 3
[2023-06-20 19:36:25] [config] maxi-batch: 100
[2023-06-20 19:36:25] [config] maxi-batch-sort: trg
[2023-06-20 19:36:25] [config] mini-batch: 64
[2023-06-20 19:36:25] [config] mini-batch-fit: false
[2023-06-20 19:36:25] [config] mini-batch-fit-step: 10
[2023-06-20 19:36:25] [config] mini-batch-round-up: true
[2023-06-20 19:36:25] [config] mini-batch-track-lr: false
[2023-06-20 19:36:25] [config] mini-batch-warmup: 0
[2023-06-20 19:36:25] [config] mini-batch-words: 0
[2023-06-20 19:36:25] [config] mini-batch-words-ref: 0
[2023-06-20 19:36:25] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:36:25] [config] multi-loss-type: sum
[2023-06-20 19:36:25] [config] n-best: false
[2023-06-20 19:36:25] [config] no-nccl: false
[2023-06-20 19:36:25] [config] no-reload: false
[2023-06-20 19:36:25] [config] no-restore-corpus: false
[2023-06-20 19:36:25] [config] normalize: 0
[2023-06-20 19:36:25] [config] normalize-gradient: false
[2023-06-20 19:36:25] [config] num-devices: 0
[2023-06-20 19:36:25] [config] optimizer: adam
[2023-06-20 19:36:25] [config] optimizer-delay: 1
[2023-06-20 19:36:25] [config] optimizer-params:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] output-omit-bias: false
[2023-06-20 19:36:25] [config] overwrite: false
[2023-06-20 19:36:25] [config] precision:
[2023-06-20 19:36:25] [config]   - float32
[2023-06-20 19:36:25] [config]   - float32
[2023-06-20 19:36:25] [config] pretrained-model: ""
[2023-06-20 19:36:25] [config] quantize-biases: false
[2023-06-20 19:36:25] [config] quantize-bits: 0
[2023-06-20 19:36:25] [config] quantize-log-based: false
[2023-06-20 19:36:25] [config] quantize-optimization-steps: 0
[2023-06-20 19:36:25] [config] quiet: false
[2023-06-20 19:36:25] [config] quiet-translation: true
[2023-06-20 19:36:25] [config] relative-paths: false
[2023-06-20 19:36:25] [config] right-left: false
[2023-06-20 19:36:25] [config] save-freq: 10000u
[2023-06-20 19:36:25] [config] seed: 1234
[2023-06-20 19:36:25] [config] sentencepiece-alphas:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] sentencepiece-max-lines: 2000000
[2023-06-20 19:36:25] [config] sentencepiece-options: ""
[2023-06-20 19:36:25] [config] sharding: global
[2023-06-20 19:36:25] [config] shuffle: data
[2023-06-20 19:36:25] [config] shuffle-in-ram: false
[2023-06-20 19:36:25] [config] sigterm: save-and-exit
[2023-06-20 19:36:25] [config] skip: false
[2023-06-20 19:36:25] [config] sqlite: ""
[2023-06-20 19:36:25] [config] sqlite-drop: false
[2023-06-20 19:36:25] [config] sync-freq: 200u
[2023-06-20 19:36:25] [config] sync-sgd: false
[2023-06-20 19:36:25] [config] tempdir: /tmp
[2023-06-20 19:36:25] [config] tied-embeddings: false
[2023-06-20 19:36:25] [config] tied-embeddings-all: false
[2023-06-20 19:36:25] [config] tied-embeddings-src: false
[2023-06-20 19:36:25] [config] train-embedder-rank:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] train-sets:
[2023-06-20 19:36:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 19:36:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 19:36:25] [config] transformer-aan-activation: swish
[2023-06-20 19:36:25] [config] transformer-aan-depth: 2
[2023-06-20 19:36:25] [config] transformer-aan-nogate: false
[2023-06-20 19:36:25] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 19:36:25] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 19:36:25] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 19:36:25] [config] transformer-depth-scaling: false
[2023-06-20 19:36:25] [config] transformer-dim-aan: 2048
[2023-06-20 19:36:25] [config] transformer-dim-ffn: 2048
[2023-06-20 19:36:25] [config] transformer-dropout: 0
[2023-06-20 19:36:25] [config] transformer-dropout-attention: 0
[2023-06-20 19:36:25] [config] transformer-dropout-ffn: 0
[2023-06-20 19:36:25] [config] transformer-ffn-activation: swish
[2023-06-20 19:36:25] [config] transformer-ffn-depth: 2
[2023-06-20 19:36:25] [config] transformer-guided-alignment-layer: last
[2023-06-20 19:36:25] [config] transformer-heads: 8
[2023-06-20 19:36:25] [config] transformer-no-projection: false
[2023-06-20 19:36:25] [config] transformer-pool: false
[2023-06-20 19:36:25] [config] transformer-postprocess: dan
[2023-06-20 19:36:25] [config] transformer-postprocess-emb: d
[2023-06-20 19:36:25] [config] transformer-postprocess-top: ""
[2023-06-20 19:36:25] [config] transformer-preprocess: ""
[2023-06-20 19:36:25] [config] transformer-tied-layers:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] transformer-train-position-embeddings: false
[2023-06-20 19:36:25] [config] tsv: false
[2023-06-20 19:36:25] [config] tsv-fields: 0
[2023-06-20 19:36:25] [config] type: amun
[2023-06-20 19:36:25] [config] ulr: false
[2023-06-20 19:36:25] [config] ulr-dim-emb: 0
[2023-06-20 19:36:25] [config] ulr-dropout: 0
[2023-06-20 19:36:25] [config] ulr-keys-vectors: ""
[2023-06-20 19:36:25] [config] ulr-query-vectors: ""
[2023-06-20 19:36:25] [config] ulr-softmax-temperature: 1
[2023-06-20 19:36:25] [config] ulr-trainable-transformation: false
[2023-06-20 19:36:25] [config] unlikelihood-loss: false
[2023-06-20 19:36:25] [config] valid-freq: 5000000
[2023-06-20 19:36:25] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 19:36:25] [config] valid-max-length: 1000
[2023-06-20 19:36:25] [config] valid-metrics:
[2023-06-20 19:36:25] [config]   - cross-entropy
[2023-06-20 19:36:25] [config] valid-mini-batch: 32
[2023-06-20 19:36:25] [config] valid-reset-stalled: false
[2023-06-20 19:36:25] [config] valid-script-args:
[2023-06-20 19:36:25] [config]   []
[2023-06-20 19:36:25] [config] valid-script-path: ""
[2023-06-20 19:36:25] [config] valid-sets:
[2023-06-20 19:36:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 19:36:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 19:36:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 19:36:25] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:36:25] [config] vocabs:
[2023-06-20 19:36:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:36:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:36:25] [config] word-penalty: 0
[2023-06-20 19:36:25] [config] word-scores: false
[2023-06-20 19:36:25] [config] workspace: 2048
[2023-06-20 19:36:25] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 19:36:25] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:36:25] [training] Using single-device training
[2023-06-20 19:36:25] Synced seed 1234
[2023-06-20 19:36:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 19:36:25] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 19:36:25] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 19:36:25] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 19:36:25] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 19:36:26] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-06-20 19:36:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 19:36:26] [comm] Using global sharding
[2023-06-20 19:36:26] [comm] NCCLCommunicators constructed successfully
[2023-06-20 19:36:26] [training] Using 1 GPUs
[2023-06-20 19:36:26] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 19:36:28] Loading Adam parameters
[2023-06-20 19:36:28] [memory] Reserving 754 MB, device gpu0
[2023-06-20 19:36:28] [memory] Reserving 377 MB, device gpu0
[2023-06-20 19:36:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 19:36:28] [data] Restoring the corpus state to epoch 111, batch 32628
[2023-06-20 19:36:28] [data] Shuffling data
[2023-06-20 19:36:28] [data] Done reading 20,192 sentences
[2023-06-20 19:36:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 19:36:28] Training started
[2023-06-20 19:36:28] Training finished
[2023-06-20 21:54:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 21:54:20] [marian] Running on node17.datos.cluster.uy as process 29693 with command line:
[2023-06-20 21:54:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 10 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 21:54:20] [config] after: 0e
[2023-06-20 21:54:20] [config] after-batches: 0
[2023-06-20 21:54:20] [config] after-epochs: 10
[2023-06-20 21:54:20] [config] all-caps-every: 0
[2023-06-20 21:54:20] [config] allow-unk: false
[2023-06-20 21:54:20] [config] authors: false
[2023-06-20 21:54:20] [config] beam-size: 12
[2023-06-20 21:54:20] [config] bert-class-symbol: "[CLS]"
[2023-06-20 21:54:20] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 21:54:20] [config] bert-masking-fraction: 0.15
[2023-06-20 21:54:20] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 21:54:20] [config] bert-train-type-embeddings: true
[2023-06-20 21:54:20] [config] bert-type-vocab-size: 2
[2023-06-20 21:54:20] [config] build-info: ""
[2023-06-20 21:54:20] [config] check-gradient-nan: false
[2023-06-20 21:54:20] [config] check-nan: false
[2023-06-20 21:54:20] [config] cite: false
[2023-06-20 21:54:20] [config] clip-norm: 1
[2023-06-20 21:54:20] [config] cost-scaling:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] cost-type: ce-sum
[2023-06-20 21:54:20] [config] cpu-threads: 0
[2023-06-20 21:54:20] [config] data-threads: 8
[2023-06-20 21:54:20] [config] data-weighting: ""
[2023-06-20 21:54:20] [config] data-weighting-type: sentence
[2023-06-20 21:54:20] [config] dec-cell: gru
[2023-06-20 21:54:20] [config] dec-cell-base-depth: 2
[2023-06-20 21:54:20] [config] dec-cell-high-depth: 1
[2023-06-20 21:54:20] [config] dec-depth: 1
[2023-06-20 21:54:20] [config] devices:
[2023-06-20 21:54:20] [config]   - 0
[2023-06-20 21:54:20] [config] dim-emb: 512
[2023-06-20 21:54:20] [config] dim-rnn: 1024
[2023-06-20 21:54:20] [config] dim-vocabs:
[2023-06-20 21:54:20] [config]   - 0
[2023-06-20 21:54:20] [config]   - 0
[2023-06-20 21:54:20] [config] disp-first: 0
[2023-06-20 21:54:20] [config] disp-freq: 1000u
[2023-06-20 21:54:20] [config] disp-label-counts: true
[2023-06-20 21:54:20] [config] dropout-rnn: 0.2
[2023-06-20 21:54:20] [config] dropout-src: 0.1
[2023-06-20 21:54:20] [config] dropout-trg: 0.1
[2023-06-20 21:54:20] [config] dump-config: ""
[2023-06-20 21:54:20] [config] dynamic-gradient-scaling:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] early-stopping: 5
[2023-06-20 21:54:20] [config] early-stopping-on: first
[2023-06-20 21:54:20] [config] embedding-fix-src: false
[2023-06-20 21:54:20] [config] embedding-fix-trg: false
[2023-06-20 21:54:20] [config] embedding-normalization: false
[2023-06-20 21:54:20] [config] embedding-vectors:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] enc-cell: gru
[2023-06-20 21:54:20] [config] enc-cell-depth: 1
[2023-06-20 21:54:20] [config] enc-depth: 1
[2023-06-20 21:54:20] [config] enc-type: bidirectional
[2023-06-20 21:54:20] [config] english-title-case-every: 0
[2023-06-20 21:54:20] [config] exponential-smoothing: 0
[2023-06-20 21:54:20] [config] factor-weight: 1
[2023-06-20 21:54:20] [config] factors-combine: sum
[2023-06-20 21:54:20] [config] factors-dim-emb: 0
[2023-06-20 21:54:20] [config] gradient-checkpointing: false
[2023-06-20 21:54:20] [config] gradient-norm-average-window: 100
[2023-06-20 21:54:20] [config] guided-alignment: none
[2023-06-20 21:54:20] [config] guided-alignment-cost: mse
[2023-06-20 21:54:20] [config] guided-alignment-weight: 0.1
[2023-06-20 21:54:20] [config] ignore-model-config: false
[2023-06-20 21:54:20] [config] input-types:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] interpolate-env-vars: false
[2023-06-20 21:54:20] [config] keep-best: false
[2023-06-20 21:54:20] [config] label-smoothing: 0
[2023-06-20 21:54:20] [config] layer-normalization: true
[2023-06-20 21:54:20] [config] learn-rate: 0.0001
[2023-06-20 21:54:20] [config] lemma-dependency: ""
[2023-06-20 21:54:20] [config] lemma-dim-emb: 0
[2023-06-20 21:54:20] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 21:54:20] [config] log-level: info
[2023-06-20 21:54:20] [config] log-time-zone: ""
[2023-06-20 21:54:20] [config] logical-epoch:
[2023-06-20 21:54:20] [config]   - 1e
[2023-06-20 21:54:20] [config]   - 0
[2023-06-20 21:54:20] [config] lr-decay: 0
[2023-06-20 21:54:20] [config] lr-decay-freq: 50000
[2023-06-20 21:54:20] [config] lr-decay-inv-sqrt:
[2023-06-20 21:54:20] [config]   - 0
[2023-06-20 21:54:20] [config] lr-decay-repeat-warmup: false
[2023-06-20 21:54:20] [config] lr-decay-reset-optimizer: false
[2023-06-20 21:54:20] [config] lr-decay-start:
[2023-06-20 21:54:20] [config]   - 10
[2023-06-20 21:54:20] [config]   - 1
[2023-06-20 21:54:20] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 21:54:20] [config] lr-report: false
[2023-06-20 21:54:20] [config] lr-warmup: 0
[2023-06-20 21:54:20] [config] lr-warmup-at-reload: false
[2023-06-20 21:54:20] [config] lr-warmup-cycle: false
[2023-06-20 21:54:20] [config] lr-warmup-start-rate: 0
[2023-06-20 21:54:20] [config] max-length: 50
[2023-06-20 21:54:20] [config] max-length-crop: false
[2023-06-20 21:54:20] [config] max-length-factor: 3
[2023-06-20 21:54:20] [config] maxi-batch: 100
[2023-06-20 21:54:20] [config] maxi-batch-sort: trg
[2023-06-20 21:54:20] [config] mini-batch: 64
[2023-06-20 21:54:20] [config] mini-batch-fit: true
[2023-06-20 21:54:20] [config] mini-batch-fit-step: 10
[2023-06-20 21:54:20] [config] mini-batch-round-up: true
[2023-06-20 21:54:20] [config] mini-batch-track-lr: false
[2023-06-20 21:54:20] [config] mini-batch-warmup: 0
[2023-06-20 21:54:20] [config] mini-batch-words: 0
[2023-06-20 21:54:20] [config] mini-batch-words-ref: 0
[2023-06-20 21:54:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 21:54:20] [config] multi-loss-type: sum
[2023-06-20 21:54:20] [config] n-best: false
[2023-06-20 21:54:20] [config] no-nccl: false
[2023-06-20 21:54:20] [config] no-reload: false
[2023-06-20 21:54:20] [config] no-restore-corpus: false
[2023-06-20 21:54:20] [config] normalize: 0
[2023-06-20 21:54:20] [config] normalize-gradient: false
[2023-06-20 21:54:20] [config] num-devices: 0
[2023-06-20 21:54:20] [config] optimizer: adam
[2023-06-20 21:54:20] [config] optimizer-delay: 1
[2023-06-20 21:54:20] [config] optimizer-params:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] output-omit-bias: false
[2023-06-20 21:54:20] [config] overwrite: false
[2023-06-20 21:54:20] [config] precision:
[2023-06-20 21:54:20] [config]   - float32
[2023-06-20 21:54:20] [config]   - float32
[2023-06-20 21:54:20] [config] pretrained-model: ""
[2023-06-20 21:54:20] [config] quantize-biases: false
[2023-06-20 21:54:20] [config] quantize-bits: 0
[2023-06-20 21:54:20] [config] quantize-log-based: false
[2023-06-20 21:54:20] [config] quantize-optimization-steps: 0
[2023-06-20 21:54:20] [config] quiet: false
[2023-06-20 21:54:20] [config] quiet-translation: true
[2023-06-20 21:54:20] [config] relative-paths: false
[2023-06-20 21:54:20] [config] right-left: false
[2023-06-20 21:54:20] [config] save-freq: 10000u
[2023-06-20 21:54:20] [config] seed: 1234
[2023-06-20 21:54:20] [config] sentencepiece-alphas:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] sentencepiece-max-lines: 2000000
[2023-06-20 21:54:20] [config] sentencepiece-options: ""
[2023-06-20 21:54:20] [config] sharding: global
[2023-06-20 21:54:20] [config] shuffle: data
[2023-06-20 21:54:20] [config] shuffle-in-ram: false
[2023-06-20 21:54:20] [config] sigterm: save-and-exit
[2023-06-20 21:54:20] [config] skip: false
[2023-06-20 21:54:20] [config] sqlite: ""
[2023-06-20 21:54:20] [config] sqlite-drop: false
[2023-06-20 21:54:20] [config] sync-freq: 200u
[2023-06-20 21:54:20] [config] sync-sgd: false
[2023-06-20 21:54:20] [config] tempdir: /tmp
[2023-06-20 21:54:20] [config] tied-embeddings: false
[2023-06-20 21:54:20] [config] tied-embeddings-all: false
[2023-06-20 21:54:20] [config] tied-embeddings-src: false
[2023-06-20 21:54:20] [config] train-embedder-rank:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] train-sets:
[2023-06-20 21:54:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 21:54:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 21:54:20] [config] transformer-aan-activation: swish
[2023-06-20 21:54:20] [config] transformer-aan-depth: 2
[2023-06-20 21:54:20] [config] transformer-aan-nogate: false
[2023-06-20 21:54:20] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 21:54:20] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 21:54:20] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 21:54:20] [config] transformer-depth-scaling: false
[2023-06-20 21:54:20] [config] transformer-dim-aan: 2048
[2023-06-20 21:54:20] [config] transformer-dim-ffn: 2048
[2023-06-20 21:54:20] [config] transformer-dropout: 0
[2023-06-20 21:54:20] [config] transformer-dropout-attention: 0
[2023-06-20 21:54:20] [config] transformer-dropout-ffn: 0
[2023-06-20 21:54:20] [config] transformer-ffn-activation: swish
[2023-06-20 21:54:20] [config] transformer-ffn-depth: 2
[2023-06-20 21:54:20] [config] transformer-guided-alignment-layer: last
[2023-06-20 21:54:20] [config] transformer-heads: 8
[2023-06-20 21:54:20] [config] transformer-no-projection: false
[2023-06-20 21:54:20] [config] transformer-pool: false
[2023-06-20 21:54:20] [config] transformer-postprocess: dan
[2023-06-20 21:54:20] [config] transformer-postprocess-emb: d
[2023-06-20 21:54:20] [config] transformer-postprocess-top: ""
[2023-06-20 21:54:20] [config] transformer-preprocess: ""
[2023-06-20 21:54:20] [config] transformer-tied-layers:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] transformer-train-position-embeddings: false
[2023-06-20 21:54:20] [config] tsv: false
[2023-06-20 21:54:20] [config] tsv-fields: 0
[2023-06-20 21:54:20] [config] type: amun
[2023-06-20 21:54:20] [config] ulr: false
[2023-06-20 21:54:20] [config] ulr-dim-emb: 0
[2023-06-20 21:54:20] [config] ulr-dropout: 0
[2023-06-20 21:54:20] [config] ulr-keys-vectors: ""
[2023-06-20 21:54:20] [config] ulr-query-vectors: ""
[2023-06-20 21:54:20] [config] ulr-softmax-temperature: 1
[2023-06-20 21:54:20] [config] ulr-trainable-transformation: false
[2023-06-20 21:54:20] [config] unlikelihood-loss: false
[2023-06-20 21:54:20] [config] valid-freq: 5000000
[2023-06-20 21:54:20] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 21:54:20] [config] valid-max-length: 1000
[2023-06-20 21:54:20] [config] valid-metrics:
[2023-06-20 21:54:20] [config]   - cross-entropy
[2023-06-20 21:54:20] [config] valid-mini-batch: 32
[2023-06-20 21:54:20] [config] valid-reset-stalled: false
[2023-06-20 21:54:20] [config] valid-script-args:
[2023-06-20 21:54:20] [config]   []
[2023-06-20 21:54:20] [config] valid-script-path: ""
[2023-06-20 21:54:20] [config] valid-sets:
[2023-06-20 21:54:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 21:54:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 21:54:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 21:54:20] [config] vocabs:
[2023-06-20 21:54:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 21:54:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 21:54:20] [config] word-penalty: 0
[2023-06-20 21:54:20] [config] word-scores: false
[2023-06-20 21:54:20] [config] workspace: 3000
[2023-06-20 21:54:20] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 21:54:20] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 21:54:20] [training] Using single-device training
[2023-06-20 21:54:21] Synced seed 1234
[2023-06-20 21:54:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 21:54:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 21:54:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 21:54:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 21:54:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 21:54:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 21:54:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 21:54:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 21:54:23] [comm] Using global sharding
[2023-06-20 21:54:24] [comm] NCCLCommunicators constructed successfully
[2023-06-20 21:54:24] [training] Using 1 GPUs
[2023-06-20 21:54:24] [logits] Applying loss function for 1 factor(s)
[2023-06-20 21:54:24] [memory] Reserving 377 MB, device gpu0
[2023-06-20 21:54:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 21:54:29] [memory] Reserving 377 MB, device gpu0
[2023-06-20 21:54:41] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 21:54:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 21:54:41] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 21:54:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 21:54:41] [comm] Using global sharding
[2023-06-20 21:54:41] [comm] NCCLCommunicators constructed successfully
[2023-06-20 21:54:41] [training] Using 1 GPUs
[2023-06-20 21:54:41] Training started
[2023-06-20 21:54:41] [data] Shuffling data
[2023-06-20 21:54:41] [data] Done reading 20,192 sentences
[2023-06-20 21:54:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:54:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 21:54:41] [memory] Reserving 377 MB, device gpu0
[2023-06-20 21:54:41] [memory] Reserving 377 MB, device gpu0
[2023-06-20 21:54:41] Parameter type float32, optimization type float32, casting types false
[2023-06-20 21:54:41] Allocating memory for Adam-specific shards
[2023-06-20 21:54:41] [memory] Reserving 754 MB, device gpu0
[2023-06-20 21:55:20] Seen 18,843 samples
[2023-06-20 21:55:20] Starting data epoch 2 in logical epoch 2
[2023-06-20 21:55:20] [data] Shuffling data
[2023-06-20 21:55:20] [data] Done reading 20,192 sentences
[2023-06-20 21:55:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:55:58] Seen 18,843 samples
[2023-06-20 21:55:58] Starting data epoch 3 in logical epoch 3
[2023-06-20 21:55:58] [data] Shuffling data
[2023-06-20 21:55:58] [data] Done reading 20,192 sentences
[2023-06-20 21:55:58] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:56:37] Seen 18,843 samples
[2023-06-20 21:56:37] Starting data epoch 4 in logical epoch 4
[2023-06-20 21:56:37] [data] Shuffling data
[2023-06-20 21:56:37] [data] Done reading 20,192 sentences
[2023-06-20 21:56:37] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:57:16] Seen 18,843 samples
[2023-06-20 21:57:16] Starting data epoch 5 in logical epoch 5
[2023-06-20 21:57:16] [data] Shuffling data
[2023-06-20 21:57:16] [data] Done reading 20,192 sentences
[2023-06-20 21:57:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:57:59] Seen 18,843 samples
[2023-06-20 21:57:59] Starting data epoch 6 in logical epoch 6
[2023-06-20 21:57:59] [data] Shuffling data
[2023-06-20 21:57:59] [data] Done reading 20,192 sentences
[2023-06-20 21:57:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:58:43] Seen 18,843 samples
[2023-06-20 21:58:43] Starting data epoch 7 in logical epoch 7
[2023-06-20 21:58:43] [data] Shuffling data
[2023-06-20 21:58:43] [data] Done reading 20,192 sentences
[2023-06-20 21:58:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 21:59:27] Seen 18,843 samples
[2023-06-20 21:59:27] Starting data epoch 8 in logical epoch 8
[2023-06-20 21:59:27] [data] Shuffling data
[2023-06-20 21:59:27] [data] Done reading 20,192 sentences
[2023-06-20 21:59:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:00:13] Seen 18,843 samples
[2023-06-20 22:00:13] Starting data epoch 9 in logical epoch 9
[2023-06-20 22:00:13] [data] Shuffling data
[2023-06-20 22:00:13] [data] Done reading 20,192 sentences
[2023-06-20 22:00:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:00:30] Ep. 9 : Up. 1000 : Sen. 6,490 : Cost 5.43062353 * 3,327,694 @ 4,713 after 3,327,694 : Time 349.02s : 9534.29 words/s : gNorm 1.2498
[2023-06-20 22:00:59] Seen 18,843 samples
[2023-06-20 22:00:59] Starting data epoch 10 in logical epoch 10
[2023-06-20 22:00:59] [data] Shuffling data
[2023-06-20 22:00:59] [data] Done reading 20,192 sentences
[2023-06-20 22:00:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:01:44] Seen 18,843 samples
[2023-06-20 22:01:44] Starting data epoch 11 in logical epoch 11
[2023-06-20 22:01:44] Training finished
[2023-06-20 22:01:50] [valid] Ep. 11 : Up. 1197 : cross-entropy : 99.6796 : new best
[2023-06-20 22:01:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:01:56] Saving Adam parameters
[2023-06-20 22:01:57] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:07:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:07:12] [marian] Running on node17.datos.cluster.uy as process 30908 with command line:
[2023-06-20 22:07:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 20 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 22:07:12] [config] after: 0e
[2023-06-20 22:07:12] [config] after-batches: 0
[2023-06-20 22:07:12] [config] after-epochs: 20
[2023-06-20 22:07:12] [config] all-caps-every: 0
[2023-06-20 22:07:12] [config] allow-unk: false
[2023-06-20 22:07:12] [config] authors: false
[2023-06-20 22:07:12] [config] beam-size: 12
[2023-06-20 22:07:12] [config] bert-class-symbol: "[CLS]"
[2023-06-20 22:07:12] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 22:07:12] [config] bert-masking-fraction: 0.15
[2023-06-20 22:07:12] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 22:07:12] [config] bert-train-type-embeddings: true
[2023-06-20 22:07:12] [config] bert-type-vocab-size: 2
[2023-06-20 22:07:12] [config] build-info: ""
[2023-06-20 22:07:12] [config] check-gradient-nan: false
[2023-06-20 22:07:12] [config] check-nan: false
[2023-06-20 22:07:12] [config] cite: false
[2023-06-20 22:07:12] [config] clip-norm: 1
[2023-06-20 22:07:12] [config] cost-scaling:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] cost-type: ce-sum
[2023-06-20 22:07:12] [config] cpu-threads: 0
[2023-06-20 22:07:12] [config] data-threads: 8
[2023-06-20 22:07:12] [config] data-weighting: ""
[2023-06-20 22:07:12] [config] data-weighting-type: sentence
[2023-06-20 22:07:12] [config] dec-cell: gru
[2023-06-20 22:07:12] [config] dec-cell-base-depth: 2
[2023-06-20 22:07:12] [config] dec-cell-high-depth: 1
[2023-06-20 22:07:12] [config] dec-depth: 1
[2023-06-20 22:07:12] [config] devices:
[2023-06-20 22:07:12] [config]   - 0
[2023-06-20 22:07:12] [config] dim-emb: 512
[2023-06-20 22:07:12] [config] dim-rnn: 1024
[2023-06-20 22:07:12] [config] dim-vocabs:
[2023-06-20 22:07:12] [config]   - 54042
[2023-06-20 22:07:12] [config]   - 36507
[2023-06-20 22:07:12] [config] disp-first: 0
[2023-06-20 22:07:12] [config] disp-freq: 1000u
[2023-06-20 22:07:12] [config] disp-label-counts: true
[2023-06-20 22:07:12] [config] dropout-rnn: 0.2
[2023-06-20 22:07:12] [config] dropout-src: 0.1
[2023-06-20 22:07:12] [config] dropout-trg: 0.1
[2023-06-20 22:07:12] [config] dump-config: ""
[2023-06-20 22:07:12] [config] dynamic-gradient-scaling:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] early-stopping: 5
[2023-06-20 22:07:12] [config] early-stopping-on: first
[2023-06-20 22:07:12] [config] embedding-fix-src: false
[2023-06-20 22:07:12] [config] embedding-fix-trg: false
[2023-06-20 22:07:12] [config] embedding-normalization: false
[2023-06-20 22:07:12] [config] embedding-vectors:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] enc-cell: gru
[2023-06-20 22:07:12] [config] enc-cell-depth: 1
[2023-06-20 22:07:12] [config] enc-depth: 1
[2023-06-20 22:07:12] [config] enc-type: bidirectional
[2023-06-20 22:07:12] [config] english-title-case-every: 0
[2023-06-20 22:07:12] [config] exponential-smoothing: 0
[2023-06-20 22:07:12] [config] factor-weight: 1
[2023-06-20 22:07:12] [config] factors-combine: sum
[2023-06-20 22:07:12] [config] factors-dim-emb: 0
[2023-06-20 22:07:12] [config] gradient-checkpointing: false
[2023-06-20 22:07:12] [config] gradient-norm-average-window: 100
[2023-06-20 22:07:12] [config] guided-alignment: none
[2023-06-20 22:07:12] [config] guided-alignment-cost: mse
[2023-06-20 22:07:12] [config] guided-alignment-weight: 0.1
[2023-06-20 22:07:12] [config] ignore-model-config: false
[2023-06-20 22:07:12] [config] input-types:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] interpolate-env-vars: false
[2023-06-20 22:07:12] [config] keep-best: false
[2023-06-20 22:07:12] [config] label-smoothing: 0
[2023-06-20 22:07:12] [config] layer-normalization: true
[2023-06-20 22:07:12] [config] learn-rate: 0.0001
[2023-06-20 22:07:12] [config] lemma-dependency: ""
[2023-06-20 22:07:12] [config] lemma-dim-emb: 0
[2023-06-20 22:07:12] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 22:07:12] [config] log-level: info
[2023-06-20 22:07:12] [config] log-time-zone: ""
[2023-06-20 22:07:12] [config] logical-epoch:
[2023-06-20 22:07:12] [config]   - 1e
[2023-06-20 22:07:12] [config]   - 0
[2023-06-20 22:07:12] [config] lr-decay: 0
[2023-06-20 22:07:12] [config] lr-decay-freq: 50000
[2023-06-20 22:07:12] [config] lr-decay-inv-sqrt:
[2023-06-20 22:07:12] [config]   - 0
[2023-06-20 22:07:12] [config] lr-decay-repeat-warmup: false
[2023-06-20 22:07:12] [config] lr-decay-reset-optimizer: false
[2023-06-20 22:07:12] [config] lr-decay-start:
[2023-06-20 22:07:12] [config]   - 10
[2023-06-20 22:07:12] [config]   - 1
[2023-06-20 22:07:12] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 22:07:12] [config] lr-report: false
[2023-06-20 22:07:12] [config] lr-warmup: 0
[2023-06-20 22:07:12] [config] lr-warmup-at-reload: false
[2023-06-20 22:07:12] [config] lr-warmup-cycle: false
[2023-06-20 22:07:12] [config] lr-warmup-start-rate: 0
[2023-06-20 22:07:12] [config] max-length: 50
[2023-06-20 22:07:12] [config] max-length-crop: false
[2023-06-20 22:07:12] [config] max-length-factor: 3
[2023-06-20 22:07:12] [config] maxi-batch: 100
[2023-06-20 22:07:12] [config] maxi-batch-sort: trg
[2023-06-20 22:07:12] [config] mini-batch: 64
[2023-06-20 22:07:12] [config] mini-batch-fit: true
[2023-06-20 22:07:12] [config] mini-batch-fit-step: 10
[2023-06-20 22:07:12] [config] mini-batch-round-up: true
[2023-06-20 22:07:12] [config] mini-batch-track-lr: false
[2023-06-20 22:07:12] [config] mini-batch-warmup: 0
[2023-06-20 22:07:12] [config] mini-batch-words: 0
[2023-06-20 22:07:12] [config] mini-batch-words-ref: 0
[2023-06-20 22:07:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:07:12] [config] multi-loss-type: sum
[2023-06-20 22:07:12] [config] n-best: false
[2023-06-20 22:07:12] [config] no-nccl: false
[2023-06-20 22:07:12] [config] no-reload: false
[2023-06-20 22:07:12] [config] no-restore-corpus: false
[2023-06-20 22:07:12] [config] normalize: 0
[2023-06-20 22:07:12] [config] normalize-gradient: false
[2023-06-20 22:07:12] [config] num-devices: 0
[2023-06-20 22:07:12] [config] optimizer: adam
[2023-06-20 22:07:12] [config] optimizer-delay: 1
[2023-06-20 22:07:12] [config] optimizer-params:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] output-omit-bias: false
[2023-06-20 22:07:12] [config] overwrite: false
[2023-06-20 22:07:12] [config] precision:
[2023-06-20 22:07:12] [config]   - float32
[2023-06-20 22:07:12] [config]   - float32
[2023-06-20 22:07:12] [config] pretrained-model: ""
[2023-06-20 22:07:12] [config] quantize-biases: false
[2023-06-20 22:07:12] [config] quantize-bits: 0
[2023-06-20 22:07:12] [config] quantize-log-based: false
[2023-06-20 22:07:12] [config] quantize-optimization-steps: 0
[2023-06-20 22:07:12] [config] quiet: false
[2023-06-20 22:07:12] [config] quiet-translation: true
[2023-06-20 22:07:12] [config] relative-paths: false
[2023-06-20 22:07:12] [config] right-left: false
[2023-06-20 22:07:12] [config] save-freq: 10000u
[2023-06-20 22:07:12] [config] seed: 1234
[2023-06-20 22:07:12] [config] sentencepiece-alphas:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] sentencepiece-max-lines: 2000000
[2023-06-20 22:07:12] [config] sentencepiece-options: ""
[2023-06-20 22:07:12] [config] sharding: global
[2023-06-20 22:07:12] [config] shuffle: data
[2023-06-20 22:07:12] [config] shuffle-in-ram: false
[2023-06-20 22:07:12] [config] sigterm: save-and-exit
[2023-06-20 22:07:12] [config] skip: false
[2023-06-20 22:07:12] [config] sqlite: ""
[2023-06-20 22:07:12] [config] sqlite-drop: false
[2023-06-20 22:07:12] [config] sync-freq: 200u
[2023-06-20 22:07:12] [config] sync-sgd: false
[2023-06-20 22:07:12] [config] tempdir: /tmp
[2023-06-20 22:07:12] [config] tied-embeddings: false
[2023-06-20 22:07:12] [config] tied-embeddings-all: false
[2023-06-20 22:07:12] [config] tied-embeddings-src: false
[2023-06-20 22:07:12] [config] train-embedder-rank:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] train-sets:
[2023-06-20 22:07:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 22:07:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 22:07:12] [config] transformer-aan-activation: swish
[2023-06-20 22:07:12] [config] transformer-aan-depth: 2
[2023-06-20 22:07:12] [config] transformer-aan-nogate: false
[2023-06-20 22:07:12] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 22:07:12] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 22:07:12] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 22:07:12] [config] transformer-depth-scaling: false
[2023-06-20 22:07:12] [config] transformer-dim-aan: 2048
[2023-06-20 22:07:12] [config] transformer-dim-ffn: 2048
[2023-06-20 22:07:12] [config] transformer-dropout: 0
[2023-06-20 22:07:12] [config] transformer-dropout-attention: 0
[2023-06-20 22:07:12] [config] transformer-dropout-ffn: 0
[2023-06-20 22:07:12] [config] transformer-ffn-activation: swish
[2023-06-20 22:07:12] [config] transformer-ffn-depth: 2
[2023-06-20 22:07:12] [config] transformer-guided-alignment-layer: last
[2023-06-20 22:07:12] [config] transformer-heads: 8
[2023-06-20 22:07:12] [config] transformer-no-projection: false
[2023-06-20 22:07:12] [config] transformer-pool: false
[2023-06-20 22:07:12] [config] transformer-postprocess: dan
[2023-06-20 22:07:12] [config] transformer-postprocess-emb: d
[2023-06-20 22:07:12] [config] transformer-postprocess-top: ""
[2023-06-20 22:07:12] [config] transformer-preprocess: ""
[2023-06-20 22:07:12] [config] transformer-tied-layers:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] transformer-train-position-embeddings: false
[2023-06-20 22:07:12] [config] tsv: false
[2023-06-20 22:07:12] [config] tsv-fields: 0
[2023-06-20 22:07:12] [config] type: amun
[2023-06-20 22:07:12] [config] ulr: false
[2023-06-20 22:07:12] [config] ulr-dim-emb: 0
[2023-06-20 22:07:12] [config] ulr-dropout: 0
[2023-06-20 22:07:12] [config] ulr-keys-vectors: ""
[2023-06-20 22:07:12] [config] ulr-query-vectors: ""
[2023-06-20 22:07:12] [config] ulr-softmax-temperature: 1
[2023-06-20 22:07:12] [config] ulr-trainable-transformation: false
[2023-06-20 22:07:12] [config] unlikelihood-loss: false
[2023-06-20 22:07:12] [config] valid-freq: 5000000
[2023-06-20 22:07:12] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 22:07:12] [config] valid-max-length: 1000
[2023-06-20 22:07:12] [config] valid-metrics:
[2023-06-20 22:07:12] [config]   - cross-entropy
[2023-06-20 22:07:12] [config] valid-mini-batch: 32
[2023-06-20 22:07:12] [config] valid-reset-stalled: false
[2023-06-20 22:07:12] [config] valid-script-args:
[2023-06-20 22:07:12] [config]   []
[2023-06-20 22:07:12] [config] valid-script-path: ""
[2023-06-20 22:07:12] [config] valid-sets:
[2023-06-20 22:07:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 22:07:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 22:07:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 22:07:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:07:12] [config] vocabs:
[2023-06-20 22:07:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:07:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:07:12] [config] word-penalty: 0
[2023-06-20 22:07:12] [config] word-scores: false
[2023-06-20 22:07:12] [config] workspace: 3000
[2023-06-20 22:07:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:07:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:07:12] [training] Using single-device training
[2023-06-20 22:07:13] Synced seed 1234
[2023-06-20 22:07:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:07:13] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 22:07:13] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:07:13] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 22:07:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 22:07:13] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:07:14] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:07:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:07:14] [comm] Using global sharding
[2023-06-20 22:07:15] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:07:15] [training] Using 1 GPUs
[2023-06-20 22:07:15] [logits] Applying loss function for 1 factor(s)
[2023-06-20 22:07:15] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:07:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 22:07:15] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:07:28] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 22:07:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:07:28] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:07:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:07:28] [comm] Using global sharding
[2023-06-20 22:07:28] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:07:28] [training] Using 1 GPUs
[2023-06-20 22:07:28] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:07:31] Loading Adam parameters
[2023-06-20 22:07:31] [memory] Reserving 754 MB, device gpu0
[2023-06-20 22:07:31] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:07:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:07:31] [data] Restoring the corpus state to epoch 11, batch 1197
[2023-06-20 22:07:31] [data] Shuffling data
[2023-06-20 22:07:31] [data] Done reading 20,192 sentences
[2023-06-20 22:07:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:07:32] Training started
[2023-06-20 22:07:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 22:07:32] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:07:32] Parameter type float32, optimization type float32, casting types false
[2023-06-20 22:08:17] Seen 18,843 samples
[2023-06-20 22:08:17] Starting data epoch 12 in logical epoch 12
[2023-06-20 22:08:17] [data] Shuffling data
[2023-06-20 22:08:17] [data] Done reading 20,192 sentences
[2023-06-20 22:08:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:09:03] Seen 18,843 samples
[2023-06-20 22:09:03] Starting data epoch 13 in logical epoch 13
[2023-06-20 22:09:03] [data] Shuffling data
[2023-06-20 22:09:03] [data] Done reading 20,192 sentences
[2023-06-20 22:09:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:09:49] Seen 18,843 samples
[2023-06-20 22:09:49] Starting data epoch 14 in logical epoch 14
[2023-06-20 22:09:49] [data] Shuffling data
[2023-06-20 22:09:49] [data] Done reading 20,192 sentences
[2023-06-20 22:09:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:10:35] Seen 18,843 samples
[2023-06-20 22:10:35] Starting data epoch 15 in logical epoch 15
[2023-06-20 22:10:35] [data] Shuffling data
[2023-06-20 22:10:35] [data] Done reading 20,192 sentences
[2023-06-20 22:10:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:11:21] Seen 18,843 samples
[2023-06-20 22:11:21] Starting data epoch 16 in logical epoch 16
[2023-06-20 22:11:21] [data] Shuffling data
[2023-06-20 22:11:21] [data] Done reading 20,192 sentences
[2023-06-20 22:11:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:12:07] Seen 18,843 samples
[2023-06-20 22:12:07] Starting data epoch 17 in logical epoch 17
[2023-06-20 22:12:07] [data] Shuffling data
[2023-06-20 22:12:07] [data] Done reading 20,192 sentences
[2023-06-20 22:12:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:12:38] Ep. 17 : Up. 2000 : Sen. 13,087 : Cost 3.92532420 * 3,311,687 @ 1,013 after 6,639,381 : Time 309.83s : 10688.86 words/s : gNorm 1.3609
[2023-06-20 22:12:53] Seen 18,843 samples
[2023-06-20 22:12:53] Starting data epoch 18 in logical epoch 18
[2023-06-20 22:12:53] [data] Shuffling data
[2023-06-20 22:12:53] [data] Done reading 20,192 sentences
[2023-06-20 22:12:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:13:39] Seen 18,843 samples
[2023-06-20 22:13:40] Starting data epoch 19 in logical epoch 19
[2023-06-20 22:13:40] [data] Shuffling data
[2023-06-20 22:13:40] [data] Done reading 20,192 sentences
[2023-06-20 22:13:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:14:26] Seen 18,843 samples
[2023-06-20 22:14:26] Starting data epoch 20 in logical epoch 20
[2023-06-20 22:14:26] [data] Shuffling data
[2023-06-20 22:14:26] [data] Done reading 20,192 sentences
[2023-06-20 22:14:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:15:12] Seen 18,843 samples
[2023-06-20 22:15:12] Starting data epoch 21 in logical epoch 21
[2023-06-20 22:15:12] Training finished
[2023-06-20 22:15:18] [valid] Ep. 21 : Up. 2399 : cross-entropy : 91.8148 : new best
[2023-06-20 22:15:19] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:15:24] Saving Adam parameters
[2023-06-20 22:15:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:20:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:20:24] [marian] Running on node17.datos.cluster.uy as process 31667 with command line:
[2023-06-20 22:20:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 30 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 22:20:24] [config] after: 0e
[2023-06-20 22:20:24] [config] after-batches: 0
[2023-06-20 22:20:24] [config] after-epochs: 30
[2023-06-20 22:20:24] [config] all-caps-every: 0
[2023-06-20 22:20:24] [config] allow-unk: false
[2023-06-20 22:20:24] [config] authors: false
[2023-06-20 22:20:24] [config] beam-size: 12
[2023-06-20 22:20:24] [config] bert-class-symbol: "[CLS]"
[2023-06-20 22:20:24] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 22:20:24] [config] bert-masking-fraction: 0.15
[2023-06-20 22:20:24] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 22:20:24] [config] bert-train-type-embeddings: true
[2023-06-20 22:20:24] [config] bert-type-vocab-size: 2
[2023-06-20 22:20:24] [config] build-info: ""
[2023-06-20 22:20:24] [config] check-gradient-nan: false
[2023-06-20 22:20:24] [config] check-nan: false
[2023-06-20 22:20:24] [config] cite: false
[2023-06-20 22:20:24] [config] clip-norm: 1
[2023-06-20 22:20:24] [config] cost-scaling:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] cost-type: ce-sum
[2023-06-20 22:20:24] [config] cpu-threads: 0
[2023-06-20 22:20:24] [config] data-threads: 8
[2023-06-20 22:20:24] [config] data-weighting: ""
[2023-06-20 22:20:24] [config] data-weighting-type: sentence
[2023-06-20 22:20:24] [config] dec-cell: gru
[2023-06-20 22:20:24] [config] dec-cell-base-depth: 2
[2023-06-20 22:20:24] [config] dec-cell-high-depth: 1
[2023-06-20 22:20:24] [config] dec-depth: 1
[2023-06-20 22:20:24] [config] devices:
[2023-06-20 22:20:24] [config]   - 0
[2023-06-20 22:20:24] [config] dim-emb: 512
[2023-06-20 22:20:24] [config] dim-rnn: 1024
[2023-06-20 22:20:24] [config] dim-vocabs:
[2023-06-20 22:20:24] [config]   - 54042
[2023-06-20 22:20:24] [config]   - 36507
[2023-06-20 22:20:24] [config] disp-first: 0
[2023-06-20 22:20:24] [config] disp-freq: 1000u
[2023-06-20 22:20:24] [config] disp-label-counts: true
[2023-06-20 22:20:24] [config] dropout-rnn: 0.2
[2023-06-20 22:20:24] [config] dropout-src: 0.1
[2023-06-20 22:20:24] [config] dropout-trg: 0.1
[2023-06-20 22:20:24] [config] dump-config: ""
[2023-06-20 22:20:24] [config] dynamic-gradient-scaling:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] early-stopping: 5
[2023-06-20 22:20:24] [config] early-stopping-on: first
[2023-06-20 22:20:24] [config] embedding-fix-src: false
[2023-06-20 22:20:24] [config] embedding-fix-trg: false
[2023-06-20 22:20:24] [config] embedding-normalization: false
[2023-06-20 22:20:24] [config] embedding-vectors:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] enc-cell: gru
[2023-06-20 22:20:24] [config] enc-cell-depth: 1
[2023-06-20 22:20:24] [config] enc-depth: 1
[2023-06-20 22:20:24] [config] enc-type: bidirectional
[2023-06-20 22:20:24] [config] english-title-case-every: 0
[2023-06-20 22:20:24] [config] exponential-smoothing: 0
[2023-06-20 22:20:24] [config] factor-weight: 1
[2023-06-20 22:20:24] [config] factors-combine: sum
[2023-06-20 22:20:24] [config] factors-dim-emb: 0
[2023-06-20 22:20:24] [config] gradient-checkpointing: false
[2023-06-20 22:20:24] [config] gradient-norm-average-window: 100
[2023-06-20 22:20:24] [config] guided-alignment: none
[2023-06-20 22:20:24] [config] guided-alignment-cost: mse
[2023-06-20 22:20:24] [config] guided-alignment-weight: 0.1
[2023-06-20 22:20:24] [config] ignore-model-config: false
[2023-06-20 22:20:24] [config] input-types:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] interpolate-env-vars: false
[2023-06-20 22:20:24] [config] keep-best: false
[2023-06-20 22:20:24] [config] label-smoothing: 0
[2023-06-20 22:20:24] [config] layer-normalization: true
[2023-06-20 22:20:24] [config] learn-rate: 0.0001
[2023-06-20 22:20:24] [config] lemma-dependency: ""
[2023-06-20 22:20:24] [config] lemma-dim-emb: 0
[2023-06-20 22:20:24] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 22:20:24] [config] log-level: info
[2023-06-20 22:20:24] [config] log-time-zone: ""
[2023-06-20 22:20:24] [config] logical-epoch:
[2023-06-20 22:20:24] [config]   - 1e
[2023-06-20 22:20:24] [config]   - 0
[2023-06-20 22:20:24] [config] lr-decay: 0
[2023-06-20 22:20:24] [config] lr-decay-freq: 50000
[2023-06-20 22:20:24] [config] lr-decay-inv-sqrt:
[2023-06-20 22:20:24] [config]   - 0
[2023-06-20 22:20:24] [config] lr-decay-repeat-warmup: false
[2023-06-20 22:20:24] [config] lr-decay-reset-optimizer: false
[2023-06-20 22:20:24] [config] lr-decay-start:
[2023-06-20 22:20:24] [config]   - 10
[2023-06-20 22:20:24] [config]   - 1
[2023-06-20 22:20:24] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 22:20:24] [config] lr-report: false
[2023-06-20 22:20:24] [config] lr-warmup: 0
[2023-06-20 22:20:24] [config] lr-warmup-at-reload: false
[2023-06-20 22:20:24] [config] lr-warmup-cycle: false
[2023-06-20 22:20:24] [config] lr-warmup-start-rate: 0
[2023-06-20 22:20:24] [config] max-length: 50
[2023-06-20 22:20:24] [config] max-length-crop: false
[2023-06-20 22:20:24] [config] max-length-factor: 3
[2023-06-20 22:20:24] [config] maxi-batch: 100
[2023-06-20 22:20:24] [config] maxi-batch-sort: trg
[2023-06-20 22:20:24] [config] mini-batch: 64
[2023-06-20 22:20:24] [config] mini-batch-fit: true
[2023-06-20 22:20:24] [config] mini-batch-fit-step: 10
[2023-06-20 22:20:24] [config] mini-batch-round-up: true
[2023-06-20 22:20:24] [config] mini-batch-track-lr: false
[2023-06-20 22:20:24] [config] mini-batch-warmup: 0
[2023-06-20 22:20:24] [config] mini-batch-words: 0
[2023-06-20 22:20:24] [config] mini-batch-words-ref: 0
[2023-06-20 22:20:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:20:24] [config] multi-loss-type: sum
[2023-06-20 22:20:24] [config] n-best: false
[2023-06-20 22:20:24] [config] no-nccl: false
[2023-06-20 22:20:24] [config] no-reload: false
[2023-06-20 22:20:24] [config] no-restore-corpus: false
[2023-06-20 22:20:24] [config] normalize: 0
[2023-06-20 22:20:24] [config] normalize-gradient: false
[2023-06-20 22:20:24] [config] num-devices: 0
[2023-06-20 22:20:24] [config] optimizer: adam
[2023-06-20 22:20:24] [config] optimizer-delay: 1
[2023-06-20 22:20:24] [config] optimizer-params:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] output-omit-bias: false
[2023-06-20 22:20:24] [config] overwrite: false
[2023-06-20 22:20:24] [config] precision:
[2023-06-20 22:20:24] [config]   - float32
[2023-06-20 22:20:24] [config]   - float32
[2023-06-20 22:20:24] [config] pretrained-model: ""
[2023-06-20 22:20:24] [config] quantize-biases: false
[2023-06-20 22:20:24] [config] quantize-bits: 0
[2023-06-20 22:20:24] [config] quantize-log-based: false
[2023-06-20 22:20:24] [config] quantize-optimization-steps: 0
[2023-06-20 22:20:24] [config] quiet: false
[2023-06-20 22:20:24] [config] quiet-translation: true
[2023-06-20 22:20:24] [config] relative-paths: false
[2023-06-20 22:20:24] [config] right-left: false
[2023-06-20 22:20:24] [config] save-freq: 10000u
[2023-06-20 22:20:24] [config] seed: 1234
[2023-06-20 22:20:24] [config] sentencepiece-alphas:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] sentencepiece-max-lines: 2000000
[2023-06-20 22:20:24] [config] sentencepiece-options: ""
[2023-06-20 22:20:24] [config] sharding: global
[2023-06-20 22:20:24] [config] shuffle: data
[2023-06-20 22:20:24] [config] shuffle-in-ram: false
[2023-06-20 22:20:24] [config] sigterm: save-and-exit
[2023-06-20 22:20:24] [config] skip: false
[2023-06-20 22:20:24] [config] sqlite: ""
[2023-06-20 22:20:24] [config] sqlite-drop: false
[2023-06-20 22:20:24] [config] sync-freq: 200u
[2023-06-20 22:20:24] [config] sync-sgd: false
[2023-06-20 22:20:24] [config] tempdir: /tmp
[2023-06-20 22:20:24] [config] tied-embeddings: false
[2023-06-20 22:20:24] [config] tied-embeddings-all: false
[2023-06-20 22:20:24] [config] tied-embeddings-src: false
[2023-06-20 22:20:24] [config] train-embedder-rank:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] train-sets:
[2023-06-20 22:20:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 22:20:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 22:20:24] [config] transformer-aan-activation: swish
[2023-06-20 22:20:24] [config] transformer-aan-depth: 2
[2023-06-20 22:20:24] [config] transformer-aan-nogate: false
[2023-06-20 22:20:24] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 22:20:24] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 22:20:24] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 22:20:24] [config] transformer-depth-scaling: false
[2023-06-20 22:20:24] [config] transformer-dim-aan: 2048
[2023-06-20 22:20:24] [config] transformer-dim-ffn: 2048
[2023-06-20 22:20:24] [config] transformer-dropout: 0
[2023-06-20 22:20:24] [config] transformer-dropout-attention: 0
[2023-06-20 22:20:24] [config] transformer-dropout-ffn: 0
[2023-06-20 22:20:24] [config] transformer-ffn-activation: swish
[2023-06-20 22:20:24] [config] transformer-ffn-depth: 2
[2023-06-20 22:20:24] [config] transformer-guided-alignment-layer: last
[2023-06-20 22:20:24] [config] transformer-heads: 8
[2023-06-20 22:20:24] [config] transformer-no-projection: false
[2023-06-20 22:20:24] [config] transformer-pool: false
[2023-06-20 22:20:24] [config] transformer-postprocess: dan
[2023-06-20 22:20:24] [config] transformer-postprocess-emb: d
[2023-06-20 22:20:24] [config] transformer-postprocess-top: ""
[2023-06-20 22:20:24] [config] transformer-preprocess: ""
[2023-06-20 22:20:24] [config] transformer-tied-layers:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] transformer-train-position-embeddings: false
[2023-06-20 22:20:24] [config] tsv: false
[2023-06-20 22:20:24] [config] tsv-fields: 0
[2023-06-20 22:20:24] [config] type: amun
[2023-06-20 22:20:24] [config] ulr: false
[2023-06-20 22:20:24] [config] ulr-dim-emb: 0
[2023-06-20 22:20:24] [config] ulr-dropout: 0
[2023-06-20 22:20:24] [config] ulr-keys-vectors: ""
[2023-06-20 22:20:24] [config] ulr-query-vectors: ""
[2023-06-20 22:20:24] [config] ulr-softmax-temperature: 1
[2023-06-20 22:20:24] [config] ulr-trainable-transformation: false
[2023-06-20 22:20:24] [config] unlikelihood-loss: false
[2023-06-20 22:20:24] [config] valid-freq: 5000000
[2023-06-20 22:20:24] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 22:20:24] [config] valid-max-length: 1000
[2023-06-20 22:20:24] [config] valid-metrics:
[2023-06-20 22:20:24] [config]   - cross-entropy
[2023-06-20 22:20:24] [config] valid-mini-batch: 32
[2023-06-20 22:20:24] [config] valid-reset-stalled: false
[2023-06-20 22:20:24] [config] valid-script-args:
[2023-06-20 22:20:24] [config]   []
[2023-06-20 22:20:24] [config] valid-script-path: ""
[2023-06-20 22:20:24] [config] valid-sets:
[2023-06-20 22:20:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 22:20:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 22:20:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 22:20:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:20:24] [config] vocabs:
[2023-06-20 22:20:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:20:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:20:24] [config] word-penalty: 0
[2023-06-20 22:20:24] [config] word-scores: false
[2023-06-20 22:20:24] [config] workspace: 3000
[2023-06-20 22:20:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:20:24] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:20:24] [training] Using single-device training
[2023-06-20 22:20:24] Synced seed 1234
[2023-06-20 22:20:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:20:24] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 22:20:24] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:20:24] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 22:20:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 22:20:24] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:20:25] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:20:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:20:25] [comm] Using global sharding
[2023-06-20 22:20:26] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:20:26] [training] Using 1 GPUs
[2023-06-20 22:20:26] [logits] Applying loss function for 1 factor(s)
[2023-06-20 22:20:26] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:20:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 22:20:26] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:20:39] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 22:20:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:20:39] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:20:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:20:39] [comm] Using global sharding
[2023-06-20 22:20:39] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:20:39] [training] Using 1 GPUs
[2023-06-20 22:20:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:20:42] Loading Adam parameters
[2023-06-20 22:20:42] [memory] Reserving 754 MB, device gpu0
[2023-06-20 22:20:42] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:20:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:20:42] [data] Restoring the corpus state to epoch 21, batch 2399
[2023-06-20 22:20:42] [data] Shuffling data
[2023-06-20 22:20:42] [data] Done reading 20,192 sentences
[2023-06-20 22:20:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:20:42] Training started
[2023-06-20 22:20:42] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 22:20:43] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:20:43] Parameter type float32, optimization type float32, casting types false
[2023-06-20 22:21:27] Seen 18,843 samples
[2023-06-20 22:21:27] Starting data epoch 22 in logical epoch 22
[2023-06-20 22:21:27] [data] Shuffling data
[2023-06-20 22:21:27] [data] Done reading 20,192 sentences
[2023-06-20 22:21:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:22:13] Seen 18,843 samples
[2023-06-20 22:22:13] Starting data epoch 23 in logical epoch 23
[2023-06-20 22:22:13] [data] Shuffling data
[2023-06-20 22:22:13] [data] Done reading 20,192 sentences
[2023-06-20 22:22:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:22:59] Seen 18,843 samples
[2023-06-20 22:22:59] Starting data epoch 24 in logical epoch 24
[2023-06-20 22:22:59] [data] Shuffling data
[2023-06-20 22:22:59] [data] Done reading 20,192 sentences
[2023-06-20 22:22:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:23:45] Seen 18,843 samples
[2023-06-20 22:23:45] Starting data epoch 25 in logical epoch 25
[2023-06-20 22:23:45] [data] Shuffling data
[2023-06-20 22:23:45] [data] Done reading 20,192 sentences
[2023-06-20 22:23:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:24:31] Ep. 25 : Up. 3000 : Sen. 18,843 : Cost 2.94155860 * 3,308,219 @ 3,507 after 9,947,600 : Time 231.60s : 14283.93 words/s : gNorm 1.5184
[2023-06-20 22:24:31] Seen 18,843 samples
[2023-06-20 22:24:31] Starting data epoch 26 in logical epoch 26
[2023-06-20 22:24:31] [data] Shuffling data
[2023-06-20 22:24:31] [data] Done reading 20,192 sentences
[2023-06-20 22:24:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:25:17] Seen 18,843 samples
[2023-06-20 22:25:19] Starting data epoch 27 in logical epoch 27
[2023-06-20 22:25:19] [data] Shuffling data
[2023-06-20 22:25:19] [data] Done reading 20,192 sentences
[2023-06-20 22:25:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:26:04] Seen 18,843 samples
[2023-06-20 22:26:04] Starting data epoch 28 in logical epoch 28
[2023-06-20 22:26:04] [data] Shuffling data
[2023-06-20 22:26:04] [data] Done reading 20,192 sentences
[2023-06-20 22:26:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:26:50] Seen 18,843 samples
[2023-06-20 22:26:50] Starting data epoch 29 in logical epoch 29
[2023-06-20 22:26:50] [data] Shuffling data
[2023-06-20 22:26:50] [data] Done reading 20,192 sentences
[2023-06-20 22:26:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:27:36] Seen 18,843 samples
[2023-06-20 22:27:36] Starting data epoch 30 in logical epoch 30
[2023-06-20 22:27:36] [data] Shuffling data
[2023-06-20 22:27:36] [data] Done reading 20,192 sentences
[2023-06-20 22:27:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:28:22] Seen 18,843 samples
[2023-06-20 22:28:22] Starting data epoch 31 in logical epoch 31
[2023-06-20 22:28:22] Training finished
[2023-06-20 22:28:28] [valid] Ep. 31 : Up. 3598 : cross-entropy : 90.9633 : new best
[2023-06-20 22:28:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:28:32] Saving Adam parameters
[2023-06-20 22:28:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:33:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:33:34] [marian] Running on node17.datos.cluster.uy as process 32769 with command line:
[2023-06-20 22:33:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 40 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 22:33:34] [config] after: 0e
[2023-06-20 22:33:34] [config] after-batches: 0
[2023-06-20 22:33:34] [config] after-epochs: 40
[2023-06-20 22:33:34] [config] all-caps-every: 0
[2023-06-20 22:33:34] [config] allow-unk: false
[2023-06-20 22:33:34] [config] authors: false
[2023-06-20 22:33:34] [config] beam-size: 12
[2023-06-20 22:33:34] [config] bert-class-symbol: "[CLS]"
[2023-06-20 22:33:34] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 22:33:34] [config] bert-masking-fraction: 0.15
[2023-06-20 22:33:34] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 22:33:34] [config] bert-train-type-embeddings: true
[2023-06-20 22:33:34] [config] bert-type-vocab-size: 2
[2023-06-20 22:33:34] [config] build-info: ""
[2023-06-20 22:33:34] [config] check-gradient-nan: false
[2023-06-20 22:33:34] [config] check-nan: false
[2023-06-20 22:33:34] [config] cite: false
[2023-06-20 22:33:34] [config] clip-norm: 1
[2023-06-20 22:33:34] [config] cost-scaling:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] cost-type: ce-sum
[2023-06-20 22:33:34] [config] cpu-threads: 0
[2023-06-20 22:33:34] [config] data-threads: 8
[2023-06-20 22:33:34] [config] data-weighting: ""
[2023-06-20 22:33:34] [config] data-weighting-type: sentence
[2023-06-20 22:33:34] [config] dec-cell: gru
[2023-06-20 22:33:34] [config] dec-cell-base-depth: 2
[2023-06-20 22:33:34] [config] dec-cell-high-depth: 1
[2023-06-20 22:33:34] [config] dec-depth: 1
[2023-06-20 22:33:34] [config] devices:
[2023-06-20 22:33:34] [config]   - 0
[2023-06-20 22:33:34] [config] dim-emb: 512
[2023-06-20 22:33:34] [config] dim-rnn: 1024
[2023-06-20 22:33:34] [config] dim-vocabs:
[2023-06-20 22:33:34] [config]   - 54042
[2023-06-20 22:33:34] [config]   - 36507
[2023-06-20 22:33:34] [config] disp-first: 0
[2023-06-20 22:33:34] [config] disp-freq: 1000u
[2023-06-20 22:33:34] [config] disp-label-counts: true
[2023-06-20 22:33:34] [config] dropout-rnn: 0.2
[2023-06-20 22:33:34] [config] dropout-src: 0.1
[2023-06-20 22:33:34] [config] dropout-trg: 0.1
[2023-06-20 22:33:34] [config] dump-config: ""
[2023-06-20 22:33:34] [config] dynamic-gradient-scaling:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] early-stopping: 5
[2023-06-20 22:33:34] [config] early-stopping-on: first
[2023-06-20 22:33:34] [config] embedding-fix-src: false
[2023-06-20 22:33:34] [config] embedding-fix-trg: false
[2023-06-20 22:33:34] [config] embedding-normalization: false
[2023-06-20 22:33:34] [config] embedding-vectors:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] enc-cell: gru
[2023-06-20 22:33:34] [config] enc-cell-depth: 1
[2023-06-20 22:33:34] [config] enc-depth: 1
[2023-06-20 22:33:34] [config] enc-type: bidirectional
[2023-06-20 22:33:34] [config] english-title-case-every: 0
[2023-06-20 22:33:34] [config] exponential-smoothing: 0
[2023-06-20 22:33:34] [config] factor-weight: 1
[2023-06-20 22:33:34] [config] factors-combine: sum
[2023-06-20 22:33:34] [config] factors-dim-emb: 0
[2023-06-20 22:33:34] [config] gradient-checkpointing: false
[2023-06-20 22:33:34] [config] gradient-norm-average-window: 100
[2023-06-20 22:33:34] [config] guided-alignment: none
[2023-06-20 22:33:34] [config] guided-alignment-cost: mse
[2023-06-20 22:33:34] [config] guided-alignment-weight: 0.1
[2023-06-20 22:33:34] [config] ignore-model-config: false
[2023-06-20 22:33:34] [config] input-types:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] interpolate-env-vars: false
[2023-06-20 22:33:34] [config] keep-best: false
[2023-06-20 22:33:34] [config] label-smoothing: 0
[2023-06-20 22:33:34] [config] layer-normalization: true
[2023-06-20 22:33:34] [config] learn-rate: 0.0001
[2023-06-20 22:33:34] [config] lemma-dependency: ""
[2023-06-20 22:33:34] [config] lemma-dim-emb: 0
[2023-06-20 22:33:34] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 22:33:34] [config] log-level: info
[2023-06-20 22:33:34] [config] log-time-zone: ""
[2023-06-20 22:33:34] [config] logical-epoch:
[2023-06-20 22:33:34] [config]   - 1e
[2023-06-20 22:33:34] [config]   - 0
[2023-06-20 22:33:34] [config] lr-decay: 0
[2023-06-20 22:33:34] [config] lr-decay-freq: 50000
[2023-06-20 22:33:34] [config] lr-decay-inv-sqrt:
[2023-06-20 22:33:34] [config]   - 0
[2023-06-20 22:33:34] [config] lr-decay-repeat-warmup: false
[2023-06-20 22:33:34] [config] lr-decay-reset-optimizer: false
[2023-06-20 22:33:34] [config] lr-decay-start:
[2023-06-20 22:33:34] [config]   - 10
[2023-06-20 22:33:34] [config]   - 1
[2023-06-20 22:33:34] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 22:33:34] [config] lr-report: false
[2023-06-20 22:33:34] [config] lr-warmup: 0
[2023-06-20 22:33:34] [config] lr-warmup-at-reload: false
[2023-06-20 22:33:34] [config] lr-warmup-cycle: false
[2023-06-20 22:33:34] [config] lr-warmup-start-rate: 0
[2023-06-20 22:33:34] [config] max-length: 50
[2023-06-20 22:33:34] [config] max-length-crop: false
[2023-06-20 22:33:34] [config] max-length-factor: 3
[2023-06-20 22:33:34] [config] maxi-batch: 100
[2023-06-20 22:33:34] [config] maxi-batch-sort: trg
[2023-06-20 22:33:34] [config] mini-batch: 64
[2023-06-20 22:33:34] [config] mini-batch-fit: true
[2023-06-20 22:33:34] [config] mini-batch-fit-step: 10
[2023-06-20 22:33:34] [config] mini-batch-round-up: true
[2023-06-20 22:33:34] [config] mini-batch-track-lr: false
[2023-06-20 22:33:34] [config] mini-batch-warmup: 0
[2023-06-20 22:33:34] [config] mini-batch-words: 0
[2023-06-20 22:33:34] [config] mini-batch-words-ref: 0
[2023-06-20 22:33:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:33:34] [config] multi-loss-type: sum
[2023-06-20 22:33:34] [config] n-best: false
[2023-06-20 22:33:34] [config] no-nccl: false
[2023-06-20 22:33:34] [config] no-reload: false
[2023-06-20 22:33:34] [config] no-restore-corpus: false
[2023-06-20 22:33:34] [config] normalize: 0
[2023-06-20 22:33:34] [config] normalize-gradient: false
[2023-06-20 22:33:34] [config] num-devices: 0
[2023-06-20 22:33:34] [config] optimizer: adam
[2023-06-20 22:33:34] [config] optimizer-delay: 1
[2023-06-20 22:33:34] [config] optimizer-params:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] output-omit-bias: false
[2023-06-20 22:33:34] [config] overwrite: false
[2023-06-20 22:33:34] [config] precision:
[2023-06-20 22:33:34] [config]   - float32
[2023-06-20 22:33:34] [config]   - float32
[2023-06-20 22:33:34] [config] pretrained-model: ""
[2023-06-20 22:33:34] [config] quantize-biases: false
[2023-06-20 22:33:34] [config] quantize-bits: 0
[2023-06-20 22:33:34] [config] quantize-log-based: false
[2023-06-20 22:33:34] [config] quantize-optimization-steps: 0
[2023-06-20 22:33:34] [config] quiet: false
[2023-06-20 22:33:34] [config] quiet-translation: true
[2023-06-20 22:33:34] [config] relative-paths: false
[2023-06-20 22:33:34] [config] right-left: false
[2023-06-20 22:33:34] [config] save-freq: 10000u
[2023-06-20 22:33:34] [config] seed: 1234
[2023-06-20 22:33:34] [config] sentencepiece-alphas:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] sentencepiece-max-lines: 2000000
[2023-06-20 22:33:34] [config] sentencepiece-options: ""
[2023-06-20 22:33:34] [config] sharding: global
[2023-06-20 22:33:34] [config] shuffle: data
[2023-06-20 22:33:34] [config] shuffle-in-ram: false
[2023-06-20 22:33:34] [config] sigterm: save-and-exit
[2023-06-20 22:33:34] [config] skip: false
[2023-06-20 22:33:34] [config] sqlite: ""
[2023-06-20 22:33:34] [config] sqlite-drop: false
[2023-06-20 22:33:34] [config] sync-freq: 200u
[2023-06-20 22:33:34] [config] sync-sgd: false
[2023-06-20 22:33:34] [config] tempdir: /tmp
[2023-06-20 22:33:34] [config] tied-embeddings: false
[2023-06-20 22:33:34] [config] tied-embeddings-all: false
[2023-06-20 22:33:34] [config] tied-embeddings-src: false
[2023-06-20 22:33:34] [config] train-embedder-rank:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] train-sets:
[2023-06-20 22:33:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 22:33:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 22:33:34] [config] transformer-aan-activation: swish
[2023-06-20 22:33:34] [config] transformer-aan-depth: 2
[2023-06-20 22:33:34] [config] transformer-aan-nogate: false
[2023-06-20 22:33:34] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 22:33:34] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 22:33:34] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 22:33:34] [config] transformer-depth-scaling: false
[2023-06-20 22:33:34] [config] transformer-dim-aan: 2048
[2023-06-20 22:33:34] [config] transformer-dim-ffn: 2048
[2023-06-20 22:33:34] [config] transformer-dropout: 0
[2023-06-20 22:33:34] [config] transformer-dropout-attention: 0
[2023-06-20 22:33:34] [config] transformer-dropout-ffn: 0
[2023-06-20 22:33:34] [config] transformer-ffn-activation: swish
[2023-06-20 22:33:34] [config] transformer-ffn-depth: 2
[2023-06-20 22:33:34] [config] transformer-guided-alignment-layer: last
[2023-06-20 22:33:34] [config] transformer-heads: 8
[2023-06-20 22:33:34] [config] transformer-no-projection: false
[2023-06-20 22:33:34] [config] transformer-pool: false
[2023-06-20 22:33:34] [config] transformer-postprocess: dan
[2023-06-20 22:33:34] [config] transformer-postprocess-emb: d
[2023-06-20 22:33:34] [config] transformer-postprocess-top: ""
[2023-06-20 22:33:34] [config] transformer-preprocess: ""
[2023-06-20 22:33:34] [config] transformer-tied-layers:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] transformer-train-position-embeddings: false
[2023-06-20 22:33:34] [config] tsv: false
[2023-06-20 22:33:34] [config] tsv-fields: 0
[2023-06-20 22:33:34] [config] type: amun
[2023-06-20 22:33:34] [config] ulr: false
[2023-06-20 22:33:34] [config] ulr-dim-emb: 0
[2023-06-20 22:33:34] [config] ulr-dropout: 0
[2023-06-20 22:33:34] [config] ulr-keys-vectors: ""
[2023-06-20 22:33:34] [config] ulr-query-vectors: ""
[2023-06-20 22:33:34] [config] ulr-softmax-temperature: 1
[2023-06-20 22:33:34] [config] ulr-trainable-transformation: false
[2023-06-20 22:33:34] [config] unlikelihood-loss: false
[2023-06-20 22:33:34] [config] valid-freq: 5000000
[2023-06-20 22:33:34] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 22:33:34] [config] valid-max-length: 1000
[2023-06-20 22:33:34] [config] valid-metrics:
[2023-06-20 22:33:34] [config]   - cross-entropy
[2023-06-20 22:33:34] [config] valid-mini-batch: 32
[2023-06-20 22:33:34] [config] valid-reset-stalled: false
[2023-06-20 22:33:34] [config] valid-script-args:
[2023-06-20 22:33:34] [config]   []
[2023-06-20 22:33:34] [config] valid-script-path: ""
[2023-06-20 22:33:34] [config] valid-sets:
[2023-06-20 22:33:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 22:33:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 22:33:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 22:33:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:33:34] [config] vocabs:
[2023-06-20 22:33:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:33:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:33:34] [config] word-penalty: 0
[2023-06-20 22:33:34] [config] word-scores: false
[2023-06-20 22:33:34] [config] workspace: 3000
[2023-06-20 22:33:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:33:34] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:33:34] [training] Using single-device training
[2023-06-20 22:33:35] Synced seed 1234
[2023-06-20 22:33:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:33:35] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 22:33:35] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:33:35] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 22:33:35] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 22:33:35] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:33:36] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:33:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:33:36] [comm] Using global sharding
[2023-06-20 22:33:37] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:33:37] [training] Using 1 GPUs
[2023-06-20 22:33:37] [logits] Applying loss function for 1 factor(s)
[2023-06-20 22:33:37] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:33:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 22:33:38] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:33:51] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 22:33:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:33:51] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:33:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:33:51] [comm] Using global sharding
[2023-06-20 22:33:51] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:33:51] [training] Using 1 GPUs
[2023-06-20 22:33:51] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:33:53] Loading Adam parameters
[2023-06-20 22:33:53] [memory] Reserving 754 MB, device gpu0
[2023-06-20 22:33:54] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:33:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:33:54] [data] Restoring the corpus state to epoch 31, batch 3598
[2023-06-20 22:33:54] [data] Shuffling data
[2023-06-20 22:33:54] [data] Done reading 20,192 sentences
[2023-06-20 22:33:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:33:54] Training started
[2023-06-20 22:33:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 22:33:54] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:33:54] Parameter type float32, optimization type float32, casting types false
[2023-06-20 22:34:39] Seen 18,843 samples
[2023-06-20 22:34:39] Starting data epoch 32 in logical epoch 32
[2023-06-20 22:34:39] [data] Shuffling data
[2023-06-20 22:34:39] [data] Done reading 20,192 sentences
[2023-06-20 22:34:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:35:25] Seen 18,843 samples
[2023-06-20 22:35:25] Starting data epoch 33 in logical epoch 33
[2023-06-20 22:35:25] [data] Shuffling data
[2023-06-20 22:35:25] [data] Done reading 20,192 sentences
[2023-06-20 22:35:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:36:10] Seen 18,843 samples
[2023-06-20 22:36:10] Starting data epoch 34 in logical epoch 34
[2023-06-20 22:36:10] [data] Shuffling data
[2023-06-20 22:36:10] [data] Done reading 20,192 sentences
[2023-06-20 22:36:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:36:28] Ep. 34 : Up. 4000 : Sen. 6,833 : Cost 2.21137071 * 3,332,508 @ 1,905 after 13,280,108 : Time 156.97s : 21229.64 words/s : gNorm 1.2720
[2023-06-20 22:36:56] Seen 18,843 samples
[2023-06-20 22:36:56] Starting data epoch 35 in logical epoch 35
[2023-06-20 22:36:56] [data] Shuffling data
[2023-06-20 22:36:56] [data] Done reading 20,192 sentences
[2023-06-20 22:36:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:37:42] Seen 18,843 samples
[2023-06-20 22:37:42] Starting data epoch 36 in logical epoch 36
[2023-06-20 22:37:42] [data] Shuffling data
[2023-06-20 22:37:42] [data] Done reading 20,192 sentences
[2023-06-20 22:37:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:38:28] Seen 18,843 samples
[2023-06-20 22:38:28] Starting data epoch 37 in logical epoch 37
[2023-06-20 22:38:28] [data] Shuffling data
[2023-06-20 22:38:28] [data] Done reading 20,192 sentences
[2023-06-20 22:38:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:39:15] Seen 18,843 samples
[2023-06-20 22:39:15] Starting data epoch 38 in logical epoch 38
[2023-06-20 22:39:15] [data] Shuffling data
[2023-06-20 22:39:15] [data] Done reading 20,192 sentences
[2023-06-20 22:39:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:40:01] Seen 18,843 samples
[2023-06-20 22:40:01] Starting data epoch 39 in logical epoch 39
[2023-06-20 22:40:01] [data] Shuffling data
[2023-06-20 22:40:01] [data] Done reading 20,192 sentences
[2023-06-20 22:40:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:40:46] Seen 18,843 samples
[2023-06-20 22:40:46] Starting data epoch 40 in logical epoch 40
[2023-06-20 22:40:46] [data] Shuffling data
[2023-06-20 22:40:46] [data] Done reading 20,192 sentences
[2023-06-20 22:40:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:41:32] Seen 18,843 samples
[2023-06-20 22:41:32] Starting data epoch 41 in logical epoch 41
[2023-06-20 22:41:32] Training finished
[2023-06-20 22:41:39] [valid] Ep. 41 : Up. 4799 : cross-entropy : 91.5854 : stalled 1 times (last best: 90.9633)
[2023-06-20 22:41:39] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:41:44] Saving Adam parameters
[2023-06-20 22:41:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:46:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:46:21] [marian] Running on node17.datos.cluster.uy as process 33508 with command line:
[2023-06-20 22:46:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 50 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 22:46:21] [config] after: 0e
[2023-06-20 22:46:21] [config] after-batches: 0
[2023-06-20 22:46:21] [config] after-epochs: 50
[2023-06-20 22:46:21] [config] all-caps-every: 0
[2023-06-20 22:46:21] [config] allow-unk: false
[2023-06-20 22:46:21] [config] authors: false
[2023-06-20 22:46:21] [config] beam-size: 12
[2023-06-20 22:46:21] [config] bert-class-symbol: "[CLS]"
[2023-06-20 22:46:21] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 22:46:21] [config] bert-masking-fraction: 0.15
[2023-06-20 22:46:21] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 22:46:21] [config] bert-train-type-embeddings: true
[2023-06-20 22:46:21] [config] bert-type-vocab-size: 2
[2023-06-20 22:46:21] [config] build-info: ""
[2023-06-20 22:46:21] [config] check-gradient-nan: false
[2023-06-20 22:46:21] [config] check-nan: false
[2023-06-20 22:46:21] [config] cite: false
[2023-06-20 22:46:21] [config] clip-norm: 1
[2023-06-20 22:46:21] [config] cost-scaling:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] cost-type: ce-sum
[2023-06-20 22:46:21] [config] cpu-threads: 0
[2023-06-20 22:46:21] [config] data-threads: 8
[2023-06-20 22:46:21] [config] data-weighting: ""
[2023-06-20 22:46:21] [config] data-weighting-type: sentence
[2023-06-20 22:46:21] [config] dec-cell: gru
[2023-06-20 22:46:21] [config] dec-cell-base-depth: 2
[2023-06-20 22:46:21] [config] dec-cell-high-depth: 1
[2023-06-20 22:46:21] [config] dec-depth: 1
[2023-06-20 22:46:21] [config] devices:
[2023-06-20 22:46:21] [config]   - 0
[2023-06-20 22:46:21] [config] dim-emb: 512
[2023-06-20 22:46:21] [config] dim-rnn: 1024
[2023-06-20 22:46:21] [config] dim-vocabs:
[2023-06-20 22:46:21] [config]   - 54042
[2023-06-20 22:46:21] [config]   - 36507
[2023-06-20 22:46:21] [config] disp-first: 0
[2023-06-20 22:46:21] [config] disp-freq: 1000u
[2023-06-20 22:46:21] [config] disp-label-counts: true
[2023-06-20 22:46:21] [config] dropout-rnn: 0.2
[2023-06-20 22:46:21] [config] dropout-src: 0.1
[2023-06-20 22:46:21] [config] dropout-trg: 0.1
[2023-06-20 22:46:21] [config] dump-config: ""
[2023-06-20 22:46:21] [config] dynamic-gradient-scaling:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] early-stopping: 5
[2023-06-20 22:46:21] [config] early-stopping-on: first
[2023-06-20 22:46:21] [config] embedding-fix-src: false
[2023-06-20 22:46:21] [config] embedding-fix-trg: false
[2023-06-20 22:46:21] [config] embedding-normalization: false
[2023-06-20 22:46:21] [config] embedding-vectors:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] enc-cell: gru
[2023-06-20 22:46:21] [config] enc-cell-depth: 1
[2023-06-20 22:46:21] [config] enc-depth: 1
[2023-06-20 22:46:21] [config] enc-type: bidirectional
[2023-06-20 22:46:21] [config] english-title-case-every: 0
[2023-06-20 22:46:21] [config] exponential-smoothing: 0
[2023-06-20 22:46:21] [config] factor-weight: 1
[2023-06-20 22:46:21] [config] factors-combine: sum
[2023-06-20 22:46:21] [config] factors-dim-emb: 0
[2023-06-20 22:46:21] [config] gradient-checkpointing: false
[2023-06-20 22:46:21] [config] gradient-norm-average-window: 100
[2023-06-20 22:46:21] [config] guided-alignment: none
[2023-06-20 22:46:21] [config] guided-alignment-cost: mse
[2023-06-20 22:46:21] [config] guided-alignment-weight: 0.1
[2023-06-20 22:46:21] [config] ignore-model-config: false
[2023-06-20 22:46:21] [config] input-types:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] interpolate-env-vars: false
[2023-06-20 22:46:21] [config] keep-best: false
[2023-06-20 22:46:21] [config] label-smoothing: 0
[2023-06-20 22:46:21] [config] layer-normalization: true
[2023-06-20 22:46:21] [config] learn-rate: 0.0001
[2023-06-20 22:46:21] [config] lemma-dependency: ""
[2023-06-20 22:46:21] [config] lemma-dim-emb: 0
[2023-06-20 22:46:21] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 22:46:21] [config] log-level: info
[2023-06-20 22:46:21] [config] log-time-zone: ""
[2023-06-20 22:46:21] [config] logical-epoch:
[2023-06-20 22:46:21] [config]   - 1e
[2023-06-20 22:46:21] [config]   - 0
[2023-06-20 22:46:21] [config] lr-decay: 0
[2023-06-20 22:46:21] [config] lr-decay-freq: 50000
[2023-06-20 22:46:21] [config] lr-decay-inv-sqrt:
[2023-06-20 22:46:21] [config]   - 0
[2023-06-20 22:46:21] [config] lr-decay-repeat-warmup: false
[2023-06-20 22:46:21] [config] lr-decay-reset-optimizer: false
[2023-06-20 22:46:21] [config] lr-decay-start:
[2023-06-20 22:46:21] [config]   - 10
[2023-06-20 22:46:21] [config]   - 1
[2023-06-20 22:46:21] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 22:46:21] [config] lr-report: false
[2023-06-20 22:46:21] [config] lr-warmup: 0
[2023-06-20 22:46:21] [config] lr-warmup-at-reload: false
[2023-06-20 22:46:21] [config] lr-warmup-cycle: false
[2023-06-20 22:46:21] [config] lr-warmup-start-rate: 0
[2023-06-20 22:46:21] [config] max-length: 50
[2023-06-20 22:46:21] [config] max-length-crop: false
[2023-06-20 22:46:21] [config] max-length-factor: 3
[2023-06-20 22:46:21] [config] maxi-batch: 100
[2023-06-20 22:46:21] [config] maxi-batch-sort: trg
[2023-06-20 22:46:21] [config] mini-batch: 64
[2023-06-20 22:46:21] [config] mini-batch-fit: true
[2023-06-20 22:46:21] [config] mini-batch-fit-step: 10
[2023-06-20 22:46:21] [config] mini-batch-round-up: true
[2023-06-20 22:46:21] [config] mini-batch-track-lr: false
[2023-06-20 22:46:21] [config] mini-batch-warmup: 0
[2023-06-20 22:46:21] [config] mini-batch-words: 0
[2023-06-20 22:46:21] [config] mini-batch-words-ref: 0
[2023-06-20 22:46:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:46:21] [config] multi-loss-type: sum
[2023-06-20 22:46:21] [config] n-best: false
[2023-06-20 22:46:21] [config] no-nccl: false
[2023-06-20 22:46:21] [config] no-reload: false
[2023-06-20 22:46:21] [config] no-restore-corpus: false
[2023-06-20 22:46:21] [config] normalize: 0
[2023-06-20 22:46:21] [config] normalize-gradient: false
[2023-06-20 22:46:21] [config] num-devices: 0
[2023-06-20 22:46:21] [config] optimizer: adam
[2023-06-20 22:46:21] [config] optimizer-delay: 1
[2023-06-20 22:46:21] [config] optimizer-params:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] output-omit-bias: false
[2023-06-20 22:46:21] [config] overwrite: false
[2023-06-20 22:46:21] [config] precision:
[2023-06-20 22:46:21] [config]   - float32
[2023-06-20 22:46:21] [config]   - float32
[2023-06-20 22:46:21] [config] pretrained-model: ""
[2023-06-20 22:46:21] [config] quantize-biases: false
[2023-06-20 22:46:21] [config] quantize-bits: 0
[2023-06-20 22:46:21] [config] quantize-log-based: false
[2023-06-20 22:46:21] [config] quantize-optimization-steps: 0
[2023-06-20 22:46:21] [config] quiet: false
[2023-06-20 22:46:21] [config] quiet-translation: true
[2023-06-20 22:46:21] [config] relative-paths: false
[2023-06-20 22:46:21] [config] right-left: false
[2023-06-20 22:46:21] [config] save-freq: 10000u
[2023-06-20 22:46:21] [config] seed: 1234
[2023-06-20 22:46:21] [config] sentencepiece-alphas:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] sentencepiece-max-lines: 2000000
[2023-06-20 22:46:21] [config] sentencepiece-options: ""
[2023-06-20 22:46:21] [config] sharding: global
[2023-06-20 22:46:21] [config] shuffle: data
[2023-06-20 22:46:21] [config] shuffle-in-ram: false
[2023-06-20 22:46:21] [config] sigterm: save-and-exit
[2023-06-20 22:46:21] [config] skip: false
[2023-06-20 22:46:21] [config] sqlite: ""
[2023-06-20 22:46:21] [config] sqlite-drop: false
[2023-06-20 22:46:21] [config] sync-freq: 200u
[2023-06-20 22:46:21] [config] sync-sgd: false
[2023-06-20 22:46:21] [config] tempdir: /tmp
[2023-06-20 22:46:21] [config] tied-embeddings: false
[2023-06-20 22:46:21] [config] tied-embeddings-all: false
[2023-06-20 22:46:21] [config] tied-embeddings-src: false
[2023-06-20 22:46:21] [config] train-embedder-rank:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] train-sets:
[2023-06-20 22:46:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 22:46:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 22:46:21] [config] transformer-aan-activation: swish
[2023-06-20 22:46:21] [config] transformer-aan-depth: 2
[2023-06-20 22:46:21] [config] transformer-aan-nogate: false
[2023-06-20 22:46:21] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 22:46:21] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 22:46:21] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 22:46:21] [config] transformer-depth-scaling: false
[2023-06-20 22:46:21] [config] transformer-dim-aan: 2048
[2023-06-20 22:46:21] [config] transformer-dim-ffn: 2048
[2023-06-20 22:46:21] [config] transformer-dropout: 0
[2023-06-20 22:46:21] [config] transformer-dropout-attention: 0
[2023-06-20 22:46:21] [config] transformer-dropout-ffn: 0
[2023-06-20 22:46:21] [config] transformer-ffn-activation: swish
[2023-06-20 22:46:21] [config] transformer-ffn-depth: 2
[2023-06-20 22:46:21] [config] transformer-guided-alignment-layer: last
[2023-06-20 22:46:21] [config] transformer-heads: 8
[2023-06-20 22:46:21] [config] transformer-no-projection: false
[2023-06-20 22:46:21] [config] transformer-pool: false
[2023-06-20 22:46:21] [config] transformer-postprocess: dan
[2023-06-20 22:46:21] [config] transformer-postprocess-emb: d
[2023-06-20 22:46:21] [config] transformer-postprocess-top: ""
[2023-06-20 22:46:21] [config] transformer-preprocess: ""
[2023-06-20 22:46:21] [config] transformer-tied-layers:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] transformer-train-position-embeddings: false
[2023-06-20 22:46:21] [config] tsv: false
[2023-06-20 22:46:21] [config] tsv-fields: 0
[2023-06-20 22:46:21] [config] type: amun
[2023-06-20 22:46:21] [config] ulr: false
[2023-06-20 22:46:21] [config] ulr-dim-emb: 0
[2023-06-20 22:46:21] [config] ulr-dropout: 0
[2023-06-20 22:46:21] [config] ulr-keys-vectors: ""
[2023-06-20 22:46:21] [config] ulr-query-vectors: ""
[2023-06-20 22:46:21] [config] ulr-softmax-temperature: 1
[2023-06-20 22:46:21] [config] ulr-trainable-transformation: false
[2023-06-20 22:46:21] [config] unlikelihood-loss: false
[2023-06-20 22:46:21] [config] valid-freq: 5000000
[2023-06-20 22:46:21] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 22:46:21] [config] valid-max-length: 1000
[2023-06-20 22:46:21] [config] valid-metrics:
[2023-06-20 22:46:21] [config]   - cross-entropy
[2023-06-20 22:46:21] [config] valid-mini-batch: 32
[2023-06-20 22:46:21] [config] valid-reset-stalled: false
[2023-06-20 22:46:21] [config] valid-script-args:
[2023-06-20 22:46:21] [config]   []
[2023-06-20 22:46:21] [config] valid-script-path: ""
[2023-06-20 22:46:21] [config] valid-sets:
[2023-06-20 22:46:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 22:46:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 22:46:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 22:46:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:46:21] [config] vocabs:
[2023-06-20 22:46:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:46:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:46:21] [config] word-penalty: 0
[2023-06-20 22:46:21] [config] word-scores: false
[2023-06-20 22:46:21] [config] workspace: 3000
[2023-06-20 22:46:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:46:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:46:21] [training] Using single-device training
[2023-06-20 22:46:21] Synced seed 1234
[2023-06-20 22:46:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:46:22] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 22:46:22] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:46:22] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 22:46:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 22:46:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:46:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:46:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:46:23] [comm] Using global sharding
[2023-06-20 22:46:24] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:46:24] [training] Using 1 GPUs
[2023-06-20 22:46:24] [logits] Applying loss function for 1 factor(s)
[2023-06-20 22:46:24] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:46:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 22:46:24] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:46:37] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 22:46:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:46:37] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:46:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:46:37] [comm] Using global sharding
[2023-06-20 22:46:37] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:46:37] [training] Using 1 GPUs
[2023-06-20 22:46:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:46:40] Loading Adam parameters
[2023-06-20 22:46:40] [memory] Reserving 754 MB, device gpu0
[2023-06-20 22:46:40] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:46:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:46:40] [data] Restoring the corpus state to epoch 41, batch 4799
[2023-06-20 22:46:40] [data] Shuffling data
[2023-06-20 22:46:40] [data] Done reading 20,192 sentences
[2023-06-20 22:46:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:46:40] Training started
[2023-06-20 22:46:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 22:46:40] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:46:41] Parameter type float32, optimization type float32, casting types false
[2023-06-20 22:47:25] Seen 18,843 samples
[2023-06-20 22:47:25] Starting data epoch 42 in logical epoch 42
[2023-06-20 22:47:25] [data] Shuffling data
[2023-06-20 22:47:25] [data] Done reading 20,192 sentences
[2023-06-20 22:47:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:47:57] Ep. 42 : Up. 5000 : Sen. 12,806 : Cost 1.62701619 * 3,307,315 @ 4,148 after 16,587,423 : Time 79.50s : 41600.73 words/s : gNorm 1.1944
[2023-06-20 22:48:11] Seen 18,843 samples
[2023-06-20 22:48:11] Starting data epoch 43 in logical epoch 43
[2023-06-20 22:48:11] [data] Shuffling data
[2023-06-20 22:48:11] [data] Done reading 20,192 sentences
[2023-06-20 22:48:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:48:57] Seen 18,843 samples
[2023-06-20 22:48:57] Starting data epoch 44 in logical epoch 44
[2023-06-20 22:48:57] [data] Shuffling data
[2023-06-20 22:48:57] [data] Done reading 20,192 sentences
[2023-06-20 22:48:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:49:43] Seen 18,843 samples
[2023-06-20 22:49:43] Starting data epoch 45 in logical epoch 45
[2023-06-20 22:49:43] [data] Shuffling data
[2023-06-20 22:49:43] [data] Done reading 20,192 sentences
[2023-06-20 22:49:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:50:30] Seen 18,843 samples
[2023-06-20 22:50:30] Starting data epoch 46 in logical epoch 46
[2023-06-20 22:50:30] [data] Shuffling data
[2023-06-20 22:50:30] [data] Done reading 20,192 sentences
[2023-06-20 22:50:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:51:16] Seen 18,843 samples
[2023-06-20 22:51:16] Starting data epoch 47 in logical epoch 47
[2023-06-20 22:51:16] [data] Shuffling data
[2023-06-20 22:51:16] [data] Done reading 20,192 sentences
[2023-06-20 22:51:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:52:02] Seen 18,843 samples
[2023-06-20 22:52:02] Starting data epoch 48 in logical epoch 48
[2023-06-20 22:52:02] [data] Shuffling data
[2023-06-20 22:52:02] [data] Done reading 20,192 sentences
[2023-06-20 22:52:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:52:47] Seen 18,843 samples
[2023-06-20 22:52:47] Starting data epoch 49 in logical epoch 49
[2023-06-20 22:52:47] [data] Shuffling data
[2023-06-20 22:52:47] [data] Done reading 20,192 sentences
[2023-06-20 22:52:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:53:33] Seen 18,843 samples
[2023-06-20 22:53:33] Starting data epoch 50 in logical epoch 50
[2023-06-20 22:53:33] [data] Shuffling data
[2023-06-20 22:53:33] [data] Done reading 20,192 sentences
[2023-06-20 22:53:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:54:19] Seen 18,843 samples
[2023-06-20 22:54:19] Starting data epoch 51 in logical epoch 51
[2023-06-20 22:54:19] Training finished
[2023-06-20 22:54:26] [valid] Ep. 51 : Up. 5998 : cross-entropy : 94.3237 : stalled 2 times (last best: 90.9633)
[2023-06-20 22:54:26] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:54:29] Saving Adam parameters
[2023-06-20 22:54:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:58:59] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:58:59] [marian] Running on node17.datos.cluster.uy as process 34583 with command line:
[2023-06-20 22:58:59] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 60 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 22:58:59] [config] after: 0e
[2023-06-20 22:58:59] [config] after-batches: 0
[2023-06-20 22:58:59] [config] after-epochs: 60
[2023-06-20 22:58:59] [config] all-caps-every: 0
[2023-06-20 22:58:59] [config] allow-unk: false
[2023-06-20 22:58:59] [config] authors: false
[2023-06-20 22:58:59] [config] beam-size: 12
[2023-06-20 22:58:59] [config] bert-class-symbol: "[CLS]"
[2023-06-20 22:58:59] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 22:58:59] [config] bert-masking-fraction: 0.15
[2023-06-20 22:58:59] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 22:58:59] [config] bert-train-type-embeddings: true
[2023-06-20 22:58:59] [config] bert-type-vocab-size: 2
[2023-06-20 22:58:59] [config] build-info: ""
[2023-06-20 22:58:59] [config] check-gradient-nan: false
[2023-06-20 22:58:59] [config] check-nan: false
[2023-06-20 22:58:59] [config] cite: false
[2023-06-20 22:58:59] [config] clip-norm: 1
[2023-06-20 22:58:59] [config] cost-scaling:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] cost-type: ce-sum
[2023-06-20 22:58:59] [config] cpu-threads: 0
[2023-06-20 22:58:59] [config] data-threads: 8
[2023-06-20 22:58:59] [config] data-weighting: ""
[2023-06-20 22:58:59] [config] data-weighting-type: sentence
[2023-06-20 22:58:59] [config] dec-cell: gru
[2023-06-20 22:58:59] [config] dec-cell-base-depth: 2
[2023-06-20 22:58:59] [config] dec-cell-high-depth: 1
[2023-06-20 22:58:59] [config] dec-depth: 1
[2023-06-20 22:58:59] [config] devices:
[2023-06-20 22:58:59] [config]   - 0
[2023-06-20 22:58:59] [config] dim-emb: 512
[2023-06-20 22:58:59] [config] dim-rnn: 1024
[2023-06-20 22:58:59] [config] dim-vocabs:
[2023-06-20 22:58:59] [config]   - 54042
[2023-06-20 22:58:59] [config]   - 36507
[2023-06-20 22:58:59] [config] disp-first: 0
[2023-06-20 22:58:59] [config] disp-freq: 1000u
[2023-06-20 22:58:59] [config] disp-label-counts: true
[2023-06-20 22:58:59] [config] dropout-rnn: 0.2
[2023-06-20 22:58:59] [config] dropout-src: 0.1
[2023-06-20 22:58:59] [config] dropout-trg: 0.1
[2023-06-20 22:58:59] [config] dump-config: ""
[2023-06-20 22:58:59] [config] dynamic-gradient-scaling:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] early-stopping: 5
[2023-06-20 22:58:59] [config] early-stopping-on: first
[2023-06-20 22:58:59] [config] embedding-fix-src: false
[2023-06-20 22:58:59] [config] embedding-fix-trg: false
[2023-06-20 22:58:59] [config] embedding-normalization: false
[2023-06-20 22:58:59] [config] embedding-vectors:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] enc-cell: gru
[2023-06-20 22:58:59] [config] enc-cell-depth: 1
[2023-06-20 22:58:59] [config] enc-depth: 1
[2023-06-20 22:58:59] [config] enc-type: bidirectional
[2023-06-20 22:58:59] [config] english-title-case-every: 0
[2023-06-20 22:58:59] [config] exponential-smoothing: 0
[2023-06-20 22:58:59] [config] factor-weight: 1
[2023-06-20 22:58:59] [config] factors-combine: sum
[2023-06-20 22:58:59] [config] factors-dim-emb: 0
[2023-06-20 22:58:59] [config] gradient-checkpointing: false
[2023-06-20 22:58:59] [config] gradient-norm-average-window: 100
[2023-06-20 22:58:59] [config] guided-alignment: none
[2023-06-20 22:58:59] [config] guided-alignment-cost: mse
[2023-06-20 22:58:59] [config] guided-alignment-weight: 0.1
[2023-06-20 22:58:59] [config] ignore-model-config: false
[2023-06-20 22:58:59] [config] input-types:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] interpolate-env-vars: false
[2023-06-20 22:58:59] [config] keep-best: false
[2023-06-20 22:58:59] [config] label-smoothing: 0
[2023-06-20 22:58:59] [config] layer-normalization: true
[2023-06-20 22:58:59] [config] learn-rate: 0.0001
[2023-06-20 22:58:59] [config] lemma-dependency: ""
[2023-06-20 22:58:59] [config] lemma-dim-emb: 0
[2023-06-20 22:58:59] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 22:58:59] [config] log-level: info
[2023-06-20 22:58:59] [config] log-time-zone: ""
[2023-06-20 22:58:59] [config] logical-epoch:
[2023-06-20 22:58:59] [config]   - 1e
[2023-06-20 22:58:59] [config]   - 0
[2023-06-20 22:58:59] [config] lr-decay: 0
[2023-06-20 22:58:59] [config] lr-decay-freq: 50000
[2023-06-20 22:58:59] [config] lr-decay-inv-sqrt:
[2023-06-20 22:58:59] [config]   - 0
[2023-06-20 22:58:59] [config] lr-decay-repeat-warmup: false
[2023-06-20 22:58:59] [config] lr-decay-reset-optimizer: false
[2023-06-20 22:58:59] [config] lr-decay-start:
[2023-06-20 22:58:59] [config]   - 10
[2023-06-20 22:58:59] [config]   - 1
[2023-06-20 22:58:59] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 22:58:59] [config] lr-report: false
[2023-06-20 22:58:59] [config] lr-warmup: 0
[2023-06-20 22:58:59] [config] lr-warmup-at-reload: false
[2023-06-20 22:58:59] [config] lr-warmup-cycle: false
[2023-06-20 22:58:59] [config] lr-warmup-start-rate: 0
[2023-06-20 22:58:59] [config] max-length: 50
[2023-06-20 22:58:59] [config] max-length-crop: false
[2023-06-20 22:58:59] [config] max-length-factor: 3
[2023-06-20 22:58:59] [config] maxi-batch: 100
[2023-06-20 22:58:59] [config] maxi-batch-sort: trg
[2023-06-20 22:58:59] [config] mini-batch: 64
[2023-06-20 22:58:59] [config] mini-batch-fit: true
[2023-06-20 22:58:59] [config] mini-batch-fit-step: 10
[2023-06-20 22:58:59] [config] mini-batch-round-up: true
[2023-06-20 22:58:59] [config] mini-batch-track-lr: false
[2023-06-20 22:58:59] [config] mini-batch-warmup: 0
[2023-06-20 22:58:59] [config] mini-batch-words: 0
[2023-06-20 22:58:59] [config] mini-batch-words-ref: 0
[2023-06-20 22:58:59] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:58:59] [config] multi-loss-type: sum
[2023-06-20 22:58:59] [config] n-best: false
[2023-06-20 22:58:59] [config] no-nccl: false
[2023-06-20 22:58:59] [config] no-reload: false
[2023-06-20 22:58:59] [config] no-restore-corpus: false
[2023-06-20 22:58:59] [config] normalize: 0
[2023-06-20 22:58:59] [config] normalize-gradient: false
[2023-06-20 22:58:59] [config] num-devices: 0
[2023-06-20 22:58:59] [config] optimizer: adam
[2023-06-20 22:58:59] [config] optimizer-delay: 1
[2023-06-20 22:58:59] [config] optimizer-params:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] output-omit-bias: false
[2023-06-20 22:58:59] [config] overwrite: false
[2023-06-20 22:58:59] [config] precision:
[2023-06-20 22:58:59] [config]   - float32
[2023-06-20 22:58:59] [config]   - float32
[2023-06-20 22:58:59] [config] pretrained-model: ""
[2023-06-20 22:58:59] [config] quantize-biases: false
[2023-06-20 22:58:59] [config] quantize-bits: 0
[2023-06-20 22:58:59] [config] quantize-log-based: false
[2023-06-20 22:58:59] [config] quantize-optimization-steps: 0
[2023-06-20 22:58:59] [config] quiet: false
[2023-06-20 22:58:59] [config] quiet-translation: true
[2023-06-20 22:58:59] [config] relative-paths: false
[2023-06-20 22:58:59] [config] right-left: false
[2023-06-20 22:58:59] [config] save-freq: 10000u
[2023-06-20 22:58:59] [config] seed: 1234
[2023-06-20 22:58:59] [config] sentencepiece-alphas:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] sentencepiece-max-lines: 2000000
[2023-06-20 22:58:59] [config] sentencepiece-options: ""
[2023-06-20 22:58:59] [config] sharding: global
[2023-06-20 22:58:59] [config] shuffle: data
[2023-06-20 22:58:59] [config] shuffle-in-ram: false
[2023-06-20 22:58:59] [config] sigterm: save-and-exit
[2023-06-20 22:58:59] [config] skip: false
[2023-06-20 22:58:59] [config] sqlite: ""
[2023-06-20 22:58:59] [config] sqlite-drop: false
[2023-06-20 22:58:59] [config] sync-freq: 200u
[2023-06-20 22:58:59] [config] sync-sgd: false
[2023-06-20 22:58:59] [config] tempdir: /tmp
[2023-06-20 22:58:59] [config] tied-embeddings: false
[2023-06-20 22:58:59] [config] tied-embeddings-all: false
[2023-06-20 22:58:59] [config] tied-embeddings-src: false
[2023-06-20 22:58:59] [config] train-embedder-rank:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] train-sets:
[2023-06-20 22:58:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 22:58:59] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 22:58:59] [config] transformer-aan-activation: swish
[2023-06-20 22:58:59] [config] transformer-aan-depth: 2
[2023-06-20 22:58:59] [config] transformer-aan-nogate: false
[2023-06-20 22:58:59] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 22:58:59] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 22:58:59] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 22:58:59] [config] transformer-depth-scaling: false
[2023-06-20 22:58:59] [config] transformer-dim-aan: 2048
[2023-06-20 22:58:59] [config] transformer-dim-ffn: 2048
[2023-06-20 22:58:59] [config] transformer-dropout: 0
[2023-06-20 22:58:59] [config] transformer-dropout-attention: 0
[2023-06-20 22:58:59] [config] transformer-dropout-ffn: 0
[2023-06-20 22:58:59] [config] transformer-ffn-activation: swish
[2023-06-20 22:58:59] [config] transformer-ffn-depth: 2
[2023-06-20 22:58:59] [config] transformer-guided-alignment-layer: last
[2023-06-20 22:58:59] [config] transformer-heads: 8
[2023-06-20 22:58:59] [config] transformer-no-projection: false
[2023-06-20 22:58:59] [config] transformer-pool: false
[2023-06-20 22:58:59] [config] transformer-postprocess: dan
[2023-06-20 22:58:59] [config] transformer-postprocess-emb: d
[2023-06-20 22:58:59] [config] transformer-postprocess-top: ""
[2023-06-20 22:58:59] [config] transformer-preprocess: ""
[2023-06-20 22:58:59] [config] transformer-tied-layers:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] transformer-train-position-embeddings: false
[2023-06-20 22:58:59] [config] tsv: false
[2023-06-20 22:58:59] [config] tsv-fields: 0
[2023-06-20 22:58:59] [config] type: amun
[2023-06-20 22:58:59] [config] ulr: false
[2023-06-20 22:58:59] [config] ulr-dim-emb: 0
[2023-06-20 22:58:59] [config] ulr-dropout: 0
[2023-06-20 22:58:59] [config] ulr-keys-vectors: ""
[2023-06-20 22:58:59] [config] ulr-query-vectors: ""
[2023-06-20 22:58:59] [config] ulr-softmax-temperature: 1
[2023-06-20 22:58:59] [config] ulr-trainable-transformation: false
[2023-06-20 22:58:59] [config] unlikelihood-loss: false
[2023-06-20 22:58:59] [config] valid-freq: 5000000
[2023-06-20 22:58:59] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 22:58:59] [config] valid-max-length: 1000
[2023-06-20 22:58:59] [config] valid-metrics:
[2023-06-20 22:58:59] [config]   - cross-entropy
[2023-06-20 22:58:59] [config] valid-mini-batch: 32
[2023-06-20 22:58:59] [config] valid-reset-stalled: false
[2023-06-20 22:58:59] [config] valid-script-args:
[2023-06-20 22:58:59] [config]   []
[2023-06-20 22:58:59] [config] valid-script-path: ""
[2023-06-20 22:58:59] [config] valid-sets:
[2023-06-20 22:58:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 22:58:59] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 22:58:59] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 22:58:59] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:58:59] [config] vocabs:
[2023-06-20 22:58:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:58:59] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:58:59] [config] word-penalty: 0
[2023-06-20 22:58:59] [config] word-scores: false
[2023-06-20 22:58:59] [config] workspace: 3000
[2023-06-20 22:58:59] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 22:58:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:58:59] [training] Using single-device training
[2023-06-20 22:59:00] Synced seed 1234
[2023-06-20 22:59:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 22:59:00] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 22:59:00] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 22:59:00] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 22:59:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 22:59:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:59:01] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:59:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:59:01] [comm] Using global sharding
[2023-06-20 22:59:02] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:59:02] [training] Using 1 GPUs
[2023-06-20 22:59:02] [logits] Applying loss function for 1 factor(s)
[2023-06-20 22:59:02] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:59:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 22:59:02] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:59:15] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 22:59:15] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 22:59:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 22:59:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 22:59:15] [comm] Using global sharding
[2023-06-20 22:59:15] [comm] NCCLCommunicators constructed successfully
[2023-06-20 22:59:15] [training] Using 1 GPUs
[2023-06-20 22:59:15] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 22:59:18] Loading Adam parameters
[2023-06-20 22:59:18] [memory] Reserving 754 MB, device gpu0
[2023-06-20 22:59:18] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:59:18] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 22:59:18] [data] Restoring the corpus state to epoch 51, batch 5998
[2023-06-20 22:59:18] [data] Shuffling data
[2023-06-20 22:59:18] [data] Done reading 20,192 sentences
[2023-06-20 22:59:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 22:59:18] Training started
[2023-06-20 22:59:18] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 22:59:19] [memory] Reserving 377 MB, device gpu0
[2023-06-20 22:59:19] Parameter type float32, optimization type float32, casting types false
[2023-06-20 22:59:19] Ep. 51 : Up. 6000 : Sen. 240 : Cost 1.18864787 * 3,314,118 @ 1,914 after 19,901,541 : Time 4.09s : 810909.27 words/s : gNorm 1.1637
[2023-06-20 23:00:03] Seen 18,843 samples
[2023-06-20 23:00:03] Starting data epoch 52 in logical epoch 52
[2023-06-20 23:00:03] [data] Shuffling data
[2023-06-20 23:00:03] [data] Done reading 20,192 sentences
[2023-06-20 23:00:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:00:49] Seen 18,843 samples
[2023-06-20 23:00:49] Starting data epoch 53 in logical epoch 53
[2023-06-20 23:00:49] [data] Shuffling data
[2023-06-20 23:00:49] [data] Done reading 20,192 sentences
[2023-06-20 23:00:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:01:35] Seen 18,843 samples
[2023-06-20 23:01:35] Starting data epoch 54 in logical epoch 54
[2023-06-20 23:01:35] [data] Shuffling data
[2023-06-20 23:01:35] [data] Done reading 20,192 sentences
[2023-06-20 23:01:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:02:21] Seen 18,843 samples
[2023-06-20 23:02:21] Starting data epoch 55 in logical epoch 55
[2023-06-20 23:02:21] [data] Shuffling data
[2023-06-20 23:02:21] [data] Done reading 20,192 sentences
[2023-06-20 23:02:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:03:07] Seen 18,843 samples
[2023-06-20 23:03:07] Starting data epoch 56 in logical epoch 56
[2023-06-20 23:03:07] [data] Shuffling data
[2023-06-20 23:03:07] [data] Done reading 20,192 sentences
[2023-06-20 23:03:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:03:53] Seen 18,843 samples
[2023-06-20 23:03:53] Starting data epoch 57 in logical epoch 57
[2023-06-20 23:03:53] [data] Shuffling data
[2023-06-20 23:03:53] [data] Done reading 20,192 sentences
[2023-06-20 23:03:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:04:39] Seen 18,843 samples
[2023-06-20 23:04:39] Starting data epoch 58 in logical epoch 58
[2023-06-20 23:04:39] [data] Shuffling data
[2023-06-20 23:04:39] [data] Done reading 20,192 sentences
[2023-06-20 23:04:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:05:25] Seen 18,843 samples
[2023-06-20 23:05:25] Starting data epoch 59 in logical epoch 59
[2023-06-20 23:05:25] [data] Shuffling data
[2023-06-20 23:05:25] [data] Done reading 20,192 sentences
[2023-06-20 23:05:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:05:41] Ep. 59 : Up. 7000 : Sen. 6,414 : Cost 0.88837510 * 3,313,387 @ 3,096 after 23,214,928 : Time 381.39s : 8687.61 words/s : gNorm 1.0818
[2023-06-20 23:06:12] Seen 18,843 samples
[2023-06-20 23:06:12] Starting data epoch 60 in logical epoch 60
[2023-06-20 23:06:12] [data] Shuffling data
[2023-06-20 23:06:12] [data] Done reading 20,192 sentences
[2023-06-20 23:06:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:06:57] Seen 18,843 samples
[2023-06-20 23:06:58] Starting data epoch 61 in logical epoch 61
[2023-06-20 23:06:58] Training finished
[2023-06-20 23:07:05] [valid] Ep. 61 : Up. 7198 : cross-entropy : 96.9741 : stalled 3 times (last best: 90.9633)
[2023-06-20 23:07:05] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:07:08] Saving Adam parameters
[2023-06-20 23:07:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:11:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:11:40] [marian] Running on node17.datos.cluster.uy as process 35328 with command line:
[2023-06-20 23:11:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 70 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:11:40] [config] after: 0e
[2023-06-20 23:11:40] [config] after-batches: 0
[2023-06-20 23:11:40] [config] after-epochs: 70
[2023-06-20 23:11:40] [config] all-caps-every: 0
[2023-06-20 23:11:40] [config] allow-unk: false
[2023-06-20 23:11:40] [config] authors: false
[2023-06-20 23:11:40] [config] beam-size: 12
[2023-06-20 23:11:40] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:11:40] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:11:40] [config] bert-masking-fraction: 0.15
[2023-06-20 23:11:40] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:11:40] [config] bert-train-type-embeddings: true
[2023-06-20 23:11:40] [config] bert-type-vocab-size: 2
[2023-06-20 23:11:40] [config] build-info: ""
[2023-06-20 23:11:40] [config] check-gradient-nan: false
[2023-06-20 23:11:40] [config] check-nan: false
[2023-06-20 23:11:40] [config] cite: false
[2023-06-20 23:11:40] [config] clip-norm: 1
[2023-06-20 23:11:40] [config] cost-scaling:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] cost-type: ce-sum
[2023-06-20 23:11:40] [config] cpu-threads: 0
[2023-06-20 23:11:40] [config] data-threads: 8
[2023-06-20 23:11:40] [config] data-weighting: ""
[2023-06-20 23:11:40] [config] data-weighting-type: sentence
[2023-06-20 23:11:40] [config] dec-cell: gru
[2023-06-20 23:11:40] [config] dec-cell-base-depth: 2
[2023-06-20 23:11:40] [config] dec-cell-high-depth: 1
[2023-06-20 23:11:40] [config] dec-depth: 1
[2023-06-20 23:11:40] [config] devices:
[2023-06-20 23:11:40] [config]   - 0
[2023-06-20 23:11:40] [config] dim-emb: 512
[2023-06-20 23:11:40] [config] dim-rnn: 1024
[2023-06-20 23:11:40] [config] dim-vocabs:
[2023-06-20 23:11:40] [config]   - 54042
[2023-06-20 23:11:40] [config]   - 36507
[2023-06-20 23:11:40] [config] disp-first: 0
[2023-06-20 23:11:40] [config] disp-freq: 1000u
[2023-06-20 23:11:40] [config] disp-label-counts: true
[2023-06-20 23:11:40] [config] dropout-rnn: 0.2
[2023-06-20 23:11:40] [config] dropout-src: 0.1
[2023-06-20 23:11:40] [config] dropout-trg: 0.1
[2023-06-20 23:11:40] [config] dump-config: ""
[2023-06-20 23:11:40] [config] dynamic-gradient-scaling:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] early-stopping: 5
[2023-06-20 23:11:40] [config] early-stopping-on: first
[2023-06-20 23:11:40] [config] embedding-fix-src: false
[2023-06-20 23:11:40] [config] embedding-fix-trg: false
[2023-06-20 23:11:40] [config] embedding-normalization: false
[2023-06-20 23:11:40] [config] embedding-vectors:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] enc-cell: gru
[2023-06-20 23:11:40] [config] enc-cell-depth: 1
[2023-06-20 23:11:40] [config] enc-depth: 1
[2023-06-20 23:11:40] [config] enc-type: bidirectional
[2023-06-20 23:11:40] [config] english-title-case-every: 0
[2023-06-20 23:11:40] [config] exponential-smoothing: 0
[2023-06-20 23:11:40] [config] factor-weight: 1
[2023-06-20 23:11:40] [config] factors-combine: sum
[2023-06-20 23:11:40] [config] factors-dim-emb: 0
[2023-06-20 23:11:40] [config] gradient-checkpointing: false
[2023-06-20 23:11:40] [config] gradient-norm-average-window: 100
[2023-06-20 23:11:40] [config] guided-alignment: none
[2023-06-20 23:11:40] [config] guided-alignment-cost: mse
[2023-06-20 23:11:40] [config] guided-alignment-weight: 0.1
[2023-06-20 23:11:40] [config] ignore-model-config: false
[2023-06-20 23:11:40] [config] input-types:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] interpolate-env-vars: false
[2023-06-20 23:11:40] [config] keep-best: false
[2023-06-20 23:11:40] [config] label-smoothing: 0
[2023-06-20 23:11:40] [config] layer-normalization: true
[2023-06-20 23:11:40] [config] learn-rate: 0.0001
[2023-06-20 23:11:40] [config] lemma-dependency: ""
[2023-06-20 23:11:40] [config] lemma-dim-emb: 0
[2023-06-20 23:11:40] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:11:40] [config] log-level: info
[2023-06-20 23:11:40] [config] log-time-zone: ""
[2023-06-20 23:11:40] [config] logical-epoch:
[2023-06-20 23:11:40] [config]   - 1e
[2023-06-20 23:11:40] [config]   - 0
[2023-06-20 23:11:40] [config] lr-decay: 0
[2023-06-20 23:11:40] [config] lr-decay-freq: 50000
[2023-06-20 23:11:40] [config] lr-decay-inv-sqrt:
[2023-06-20 23:11:40] [config]   - 0
[2023-06-20 23:11:40] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:11:40] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:11:40] [config] lr-decay-start:
[2023-06-20 23:11:40] [config]   - 10
[2023-06-20 23:11:40] [config]   - 1
[2023-06-20 23:11:40] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:11:40] [config] lr-report: false
[2023-06-20 23:11:40] [config] lr-warmup: 0
[2023-06-20 23:11:40] [config] lr-warmup-at-reload: false
[2023-06-20 23:11:40] [config] lr-warmup-cycle: false
[2023-06-20 23:11:40] [config] lr-warmup-start-rate: 0
[2023-06-20 23:11:40] [config] max-length: 50
[2023-06-20 23:11:40] [config] max-length-crop: false
[2023-06-20 23:11:40] [config] max-length-factor: 3
[2023-06-20 23:11:40] [config] maxi-batch: 100
[2023-06-20 23:11:40] [config] maxi-batch-sort: trg
[2023-06-20 23:11:40] [config] mini-batch: 64
[2023-06-20 23:11:40] [config] mini-batch-fit: true
[2023-06-20 23:11:40] [config] mini-batch-fit-step: 10
[2023-06-20 23:11:40] [config] mini-batch-round-up: true
[2023-06-20 23:11:40] [config] mini-batch-track-lr: false
[2023-06-20 23:11:40] [config] mini-batch-warmup: 0
[2023-06-20 23:11:40] [config] mini-batch-words: 0
[2023-06-20 23:11:40] [config] mini-batch-words-ref: 0
[2023-06-20 23:11:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:11:40] [config] multi-loss-type: sum
[2023-06-20 23:11:40] [config] n-best: false
[2023-06-20 23:11:40] [config] no-nccl: false
[2023-06-20 23:11:40] [config] no-reload: false
[2023-06-20 23:11:40] [config] no-restore-corpus: false
[2023-06-20 23:11:40] [config] normalize: 0
[2023-06-20 23:11:40] [config] normalize-gradient: false
[2023-06-20 23:11:40] [config] num-devices: 0
[2023-06-20 23:11:40] [config] optimizer: adam
[2023-06-20 23:11:40] [config] optimizer-delay: 1
[2023-06-20 23:11:40] [config] optimizer-params:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] output-omit-bias: false
[2023-06-20 23:11:40] [config] overwrite: false
[2023-06-20 23:11:40] [config] precision:
[2023-06-20 23:11:40] [config]   - float32
[2023-06-20 23:11:40] [config]   - float32
[2023-06-20 23:11:40] [config] pretrained-model: ""
[2023-06-20 23:11:40] [config] quantize-biases: false
[2023-06-20 23:11:40] [config] quantize-bits: 0
[2023-06-20 23:11:40] [config] quantize-log-based: false
[2023-06-20 23:11:40] [config] quantize-optimization-steps: 0
[2023-06-20 23:11:40] [config] quiet: false
[2023-06-20 23:11:40] [config] quiet-translation: true
[2023-06-20 23:11:40] [config] relative-paths: false
[2023-06-20 23:11:40] [config] right-left: false
[2023-06-20 23:11:40] [config] save-freq: 10000u
[2023-06-20 23:11:40] [config] seed: 1234
[2023-06-20 23:11:40] [config] sentencepiece-alphas:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:11:40] [config] sentencepiece-options: ""
[2023-06-20 23:11:40] [config] sharding: global
[2023-06-20 23:11:40] [config] shuffle: data
[2023-06-20 23:11:40] [config] shuffle-in-ram: false
[2023-06-20 23:11:40] [config] sigterm: save-and-exit
[2023-06-20 23:11:40] [config] skip: false
[2023-06-20 23:11:40] [config] sqlite: ""
[2023-06-20 23:11:40] [config] sqlite-drop: false
[2023-06-20 23:11:40] [config] sync-freq: 200u
[2023-06-20 23:11:40] [config] sync-sgd: false
[2023-06-20 23:11:40] [config] tempdir: /tmp
[2023-06-20 23:11:40] [config] tied-embeddings: false
[2023-06-20 23:11:40] [config] tied-embeddings-all: false
[2023-06-20 23:11:40] [config] tied-embeddings-src: false
[2023-06-20 23:11:40] [config] train-embedder-rank:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] train-sets:
[2023-06-20 23:11:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:11:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:11:40] [config] transformer-aan-activation: swish
[2023-06-20 23:11:40] [config] transformer-aan-depth: 2
[2023-06-20 23:11:40] [config] transformer-aan-nogate: false
[2023-06-20 23:11:40] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:11:40] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:11:40] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:11:40] [config] transformer-depth-scaling: false
[2023-06-20 23:11:40] [config] transformer-dim-aan: 2048
[2023-06-20 23:11:40] [config] transformer-dim-ffn: 2048
[2023-06-20 23:11:40] [config] transformer-dropout: 0
[2023-06-20 23:11:40] [config] transformer-dropout-attention: 0
[2023-06-20 23:11:40] [config] transformer-dropout-ffn: 0
[2023-06-20 23:11:40] [config] transformer-ffn-activation: swish
[2023-06-20 23:11:40] [config] transformer-ffn-depth: 2
[2023-06-20 23:11:40] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:11:40] [config] transformer-heads: 8
[2023-06-20 23:11:40] [config] transformer-no-projection: false
[2023-06-20 23:11:40] [config] transformer-pool: false
[2023-06-20 23:11:40] [config] transformer-postprocess: dan
[2023-06-20 23:11:40] [config] transformer-postprocess-emb: d
[2023-06-20 23:11:40] [config] transformer-postprocess-top: ""
[2023-06-20 23:11:40] [config] transformer-preprocess: ""
[2023-06-20 23:11:40] [config] transformer-tied-layers:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] transformer-train-position-embeddings: false
[2023-06-20 23:11:40] [config] tsv: false
[2023-06-20 23:11:40] [config] tsv-fields: 0
[2023-06-20 23:11:40] [config] type: amun
[2023-06-20 23:11:40] [config] ulr: false
[2023-06-20 23:11:40] [config] ulr-dim-emb: 0
[2023-06-20 23:11:40] [config] ulr-dropout: 0
[2023-06-20 23:11:40] [config] ulr-keys-vectors: ""
[2023-06-20 23:11:40] [config] ulr-query-vectors: ""
[2023-06-20 23:11:40] [config] ulr-softmax-temperature: 1
[2023-06-20 23:11:40] [config] ulr-trainable-transformation: false
[2023-06-20 23:11:40] [config] unlikelihood-loss: false
[2023-06-20 23:11:40] [config] valid-freq: 5000000
[2023-06-20 23:11:40] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:11:40] [config] valid-max-length: 1000
[2023-06-20 23:11:40] [config] valid-metrics:
[2023-06-20 23:11:40] [config]   - cross-entropy
[2023-06-20 23:11:40] [config] valid-mini-batch: 32
[2023-06-20 23:11:40] [config] valid-reset-stalled: false
[2023-06-20 23:11:40] [config] valid-script-args:
[2023-06-20 23:11:40] [config]   []
[2023-06-20 23:11:40] [config] valid-script-path: ""
[2023-06-20 23:11:40] [config] valid-sets:
[2023-06-20 23:11:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:11:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:11:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:11:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:11:40] [config] vocabs:
[2023-06-20 23:11:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:11:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:11:40] [config] word-penalty: 0
[2023-06-20 23:11:40] [config] word-scores: false
[2023-06-20 23:11:40] [config] workspace: 3000
[2023-06-20 23:11:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:11:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:11:40] [training] Using single-device training
[2023-06-20 23:11:40] Synced seed 1234
[2023-06-20 23:11:40] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:11:40] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:11:40] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:11:40] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:11:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:11:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:11:42] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:11:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:11:42] [comm] Using global sharding
[2023-06-20 23:11:42] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:11:42] [training] Using 1 GPUs
[2023-06-20 23:11:42] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:11:42] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:11:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:11:43] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:11:56] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:11:56] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:11:56] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:11:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:11:56] [comm] Using global sharding
[2023-06-20 23:11:56] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:11:56] [training] Using 1 GPUs
[2023-06-20 23:11:58] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:12:03] Loading Adam parameters
[2023-06-20 23:12:04] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:12:04] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:12:04] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:12:04] [data] Restoring the corpus state to epoch 61, batch 7198
[2023-06-20 23:12:04] [data] Shuffling data
[2023-06-20 23:12:04] [data] Done reading 20,192 sentences
[2023-06-20 23:12:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:12:04] Training started
[2023-06-20 23:12:04] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 23:12:04] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:12:04] Parameter type float32, optimization type float32, casting types false
[2023-06-20 23:12:48] Seen 18,843 samples
[2023-06-20 23:12:48] Starting data epoch 62 in logical epoch 62
[2023-06-20 23:12:48] [data] Shuffling data
[2023-06-20 23:12:48] [data] Done reading 20,192 sentences
[2023-06-20 23:12:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:13:34] Seen 18,843 samples
[2023-06-20 23:13:34] Starting data epoch 63 in logical epoch 63
[2023-06-20 23:13:34] [data] Shuffling data
[2023-06-20 23:13:34] [data] Done reading 20,192 sentences
[2023-06-20 23:13:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:14:20] Seen 18,843 samples
[2023-06-20 23:14:20] Starting data epoch 64 in logical epoch 64
[2023-06-20 23:14:20] [data] Shuffling data
[2023-06-20 23:14:20] [data] Done reading 20,192 sentences
[2023-06-20 23:14:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:15:06] Seen 18,843 samples
[2023-06-20 23:15:06] Starting data epoch 65 in logical epoch 65
[2023-06-20 23:15:06] [data] Shuffling data
[2023-06-20 23:15:06] [data] Done reading 20,192 sentences
[2023-06-20 23:15:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:15:52] Seen 18,843 samples
[2023-06-20 23:15:52] Starting data epoch 66 in logical epoch 66
[2023-06-20 23:15:52] [data] Shuffling data
[2023-06-20 23:15:52] [data] Done reading 20,192 sentences
[2023-06-20 23:15:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:16:38] Seen 18,843 samples
[2023-06-20 23:16:38] Starting data epoch 67 in logical epoch 67
[2023-06-20 23:16:38] [data] Shuffling data
[2023-06-20 23:16:38] [data] Done reading 20,192 sentences
[2023-06-20 23:16:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:17:10] Ep. 67 : Up. 8000 : Sen. 13,561 : Cost 0.68413067 * 3,327,026 @ 4,730 after 26,541,954 : Time 314.07s : 10593.31 words/s : gNorm 1.0292
[2023-06-20 23:17:24] Seen 18,843 samples
[2023-06-20 23:17:24] Starting data epoch 68 in logical epoch 68
[2023-06-20 23:17:24] [data] Shuffling data
[2023-06-20 23:17:24] [data] Done reading 20,192 sentences
[2023-06-20 23:17:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:18:10] Seen 18,843 samples
[2023-06-20 23:18:10] Starting data epoch 69 in logical epoch 69
[2023-06-20 23:18:10] [data] Shuffling data
[2023-06-20 23:18:10] [data] Done reading 20,192 sentences
[2023-06-20 23:18:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:18:56] Seen 18,843 samples
[2023-06-20 23:18:56] Starting data epoch 70 in logical epoch 70
[2023-06-20 23:18:56] [data] Shuffling data
[2023-06-20 23:18:56] [data] Done reading 20,192 sentences
[2023-06-20 23:18:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:19:42] Seen 18,843 samples
[2023-06-20 23:19:42] Starting data epoch 71 in logical epoch 71
[2023-06-20 23:19:42] Training finished
[2023-06-20 23:19:48] [valid] Ep. 71 : Up. 8395 : cross-entropy : 99.8775 : stalled 4 times (last best: 90.9633)
[2023-06-20 23:19:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:19:52] Saving Adam parameters
[2023-06-20 23:19:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:24:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:24:42] [marian] Running on node17.datos.cluster.uy as process 36083 with command line:
[2023-06-20 23:24:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 80 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:24:42] [config] after: 0e
[2023-06-20 23:24:42] [config] after-batches: 0
[2023-06-20 23:24:42] [config] after-epochs: 80
[2023-06-20 23:24:42] [config] all-caps-every: 0
[2023-06-20 23:24:42] [config] allow-unk: false
[2023-06-20 23:24:42] [config] authors: false
[2023-06-20 23:24:42] [config] beam-size: 12
[2023-06-20 23:24:42] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:24:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:24:42] [config] bert-masking-fraction: 0.15
[2023-06-20 23:24:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:24:42] [config] bert-train-type-embeddings: true
[2023-06-20 23:24:42] [config] bert-type-vocab-size: 2
[2023-06-20 23:24:42] [config] build-info: ""
[2023-06-20 23:24:42] [config] check-gradient-nan: false
[2023-06-20 23:24:42] [config] check-nan: false
[2023-06-20 23:24:42] [config] cite: false
[2023-06-20 23:24:42] [config] clip-norm: 1
[2023-06-20 23:24:42] [config] cost-scaling:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] cost-type: ce-sum
[2023-06-20 23:24:42] [config] cpu-threads: 0
[2023-06-20 23:24:42] [config] data-threads: 8
[2023-06-20 23:24:42] [config] data-weighting: ""
[2023-06-20 23:24:42] [config] data-weighting-type: sentence
[2023-06-20 23:24:42] [config] dec-cell: gru
[2023-06-20 23:24:42] [config] dec-cell-base-depth: 2
[2023-06-20 23:24:42] [config] dec-cell-high-depth: 1
[2023-06-20 23:24:42] [config] dec-depth: 1
[2023-06-20 23:24:42] [config] devices:
[2023-06-20 23:24:42] [config]   - 0
[2023-06-20 23:24:42] [config] dim-emb: 512
[2023-06-20 23:24:42] [config] dim-rnn: 1024
[2023-06-20 23:24:42] [config] dim-vocabs:
[2023-06-20 23:24:42] [config]   - 54042
[2023-06-20 23:24:42] [config]   - 36507
[2023-06-20 23:24:42] [config] disp-first: 0
[2023-06-20 23:24:42] [config] disp-freq: 1000u
[2023-06-20 23:24:42] [config] disp-label-counts: true
[2023-06-20 23:24:42] [config] dropout-rnn: 0.2
[2023-06-20 23:24:42] [config] dropout-src: 0.1
[2023-06-20 23:24:42] [config] dropout-trg: 0.1
[2023-06-20 23:24:42] [config] dump-config: ""
[2023-06-20 23:24:42] [config] dynamic-gradient-scaling:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] early-stopping: 5
[2023-06-20 23:24:42] [config] early-stopping-on: first
[2023-06-20 23:24:42] [config] embedding-fix-src: false
[2023-06-20 23:24:42] [config] embedding-fix-trg: false
[2023-06-20 23:24:42] [config] embedding-normalization: false
[2023-06-20 23:24:42] [config] embedding-vectors:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] enc-cell: gru
[2023-06-20 23:24:42] [config] enc-cell-depth: 1
[2023-06-20 23:24:42] [config] enc-depth: 1
[2023-06-20 23:24:42] [config] enc-type: bidirectional
[2023-06-20 23:24:42] [config] english-title-case-every: 0
[2023-06-20 23:24:42] [config] exponential-smoothing: 0
[2023-06-20 23:24:42] [config] factor-weight: 1
[2023-06-20 23:24:42] [config] factors-combine: sum
[2023-06-20 23:24:42] [config] factors-dim-emb: 0
[2023-06-20 23:24:42] [config] gradient-checkpointing: false
[2023-06-20 23:24:42] [config] gradient-norm-average-window: 100
[2023-06-20 23:24:42] [config] guided-alignment: none
[2023-06-20 23:24:42] [config] guided-alignment-cost: mse
[2023-06-20 23:24:42] [config] guided-alignment-weight: 0.1
[2023-06-20 23:24:42] [config] ignore-model-config: false
[2023-06-20 23:24:42] [config] input-types:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] interpolate-env-vars: false
[2023-06-20 23:24:42] [config] keep-best: false
[2023-06-20 23:24:42] [config] label-smoothing: 0
[2023-06-20 23:24:42] [config] layer-normalization: true
[2023-06-20 23:24:42] [config] learn-rate: 0.0001
[2023-06-20 23:24:42] [config] lemma-dependency: ""
[2023-06-20 23:24:42] [config] lemma-dim-emb: 0
[2023-06-20 23:24:42] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:24:42] [config] log-level: info
[2023-06-20 23:24:42] [config] log-time-zone: ""
[2023-06-20 23:24:42] [config] logical-epoch:
[2023-06-20 23:24:42] [config]   - 1e
[2023-06-20 23:24:42] [config]   - 0
[2023-06-20 23:24:42] [config] lr-decay: 0
[2023-06-20 23:24:42] [config] lr-decay-freq: 50000
[2023-06-20 23:24:42] [config] lr-decay-inv-sqrt:
[2023-06-20 23:24:42] [config]   - 0
[2023-06-20 23:24:42] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:24:42] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:24:42] [config] lr-decay-start:
[2023-06-20 23:24:42] [config]   - 10
[2023-06-20 23:24:42] [config]   - 1
[2023-06-20 23:24:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:24:42] [config] lr-report: false
[2023-06-20 23:24:42] [config] lr-warmup: 0
[2023-06-20 23:24:42] [config] lr-warmup-at-reload: false
[2023-06-20 23:24:42] [config] lr-warmup-cycle: false
[2023-06-20 23:24:42] [config] lr-warmup-start-rate: 0
[2023-06-20 23:24:42] [config] max-length: 50
[2023-06-20 23:24:42] [config] max-length-crop: false
[2023-06-20 23:24:42] [config] max-length-factor: 3
[2023-06-20 23:24:42] [config] maxi-batch: 100
[2023-06-20 23:24:42] [config] maxi-batch-sort: trg
[2023-06-20 23:24:42] [config] mini-batch: 64
[2023-06-20 23:24:42] [config] mini-batch-fit: true
[2023-06-20 23:24:42] [config] mini-batch-fit-step: 10
[2023-06-20 23:24:42] [config] mini-batch-round-up: true
[2023-06-20 23:24:42] [config] mini-batch-track-lr: false
[2023-06-20 23:24:42] [config] mini-batch-warmup: 0
[2023-06-20 23:24:42] [config] mini-batch-words: 0
[2023-06-20 23:24:42] [config] mini-batch-words-ref: 0
[2023-06-20 23:24:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:24:42] [config] multi-loss-type: sum
[2023-06-20 23:24:42] [config] n-best: false
[2023-06-20 23:24:42] [config] no-nccl: false
[2023-06-20 23:24:42] [config] no-reload: false
[2023-06-20 23:24:42] [config] no-restore-corpus: false
[2023-06-20 23:24:42] [config] normalize: 0
[2023-06-20 23:24:42] [config] normalize-gradient: false
[2023-06-20 23:24:42] [config] num-devices: 0
[2023-06-20 23:24:42] [config] optimizer: adam
[2023-06-20 23:24:42] [config] optimizer-delay: 1
[2023-06-20 23:24:42] [config] optimizer-params:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] output-omit-bias: false
[2023-06-20 23:24:42] [config] overwrite: false
[2023-06-20 23:24:42] [config] precision:
[2023-06-20 23:24:42] [config]   - float32
[2023-06-20 23:24:42] [config]   - float32
[2023-06-20 23:24:42] [config] pretrained-model: ""
[2023-06-20 23:24:42] [config] quantize-biases: false
[2023-06-20 23:24:42] [config] quantize-bits: 0
[2023-06-20 23:24:42] [config] quantize-log-based: false
[2023-06-20 23:24:42] [config] quantize-optimization-steps: 0
[2023-06-20 23:24:42] [config] quiet: false
[2023-06-20 23:24:42] [config] quiet-translation: true
[2023-06-20 23:24:42] [config] relative-paths: false
[2023-06-20 23:24:42] [config] right-left: false
[2023-06-20 23:24:42] [config] save-freq: 10000u
[2023-06-20 23:24:42] [config] seed: 1234
[2023-06-20 23:24:42] [config] sentencepiece-alphas:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:24:42] [config] sentencepiece-options: ""
[2023-06-20 23:24:42] [config] sharding: global
[2023-06-20 23:24:42] [config] shuffle: data
[2023-06-20 23:24:42] [config] shuffle-in-ram: false
[2023-06-20 23:24:42] [config] sigterm: save-and-exit
[2023-06-20 23:24:42] [config] skip: false
[2023-06-20 23:24:42] [config] sqlite: ""
[2023-06-20 23:24:42] [config] sqlite-drop: false
[2023-06-20 23:24:42] [config] sync-freq: 200u
[2023-06-20 23:24:42] [config] sync-sgd: false
[2023-06-20 23:24:42] [config] tempdir: /tmp
[2023-06-20 23:24:42] [config] tied-embeddings: false
[2023-06-20 23:24:42] [config] tied-embeddings-all: false
[2023-06-20 23:24:42] [config] tied-embeddings-src: false
[2023-06-20 23:24:42] [config] train-embedder-rank:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] train-sets:
[2023-06-20 23:24:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:24:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:24:42] [config] transformer-aan-activation: swish
[2023-06-20 23:24:42] [config] transformer-aan-depth: 2
[2023-06-20 23:24:42] [config] transformer-aan-nogate: false
[2023-06-20 23:24:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:24:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:24:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:24:42] [config] transformer-depth-scaling: false
[2023-06-20 23:24:42] [config] transformer-dim-aan: 2048
[2023-06-20 23:24:42] [config] transformer-dim-ffn: 2048
[2023-06-20 23:24:42] [config] transformer-dropout: 0
[2023-06-20 23:24:42] [config] transformer-dropout-attention: 0
[2023-06-20 23:24:42] [config] transformer-dropout-ffn: 0
[2023-06-20 23:24:42] [config] transformer-ffn-activation: swish
[2023-06-20 23:24:42] [config] transformer-ffn-depth: 2
[2023-06-20 23:24:42] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:24:42] [config] transformer-heads: 8
[2023-06-20 23:24:42] [config] transformer-no-projection: false
[2023-06-20 23:24:42] [config] transformer-pool: false
[2023-06-20 23:24:42] [config] transformer-postprocess: dan
[2023-06-20 23:24:42] [config] transformer-postprocess-emb: d
[2023-06-20 23:24:42] [config] transformer-postprocess-top: ""
[2023-06-20 23:24:42] [config] transformer-preprocess: ""
[2023-06-20 23:24:42] [config] transformer-tied-layers:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] transformer-train-position-embeddings: false
[2023-06-20 23:24:42] [config] tsv: false
[2023-06-20 23:24:42] [config] tsv-fields: 0
[2023-06-20 23:24:42] [config] type: amun
[2023-06-20 23:24:42] [config] ulr: false
[2023-06-20 23:24:42] [config] ulr-dim-emb: 0
[2023-06-20 23:24:42] [config] ulr-dropout: 0
[2023-06-20 23:24:42] [config] ulr-keys-vectors: ""
[2023-06-20 23:24:42] [config] ulr-query-vectors: ""
[2023-06-20 23:24:42] [config] ulr-softmax-temperature: 1
[2023-06-20 23:24:42] [config] ulr-trainable-transformation: false
[2023-06-20 23:24:42] [config] unlikelihood-loss: false
[2023-06-20 23:24:42] [config] valid-freq: 5000000
[2023-06-20 23:24:42] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:24:42] [config] valid-max-length: 1000
[2023-06-20 23:24:42] [config] valid-metrics:
[2023-06-20 23:24:42] [config]   - cross-entropy
[2023-06-20 23:24:42] [config] valid-mini-batch: 32
[2023-06-20 23:24:42] [config] valid-reset-stalled: false
[2023-06-20 23:24:42] [config] valid-script-args:
[2023-06-20 23:24:42] [config]   []
[2023-06-20 23:24:42] [config] valid-script-path: ""
[2023-06-20 23:24:42] [config] valid-sets:
[2023-06-20 23:24:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:24:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:24:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:24:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:24:42] [config] vocabs:
[2023-06-20 23:24:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:24:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:24:42] [config] word-penalty: 0
[2023-06-20 23:24:42] [config] word-scores: false
[2023-06-20 23:24:42] [config] workspace: 3000
[2023-06-20 23:24:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:24:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:24:42] [training] Using single-device training
[2023-06-20 23:24:42] Synced seed 1234
[2023-06-20 23:24:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:24:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:24:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:24:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:24:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:24:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:24:44] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:24:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:24:44] [comm] Using global sharding
[2023-06-20 23:24:44] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:24:44] [training] Using 1 GPUs
[2023-06-20 23:24:44] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:24:44] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:24:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:24:45] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:24:58] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:24:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:24:58] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:24:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:24:58] [comm] Using global sharding
[2023-06-20 23:24:58] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:24:58] [training] Using 1 GPUs
[2023-06-20 23:24:58] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:25:00] Loading Adam parameters
[2023-06-20 23:25:01] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:25:01] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:25:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:25:01] [data] Restoring the corpus state to epoch 71, batch 8395
[2023-06-20 23:25:01] [data] Shuffling data
[2023-06-20 23:25:01] [data] Done reading 20,192 sentences
[2023-06-20 23:25:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:25:01] Training started
[2023-06-20 23:25:01] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-20 23:25:01] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:25:01] Parameter type float32, optimization type float32, casting types false
[2023-06-20 23:25:46] Seen 18,843 samples
[2023-06-20 23:25:46] Starting data epoch 72 in logical epoch 72
[2023-06-20 23:25:46] [data] Shuffling data
[2023-06-20 23:25:46] [data] Done reading 20,192 sentences
[2023-06-20 23:25:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:26:31] Seen 18,843 samples
[2023-06-20 23:26:31] Starting data epoch 73 in logical epoch 73
[2023-06-20 23:26:31] [data] Shuffling data
[2023-06-20 23:26:31] [data] Done reading 20,192 sentences
[2023-06-20 23:26:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:27:17] Seen 18,843 samples
[2023-06-20 23:27:17] Starting data epoch 74 in logical epoch 74
[2023-06-20 23:27:17] [data] Shuffling data
[2023-06-20 23:27:17] [data] Done reading 20,192 sentences
[2023-06-20 23:27:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:28:03] Seen 18,843 samples
[2023-06-20 23:28:03] Starting data epoch 75 in logical epoch 75
[2023-06-20 23:28:03] [data] Shuffling data
[2023-06-20 23:28:03] [data] Done reading 20,192 sentences
[2023-06-20 23:28:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:28:49] Seen 18,843 samples
[2023-06-20 23:28:49] Starting data epoch 76 in logical epoch 76
[2023-06-20 23:28:49] [data] Shuffling data
[2023-06-20 23:28:49] [data] Done reading 20,192 sentences
[2023-06-20 23:28:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:28:52] Ep. 76 : Up. 9000 : Sen. 871 : Cost 0.52346247 * 3,329,440 @ 3,776 after 29,871,394 : Time 234.23s : 14214.46 words/s : gNorm 0.9262
[2023-06-20 23:29:35] Seen 18,843 samples
[2023-06-20 23:29:35] Starting data epoch 77 in logical epoch 77
[2023-06-20 23:29:35] [data] Shuffling data
[2023-06-20 23:29:35] [data] Done reading 20,192 sentences
[2023-06-20 23:29:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:30:21] Seen 18,843 samples
[2023-06-20 23:30:21] Starting data epoch 78 in logical epoch 78
[2023-06-20 23:30:21] [data] Shuffling data
[2023-06-20 23:30:21] [data] Done reading 20,192 sentences
[2023-06-20 23:30:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:31:07] Seen 18,843 samples
[2023-06-20 23:31:07] Starting data epoch 79 in logical epoch 79
[2023-06-20 23:31:07] [data] Shuffling data
[2023-06-20 23:31:07] [data] Done reading 20,192 sentences
[2023-06-20 23:31:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:31:53] Seen 18,843 samples
[2023-06-20 23:31:53] Starting data epoch 80 in logical epoch 80
[2023-06-20 23:31:53] [data] Shuffling data
[2023-06-20 23:31:53] [data] Done reading 20,192 sentences
[2023-06-20 23:31:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:32:39] Seen 18,843 samples
[2023-06-20 23:32:39] Starting data epoch 81 in logical epoch 81
[2023-06-20 23:32:39] Training finished
[2023-06-20 23:32:46] [valid] Ep. 81 : Up. 9592 : cross-entropy : 102.371 : stalled 5 times (last best: 90.9633)
[2023-06-20 23:32:46] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:32:50] Saving Adam parameters
[2023-06-20 23:32:51] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:37:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:37:21] [marian] Running on node17.datos.cluster.uy as process 37154 with command line:
[2023-06-20 23:37:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 90 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:37:21] [config] after: 0e
[2023-06-20 23:37:21] [config] after-batches: 0
[2023-06-20 23:37:21] [config] after-epochs: 90
[2023-06-20 23:37:21] [config] all-caps-every: 0
[2023-06-20 23:37:21] [config] allow-unk: false
[2023-06-20 23:37:21] [config] authors: false
[2023-06-20 23:37:21] [config] beam-size: 12
[2023-06-20 23:37:21] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:37:21] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:37:21] [config] bert-masking-fraction: 0.15
[2023-06-20 23:37:21] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:37:21] [config] bert-train-type-embeddings: true
[2023-06-20 23:37:21] [config] bert-type-vocab-size: 2
[2023-06-20 23:37:21] [config] build-info: ""
[2023-06-20 23:37:21] [config] check-gradient-nan: false
[2023-06-20 23:37:21] [config] check-nan: false
[2023-06-20 23:37:21] [config] cite: false
[2023-06-20 23:37:21] [config] clip-norm: 1
[2023-06-20 23:37:21] [config] cost-scaling:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] cost-type: ce-sum
[2023-06-20 23:37:21] [config] cpu-threads: 0
[2023-06-20 23:37:21] [config] data-threads: 8
[2023-06-20 23:37:21] [config] data-weighting: ""
[2023-06-20 23:37:21] [config] data-weighting-type: sentence
[2023-06-20 23:37:21] [config] dec-cell: gru
[2023-06-20 23:37:21] [config] dec-cell-base-depth: 2
[2023-06-20 23:37:21] [config] dec-cell-high-depth: 1
[2023-06-20 23:37:21] [config] dec-depth: 1
[2023-06-20 23:37:21] [config] devices:
[2023-06-20 23:37:21] [config]   - 0
[2023-06-20 23:37:21] [config] dim-emb: 512
[2023-06-20 23:37:21] [config] dim-rnn: 1024
[2023-06-20 23:37:21] [config] dim-vocabs:
[2023-06-20 23:37:21] [config]   - 54042
[2023-06-20 23:37:21] [config]   - 36507
[2023-06-20 23:37:21] [config] disp-first: 0
[2023-06-20 23:37:21] [config] disp-freq: 1000u
[2023-06-20 23:37:21] [config] disp-label-counts: true
[2023-06-20 23:37:21] [config] dropout-rnn: 0.2
[2023-06-20 23:37:21] [config] dropout-src: 0.1
[2023-06-20 23:37:21] [config] dropout-trg: 0.1
[2023-06-20 23:37:21] [config] dump-config: ""
[2023-06-20 23:37:21] [config] dynamic-gradient-scaling:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] early-stopping: 5
[2023-06-20 23:37:21] [config] early-stopping-on: first
[2023-06-20 23:37:21] [config] embedding-fix-src: false
[2023-06-20 23:37:21] [config] embedding-fix-trg: false
[2023-06-20 23:37:21] [config] embedding-normalization: false
[2023-06-20 23:37:21] [config] embedding-vectors:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] enc-cell: gru
[2023-06-20 23:37:21] [config] enc-cell-depth: 1
[2023-06-20 23:37:21] [config] enc-depth: 1
[2023-06-20 23:37:21] [config] enc-type: bidirectional
[2023-06-20 23:37:21] [config] english-title-case-every: 0
[2023-06-20 23:37:21] [config] exponential-smoothing: 0
[2023-06-20 23:37:21] [config] factor-weight: 1
[2023-06-20 23:37:21] [config] factors-combine: sum
[2023-06-20 23:37:21] [config] factors-dim-emb: 0
[2023-06-20 23:37:21] [config] gradient-checkpointing: false
[2023-06-20 23:37:21] [config] gradient-norm-average-window: 100
[2023-06-20 23:37:21] [config] guided-alignment: none
[2023-06-20 23:37:21] [config] guided-alignment-cost: mse
[2023-06-20 23:37:21] [config] guided-alignment-weight: 0.1
[2023-06-20 23:37:21] [config] ignore-model-config: false
[2023-06-20 23:37:21] [config] input-types:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] interpolate-env-vars: false
[2023-06-20 23:37:21] [config] keep-best: false
[2023-06-20 23:37:21] [config] label-smoothing: 0
[2023-06-20 23:37:21] [config] layer-normalization: true
[2023-06-20 23:37:21] [config] learn-rate: 0.0001
[2023-06-20 23:37:21] [config] lemma-dependency: ""
[2023-06-20 23:37:21] [config] lemma-dim-emb: 0
[2023-06-20 23:37:21] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:37:21] [config] log-level: info
[2023-06-20 23:37:21] [config] log-time-zone: ""
[2023-06-20 23:37:21] [config] logical-epoch:
[2023-06-20 23:37:21] [config]   - 1e
[2023-06-20 23:37:21] [config]   - 0
[2023-06-20 23:37:21] [config] lr-decay: 0
[2023-06-20 23:37:21] [config] lr-decay-freq: 50000
[2023-06-20 23:37:21] [config] lr-decay-inv-sqrt:
[2023-06-20 23:37:21] [config]   - 0
[2023-06-20 23:37:21] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:37:21] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:37:21] [config] lr-decay-start:
[2023-06-20 23:37:21] [config]   - 10
[2023-06-20 23:37:21] [config]   - 1
[2023-06-20 23:37:21] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:37:21] [config] lr-report: false
[2023-06-20 23:37:21] [config] lr-warmup: 0
[2023-06-20 23:37:21] [config] lr-warmup-at-reload: false
[2023-06-20 23:37:21] [config] lr-warmup-cycle: false
[2023-06-20 23:37:21] [config] lr-warmup-start-rate: 0
[2023-06-20 23:37:21] [config] max-length: 50
[2023-06-20 23:37:21] [config] max-length-crop: false
[2023-06-20 23:37:21] [config] max-length-factor: 3
[2023-06-20 23:37:21] [config] maxi-batch: 100
[2023-06-20 23:37:21] [config] maxi-batch-sort: trg
[2023-06-20 23:37:21] [config] mini-batch: 64
[2023-06-20 23:37:21] [config] mini-batch-fit: true
[2023-06-20 23:37:21] [config] mini-batch-fit-step: 10
[2023-06-20 23:37:21] [config] mini-batch-round-up: true
[2023-06-20 23:37:21] [config] mini-batch-track-lr: false
[2023-06-20 23:37:21] [config] mini-batch-warmup: 0
[2023-06-20 23:37:21] [config] mini-batch-words: 0
[2023-06-20 23:37:21] [config] mini-batch-words-ref: 0
[2023-06-20 23:37:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:37:21] [config] multi-loss-type: sum
[2023-06-20 23:37:21] [config] n-best: false
[2023-06-20 23:37:21] [config] no-nccl: false
[2023-06-20 23:37:21] [config] no-reload: false
[2023-06-20 23:37:21] [config] no-restore-corpus: false
[2023-06-20 23:37:21] [config] normalize: 0
[2023-06-20 23:37:21] [config] normalize-gradient: false
[2023-06-20 23:37:21] [config] num-devices: 0
[2023-06-20 23:37:21] [config] optimizer: adam
[2023-06-20 23:37:21] [config] optimizer-delay: 1
[2023-06-20 23:37:21] [config] optimizer-params:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] output-omit-bias: false
[2023-06-20 23:37:21] [config] overwrite: false
[2023-06-20 23:37:21] [config] precision:
[2023-06-20 23:37:21] [config]   - float32
[2023-06-20 23:37:21] [config]   - float32
[2023-06-20 23:37:21] [config] pretrained-model: ""
[2023-06-20 23:37:21] [config] quantize-biases: false
[2023-06-20 23:37:21] [config] quantize-bits: 0
[2023-06-20 23:37:21] [config] quantize-log-based: false
[2023-06-20 23:37:21] [config] quantize-optimization-steps: 0
[2023-06-20 23:37:21] [config] quiet: false
[2023-06-20 23:37:21] [config] quiet-translation: true
[2023-06-20 23:37:21] [config] relative-paths: false
[2023-06-20 23:37:21] [config] right-left: false
[2023-06-20 23:37:21] [config] save-freq: 10000u
[2023-06-20 23:37:21] [config] seed: 1234
[2023-06-20 23:37:21] [config] sentencepiece-alphas:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:37:21] [config] sentencepiece-options: ""
[2023-06-20 23:37:21] [config] sharding: global
[2023-06-20 23:37:21] [config] shuffle: data
[2023-06-20 23:37:21] [config] shuffle-in-ram: false
[2023-06-20 23:37:21] [config] sigterm: save-and-exit
[2023-06-20 23:37:21] [config] skip: false
[2023-06-20 23:37:21] [config] sqlite: ""
[2023-06-20 23:37:21] [config] sqlite-drop: false
[2023-06-20 23:37:21] [config] sync-freq: 200u
[2023-06-20 23:37:21] [config] sync-sgd: false
[2023-06-20 23:37:21] [config] tempdir: /tmp
[2023-06-20 23:37:21] [config] tied-embeddings: false
[2023-06-20 23:37:21] [config] tied-embeddings-all: false
[2023-06-20 23:37:21] [config] tied-embeddings-src: false
[2023-06-20 23:37:21] [config] train-embedder-rank:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] train-sets:
[2023-06-20 23:37:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:37:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:37:21] [config] transformer-aan-activation: swish
[2023-06-20 23:37:21] [config] transformer-aan-depth: 2
[2023-06-20 23:37:21] [config] transformer-aan-nogate: false
[2023-06-20 23:37:21] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:37:21] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:37:21] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:37:21] [config] transformer-depth-scaling: false
[2023-06-20 23:37:21] [config] transformer-dim-aan: 2048
[2023-06-20 23:37:21] [config] transformer-dim-ffn: 2048
[2023-06-20 23:37:21] [config] transformer-dropout: 0
[2023-06-20 23:37:21] [config] transformer-dropout-attention: 0
[2023-06-20 23:37:21] [config] transformer-dropout-ffn: 0
[2023-06-20 23:37:21] [config] transformer-ffn-activation: swish
[2023-06-20 23:37:21] [config] transformer-ffn-depth: 2
[2023-06-20 23:37:21] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:37:21] [config] transformer-heads: 8
[2023-06-20 23:37:21] [config] transformer-no-projection: false
[2023-06-20 23:37:21] [config] transformer-pool: false
[2023-06-20 23:37:21] [config] transformer-postprocess: dan
[2023-06-20 23:37:21] [config] transformer-postprocess-emb: d
[2023-06-20 23:37:21] [config] transformer-postprocess-top: ""
[2023-06-20 23:37:21] [config] transformer-preprocess: ""
[2023-06-20 23:37:21] [config] transformer-tied-layers:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] transformer-train-position-embeddings: false
[2023-06-20 23:37:21] [config] tsv: false
[2023-06-20 23:37:21] [config] tsv-fields: 0
[2023-06-20 23:37:21] [config] type: amun
[2023-06-20 23:37:21] [config] ulr: false
[2023-06-20 23:37:21] [config] ulr-dim-emb: 0
[2023-06-20 23:37:21] [config] ulr-dropout: 0
[2023-06-20 23:37:21] [config] ulr-keys-vectors: ""
[2023-06-20 23:37:21] [config] ulr-query-vectors: ""
[2023-06-20 23:37:21] [config] ulr-softmax-temperature: 1
[2023-06-20 23:37:21] [config] ulr-trainable-transformation: false
[2023-06-20 23:37:21] [config] unlikelihood-loss: false
[2023-06-20 23:37:21] [config] valid-freq: 5000000
[2023-06-20 23:37:21] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:37:21] [config] valid-max-length: 1000
[2023-06-20 23:37:21] [config] valid-metrics:
[2023-06-20 23:37:21] [config]   - cross-entropy
[2023-06-20 23:37:21] [config] valid-mini-batch: 32
[2023-06-20 23:37:21] [config] valid-reset-stalled: false
[2023-06-20 23:37:21] [config] valid-script-args:
[2023-06-20 23:37:21] [config]   []
[2023-06-20 23:37:21] [config] valid-script-path: ""
[2023-06-20 23:37:21] [config] valid-sets:
[2023-06-20 23:37:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:37:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:37:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:37:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:37:21] [config] vocabs:
[2023-06-20 23:37:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:37:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:37:21] [config] word-penalty: 0
[2023-06-20 23:37:21] [config] word-scores: false
[2023-06-20 23:37:21] [config] workspace: 3000
[2023-06-20 23:37:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:37:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:37:21] [training] Using single-device training
[2023-06-20 23:37:21] Synced seed 1234
[2023-06-20 23:37:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:37:21] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:37:21] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:37:21] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:37:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:37:21] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:37:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:37:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:37:22] [comm] Using global sharding
[2023-06-20 23:37:23] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:37:23] [training] Using 1 GPUs
[2023-06-20 23:37:23] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:37:23] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:37:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:37:23] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:37:36] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:37:36] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:37:36] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:37:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:37:36] [comm] Using global sharding
[2023-06-20 23:37:37] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:37:37] [training] Using 1 GPUs
[2023-06-20 23:37:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:37:39] Loading Adam parameters
[2023-06-20 23:37:39] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:37:39] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:37:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:37:40] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-20 23:37:40] [data] Shuffling data
[2023-06-20 23:37:40] [data] Done reading 20,192 sentences
[2023-06-20 23:37:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:37:40] Training started
[2023-06-20 23:37:40] Training finished
[2023-06-20 23:42:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:42:04] [marian] Running on node17.datos.cluster.uy as process 37469 with command line:
[2023-06-20 23:42:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 100 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:42:04] [config] after: 0e
[2023-06-20 23:42:04] [config] after-batches: 0
[2023-06-20 23:42:04] [config] after-epochs: 100
[2023-06-20 23:42:04] [config] all-caps-every: 0
[2023-06-20 23:42:04] [config] allow-unk: false
[2023-06-20 23:42:04] [config] authors: false
[2023-06-20 23:42:04] [config] beam-size: 12
[2023-06-20 23:42:04] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:42:04] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:42:04] [config] bert-masking-fraction: 0.15
[2023-06-20 23:42:04] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:42:04] [config] bert-train-type-embeddings: true
[2023-06-20 23:42:04] [config] bert-type-vocab-size: 2
[2023-06-20 23:42:04] [config] build-info: ""
[2023-06-20 23:42:04] [config] check-gradient-nan: false
[2023-06-20 23:42:04] [config] check-nan: false
[2023-06-20 23:42:04] [config] cite: false
[2023-06-20 23:42:04] [config] clip-norm: 1
[2023-06-20 23:42:04] [config] cost-scaling:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] cost-type: ce-sum
[2023-06-20 23:42:04] [config] cpu-threads: 0
[2023-06-20 23:42:04] [config] data-threads: 8
[2023-06-20 23:42:04] [config] data-weighting: ""
[2023-06-20 23:42:04] [config] data-weighting-type: sentence
[2023-06-20 23:42:04] [config] dec-cell: gru
[2023-06-20 23:42:04] [config] dec-cell-base-depth: 2
[2023-06-20 23:42:04] [config] dec-cell-high-depth: 1
[2023-06-20 23:42:04] [config] dec-depth: 1
[2023-06-20 23:42:04] [config] devices:
[2023-06-20 23:42:04] [config]   - 0
[2023-06-20 23:42:04] [config] dim-emb: 512
[2023-06-20 23:42:04] [config] dim-rnn: 1024
[2023-06-20 23:42:04] [config] dim-vocabs:
[2023-06-20 23:42:04] [config]   - 54042
[2023-06-20 23:42:04] [config]   - 36507
[2023-06-20 23:42:04] [config] disp-first: 0
[2023-06-20 23:42:04] [config] disp-freq: 1000u
[2023-06-20 23:42:04] [config] disp-label-counts: true
[2023-06-20 23:42:04] [config] dropout-rnn: 0.2
[2023-06-20 23:42:04] [config] dropout-src: 0.1
[2023-06-20 23:42:04] [config] dropout-trg: 0.1
[2023-06-20 23:42:04] [config] dump-config: ""
[2023-06-20 23:42:04] [config] dynamic-gradient-scaling:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] early-stopping: 5
[2023-06-20 23:42:04] [config] early-stopping-on: first
[2023-06-20 23:42:04] [config] embedding-fix-src: false
[2023-06-20 23:42:04] [config] embedding-fix-trg: false
[2023-06-20 23:42:04] [config] embedding-normalization: false
[2023-06-20 23:42:04] [config] embedding-vectors:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] enc-cell: gru
[2023-06-20 23:42:04] [config] enc-cell-depth: 1
[2023-06-20 23:42:04] [config] enc-depth: 1
[2023-06-20 23:42:04] [config] enc-type: bidirectional
[2023-06-20 23:42:04] [config] english-title-case-every: 0
[2023-06-20 23:42:04] [config] exponential-smoothing: 0
[2023-06-20 23:42:04] [config] factor-weight: 1
[2023-06-20 23:42:04] [config] factors-combine: sum
[2023-06-20 23:42:04] [config] factors-dim-emb: 0
[2023-06-20 23:42:04] [config] gradient-checkpointing: false
[2023-06-20 23:42:04] [config] gradient-norm-average-window: 100
[2023-06-20 23:42:04] [config] guided-alignment: none
[2023-06-20 23:42:04] [config] guided-alignment-cost: mse
[2023-06-20 23:42:04] [config] guided-alignment-weight: 0.1
[2023-06-20 23:42:04] [config] ignore-model-config: false
[2023-06-20 23:42:04] [config] input-types:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] interpolate-env-vars: false
[2023-06-20 23:42:04] [config] keep-best: false
[2023-06-20 23:42:04] [config] label-smoothing: 0
[2023-06-20 23:42:04] [config] layer-normalization: true
[2023-06-20 23:42:04] [config] learn-rate: 0.0001
[2023-06-20 23:42:04] [config] lemma-dependency: ""
[2023-06-20 23:42:04] [config] lemma-dim-emb: 0
[2023-06-20 23:42:04] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:42:04] [config] log-level: info
[2023-06-20 23:42:04] [config] log-time-zone: ""
[2023-06-20 23:42:04] [config] logical-epoch:
[2023-06-20 23:42:04] [config]   - 1e
[2023-06-20 23:42:04] [config]   - 0
[2023-06-20 23:42:04] [config] lr-decay: 0
[2023-06-20 23:42:04] [config] lr-decay-freq: 50000
[2023-06-20 23:42:04] [config] lr-decay-inv-sqrt:
[2023-06-20 23:42:04] [config]   - 0
[2023-06-20 23:42:04] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:42:04] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:42:04] [config] lr-decay-start:
[2023-06-20 23:42:04] [config]   - 10
[2023-06-20 23:42:04] [config]   - 1
[2023-06-20 23:42:04] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:42:04] [config] lr-report: false
[2023-06-20 23:42:04] [config] lr-warmup: 0
[2023-06-20 23:42:04] [config] lr-warmup-at-reload: false
[2023-06-20 23:42:04] [config] lr-warmup-cycle: false
[2023-06-20 23:42:04] [config] lr-warmup-start-rate: 0
[2023-06-20 23:42:04] [config] max-length: 50
[2023-06-20 23:42:04] [config] max-length-crop: false
[2023-06-20 23:42:04] [config] max-length-factor: 3
[2023-06-20 23:42:04] [config] maxi-batch: 100
[2023-06-20 23:42:04] [config] maxi-batch-sort: trg
[2023-06-20 23:42:04] [config] mini-batch: 64
[2023-06-20 23:42:04] [config] mini-batch-fit: true
[2023-06-20 23:42:04] [config] mini-batch-fit-step: 10
[2023-06-20 23:42:04] [config] mini-batch-round-up: true
[2023-06-20 23:42:04] [config] mini-batch-track-lr: false
[2023-06-20 23:42:04] [config] mini-batch-warmup: 0
[2023-06-20 23:42:04] [config] mini-batch-words: 0
[2023-06-20 23:42:04] [config] mini-batch-words-ref: 0
[2023-06-20 23:42:04] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:42:04] [config] multi-loss-type: sum
[2023-06-20 23:42:04] [config] n-best: false
[2023-06-20 23:42:04] [config] no-nccl: false
[2023-06-20 23:42:04] [config] no-reload: false
[2023-06-20 23:42:04] [config] no-restore-corpus: false
[2023-06-20 23:42:04] [config] normalize: 0
[2023-06-20 23:42:04] [config] normalize-gradient: false
[2023-06-20 23:42:04] [config] num-devices: 0
[2023-06-20 23:42:04] [config] optimizer: adam
[2023-06-20 23:42:04] [config] optimizer-delay: 1
[2023-06-20 23:42:04] [config] optimizer-params:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] output-omit-bias: false
[2023-06-20 23:42:04] [config] overwrite: false
[2023-06-20 23:42:04] [config] precision:
[2023-06-20 23:42:04] [config]   - float32
[2023-06-20 23:42:04] [config]   - float32
[2023-06-20 23:42:04] [config] pretrained-model: ""
[2023-06-20 23:42:04] [config] quantize-biases: false
[2023-06-20 23:42:04] [config] quantize-bits: 0
[2023-06-20 23:42:04] [config] quantize-log-based: false
[2023-06-20 23:42:04] [config] quantize-optimization-steps: 0
[2023-06-20 23:42:04] [config] quiet: false
[2023-06-20 23:42:04] [config] quiet-translation: true
[2023-06-20 23:42:04] [config] relative-paths: false
[2023-06-20 23:42:04] [config] right-left: false
[2023-06-20 23:42:04] [config] save-freq: 10000u
[2023-06-20 23:42:04] [config] seed: 1234
[2023-06-20 23:42:04] [config] sentencepiece-alphas:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:42:04] [config] sentencepiece-options: ""
[2023-06-20 23:42:04] [config] sharding: global
[2023-06-20 23:42:04] [config] shuffle: data
[2023-06-20 23:42:04] [config] shuffle-in-ram: false
[2023-06-20 23:42:04] [config] sigterm: save-and-exit
[2023-06-20 23:42:04] [config] skip: false
[2023-06-20 23:42:04] [config] sqlite: ""
[2023-06-20 23:42:04] [config] sqlite-drop: false
[2023-06-20 23:42:04] [config] sync-freq: 200u
[2023-06-20 23:42:04] [config] sync-sgd: false
[2023-06-20 23:42:04] [config] tempdir: /tmp
[2023-06-20 23:42:04] [config] tied-embeddings: false
[2023-06-20 23:42:04] [config] tied-embeddings-all: false
[2023-06-20 23:42:04] [config] tied-embeddings-src: false
[2023-06-20 23:42:04] [config] train-embedder-rank:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] train-sets:
[2023-06-20 23:42:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:42:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:42:04] [config] transformer-aan-activation: swish
[2023-06-20 23:42:04] [config] transformer-aan-depth: 2
[2023-06-20 23:42:04] [config] transformer-aan-nogate: false
[2023-06-20 23:42:04] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:42:04] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:42:04] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:42:04] [config] transformer-depth-scaling: false
[2023-06-20 23:42:04] [config] transformer-dim-aan: 2048
[2023-06-20 23:42:04] [config] transformer-dim-ffn: 2048
[2023-06-20 23:42:04] [config] transformer-dropout: 0
[2023-06-20 23:42:04] [config] transformer-dropout-attention: 0
[2023-06-20 23:42:04] [config] transformer-dropout-ffn: 0
[2023-06-20 23:42:04] [config] transformer-ffn-activation: swish
[2023-06-20 23:42:04] [config] transformer-ffn-depth: 2
[2023-06-20 23:42:04] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:42:04] [config] transformer-heads: 8
[2023-06-20 23:42:04] [config] transformer-no-projection: false
[2023-06-20 23:42:04] [config] transformer-pool: false
[2023-06-20 23:42:04] [config] transformer-postprocess: dan
[2023-06-20 23:42:04] [config] transformer-postprocess-emb: d
[2023-06-20 23:42:04] [config] transformer-postprocess-top: ""
[2023-06-20 23:42:04] [config] transformer-preprocess: ""
[2023-06-20 23:42:04] [config] transformer-tied-layers:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] transformer-train-position-embeddings: false
[2023-06-20 23:42:04] [config] tsv: false
[2023-06-20 23:42:04] [config] tsv-fields: 0
[2023-06-20 23:42:04] [config] type: amun
[2023-06-20 23:42:04] [config] ulr: false
[2023-06-20 23:42:04] [config] ulr-dim-emb: 0
[2023-06-20 23:42:04] [config] ulr-dropout: 0
[2023-06-20 23:42:04] [config] ulr-keys-vectors: ""
[2023-06-20 23:42:04] [config] ulr-query-vectors: ""
[2023-06-20 23:42:04] [config] ulr-softmax-temperature: 1
[2023-06-20 23:42:04] [config] ulr-trainable-transformation: false
[2023-06-20 23:42:04] [config] unlikelihood-loss: false
[2023-06-20 23:42:04] [config] valid-freq: 5000000
[2023-06-20 23:42:04] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:42:04] [config] valid-max-length: 1000
[2023-06-20 23:42:04] [config] valid-metrics:
[2023-06-20 23:42:04] [config]   - cross-entropy
[2023-06-20 23:42:04] [config] valid-mini-batch: 32
[2023-06-20 23:42:04] [config] valid-reset-stalled: false
[2023-06-20 23:42:04] [config] valid-script-args:
[2023-06-20 23:42:04] [config]   []
[2023-06-20 23:42:04] [config] valid-script-path: ""
[2023-06-20 23:42:04] [config] valid-sets:
[2023-06-20 23:42:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:42:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:42:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:42:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:42:04] [config] vocabs:
[2023-06-20 23:42:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:42:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:42:04] [config] word-penalty: 0
[2023-06-20 23:42:04] [config] word-scores: false
[2023-06-20 23:42:04] [config] workspace: 3000
[2023-06-20 23:42:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:42:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:42:04] [training] Using single-device training
[2023-06-20 23:42:04] Synced seed 1234
[2023-06-20 23:42:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:42:04] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:42:04] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:42:04] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:42:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:42:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:42:05] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:42:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:42:06] [comm] Using global sharding
[2023-06-20 23:42:06] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:42:06] [training] Using 1 GPUs
[2023-06-20 23:42:06] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:42:06] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:42:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:42:06] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:42:19] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:42:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:42:19] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:42:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:42:19] [comm] Using global sharding
[2023-06-20 23:42:19] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:42:19] [training] Using 1 GPUs
[2023-06-20 23:42:19] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:42:21] Loading Adam parameters
[2023-06-20 23:42:22] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:42:22] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:42:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:42:22] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-20 23:42:22] [data] Shuffling data
[2023-06-20 23:42:22] [data] Done reading 20,192 sentences
[2023-06-20 23:42:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:42:22] Training started
[2023-06-20 23:42:22] Training finished
[2023-06-20 23:46:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:46:42] [marian] Running on node17.datos.cluster.uy as process 37779 with command line:
[2023-06-20 23:46:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 110 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:46:42] [config] after: 0e
[2023-06-20 23:46:42] [config] after-batches: 0
[2023-06-20 23:46:42] [config] after-epochs: 110
[2023-06-20 23:46:42] [config] all-caps-every: 0
[2023-06-20 23:46:42] [config] allow-unk: false
[2023-06-20 23:46:42] [config] authors: false
[2023-06-20 23:46:42] [config] beam-size: 12
[2023-06-20 23:46:42] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:46:42] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:46:42] [config] bert-masking-fraction: 0.15
[2023-06-20 23:46:42] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:46:42] [config] bert-train-type-embeddings: true
[2023-06-20 23:46:42] [config] bert-type-vocab-size: 2
[2023-06-20 23:46:42] [config] build-info: ""
[2023-06-20 23:46:42] [config] check-gradient-nan: false
[2023-06-20 23:46:42] [config] check-nan: false
[2023-06-20 23:46:42] [config] cite: false
[2023-06-20 23:46:42] [config] clip-norm: 1
[2023-06-20 23:46:42] [config] cost-scaling:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] cost-type: ce-sum
[2023-06-20 23:46:42] [config] cpu-threads: 0
[2023-06-20 23:46:42] [config] data-threads: 8
[2023-06-20 23:46:42] [config] data-weighting: ""
[2023-06-20 23:46:42] [config] data-weighting-type: sentence
[2023-06-20 23:46:42] [config] dec-cell: gru
[2023-06-20 23:46:42] [config] dec-cell-base-depth: 2
[2023-06-20 23:46:42] [config] dec-cell-high-depth: 1
[2023-06-20 23:46:42] [config] dec-depth: 1
[2023-06-20 23:46:42] [config] devices:
[2023-06-20 23:46:42] [config]   - 0
[2023-06-20 23:46:42] [config] dim-emb: 512
[2023-06-20 23:46:42] [config] dim-rnn: 1024
[2023-06-20 23:46:42] [config] dim-vocabs:
[2023-06-20 23:46:42] [config]   - 54042
[2023-06-20 23:46:42] [config]   - 36507
[2023-06-20 23:46:42] [config] disp-first: 0
[2023-06-20 23:46:42] [config] disp-freq: 1000u
[2023-06-20 23:46:42] [config] disp-label-counts: true
[2023-06-20 23:46:42] [config] dropout-rnn: 0.2
[2023-06-20 23:46:42] [config] dropout-src: 0.1
[2023-06-20 23:46:42] [config] dropout-trg: 0.1
[2023-06-20 23:46:42] [config] dump-config: ""
[2023-06-20 23:46:42] [config] dynamic-gradient-scaling:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] early-stopping: 5
[2023-06-20 23:46:42] [config] early-stopping-on: first
[2023-06-20 23:46:42] [config] embedding-fix-src: false
[2023-06-20 23:46:42] [config] embedding-fix-trg: false
[2023-06-20 23:46:42] [config] embedding-normalization: false
[2023-06-20 23:46:42] [config] embedding-vectors:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] enc-cell: gru
[2023-06-20 23:46:42] [config] enc-cell-depth: 1
[2023-06-20 23:46:42] [config] enc-depth: 1
[2023-06-20 23:46:42] [config] enc-type: bidirectional
[2023-06-20 23:46:42] [config] english-title-case-every: 0
[2023-06-20 23:46:42] [config] exponential-smoothing: 0
[2023-06-20 23:46:42] [config] factor-weight: 1
[2023-06-20 23:46:42] [config] factors-combine: sum
[2023-06-20 23:46:42] [config] factors-dim-emb: 0
[2023-06-20 23:46:42] [config] gradient-checkpointing: false
[2023-06-20 23:46:42] [config] gradient-norm-average-window: 100
[2023-06-20 23:46:42] [config] guided-alignment: none
[2023-06-20 23:46:42] [config] guided-alignment-cost: mse
[2023-06-20 23:46:42] [config] guided-alignment-weight: 0.1
[2023-06-20 23:46:42] [config] ignore-model-config: false
[2023-06-20 23:46:42] [config] input-types:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] interpolate-env-vars: false
[2023-06-20 23:46:42] [config] keep-best: false
[2023-06-20 23:46:42] [config] label-smoothing: 0
[2023-06-20 23:46:42] [config] layer-normalization: true
[2023-06-20 23:46:42] [config] learn-rate: 0.0001
[2023-06-20 23:46:42] [config] lemma-dependency: ""
[2023-06-20 23:46:42] [config] lemma-dim-emb: 0
[2023-06-20 23:46:42] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:46:42] [config] log-level: info
[2023-06-20 23:46:42] [config] log-time-zone: ""
[2023-06-20 23:46:42] [config] logical-epoch:
[2023-06-20 23:46:42] [config]   - 1e
[2023-06-20 23:46:42] [config]   - 0
[2023-06-20 23:46:42] [config] lr-decay: 0
[2023-06-20 23:46:42] [config] lr-decay-freq: 50000
[2023-06-20 23:46:42] [config] lr-decay-inv-sqrt:
[2023-06-20 23:46:42] [config]   - 0
[2023-06-20 23:46:42] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:46:42] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:46:42] [config] lr-decay-start:
[2023-06-20 23:46:42] [config]   - 10
[2023-06-20 23:46:42] [config]   - 1
[2023-06-20 23:46:42] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:46:42] [config] lr-report: false
[2023-06-20 23:46:42] [config] lr-warmup: 0
[2023-06-20 23:46:42] [config] lr-warmup-at-reload: false
[2023-06-20 23:46:42] [config] lr-warmup-cycle: false
[2023-06-20 23:46:42] [config] lr-warmup-start-rate: 0
[2023-06-20 23:46:42] [config] max-length: 50
[2023-06-20 23:46:42] [config] max-length-crop: false
[2023-06-20 23:46:42] [config] max-length-factor: 3
[2023-06-20 23:46:42] [config] maxi-batch: 100
[2023-06-20 23:46:42] [config] maxi-batch-sort: trg
[2023-06-20 23:46:42] [config] mini-batch: 64
[2023-06-20 23:46:42] [config] mini-batch-fit: true
[2023-06-20 23:46:42] [config] mini-batch-fit-step: 10
[2023-06-20 23:46:42] [config] mini-batch-round-up: true
[2023-06-20 23:46:42] [config] mini-batch-track-lr: false
[2023-06-20 23:46:42] [config] mini-batch-warmup: 0
[2023-06-20 23:46:42] [config] mini-batch-words: 0
[2023-06-20 23:46:42] [config] mini-batch-words-ref: 0
[2023-06-20 23:46:42] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:46:42] [config] multi-loss-type: sum
[2023-06-20 23:46:42] [config] n-best: false
[2023-06-20 23:46:42] [config] no-nccl: false
[2023-06-20 23:46:42] [config] no-reload: false
[2023-06-20 23:46:42] [config] no-restore-corpus: false
[2023-06-20 23:46:42] [config] normalize: 0
[2023-06-20 23:46:42] [config] normalize-gradient: false
[2023-06-20 23:46:42] [config] num-devices: 0
[2023-06-20 23:46:42] [config] optimizer: adam
[2023-06-20 23:46:42] [config] optimizer-delay: 1
[2023-06-20 23:46:42] [config] optimizer-params:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] output-omit-bias: false
[2023-06-20 23:46:42] [config] overwrite: false
[2023-06-20 23:46:42] [config] precision:
[2023-06-20 23:46:42] [config]   - float32
[2023-06-20 23:46:42] [config]   - float32
[2023-06-20 23:46:42] [config] pretrained-model: ""
[2023-06-20 23:46:42] [config] quantize-biases: false
[2023-06-20 23:46:42] [config] quantize-bits: 0
[2023-06-20 23:46:42] [config] quantize-log-based: false
[2023-06-20 23:46:42] [config] quantize-optimization-steps: 0
[2023-06-20 23:46:42] [config] quiet: false
[2023-06-20 23:46:42] [config] quiet-translation: true
[2023-06-20 23:46:42] [config] relative-paths: false
[2023-06-20 23:46:42] [config] right-left: false
[2023-06-20 23:46:42] [config] save-freq: 10000u
[2023-06-20 23:46:42] [config] seed: 1234
[2023-06-20 23:46:42] [config] sentencepiece-alphas:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:46:42] [config] sentencepiece-options: ""
[2023-06-20 23:46:42] [config] sharding: global
[2023-06-20 23:46:42] [config] shuffle: data
[2023-06-20 23:46:42] [config] shuffle-in-ram: false
[2023-06-20 23:46:42] [config] sigterm: save-and-exit
[2023-06-20 23:46:42] [config] skip: false
[2023-06-20 23:46:42] [config] sqlite: ""
[2023-06-20 23:46:42] [config] sqlite-drop: false
[2023-06-20 23:46:42] [config] sync-freq: 200u
[2023-06-20 23:46:42] [config] sync-sgd: false
[2023-06-20 23:46:42] [config] tempdir: /tmp
[2023-06-20 23:46:42] [config] tied-embeddings: false
[2023-06-20 23:46:42] [config] tied-embeddings-all: false
[2023-06-20 23:46:42] [config] tied-embeddings-src: false
[2023-06-20 23:46:42] [config] train-embedder-rank:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] train-sets:
[2023-06-20 23:46:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:46:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:46:42] [config] transformer-aan-activation: swish
[2023-06-20 23:46:42] [config] transformer-aan-depth: 2
[2023-06-20 23:46:42] [config] transformer-aan-nogate: false
[2023-06-20 23:46:42] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:46:42] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:46:42] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:46:42] [config] transformer-depth-scaling: false
[2023-06-20 23:46:42] [config] transformer-dim-aan: 2048
[2023-06-20 23:46:42] [config] transformer-dim-ffn: 2048
[2023-06-20 23:46:42] [config] transformer-dropout: 0
[2023-06-20 23:46:42] [config] transformer-dropout-attention: 0
[2023-06-20 23:46:42] [config] transformer-dropout-ffn: 0
[2023-06-20 23:46:42] [config] transformer-ffn-activation: swish
[2023-06-20 23:46:42] [config] transformer-ffn-depth: 2
[2023-06-20 23:46:42] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:46:42] [config] transformer-heads: 8
[2023-06-20 23:46:42] [config] transformer-no-projection: false
[2023-06-20 23:46:42] [config] transformer-pool: false
[2023-06-20 23:46:42] [config] transformer-postprocess: dan
[2023-06-20 23:46:42] [config] transformer-postprocess-emb: d
[2023-06-20 23:46:42] [config] transformer-postprocess-top: ""
[2023-06-20 23:46:42] [config] transformer-preprocess: ""
[2023-06-20 23:46:42] [config] transformer-tied-layers:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] transformer-train-position-embeddings: false
[2023-06-20 23:46:42] [config] tsv: false
[2023-06-20 23:46:42] [config] tsv-fields: 0
[2023-06-20 23:46:42] [config] type: amun
[2023-06-20 23:46:42] [config] ulr: false
[2023-06-20 23:46:42] [config] ulr-dim-emb: 0
[2023-06-20 23:46:42] [config] ulr-dropout: 0
[2023-06-20 23:46:42] [config] ulr-keys-vectors: ""
[2023-06-20 23:46:42] [config] ulr-query-vectors: ""
[2023-06-20 23:46:42] [config] ulr-softmax-temperature: 1
[2023-06-20 23:46:42] [config] ulr-trainable-transformation: false
[2023-06-20 23:46:42] [config] unlikelihood-loss: false
[2023-06-20 23:46:42] [config] valid-freq: 5000000
[2023-06-20 23:46:42] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:46:42] [config] valid-max-length: 1000
[2023-06-20 23:46:42] [config] valid-metrics:
[2023-06-20 23:46:42] [config]   - cross-entropy
[2023-06-20 23:46:42] [config] valid-mini-batch: 32
[2023-06-20 23:46:42] [config] valid-reset-stalled: false
[2023-06-20 23:46:42] [config] valid-script-args:
[2023-06-20 23:46:42] [config]   []
[2023-06-20 23:46:42] [config] valid-script-path: ""
[2023-06-20 23:46:42] [config] valid-sets:
[2023-06-20 23:46:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:46:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:46:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:46:42] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:46:42] [config] vocabs:
[2023-06-20 23:46:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:46:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:46:42] [config] word-penalty: 0
[2023-06-20 23:46:42] [config] word-scores: false
[2023-06-20 23:46:42] [config] workspace: 3000
[2023-06-20 23:46:42] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:46:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:46:42] [training] Using single-device training
[2023-06-20 23:46:43] Synced seed 1234
[2023-06-20 23:46:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:46:43] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:46:43] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:46:43] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:46:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:46:43] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:46:44] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:46:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:46:44] [comm] Using global sharding
[2023-06-20 23:46:45] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:46:45] [training] Using 1 GPUs
[2023-06-20 23:46:45] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:46:45] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:46:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:46:45] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:46:58] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:46:59] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:46:59] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:46:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:46:59] [comm] Using global sharding
[2023-06-20 23:46:59] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:46:59] [training] Using 1 GPUs
[2023-06-20 23:46:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:47:01] Loading Adam parameters
[2023-06-20 23:47:01] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:47:01] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:47:02] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:47:02] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-20 23:47:02] [data] Shuffling data
[2023-06-20 23:47:02] [data] Done reading 20,192 sentences
[2023-06-20 23:47:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:47:02] Training started
[2023-06-20 23:47:02] Training finished
[2023-06-20 23:51:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:51:23] [marian] Running on node17.datos.cluster.uy as process 38090 with command line:
[2023-06-20 23:51:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 120 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:51:23] [config] after: 0e
[2023-06-20 23:51:23] [config] after-batches: 0
[2023-06-20 23:51:23] [config] after-epochs: 120
[2023-06-20 23:51:23] [config] all-caps-every: 0
[2023-06-20 23:51:23] [config] allow-unk: false
[2023-06-20 23:51:23] [config] authors: false
[2023-06-20 23:51:23] [config] beam-size: 12
[2023-06-20 23:51:23] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:51:23] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:51:23] [config] bert-masking-fraction: 0.15
[2023-06-20 23:51:23] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:51:23] [config] bert-train-type-embeddings: true
[2023-06-20 23:51:23] [config] bert-type-vocab-size: 2
[2023-06-20 23:51:23] [config] build-info: ""
[2023-06-20 23:51:23] [config] check-gradient-nan: false
[2023-06-20 23:51:23] [config] check-nan: false
[2023-06-20 23:51:23] [config] cite: false
[2023-06-20 23:51:23] [config] clip-norm: 1
[2023-06-20 23:51:23] [config] cost-scaling:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] cost-type: ce-sum
[2023-06-20 23:51:23] [config] cpu-threads: 0
[2023-06-20 23:51:23] [config] data-threads: 8
[2023-06-20 23:51:23] [config] data-weighting: ""
[2023-06-20 23:51:23] [config] data-weighting-type: sentence
[2023-06-20 23:51:23] [config] dec-cell: gru
[2023-06-20 23:51:23] [config] dec-cell-base-depth: 2
[2023-06-20 23:51:23] [config] dec-cell-high-depth: 1
[2023-06-20 23:51:23] [config] dec-depth: 1
[2023-06-20 23:51:23] [config] devices:
[2023-06-20 23:51:23] [config]   - 0
[2023-06-20 23:51:23] [config] dim-emb: 512
[2023-06-20 23:51:23] [config] dim-rnn: 1024
[2023-06-20 23:51:23] [config] dim-vocabs:
[2023-06-20 23:51:23] [config]   - 54042
[2023-06-20 23:51:23] [config]   - 36507
[2023-06-20 23:51:23] [config] disp-first: 0
[2023-06-20 23:51:23] [config] disp-freq: 1000u
[2023-06-20 23:51:23] [config] disp-label-counts: true
[2023-06-20 23:51:23] [config] dropout-rnn: 0.2
[2023-06-20 23:51:23] [config] dropout-src: 0.1
[2023-06-20 23:51:23] [config] dropout-trg: 0.1
[2023-06-20 23:51:23] [config] dump-config: ""
[2023-06-20 23:51:23] [config] dynamic-gradient-scaling:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] early-stopping: 5
[2023-06-20 23:51:23] [config] early-stopping-on: first
[2023-06-20 23:51:23] [config] embedding-fix-src: false
[2023-06-20 23:51:23] [config] embedding-fix-trg: false
[2023-06-20 23:51:23] [config] embedding-normalization: false
[2023-06-20 23:51:23] [config] embedding-vectors:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] enc-cell: gru
[2023-06-20 23:51:23] [config] enc-cell-depth: 1
[2023-06-20 23:51:23] [config] enc-depth: 1
[2023-06-20 23:51:23] [config] enc-type: bidirectional
[2023-06-20 23:51:23] [config] english-title-case-every: 0
[2023-06-20 23:51:23] [config] exponential-smoothing: 0
[2023-06-20 23:51:23] [config] factor-weight: 1
[2023-06-20 23:51:23] [config] factors-combine: sum
[2023-06-20 23:51:23] [config] factors-dim-emb: 0
[2023-06-20 23:51:23] [config] gradient-checkpointing: false
[2023-06-20 23:51:23] [config] gradient-norm-average-window: 100
[2023-06-20 23:51:23] [config] guided-alignment: none
[2023-06-20 23:51:23] [config] guided-alignment-cost: mse
[2023-06-20 23:51:23] [config] guided-alignment-weight: 0.1
[2023-06-20 23:51:23] [config] ignore-model-config: false
[2023-06-20 23:51:23] [config] input-types:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] interpolate-env-vars: false
[2023-06-20 23:51:23] [config] keep-best: false
[2023-06-20 23:51:23] [config] label-smoothing: 0
[2023-06-20 23:51:23] [config] layer-normalization: true
[2023-06-20 23:51:23] [config] learn-rate: 0.0001
[2023-06-20 23:51:23] [config] lemma-dependency: ""
[2023-06-20 23:51:23] [config] lemma-dim-emb: 0
[2023-06-20 23:51:23] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:51:23] [config] log-level: info
[2023-06-20 23:51:23] [config] log-time-zone: ""
[2023-06-20 23:51:23] [config] logical-epoch:
[2023-06-20 23:51:23] [config]   - 1e
[2023-06-20 23:51:23] [config]   - 0
[2023-06-20 23:51:23] [config] lr-decay: 0
[2023-06-20 23:51:23] [config] lr-decay-freq: 50000
[2023-06-20 23:51:23] [config] lr-decay-inv-sqrt:
[2023-06-20 23:51:23] [config]   - 0
[2023-06-20 23:51:23] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:51:23] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:51:23] [config] lr-decay-start:
[2023-06-20 23:51:23] [config]   - 10
[2023-06-20 23:51:23] [config]   - 1
[2023-06-20 23:51:23] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:51:23] [config] lr-report: false
[2023-06-20 23:51:23] [config] lr-warmup: 0
[2023-06-20 23:51:23] [config] lr-warmup-at-reload: false
[2023-06-20 23:51:23] [config] lr-warmup-cycle: false
[2023-06-20 23:51:23] [config] lr-warmup-start-rate: 0
[2023-06-20 23:51:23] [config] max-length: 50
[2023-06-20 23:51:23] [config] max-length-crop: false
[2023-06-20 23:51:23] [config] max-length-factor: 3
[2023-06-20 23:51:23] [config] maxi-batch: 100
[2023-06-20 23:51:23] [config] maxi-batch-sort: trg
[2023-06-20 23:51:23] [config] mini-batch: 64
[2023-06-20 23:51:23] [config] mini-batch-fit: true
[2023-06-20 23:51:23] [config] mini-batch-fit-step: 10
[2023-06-20 23:51:23] [config] mini-batch-round-up: true
[2023-06-20 23:51:23] [config] mini-batch-track-lr: false
[2023-06-20 23:51:23] [config] mini-batch-warmup: 0
[2023-06-20 23:51:23] [config] mini-batch-words: 0
[2023-06-20 23:51:23] [config] mini-batch-words-ref: 0
[2023-06-20 23:51:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:51:23] [config] multi-loss-type: sum
[2023-06-20 23:51:23] [config] n-best: false
[2023-06-20 23:51:23] [config] no-nccl: false
[2023-06-20 23:51:23] [config] no-reload: false
[2023-06-20 23:51:23] [config] no-restore-corpus: false
[2023-06-20 23:51:23] [config] normalize: 0
[2023-06-20 23:51:23] [config] normalize-gradient: false
[2023-06-20 23:51:23] [config] num-devices: 0
[2023-06-20 23:51:23] [config] optimizer: adam
[2023-06-20 23:51:23] [config] optimizer-delay: 1
[2023-06-20 23:51:23] [config] optimizer-params:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] output-omit-bias: false
[2023-06-20 23:51:23] [config] overwrite: false
[2023-06-20 23:51:23] [config] precision:
[2023-06-20 23:51:23] [config]   - float32
[2023-06-20 23:51:23] [config]   - float32
[2023-06-20 23:51:23] [config] pretrained-model: ""
[2023-06-20 23:51:23] [config] quantize-biases: false
[2023-06-20 23:51:23] [config] quantize-bits: 0
[2023-06-20 23:51:23] [config] quantize-log-based: false
[2023-06-20 23:51:23] [config] quantize-optimization-steps: 0
[2023-06-20 23:51:23] [config] quiet: false
[2023-06-20 23:51:23] [config] quiet-translation: true
[2023-06-20 23:51:23] [config] relative-paths: false
[2023-06-20 23:51:23] [config] right-left: false
[2023-06-20 23:51:23] [config] save-freq: 10000u
[2023-06-20 23:51:23] [config] seed: 1234
[2023-06-20 23:51:23] [config] sentencepiece-alphas:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:51:23] [config] sentencepiece-options: ""
[2023-06-20 23:51:23] [config] sharding: global
[2023-06-20 23:51:23] [config] shuffle: data
[2023-06-20 23:51:23] [config] shuffle-in-ram: false
[2023-06-20 23:51:23] [config] sigterm: save-and-exit
[2023-06-20 23:51:23] [config] skip: false
[2023-06-20 23:51:23] [config] sqlite: ""
[2023-06-20 23:51:23] [config] sqlite-drop: false
[2023-06-20 23:51:23] [config] sync-freq: 200u
[2023-06-20 23:51:23] [config] sync-sgd: false
[2023-06-20 23:51:23] [config] tempdir: /tmp
[2023-06-20 23:51:23] [config] tied-embeddings: false
[2023-06-20 23:51:23] [config] tied-embeddings-all: false
[2023-06-20 23:51:23] [config] tied-embeddings-src: false
[2023-06-20 23:51:23] [config] train-embedder-rank:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] train-sets:
[2023-06-20 23:51:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:51:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:51:23] [config] transformer-aan-activation: swish
[2023-06-20 23:51:23] [config] transformer-aan-depth: 2
[2023-06-20 23:51:23] [config] transformer-aan-nogate: false
[2023-06-20 23:51:23] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:51:23] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:51:23] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:51:23] [config] transformer-depth-scaling: false
[2023-06-20 23:51:23] [config] transformer-dim-aan: 2048
[2023-06-20 23:51:23] [config] transformer-dim-ffn: 2048
[2023-06-20 23:51:23] [config] transformer-dropout: 0
[2023-06-20 23:51:23] [config] transformer-dropout-attention: 0
[2023-06-20 23:51:23] [config] transformer-dropout-ffn: 0
[2023-06-20 23:51:23] [config] transformer-ffn-activation: swish
[2023-06-20 23:51:23] [config] transformer-ffn-depth: 2
[2023-06-20 23:51:23] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:51:23] [config] transformer-heads: 8
[2023-06-20 23:51:23] [config] transformer-no-projection: false
[2023-06-20 23:51:23] [config] transformer-pool: false
[2023-06-20 23:51:23] [config] transformer-postprocess: dan
[2023-06-20 23:51:23] [config] transformer-postprocess-emb: d
[2023-06-20 23:51:23] [config] transformer-postprocess-top: ""
[2023-06-20 23:51:23] [config] transformer-preprocess: ""
[2023-06-20 23:51:23] [config] transformer-tied-layers:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] transformer-train-position-embeddings: false
[2023-06-20 23:51:23] [config] tsv: false
[2023-06-20 23:51:23] [config] tsv-fields: 0
[2023-06-20 23:51:23] [config] type: amun
[2023-06-20 23:51:23] [config] ulr: false
[2023-06-20 23:51:23] [config] ulr-dim-emb: 0
[2023-06-20 23:51:23] [config] ulr-dropout: 0
[2023-06-20 23:51:23] [config] ulr-keys-vectors: ""
[2023-06-20 23:51:23] [config] ulr-query-vectors: ""
[2023-06-20 23:51:23] [config] ulr-softmax-temperature: 1
[2023-06-20 23:51:23] [config] ulr-trainable-transformation: false
[2023-06-20 23:51:23] [config] unlikelihood-loss: false
[2023-06-20 23:51:23] [config] valid-freq: 5000000
[2023-06-20 23:51:23] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:51:23] [config] valid-max-length: 1000
[2023-06-20 23:51:23] [config] valid-metrics:
[2023-06-20 23:51:23] [config]   - cross-entropy
[2023-06-20 23:51:23] [config] valid-mini-batch: 32
[2023-06-20 23:51:23] [config] valid-reset-stalled: false
[2023-06-20 23:51:23] [config] valid-script-args:
[2023-06-20 23:51:23] [config]   []
[2023-06-20 23:51:23] [config] valid-script-path: ""
[2023-06-20 23:51:23] [config] valid-sets:
[2023-06-20 23:51:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:51:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:51:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:51:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:51:23] [config] vocabs:
[2023-06-20 23:51:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:51:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:51:23] [config] word-penalty: 0
[2023-06-20 23:51:23] [config] word-scores: false
[2023-06-20 23:51:23] [config] workspace: 3000
[2023-06-20 23:51:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:51:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:51:23] [training] Using single-device training
[2023-06-20 23:51:23] Synced seed 1234
[2023-06-20 23:51:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:51:23] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:51:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:51:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:51:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:51:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:51:24] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:51:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:51:25] [comm] Using global sharding
[2023-06-20 23:51:25] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:51:25] [training] Using 1 GPUs
[2023-06-20 23:51:25] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:51:25] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:51:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:51:26] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:51:39] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:51:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:51:39] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:51:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:51:39] [comm] Using global sharding
[2023-06-20 23:51:39] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:51:39] [training] Using 1 GPUs
[2023-06-20 23:51:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:51:41] Loading Adam parameters
[2023-06-20 23:51:41] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:51:41] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:51:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:51:41] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-20 23:51:41] [data] Shuffling data
[2023-06-20 23:51:41] [data] Done reading 20,192 sentences
[2023-06-20 23:51:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:51:41] Training started
[2023-06-20 23:51:41] Training finished
[2023-06-20 23:56:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:56:02] [marian] Running on node17.datos.cluster.uy as process 38406 with command line:
[2023-06-20 23:56:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 130 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-20 23:56:02] [config] after: 0e
[2023-06-20 23:56:02] [config] after-batches: 0
[2023-06-20 23:56:02] [config] after-epochs: 130
[2023-06-20 23:56:02] [config] all-caps-every: 0
[2023-06-20 23:56:02] [config] allow-unk: false
[2023-06-20 23:56:02] [config] authors: false
[2023-06-20 23:56:02] [config] beam-size: 12
[2023-06-20 23:56:02] [config] bert-class-symbol: "[CLS]"
[2023-06-20 23:56:02] [config] bert-mask-symbol: "[MASK]"
[2023-06-20 23:56:02] [config] bert-masking-fraction: 0.15
[2023-06-20 23:56:02] [config] bert-sep-symbol: "[SEP]"
[2023-06-20 23:56:02] [config] bert-train-type-embeddings: true
[2023-06-20 23:56:02] [config] bert-type-vocab-size: 2
[2023-06-20 23:56:02] [config] build-info: ""
[2023-06-20 23:56:02] [config] check-gradient-nan: false
[2023-06-20 23:56:02] [config] check-nan: false
[2023-06-20 23:56:02] [config] cite: false
[2023-06-20 23:56:02] [config] clip-norm: 1
[2023-06-20 23:56:02] [config] cost-scaling:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] cost-type: ce-sum
[2023-06-20 23:56:02] [config] cpu-threads: 0
[2023-06-20 23:56:02] [config] data-threads: 8
[2023-06-20 23:56:02] [config] data-weighting: ""
[2023-06-20 23:56:02] [config] data-weighting-type: sentence
[2023-06-20 23:56:02] [config] dec-cell: gru
[2023-06-20 23:56:02] [config] dec-cell-base-depth: 2
[2023-06-20 23:56:02] [config] dec-cell-high-depth: 1
[2023-06-20 23:56:02] [config] dec-depth: 1
[2023-06-20 23:56:02] [config] devices:
[2023-06-20 23:56:02] [config]   - 0
[2023-06-20 23:56:02] [config] dim-emb: 512
[2023-06-20 23:56:02] [config] dim-rnn: 1024
[2023-06-20 23:56:02] [config] dim-vocabs:
[2023-06-20 23:56:02] [config]   - 54042
[2023-06-20 23:56:02] [config]   - 36507
[2023-06-20 23:56:02] [config] disp-first: 0
[2023-06-20 23:56:02] [config] disp-freq: 1000u
[2023-06-20 23:56:02] [config] disp-label-counts: true
[2023-06-20 23:56:02] [config] dropout-rnn: 0.2
[2023-06-20 23:56:02] [config] dropout-src: 0.1
[2023-06-20 23:56:02] [config] dropout-trg: 0.1
[2023-06-20 23:56:02] [config] dump-config: ""
[2023-06-20 23:56:02] [config] dynamic-gradient-scaling:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] early-stopping: 5
[2023-06-20 23:56:02] [config] early-stopping-on: first
[2023-06-20 23:56:02] [config] embedding-fix-src: false
[2023-06-20 23:56:02] [config] embedding-fix-trg: false
[2023-06-20 23:56:02] [config] embedding-normalization: false
[2023-06-20 23:56:02] [config] embedding-vectors:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] enc-cell: gru
[2023-06-20 23:56:02] [config] enc-cell-depth: 1
[2023-06-20 23:56:02] [config] enc-depth: 1
[2023-06-20 23:56:02] [config] enc-type: bidirectional
[2023-06-20 23:56:02] [config] english-title-case-every: 0
[2023-06-20 23:56:02] [config] exponential-smoothing: 0
[2023-06-20 23:56:02] [config] factor-weight: 1
[2023-06-20 23:56:02] [config] factors-combine: sum
[2023-06-20 23:56:02] [config] factors-dim-emb: 0
[2023-06-20 23:56:02] [config] gradient-checkpointing: false
[2023-06-20 23:56:02] [config] gradient-norm-average-window: 100
[2023-06-20 23:56:02] [config] guided-alignment: none
[2023-06-20 23:56:02] [config] guided-alignment-cost: mse
[2023-06-20 23:56:02] [config] guided-alignment-weight: 0.1
[2023-06-20 23:56:02] [config] ignore-model-config: false
[2023-06-20 23:56:02] [config] input-types:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] interpolate-env-vars: false
[2023-06-20 23:56:02] [config] keep-best: false
[2023-06-20 23:56:02] [config] label-smoothing: 0
[2023-06-20 23:56:02] [config] layer-normalization: true
[2023-06-20 23:56:02] [config] learn-rate: 0.0001
[2023-06-20 23:56:02] [config] lemma-dependency: ""
[2023-06-20 23:56:02] [config] lemma-dim-emb: 0
[2023-06-20 23:56:02] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-20 23:56:02] [config] log-level: info
[2023-06-20 23:56:02] [config] log-time-zone: ""
[2023-06-20 23:56:02] [config] logical-epoch:
[2023-06-20 23:56:02] [config]   - 1e
[2023-06-20 23:56:02] [config]   - 0
[2023-06-20 23:56:02] [config] lr-decay: 0
[2023-06-20 23:56:02] [config] lr-decay-freq: 50000
[2023-06-20 23:56:02] [config] lr-decay-inv-sqrt:
[2023-06-20 23:56:02] [config]   - 0
[2023-06-20 23:56:02] [config] lr-decay-repeat-warmup: false
[2023-06-20 23:56:02] [config] lr-decay-reset-optimizer: false
[2023-06-20 23:56:02] [config] lr-decay-start:
[2023-06-20 23:56:02] [config]   - 10
[2023-06-20 23:56:02] [config]   - 1
[2023-06-20 23:56:02] [config] lr-decay-strategy: epoch+stalled
[2023-06-20 23:56:02] [config] lr-report: false
[2023-06-20 23:56:02] [config] lr-warmup: 0
[2023-06-20 23:56:02] [config] lr-warmup-at-reload: false
[2023-06-20 23:56:02] [config] lr-warmup-cycle: false
[2023-06-20 23:56:02] [config] lr-warmup-start-rate: 0
[2023-06-20 23:56:02] [config] max-length: 50
[2023-06-20 23:56:02] [config] max-length-crop: false
[2023-06-20 23:56:02] [config] max-length-factor: 3
[2023-06-20 23:56:02] [config] maxi-batch: 100
[2023-06-20 23:56:02] [config] maxi-batch-sort: trg
[2023-06-20 23:56:02] [config] mini-batch: 64
[2023-06-20 23:56:02] [config] mini-batch-fit: true
[2023-06-20 23:56:02] [config] mini-batch-fit-step: 10
[2023-06-20 23:56:02] [config] mini-batch-round-up: true
[2023-06-20 23:56:02] [config] mini-batch-track-lr: false
[2023-06-20 23:56:02] [config] mini-batch-warmup: 0
[2023-06-20 23:56:02] [config] mini-batch-words: 0
[2023-06-20 23:56:02] [config] mini-batch-words-ref: 0
[2023-06-20 23:56:02] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:56:02] [config] multi-loss-type: sum
[2023-06-20 23:56:02] [config] n-best: false
[2023-06-20 23:56:02] [config] no-nccl: false
[2023-06-20 23:56:02] [config] no-reload: false
[2023-06-20 23:56:02] [config] no-restore-corpus: false
[2023-06-20 23:56:02] [config] normalize: 0
[2023-06-20 23:56:02] [config] normalize-gradient: false
[2023-06-20 23:56:02] [config] num-devices: 0
[2023-06-20 23:56:02] [config] optimizer: adam
[2023-06-20 23:56:02] [config] optimizer-delay: 1
[2023-06-20 23:56:02] [config] optimizer-params:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] output-omit-bias: false
[2023-06-20 23:56:02] [config] overwrite: false
[2023-06-20 23:56:02] [config] precision:
[2023-06-20 23:56:02] [config]   - float32
[2023-06-20 23:56:02] [config]   - float32
[2023-06-20 23:56:02] [config] pretrained-model: ""
[2023-06-20 23:56:02] [config] quantize-biases: false
[2023-06-20 23:56:02] [config] quantize-bits: 0
[2023-06-20 23:56:02] [config] quantize-log-based: false
[2023-06-20 23:56:02] [config] quantize-optimization-steps: 0
[2023-06-20 23:56:02] [config] quiet: false
[2023-06-20 23:56:02] [config] quiet-translation: true
[2023-06-20 23:56:02] [config] relative-paths: false
[2023-06-20 23:56:02] [config] right-left: false
[2023-06-20 23:56:02] [config] save-freq: 10000u
[2023-06-20 23:56:02] [config] seed: 1234
[2023-06-20 23:56:02] [config] sentencepiece-alphas:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] sentencepiece-max-lines: 2000000
[2023-06-20 23:56:02] [config] sentencepiece-options: ""
[2023-06-20 23:56:02] [config] sharding: global
[2023-06-20 23:56:02] [config] shuffle: data
[2023-06-20 23:56:02] [config] shuffle-in-ram: false
[2023-06-20 23:56:02] [config] sigterm: save-and-exit
[2023-06-20 23:56:02] [config] skip: false
[2023-06-20 23:56:02] [config] sqlite: ""
[2023-06-20 23:56:02] [config] sqlite-drop: false
[2023-06-20 23:56:02] [config] sync-freq: 200u
[2023-06-20 23:56:02] [config] sync-sgd: false
[2023-06-20 23:56:02] [config] tempdir: /tmp
[2023-06-20 23:56:02] [config] tied-embeddings: false
[2023-06-20 23:56:02] [config] tied-embeddings-all: false
[2023-06-20 23:56:02] [config] tied-embeddings-src: false
[2023-06-20 23:56:02] [config] train-embedder-rank:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] train-sets:
[2023-06-20 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-20 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-20 23:56:02] [config] transformer-aan-activation: swish
[2023-06-20 23:56:02] [config] transformer-aan-depth: 2
[2023-06-20 23:56:02] [config] transformer-aan-nogate: false
[2023-06-20 23:56:02] [config] transformer-decoder-autoreg: self-attention
[2023-06-20 23:56:02] [config] transformer-decoder-dim-ffn: 0
[2023-06-20 23:56:02] [config] transformer-decoder-ffn-depth: 0
[2023-06-20 23:56:02] [config] transformer-depth-scaling: false
[2023-06-20 23:56:02] [config] transformer-dim-aan: 2048
[2023-06-20 23:56:02] [config] transformer-dim-ffn: 2048
[2023-06-20 23:56:02] [config] transformer-dropout: 0
[2023-06-20 23:56:02] [config] transformer-dropout-attention: 0
[2023-06-20 23:56:02] [config] transformer-dropout-ffn: 0
[2023-06-20 23:56:02] [config] transformer-ffn-activation: swish
[2023-06-20 23:56:02] [config] transformer-ffn-depth: 2
[2023-06-20 23:56:02] [config] transformer-guided-alignment-layer: last
[2023-06-20 23:56:02] [config] transformer-heads: 8
[2023-06-20 23:56:02] [config] transformer-no-projection: false
[2023-06-20 23:56:02] [config] transformer-pool: false
[2023-06-20 23:56:02] [config] transformer-postprocess: dan
[2023-06-20 23:56:02] [config] transformer-postprocess-emb: d
[2023-06-20 23:56:02] [config] transformer-postprocess-top: ""
[2023-06-20 23:56:02] [config] transformer-preprocess: ""
[2023-06-20 23:56:02] [config] transformer-tied-layers:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] transformer-train-position-embeddings: false
[2023-06-20 23:56:02] [config] tsv: false
[2023-06-20 23:56:02] [config] tsv-fields: 0
[2023-06-20 23:56:02] [config] type: amun
[2023-06-20 23:56:02] [config] ulr: false
[2023-06-20 23:56:02] [config] ulr-dim-emb: 0
[2023-06-20 23:56:02] [config] ulr-dropout: 0
[2023-06-20 23:56:02] [config] ulr-keys-vectors: ""
[2023-06-20 23:56:02] [config] ulr-query-vectors: ""
[2023-06-20 23:56:02] [config] ulr-softmax-temperature: 1
[2023-06-20 23:56:02] [config] ulr-trainable-transformation: false
[2023-06-20 23:56:02] [config] unlikelihood-loss: false
[2023-06-20 23:56:02] [config] valid-freq: 5000000
[2023-06-20 23:56:02] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-20 23:56:02] [config] valid-max-length: 1000
[2023-06-20 23:56:02] [config] valid-metrics:
[2023-06-20 23:56:02] [config]   - cross-entropy
[2023-06-20 23:56:02] [config] valid-mini-batch: 32
[2023-06-20 23:56:02] [config] valid-reset-stalled: false
[2023-06-20 23:56:02] [config] valid-script-args:
[2023-06-20 23:56:02] [config]   []
[2023-06-20 23:56:02] [config] valid-script-path: ""
[2023-06-20 23:56:02] [config] valid-sets:
[2023-06-20 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-20 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-20 23:56:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-20 23:56:02] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:56:02] [config] vocabs:
[2023-06-20 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:56:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:56:02] [config] word-penalty: 0
[2023-06-20 23:56:02] [config] word-scores: false
[2023-06-20 23:56:02] [config] workspace: 3000
[2023-06-20 23:56:02] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-20 23:56:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:56:02] [training] Using single-device training
[2023-06-20 23:56:02] Synced seed 1234
[2023-06-20 23:56:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-20 23:56:02] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-20 23:56:02] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-20 23:56:02] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-20 23:56:02] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-20 23:56:02] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:56:03] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:56:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:56:03] [comm] Using global sharding
[2023-06-20 23:56:04] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:56:04] [training] Using 1 GPUs
[2023-06-20 23:56:04] [logits] Applying loss function for 1 factor(s)
[2023-06-20 23:56:04] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:56:04] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-20 23:56:04] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:56:17] [batching] Done. Typical MB size is 4,814 target words
[2023-06-20 23:56:17] [MPI rank 0 out of 1]: GPU[0]
[2023-06-20 23:56:17] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-20 23:56:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-20 23:56:17] [comm] Using global sharding
[2023-06-20 23:56:17] [comm] NCCLCommunicators constructed successfully
[2023-06-20 23:56:17] [training] Using 1 GPUs
[2023-06-20 23:56:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-20 23:56:19] Loading Adam parameters
[2023-06-20 23:56:19] [memory] Reserving 754 MB, device gpu0
[2023-06-20 23:56:19] [memory] Reserving 377 MB, device gpu0
[2023-06-20 23:56:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-20 23:56:20] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-20 23:56:20] [data] Shuffling data
[2023-06-20 23:56:20] [data] Done reading 20,192 sentences
[2023-06-20 23:56:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-20 23:56:20] Training started
[2023-06-20 23:56:20] Training finished
[2023-06-21 00:00:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:00:39] [marian] Running on node17.datos.cluster.uy as process 39062 with command line:
[2023-06-21 00:00:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 140 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:00:39] [config] after: 0e
[2023-06-21 00:00:39] [config] after-batches: 0
[2023-06-21 00:00:39] [config] after-epochs: 140
[2023-06-21 00:00:39] [config] all-caps-every: 0
[2023-06-21 00:00:39] [config] allow-unk: false
[2023-06-21 00:00:39] [config] authors: false
[2023-06-21 00:00:39] [config] beam-size: 12
[2023-06-21 00:00:39] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:00:39] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:00:39] [config] bert-masking-fraction: 0.15
[2023-06-21 00:00:39] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:00:39] [config] bert-train-type-embeddings: true
[2023-06-21 00:00:39] [config] bert-type-vocab-size: 2
[2023-06-21 00:00:39] [config] build-info: ""
[2023-06-21 00:00:39] [config] check-gradient-nan: false
[2023-06-21 00:00:39] [config] check-nan: false
[2023-06-21 00:00:39] [config] cite: false
[2023-06-21 00:00:39] [config] clip-norm: 1
[2023-06-21 00:00:39] [config] cost-scaling:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] cost-type: ce-sum
[2023-06-21 00:00:39] [config] cpu-threads: 0
[2023-06-21 00:00:39] [config] data-threads: 8
[2023-06-21 00:00:39] [config] data-weighting: ""
[2023-06-21 00:00:39] [config] data-weighting-type: sentence
[2023-06-21 00:00:39] [config] dec-cell: gru
[2023-06-21 00:00:39] [config] dec-cell-base-depth: 2
[2023-06-21 00:00:39] [config] dec-cell-high-depth: 1
[2023-06-21 00:00:39] [config] dec-depth: 1
[2023-06-21 00:00:39] [config] devices:
[2023-06-21 00:00:39] [config]   - 0
[2023-06-21 00:00:39] [config] dim-emb: 512
[2023-06-21 00:00:39] [config] dim-rnn: 1024
[2023-06-21 00:00:39] [config] dim-vocabs:
[2023-06-21 00:00:39] [config]   - 54042
[2023-06-21 00:00:39] [config]   - 36507
[2023-06-21 00:00:39] [config] disp-first: 0
[2023-06-21 00:00:39] [config] disp-freq: 1000u
[2023-06-21 00:00:39] [config] disp-label-counts: true
[2023-06-21 00:00:39] [config] dropout-rnn: 0.2
[2023-06-21 00:00:39] [config] dropout-src: 0.1
[2023-06-21 00:00:39] [config] dropout-trg: 0.1
[2023-06-21 00:00:39] [config] dump-config: ""
[2023-06-21 00:00:39] [config] dynamic-gradient-scaling:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] early-stopping: 5
[2023-06-21 00:00:39] [config] early-stopping-on: first
[2023-06-21 00:00:39] [config] embedding-fix-src: false
[2023-06-21 00:00:39] [config] embedding-fix-trg: false
[2023-06-21 00:00:39] [config] embedding-normalization: false
[2023-06-21 00:00:39] [config] embedding-vectors:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] enc-cell: gru
[2023-06-21 00:00:39] [config] enc-cell-depth: 1
[2023-06-21 00:00:39] [config] enc-depth: 1
[2023-06-21 00:00:39] [config] enc-type: bidirectional
[2023-06-21 00:00:39] [config] english-title-case-every: 0
[2023-06-21 00:00:39] [config] exponential-smoothing: 0
[2023-06-21 00:00:39] [config] factor-weight: 1
[2023-06-21 00:00:39] [config] factors-combine: sum
[2023-06-21 00:00:39] [config] factors-dim-emb: 0
[2023-06-21 00:00:39] [config] gradient-checkpointing: false
[2023-06-21 00:00:39] [config] gradient-norm-average-window: 100
[2023-06-21 00:00:39] [config] guided-alignment: none
[2023-06-21 00:00:39] [config] guided-alignment-cost: mse
[2023-06-21 00:00:39] [config] guided-alignment-weight: 0.1
[2023-06-21 00:00:39] [config] ignore-model-config: false
[2023-06-21 00:00:39] [config] input-types:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] interpolate-env-vars: false
[2023-06-21 00:00:39] [config] keep-best: false
[2023-06-21 00:00:39] [config] label-smoothing: 0
[2023-06-21 00:00:39] [config] layer-normalization: true
[2023-06-21 00:00:39] [config] learn-rate: 0.0001
[2023-06-21 00:00:39] [config] lemma-dependency: ""
[2023-06-21 00:00:39] [config] lemma-dim-emb: 0
[2023-06-21 00:00:39] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:00:39] [config] log-level: info
[2023-06-21 00:00:39] [config] log-time-zone: ""
[2023-06-21 00:00:39] [config] logical-epoch:
[2023-06-21 00:00:39] [config]   - 1e
[2023-06-21 00:00:39] [config]   - 0
[2023-06-21 00:00:39] [config] lr-decay: 0
[2023-06-21 00:00:39] [config] lr-decay-freq: 50000
[2023-06-21 00:00:39] [config] lr-decay-inv-sqrt:
[2023-06-21 00:00:39] [config]   - 0
[2023-06-21 00:00:39] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:00:39] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:00:39] [config] lr-decay-start:
[2023-06-21 00:00:39] [config]   - 10
[2023-06-21 00:00:39] [config]   - 1
[2023-06-21 00:00:39] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:00:39] [config] lr-report: false
[2023-06-21 00:00:39] [config] lr-warmup: 0
[2023-06-21 00:00:39] [config] lr-warmup-at-reload: false
[2023-06-21 00:00:39] [config] lr-warmup-cycle: false
[2023-06-21 00:00:39] [config] lr-warmup-start-rate: 0
[2023-06-21 00:00:39] [config] max-length: 50
[2023-06-21 00:00:39] [config] max-length-crop: false
[2023-06-21 00:00:39] [config] max-length-factor: 3
[2023-06-21 00:00:39] [config] maxi-batch: 100
[2023-06-21 00:00:39] [config] maxi-batch-sort: trg
[2023-06-21 00:00:39] [config] mini-batch: 64
[2023-06-21 00:00:39] [config] mini-batch-fit: true
[2023-06-21 00:00:39] [config] mini-batch-fit-step: 10
[2023-06-21 00:00:39] [config] mini-batch-round-up: true
[2023-06-21 00:00:39] [config] mini-batch-track-lr: false
[2023-06-21 00:00:39] [config] mini-batch-warmup: 0
[2023-06-21 00:00:39] [config] mini-batch-words: 0
[2023-06-21 00:00:39] [config] mini-batch-words-ref: 0
[2023-06-21 00:00:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:00:39] [config] multi-loss-type: sum
[2023-06-21 00:00:39] [config] n-best: false
[2023-06-21 00:00:39] [config] no-nccl: false
[2023-06-21 00:00:39] [config] no-reload: false
[2023-06-21 00:00:39] [config] no-restore-corpus: false
[2023-06-21 00:00:39] [config] normalize: 0
[2023-06-21 00:00:39] [config] normalize-gradient: false
[2023-06-21 00:00:39] [config] num-devices: 0
[2023-06-21 00:00:39] [config] optimizer: adam
[2023-06-21 00:00:39] [config] optimizer-delay: 1
[2023-06-21 00:00:39] [config] optimizer-params:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] output-omit-bias: false
[2023-06-21 00:00:39] [config] overwrite: false
[2023-06-21 00:00:39] [config] precision:
[2023-06-21 00:00:39] [config]   - float32
[2023-06-21 00:00:39] [config]   - float32
[2023-06-21 00:00:39] [config] pretrained-model: ""
[2023-06-21 00:00:39] [config] quantize-biases: false
[2023-06-21 00:00:39] [config] quantize-bits: 0
[2023-06-21 00:00:39] [config] quantize-log-based: false
[2023-06-21 00:00:39] [config] quantize-optimization-steps: 0
[2023-06-21 00:00:39] [config] quiet: false
[2023-06-21 00:00:39] [config] quiet-translation: true
[2023-06-21 00:00:39] [config] relative-paths: false
[2023-06-21 00:00:39] [config] right-left: false
[2023-06-21 00:00:39] [config] save-freq: 10000u
[2023-06-21 00:00:39] [config] seed: 1234
[2023-06-21 00:00:39] [config] sentencepiece-alphas:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:00:39] [config] sentencepiece-options: ""
[2023-06-21 00:00:39] [config] sharding: global
[2023-06-21 00:00:39] [config] shuffle: data
[2023-06-21 00:00:39] [config] shuffle-in-ram: false
[2023-06-21 00:00:39] [config] sigterm: save-and-exit
[2023-06-21 00:00:39] [config] skip: false
[2023-06-21 00:00:39] [config] sqlite: ""
[2023-06-21 00:00:39] [config] sqlite-drop: false
[2023-06-21 00:00:39] [config] sync-freq: 200u
[2023-06-21 00:00:39] [config] sync-sgd: false
[2023-06-21 00:00:39] [config] tempdir: /tmp
[2023-06-21 00:00:39] [config] tied-embeddings: false
[2023-06-21 00:00:39] [config] tied-embeddings-all: false
[2023-06-21 00:00:39] [config] tied-embeddings-src: false
[2023-06-21 00:00:39] [config] train-embedder-rank:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] train-sets:
[2023-06-21 00:00:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:00:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:00:39] [config] transformer-aan-activation: swish
[2023-06-21 00:00:39] [config] transformer-aan-depth: 2
[2023-06-21 00:00:39] [config] transformer-aan-nogate: false
[2023-06-21 00:00:39] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:00:39] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:00:39] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:00:39] [config] transformer-depth-scaling: false
[2023-06-21 00:00:39] [config] transformer-dim-aan: 2048
[2023-06-21 00:00:39] [config] transformer-dim-ffn: 2048
[2023-06-21 00:00:39] [config] transformer-dropout: 0
[2023-06-21 00:00:39] [config] transformer-dropout-attention: 0
[2023-06-21 00:00:39] [config] transformer-dropout-ffn: 0
[2023-06-21 00:00:39] [config] transformer-ffn-activation: swish
[2023-06-21 00:00:39] [config] transformer-ffn-depth: 2
[2023-06-21 00:00:39] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:00:39] [config] transformer-heads: 8
[2023-06-21 00:00:39] [config] transformer-no-projection: false
[2023-06-21 00:00:39] [config] transformer-pool: false
[2023-06-21 00:00:39] [config] transformer-postprocess: dan
[2023-06-21 00:00:39] [config] transformer-postprocess-emb: d
[2023-06-21 00:00:39] [config] transformer-postprocess-top: ""
[2023-06-21 00:00:39] [config] transformer-preprocess: ""
[2023-06-21 00:00:39] [config] transformer-tied-layers:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] transformer-train-position-embeddings: false
[2023-06-21 00:00:39] [config] tsv: false
[2023-06-21 00:00:39] [config] tsv-fields: 0
[2023-06-21 00:00:39] [config] type: amun
[2023-06-21 00:00:39] [config] ulr: false
[2023-06-21 00:00:39] [config] ulr-dim-emb: 0
[2023-06-21 00:00:39] [config] ulr-dropout: 0
[2023-06-21 00:00:39] [config] ulr-keys-vectors: ""
[2023-06-21 00:00:39] [config] ulr-query-vectors: ""
[2023-06-21 00:00:39] [config] ulr-softmax-temperature: 1
[2023-06-21 00:00:39] [config] ulr-trainable-transformation: false
[2023-06-21 00:00:39] [config] unlikelihood-loss: false
[2023-06-21 00:00:39] [config] valid-freq: 5000000
[2023-06-21 00:00:39] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:00:39] [config] valid-max-length: 1000
[2023-06-21 00:00:39] [config] valid-metrics:
[2023-06-21 00:00:39] [config]   - cross-entropy
[2023-06-21 00:00:39] [config] valid-mini-batch: 32
[2023-06-21 00:00:39] [config] valid-reset-stalled: false
[2023-06-21 00:00:39] [config] valid-script-args:
[2023-06-21 00:00:39] [config]   []
[2023-06-21 00:00:39] [config] valid-script-path: ""
[2023-06-21 00:00:39] [config] valid-sets:
[2023-06-21 00:00:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:00:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:00:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:00:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:00:39] [config] vocabs:
[2023-06-21 00:00:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:00:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:00:39] [config] word-penalty: 0
[2023-06-21 00:00:39] [config] word-scores: false
[2023-06-21 00:00:39] [config] workspace: 3000
[2023-06-21 00:00:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:00:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:00:39] [training] Using single-device training
[2023-06-21 00:00:39] Synced seed 1234
[2023-06-21 00:00:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:00:39] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:00:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:00:39] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:00:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:00:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:00:41] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:00:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:00:41] [comm] Using global sharding
[2023-06-21 00:00:41] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:00:41] [training] Using 1 GPUs
[2023-06-21 00:00:41] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:00:41] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:00:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:00:42] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:00:55] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:00:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:00:55] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:00:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:00:55] [comm] Using global sharding
[2023-06-21 00:00:55] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:00:55] [training] Using 1 GPUs
[2023-06-21 00:00:55] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:00:57] Loading Adam parameters
[2023-06-21 00:00:57] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:00:57] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:00:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:00:57] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:00:57] [data] Shuffling data
[2023-06-21 00:00:57] [data] Done reading 20,192 sentences
[2023-06-21 00:00:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:00:57] Training started
[2023-06-21 00:00:57] Training finished
[2023-06-21 00:05:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:05:22] [marian] Running on node17.datos.cluster.uy as process 39392 with command line:
[2023-06-21 00:05:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 150 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:05:22] [config] after: 0e
[2023-06-21 00:05:22] [config] after-batches: 0
[2023-06-21 00:05:22] [config] after-epochs: 150
[2023-06-21 00:05:22] [config] all-caps-every: 0
[2023-06-21 00:05:22] [config] allow-unk: false
[2023-06-21 00:05:22] [config] authors: false
[2023-06-21 00:05:22] [config] beam-size: 12
[2023-06-21 00:05:22] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:05:22] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:05:22] [config] bert-masking-fraction: 0.15
[2023-06-21 00:05:22] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:05:22] [config] bert-train-type-embeddings: true
[2023-06-21 00:05:22] [config] bert-type-vocab-size: 2
[2023-06-21 00:05:22] [config] build-info: ""
[2023-06-21 00:05:22] [config] check-gradient-nan: false
[2023-06-21 00:05:22] [config] check-nan: false
[2023-06-21 00:05:22] [config] cite: false
[2023-06-21 00:05:22] [config] clip-norm: 1
[2023-06-21 00:05:22] [config] cost-scaling:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] cost-type: ce-sum
[2023-06-21 00:05:22] [config] cpu-threads: 0
[2023-06-21 00:05:22] [config] data-threads: 8
[2023-06-21 00:05:22] [config] data-weighting: ""
[2023-06-21 00:05:22] [config] data-weighting-type: sentence
[2023-06-21 00:05:22] [config] dec-cell: gru
[2023-06-21 00:05:22] [config] dec-cell-base-depth: 2
[2023-06-21 00:05:22] [config] dec-cell-high-depth: 1
[2023-06-21 00:05:22] [config] dec-depth: 1
[2023-06-21 00:05:22] [config] devices:
[2023-06-21 00:05:22] [config]   - 0
[2023-06-21 00:05:22] [config] dim-emb: 512
[2023-06-21 00:05:22] [config] dim-rnn: 1024
[2023-06-21 00:05:22] [config] dim-vocabs:
[2023-06-21 00:05:22] [config]   - 54042
[2023-06-21 00:05:22] [config]   - 36507
[2023-06-21 00:05:22] [config] disp-first: 0
[2023-06-21 00:05:22] [config] disp-freq: 1000u
[2023-06-21 00:05:22] [config] disp-label-counts: true
[2023-06-21 00:05:22] [config] dropout-rnn: 0.2
[2023-06-21 00:05:22] [config] dropout-src: 0.1
[2023-06-21 00:05:22] [config] dropout-trg: 0.1
[2023-06-21 00:05:22] [config] dump-config: ""
[2023-06-21 00:05:22] [config] dynamic-gradient-scaling:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] early-stopping: 5
[2023-06-21 00:05:22] [config] early-stopping-on: first
[2023-06-21 00:05:22] [config] embedding-fix-src: false
[2023-06-21 00:05:22] [config] embedding-fix-trg: false
[2023-06-21 00:05:22] [config] embedding-normalization: false
[2023-06-21 00:05:22] [config] embedding-vectors:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] enc-cell: gru
[2023-06-21 00:05:22] [config] enc-cell-depth: 1
[2023-06-21 00:05:22] [config] enc-depth: 1
[2023-06-21 00:05:22] [config] enc-type: bidirectional
[2023-06-21 00:05:22] [config] english-title-case-every: 0
[2023-06-21 00:05:22] [config] exponential-smoothing: 0
[2023-06-21 00:05:22] [config] factor-weight: 1
[2023-06-21 00:05:22] [config] factors-combine: sum
[2023-06-21 00:05:22] [config] factors-dim-emb: 0
[2023-06-21 00:05:22] [config] gradient-checkpointing: false
[2023-06-21 00:05:22] [config] gradient-norm-average-window: 100
[2023-06-21 00:05:22] [config] guided-alignment: none
[2023-06-21 00:05:22] [config] guided-alignment-cost: mse
[2023-06-21 00:05:22] [config] guided-alignment-weight: 0.1
[2023-06-21 00:05:22] [config] ignore-model-config: false
[2023-06-21 00:05:22] [config] input-types:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] interpolate-env-vars: false
[2023-06-21 00:05:22] [config] keep-best: false
[2023-06-21 00:05:22] [config] label-smoothing: 0
[2023-06-21 00:05:22] [config] layer-normalization: true
[2023-06-21 00:05:22] [config] learn-rate: 0.0001
[2023-06-21 00:05:22] [config] lemma-dependency: ""
[2023-06-21 00:05:22] [config] lemma-dim-emb: 0
[2023-06-21 00:05:22] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:05:22] [config] log-level: info
[2023-06-21 00:05:22] [config] log-time-zone: ""
[2023-06-21 00:05:22] [config] logical-epoch:
[2023-06-21 00:05:22] [config]   - 1e
[2023-06-21 00:05:22] [config]   - 0
[2023-06-21 00:05:22] [config] lr-decay: 0
[2023-06-21 00:05:22] [config] lr-decay-freq: 50000
[2023-06-21 00:05:22] [config] lr-decay-inv-sqrt:
[2023-06-21 00:05:22] [config]   - 0
[2023-06-21 00:05:22] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:05:22] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:05:22] [config] lr-decay-start:
[2023-06-21 00:05:22] [config]   - 10
[2023-06-21 00:05:22] [config]   - 1
[2023-06-21 00:05:22] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:05:22] [config] lr-report: false
[2023-06-21 00:05:22] [config] lr-warmup: 0
[2023-06-21 00:05:22] [config] lr-warmup-at-reload: false
[2023-06-21 00:05:22] [config] lr-warmup-cycle: false
[2023-06-21 00:05:22] [config] lr-warmup-start-rate: 0
[2023-06-21 00:05:22] [config] max-length: 50
[2023-06-21 00:05:22] [config] max-length-crop: false
[2023-06-21 00:05:22] [config] max-length-factor: 3
[2023-06-21 00:05:22] [config] maxi-batch: 100
[2023-06-21 00:05:22] [config] maxi-batch-sort: trg
[2023-06-21 00:05:22] [config] mini-batch: 64
[2023-06-21 00:05:22] [config] mini-batch-fit: true
[2023-06-21 00:05:22] [config] mini-batch-fit-step: 10
[2023-06-21 00:05:22] [config] mini-batch-round-up: true
[2023-06-21 00:05:22] [config] mini-batch-track-lr: false
[2023-06-21 00:05:22] [config] mini-batch-warmup: 0
[2023-06-21 00:05:22] [config] mini-batch-words: 0
[2023-06-21 00:05:22] [config] mini-batch-words-ref: 0
[2023-06-21 00:05:22] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:05:22] [config] multi-loss-type: sum
[2023-06-21 00:05:22] [config] n-best: false
[2023-06-21 00:05:22] [config] no-nccl: false
[2023-06-21 00:05:22] [config] no-reload: false
[2023-06-21 00:05:22] [config] no-restore-corpus: false
[2023-06-21 00:05:22] [config] normalize: 0
[2023-06-21 00:05:22] [config] normalize-gradient: false
[2023-06-21 00:05:22] [config] num-devices: 0
[2023-06-21 00:05:22] [config] optimizer: adam
[2023-06-21 00:05:22] [config] optimizer-delay: 1
[2023-06-21 00:05:22] [config] optimizer-params:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] output-omit-bias: false
[2023-06-21 00:05:22] [config] overwrite: false
[2023-06-21 00:05:22] [config] precision:
[2023-06-21 00:05:22] [config]   - float32
[2023-06-21 00:05:22] [config]   - float32
[2023-06-21 00:05:22] [config] pretrained-model: ""
[2023-06-21 00:05:22] [config] quantize-biases: false
[2023-06-21 00:05:22] [config] quantize-bits: 0
[2023-06-21 00:05:22] [config] quantize-log-based: false
[2023-06-21 00:05:22] [config] quantize-optimization-steps: 0
[2023-06-21 00:05:22] [config] quiet: false
[2023-06-21 00:05:22] [config] quiet-translation: true
[2023-06-21 00:05:22] [config] relative-paths: false
[2023-06-21 00:05:22] [config] right-left: false
[2023-06-21 00:05:22] [config] save-freq: 10000u
[2023-06-21 00:05:22] [config] seed: 1234
[2023-06-21 00:05:22] [config] sentencepiece-alphas:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:05:22] [config] sentencepiece-options: ""
[2023-06-21 00:05:22] [config] sharding: global
[2023-06-21 00:05:22] [config] shuffle: data
[2023-06-21 00:05:22] [config] shuffle-in-ram: false
[2023-06-21 00:05:22] [config] sigterm: save-and-exit
[2023-06-21 00:05:22] [config] skip: false
[2023-06-21 00:05:22] [config] sqlite: ""
[2023-06-21 00:05:22] [config] sqlite-drop: false
[2023-06-21 00:05:22] [config] sync-freq: 200u
[2023-06-21 00:05:22] [config] sync-sgd: false
[2023-06-21 00:05:22] [config] tempdir: /tmp
[2023-06-21 00:05:22] [config] tied-embeddings: false
[2023-06-21 00:05:22] [config] tied-embeddings-all: false
[2023-06-21 00:05:22] [config] tied-embeddings-src: false
[2023-06-21 00:05:22] [config] train-embedder-rank:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] train-sets:
[2023-06-21 00:05:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:05:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:05:22] [config] transformer-aan-activation: swish
[2023-06-21 00:05:22] [config] transformer-aan-depth: 2
[2023-06-21 00:05:22] [config] transformer-aan-nogate: false
[2023-06-21 00:05:22] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:05:22] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:05:22] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:05:22] [config] transformer-depth-scaling: false
[2023-06-21 00:05:22] [config] transformer-dim-aan: 2048
[2023-06-21 00:05:22] [config] transformer-dim-ffn: 2048
[2023-06-21 00:05:22] [config] transformer-dropout: 0
[2023-06-21 00:05:22] [config] transformer-dropout-attention: 0
[2023-06-21 00:05:22] [config] transformer-dropout-ffn: 0
[2023-06-21 00:05:22] [config] transformer-ffn-activation: swish
[2023-06-21 00:05:22] [config] transformer-ffn-depth: 2
[2023-06-21 00:05:22] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:05:22] [config] transformer-heads: 8
[2023-06-21 00:05:22] [config] transformer-no-projection: false
[2023-06-21 00:05:22] [config] transformer-pool: false
[2023-06-21 00:05:22] [config] transformer-postprocess: dan
[2023-06-21 00:05:22] [config] transformer-postprocess-emb: d
[2023-06-21 00:05:22] [config] transformer-postprocess-top: ""
[2023-06-21 00:05:22] [config] transformer-preprocess: ""
[2023-06-21 00:05:22] [config] transformer-tied-layers:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] transformer-train-position-embeddings: false
[2023-06-21 00:05:22] [config] tsv: false
[2023-06-21 00:05:22] [config] tsv-fields: 0
[2023-06-21 00:05:22] [config] type: amun
[2023-06-21 00:05:22] [config] ulr: false
[2023-06-21 00:05:22] [config] ulr-dim-emb: 0
[2023-06-21 00:05:22] [config] ulr-dropout: 0
[2023-06-21 00:05:22] [config] ulr-keys-vectors: ""
[2023-06-21 00:05:22] [config] ulr-query-vectors: ""
[2023-06-21 00:05:22] [config] ulr-softmax-temperature: 1
[2023-06-21 00:05:22] [config] ulr-trainable-transformation: false
[2023-06-21 00:05:22] [config] unlikelihood-loss: false
[2023-06-21 00:05:22] [config] valid-freq: 5000000
[2023-06-21 00:05:22] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:05:22] [config] valid-max-length: 1000
[2023-06-21 00:05:22] [config] valid-metrics:
[2023-06-21 00:05:22] [config]   - cross-entropy
[2023-06-21 00:05:22] [config] valid-mini-batch: 32
[2023-06-21 00:05:22] [config] valid-reset-stalled: false
[2023-06-21 00:05:22] [config] valid-script-args:
[2023-06-21 00:05:22] [config]   []
[2023-06-21 00:05:22] [config] valid-script-path: ""
[2023-06-21 00:05:22] [config] valid-sets:
[2023-06-21 00:05:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:05:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:05:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:05:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:05:22] [config] vocabs:
[2023-06-21 00:05:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:05:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:05:22] [config] word-penalty: 0
[2023-06-21 00:05:22] [config] word-scores: false
[2023-06-21 00:05:22] [config] workspace: 3000
[2023-06-21 00:05:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:05:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:05:22] [training] Using single-device training
[2023-06-21 00:05:23] Synced seed 1234
[2023-06-21 00:05:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:05:23] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:05:23] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:05:23] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:05:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:05:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:05:24] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:05:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:05:24] [comm] Using global sharding
[2023-06-21 00:05:25] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:05:25] [training] Using 1 GPUs
[2023-06-21 00:05:25] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:05:25] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:05:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:05:25] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:05:38] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:05:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:05:38] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:05:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:05:38] [comm] Using global sharding
[2023-06-21 00:05:38] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:05:38] [training] Using 1 GPUs
[2023-06-21 00:05:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:05:39] Loading Adam parameters
[2023-06-21 00:05:40] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:05:40] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:05:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:05:40] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:05:40] [data] Shuffling data
[2023-06-21 00:05:40] [data] Done reading 20,192 sentences
[2023-06-21 00:05:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:05:40] Training started
[2023-06-21 00:05:40] Training finished
[2023-06-21 00:10:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:10:11] [marian] Running on node17.datos.cluster.uy as process 39712 with command line:
[2023-06-21 00:10:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 160 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:10:11] [config] after: 0e
[2023-06-21 00:10:11] [config] after-batches: 0
[2023-06-21 00:10:11] [config] after-epochs: 160
[2023-06-21 00:10:11] [config] all-caps-every: 0
[2023-06-21 00:10:11] [config] allow-unk: false
[2023-06-21 00:10:11] [config] authors: false
[2023-06-21 00:10:11] [config] beam-size: 12
[2023-06-21 00:10:11] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:10:11] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:10:11] [config] bert-masking-fraction: 0.15
[2023-06-21 00:10:11] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:10:11] [config] bert-train-type-embeddings: true
[2023-06-21 00:10:11] [config] bert-type-vocab-size: 2
[2023-06-21 00:10:11] [config] build-info: ""
[2023-06-21 00:10:11] [config] check-gradient-nan: false
[2023-06-21 00:10:11] [config] check-nan: false
[2023-06-21 00:10:11] [config] cite: false
[2023-06-21 00:10:11] [config] clip-norm: 1
[2023-06-21 00:10:11] [config] cost-scaling:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] cost-type: ce-sum
[2023-06-21 00:10:11] [config] cpu-threads: 0
[2023-06-21 00:10:11] [config] data-threads: 8
[2023-06-21 00:10:11] [config] data-weighting: ""
[2023-06-21 00:10:11] [config] data-weighting-type: sentence
[2023-06-21 00:10:11] [config] dec-cell: gru
[2023-06-21 00:10:11] [config] dec-cell-base-depth: 2
[2023-06-21 00:10:11] [config] dec-cell-high-depth: 1
[2023-06-21 00:10:11] [config] dec-depth: 1
[2023-06-21 00:10:11] [config] devices:
[2023-06-21 00:10:11] [config]   - 0
[2023-06-21 00:10:11] [config] dim-emb: 512
[2023-06-21 00:10:11] [config] dim-rnn: 1024
[2023-06-21 00:10:11] [config] dim-vocabs:
[2023-06-21 00:10:11] [config]   - 54042
[2023-06-21 00:10:11] [config]   - 36507
[2023-06-21 00:10:11] [config] disp-first: 0
[2023-06-21 00:10:11] [config] disp-freq: 1000u
[2023-06-21 00:10:11] [config] disp-label-counts: true
[2023-06-21 00:10:11] [config] dropout-rnn: 0.2
[2023-06-21 00:10:11] [config] dropout-src: 0.1
[2023-06-21 00:10:11] [config] dropout-trg: 0.1
[2023-06-21 00:10:11] [config] dump-config: ""
[2023-06-21 00:10:11] [config] dynamic-gradient-scaling:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] early-stopping: 5
[2023-06-21 00:10:11] [config] early-stopping-on: first
[2023-06-21 00:10:11] [config] embedding-fix-src: false
[2023-06-21 00:10:11] [config] embedding-fix-trg: false
[2023-06-21 00:10:11] [config] embedding-normalization: false
[2023-06-21 00:10:11] [config] embedding-vectors:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] enc-cell: gru
[2023-06-21 00:10:11] [config] enc-cell-depth: 1
[2023-06-21 00:10:11] [config] enc-depth: 1
[2023-06-21 00:10:11] [config] enc-type: bidirectional
[2023-06-21 00:10:11] [config] english-title-case-every: 0
[2023-06-21 00:10:11] [config] exponential-smoothing: 0
[2023-06-21 00:10:11] [config] factor-weight: 1
[2023-06-21 00:10:11] [config] factors-combine: sum
[2023-06-21 00:10:11] [config] factors-dim-emb: 0
[2023-06-21 00:10:11] [config] gradient-checkpointing: false
[2023-06-21 00:10:11] [config] gradient-norm-average-window: 100
[2023-06-21 00:10:11] [config] guided-alignment: none
[2023-06-21 00:10:11] [config] guided-alignment-cost: mse
[2023-06-21 00:10:11] [config] guided-alignment-weight: 0.1
[2023-06-21 00:10:11] [config] ignore-model-config: false
[2023-06-21 00:10:11] [config] input-types:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] interpolate-env-vars: false
[2023-06-21 00:10:11] [config] keep-best: false
[2023-06-21 00:10:11] [config] label-smoothing: 0
[2023-06-21 00:10:11] [config] layer-normalization: true
[2023-06-21 00:10:11] [config] learn-rate: 0.0001
[2023-06-21 00:10:11] [config] lemma-dependency: ""
[2023-06-21 00:10:11] [config] lemma-dim-emb: 0
[2023-06-21 00:10:11] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:10:11] [config] log-level: info
[2023-06-21 00:10:11] [config] log-time-zone: ""
[2023-06-21 00:10:11] [config] logical-epoch:
[2023-06-21 00:10:11] [config]   - 1e
[2023-06-21 00:10:11] [config]   - 0
[2023-06-21 00:10:11] [config] lr-decay: 0
[2023-06-21 00:10:11] [config] lr-decay-freq: 50000
[2023-06-21 00:10:11] [config] lr-decay-inv-sqrt:
[2023-06-21 00:10:11] [config]   - 0
[2023-06-21 00:10:11] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:10:11] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:10:11] [config] lr-decay-start:
[2023-06-21 00:10:11] [config]   - 10
[2023-06-21 00:10:11] [config]   - 1
[2023-06-21 00:10:11] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:10:11] [config] lr-report: false
[2023-06-21 00:10:11] [config] lr-warmup: 0
[2023-06-21 00:10:11] [config] lr-warmup-at-reload: false
[2023-06-21 00:10:11] [config] lr-warmup-cycle: false
[2023-06-21 00:10:11] [config] lr-warmup-start-rate: 0
[2023-06-21 00:10:11] [config] max-length: 50
[2023-06-21 00:10:11] [config] max-length-crop: false
[2023-06-21 00:10:11] [config] max-length-factor: 3
[2023-06-21 00:10:11] [config] maxi-batch: 100
[2023-06-21 00:10:11] [config] maxi-batch-sort: trg
[2023-06-21 00:10:11] [config] mini-batch: 64
[2023-06-21 00:10:11] [config] mini-batch-fit: true
[2023-06-21 00:10:11] [config] mini-batch-fit-step: 10
[2023-06-21 00:10:11] [config] mini-batch-round-up: true
[2023-06-21 00:10:11] [config] mini-batch-track-lr: false
[2023-06-21 00:10:11] [config] mini-batch-warmup: 0
[2023-06-21 00:10:11] [config] mini-batch-words: 0
[2023-06-21 00:10:11] [config] mini-batch-words-ref: 0
[2023-06-21 00:10:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:10:11] [config] multi-loss-type: sum
[2023-06-21 00:10:11] [config] n-best: false
[2023-06-21 00:10:11] [config] no-nccl: false
[2023-06-21 00:10:11] [config] no-reload: false
[2023-06-21 00:10:11] [config] no-restore-corpus: false
[2023-06-21 00:10:11] [config] normalize: 0
[2023-06-21 00:10:11] [config] normalize-gradient: false
[2023-06-21 00:10:11] [config] num-devices: 0
[2023-06-21 00:10:11] [config] optimizer: adam
[2023-06-21 00:10:11] [config] optimizer-delay: 1
[2023-06-21 00:10:11] [config] optimizer-params:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] output-omit-bias: false
[2023-06-21 00:10:11] [config] overwrite: false
[2023-06-21 00:10:11] [config] precision:
[2023-06-21 00:10:11] [config]   - float32
[2023-06-21 00:10:11] [config]   - float32
[2023-06-21 00:10:11] [config] pretrained-model: ""
[2023-06-21 00:10:11] [config] quantize-biases: false
[2023-06-21 00:10:11] [config] quantize-bits: 0
[2023-06-21 00:10:11] [config] quantize-log-based: false
[2023-06-21 00:10:11] [config] quantize-optimization-steps: 0
[2023-06-21 00:10:11] [config] quiet: false
[2023-06-21 00:10:11] [config] quiet-translation: true
[2023-06-21 00:10:11] [config] relative-paths: false
[2023-06-21 00:10:11] [config] right-left: false
[2023-06-21 00:10:11] [config] save-freq: 10000u
[2023-06-21 00:10:11] [config] seed: 1234
[2023-06-21 00:10:11] [config] sentencepiece-alphas:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:10:11] [config] sentencepiece-options: ""
[2023-06-21 00:10:11] [config] sharding: global
[2023-06-21 00:10:11] [config] shuffle: data
[2023-06-21 00:10:11] [config] shuffle-in-ram: false
[2023-06-21 00:10:11] [config] sigterm: save-and-exit
[2023-06-21 00:10:11] [config] skip: false
[2023-06-21 00:10:11] [config] sqlite: ""
[2023-06-21 00:10:11] [config] sqlite-drop: false
[2023-06-21 00:10:11] [config] sync-freq: 200u
[2023-06-21 00:10:11] [config] sync-sgd: false
[2023-06-21 00:10:11] [config] tempdir: /tmp
[2023-06-21 00:10:11] [config] tied-embeddings: false
[2023-06-21 00:10:11] [config] tied-embeddings-all: false
[2023-06-21 00:10:11] [config] tied-embeddings-src: false
[2023-06-21 00:10:11] [config] train-embedder-rank:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] train-sets:
[2023-06-21 00:10:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:10:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:10:11] [config] transformer-aan-activation: swish
[2023-06-21 00:10:11] [config] transformer-aan-depth: 2
[2023-06-21 00:10:11] [config] transformer-aan-nogate: false
[2023-06-21 00:10:11] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:10:11] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:10:11] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:10:11] [config] transformer-depth-scaling: false
[2023-06-21 00:10:11] [config] transformer-dim-aan: 2048
[2023-06-21 00:10:11] [config] transformer-dim-ffn: 2048
[2023-06-21 00:10:11] [config] transformer-dropout: 0
[2023-06-21 00:10:11] [config] transformer-dropout-attention: 0
[2023-06-21 00:10:11] [config] transformer-dropout-ffn: 0
[2023-06-21 00:10:11] [config] transformer-ffn-activation: swish
[2023-06-21 00:10:11] [config] transformer-ffn-depth: 2
[2023-06-21 00:10:11] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:10:11] [config] transformer-heads: 8
[2023-06-21 00:10:11] [config] transformer-no-projection: false
[2023-06-21 00:10:11] [config] transformer-pool: false
[2023-06-21 00:10:11] [config] transformer-postprocess: dan
[2023-06-21 00:10:11] [config] transformer-postprocess-emb: d
[2023-06-21 00:10:11] [config] transformer-postprocess-top: ""
[2023-06-21 00:10:11] [config] transformer-preprocess: ""
[2023-06-21 00:10:11] [config] transformer-tied-layers:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] transformer-train-position-embeddings: false
[2023-06-21 00:10:11] [config] tsv: false
[2023-06-21 00:10:11] [config] tsv-fields: 0
[2023-06-21 00:10:11] [config] type: amun
[2023-06-21 00:10:11] [config] ulr: false
[2023-06-21 00:10:11] [config] ulr-dim-emb: 0
[2023-06-21 00:10:11] [config] ulr-dropout: 0
[2023-06-21 00:10:11] [config] ulr-keys-vectors: ""
[2023-06-21 00:10:11] [config] ulr-query-vectors: ""
[2023-06-21 00:10:11] [config] ulr-softmax-temperature: 1
[2023-06-21 00:10:11] [config] ulr-trainable-transformation: false
[2023-06-21 00:10:11] [config] unlikelihood-loss: false
[2023-06-21 00:10:11] [config] valid-freq: 5000000
[2023-06-21 00:10:11] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:10:11] [config] valid-max-length: 1000
[2023-06-21 00:10:11] [config] valid-metrics:
[2023-06-21 00:10:11] [config]   - cross-entropy
[2023-06-21 00:10:11] [config] valid-mini-batch: 32
[2023-06-21 00:10:11] [config] valid-reset-stalled: false
[2023-06-21 00:10:11] [config] valid-script-args:
[2023-06-21 00:10:11] [config]   []
[2023-06-21 00:10:11] [config] valid-script-path: ""
[2023-06-21 00:10:11] [config] valid-sets:
[2023-06-21 00:10:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:10:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:10:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:10:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:10:11] [config] vocabs:
[2023-06-21 00:10:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:10:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:10:11] [config] word-penalty: 0
[2023-06-21 00:10:11] [config] word-scores: false
[2023-06-21 00:10:11] [config] workspace: 3000
[2023-06-21 00:10:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:10:11] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:10:11] [training] Using single-device training
[2023-06-21 00:10:12] Synced seed 1234
[2023-06-21 00:10:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:10:12] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:10:12] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:10:12] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:10:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:10:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:10:13] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:10:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:10:13] [comm] Using global sharding
[2023-06-21 00:10:14] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:10:14] [training] Using 1 GPUs
[2023-06-21 00:10:14] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:10:14] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:10:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:10:14] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:10:27] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:10:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:10:27] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:10:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:10:27] [comm] Using global sharding
[2023-06-21 00:10:27] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:10:27] [training] Using 1 GPUs
[2023-06-21 00:10:27] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:10:29] Loading Adam parameters
[2023-06-21 00:10:29] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:10:29] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:10:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:10:30] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:10:30] [data] Shuffling data
[2023-06-21 00:10:30] [data] Done reading 20,192 sentences
[2023-06-21 00:10:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:10:30] Training started
[2023-06-21 00:10:30] Training finished
[2023-06-21 00:14:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:14:50] [marian] Running on node17.datos.cluster.uy as process 40020 with command line:
[2023-06-21 00:14:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 170 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:14:50] [config] after: 0e
[2023-06-21 00:14:50] [config] after-batches: 0
[2023-06-21 00:14:50] [config] after-epochs: 170
[2023-06-21 00:14:50] [config] all-caps-every: 0
[2023-06-21 00:14:50] [config] allow-unk: false
[2023-06-21 00:14:50] [config] authors: false
[2023-06-21 00:14:50] [config] beam-size: 12
[2023-06-21 00:14:50] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:14:50] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:14:50] [config] bert-masking-fraction: 0.15
[2023-06-21 00:14:50] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:14:50] [config] bert-train-type-embeddings: true
[2023-06-21 00:14:50] [config] bert-type-vocab-size: 2
[2023-06-21 00:14:50] [config] build-info: ""
[2023-06-21 00:14:50] [config] check-gradient-nan: false
[2023-06-21 00:14:50] [config] check-nan: false
[2023-06-21 00:14:50] [config] cite: false
[2023-06-21 00:14:50] [config] clip-norm: 1
[2023-06-21 00:14:50] [config] cost-scaling:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] cost-type: ce-sum
[2023-06-21 00:14:50] [config] cpu-threads: 0
[2023-06-21 00:14:50] [config] data-threads: 8
[2023-06-21 00:14:50] [config] data-weighting: ""
[2023-06-21 00:14:50] [config] data-weighting-type: sentence
[2023-06-21 00:14:50] [config] dec-cell: gru
[2023-06-21 00:14:50] [config] dec-cell-base-depth: 2
[2023-06-21 00:14:50] [config] dec-cell-high-depth: 1
[2023-06-21 00:14:50] [config] dec-depth: 1
[2023-06-21 00:14:50] [config] devices:
[2023-06-21 00:14:50] [config]   - 0
[2023-06-21 00:14:50] [config] dim-emb: 512
[2023-06-21 00:14:50] [config] dim-rnn: 1024
[2023-06-21 00:14:50] [config] dim-vocabs:
[2023-06-21 00:14:50] [config]   - 54042
[2023-06-21 00:14:50] [config]   - 36507
[2023-06-21 00:14:50] [config] disp-first: 0
[2023-06-21 00:14:50] [config] disp-freq: 1000u
[2023-06-21 00:14:50] [config] disp-label-counts: true
[2023-06-21 00:14:50] [config] dropout-rnn: 0.2
[2023-06-21 00:14:50] [config] dropout-src: 0.1
[2023-06-21 00:14:50] [config] dropout-trg: 0.1
[2023-06-21 00:14:50] [config] dump-config: ""
[2023-06-21 00:14:50] [config] dynamic-gradient-scaling:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] early-stopping: 5
[2023-06-21 00:14:50] [config] early-stopping-on: first
[2023-06-21 00:14:50] [config] embedding-fix-src: false
[2023-06-21 00:14:50] [config] embedding-fix-trg: false
[2023-06-21 00:14:50] [config] embedding-normalization: false
[2023-06-21 00:14:50] [config] embedding-vectors:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] enc-cell: gru
[2023-06-21 00:14:50] [config] enc-cell-depth: 1
[2023-06-21 00:14:50] [config] enc-depth: 1
[2023-06-21 00:14:50] [config] enc-type: bidirectional
[2023-06-21 00:14:50] [config] english-title-case-every: 0
[2023-06-21 00:14:50] [config] exponential-smoothing: 0
[2023-06-21 00:14:50] [config] factor-weight: 1
[2023-06-21 00:14:50] [config] factors-combine: sum
[2023-06-21 00:14:50] [config] factors-dim-emb: 0
[2023-06-21 00:14:50] [config] gradient-checkpointing: false
[2023-06-21 00:14:50] [config] gradient-norm-average-window: 100
[2023-06-21 00:14:50] [config] guided-alignment: none
[2023-06-21 00:14:50] [config] guided-alignment-cost: mse
[2023-06-21 00:14:50] [config] guided-alignment-weight: 0.1
[2023-06-21 00:14:50] [config] ignore-model-config: false
[2023-06-21 00:14:50] [config] input-types:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] interpolate-env-vars: false
[2023-06-21 00:14:50] [config] keep-best: false
[2023-06-21 00:14:50] [config] label-smoothing: 0
[2023-06-21 00:14:50] [config] layer-normalization: true
[2023-06-21 00:14:50] [config] learn-rate: 0.0001
[2023-06-21 00:14:50] [config] lemma-dependency: ""
[2023-06-21 00:14:50] [config] lemma-dim-emb: 0
[2023-06-21 00:14:50] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:14:50] [config] log-level: info
[2023-06-21 00:14:50] [config] log-time-zone: ""
[2023-06-21 00:14:50] [config] logical-epoch:
[2023-06-21 00:14:50] [config]   - 1e
[2023-06-21 00:14:50] [config]   - 0
[2023-06-21 00:14:50] [config] lr-decay: 0
[2023-06-21 00:14:50] [config] lr-decay-freq: 50000
[2023-06-21 00:14:50] [config] lr-decay-inv-sqrt:
[2023-06-21 00:14:50] [config]   - 0
[2023-06-21 00:14:50] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:14:50] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:14:50] [config] lr-decay-start:
[2023-06-21 00:14:50] [config]   - 10
[2023-06-21 00:14:50] [config]   - 1
[2023-06-21 00:14:50] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:14:50] [config] lr-report: false
[2023-06-21 00:14:50] [config] lr-warmup: 0
[2023-06-21 00:14:50] [config] lr-warmup-at-reload: false
[2023-06-21 00:14:50] [config] lr-warmup-cycle: false
[2023-06-21 00:14:50] [config] lr-warmup-start-rate: 0
[2023-06-21 00:14:50] [config] max-length: 50
[2023-06-21 00:14:50] [config] max-length-crop: false
[2023-06-21 00:14:50] [config] max-length-factor: 3
[2023-06-21 00:14:50] [config] maxi-batch: 100
[2023-06-21 00:14:50] [config] maxi-batch-sort: trg
[2023-06-21 00:14:50] [config] mini-batch: 64
[2023-06-21 00:14:50] [config] mini-batch-fit: true
[2023-06-21 00:14:50] [config] mini-batch-fit-step: 10
[2023-06-21 00:14:50] [config] mini-batch-round-up: true
[2023-06-21 00:14:50] [config] mini-batch-track-lr: false
[2023-06-21 00:14:50] [config] mini-batch-warmup: 0
[2023-06-21 00:14:50] [config] mini-batch-words: 0
[2023-06-21 00:14:50] [config] mini-batch-words-ref: 0
[2023-06-21 00:14:50] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:14:50] [config] multi-loss-type: sum
[2023-06-21 00:14:50] [config] n-best: false
[2023-06-21 00:14:50] [config] no-nccl: false
[2023-06-21 00:14:50] [config] no-reload: false
[2023-06-21 00:14:50] [config] no-restore-corpus: false
[2023-06-21 00:14:50] [config] normalize: 0
[2023-06-21 00:14:50] [config] normalize-gradient: false
[2023-06-21 00:14:50] [config] num-devices: 0
[2023-06-21 00:14:50] [config] optimizer: adam
[2023-06-21 00:14:50] [config] optimizer-delay: 1
[2023-06-21 00:14:50] [config] optimizer-params:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] output-omit-bias: false
[2023-06-21 00:14:50] [config] overwrite: false
[2023-06-21 00:14:50] [config] precision:
[2023-06-21 00:14:50] [config]   - float32
[2023-06-21 00:14:50] [config]   - float32
[2023-06-21 00:14:50] [config] pretrained-model: ""
[2023-06-21 00:14:50] [config] quantize-biases: false
[2023-06-21 00:14:50] [config] quantize-bits: 0
[2023-06-21 00:14:50] [config] quantize-log-based: false
[2023-06-21 00:14:50] [config] quantize-optimization-steps: 0
[2023-06-21 00:14:50] [config] quiet: false
[2023-06-21 00:14:50] [config] quiet-translation: true
[2023-06-21 00:14:50] [config] relative-paths: false
[2023-06-21 00:14:50] [config] right-left: false
[2023-06-21 00:14:50] [config] save-freq: 10000u
[2023-06-21 00:14:50] [config] seed: 1234
[2023-06-21 00:14:50] [config] sentencepiece-alphas:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:14:50] [config] sentencepiece-options: ""
[2023-06-21 00:14:50] [config] sharding: global
[2023-06-21 00:14:50] [config] shuffle: data
[2023-06-21 00:14:50] [config] shuffle-in-ram: false
[2023-06-21 00:14:50] [config] sigterm: save-and-exit
[2023-06-21 00:14:50] [config] skip: false
[2023-06-21 00:14:50] [config] sqlite: ""
[2023-06-21 00:14:50] [config] sqlite-drop: false
[2023-06-21 00:14:50] [config] sync-freq: 200u
[2023-06-21 00:14:50] [config] sync-sgd: false
[2023-06-21 00:14:50] [config] tempdir: /tmp
[2023-06-21 00:14:50] [config] tied-embeddings: false
[2023-06-21 00:14:50] [config] tied-embeddings-all: false
[2023-06-21 00:14:50] [config] tied-embeddings-src: false
[2023-06-21 00:14:50] [config] train-embedder-rank:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] train-sets:
[2023-06-21 00:14:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:14:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:14:50] [config] transformer-aan-activation: swish
[2023-06-21 00:14:50] [config] transformer-aan-depth: 2
[2023-06-21 00:14:50] [config] transformer-aan-nogate: false
[2023-06-21 00:14:50] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:14:50] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:14:50] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:14:50] [config] transformer-depth-scaling: false
[2023-06-21 00:14:50] [config] transformer-dim-aan: 2048
[2023-06-21 00:14:50] [config] transformer-dim-ffn: 2048
[2023-06-21 00:14:50] [config] transformer-dropout: 0
[2023-06-21 00:14:50] [config] transformer-dropout-attention: 0
[2023-06-21 00:14:50] [config] transformer-dropout-ffn: 0
[2023-06-21 00:14:50] [config] transformer-ffn-activation: swish
[2023-06-21 00:14:50] [config] transformer-ffn-depth: 2
[2023-06-21 00:14:50] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:14:50] [config] transformer-heads: 8
[2023-06-21 00:14:50] [config] transformer-no-projection: false
[2023-06-21 00:14:50] [config] transformer-pool: false
[2023-06-21 00:14:50] [config] transformer-postprocess: dan
[2023-06-21 00:14:50] [config] transformer-postprocess-emb: d
[2023-06-21 00:14:50] [config] transformer-postprocess-top: ""
[2023-06-21 00:14:50] [config] transformer-preprocess: ""
[2023-06-21 00:14:50] [config] transformer-tied-layers:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] transformer-train-position-embeddings: false
[2023-06-21 00:14:50] [config] tsv: false
[2023-06-21 00:14:50] [config] tsv-fields: 0
[2023-06-21 00:14:50] [config] type: amun
[2023-06-21 00:14:50] [config] ulr: false
[2023-06-21 00:14:50] [config] ulr-dim-emb: 0
[2023-06-21 00:14:50] [config] ulr-dropout: 0
[2023-06-21 00:14:50] [config] ulr-keys-vectors: ""
[2023-06-21 00:14:50] [config] ulr-query-vectors: ""
[2023-06-21 00:14:50] [config] ulr-softmax-temperature: 1
[2023-06-21 00:14:50] [config] ulr-trainable-transformation: false
[2023-06-21 00:14:50] [config] unlikelihood-loss: false
[2023-06-21 00:14:50] [config] valid-freq: 5000000
[2023-06-21 00:14:50] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:14:50] [config] valid-max-length: 1000
[2023-06-21 00:14:50] [config] valid-metrics:
[2023-06-21 00:14:50] [config]   - cross-entropy
[2023-06-21 00:14:50] [config] valid-mini-batch: 32
[2023-06-21 00:14:50] [config] valid-reset-stalled: false
[2023-06-21 00:14:50] [config] valid-script-args:
[2023-06-21 00:14:50] [config]   []
[2023-06-21 00:14:50] [config] valid-script-path: ""
[2023-06-21 00:14:50] [config] valid-sets:
[2023-06-21 00:14:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:14:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:14:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:14:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:14:50] [config] vocabs:
[2023-06-21 00:14:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:14:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:14:50] [config] word-penalty: 0
[2023-06-21 00:14:50] [config] word-scores: false
[2023-06-21 00:14:50] [config] workspace: 3000
[2023-06-21 00:14:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:14:50] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:14:50] [training] Using single-device training
[2023-06-21 00:14:50] Synced seed 1234
[2023-06-21 00:14:50] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:14:50] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:14:50] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:14:50] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:14:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:14:50] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:14:52] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:14:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:14:52] [comm] Using global sharding
[2023-06-21 00:14:52] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:14:52] [training] Using 1 GPUs
[2023-06-21 00:14:52] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:14:52] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:14:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:14:53] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:15:06] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:15:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:15:06] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:15:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:15:06] [comm] Using global sharding
[2023-06-21 00:15:06] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:15:06] [training] Using 1 GPUs
[2023-06-21 00:15:06] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:15:08] Loading Adam parameters
[2023-06-21 00:15:08] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:15:08] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:15:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:15:09] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:15:09] [data] Shuffling data
[2023-06-21 00:15:09] [data] Done reading 20,192 sentences
[2023-06-21 00:15:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:15:09] Training started
[2023-06-21 00:15:09] Training finished
[2023-06-21 00:19:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:19:30] [marian] Running on node17.datos.cluster.uy as process 40334 with command line:
[2023-06-21 00:19:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 180 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:19:30] [config] after: 0e
[2023-06-21 00:19:30] [config] after-batches: 0
[2023-06-21 00:19:30] [config] after-epochs: 180
[2023-06-21 00:19:30] [config] all-caps-every: 0
[2023-06-21 00:19:30] [config] allow-unk: false
[2023-06-21 00:19:30] [config] authors: false
[2023-06-21 00:19:30] [config] beam-size: 12
[2023-06-21 00:19:30] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:19:30] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:19:30] [config] bert-masking-fraction: 0.15
[2023-06-21 00:19:30] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:19:30] [config] bert-train-type-embeddings: true
[2023-06-21 00:19:30] [config] bert-type-vocab-size: 2
[2023-06-21 00:19:30] [config] build-info: ""
[2023-06-21 00:19:30] [config] check-gradient-nan: false
[2023-06-21 00:19:30] [config] check-nan: false
[2023-06-21 00:19:30] [config] cite: false
[2023-06-21 00:19:30] [config] clip-norm: 1
[2023-06-21 00:19:30] [config] cost-scaling:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] cost-type: ce-sum
[2023-06-21 00:19:30] [config] cpu-threads: 0
[2023-06-21 00:19:30] [config] data-threads: 8
[2023-06-21 00:19:30] [config] data-weighting: ""
[2023-06-21 00:19:30] [config] data-weighting-type: sentence
[2023-06-21 00:19:30] [config] dec-cell: gru
[2023-06-21 00:19:30] [config] dec-cell-base-depth: 2
[2023-06-21 00:19:30] [config] dec-cell-high-depth: 1
[2023-06-21 00:19:30] [config] dec-depth: 1
[2023-06-21 00:19:30] [config] devices:
[2023-06-21 00:19:30] [config]   - 0
[2023-06-21 00:19:30] [config] dim-emb: 512
[2023-06-21 00:19:30] [config] dim-rnn: 1024
[2023-06-21 00:19:30] [config] dim-vocabs:
[2023-06-21 00:19:30] [config]   - 54042
[2023-06-21 00:19:30] [config]   - 36507
[2023-06-21 00:19:30] [config] disp-first: 0
[2023-06-21 00:19:30] [config] disp-freq: 1000u
[2023-06-21 00:19:30] [config] disp-label-counts: true
[2023-06-21 00:19:30] [config] dropout-rnn: 0.2
[2023-06-21 00:19:30] [config] dropout-src: 0.1
[2023-06-21 00:19:30] [config] dropout-trg: 0.1
[2023-06-21 00:19:30] [config] dump-config: ""
[2023-06-21 00:19:30] [config] dynamic-gradient-scaling:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] early-stopping: 5
[2023-06-21 00:19:30] [config] early-stopping-on: first
[2023-06-21 00:19:30] [config] embedding-fix-src: false
[2023-06-21 00:19:30] [config] embedding-fix-trg: false
[2023-06-21 00:19:30] [config] embedding-normalization: false
[2023-06-21 00:19:30] [config] embedding-vectors:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] enc-cell: gru
[2023-06-21 00:19:30] [config] enc-cell-depth: 1
[2023-06-21 00:19:30] [config] enc-depth: 1
[2023-06-21 00:19:30] [config] enc-type: bidirectional
[2023-06-21 00:19:30] [config] english-title-case-every: 0
[2023-06-21 00:19:30] [config] exponential-smoothing: 0
[2023-06-21 00:19:30] [config] factor-weight: 1
[2023-06-21 00:19:30] [config] factors-combine: sum
[2023-06-21 00:19:30] [config] factors-dim-emb: 0
[2023-06-21 00:19:30] [config] gradient-checkpointing: false
[2023-06-21 00:19:30] [config] gradient-norm-average-window: 100
[2023-06-21 00:19:30] [config] guided-alignment: none
[2023-06-21 00:19:30] [config] guided-alignment-cost: mse
[2023-06-21 00:19:30] [config] guided-alignment-weight: 0.1
[2023-06-21 00:19:30] [config] ignore-model-config: false
[2023-06-21 00:19:30] [config] input-types:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] interpolate-env-vars: false
[2023-06-21 00:19:30] [config] keep-best: false
[2023-06-21 00:19:30] [config] label-smoothing: 0
[2023-06-21 00:19:30] [config] layer-normalization: true
[2023-06-21 00:19:30] [config] learn-rate: 0.0001
[2023-06-21 00:19:30] [config] lemma-dependency: ""
[2023-06-21 00:19:30] [config] lemma-dim-emb: 0
[2023-06-21 00:19:30] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:19:30] [config] log-level: info
[2023-06-21 00:19:30] [config] log-time-zone: ""
[2023-06-21 00:19:30] [config] logical-epoch:
[2023-06-21 00:19:30] [config]   - 1e
[2023-06-21 00:19:30] [config]   - 0
[2023-06-21 00:19:30] [config] lr-decay: 0
[2023-06-21 00:19:30] [config] lr-decay-freq: 50000
[2023-06-21 00:19:30] [config] lr-decay-inv-sqrt:
[2023-06-21 00:19:30] [config]   - 0
[2023-06-21 00:19:30] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:19:30] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:19:30] [config] lr-decay-start:
[2023-06-21 00:19:30] [config]   - 10
[2023-06-21 00:19:30] [config]   - 1
[2023-06-21 00:19:30] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:19:30] [config] lr-report: false
[2023-06-21 00:19:30] [config] lr-warmup: 0
[2023-06-21 00:19:30] [config] lr-warmup-at-reload: false
[2023-06-21 00:19:30] [config] lr-warmup-cycle: false
[2023-06-21 00:19:30] [config] lr-warmup-start-rate: 0
[2023-06-21 00:19:30] [config] max-length: 50
[2023-06-21 00:19:30] [config] max-length-crop: false
[2023-06-21 00:19:30] [config] max-length-factor: 3
[2023-06-21 00:19:30] [config] maxi-batch: 100
[2023-06-21 00:19:30] [config] maxi-batch-sort: trg
[2023-06-21 00:19:30] [config] mini-batch: 64
[2023-06-21 00:19:30] [config] mini-batch-fit: true
[2023-06-21 00:19:30] [config] mini-batch-fit-step: 10
[2023-06-21 00:19:30] [config] mini-batch-round-up: true
[2023-06-21 00:19:30] [config] mini-batch-track-lr: false
[2023-06-21 00:19:30] [config] mini-batch-warmup: 0
[2023-06-21 00:19:30] [config] mini-batch-words: 0
[2023-06-21 00:19:30] [config] mini-batch-words-ref: 0
[2023-06-21 00:19:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:19:30] [config] multi-loss-type: sum
[2023-06-21 00:19:30] [config] n-best: false
[2023-06-21 00:19:30] [config] no-nccl: false
[2023-06-21 00:19:30] [config] no-reload: false
[2023-06-21 00:19:30] [config] no-restore-corpus: false
[2023-06-21 00:19:30] [config] normalize: 0
[2023-06-21 00:19:30] [config] normalize-gradient: false
[2023-06-21 00:19:30] [config] num-devices: 0
[2023-06-21 00:19:30] [config] optimizer: adam
[2023-06-21 00:19:30] [config] optimizer-delay: 1
[2023-06-21 00:19:30] [config] optimizer-params:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] output-omit-bias: false
[2023-06-21 00:19:30] [config] overwrite: false
[2023-06-21 00:19:30] [config] precision:
[2023-06-21 00:19:30] [config]   - float32
[2023-06-21 00:19:30] [config]   - float32
[2023-06-21 00:19:30] [config] pretrained-model: ""
[2023-06-21 00:19:30] [config] quantize-biases: false
[2023-06-21 00:19:30] [config] quantize-bits: 0
[2023-06-21 00:19:30] [config] quantize-log-based: false
[2023-06-21 00:19:30] [config] quantize-optimization-steps: 0
[2023-06-21 00:19:30] [config] quiet: false
[2023-06-21 00:19:30] [config] quiet-translation: true
[2023-06-21 00:19:30] [config] relative-paths: false
[2023-06-21 00:19:30] [config] right-left: false
[2023-06-21 00:19:30] [config] save-freq: 10000u
[2023-06-21 00:19:30] [config] seed: 1234
[2023-06-21 00:19:30] [config] sentencepiece-alphas:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:19:30] [config] sentencepiece-options: ""
[2023-06-21 00:19:30] [config] sharding: global
[2023-06-21 00:19:30] [config] shuffle: data
[2023-06-21 00:19:30] [config] shuffle-in-ram: false
[2023-06-21 00:19:30] [config] sigterm: save-and-exit
[2023-06-21 00:19:30] [config] skip: false
[2023-06-21 00:19:30] [config] sqlite: ""
[2023-06-21 00:19:30] [config] sqlite-drop: false
[2023-06-21 00:19:30] [config] sync-freq: 200u
[2023-06-21 00:19:30] [config] sync-sgd: false
[2023-06-21 00:19:30] [config] tempdir: /tmp
[2023-06-21 00:19:30] [config] tied-embeddings: false
[2023-06-21 00:19:30] [config] tied-embeddings-all: false
[2023-06-21 00:19:30] [config] tied-embeddings-src: false
[2023-06-21 00:19:30] [config] train-embedder-rank:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] train-sets:
[2023-06-21 00:19:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:19:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:19:30] [config] transformer-aan-activation: swish
[2023-06-21 00:19:30] [config] transformer-aan-depth: 2
[2023-06-21 00:19:30] [config] transformer-aan-nogate: false
[2023-06-21 00:19:30] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:19:30] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:19:30] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:19:30] [config] transformer-depth-scaling: false
[2023-06-21 00:19:30] [config] transformer-dim-aan: 2048
[2023-06-21 00:19:30] [config] transformer-dim-ffn: 2048
[2023-06-21 00:19:30] [config] transformer-dropout: 0
[2023-06-21 00:19:30] [config] transformer-dropout-attention: 0
[2023-06-21 00:19:30] [config] transformer-dropout-ffn: 0
[2023-06-21 00:19:30] [config] transformer-ffn-activation: swish
[2023-06-21 00:19:30] [config] transformer-ffn-depth: 2
[2023-06-21 00:19:30] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:19:30] [config] transformer-heads: 8
[2023-06-21 00:19:30] [config] transformer-no-projection: false
[2023-06-21 00:19:30] [config] transformer-pool: false
[2023-06-21 00:19:30] [config] transformer-postprocess: dan
[2023-06-21 00:19:30] [config] transformer-postprocess-emb: d
[2023-06-21 00:19:30] [config] transformer-postprocess-top: ""
[2023-06-21 00:19:30] [config] transformer-preprocess: ""
[2023-06-21 00:19:30] [config] transformer-tied-layers:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] transformer-train-position-embeddings: false
[2023-06-21 00:19:30] [config] tsv: false
[2023-06-21 00:19:30] [config] tsv-fields: 0
[2023-06-21 00:19:30] [config] type: amun
[2023-06-21 00:19:30] [config] ulr: false
[2023-06-21 00:19:30] [config] ulr-dim-emb: 0
[2023-06-21 00:19:30] [config] ulr-dropout: 0
[2023-06-21 00:19:30] [config] ulr-keys-vectors: ""
[2023-06-21 00:19:30] [config] ulr-query-vectors: ""
[2023-06-21 00:19:30] [config] ulr-softmax-temperature: 1
[2023-06-21 00:19:30] [config] ulr-trainable-transformation: false
[2023-06-21 00:19:30] [config] unlikelihood-loss: false
[2023-06-21 00:19:30] [config] valid-freq: 5000000
[2023-06-21 00:19:30] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:19:30] [config] valid-max-length: 1000
[2023-06-21 00:19:30] [config] valid-metrics:
[2023-06-21 00:19:30] [config]   - cross-entropy
[2023-06-21 00:19:30] [config] valid-mini-batch: 32
[2023-06-21 00:19:30] [config] valid-reset-stalled: false
[2023-06-21 00:19:30] [config] valid-script-args:
[2023-06-21 00:19:30] [config]   []
[2023-06-21 00:19:30] [config] valid-script-path: ""
[2023-06-21 00:19:30] [config] valid-sets:
[2023-06-21 00:19:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:19:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:19:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:19:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:19:30] [config] vocabs:
[2023-06-21 00:19:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:19:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:19:30] [config] word-penalty: 0
[2023-06-21 00:19:30] [config] word-scores: false
[2023-06-21 00:19:30] [config] workspace: 3000
[2023-06-21 00:19:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:19:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:19:30] [training] Using single-device training
[2023-06-21 00:19:31] Synced seed 1234
[2023-06-21 00:19:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:19:31] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:19:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:19:31] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:19:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:19:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:19:32] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:19:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:19:32] [comm] Using global sharding
[2023-06-21 00:19:33] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:19:33] [training] Using 1 GPUs
[2023-06-21 00:19:33] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:19:33] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:19:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:19:33] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:19:46] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:19:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:19:46] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:19:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:19:46] [comm] Using global sharding
[2023-06-21 00:19:46] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:19:46] [training] Using 1 GPUs
[2023-06-21 00:19:46] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:19:48] Loading Adam parameters
[2023-06-21 00:19:48] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:19:48] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:19:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:19:49] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:19:49] [data] Shuffling data
[2023-06-21 00:19:49] [data] Done reading 20,192 sentences
[2023-06-21 00:19:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:19:49] Training started
[2023-06-21 00:19:49] Training finished
[2023-06-21 00:24:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:24:10] [marian] Running on node17.datos.cluster.uy as process 40642 with command line:
[2023-06-21 00:24:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 190 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:24:10] [config] after: 0e
[2023-06-21 00:24:10] [config] after-batches: 0
[2023-06-21 00:24:10] [config] after-epochs: 190
[2023-06-21 00:24:10] [config] all-caps-every: 0
[2023-06-21 00:24:10] [config] allow-unk: false
[2023-06-21 00:24:10] [config] authors: false
[2023-06-21 00:24:10] [config] beam-size: 12
[2023-06-21 00:24:10] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:24:10] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:24:10] [config] bert-masking-fraction: 0.15
[2023-06-21 00:24:10] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:24:10] [config] bert-train-type-embeddings: true
[2023-06-21 00:24:10] [config] bert-type-vocab-size: 2
[2023-06-21 00:24:10] [config] build-info: ""
[2023-06-21 00:24:10] [config] check-gradient-nan: false
[2023-06-21 00:24:10] [config] check-nan: false
[2023-06-21 00:24:10] [config] cite: false
[2023-06-21 00:24:10] [config] clip-norm: 1
[2023-06-21 00:24:10] [config] cost-scaling:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] cost-type: ce-sum
[2023-06-21 00:24:10] [config] cpu-threads: 0
[2023-06-21 00:24:10] [config] data-threads: 8
[2023-06-21 00:24:10] [config] data-weighting: ""
[2023-06-21 00:24:10] [config] data-weighting-type: sentence
[2023-06-21 00:24:10] [config] dec-cell: gru
[2023-06-21 00:24:10] [config] dec-cell-base-depth: 2
[2023-06-21 00:24:10] [config] dec-cell-high-depth: 1
[2023-06-21 00:24:10] [config] dec-depth: 1
[2023-06-21 00:24:10] [config] devices:
[2023-06-21 00:24:10] [config]   - 0
[2023-06-21 00:24:10] [config] dim-emb: 512
[2023-06-21 00:24:10] [config] dim-rnn: 1024
[2023-06-21 00:24:10] [config] dim-vocabs:
[2023-06-21 00:24:10] [config]   - 54042
[2023-06-21 00:24:10] [config]   - 36507
[2023-06-21 00:24:10] [config] disp-first: 0
[2023-06-21 00:24:10] [config] disp-freq: 1000u
[2023-06-21 00:24:10] [config] disp-label-counts: true
[2023-06-21 00:24:10] [config] dropout-rnn: 0.2
[2023-06-21 00:24:10] [config] dropout-src: 0.1
[2023-06-21 00:24:10] [config] dropout-trg: 0.1
[2023-06-21 00:24:10] [config] dump-config: ""
[2023-06-21 00:24:10] [config] dynamic-gradient-scaling:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] early-stopping: 5
[2023-06-21 00:24:10] [config] early-stopping-on: first
[2023-06-21 00:24:10] [config] embedding-fix-src: false
[2023-06-21 00:24:10] [config] embedding-fix-trg: false
[2023-06-21 00:24:10] [config] embedding-normalization: false
[2023-06-21 00:24:10] [config] embedding-vectors:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] enc-cell: gru
[2023-06-21 00:24:10] [config] enc-cell-depth: 1
[2023-06-21 00:24:10] [config] enc-depth: 1
[2023-06-21 00:24:10] [config] enc-type: bidirectional
[2023-06-21 00:24:10] [config] english-title-case-every: 0
[2023-06-21 00:24:10] [config] exponential-smoothing: 0
[2023-06-21 00:24:10] [config] factor-weight: 1
[2023-06-21 00:24:10] [config] factors-combine: sum
[2023-06-21 00:24:10] [config] factors-dim-emb: 0
[2023-06-21 00:24:10] [config] gradient-checkpointing: false
[2023-06-21 00:24:10] [config] gradient-norm-average-window: 100
[2023-06-21 00:24:10] [config] guided-alignment: none
[2023-06-21 00:24:10] [config] guided-alignment-cost: mse
[2023-06-21 00:24:10] [config] guided-alignment-weight: 0.1
[2023-06-21 00:24:10] [config] ignore-model-config: false
[2023-06-21 00:24:10] [config] input-types:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] interpolate-env-vars: false
[2023-06-21 00:24:10] [config] keep-best: false
[2023-06-21 00:24:10] [config] label-smoothing: 0
[2023-06-21 00:24:10] [config] layer-normalization: true
[2023-06-21 00:24:10] [config] learn-rate: 0.0001
[2023-06-21 00:24:10] [config] lemma-dependency: ""
[2023-06-21 00:24:10] [config] lemma-dim-emb: 0
[2023-06-21 00:24:10] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:24:10] [config] log-level: info
[2023-06-21 00:24:10] [config] log-time-zone: ""
[2023-06-21 00:24:10] [config] logical-epoch:
[2023-06-21 00:24:10] [config]   - 1e
[2023-06-21 00:24:10] [config]   - 0
[2023-06-21 00:24:10] [config] lr-decay: 0
[2023-06-21 00:24:10] [config] lr-decay-freq: 50000
[2023-06-21 00:24:10] [config] lr-decay-inv-sqrt:
[2023-06-21 00:24:10] [config]   - 0
[2023-06-21 00:24:10] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:24:10] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:24:10] [config] lr-decay-start:
[2023-06-21 00:24:10] [config]   - 10
[2023-06-21 00:24:10] [config]   - 1
[2023-06-21 00:24:10] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:24:10] [config] lr-report: false
[2023-06-21 00:24:10] [config] lr-warmup: 0
[2023-06-21 00:24:10] [config] lr-warmup-at-reload: false
[2023-06-21 00:24:10] [config] lr-warmup-cycle: false
[2023-06-21 00:24:10] [config] lr-warmup-start-rate: 0
[2023-06-21 00:24:10] [config] max-length: 50
[2023-06-21 00:24:10] [config] max-length-crop: false
[2023-06-21 00:24:10] [config] max-length-factor: 3
[2023-06-21 00:24:10] [config] maxi-batch: 100
[2023-06-21 00:24:10] [config] maxi-batch-sort: trg
[2023-06-21 00:24:10] [config] mini-batch: 64
[2023-06-21 00:24:10] [config] mini-batch-fit: true
[2023-06-21 00:24:10] [config] mini-batch-fit-step: 10
[2023-06-21 00:24:10] [config] mini-batch-round-up: true
[2023-06-21 00:24:10] [config] mini-batch-track-lr: false
[2023-06-21 00:24:10] [config] mini-batch-warmup: 0
[2023-06-21 00:24:10] [config] mini-batch-words: 0
[2023-06-21 00:24:10] [config] mini-batch-words-ref: 0
[2023-06-21 00:24:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:24:10] [config] multi-loss-type: sum
[2023-06-21 00:24:10] [config] n-best: false
[2023-06-21 00:24:10] [config] no-nccl: false
[2023-06-21 00:24:10] [config] no-reload: false
[2023-06-21 00:24:10] [config] no-restore-corpus: false
[2023-06-21 00:24:10] [config] normalize: 0
[2023-06-21 00:24:10] [config] normalize-gradient: false
[2023-06-21 00:24:10] [config] num-devices: 0
[2023-06-21 00:24:10] [config] optimizer: adam
[2023-06-21 00:24:10] [config] optimizer-delay: 1
[2023-06-21 00:24:10] [config] optimizer-params:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] output-omit-bias: false
[2023-06-21 00:24:10] [config] overwrite: false
[2023-06-21 00:24:10] [config] precision:
[2023-06-21 00:24:10] [config]   - float32
[2023-06-21 00:24:10] [config]   - float32
[2023-06-21 00:24:10] [config] pretrained-model: ""
[2023-06-21 00:24:10] [config] quantize-biases: false
[2023-06-21 00:24:10] [config] quantize-bits: 0
[2023-06-21 00:24:10] [config] quantize-log-based: false
[2023-06-21 00:24:10] [config] quantize-optimization-steps: 0
[2023-06-21 00:24:10] [config] quiet: false
[2023-06-21 00:24:10] [config] quiet-translation: true
[2023-06-21 00:24:10] [config] relative-paths: false
[2023-06-21 00:24:10] [config] right-left: false
[2023-06-21 00:24:10] [config] save-freq: 10000u
[2023-06-21 00:24:10] [config] seed: 1234
[2023-06-21 00:24:10] [config] sentencepiece-alphas:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:24:10] [config] sentencepiece-options: ""
[2023-06-21 00:24:10] [config] sharding: global
[2023-06-21 00:24:10] [config] shuffle: data
[2023-06-21 00:24:10] [config] shuffle-in-ram: false
[2023-06-21 00:24:10] [config] sigterm: save-and-exit
[2023-06-21 00:24:10] [config] skip: false
[2023-06-21 00:24:10] [config] sqlite: ""
[2023-06-21 00:24:10] [config] sqlite-drop: false
[2023-06-21 00:24:10] [config] sync-freq: 200u
[2023-06-21 00:24:10] [config] sync-sgd: false
[2023-06-21 00:24:10] [config] tempdir: /tmp
[2023-06-21 00:24:10] [config] tied-embeddings: false
[2023-06-21 00:24:10] [config] tied-embeddings-all: false
[2023-06-21 00:24:10] [config] tied-embeddings-src: false
[2023-06-21 00:24:10] [config] train-embedder-rank:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] train-sets:
[2023-06-21 00:24:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:24:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:24:10] [config] transformer-aan-activation: swish
[2023-06-21 00:24:10] [config] transformer-aan-depth: 2
[2023-06-21 00:24:10] [config] transformer-aan-nogate: false
[2023-06-21 00:24:10] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:24:10] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:24:10] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:24:10] [config] transformer-depth-scaling: false
[2023-06-21 00:24:10] [config] transformer-dim-aan: 2048
[2023-06-21 00:24:10] [config] transformer-dim-ffn: 2048
[2023-06-21 00:24:10] [config] transformer-dropout: 0
[2023-06-21 00:24:10] [config] transformer-dropout-attention: 0
[2023-06-21 00:24:10] [config] transformer-dropout-ffn: 0
[2023-06-21 00:24:10] [config] transformer-ffn-activation: swish
[2023-06-21 00:24:10] [config] transformer-ffn-depth: 2
[2023-06-21 00:24:10] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:24:10] [config] transformer-heads: 8
[2023-06-21 00:24:10] [config] transformer-no-projection: false
[2023-06-21 00:24:10] [config] transformer-pool: false
[2023-06-21 00:24:10] [config] transformer-postprocess: dan
[2023-06-21 00:24:10] [config] transformer-postprocess-emb: d
[2023-06-21 00:24:10] [config] transformer-postprocess-top: ""
[2023-06-21 00:24:10] [config] transformer-preprocess: ""
[2023-06-21 00:24:10] [config] transformer-tied-layers:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] transformer-train-position-embeddings: false
[2023-06-21 00:24:10] [config] tsv: false
[2023-06-21 00:24:10] [config] tsv-fields: 0
[2023-06-21 00:24:10] [config] type: amun
[2023-06-21 00:24:10] [config] ulr: false
[2023-06-21 00:24:10] [config] ulr-dim-emb: 0
[2023-06-21 00:24:10] [config] ulr-dropout: 0
[2023-06-21 00:24:10] [config] ulr-keys-vectors: ""
[2023-06-21 00:24:10] [config] ulr-query-vectors: ""
[2023-06-21 00:24:10] [config] ulr-softmax-temperature: 1
[2023-06-21 00:24:10] [config] ulr-trainable-transformation: false
[2023-06-21 00:24:10] [config] unlikelihood-loss: false
[2023-06-21 00:24:10] [config] valid-freq: 5000000
[2023-06-21 00:24:10] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:24:10] [config] valid-max-length: 1000
[2023-06-21 00:24:10] [config] valid-metrics:
[2023-06-21 00:24:10] [config]   - cross-entropy
[2023-06-21 00:24:10] [config] valid-mini-batch: 32
[2023-06-21 00:24:10] [config] valid-reset-stalled: false
[2023-06-21 00:24:10] [config] valid-script-args:
[2023-06-21 00:24:10] [config]   []
[2023-06-21 00:24:10] [config] valid-script-path: ""
[2023-06-21 00:24:10] [config] valid-sets:
[2023-06-21 00:24:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:24:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:24:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:24:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:24:10] [config] vocabs:
[2023-06-21 00:24:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:24:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:24:10] [config] word-penalty: 0
[2023-06-21 00:24:10] [config] word-scores: false
[2023-06-21 00:24:10] [config] workspace: 3000
[2023-06-21 00:24:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:24:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:24:10] [training] Using single-device training
[2023-06-21 00:24:10] Synced seed 1234
[2023-06-21 00:24:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:24:10] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:24:10] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:24:10] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:24:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:24:10] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:24:11] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:24:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:24:11] [comm] Using global sharding
[2023-06-21 00:24:12] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:24:12] [training] Using 1 GPUs
[2023-06-21 00:24:12] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:24:12] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:24:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:24:12] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:24:26] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:24:26] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:24:26] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:24:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:24:26] [comm] Using global sharding
[2023-06-21 00:24:26] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:24:26] [training] Using 1 GPUs
[2023-06-21 00:24:26] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:24:27] Loading Adam parameters
[2023-06-21 00:24:28] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:24:28] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:24:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:24:28] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:24:28] [data] Shuffling data
[2023-06-21 00:24:28] [data] Done reading 20,192 sentences
[2023-06-21 00:24:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:24:28] Training started
[2023-06-21 00:24:28] Training finished
[2023-06-21 00:28:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:28:48] [marian] Running on node17.datos.cluster.uy as process 648 with command line:
[2023-06-21 00:28:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 200 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-21 00:28:48] [config] after: 0e
[2023-06-21 00:28:48] [config] after-batches: 0
[2023-06-21 00:28:48] [config] after-epochs: 200
[2023-06-21 00:28:48] [config] all-caps-every: 0
[2023-06-21 00:28:48] [config] allow-unk: false
[2023-06-21 00:28:48] [config] authors: false
[2023-06-21 00:28:48] [config] beam-size: 12
[2023-06-21 00:28:48] [config] bert-class-symbol: "[CLS]"
[2023-06-21 00:28:48] [config] bert-mask-symbol: "[MASK]"
[2023-06-21 00:28:48] [config] bert-masking-fraction: 0.15
[2023-06-21 00:28:48] [config] bert-sep-symbol: "[SEP]"
[2023-06-21 00:28:48] [config] bert-train-type-embeddings: true
[2023-06-21 00:28:48] [config] bert-type-vocab-size: 2
[2023-06-21 00:28:48] [config] build-info: ""
[2023-06-21 00:28:48] [config] check-gradient-nan: false
[2023-06-21 00:28:48] [config] check-nan: false
[2023-06-21 00:28:48] [config] cite: false
[2023-06-21 00:28:48] [config] clip-norm: 1
[2023-06-21 00:28:48] [config] cost-scaling:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] cost-type: ce-sum
[2023-06-21 00:28:48] [config] cpu-threads: 0
[2023-06-21 00:28:48] [config] data-threads: 8
[2023-06-21 00:28:48] [config] data-weighting: ""
[2023-06-21 00:28:48] [config] data-weighting-type: sentence
[2023-06-21 00:28:48] [config] dec-cell: gru
[2023-06-21 00:28:48] [config] dec-cell-base-depth: 2
[2023-06-21 00:28:48] [config] dec-cell-high-depth: 1
[2023-06-21 00:28:48] [config] dec-depth: 1
[2023-06-21 00:28:48] [config] devices:
[2023-06-21 00:28:48] [config]   - 0
[2023-06-21 00:28:48] [config] dim-emb: 512
[2023-06-21 00:28:48] [config] dim-rnn: 1024
[2023-06-21 00:28:48] [config] dim-vocabs:
[2023-06-21 00:28:48] [config]   - 54042
[2023-06-21 00:28:48] [config]   - 36507
[2023-06-21 00:28:48] [config] disp-first: 0
[2023-06-21 00:28:48] [config] disp-freq: 1000u
[2023-06-21 00:28:48] [config] disp-label-counts: true
[2023-06-21 00:28:48] [config] dropout-rnn: 0.2
[2023-06-21 00:28:48] [config] dropout-src: 0.1
[2023-06-21 00:28:48] [config] dropout-trg: 0.1
[2023-06-21 00:28:48] [config] dump-config: ""
[2023-06-21 00:28:48] [config] dynamic-gradient-scaling:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] early-stopping: 5
[2023-06-21 00:28:48] [config] early-stopping-on: first
[2023-06-21 00:28:48] [config] embedding-fix-src: false
[2023-06-21 00:28:48] [config] embedding-fix-trg: false
[2023-06-21 00:28:48] [config] embedding-normalization: false
[2023-06-21 00:28:48] [config] embedding-vectors:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] enc-cell: gru
[2023-06-21 00:28:48] [config] enc-cell-depth: 1
[2023-06-21 00:28:48] [config] enc-depth: 1
[2023-06-21 00:28:48] [config] enc-type: bidirectional
[2023-06-21 00:28:48] [config] english-title-case-every: 0
[2023-06-21 00:28:48] [config] exponential-smoothing: 0
[2023-06-21 00:28:48] [config] factor-weight: 1
[2023-06-21 00:28:48] [config] factors-combine: sum
[2023-06-21 00:28:48] [config] factors-dim-emb: 0
[2023-06-21 00:28:48] [config] gradient-checkpointing: false
[2023-06-21 00:28:48] [config] gradient-norm-average-window: 100
[2023-06-21 00:28:48] [config] guided-alignment: none
[2023-06-21 00:28:48] [config] guided-alignment-cost: mse
[2023-06-21 00:28:48] [config] guided-alignment-weight: 0.1
[2023-06-21 00:28:48] [config] ignore-model-config: false
[2023-06-21 00:28:48] [config] input-types:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] interpolate-env-vars: false
[2023-06-21 00:28:48] [config] keep-best: false
[2023-06-21 00:28:48] [config] label-smoothing: 0
[2023-06-21 00:28:48] [config] layer-normalization: true
[2023-06-21 00:28:48] [config] learn-rate: 0.0001
[2023-06-21 00:28:48] [config] lemma-dependency: ""
[2023-06-21 00:28:48] [config] lemma-dim-emb: 0
[2023-06-21 00:28:48] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-21 00:28:48] [config] log-level: info
[2023-06-21 00:28:48] [config] log-time-zone: ""
[2023-06-21 00:28:48] [config] logical-epoch:
[2023-06-21 00:28:48] [config]   - 1e
[2023-06-21 00:28:48] [config]   - 0
[2023-06-21 00:28:48] [config] lr-decay: 0
[2023-06-21 00:28:48] [config] lr-decay-freq: 50000
[2023-06-21 00:28:48] [config] lr-decay-inv-sqrt:
[2023-06-21 00:28:48] [config]   - 0
[2023-06-21 00:28:48] [config] lr-decay-repeat-warmup: false
[2023-06-21 00:28:48] [config] lr-decay-reset-optimizer: false
[2023-06-21 00:28:48] [config] lr-decay-start:
[2023-06-21 00:28:48] [config]   - 10
[2023-06-21 00:28:48] [config]   - 1
[2023-06-21 00:28:48] [config] lr-decay-strategy: epoch+stalled
[2023-06-21 00:28:48] [config] lr-report: false
[2023-06-21 00:28:48] [config] lr-warmup: 0
[2023-06-21 00:28:48] [config] lr-warmup-at-reload: false
[2023-06-21 00:28:48] [config] lr-warmup-cycle: false
[2023-06-21 00:28:48] [config] lr-warmup-start-rate: 0
[2023-06-21 00:28:48] [config] max-length: 50
[2023-06-21 00:28:48] [config] max-length-crop: false
[2023-06-21 00:28:48] [config] max-length-factor: 3
[2023-06-21 00:28:48] [config] maxi-batch: 100
[2023-06-21 00:28:48] [config] maxi-batch-sort: trg
[2023-06-21 00:28:48] [config] mini-batch: 64
[2023-06-21 00:28:48] [config] mini-batch-fit: true
[2023-06-21 00:28:48] [config] mini-batch-fit-step: 10
[2023-06-21 00:28:48] [config] mini-batch-round-up: true
[2023-06-21 00:28:48] [config] mini-batch-track-lr: false
[2023-06-21 00:28:48] [config] mini-batch-warmup: 0
[2023-06-21 00:28:48] [config] mini-batch-words: 0
[2023-06-21 00:28:48] [config] mini-batch-words-ref: 0
[2023-06-21 00:28:48] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:28:48] [config] multi-loss-type: sum
[2023-06-21 00:28:48] [config] n-best: false
[2023-06-21 00:28:48] [config] no-nccl: false
[2023-06-21 00:28:48] [config] no-reload: false
[2023-06-21 00:28:48] [config] no-restore-corpus: false
[2023-06-21 00:28:48] [config] normalize: 0
[2023-06-21 00:28:48] [config] normalize-gradient: false
[2023-06-21 00:28:48] [config] num-devices: 0
[2023-06-21 00:28:48] [config] optimizer: adam
[2023-06-21 00:28:48] [config] optimizer-delay: 1
[2023-06-21 00:28:48] [config] optimizer-params:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] output-omit-bias: false
[2023-06-21 00:28:48] [config] overwrite: false
[2023-06-21 00:28:48] [config] precision:
[2023-06-21 00:28:48] [config]   - float32
[2023-06-21 00:28:48] [config]   - float32
[2023-06-21 00:28:48] [config] pretrained-model: ""
[2023-06-21 00:28:48] [config] quantize-biases: false
[2023-06-21 00:28:48] [config] quantize-bits: 0
[2023-06-21 00:28:48] [config] quantize-log-based: false
[2023-06-21 00:28:48] [config] quantize-optimization-steps: 0
[2023-06-21 00:28:48] [config] quiet: false
[2023-06-21 00:28:48] [config] quiet-translation: true
[2023-06-21 00:28:48] [config] relative-paths: false
[2023-06-21 00:28:48] [config] right-left: false
[2023-06-21 00:28:48] [config] save-freq: 10000u
[2023-06-21 00:28:48] [config] seed: 1234
[2023-06-21 00:28:48] [config] sentencepiece-alphas:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] sentencepiece-max-lines: 2000000
[2023-06-21 00:28:48] [config] sentencepiece-options: ""
[2023-06-21 00:28:48] [config] sharding: global
[2023-06-21 00:28:48] [config] shuffle: data
[2023-06-21 00:28:48] [config] shuffle-in-ram: false
[2023-06-21 00:28:48] [config] sigterm: save-and-exit
[2023-06-21 00:28:48] [config] skip: false
[2023-06-21 00:28:48] [config] sqlite: ""
[2023-06-21 00:28:48] [config] sqlite-drop: false
[2023-06-21 00:28:48] [config] sync-freq: 200u
[2023-06-21 00:28:48] [config] sync-sgd: false
[2023-06-21 00:28:48] [config] tempdir: /tmp
[2023-06-21 00:28:48] [config] tied-embeddings: false
[2023-06-21 00:28:48] [config] tied-embeddings-all: false
[2023-06-21 00:28:48] [config] tied-embeddings-src: false
[2023-06-21 00:28:48] [config] train-embedder-rank:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] train-sets:
[2023-06-21 00:28:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-21 00:28:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-21 00:28:48] [config] transformer-aan-activation: swish
[2023-06-21 00:28:48] [config] transformer-aan-depth: 2
[2023-06-21 00:28:48] [config] transformer-aan-nogate: false
[2023-06-21 00:28:48] [config] transformer-decoder-autoreg: self-attention
[2023-06-21 00:28:48] [config] transformer-decoder-dim-ffn: 0
[2023-06-21 00:28:48] [config] transformer-decoder-ffn-depth: 0
[2023-06-21 00:28:48] [config] transformer-depth-scaling: false
[2023-06-21 00:28:48] [config] transformer-dim-aan: 2048
[2023-06-21 00:28:48] [config] transformer-dim-ffn: 2048
[2023-06-21 00:28:48] [config] transformer-dropout: 0
[2023-06-21 00:28:48] [config] transformer-dropout-attention: 0
[2023-06-21 00:28:48] [config] transformer-dropout-ffn: 0
[2023-06-21 00:28:48] [config] transformer-ffn-activation: swish
[2023-06-21 00:28:48] [config] transformer-ffn-depth: 2
[2023-06-21 00:28:48] [config] transformer-guided-alignment-layer: last
[2023-06-21 00:28:48] [config] transformer-heads: 8
[2023-06-21 00:28:48] [config] transformer-no-projection: false
[2023-06-21 00:28:48] [config] transformer-pool: false
[2023-06-21 00:28:48] [config] transformer-postprocess: dan
[2023-06-21 00:28:48] [config] transformer-postprocess-emb: d
[2023-06-21 00:28:48] [config] transformer-postprocess-top: ""
[2023-06-21 00:28:48] [config] transformer-preprocess: ""
[2023-06-21 00:28:48] [config] transformer-tied-layers:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] transformer-train-position-embeddings: false
[2023-06-21 00:28:48] [config] tsv: false
[2023-06-21 00:28:48] [config] tsv-fields: 0
[2023-06-21 00:28:48] [config] type: amun
[2023-06-21 00:28:48] [config] ulr: false
[2023-06-21 00:28:48] [config] ulr-dim-emb: 0
[2023-06-21 00:28:48] [config] ulr-dropout: 0
[2023-06-21 00:28:48] [config] ulr-keys-vectors: ""
[2023-06-21 00:28:48] [config] ulr-query-vectors: ""
[2023-06-21 00:28:48] [config] ulr-softmax-temperature: 1
[2023-06-21 00:28:48] [config] ulr-trainable-transformation: false
[2023-06-21 00:28:48] [config] unlikelihood-loss: false
[2023-06-21 00:28:48] [config] valid-freq: 5000000
[2023-06-21 00:28:48] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-21 00:28:48] [config] valid-max-length: 1000
[2023-06-21 00:28:48] [config] valid-metrics:
[2023-06-21 00:28:48] [config]   - cross-entropy
[2023-06-21 00:28:48] [config] valid-mini-batch: 32
[2023-06-21 00:28:48] [config] valid-reset-stalled: false
[2023-06-21 00:28:48] [config] valid-script-args:
[2023-06-21 00:28:48] [config]   []
[2023-06-21 00:28:48] [config] valid-script-path: ""
[2023-06-21 00:28:48] [config] valid-sets:
[2023-06-21 00:28:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-21 00:28:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-21 00:28:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-21 00:28:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:28:48] [config] vocabs:
[2023-06-21 00:28:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:28:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:28:48] [config] word-penalty: 0
[2023-06-21 00:28:48] [config] word-scores: false
[2023-06-21 00:28:48] [config] workspace: 3000
[2023-06-21 00:28:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-21 00:28:48] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:28:48] [training] Using single-device training
[2023-06-21 00:28:48] Synced seed 1234
[2023-06-21 00:28:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-21 00:28:48] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-21 00:28:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-21 00:28:49] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-21 00:28:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-21 00:28:49] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:28:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:28:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:28:50] [comm] Using global sharding
[2023-06-21 00:28:51] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:28:51] [training] Using 1 GPUs
[2023-06-21 00:28:51] [logits] Applying loss function for 1 factor(s)
[2023-06-21 00:28:51] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:28:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-21 00:28:51] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:29:04] [batching] Done. Typical MB size is 4,814 target words
[2023-06-21 00:29:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-21 00:29:04] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-21 00:29:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-21 00:29:04] [comm] Using global sharding
[2023-06-21 00:29:04] [comm] NCCLCommunicators constructed successfully
[2023-06-21 00:29:04] [training] Using 1 GPUs
[2023-06-21 00:29:04] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-21 00:29:06] Loading Adam parameters
[2023-06-21 00:29:06] [memory] Reserving 754 MB, device gpu0
[2023-06-21 00:29:06] [memory] Reserving 377 MB, device gpu0
[2023-06-21 00:29:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-21 00:29:06] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-21 00:29:06] [data] Shuffling data
[2023-06-21 00:29:06] [data] Done reading 20,192 sentences
[2023-06-21 00:29:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-21 00:29:06] Training started
[2023-06-21 00:29:06] Training finished
[2023-06-23 08:48:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 08:48:30] [marian] Running on node07.datos.cluster.uy as process 39111 with command line:
[2023-06-23 08:48:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 200 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-23 08:48:30] [config] after: 0e
[2023-06-23 08:48:30] [config] after-batches: 0
[2023-06-23 08:48:30] [config] after-epochs: 200
[2023-06-23 08:48:30] [config] all-caps-every: 0
[2023-06-23 08:48:30] [config] allow-unk: false
[2023-06-23 08:48:30] [config] authors: false
[2023-06-23 08:48:30] [config] beam-size: 12
[2023-06-23 08:48:30] [config] bert-class-symbol: "[CLS]"
[2023-06-23 08:48:30] [config] bert-mask-symbol: "[MASK]"
[2023-06-23 08:48:30] [config] bert-masking-fraction: 0.15
[2023-06-23 08:48:30] [config] bert-sep-symbol: "[SEP]"
[2023-06-23 08:48:30] [config] bert-train-type-embeddings: true
[2023-06-23 08:48:30] [config] bert-type-vocab-size: 2
[2023-06-23 08:48:30] [config] build-info: ""
[2023-06-23 08:48:30] [config] check-gradient-nan: false
[2023-06-23 08:48:30] [config] check-nan: false
[2023-06-23 08:48:30] [config] cite: false
[2023-06-23 08:48:30] [config] clip-norm: 1
[2023-06-23 08:48:30] [config] cost-scaling:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] cost-type: ce-sum
[2023-06-23 08:48:30] [config] cpu-threads: 0
[2023-06-23 08:48:30] [config] data-threads: 8
[2023-06-23 08:48:30] [config] data-weighting: ""
[2023-06-23 08:48:30] [config] data-weighting-type: sentence
[2023-06-23 08:48:30] [config] dec-cell: gru
[2023-06-23 08:48:30] [config] dec-cell-base-depth: 2
[2023-06-23 08:48:30] [config] dec-cell-high-depth: 1
[2023-06-23 08:48:30] [config] dec-depth: 1
[2023-06-23 08:48:30] [config] devices:
[2023-06-23 08:48:30] [config]   - 0
[2023-06-23 08:48:30] [config] dim-emb: 512
[2023-06-23 08:48:30] [config] dim-rnn: 1024
[2023-06-23 08:48:30] [config] dim-vocabs:
[2023-06-23 08:48:30] [config]   - 54042
[2023-06-23 08:48:30] [config]   - 36507
[2023-06-23 08:48:30] [config] disp-first: 0
[2023-06-23 08:48:30] [config] disp-freq: 1000u
[2023-06-23 08:48:30] [config] disp-label-counts: true
[2023-06-23 08:48:30] [config] dropout-rnn: 0.2
[2023-06-23 08:48:30] [config] dropout-src: 0.1
[2023-06-23 08:48:30] [config] dropout-trg: 0.1
[2023-06-23 08:48:30] [config] dump-config: ""
[2023-06-23 08:48:30] [config] dynamic-gradient-scaling:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] early-stopping: 5
[2023-06-23 08:48:30] [config] early-stopping-on: first
[2023-06-23 08:48:30] [config] embedding-fix-src: false
[2023-06-23 08:48:30] [config] embedding-fix-trg: false
[2023-06-23 08:48:30] [config] embedding-normalization: false
[2023-06-23 08:48:30] [config] embedding-vectors:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] enc-cell: gru
[2023-06-23 08:48:30] [config] enc-cell-depth: 1
[2023-06-23 08:48:30] [config] enc-depth: 1
[2023-06-23 08:48:30] [config] enc-type: bidirectional
[2023-06-23 08:48:30] [config] english-title-case-every: 0
[2023-06-23 08:48:30] [config] exponential-smoothing: 0
[2023-06-23 08:48:30] [config] factor-weight: 1
[2023-06-23 08:48:30] [config] factors-combine: sum
[2023-06-23 08:48:30] [config] factors-dim-emb: 0
[2023-06-23 08:48:30] [config] gradient-checkpointing: false
[2023-06-23 08:48:30] [config] gradient-norm-average-window: 100
[2023-06-23 08:48:30] [config] guided-alignment: none
[2023-06-23 08:48:30] [config] guided-alignment-cost: mse
[2023-06-23 08:48:30] [config] guided-alignment-weight: 0.1
[2023-06-23 08:48:30] [config] ignore-model-config: false
[2023-06-23 08:48:30] [config] input-types:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] interpolate-env-vars: false
[2023-06-23 08:48:30] [config] keep-best: false
[2023-06-23 08:48:30] [config] label-smoothing: 0
[2023-06-23 08:48:30] [config] layer-normalization: true
[2023-06-23 08:48:30] [config] learn-rate: 0.0001
[2023-06-23 08:48:30] [config] lemma-dependency: ""
[2023-06-23 08:48:30] [config] lemma-dim-emb: 0
[2023-06-23 08:48:30] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-23 08:48:30] [config] log-level: info
[2023-06-23 08:48:30] [config] log-time-zone: ""
[2023-06-23 08:48:30] [config] logical-epoch:
[2023-06-23 08:48:30] [config]   - 1e
[2023-06-23 08:48:30] [config]   - 0
[2023-06-23 08:48:30] [config] lr-decay: 0
[2023-06-23 08:48:30] [config] lr-decay-freq: 50000
[2023-06-23 08:48:30] [config] lr-decay-inv-sqrt:
[2023-06-23 08:48:30] [config]   - 0
[2023-06-23 08:48:30] [config] lr-decay-repeat-warmup: false
[2023-06-23 08:48:30] [config] lr-decay-reset-optimizer: false
[2023-06-23 08:48:30] [config] lr-decay-start:
[2023-06-23 08:48:30] [config]   - 10
[2023-06-23 08:48:30] [config]   - 1
[2023-06-23 08:48:30] [config] lr-decay-strategy: epoch+stalled
[2023-06-23 08:48:30] [config] lr-report: false
[2023-06-23 08:48:30] [config] lr-warmup: 0
[2023-06-23 08:48:30] [config] lr-warmup-at-reload: false
[2023-06-23 08:48:30] [config] lr-warmup-cycle: false
[2023-06-23 08:48:30] [config] lr-warmup-start-rate: 0
[2023-06-23 08:48:30] [config] max-length: 50
[2023-06-23 08:48:30] [config] max-length-crop: false
[2023-06-23 08:48:30] [config] max-length-factor: 3
[2023-06-23 08:48:30] [config] maxi-batch: 100
[2023-06-23 08:48:30] [config] maxi-batch-sort: trg
[2023-06-23 08:48:30] [config] mini-batch: 64
[2023-06-23 08:48:30] [config] mini-batch-fit: true
[2023-06-23 08:48:30] [config] mini-batch-fit-step: 10
[2023-06-23 08:48:30] [config] mini-batch-round-up: true
[2023-06-23 08:48:30] [config] mini-batch-track-lr: false
[2023-06-23 08:48:30] [config] mini-batch-warmup: 0
[2023-06-23 08:48:30] [config] mini-batch-words: 0
[2023-06-23 08:48:30] [config] mini-batch-words-ref: 0
[2023-06-23 08:48:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 08:48:30] [config] multi-loss-type: sum
[2023-06-23 08:48:30] [config] n-best: false
[2023-06-23 08:48:30] [config] no-nccl: false
[2023-06-23 08:48:30] [config] no-reload: false
[2023-06-23 08:48:30] [config] no-restore-corpus: false
[2023-06-23 08:48:30] [config] normalize: 0
[2023-06-23 08:48:30] [config] normalize-gradient: false
[2023-06-23 08:48:30] [config] num-devices: 0
[2023-06-23 08:48:30] [config] optimizer: adam
[2023-06-23 08:48:30] [config] optimizer-delay: 1
[2023-06-23 08:48:30] [config] optimizer-params:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] output-omit-bias: false
[2023-06-23 08:48:30] [config] overwrite: false
[2023-06-23 08:48:30] [config] precision:
[2023-06-23 08:48:30] [config]   - float32
[2023-06-23 08:48:30] [config]   - float32
[2023-06-23 08:48:30] [config] pretrained-model: ""
[2023-06-23 08:48:30] [config] quantize-biases: false
[2023-06-23 08:48:30] [config] quantize-bits: 0
[2023-06-23 08:48:30] [config] quantize-log-based: false
[2023-06-23 08:48:30] [config] quantize-optimization-steps: 0
[2023-06-23 08:48:30] [config] quiet: false
[2023-06-23 08:48:30] [config] quiet-translation: true
[2023-06-23 08:48:30] [config] relative-paths: false
[2023-06-23 08:48:30] [config] right-left: false
[2023-06-23 08:48:30] [config] save-freq: 10000u
[2023-06-23 08:48:30] [config] seed: 1234
[2023-06-23 08:48:30] [config] sentencepiece-alphas:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] sentencepiece-max-lines: 2000000
[2023-06-23 08:48:30] [config] sentencepiece-options: ""
[2023-06-23 08:48:30] [config] sharding: global
[2023-06-23 08:48:30] [config] shuffle: data
[2023-06-23 08:48:30] [config] shuffle-in-ram: false
[2023-06-23 08:48:30] [config] sigterm: save-and-exit
[2023-06-23 08:48:30] [config] skip: false
[2023-06-23 08:48:30] [config] sqlite: ""
[2023-06-23 08:48:30] [config] sqlite-drop: false
[2023-06-23 08:48:30] [config] sync-freq: 200u
[2023-06-23 08:48:30] [config] sync-sgd: false
[2023-06-23 08:48:30] [config] tempdir: /tmp
[2023-06-23 08:48:30] [config] tied-embeddings: false
[2023-06-23 08:48:30] [config] tied-embeddings-all: false
[2023-06-23 08:48:30] [config] tied-embeddings-src: false
[2023-06-23 08:48:30] [config] train-embedder-rank:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] train-sets:
[2023-06-23 08:48:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-23 08:48:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-23 08:48:30] [config] transformer-aan-activation: swish
[2023-06-23 08:48:30] [config] transformer-aan-depth: 2
[2023-06-23 08:48:30] [config] transformer-aan-nogate: false
[2023-06-23 08:48:30] [config] transformer-decoder-autoreg: self-attention
[2023-06-23 08:48:30] [config] transformer-decoder-dim-ffn: 0
[2023-06-23 08:48:30] [config] transformer-decoder-ffn-depth: 0
[2023-06-23 08:48:30] [config] transformer-depth-scaling: false
[2023-06-23 08:48:30] [config] transformer-dim-aan: 2048
[2023-06-23 08:48:30] [config] transformer-dim-ffn: 2048
[2023-06-23 08:48:30] [config] transformer-dropout: 0
[2023-06-23 08:48:30] [config] transformer-dropout-attention: 0
[2023-06-23 08:48:30] [config] transformer-dropout-ffn: 0
[2023-06-23 08:48:30] [config] transformer-ffn-activation: swish
[2023-06-23 08:48:30] [config] transformer-ffn-depth: 2
[2023-06-23 08:48:30] [config] transformer-guided-alignment-layer: last
[2023-06-23 08:48:30] [config] transformer-heads: 8
[2023-06-23 08:48:30] [config] transformer-no-projection: false
[2023-06-23 08:48:30] [config] transformer-pool: false
[2023-06-23 08:48:30] [config] transformer-postprocess: dan
[2023-06-23 08:48:30] [config] transformer-postprocess-emb: d
[2023-06-23 08:48:30] [config] transformer-postprocess-top: ""
[2023-06-23 08:48:30] [config] transformer-preprocess: ""
[2023-06-23 08:48:30] [config] transformer-tied-layers:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] transformer-train-position-embeddings: false
[2023-06-23 08:48:30] [config] tsv: false
[2023-06-23 08:48:30] [config] tsv-fields: 0
[2023-06-23 08:48:30] [config] type: amun
[2023-06-23 08:48:30] [config] ulr: false
[2023-06-23 08:48:30] [config] ulr-dim-emb: 0
[2023-06-23 08:48:30] [config] ulr-dropout: 0
[2023-06-23 08:48:30] [config] ulr-keys-vectors: ""
[2023-06-23 08:48:30] [config] ulr-query-vectors: ""
[2023-06-23 08:48:30] [config] ulr-softmax-temperature: 1
[2023-06-23 08:48:30] [config] ulr-trainable-transformation: false
[2023-06-23 08:48:30] [config] unlikelihood-loss: false
[2023-06-23 08:48:30] [config] valid-freq: 5000000
[2023-06-23 08:48:30] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-23 08:48:30] [config] valid-max-length: 1000
[2023-06-23 08:48:30] [config] valid-metrics:
[2023-06-23 08:48:30] [config]   - cross-entropy
[2023-06-23 08:48:30] [config]   - translation
[2023-06-23 08:48:30] [config] valid-mini-batch: 32
[2023-06-23 08:48:30] [config] valid-reset-stalled: false
[2023-06-23 08:48:30] [config] valid-script-args:
[2023-06-23 08:48:30] [config]   []
[2023-06-23 08:48:30] [config] valid-script-path: ""
[2023-06-23 08:48:30] [config] valid-sets:
[2023-06-23 08:48:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-23 08:48:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-23 08:48:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-23 08:48:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 08:48:30] [config] vocabs:
[2023-06-23 08:48:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 08:48:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 08:48:30] [config] word-penalty: 0
[2023-06-23 08:48:30] [config] word-scores: false
[2023-06-23 08:48:30] [config] workspace: 3000
[2023-06-23 08:48:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 08:48:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 08:48:30] [training] Using single-device training
[2023-06-23 08:48:31] Synced seed 1234
[2023-06-23 08:48:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 08:48:31] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-23 08:48:31] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 08:48:31] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-23 08:48:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-23 08:48:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 08:48:33] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 08:48:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 08:48:34] [comm] Using global sharding
[2023-06-23 08:48:34] [comm] NCCLCommunicators constructed successfully
[2023-06-23 08:48:34] [training] Using 1 GPUs
[2023-06-23 08:48:34] [logits] Applying loss function for 1 factor(s)
[2023-06-23 08:48:34] [memory] Reserving 377 MB, device gpu0
[2023-06-23 08:48:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-23 08:48:37] [memory] Reserving 377 MB, device gpu0
[2023-06-23 08:48:48] [batching] Done. Typical MB size is 4,814 target words
[2023-06-23 08:48:48] [valid] No post-processing script given for validating translator
[2023-06-23 08:48:49] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 08:48:49] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 08:48:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 08:48:49] [comm] Using global sharding
[2023-06-23 08:48:49] [comm] NCCLCommunicators constructed successfully
[2023-06-23 08:48:49] [training] Using 1 GPUs
[2023-06-23 08:48:49] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 08:49:04] Loading Adam parameters
[2023-06-23 08:49:05] [memory] Reserving 754 MB, device gpu0
[2023-06-23 08:49:05] [memory] Reserving 377 MB, device gpu0
[2023-06-23 08:49:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-23 08:49:05] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-23 08:49:05] [data] Shuffling data
[2023-06-23 08:49:05] [data] Done reading 20,192 sentences
[2023-06-23 08:49:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-23 08:49:05] Training started
[2023-06-23 08:49:05] Training finished
[2023-06-23 08:55:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 08:55:56] [marian] Running on node07.datos.cluster.uy as process 39753 with command line:
[2023-06-23 08:55:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 200 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-23 08:55:56] [config] after: 0e
[2023-06-23 08:55:56] [config] after-batches: 0
[2023-06-23 08:55:56] [config] after-epochs: 200
[2023-06-23 08:55:56] [config] all-caps-every: 0
[2023-06-23 08:55:56] [config] allow-unk: false
[2023-06-23 08:55:56] [config] authors: false
[2023-06-23 08:55:56] [config] beam-size: 12
[2023-06-23 08:55:56] [config] bert-class-symbol: "[CLS]"
[2023-06-23 08:55:56] [config] bert-mask-symbol: "[MASK]"
[2023-06-23 08:55:56] [config] bert-masking-fraction: 0.15
[2023-06-23 08:55:56] [config] bert-sep-symbol: "[SEP]"
[2023-06-23 08:55:56] [config] bert-train-type-embeddings: true
[2023-06-23 08:55:56] [config] bert-type-vocab-size: 2
[2023-06-23 08:55:56] [config] build-info: ""
[2023-06-23 08:55:56] [config] check-gradient-nan: false
[2023-06-23 08:55:56] [config] check-nan: false
[2023-06-23 08:55:56] [config] cite: false
[2023-06-23 08:55:56] [config] clip-norm: 1
[2023-06-23 08:55:56] [config] cost-scaling:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] cost-type: ce-sum
[2023-06-23 08:55:56] [config] cpu-threads: 0
[2023-06-23 08:55:56] [config] data-threads: 8
[2023-06-23 08:55:56] [config] data-weighting: ""
[2023-06-23 08:55:56] [config] data-weighting-type: sentence
[2023-06-23 08:55:56] [config] dec-cell: gru
[2023-06-23 08:55:56] [config] dec-cell-base-depth: 2
[2023-06-23 08:55:56] [config] dec-cell-high-depth: 1
[2023-06-23 08:55:56] [config] dec-depth: 1
[2023-06-23 08:55:56] [config] devices:
[2023-06-23 08:55:56] [config]   - 0
[2023-06-23 08:55:56] [config] dim-emb: 512
[2023-06-23 08:55:56] [config] dim-rnn: 1024
[2023-06-23 08:55:56] [config] dim-vocabs:
[2023-06-23 08:55:56] [config]   - 54042
[2023-06-23 08:55:56] [config]   - 36507
[2023-06-23 08:55:56] [config] disp-first: 0
[2023-06-23 08:55:56] [config] disp-freq: 1000u
[2023-06-23 08:55:56] [config] disp-label-counts: true
[2023-06-23 08:55:56] [config] dropout-rnn: 0.2
[2023-06-23 08:55:56] [config] dropout-src: 0.1
[2023-06-23 08:55:56] [config] dropout-trg: 0.1
[2023-06-23 08:55:56] [config] dump-config: ""
[2023-06-23 08:55:56] [config] dynamic-gradient-scaling:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] early-stopping: 5
[2023-06-23 08:55:56] [config] early-stopping-on: first
[2023-06-23 08:55:56] [config] embedding-fix-src: false
[2023-06-23 08:55:56] [config] embedding-fix-trg: false
[2023-06-23 08:55:56] [config] embedding-normalization: false
[2023-06-23 08:55:56] [config] embedding-vectors:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] enc-cell: gru
[2023-06-23 08:55:56] [config] enc-cell-depth: 1
[2023-06-23 08:55:56] [config] enc-depth: 1
[2023-06-23 08:55:56] [config] enc-type: bidirectional
[2023-06-23 08:55:56] [config] english-title-case-every: 0
[2023-06-23 08:55:56] [config] exponential-smoothing: 0
[2023-06-23 08:55:56] [config] factor-weight: 1
[2023-06-23 08:55:56] [config] factors-combine: sum
[2023-06-23 08:55:56] [config] factors-dim-emb: 0
[2023-06-23 08:55:56] [config] gradient-checkpointing: false
[2023-06-23 08:55:56] [config] gradient-norm-average-window: 100
[2023-06-23 08:55:56] [config] guided-alignment: none
[2023-06-23 08:55:56] [config] guided-alignment-cost: mse
[2023-06-23 08:55:56] [config] guided-alignment-weight: 0.1
[2023-06-23 08:55:56] [config] ignore-model-config: false
[2023-06-23 08:55:56] [config] input-types:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] interpolate-env-vars: false
[2023-06-23 08:55:56] [config] keep-best: false
[2023-06-23 08:55:56] [config] label-smoothing: 0
[2023-06-23 08:55:56] [config] layer-normalization: true
[2023-06-23 08:55:56] [config] learn-rate: 0.0001
[2023-06-23 08:55:56] [config] lemma-dependency: ""
[2023-06-23 08:55:56] [config] lemma-dim-emb: 0
[2023-06-23 08:55:56] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-23 08:55:56] [config] log-level: info
[2023-06-23 08:55:56] [config] log-time-zone: ""
[2023-06-23 08:55:56] [config] logical-epoch:
[2023-06-23 08:55:56] [config]   - 1e
[2023-06-23 08:55:56] [config]   - 0
[2023-06-23 08:55:56] [config] lr-decay: 0
[2023-06-23 08:55:56] [config] lr-decay-freq: 50000
[2023-06-23 08:55:56] [config] lr-decay-inv-sqrt:
[2023-06-23 08:55:56] [config]   - 0
[2023-06-23 08:55:56] [config] lr-decay-repeat-warmup: false
[2023-06-23 08:55:56] [config] lr-decay-reset-optimizer: false
[2023-06-23 08:55:56] [config] lr-decay-start:
[2023-06-23 08:55:56] [config]   - 10
[2023-06-23 08:55:56] [config]   - 1
[2023-06-23 08:55:56] [config] lr-decay-strategy: epoch+stalled
[2023-06-23 08:55:56] [config] lr-report: false
[2023-06-23 08:55:56] [config] lr-warmup: 0
[2023-06-23 08:55:56] [config] lr-warmup-at-reload: false
[2023-06-23 08:55:56] [config] lr-warmup-cycle: false
[2023-06-23 08:55:56] [config] lr-warmup-start-rate: 0
[2023-06-23 08:55:56] [config] max-length: 50
[2023-06-23 08:55:56] [config] max-length-crop: false
[2023-06-23 08:55:56] [config] max-length-factor: 3
[2023-06-23 08:55:56] [config] maxi-batch: 100
[2023-06-23 08:55:56] [config] maxi-batch-sort: trg
[2023-06-23 08:55:56] [config] mini-batch: 64
[2023-06-23 08:55:56] [config] mini-batch-fit: true
[2023-06-23 08:55:56] [config] mini-batch-fit-step: 10
[2023-06-23 08:55:56] [config] mini-batch-round-up: true
[2023-06-23 08:55:56] [config] mini-batch-track-lr: false
[2023-06-23 08:55:56] [config] mini-batch-warmup: 0
[2023-06-23 08:55:56] [config] mini-batch-words: 0
[2023-06-23 08:55:56] [config] mini-batch-words-ref: 0
[2023-06-23 08:55:56] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 08:55:56] [config] multi-loss-type: sum
[2023-06-23 08:55:56] [config] n-best: false
[2023-06-23 08:55:56] [config] no-nccl: false
[2023-06-23 08:55:56] [config] no-reload: false
[2023-06-23 08:55:56] [config] no-restore-corpus: false
[2023-06-23 08:55:56] [config] normalize: 0
[2023-06-23 08:55:56] [config] normalize-gradient: false
[2023-06-23 08:55:56] [config] num-devices: 0
[2023-06-23 08:55:56] [config] optimizer: adam
[2023-06-23 08:55:56] [config] optimizer-delay: 1
[2023-06-23 08:55:56] [config] optimizer-params:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] output-omit-bias: false
[2023-06-23 08:55:56] [config] overwrite: false
[2023-06-23 08:55:56] [config] precision:
[2023-06-23 08:55:56] [config]   - float32
[2023-06-23 08:55:56] [config]   - float32
[2023-06-23 08:55:56] [config] pretrained-model: ""
[2023-06-23 08:55:56] [config] quantize-biases: false
[2023-06-23 08:55:56] [config] quantize-bits: 0
[2023-06-23 08:55:56] [config] quantize-log-based: false
[2023-06-23 08:55:56] [config] quantize-optimization-steps: 0
[2023-06-23 08:55:56] [config] quiet: false
[2023-06-23 08:55:56] [config] quiet-translation: true
[2023-06-23 08:55:56] [config] relative-paths: false
[2023-06-23 08:55:56] [config] right-left: false
[2023-06-23 08:55:56] [config] save-freq: 10000u
[2023-06-23 08:55:56] [config] seed: 1234
[2023-06-23 08:55:56] [config] sentencepiece-alphas:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] sentencepiece-max-lines: 2000000
[2023-06-23 08:55:56] [config] sentencepiece-options: ""
[2023-06-23 08:55:56] [config] sharding: global
[2023-06-23 08:55:56] [config] shuffle: data
[2023-06-23 08:55:56] [config] shuffle-in-ram: false
[2023-06-23 08:55:56] [config] sigterm: save-and-exit
[2023-06-23 08:55:56] [config] skip: false
[2023-06-23 08:55:56] [config] sqlite: ""
[2023-06-23 08:55:56] [config] sqlite-drop: false
[2023-06-23 08:55:56] [config] sync-freq: 200u
[2023-06-23 08:55:56] [config] sync-sgd: false
[2023-06-23 08:55:56] [config] tempdir: /tmp
[2023-06-23 08:55:56] [config] tied-embeddings: false
[2023-06-23 08:55:56] [config] tied-embeddings-all: false
[2023-06-23 08:55:56] [config] tied-embeddings-src: false
[2023-06-23 08:55:56] [config] train-embedder-rank:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] train-sets:
[2023-06-23 08:55:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-23 08:55:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-23 08:55:56] [config] transformer-aan-activation: swish
[2023-06-23 08:55:56] [config] transformer-aan-depth: 2
[2023-06-23 08:55:56] [config] transformer-aan-nogate: false
[2023-06-23 08:55:56] [config] transformer-decoder-autoreg: self-attention
[2023-06-23 08:55:56] [config] transformer-decoder-dim-ffn: 0
[2023-06-23 08:55:56] [config] transformer-decoder-ffn-depth: 0
[2023-06-23 08:55:56] [config] transformer-depth-scaling: false
[2023-06-23 08:55:56] [config] transformer-dim-aan: 2048
[2023-06-23 08:55:56] [config] transformer-dim-ffn: 2048
[2023-06-23 08:55:56] [config] transformer-dropout: 0
[2023-06-23 08:55:56] [config] transformer-dropout-attention: 0
[2023-06-23 08:55:56] [config] transformer-dropout-ffn: 0
[2023-06-23 08:55:56] [config] transformer-ffn-activation: swish
[2023-06-23 08:55:56] [config] transformer-ffn-depth: 2
[2023-06-23 08:55:56] [config] transformer-guided-alignment-layer: last
[2023-06-23 08:55:56] [config] transformer-heads: 8
[2023-06-23 08:55:56] [config] transformer-no-projection: false
[2023-06-23 08:55:56] [config] transformer-pool: false
[2023-06-23 08:55:56] [config] transformer-postprocess: dan
[2023-06-23 08:55:56] [config] transformer-postprocess-emb: d
[2023-06-23 08:55:56] [config] transformer-postprocess-top: ""
[2023-06-23 08:55:56] [config] transformer-preprocess: ""
[2023-06-23 08:55:56] [config] transformer-tied-layers:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] transformer-train-position-embeddings: false
[2023-06-23 08:55:56] [config] tsv: false
[2023-06-23 08:55:56] [config] tsv-fields: 0
[2023-06-23 08:55:56] [config] type: amun
[2023-06-23 08:55:56] [config] ulr: false
[2023-06-23 08:55:56] [config] ulr-dim-emb: 0
[2023-06-23 08:55:56] [config] ulr-dropout: 0
[2023-06-23 08:55:56] [config] ulr-keys-vectors: ""
[2023-06-23 08:55:56] [config] ulr-query-vectors: ""
[2023-06-23 08:55:56] [config] ulr-softmax-temperature: 1
[2023-06-23 08:55:56] [config] ulr-trainable-transformation: false
[2023-06-23 08:55:56] [config] unlikelihood-loss: false
[2023-06-23 08:55:56] [config] valid-freq: 5000000
[2023-06-23 08:55:56] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-23 08:55:56] [config] valid-max-length: 1000
[2023-06-23 08:55:56] [config] valid-metrics:
[2023-06-23 08:55:56] [config]   - cross-entropy
[2023-06-23 08:55:56] [config]   - translation
[2023-06-23 08:55:56] [config] valid-mini-batch: 32
[2023-06-23 08:55:56] [config] valid-reset-stalled: false
[2023-06-23 08:55:56] [config] valid-script-args:
[2023-06-23 08:55:56] [config]   []
[2023-06-23 08:55:56] [config] valid-script-path: ""
[2023-06-23 08:55:56] [config] valid-sets:
[2023-06-23 08:55:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-23 08:55:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-23 08:55:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-23 08:55:56] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 08:55:56] [config] vocabs:
[2023-06-23 08:55:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 08:55:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 08:55:56] [config] word-penalty: 0
[2023-06-23 08:55:56] [config] word-scores: false
[2023-06-23 08:55:56] [config] workspace: 3000
[2023-06-23 08:55:56] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 08:55:56] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 08:55:56] [training] Using single-device training
[2023-06-23 08:55:57] Synced seed 1234
[2023-06-23 08:55:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 08:55:57] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-23 08:55:57] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 08:55:57] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-23 08:55:57] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-23 08:55:57] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 08:55:58] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 08:55:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 08:55:58] [comm] Using global sharding
[2023-06-23 08:55:58] [comm] NCCLCommunicators constructed successfully
[2023-06-23 08:55:58] [training] Using 1 GPUs
[2023-06-23 08:55:58] [logits] Applying loss function for 1 factor(s)
[2023-06-23 08:55:58] [memory] Reserving 377 MB, device gpu0
[2023-06-23 08:56:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-23 08:56:00] [memory] Reserving 377 MB, device gpu0
[2023-06-23 08:56:12] [batching] Done. Typical MB size is 4,814 target words
[2023-06-23 08:56:12] [valid] No post-processing script given for validating translator
[2023-06-23 08:56:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 08:56:12] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 08:56:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 08:56:12] [comm] Using global sharding
[2023-06-23 08:56:12] [comm] NCCLCommunicators constructed successfully
[2023-06-23 08:56:12] [training] Using 1 GPUs
[2023-06-23 08:56:12] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 08:56:15] Loading Adam parameters
[2023-06-23 08:56:15] [memory] Reserving 754 MB, device gpu0
[2023-06-23 08:56:15] [memory] Reserving 377 MB, device gpu0
[2023-06-23 08:56:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-23 08:56:15] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-23 08:56:15] [data] Shuffling data
[2023-06-23 08:56:15] [data] Done reading 20,192 sentences
[2023-06-23 08:56:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-23 08:56:15] Training started
[2023-06-23 08:56:15] Training finished
[2023-06-23 09:06:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 09:06:27] [marian] Running on node07.datos.cluster.uy as process 40780 with command line:
[2023-06-23 09:06:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-23 09:06:27] [config] after: 0e
[2023-06-23 09:06:27] [config] after-batches: 0
[2023-06-23 09:06:27] [config] after-epochs: 1
[2023-06-23 09:06:27] [config] all-caps-every: 0
[2023-06-23 09:06:27] [config] allow-unk: false
[2023-06-23 09:06:27] [config] authors: false
[2023-06-23 09:06:27] [config] beam-size: 12
[2023-06-23 09:06:27] [config] bert-class-symbol: "[CLS]"
[2023-06-23 09:06:27] [config] bert-mask-symbol: "[MASK]"
[2023-06-23 09:06:27] [config] bert-masking-fraction: 0.15
[2023-06-23 09:06:27] [config] bert-sep-symbol: "[SEP]"
[2023-06-23 09:06:27] [config] bert-train-type-embeddings: true
[2023-06-23 09:06:27] [config] bert-type-vocab-size: 2
[2023-06-23 09:06:27] [config] build-info: ""
[2023-06-23 09:06:27] [config] check-gradient-nan: false
[2023-06-23 09:06:27] [config] check-nan: false
[2023-06-23 09:06:27] [config] cite: false
[2023-06-23 09:06:27] [config] clip-norm: 1
[2023-06-23 09:06:27] [config] cost-scaling:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] cost-type: ce-sum
[2023-06-23 09:06:27] [config] cpu-threads: 0
[2023-06-23 09:06:27] [config] data-threads: 8
[2023-06-23 09:06:27] [config] data-weighting: ""
[2023-06-23 09:06:27] [config] data-weighting-type: sentence
[2023-06-23 09:06:27] [config] dec-cell: gru
[2023-06-23 09:06:27] [config] dec-cell-base-depth: 2
[2023-06-23 09:06:27] [config] dec-cell-high-depth: 1
[2023-06-23 09:06:27] [config] dec-depth: 1
[2023-06-23 09:06:27] [config] devices:
[2023-06-23 09:06:27] [config]   - 0
[2023-06-23 09:06:27] [config] dim-emb: 512
[2023-06-23 09:06:27] [config] dim-rnn: 1024
[2023-06-23 09:06:27] [config] dim-vocabs:
[2023-06-23 09:06:27] [config]   - 54042
[2023-06-23 09:06:27] [config]   - 36507
[2023-06-23 09:06:27] [config] disp-first: 0
[2023-06-23 09:06:27] [config] disp-freq: 1000u
[2023-06-23 09:06:27] [config] disp-label-counts: true
[2023-06-23 09:06:27] [config] dropout-rnn: 0.2
[2023-06-23 09:06:27] [config] dropout-src: 0.1
[2023-06-23 09:06:27] [config] dropout-trg: 0.1
[2023-06-23 09:06:27] [config] dump-config: ""
[2023-06-23 09:06:27] [config] dynamic-gradient-scaling:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] early-stopping: 5
[2023-06-23 09:06:27] [config] early-stopping-on: first
[2023-06-23 09:06:27] [config] embedding-fix-src: false
[2023-06-23 09:06:27] [config] embedding-fix-trg: false
[2023-06-23 09:06:27] [config] embedding-normalization: false
[2023-06-23 09:06:27] [config] embedding-vectors:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] enc-cell: gru
[2023-06-23 09:06:27] [config] enc-cell-depth: 1
[2023-06-23 09:06:27] [config] enc-depth: 1
[2023-06-23 09:06:27] [config] enc-type: bidirectional
[2023-06-23 09:06:27] [config] english-title-case-every: 0
[2023-06-23 09:06:27] [config] exponential-smoothing: 0
[2023-06-23 09:06:27] [config] factor-weight: 1
[2023-06-23 09:06:27] [config] factors-combine: sum
[2023-06-23 09:06:27] [config] factors-dim-emb: 0
[2023-06-23 09:06:27] [config] gradient-checkpointing: false
[2023-06-23 09:06:27] [config] gradient-norm-average-window: 100
[2023-06-23 09:06:27] [config] guided-alignment: none
[2023-06-23 09:06:27] [config] guided-alignment-cost: mse
[2023-06-23 09:06:27] [config] guided-alignment-weight: 0.1
[2023-06-23 09:06:27] [config] ignore-model-config: false
[2023-06-23 09:06:27] [config] input-types:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] interpolate-env-vars: false
[2023-06-23 09:06:27] [config] keep-best: false
[2023-06-23 09:06:27] [config] label-smoothing: 0
[2023-06-23 09:06:27] [config] layer-normalization: true
[2023-06-23 09:06:27] [config] learn-rate: 0.0001
[2023-06-23 09:06:27] [config] lemma-dependency: ""
[2023-06-23 09:06:27] [config] lemma-dim-emb: 0
[2023-06-23 09:06:27] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-23 09:06:27] [config] log-level: info
[2023-06-23 09:06:27] [config] log-time-zone: ""
[2023-06-23 09:06:27] [config] logical-epoch:
[2023-06-23 09:06:27] [config]   - 1e
[2023-06-23 09:06:27] [config]   - 0
[2023-06-23 09:06:27] [config] lr-decay: 0
[2023-06-23 09:06:27] [config] lr-decay-freq: 50000
[2023-06-23 09:06:27] [config] lr-decay-inv-sqrt:
[2023-06-23 09:06:27] [config]   - 0
[2023-06-23 09:06:27] [config] lr-decay-repeat-warmup: false
[2023-06-23 09:06:27] [config] lr-decay-reset-optimizer: false
[2023-06-23 09:06:27] [config] lr-decay-start:
[2023-06-23 09:06:27] [config]   - 10
[2023-06-23 09:06:27] [config]   - 1
[2023-06-23 09:06:27] [config] lr-decay-strategy: epoch+stalled
[2023-06-23 09:06:27] [config] lr-report: false
[2023-06-23 09:06:27] [config] lr-warmup: 0
[2023-06-23 09:06:27] [config] lr-warmup-at-reload: false
[2023-06-23 09:06:27] [config] lr-warmup-cycle: false
[2023-06-23 09:06:27] [config] lr-warmup-start-rate: 0
[2023-06-23 09:06:27] [config] max-length: 50
[2023-06-23 09:06:27] [config] max-length-crop: false
[2023-06-23 09:06:27] [config] max-length-factor: 3
[2023-06-23 09:06:27] [config] maxi-batch: 100
[2023-06-23 09:06:27] [config] maxi-batch-sort: trg
[2023-06-23 09:06:27] [config] mini-batch: 64
[2023-06-23 09:06:27] [config] mini-batch-fit: true
[2023-06-23 09:06:27] [config] mini-batch-fit-step: 10
[2023-06-23 09:06:27] [config] mini-batch-round-up: true
[2023-06-23 09:06:27] [config] mini-batch-track-lr: false
[2023-06-23 09:06:27] [config] mini-batch-warmup: 0
[2023-06-23 09:06:27] [config] mini-batch-words: 0
[2023-06-23 09:06:27] [config] mini-batch-words-ref: 0
[2023-06-23 09:06:27] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 09:06:27] [config] multi-loss-type: sum
[2023-06-23 09:06:27] [config] n-best: false
[2023-06-23 09:06:27] [config] no-nccl: false
[2023-06-23 09:06:27] [config] no-reload: false
[2023-06-23 09:06:27] [config] no-restore-corpus: false
[2023-06-23 09:06:27] [config] normalize: 0
[2023-06-23 09:06:27] [config] normalize-gradient: false
[2023-06-23 09:06:27] [config] num-devices: 0
[2023-06-23 09:06:27] [config] optimizer: adam
[2023-06-23 09:06:27] [config] optimizer-delay: 1
[2023-06-23 09:06:27] [config] optimizer-params:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] output-omit-bias: false
[2023-06-23 09:06:27] [config] overwrite: false
[2023-06-23 09:06:27] [config] precision:
[2023-06-23 09:06:27] [config]   - float32
[2023-06-23 09:06:27] [config]   - float32
[2023-06-23 09:06:27] [config] pretrained-model: ""
[2023-06-23 09:06:27] [config] quantize-biases: false
[2023-06-23 09:06:27] [config] quantize-bits: 0
[2023-06-23 09:06:27] [config] quantize-log-based: false
[2023-06-23 09:06:27] [config] quantize-optimization-steps: 0
[2023-06-23 09:06:27] [config] quiet: false
[2023-06-23 09:06:27] [config] quiet-translation: true
[2023-06-23 09:06:27] [config] relative-paths: false
[2023-06-23 09:06:27] [config] right-left: false
[2023-06-23 09:06:27] [config] save-freq: 10000u
[2023-06-23 09:06:27] [config] seed: 1234
[2023-06-23 09:06:27] [config] sentencepiece-alphas:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] sentencepiece-max-lines: 2000000
[2023-06-23 09:06:27] [config] sentencepiece-options: ""
[2023-06-23 09:06:27] [config] sharding: global
[2023-06-23 09:06:27] [config] shuffle: data
[2023-06-23 09:06:27] [config] shuffle-in-ram: false
[2023-06-23 09:06:27] [config] sigterm: save-and-exit
[2023-06-23 09:06:27] [config] skip: false
[2023-06-23 09:06:27] [config] sqlite: ""
[2023-06-23 09:06:27] [config] sqlite-drop: false
[2023-06-23 09:06:27] [config] sync-freq: 200u
[2023-06-23 09:06:27] [config] sync-sgd: false
[2023-06-23 09:06:27] [config] tempdir: /tmp
[2023-06-23 09:06:27] [config] tied-embeddings: false
[2023-06-23 09:06:27] [config] tied-embeddings-all: false
[2023-06-23 09:06:27] [config] tied-embeddings-src: false
[2023-06-23 09:06:27] [config] train-embedder-rank:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] train-sets:
[2023-06-23 09:06:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-23 09:06:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-23 09:06:27] [config] transformer-aan-activation: swish
[2023-06-23 09:06:27] [config] transformer-aan-depth: 2
[2023-06-23 09:06:27] [config] transformer-aan-nogate: false
[2023-06-23 09:06:27] [config] transformer-decoder-autoreg: self-attention
[2023-06-23 09:06:27] [config] transformer-decoder-dim-ffn: 0
[2023-06-23 09:06:27] [config] transformer-decoder-ffn-depth: 0
[2023-06-23 09:06:27] [config] transformer-depth-scaling: false
[2023-06-23 09:06:27] [config] transformer-dim-aan: 2048
[2023-06-23 09:06:27] [config] transformer-dim-ffn: 2048
[2023-06-23 09:06:27] [config] transformer-dropout: 0
[2023-06-23 09:06:27] [config] transformer-dropout-attention: 0
[2023-06-23 09:06:27] [config] transformer-dropout-ffn: 0
[2023-06-23 09:06:27] [config] transformer-ffn-activation: swish
[2023-06-23 09:06:27] [config] transformer-ffn-depth: 2
[2023-06-23 09:06:27] [config] transformer-guided-alignment-layer: last
[2023-06-23 09:06:27] [config] transformer-heads: 8
[2023-06-23 09:06:27] [config] transformer-no-projection: false
[2023-06-23 09:06:27] [config] transformer-pool: false
[2023-06-23 09:06:27] [config] transformer-postprocess: dan
[2023-06-23 09:06:27] [config] transformer-postprocess-emb: d
[2023-06-23 09:06:27] [config] transformer-postprocess-top: ""
[2023-06-23 09:06:27] [config] transformer-preprocess: ""
[2023-06-23 09:06:27] [config] transformer-tied-layers:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] transformer-train-position-embeddings: false
[2023-06-23 09:06:27] [config] tsv: false
[2023-06-23 09:06:27] [config] tsv-fields: 0
[2023-06-23 09:06:27] [config] type: amun
[2023-06-23 09:06:27] [config] ulr: false
[2023-06-23 09:06:27] [config] ulr-dim-emb: 0
[2023-06-23 09:06:27] [config] ulr-dropout: 0
[2023-06-23 09:06:27] [config] ulr-keys-vectors: ""
[2023-06-23 09:06:27] [config] ulr-query-vectors: ""
[2023-06-23 09:06:27] [config] ulr-softmax-temperature: 1
[2023-06-23 09:06:27] [config] ulr-trainable-transformation: false
[2023-06-23 09:06:27] [config] unlikelihood-loss: false
[2023-06-23 09:06:27] [config] valid-freq: 5000000
[2023-06-23 09:06:27] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-23 09:06:27] [config] valid-max-length: 1000
[2023-06-23 09:06:27] [config] valid-metrics:
[2023-06-23 09:06:27] [config]   - cross-entropy
[2023-06-23 09:06:27] [config]   - translation
[2023-06-23 09:06:27] [config] valid-mini-batch: 32
[2023-06-23 09:06:27] [config] valid-reset-stalled: false
[2023-06-23 09:06:27] [config] valid-script-args:
[2023-06-23 09:06:27] [config]   []
[2023-06-23 09:06:27] [config] valid-script-path: ""
[2023-06-23 09:06:27] [config] valid-sets:
[2023-06-23 09:06:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-23 09:06:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-23 09:06:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-23 09:06:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 09:06:27] [config] vocabs:
[2023-06-23 09:06:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 09:06:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 09:06:27] [config] word-penalty: 0
[2023-06-23 09:06:27] [config] word-scores: false
[2023-06-23 09:06:27] [config] workspace: 3000
[2023-06-23 09:06:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 09:06:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 09:06:27] [training] Using single-device training
[2023-06-23 09:06:27] Synced seed 1234
[2023-06-23 09:06:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 09:06:27] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-23 09:06:27] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 09:06:27] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-23 09:06:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-23 09:06:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 09:06:28] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 09:06:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 09:06:28] [comm] Using global sharding
[2023-06-23 09:06:28] [comm] NCCLCommunicators constructed successfully
[2023-06-23 09:06:28] [training] Using 1 GPUs
[2023-06-23 09:06:28] [logits] Applying loss function for 1 factor(s)
[2023-06-23 09:06:28] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:06:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-23 09:06:30] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:06:42] [batching] Done. Typical MB size is 4,814 target words
[2023-06-23 09:06:42] [valid] No post-processing script given for validating translator
[2023-06-23 09:06:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 09:06:42] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 09:06:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 09:06:42] [comm] Using global sharding
[2023-06-23 09:06:42] [comm] NCCLCommunicators constructed successfully
[2023-06-23 09:06:42] [training] Using 1 GPUs
[2023-06-23 09:06:42] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 09:06:45] Loading Adam parameters
[2023-06-23 09:06:45] [memory] Reserving 754 MB, device gpu0
[2023-06-23 09:06:46] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:06:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-23 09:06:46] [data] Restoring the corpus state to epoch 81, batch 9592
[2023-06-23 09:06:46] [data] Shuffling data
[2023-06-23 09:06:46] [data] Done reading 20,192 sentences
[2023-06-23 09:06:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-23 09:06:46] Training started
[2023-06-23 09:06:46] Training finished
[2023-06-23 09:24:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 09:24:14] [marian] Running on node07.datos.cluster.uy as process 1951 with command line:
[2023-06-23 09:24:14] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 1 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation
[2023-06-23 09:24:14] [config] after: 0e
[2023-06-23 09:24:14] [config] after-batches: 0
[2023-06-23 09:24:14] [config] after-epochs: 1
[2023-06-23 09:24:14] [config] all-caps-every: 0
[2023-06-23 09:24:14] [config] allow-unk: false
[2023-06-23 09:24:14] [config] authors: false
[2023-06-23 09:24:14] [config] beam-size: 12
[2023-06-23 09:24:14] [config] bert-class-symbol: "[CLS]"
[2023-06-23 09:24:14] [config] bert-mask-symbol: "[MASK]"
[2023-06-23 09:24:14] [config] bert-masking-fraction: 0.15
[2023-06-23 09:24:14] [config] bert-sep-symbol: "[SEP]"
[2023-06-23 09:24:14] [config] bert-train-type-embeddings: true
[2023-06-23 09:24:14] [config] bert-type-vocab-size: 2
[2023-06-23 09:24:14] [config] build-info: ""
[2023-06-23 09:24:14] [config] check-gradient-nan: false
[2023-06-23 09:24:14] [config] check-nan: false
[2023-06-23 09:24:14] [config] cite: false
[2023-06-23 09:24:14] [config] clip-norm: 1
[2023-06-23 09:24:14] [config] cost-scaling:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] cost-type: ce-sum
[2023-06-23 09:24:14] [config] cpu-threads: 0
[2023-06-23 09:24:14] [config] data-threads: 8
[2023-06-23 09:24:14] [config] data-weighting: ""
[2023-06-23 09:24:14] [config] data-weighting-type: sentence
[2023-06-23 09:24:14] [config] dec-cell: gru
[2023-06-23 09:24:14] [config] dec-cell-base-depth: 2
[2023-06-23 09:24:14] [config] dec-cell-high-depth: 1
[2023-06-23 09:24:14] [config] dec-depth: 1
[2023-06-23 09:24:14] [config] devices:
[2023-06-23 09:24:14] [config]   - 0
[2023-06-23 09:24:14] [config] dim-emb: 512
[2023-06-23 09:24:14] [config] dim-rnn: 1024
[2023-06-23 09:24:14] [config] dim-vocabs:
[2023-06-23 09:24:14] [config]   - 0
[2023-06-23 09:24:14] [config]   - 0
[2023-06-23 09:24:14] [config] disp-first: 0
[2023-06-23 09:24:14] [config] disp-freq: 1000u
[2023-06-23 09:24:14] [config] disp-label-counts: true
[2023-06-23 09:24:14] [config] dropout-rnn: 0.2
[2023-06-23 09:24:14] [config] dropout-src: 0.1
[2023-06-23 09:24:14] [config] dropout-trg: 0.1
[2023-06-23 09:24:14] [config] dump-config: ""
[2023-06-23 09:24:14] [config] dynamic-gradient-scaling:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] early-stopping: 5
[2023-06-23 09:24:14] [config] early-stopping-on: first
[2023-06-23 09:24:14] [config] embedding-fix-src: false
[2023-06-23 09:24:14] [config] embedding-fix-trg: false
[2023-06-23 09:24:14] [config] embedding-normalization: false
[2023-06-23 09:24:14] [config] embedding-vectors:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] enc-cell: gru
[2023-06-23 09:24:14] [config] enc-cell-depth: 1
[2023-06-23 09:24:14] [config] enc-depth: 1
[2023-06-23 09:24:14] [config] enc-type: bidirectional
[2023-06-23 09:24:14] [config] english-title-case-every: 0
[2023-06-23 09:24:14] [config] exponential-smoothing: 0
[2023-06-23 09:24:14] [config] factor-weight: 1
[2023-06-23 09:24:14] [config] factors-combine: sum
[2023-06-23 09:24:14] [config] factors-dim-emb: 0
[2023-06-23 09:24:14] [config] gradient-checkpointing: false
[2023-06-23 09:24:14] [config] gradient-norm-average-window: 100
[2023-06-23 09:24:14] [config] guided-alignment: none
[2023-06-23 09:24:14] [config] guided-alignment-cost: mse
[2023-06-23 09:24:14] [config] guided-alignment-weight: 0.1
[2023-06-23 09:24:14] [config] ignore-model-config: false
[2023-06-23 09:24:14] [config] input-types:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] interpolate-env-vars: false
[2023-06-23 09:24:14] [config] keep-best: false
[2023-06-23 09:24:14] [config] label-smoothing: 0
[2023-06-23 09:24:14] [config] layer-normalization: true
[2023-06-23 09:24:14] [config] learn-rate: 0.0001
[2023-06-23 09:24:14] [config] lemma-dependency: ""
[2023-06-23 09:24:14] [config] lemma-dim-emb: 0
[2023-06-23 09:24:14] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-23 09:24:14] [config] log-level: info
[2023-06-23 09:24:14] [config] log-time-zone: ""
[2023-06-23 09:24:14] [config] logical-epoch:
[2023-06-23 09:24:14] [config]   - 1e
[2023-06-23 09:24:14] [config]   - 0
[2023-06-23 09:24:14] [config] lr-decay: 0
[2023-06-23 09:24:14] [config] lr-decay-freq: 50000
[2023-06-23 09:24:14] [config] lr-decay-inv-sqrt:
[2023-06-23 09:24:14] [config]   - 0
[2023-06-23 09:24:14] [config] lr-decay-repeat-warmup: false
[2023-06-23 09:24:14] [config] lr-decay-reset-optimizer: false
[2023-06-23 09:24:14] [config] lr-decay-start:
[2023-06-23 09:24:14] [config]   - 10
[2023-06-23 09:24:14] [config]   - 1
[2023-06-23 09:24:14] [config] lr-decay-strategy: epoch+stalled
[2023-06-23 09:24:14] [config] lr-report: false
[2023-06-23 09:24:14] [config] lr-warmup: 0
[2023-06-23 09:24:14] [config] lr-warmup-at-reload: false
[2023-06-23 09:24:14] [config] lr-warmup-cycle: false
[2023-06-23 09:24:14] [config] lr-warmup-start-rate: 0
[2023-06-23 09:24:14] [config] max-length: 50
[2023-06-23 09:24:14] [config] max-length-crop: false
[2023-06-23 09:24:14] [config] max-length-factor: 3
[2023-06-23 09:24:14] [config] maxi-batch: 100
[2023-06-23 09:24:14] [config] maxi-batch-sort: trg
[2023-06-23 09:24:14] [config] mini-batch: 64
[2023-06-23 09:24:14] [config] mini-batch-fit: true
[2023-06-23 09:24:14] [config] mini-batch-fit-step: 10
[2023-06-23 09:24:14] [config] mini-batch-round-up: true
[2023-06-23 09:24:14] [config] mini-batch-track-lr: false
[2023-06-23 09:24:14] [config] mini-batch-warmup: 0
[2023-06-23 09:24:14] [config] mini-batch-words: 0
[2023-06-23 09:24:14] [config] mini-batch-words-ref: 0
[2023-06-23 09:24:14] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 09:24:14] [config] multi-loss-type: sum
[2023-06-23 09:24:14] [config] n-best: false
[2023-06-23 09:24:14] [config] no-nccl: false
[2023-06-23 09:24:14] [config] no-reload: false
[2023-06-23 09:24:14] [config] no-restore-corpus: false
[2023-06-23 09:24:14] [config] normalize: 0
[2023-06-23 09:24:14] [config] normalize-gradient: false
[2023-06-23 09:24:14] [config] num-devices: 0
[2023-06-23 09:24:14] [config] optimizer: adam
[2023-06-23 09:24:14] [config] optimizer-delay: 1
[2023-06-23 09:24:14] [config] optimizer-params:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] output-omit-bias: false
[2023-06-23 09:24:14] [config] overwrite: false
[2023-06-23 09:24:14] [config] precision:
[2023-06-23 09:24:14] [config]   - float32
[2023-06-23 09:24:14] [config]   - float32
[2023-06-23 09:24:14] [config] pretrained-model: ""
[2023-06-23 09:24:14] [config] quantize-biases: false
[2023-06-23 09:24:14] [config] quantize-bits: 0
[2023-06-23 09:24:14] [config] quantize-log-based: false
[2023-06-23 09:24:14] [config] quantize-optimization-steps: 0
[2023-06-23 09:24:14] [config] quiet: false
[2023-06-23 09:24:14] [config] quiet-translation: true
[2023-06-23 09:24:14] [config] relative-paths: false
[2023-06-23 09:24:14] [config] right-left: false
[2023-06-23 09:24:14] [config] save-freq: 10000u
[2023-06-23 09:24:14] [config] seed: 1234
[2023-06-23 09:24:14] [config] sentencepiece-alphas:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] sentencepiece-max-lines: 2000000
[2023-06-23 09:24:14] [config] sentencepiece-options: ""
[2023-06-23 09:24:14] [config] sharding: global
[2023-06-23 09:24:14] [config] shuffle: data
[2023-06-23 09:24:14] [config] shuffle-in-ram: false
[2023-06-23 09:24:14] [config] sigterm: save-and-exit
[2023-06-23 09:24:14] [config] skip: false
[2023-06-23 09:24:14] [config] sqlite: ""
[2023-06-23 09:24:14] [config] sqlite-drop: false
[2023-06-23 09:24:14] [config] sync-freq: 200u
[2023-06-23 09:24:14] [config] sync-sgd: false
[2023-06-23 09:24:14] [config] tempdir: /tmp
[2023-06-23 09:24:14] [config] tied-embeddings: false
[2023-06-23 09:24:14] [config] tied-embeddings-all: false
[2023-06-23 09:24:14] [config] tied-embeddings-src: false
[2023-06-23 09:24:14] [config] train-embedder-rank:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] train-sets:
[2023-06-23 09:24:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-23 09:24:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-23 09:24:14] [config] transformer-aan-activation: swish
[2023-06-23 09:24:14] [config] transformer-aan-depth: 2
[2023-06-23 09:24:14] [config] transformer-aan-nogate: false
[2023-06-23 09:24:14] [config] transformer-decoder-autoreg: self-attention
[2023-06-23 09:24:14] [config] transformer-decoder-dim-ffn: 0
[2023-06-23 09:24:14] [config] transformer-decoder-ffn-depth: 0
[2023-06-23 09:24:14] [config] transformer-depth-scaling: false
[2023-06-23 09:24:14] [config] transformer-dim-aan: 2048
[2023-06-23 09:24:14] [config] transformer-dim-ffn: 2048
[2023-06-23 09:24:14] [config] transformer-dropout: 0
[2023-06-23 09:24:14] [config] transformer-dropout-attention: 0
[2023-06-23 09:24:14] [config] transformer-dropout-ffn: 0
[2023-06-23 09:24:14] [config] transformer-ffn-activation: swish
[2023-06-23 09:24:14] [config] transformer-ffn-depth: 2
[2023-06-23 09:24:14] [config] transformer-guided-alignment-layer: last
[2023-06-23 09:24:14] [config] transformer-heads: 8
[2023-06-23 09:24:14] [config] transformer-no-projection: false
[2023-06-23 09:24:14] [config] transformer-pool: false
[2023-06-23 09:24:14] [config] transformer-postprocess: dan
[2023-06-23 09:24:14] [config] transformer-postprocess-emb: d
[2023-06-23 09:24:14] [config] transformer-postprocess-top: ""
[2023-06-23 09:24:14] [config] transformer-preprocess: ""
[2023-06-23 09:24:14] [config] transformer-tied-layers:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] transformer-train-position-embeddings: false
[2023-06-23 09:24:14] [config] tsv: false
[2023-06-23 09:24:14] [config] tsv-fields: 0
[2023-06-23 09:24:14] [config] type: amun
[2023-06-23 09:24:14] [config] ulr: false
[2023-06-23 09:24:14] [config] ulr-dim-emb: 0
[2023-06-23 09:24:14] [config] ulr-dropout: 0
[2023-06-23 09:24:14] [config] ulr-keys-vectors: ""
[2023-06-23 09:24:14] [config] ulr-query-vectors: ""
[2023-06-23 09:24:14] [config] ulr-softmax-temperature: 1
[2023-06-23 09:24:14] [config] ulr-trainable-transformation: false
[2023-06-23 09:24:14] [config] unlikelihood-loss: false
[2023-06-23 09:24:14] [config] valid-freq: 5000000
[2023-06-23 09:24:14] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-23 09:24:14] [config] valid-max-length: 1000
[2023-06-23 09:24:14] [config] valid-metrics:
[2023-06-23 09:24:14] [config]   - cross-entropy
[2023-06-23 09:24:14] [config]   - translation
[2023-06-23 09:24:14] [config] valid-mini-batch: 32
[2023-06-23 09:24:14] [config] valid-reset-stalled: false
[2023-06-23 09:24:14] [config] valid-script-args:
[2023-06-23 09:24:14] [config]   []
[2023-06-23 09:24:14] [config] valid-script-path: ""
[2023-06-23 09:24:14] [config] valid-sets:
[2023-06-23 09:24:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-23 09:24:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-23 09:24:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-23 09:24:14] [config] vocabs:
[2023-06-23 09:24:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 09:24:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 09:24:14] [config] word-penalty: 0
[2023-06-23 09:24:14] [config] word-scores: false
[2023-06-23 09:24:14] [config] workspace: 3000
[2023-06-23 09:24:14] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 09:24:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 09:24:14] [training] Using single-device training
[2023-06-23 09:24:14] Synced seed 1234
[2023-06-23 09:24:14] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 09:24:15] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-23 09:24:15] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 09:24:15] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-23 09:24:15] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-23 09:24:15] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 09:24:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 09:24:16] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 09:24:16] [comm] Using global sharding
[2023-06-23 09:24:16] [comm] NCCLCommunicators constructed successfully
[2023-06-23 09:24:16] [training] Using 1 GPUs
[2023-06-23 09:24:16] [logits] Applying loss function for 1 factor(s)
[2023-06-23 09:24:16] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:24:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-23 09:24:18] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:24:30] [batching] Done. Typical MB size is 4,814 target words
[2023-06-23 09:24:30] [valid] No post-processing script given for validating translator
[2023-06-23 09:24:30] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 09:24:30] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 09:24:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 09:24:30] [comm] Using global sharding
[2023-06-23 09:24:30] [comm] NCCLCommunicators constructed successfully
[2023-06-23 09:24:30] [training] Using 1 GPUs
[2023-06-23 09:24:30] Training started
[2023-06-23 09:24:30] [data] Shuffling data
[2023-06-23 09:24:30] [data] Done reading 20,192 sentences
[2023-06-23 09:24:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-23 09:24:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-23 09:24:30] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:24:30] [memory] Reserving 377 MB, device gpu0
[2023-06-23 09:24:31] Parameter type float32, optimization type float32, casting types false
[2023-06-23 09:24:31] Allocating memory for Adam-specific shards
[2023-06-23 09:24:31] [memory] Reserving 754 MB, device gpu0
[2023-06-23 09:25:09] Seen 18,843 samples
[2023-06-23 09:25:09] Starting data epoch 2 in logical epoch 2
[2023-06-23 09:25:09] Training finished
[2023-06-23 09:25:16] [valid] Ep. 2 : Up. 119 : cross-entropy : 124.321 : new best
[2023-06-23 09:27:18] [valid] Ep. 2 : Up. 119 : translation : 0 : new best
[2023-06-23 09:27:18] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 09:27:21] Saving Adam parameters
[2023-06-23 09:27:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-23 11:11:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 11:11:01] [marian] Running on node21.datos.cluster.uy as process 17575 with command line:
[2023-06-23 11:11:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz --after-epochs 2 --valid-freq 5000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type amun --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --early-stopping 5 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/model-epochs.txt --quiet-translation --sentencepiece-options '  --normalization_rule_name=nmt_nfkc'
[2023-06-23 11:11:01] [config] after: 0e
[2023-06-23 11:11:01] [config] after-batches: 0
[2023-06-23 11:11:01] [config] after-epochs: 2
[2023-06-23 11:11:01] [config] all-caps-every: 0
[2023-06-23 11:11:01] [config] allow-unk: false
[2023-06-23 11:11:01] [config] authors: false
[2023-06-23 11:11:01] [config] beam-size: 12
[2023-06-23 11:11:01] [config] bert-class-symbol: "[CLS]"
[2023-06-23 11:11:01] [config] bert-mask-symbol: "[MASK]"
[2023-06-23 11:11:01] [config] bert-masking-fraction: 0.15
[2023-06-23 11:11:01] [config] bert-sep-symbol: "[SEP]"
[2023-06-23 11:11:01] [config] bert-train-type-embeddings: true
[2023-06-23 11:11:01] [config] bert-type-vocab-size: 2
[2023-06-23 11:11:01] [config] build-info: ""
[2023-06-23 11:11:01] [config] check-gradient-nan: false
[2023-06-23 11:11:01] [config] check-nan: false
[2023-06-23 11:11:01] [config] cite: false
[2023-06-23 11:11:01] [config] clip-norm: 1
[2023-06-23 11:11:01] [config] cost-scaling:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] cost-type: ce-sum
[2023-06-23 11:11:01] [config] cpu-threads: 0
[2023-06-23 11:11:01] [config] data-threads: 8
[2023-06-23 11:11:01] [config] data-weighting: ""
[2023-06-23 11:11:01] [config] data-weighting-type: sentence
[2023-06-23 11:11:01] [config] dec-cell: gru
[2023-06-23 11:11:01] [config] dec-cell-base-depth: 2
[2023-06-23 11:11:01] [config] dec-cell-high-depth: 1
[2023-06-23 11:11:01] [config] dec-depth: 1
[2023-06-23 11:11:01] [config] devices:
[2023-06-23 11:11:01] [config]   - 0
[2023-06-23 11:11:01] [config] dim-emb: 512
[2023-06-23 11:11:01] [config] dim-rnn: 1024
[2023-06-23 11:11:01] [config] dim-vocabs:
[2023-06-23 11:11:01] [config]   - 54042
[2023-06-23 11:11:01] [config]   - 36507
[2023-06-23 11:11:01] [config] disp-first: 0
[2023-06-23 11:11:01] [config] disp-freq: 1000u
[2023-06-23 11:11:01] [config] disp-label-counts: true
[2023-06-23 11:11:01] [config] dropout-rnn: 0.2
[2023-06-23 11:11:01] [config] dropout-src: 0.1
[2023-06-23 11:11:01] [config] dropout-trg: 0.1
[2023-06-23 11:11:01] [config] dump-config: ""
[2023-06-23 11:11:01] [config] dynamic-gradient-scaling:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] early-stopping: 5
[2023-06-23 11:11:01] [config] early-stopping-on: first
[2023-06-23 11:11:01] [config] embedding-fix-src: false
[2023-06-23 11:11:01] [config] embedding-fix-trg: false
[2023-06-23 11:11:01] [config] embedding-normalization: false
[2023-06-23 11:11:01] [config] embedding-vectors:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] enc-cell: gru
[2023-06-23 11:11:01] [config] enc-cell-depth: 1
[2023-06-23 11:11:01] [config] enc-depth: 1
[2023-06-23 11:11:01] [config] enc-type: bidirectional
[2023-06-23 11:11:01] [config] english-title-case-every: 0
[2023-06-23 11:11:01] [config] exponential-smoothing: 0
[2023-06-23 11:11:01] [config] factor-weight: 1
[2023-06-23 11:11:01] [config] factors-combine: sum
[2023-06-23 11:11:01] [config] factors-dim-emb: 0
[2023-06-23 11:11:01] [config] gradient-checkpointing: false
[2023-06-23 11:11:01] [config] gradient-norm-average-window: 100
[2023-06-23 11:11:01] [config] guided-alignment: none
[2023-06-23 11:11:01] [config] guided-alignment-cost: mse
[2023-06-23 11:11:01] [config] guided-alignment-weight: 0.1
[2023-06-23 11:11:01] [config] ignore-model-config: false
[2023-06-23 11:11:01] [config] input-types:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] interpolate-env-vars: false
[2023-06-23 11:11:01] [config] keep-best: false
[2023-06-23 11:11:01] [config] label-smoothing: 0
[2023-06-23 11:11:01] [config] layer-normalization: true
[2023-06-23 11:11:01] [config] learn-rate: 0.0001
[2023-06-23 11:11:01] [config] lemma-dependency: ""
[2023-06-23 11:11:01] [config] lemma-dim-emb: 0
[2023-06-23 11:11:01] [config] log: /docker/home/marianmt/logs/marian/split_model_gn_es_scored_june.log
[2023-06-23 11:11:01] [config] log-level: info
[2023-06-23 11:11:01] [config] log-time-zone: ""
[2023-06-23 11:11:01] [config] logical-epoch:
[2023-06-23 11:11:01] [config]   - 1e
[2023-06-23 11:11:01] [config]   - 0
[2023-06-23 11:11:01] [config] lr-decay: 0
[2023-06-23 11:11:01] [config] lr-decay-freq: 50000
[2023-06-23 11:11:01] [config] lr-decay-inv-sqrt:
[2023-06-23 11:11:01] [config]   - 0
[2023-06-23 11:11:01] [config] lr-decay-repeat-warmup: false
[2023-06-23 11:11:01] [config] lr-decay-reset-optimizer: false
[2023-06-23 11:11:01] [config] lr-decay-start:
[2023-06-23 11:11:01] [config]   - 10
[2023-06-23 11:11:01] [config]   - 1
[2023-06-23 11:11:01] [config] lr-decay-strategy: epoch+stalled
[2023-06-23 11:11:01] [config] lr-report: false
[2023-06-23 11:11:01] [config] lr-warmup: 0
[2023-06-23 11:11:01] [config] lr-warmup-at-reload: false
[2023-06-23 11:11:01] [config] lr-warmup-cycle: false
[2023-06-23 11:11:01] [config] lr-warmup-start-rate: 0
[2023-06-23 11:11:01] [config] max-length: 50
[2023-06-23 11:11:01] [config] max-length-crop: false
[2023-06-23 11:11:01] [config] max-length-factor: 3
[2023-06-23 11:11:01] [config] maxi-batch: 100
[2023-06-23 11:11:01] [config] maxi-batch-sort: trg
[2023-06-23 11:11:01] [config] mini-batch: 64
[2023-06-23 11:11:01] [config] mini-batch-fit: true
[2023-06-23 11:11:01] [config] mini-batch-fit-step: 10
[2023-06-23 11:11:01] [config] mini-batch-round-up: true
[2023-06-23 11:11:01] [config] mini-batch-track-lr: false
[2023-06-23 11:11:01] [config] mini-batch-warmup: 0
[2023-06-23 11:11:01] [config] mini-batch-words: 0
[2023-06-23 11:11:01] [config] mini-batch-words-ref: 0
[2023-06-23 11:11:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 11:11:01] [config] multi-loss-type: sum
[2023-06-23 11:11:01] [config] n-best: false
[2023-06-23 11:11:01] [config] no-nccl: false
[2023-06-23 11:11:01] [config] no-reload: false
[2023-06-23 11:11:01] [config] no-restore-corpus: false
[2023-06-23 11:11:01] [config] normalize: 0
[2023-06-23 11:11:01] [config] normalize-gradient: false
[2023-06-23 11:11:01] [config] num-devices: 0
[2023-06-23 11:11:01] [config] optimizer: adam
[2023-06-23 11:11:01] [config] optimizer-delay: 1
[2023-06-23 11:11:01] [config] optimizer-params:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] output-omit-bias: false
[2023-06-23 11:11:01] [config] overwrite: false
[2023-06-23 11:11:01] [config] precision:
[2023-06-23 11:11:01] [config]   - float32
[2023-06-23 11:11:01] [config]   - float32
[2023-06-23 11:11:01] [config] pretrained-model: ""
[2023-06-23 11:11:01] [config] quantize-biases: false
[2023-06-23 11:11:01] [config] quantize-bits: 0
[2023-06-23 11:11:01] [config] quantize-log-based: false
[2023-06-23 11:11:01] [config] quantize-optimization-steps: 0
[2023-06-23 11:11:01] [config] quiet: false
[2023-06-23 11:11:01] [config] quiet-translation: true
[2023-06-23 11:11:01] [config] relative-paths: false
[2023-06-23 11:11:01] [config] right-left: false
[2023-06-23 11:11:01] [config] save-freq: 10000u
[2023-06-23 11:11:01] [config] seed: 1234
[2023-06-23 11:11:01] [config] sentencepiece-alphas:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] sentencepiece-max-lines: 2000000
[2023-06-23 11:11:01] [config] sentencepiece-options: "  --normalization_rule_name=nmt_nfkc"
[2023-06-23 11:11:01] [config] sharding: global
[2023-06-23 11:11:01] [config] shuffle: data
[2023-06-23 11:11:01] [config] shuffle-in-ram: false
[2023-06-23 11:11:01] [config] sigterm: save-and-exit
[2023-06-23 11:11:01] [config] skip: false
[2023-06-23 11:11:01] [config] sqlite: ""
[2023-06-23 11:11:01] [config] sqlite-drop: false
[2023-06-23 11:11:01] [config] sync-freq: 200u
[2023-06-23 11:11:01] [config] sync-sgd: false
[2023-06-23 11:11:01] [config] tempdir: /tmp
[2023-06-23 11:11:01] [config] tied-embeddings: false
[2023-06-23 11:11:01] [config] tied-embeddings-all: false
[2023-06-23 11:11:01] [config] tied-embeddings-src: false
[2023-06-23 11:11:01] [config] train-embedder-rank:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] train-sets:
[2023-06-23 11:11:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-23 11:11:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-23 11:11:01] [config] transformer-aan-activation: swish
[2023-06-23 11:11:01] [config] transformer-aan-depth: 2
[2023-06-23 11:11:01] [config] transformer-aan-nogate: false
[2023-06-23 11:11:01] [config] transformer-decoder-autoreg: self-attention
[2023-06-23 11:11:01] [config] transformer-decoder-dim-ffn: 0
[2023-06-23 11:11:01] [config] transformer-decoder-ffn-depth: 0
[2023-06-23 11:11:01] [config] transformer-depth-scaling: false
[2023-06-23 11:11:01] [config] transformer-dim-aan: 2048
[2023-06-23 11:11:01] [config] transformer-dim-ffn: 2048
[2023-06-23 11:11:01] [config] transformer-dropout: 0
[2023-06-23 11:11:01] [config] transformer-dropout-attention: 0
[2023-06-23 11:11:01] [config] transformer-dropout-ffn: 0
[2023-06-23 11:11:01] [config] transformer-ffn-activation: swish
[2023-06-23 11:11:01] [config] transformer-ffn-depth: 2
[2023-06-23 11:11:01] [config] transformer-guided-alignment-layer: last
[2023-06-23 11:11:01] [config] transformer-heads: 8
[2023-06-23 11:11:01] [config] transformer-no-projection: false
[2023-06-23 11:11:01] [config] transformer-pool: false
[2023-06-23 11:11:01] [config] transformer-postprocess: dan
[2023-06-23 11:11:01] [config] transformer-postprocess-emb: d
[2023-06-23 11:11:01] [config] transformer-postprocess-top: ""
[2023-06-23 11:11:01] [config] transformer-preprocess: ""
[2023-06-23 11:11:01] [config] transformer-tied-layers:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] transformer-train-position-embeddings: false
[2023-06-23 11:11:01] [config] tsv: false
[2023-06-23 11:11:01] [config] tsv-fields: 0
[2023-06-23 11:11:01] [config] type: amun
[2023-06-23 11:11:01] [config] ulr: false
[2023-06-23 11:11:01] [config] ulr-dim-emb: 0
[2023-06-23 11:11:01] [config] ulr-dropout: 0
[2023-06-23 11:11:01] [config] ulr-keys-vectors: ""
[2023-06-23 11:11:01] [config] ulr-query-vectors: ""
[2023-06-23 11:11:01] [config] ulr-softmax-temperature: 1
[2023-06-23 11:11:01] [config] ulr-trainable-transformation: false
[2023-06-23 11:11:01] [config] unlikelihood-loss: false
[2023-06-23 11:11:01] [config] valid-freq: 5000000
[2023-06-23 11:11:01] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_gn_es_scored_june.log
[2023-06-23 11:11:01] [config] valid-max-length: 1000
[2023-06-23 11:11:01] [config] valid-metrics:
[2023-06-23 11:11:01] [config]   - cross-entropy
[2023-06-23 11:11:01] [config]   - translation
[2023-06-23 11:11:01] [config] valid-mini-batch: 32
[2023-06-23 11:11:01] [config] valid-reset-stalled: false
[2023-06-23 11:11:01] [config] valid-script-args:
[2023-06-23 11:11:01] [config]   []
[2023-06-23 11:11:01] [config] valid-script-path: ""
[2023-06-23 11:11:01] [config] valid-sets:
[2023-06-23 11:11:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-23 11:11:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-23 11:11:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/model-epochs.txt
[2023-06-23 11:11:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 11:11:01] [config] vocabs:
[2023-06-23 11:11:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 11:11:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 11:11:01] [config] word-penalty: 0
[2023-06-23 11:11:01] [config] word-scores: false
[2023-06-23 11:11:01] [config] workspace: 3000
[2023-06-23 11:11:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-23 11:11:01] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 11:11:01] [training] Using single-device training
[2023-06-23 11:11:03] Synced seed 1234
[2023-06-23 11:11:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-06-23 11:11:03] [data] Setting vocabulary size for input 0 to 54,042
[2023-06-23 11:11:03] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-06-23 11:11:03] [data] Setting vocabulary size for input 1 to 36,507
[2023-06-23 11:11:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-23 11:11:03] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 11:11:04] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 11:11:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 11:11:04] [comm] Using global sharding
[2023-06-23 11:11:05] [comm] NCCLCommunicators constructed successfully
[2023-06-23 11:11:05] [training] Using 1 GPUs
[2023-06-23 11:11:05] [logits] Applying loss function for 1 factor(s)
[2023-06-23 11:11:05] [memory] Reserving 377 MB, device gpu0
[2023-06-23 11:11:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-23 11:11:10] [memory] Reserving 377 MB, device gpu0
[2023-06-23 11:11:22] [batching] Done. Typical MB size is 4,814 target words
[2023-06-23 11:11:23] [valid] No post-processing script given for validating translator
[2023-06-23 11:11:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-23 11:11:23] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-23 11:11:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-23 11:11:23] [comm] Using global sharding
[2023-06-23 11:11:23] [comm] NCCLCommunicators constructed successfully
[2023-06-23 11:11:23] [training] Using 1 GPUs
[2023-06-23 11:11:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 11:11:38] Loading Adam parameters
[2023-06-23 11:11:38] [memory] Reserving 754 MB, device gpu0
[2023-06-23 11:11:38] [memory] Reserving 377 MB, device gpu0
[2023-06-23 11:11:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
[2023-06-23 11:11:38] [data] Restoring the corpus state to epoch 2, batch 119
[2023-06-23 11:11:38] [data] Shuffling data
[2023-06-23 11:11:39] [data] Done reading 20,192 sentences
[2023-06-23 11:11:39] [data] Done shuffling 20,192 sentences to temp files
[2023-06-23 11:11:39] Training started
[2023-06-23 11:11:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-23 11:11:39] [memory] Reserving 377 MB, device gpu0
[2023-06-23 11:11:39] Parameter type float32, optimization type float32, casting types false
[2023-06-23 11:12:18] Seen 18,843 samples
[2023-06-23 11:12:18] Starting data epoch 3 in logical epoch 3
[2023-06-23 11:12:18] Training finished
[2023-06-23 11:12:24] [valid] Ep. 3 : Up. 239 : cross-entropy : 117.844 : new best
[2023-06-23 11:14:22] [valid] Ep. 3 : Up. 239 : translation : 0 : new best
[2023-06-23 11:14:22] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz
[2023-06-23 11:14:34] Saving Adam parameters
[2023-06-23 11:14:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz and /docker/home/marianmt/artifacts/models/model_gn_es_scored_june/gn_es_scored_june.npz.optimizer.npz
