[2023-07-20 16:19:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:18] [marian] Running on node23.datos.cluster.uy as process 3012 with command line:
[2023-07-20 16:19:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 16:19:18] [config] after: 0e
[2023-07-20 16:19:18] [config] after-batches: 0
[2023-07-20 16:19:18] [config] after-epochs: 10
[2023-07-20 16:19:18] [config] all-caps-every: 0
[2023-07-20 16:19:18] [config] allow-unk: false
[2023-07-20 16:19:18] [config] authors: false
[2023-07-20 16:19:18] [config] beam-size: 12
[2023-07-20 16:19:18] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:18] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:18] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:18] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:18] [config] build-info: ""
[2023-07-20 16:19:18] [config] check-gradient-nan: false
[2023-07-20 16:19:18] [config] check-nan: false
[2023-07-20 16:19:18] [config] cite: false
[2023-07-20 16:19:18] [config] clip-norm: 1
[2023-07-20 16:19:18] [config] cost-scaling:
[2023-07-20 16:19:18] [config]   - 256.f
[2023-07-20 16:19:18] [config]   - 1000
[2023-07-20 16:19:18] [config]   - 2.f
[2023-07-20 16:19:18] [config]   - 256.f
[2023-07-20 16:19:18] [config] cost-type: ce-sum
[2023-07-20 16:19:18] [config] cpu-threads: 0
[2023-07-20 16:19:18] [config] data-threads: 8
[2023-07-20 16:19:18] [config] data-weighting: ""
[2023-07-20 16:19:18] [config] data-weighting-type: sentence
[2023-07-20 16:19:18] [config] dec-cell: gru
[2023-07-20 16:19:18] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:18] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:18] [config] dec-depth: 1
[2023-07-20 16:19:18] [config] devices:
[2023-07-20 16:19:18] [config]   - 0
[2023-07-20 16:19:18] [config] dim-emb: 512
[2023-07-20 16:19:18] [config] dim-rnn: 1024
[2023-07-20 16:19:18] [config] dim-vocabs:
[2023-07-20 16:19:18] [config]   - 16384
[2023-07-20 16:19:18] [config]   - 16384
[2023-07-20 16:19:18] [config] disp-first: 0
[2023-07-20 16:19:18] [config] disp-freq: 1000u
[2023-07-20 16:19:18] [config] disp-label-counts: true
[2023-07-20 16:19:18] [config] dropout-rnn: 0
[2023-07-20 16:19:18] [config] dropout-src: 0
[2023-07-20 16:19:18] [config] dropout-trg: 0
[2023-07-20 16:19:18] [config] dump-config: ""
[2023-07-20 16:19:18] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] early-stopping: 200
[2023-07-20 16:19:18] [config] early-stopping-on: first
[2023-07-20 16:19:18] [config] embedding-fix-src: false
[2023-07-20 16:19:18] [config] embedding-fix-trg: false
[2023-07-20 16:19:18] [config] embedding-normalization: false
[2023-07-20 16:19:18] [config] embedding-vectors:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] enc-cell: gru
[2023-07-20 16:19:18] [config] enc-cell-depth: 1
[2023-07-20 16:19:18] [config] enc-depth: 1
[2023-07-20 16:19:18] [config] enc-type: bidirectional
[2023-07-20 16:19:18] [config] english-title-case-every: 0
[2023-07-20 16:19:18] [config] exponential-smoothing: 0
[2023-07-20 16:19:18] [config] factor-weight: 1
[2023-07-20 16:19:18] [config] factors-combine: sum
[2023-07-20 16:19:18] [config] factors-dim-emb: 0
[2023-07-20 16:19:18] [config] gradient-checkpointing: false
[2023-07-20 16:19:18] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:18] [config] guided-alignment: none
[2023-07-20 16:19:18] [config] guided-alignment-cost: mse
[2023-07-20 16:19:18] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:18] [config] ignore-model-config: false
[2023-07-20 16:19:18] [config] input-types:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] interpolate-env-vars: false
[2023-07-20 16:19:18] [config] keep-best: false
[2023-07-20 16:19:18] [config] label-smoothing: 0
[2023-07-20 16:19:18] [config] layer-normalization: false
[2023-07-20 16:19:18] [config] learn-rate: 0.0001
[2023-07-20 16:19:18] [config] lemma-dependency: ""
[2023-07-20 16:19:18] [config] lemma-dim-emb: 0
[2023-07-20 16:19:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:18] [config] log-level: info
[2023-07-20 16:19:18] [config] log-time-zone: ""
[2023-07-20 16:19:18] [config] logical-epoch:
[2023-07-20 16:19:18] [config]   - 1e
[2023-07-20 16:19:18] [config]   - 0
[2023-07-20 16:19:18] [config] lr-decay: 0
[2023-07-20 16:19:18] [config] lr-decay-freq: 50000
[2023-07-20 16:19:18] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:18] [config]   - 0
[2023-07-20 16:19:18] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:18] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:18] [config] lr-decay-start:
[2023-07-20 16:19:18] [config]   - 10
[2023-07-20 16:19:18] [config]   - 1
[2023-07-20 16:19:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:18] [config] lr-report: false
[2023-07-20 16:19:18] [config] lr-warmup: 0
[2023-07-20 16:19:18] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:18] [config] lr-warmup-cycle: false
[2023-07-20 16:19:18] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:18] [config] max-length: 200
[2023-07-20 16:19:18] [config] max-length-crop: true
[2023-07-20 16:19:18] [config] max-length-factor: 3
[2023-07-20 16:19:18] [config] maxi-batch: 100
[2023-07-20 16:19:18] [config] maxi-batch-sort: trg
[2023-07-20 16:19:18] [config] mini-batch: 64
[2023-07-20 16:19:18] [config] mini-batch-fit: true
[2023-07-20 16:19:18] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:18] [config] mini-batch-round-up: true
[2023-07-20 16:19:18] [config] mini-batch-track-lr: false
[2023-07-20 16:19:18] [config] mini-batch-warmup: 0
[2023-07-20 16:19:18] [config] mini-batch-words: 0
[2023-07-20 16:19:18] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_200.npz
[2023-07-20 16:19:18] [config] multi-loss-type: sum
[2023-07-20 16:19:18] [config] n-best: false
[2023-07-20 16:19:18] [config] no-nccl: false
[2023-07-20 16:19:18] [config] no-reload: false
[2023-07-20 16:19:18] [config] no-restore-corpus: false
[2023-07-20 16:19:18] [config] normalize: 0
[2023-07-20 16:19:18] [config] normalize-gradient: false
[2023-07-20 16:19:18] [config] num-devices: 0
[2023-07-20 16:19:18] [config] optimizer: adam
[2023-07-20 16:19:18] [config] optimizer-delay: 1
[2023-07-20 16:19:18] [config] optimizer-params:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] output-omit-bias: false
[2023-07-20 16:19:18] [config] overwrite: true
[2023-07-20 16:19:18] [config] precision:
[2023-07-20 16:19:18] [config]   - float16
[2023-07-20 16:19:18] [config]   - float32
[2023-07-20 16:19:18] [config] pretrained-model: ""
[2023-07-20 16:19:18] [config] quantize-biases: false
[2023-07-20 16:19:18] [config] quantize-bits: 0
[2023-07-20 16:19:18] [config] quantize-log-based: false
[2023-07-20 16:19:18] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:18] [config] quiet: false
[2023-07-20 16:19:18] [config] quiet-translation: true
[2023-07-20 16:19:18] [config] relative-paths: false
[2023-07-20 16:19:18] [config] right-left: false
[2023-07-20 16:19:18] [config] save-freq: 10000u
[2023-07-20 16:19:18] [config] seed: 1234
[2023-07-20 16:19:18] [config] sentencepiece-alphas:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:18] [config] sentencepiece-options: ""
[2023-07-20 16:19:18] [config] sharding: global
[2023-07-20 16:19:18] [config] shuffle: data
[2023-07-20 16:19:18] [config] shuffle-in-ram: false
[2023-07-20 16:19:18] [config] sigterm: save-and-exit
[2023-07-20 16:19:18] [config] skip: false
[2023-07-20 16:19:18] [config] sqlite: ""
[2023-07-20 16:19:18] [config] sqlite-drop: false
[2023-07-20 16:19:18] [config] sync-freq: 200u
[2023-07-20 16:19:18] [config] sync-sgd: false
[2023-07-20 16:19:18] [config] tempdir: /tmp
[2023-07-20 16:19:18] [config] tied-embeddings: false
[2023-07-20 16:19:18] [config] tied-embeddings-all: true
[2023-07-20 16:19:18] [config] tied-embeddings-src: false
[2023-07-20 16:19:18] [config] train-embedder-rank:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] train-sets:
[2023-07-20 16:19:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:18] [config] transformer-aan-activation: swish
[2023-07-20 16:19:18] [config] transformer-aan-depth: 2
[2023-07-20 16:19:18] [config] transformer-aan-nogate: false
[2023-07-20 16:19:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:18] [config] transformer-depth-scaling: false
[2023-07-20 16:19:18] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:18] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:18] [config] transformer-dropout: 0
[2023-07-20 16:19:18] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:18] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:18] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:18] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:18] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:18] [config] transformer-heads: 8
[2023-07-20 16:19:18] [config] transformer-no-projection: false
[2023-07-20 16:19:18] [config] transformer-pool: false
[2023-07-20 16:19:18] [config] transformer-postprocess: dan
[2023-07-20 16:19:18] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:18] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:18] [config] transformer-preprocess: ""
[2023-07-20 16:19:18] [config] transformer-tied-layers:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:18] [config] tsv: false
[2023-07-20 16:19:18] [config] tsv-fields: 0
[2023-07-20 16:19:18] [config] type: amun
[2023-07-20 16:19:18] [config] ulr: false
[2023-07-20 16:19:18] [config] ulr-dim-emb: 0
[2023-07-20 16:19:18] [config] ulr-dropout: 0
[2023-07-20 16:19:18] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:18] [config] ulr-query-vectors: ""
[2023-07-20 16:19:18] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:18] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:18] [config] unlikelihood-loss: false
[2023-07-20 16:19:18] [config] valid-freq: 50000000
[2023-07-20 16:19:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:18] [config] valid-max-length: 1000
[2023-07-20 16:19:18] [config] valid-metrics:
[2023-07-20 16:19:18] [config]   - cross-entropy
[2023-07-20 16:19:18] [config]   - translation
[2023-07-20 16:19:18] [config] valid-mini-batch: 32
[2023-07-20 16:19:18] [config] valid-reset-stalled: false
[2023-07-20 16:19:18] [config] valid-script-args:
[2023-07-20 16:19:18] [config]   []
[2023-07-20 16:19:18] [config] valid-script-path: ""
[2023-07-20 16:19:18] [config] valid-sets:
[2023-07-20 16:19:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:18] [config] vocabs:
[2023-07-20 16:19:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:18] [config] word-penalty: 0
[2023-07-20 16:19:18] [config] word-scores: false
[2023-07-20 16:19:18] [config] workspace: 5500
[2023-07-20 16:19:18] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:18] [training] Using single-device training
[2023-07-20 16:19:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:21] [marian] Running on node23.datos.cluster.uy as process 3107 with command line:
[2023-07-20 16:19:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:19:21] [config] after: 0e
[2023-07-20 16:19:21] [config] after-batches: 0
[2023-07-20 16:19:21] [config] after-epochs: 10
[2023-07-20 16:19:21] [config] all-caps-every: 0
[2023-07-20 16:19:21] [config] allow-unk: false
[2023-07-20 16:19:21] [config] authors: false
[2023-07-20 16:19:21] [config] beam-size: 12
[2023-07-20 16:19:21] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:21] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:21] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:21] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:21] [config] build-info: ""
[2023-07-20 16:19:21] [config] check-gradient-nan: false
[2023-07-20 16:19:21] [config] check-nan: false
[2023-07-20 16:19:21] [config] cite: false
[2023-07-20 16:19:21] [config] clip-norm: 1
[2023-07-20 16:19:21] [config] cost-scaling:
[2023-07-20 16:19:21] [config]   - 256.f
[2023-07-20 16:19:21] [config]   - 1000
[2023-07-20 16:19:21] [config]   - 2.f
[2023-07-20 16:19:21] [config]   - 256.f
[2023-07-20 16:19:21] [config] cost-type: ce-sum
[2023-07-20 16:19:21] [config] cpu-threads: 0
[2023-07-20 16:19:21] [config] data-threads: 8
[2023-07-20 16:19:21] [config] data-weighting: ""
[2023-07-20 16:19:21] [config] data-weighting-type: sentence
[2023-07-20 16:19:21] [config] dec-cell: gru
[2023-07-20 16:19:21] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:21] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:21] [config] dec-depth: 1
[2023-07-20 16:19:21] [config] devices:
[2023-07-20 16:19:21] [config]   - 0
[2023-07-20 16:19:21] [config] dim-emb: 512
[2023-07-20 16:19:21] [config] dim-rnn: 1024
[2023-07-20 16:19:21] [config] dim-vocabs:
[2023-07-20 16:19:21] [config]   - 16384
[2023-07-20 16:19:21] [config]   - 16384
[2023-07-20 16:19:21] [config] disp-first: 0
[2023-07-20 16:19:21] [config] disp-freq: 1000u
[2023-07-20 16:19:21] [config] disp-label-counts: true
[2023-07-20 16:19:21] [config] dropout-rnn: 0
[2023-07-20 16:19:21] [config] dropout-src: 0
[2023-07-20 16:19:21] [config] dropout-trg: 0
[2023-07-20 16:19:21] [config] dump-config: ""
[2023-07-20 16:19:21] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] early-stopping: 200
[2023-07-20 16:19:21] [config] early-stopping-on: first
[2023-07-20 16:19:21] [config] embedding-fix-src: false
[2023-07-20 16:19:21] [config] embedding-fix-trg: false
[2023-07-20 16:19:21] [config] embedding-normalization: false
[2023-07-20 16:19:21] [config] embedding-vectors:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] enc-cell: gru
[2023-07-20 16:19:21] [config] enc-cell-depth: 1
[2023-07-20 16:19:21] [config] enc-depth: 1
[2023-07-20 16:19:21] [config] enc-type: bidirectional
[2023-07-20 16:19:21] [config] english-title-case-every: 0
[2023-07-20 16:19:21] [config] exponential-smoothing: 0
[2023-07-20 16:19:21] [config] factor-weight: 1
[2023-07-20 16:19:21] [config] factors-combine: sum
[2023-07-20 16:19:21] [config] factors-dim-emb: 0
[2023-07-20 16:19:21] [config] gradient-checkpointing: false
[2023-07-20 16:19:21] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:21] [config] guided-alignment: none
[2023-07-20 16:19:21] [config] guided-alignment-cost: mse
[2023-07-20 16:19:21] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:21] [config] ignore-model-config: false
[2023-07-20 16:19:21] [config] input-types:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] interpolate-env-vars: false
[2023-07-20 16:19:21] [config] keep-best: false
[2023-07-20 16:19:21] [config] label-smoothing: 0
[2023-07-20 16:19:21] [config] layer-normalization: false
[2023-07-20 16:19:21] [config] learn-rate: 0.0001
[2023-07-20 16:19:21] [config] lemma-dependency: ""
[2023-07-20 16:19:21] [config] lemma-dim-emb: 0
[2023-07-20 16:19:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:21] [config] log-level: info
[2023-07-20 16:19:21] [config] log-time-zone: ""
[2023-07-20 16:19:21] [config] logical-epoch:
[2023-07-20 16:19:21] [config]   - 1e
[2023-07-20 16:19:21] [config]   - 0
[2023-07-20 16:19:21] [config] lr-decay: 0
[2023-07-20 16:19:21] [config] lr-decay-freq: 50000
[2023-07-20 16:19:21] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:21] [config]   - 0
[2023-07-20 16:19:21] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:21] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:21] [config] lr-decay-start:
[2023-07-20 16:19:21] [config]   - 10
[2023-07-20 16:19:21] [config]   - 1
[2023-07-20 16:19:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:21] [config] lr-report: false
[2023-07-20 16:19:21] [config] lr-warmup: 0
[2023-07-20 16:19:21] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:21] [config] lr-warmup-cycle: false
[2023-07-20 16:19:21] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:21] [config] max-length: 150
[2023-07-20 16:19:21] [config] max-length-crop: true
[2023-07-20 16:19:21] [config] max-length-factor: 3
[2023-07-20 16:19:21] [config] maxi-batch: 100
[2023-07-20 16:19:21] [config] maxi-batch-sort: trg
[2023-07-20 16:19:21] [config] mini-batch: 64
[2023-07-20 16:19:21] [config] mini-batch-fit: true
[2023-07-20 16:19:21] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:21] [config] mini-batch-round-up: true
[2023-07-20 16:19:21] [config] mini-batch-track-lr: false
[2023-07-20 16:19:21] [config] mini-batch-warmup: 0
[2023-07-20 16:19:21] [config] mini-batch-words: 0
[2023-07-20 16:19:21] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:19:21] [config] multi-loss-type: sum
[2023-07-20 16:19:21] [config] n-best: false
[2023-07-20 16:19:21] [config] no-nccl: false
[2023-07-20 16:19:21] [config] no-reload: false
[2023-07-20 16:19:21] [config] no-restore-corpus: false
[2023-07-20 16:19:21] [config] normalize: 0
[2023-07-20 16:19:21] [config] normalize-gradient: false
[2023-07-20 16:19:21] [config] num-devices: 0
[2023-07-20 16:19:21] [config] optimizer: adam
[2023-07-20 16:19:21] [config] optimizer-delay: 1
[2023-07-20 16:19:21] [config] optimizer-params:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] output-omit-bias: false
[2023-07-20 16:19:21] [config] overwrite: true
[2023-07-20 16:19:21] [config] precision:
[2023-07-20 16:19:21] [config]   - float16
[2023-07-20 16:19:21] [config]   - float32
[2023-07-20 16:19:21] [config] pretrained-model: ""
[2023-07-20 16:19:21] [config] quantize-biases: false
[2023-07-20 16:19:21] [config] quantize-bits: 0
[2023-07-20 16:19:21] [config] quantize-log-based: false
[2023-07-20 16:19:21] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:21] [config] quiet: false
[2023-07-20 16:19:21] [config] quiet-translation: true
[2023-07-20 16:19:21] [config] relative-paths: false
[2023-07-20 16:19:21] [config] right-left: false
[2023-07-20 16:19:21] [config] save-freq: 10000u
[2023-07-20 16:19:21] [config] seed: 1234
[2023-07-20 16:19:21] [config] sentencepiece-alphas:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:21] [config] sentencepiece-options: ""
[2023-07-20 16:19:21] [config] sharding: global
[2023-07-20 16:19:21] [config] shuffle: data
[2023-07-20 16:19:21] [config] shuffle-in-ram: false
[2023-07-20 16:19:21] [config] sigterm: save-and-exit
[2023-07-20 16:19:21] [config] skip: false
[2023-07-20 16:19:21] [config] sqlite: ""
[2023-07-20 16:19:21] [config] sqlite-drop: false
[2023-07-20 16:19:21] [config] sync-freq: 200u
[2023-07-20 16:19:21] [config] sync-sgd: false
[2023-07-20 16:19:21] [config] tempdir: /tmp
[2023-07-20 16:19:21] [config] tied-embeddings: false
[2023-07-20 16:19:21] [config] tied-embeddings-all: true
[2023-07-20 16:19:21] [config] tied-embeddings-src: false
[2023-07-20 16:19:21] [config] train-embedder-rank:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] train-sets:
[2023-07-20 16:19:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:21] [config] transformer-aan-activation: swish
[2023-07-20 16:19:21] [config] transformer-aan-depth: 2
[2023-07-20 16:19:21] [config] transformer-aan-nogate: false
[2023-07-20 16:19:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:21] [config] transformer-depth-scaling: false
[2023-07-20 16:19:21] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:21] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:21] [config] transformer-dropout: 0
[2023-07-20 16:19:21] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:21] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:21] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:21] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:21] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:21] [config] transformer-heads: 8
[2023-07-20 16:19:21] [config] transformer-no-projection: false
[2023-07-20 16:19:21] [config] transformer-pool: false
[2023-07-20 16:19:21] [config] transformer-postprocess: dan
[2023-07-20 16:19:21] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:21] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:21] [config] transformer-preprocess: ""
[2023-07-20 16:19:21] [config] transformer-tied-layers:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:21] [config] tsv: false
[2023-07-20 16:19:21] [config] tsv-fields: 0
[2023-07-20 16:19:21] [config] type: amun
[2023-07-20 16:19:21] [config] ulr: false
[2023-07-20 16:19:21] [config] ulr-dim-emb: 0
[2023-07-20 16:19:21] [config] ulr-dropout: 0
[2023-07-20 16:19:21] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:21] [config] ulr-query-vectors: ""
[2023-07-20 16:19:21] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:21] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:21] [config] unlikelihood-loss: false
[2023-07-20 16:19:21] [config] valid-freq: 50000000
[2023-07-20 16:19:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:21] [config] valid-max-length: 1000
[2023-07-20 16:19:21] [config] valid-metrics:
[2023-07-20 16:19:21] [config]   - cross-entropy
[2023-07-20 16:19:21] [config]   - translation
[2023-07-20 16:19:21] [config] valid-mini-batch: 32
[2023-07-20 16:19:21] [config] valid-reset-stalled: false
[2023-07-20 16:19:21] [config] valid-script-args:
[2023-07-20 16:19:21] [config]   []
[2023-07-20 16:19:21] [config] valid-script-path: ""
[2023-07-20 16:19:21] [config] valid-sets:
[2023-07-20 16:19:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:21] [config] vocabs:
[2023-07-20 16:19:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:21] [config] word-penalty: 0
[2023-07-20 16:19:21] [config] word-scores: false
[2023-07-20 16:19:21] [config] workspace: 5500
[2023-07-20 16:19:21] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:21] [training] Using single-device training
[2023-07-20 16:19:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:24] [marian] Running on node23.datos.cluster.uy as process 3203 with command line:
[2023-07-20 16:19:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:19:24] [config] after: 0e
[2023-07-20 16:19:24] [config] after-batches: 0
[2023-07-20 16:19:24] [config] after-epochs: 10
[2023-07-20 16:19:24] [config] all-caps-every: 0
[2023-07-20 16:19:24] [config] allow-unk: false
[2023-07-20 16:19:24] [config] authors: false
[2023-07-20 16:19:24] [config] beam-size: 12
[2023-07-20 16:19:24] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:24] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:24] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:24] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:24] [config] build-info: ""
[2023-07-20 16:19:24] [config] check-gradient-nan: false
[2023-07-20 16:19:24] [config] check-nan: false
[2023-07-20 16:19:24] [config] cite: false
[2023-07-20 16:19:24] [config] clip-norm: 1
[2023-07-20 16:19:24] [config] cost-scaling:
[2023-07-20 16:19:24] [config]   - 256.f
[2023-07-20 16:19:24] [config]   - 1000
[2023-07-20 16:19:24] [config]   - 2.f
[2023-07-20 16:19:24] [config]   - 256.f
[2023-07-20 16:19:24] [config] cost-type: ce-sum
[2023-07-20 16:19:24] [config] cpu-threads: 0
[2023-07-20 16:19:24] [config] data-threads: 8
[2023-07-20 16:19:24] [config] data-weighting: ""
[2023-07-20 16:19:24] [config] data-weighting-type: sentence
[2023-07-20 16:19:24] [config] dec-cell: gru
[2023-07-20 16:19:24] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:24] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:24] [config] dec-depth: 1
[2023-07-20 16:19:24] [config] devices:
[2023-07-20 16:19:24] [config]   - 0
[2023-07-20 16:19:24] [config] dim-emb: 512
[2023-07-20 16:19:24] [config] dim-rnn: 1024
[2023-07-20 16:19:24] [config] dim-vocabs:
[2023-07-20 16:19:24] [config]   - 16384
[2023-07-20 16:19:24] [config]   - 16384
[2023-07-20 16:19:24] [config] disp-first: 0
[2023-07-20 16:19:24] [config] disp-freq: 1000u
[2023-07-20 16:19:24] [config] disp-label-counts: true
[2023-07-20 16:19:24] [config] dropout-rnn: 0
[2023-07-20 16:19:24] [config] dropout-src: 0
[2023-07-20 16:19:24] [config] dropout-trg: 0
[2023-07-20 16:19:24] [config] dump-config: ""
[2023-07-20 16:19:24] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] early-stopping: 200
[2023-07-20 16:19:24] [config] early-stopping-on: first
[2023-07-20 16:19:24] [config] embedding-fix-src: false
[2023-07-20 16:19:24] [config] embedding-fix-trg: false
[2023-07-20 16:19:24] [config] embedding-normalization: false
[2023-07-20 16:19:24] [config] embedding-vectors:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] enc-cell: gru
[2023-07-20 16:19:24] [config] enc-cell-depth: 1
[2023-07-20 16:19:24] [config] enc-depth: 1
[2023-07-20 16:19:24] [config] enc-type: bidirectional
[2023-07-20 16:19:24] [config] english-title-case-every: 0
[2023-07-20 16:19:24] [config] exponential-smoothing: 0
[2023-07-20 16:19:24] [config] factor-weight: 1
[2023-07-20 16:19:24] [config] factors-combine: sum
[2023-07-20 16:19:24] [config] factors-dim-emb: 0
[2023-07-20 16:19:24] [config] gradient-checkpointing: false
[2023-07-20 16:19:24] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:24] [config] guided-alignment: none
[2023-07-20 16:19:24] [config] guided-alignment-cost: mse
[2023-07-20 16:19:24] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:24] [config] ignore-model-config: false
[2023-07-20 16:19:24] [config] input-types:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] interpolate-env-vars: false
[2023-07-20 16:19:24] [config] keep-best: false
[2023-07-20 16:19:24] [config] label-smoothing: 0
[2023-07-20 16:19:24] [config] layer-normalization: false
[2023-07-20 16:19:24] [config] learn-rate: 0.0001
[2023-07-20 16:19:24] [config] lemma-dependency: ""
[2023-07-20 16:19:24] [config] lemma-dim-emb: 0
[2023-07-20 16:19:24] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:24] [config] log-level: info
[2023-07-20 16:19:24] [config] log-time-zone: ""
[2023-07-20 16:19:24] [config] logical-epoch:
[2023-07-20 16:19:24] [config]   - 1e
[2023-07-20 16:19:24] [config]   - 0
[2023-07-20 16:19:24] [config] lr-decay: 0
[2023-07-20 16:19:24] [config] lr-decay-freq: 50000
[2023-07-20 16:19:24] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:24] [config]   - 0
[2023-07-20 16:19:24] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:24] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:24] [config] lr-decay-start:
[2023-07-20 16:19:24] [config]   - 10
[2023-07-20 16:19:24] [config]   - 1
[2023-07-20 16:19:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:24] [config] lr-report: false
[2023-07-20 16:19:24] [config] lr-warmup: 0
[2023-07-20 16:19:24] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:24] [config] lr-warmup-cycle: false
[2023-07-20 16:19:24] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:24] [config] max-length: 150
[2023-07-20 16:19:24] [config] max-length-crop: true
[2023-07-20 16:19:24] [config] max-length-factor: 3
[2023-07-20 16:19:24] [config] maxi-batch: 100
[2023-07-20 16:19:24] [config] maxi-batch-sort: trg
[2023-07-20 16:19:24] [config] mini-batch: 64
[2023-07-20 16:19:24] [config] mini-batch-fit: true
[2023-07-20 16:19:24] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:24] [config] mini-batch-round-up: true
[2023-07-20 16:19:24] [config] mini-batch-track-lr: false
[2023-07-20 16:19:24] [config] mini-batch-warmup: 0
[2023-07-20 16:19:24] [config] mini-batch-words: 0
[2023-07-20 16:19:24] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:24] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:19:24] [config] multi-loss-type: sum
[2023-07-20 16:19:24] [config] n-best: false
[2023-07-20 16:19:24] [config] no-nccl: false
[2023-07-20 16:19:24] [config] no-reload: false
[2023-07-20 16:19:24] [config] no-restore-corpus: false
[2023-07-20 16:19:24] [config] normalize: 0
[2023-07-20 16:19:24] [config] normalize-gradient: false
[2023-07-20 16:19:24] [config] num-devices: 0
[2023-07-20 16:19:24] [config] optimizer: adam
[2023-07-20 16:19:24] [config] optimizer-delay: 1
[2023-07-20 16:19:24] [config] optimizer-params:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] output-omit-bias: false
[2023-07-20 16:19:24] [config] overwrite: true
[2023-07-20 16:19:24] [config] precision:
[2023-07-20 16:19:24] [config]   - float16
[2023-07-20 16:19:24] [config]   - float32
[2023-07-20 16:19:24] [config] pretrained-model: ""
[2023-07-20 16:19:24] [config] quantize-biases: false
[2023-07-20 16:19:24] [config] quantize-bits: 0
[2023-07-20 16:19:24] [config] quantize-log-based: false
[2023-07-20 16:19:24] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:24] [config] quiet: false
[2023-07-20 16:19:24] [config] quiet-translation: true
[2023-07-20 16:19:24] [config] relative-paths: false
[2023-07-20 16:19:24] [config] right-left: false
[2023-07-20 16:19:24] [config] save-freq: 10000u
[2023-07-20 16:19:24] [config] seed: 1234
[2023-07-20 16:19:24] [config] sentencepiece-alphas:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:24] [config] sentencepiece-options: ""
[2023-07-20 16:19:24] [config] sharding: global
[2023-07-20 16:19:24] [config] shuffle: data
[2023-07-20 16:19:24] [config] shuffle-in-ram: false
[2023-07-20 16:19:24] [config] sigterm: save-and-exit
[2023-07-20 16:19:24] [config] skip: false
[2023-07-20 16:19:24] [config] sqlite: ""
[2023-07-20 16:19:24] [config] sqlite-drop: false
[2023-07-20 16:19:24] [config] sync-freq: 200u
[2023-07-20 16:19:24] [config] sync-sgd: false
[2023-07-20 16:19:24] [config] tempdir: /tmp
[2023-07-20 16:19:24] [config] tied-embeddings: false
[2023-07-20 16:19:24] [config] tied-embeddings-all: true
[2023-07-20 16:19:24] [config] tied-embeddings-src: false
[2023-07-20 16:19:24] [config] train-embedder-rank:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] train-sets:
[2023-07-20 16:19:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:24] [config] transformer-aan-activation: swish
[2023-07-20 16:19:24] [config] transformer-aan-depth: 2
[2023-07-20 16:19:24] [config] transformer-aan-nogate: false
[2023-07-20 16:19:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:24] [config] transformer-depth-scaling: false
[2023-07-20 16:19:24] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:24] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:24] [config] transformer-dropout: 0
[2023-07-20 16:19:24] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:24] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:24] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:24] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:24] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:24] [config] transformer-heads: 8
[2023-07-20 16:19:24] [config] transformer-no-projection: false
[2023-07-20 16:19:24] [config] transformer-pool: false
[2023-07-20 16:19:24] [config] transformer-postprocess: dan
[2023-07-20 16:19:24] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:24] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:24] [config] transformer-preprocess: ""
[2023-07-20 16:19:24] [config] transformer-tied-layers:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:24] [config] tsv: false
[2023-07-20 16:19:24] [config] tsv-fields: 0
[2023-07-20 16:19:24] [config] type: amun
[2023-07-20 16:19:24] [config] ulr: false
[2023-07-20 16:19:24] [config] ulr-dim-emb: 0
[2023-07-20 16:19:24] [config] ulr-dropout: 0
[2023-07-20 16:19:24] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:24] [config] ulr-query-vectors: ""
[2023-07-20 16:19:24] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:24] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:24] [config] unlikelihood-loss: false
[2023-07-20 16:19:24] [config] valid-freq: 50000000
[2023-07-20 16:19:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:24] [config] valid-max-length: 1000
[2023-07-20 16:19:24] [config] valid-metrics:
[2023-07-20 16:19:24] [config]   - cross-entropy
[2023-07-20 16:19:24] [config]   - translation
[2023-07-20 16:19:24] [config] valid-mini-batch: 32
[2023-07-20 16:19:24] [config] valid-reset-stalled: false
[2023-07-20 16:19:24] [config] valid-script-args:
[2023-07-20 16:19:24] [config]   []
[2023-07-20 16:19:24] [config] valid-script-path: ""
[2023-07-20 16:19:24] [config] valid-sets:
[2023-07-20 16:19:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:24] [config] vocabs:
[2023-07-20 16:19:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:24] [config] word-penalty: 0
[2023-07-20 16:19:24] [config] word-scores: false
[2023-07-20 16:19:24] [config] workspace: 5500
[2023-07-20 16:19:24] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:24] [training] Using single-device training
[2023-07-20 16:19:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:27] [marian] Running on node23.datos.cluster.uy as process 3299 with command line:
[2023-07-20 16:19:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:19:27] [config] after: 0e
[2023-07-20 16:19:27] [config] after-batches: 0
[2023-07-20 16:19:27] [config] after-epochs: 10
[2023-07-20 16:19:27] [config] all-caps-every: 0
[2023-07-20 16:19:27] [config] allow-unk: false
[2023-07-20 16:19:27] [config] authors: false
[2023-07-20 16:19:27] [config] beam-size: 12
[2023-07-20 16:19:27] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:27] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:27] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:27] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:27] [config] build-info: ""
[2023-07-20 16:19:27] [config] check-gradient-nan: false
[2023-07-20 16:19:27] [config] check-nan: false
[2023-07-20 16:19:27] [config] cite: false
[2023-07-20 16:19:27] [config] clip-norm: 1
[2023-07-20 16:19:27] [config] cost-scaling:
[2023-07-20 16:19:27] [config]   - 256.f
[2023-07-20 16:19:27] [config]   - 1000
[2023-07-20 16:19:27] [config]   - 2.f
[2023-07-20 16:19:27] [config]   - 256.f
[2023-07-20 16:19:27] [config] cost-type: ce-sum
[2023-07-20 16:19:27] [config] cpu-threads: 0
[2023-07-20 16:19:27] [config] data-threads: 8
[2023-07-20 16:19:27] [config] data-weighting: ""
[2023-07-20 16:19:27] [config] data-weighting-type: sentence
[2023-07-20 16:19:27] [config] dec-cell: gru
[2023-07-20 16:19:27] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:27] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:27] [config] dec-depth: 1
[2023-07-20 16:19:27] [config] devices:
[2023-07-20 16:19:27] [config]   - 0
[2023-07-20 16:19:27] [config] dim-emb: 512
[2023-07-20 16:19:27] [config] dim-rnn: 1024
[2023-07-20 16:19:27] [config] dim-vocabs:
[2023-07-20 16:19:27] [config]   - 16384
[2023-07-20 16:19:27] [config]   - 16384
[2023-07-20 16:19:27] [config] disp-first: 0
[2023-07-20 16:19:27] [config] disp-freq: 1000u
[2023-07-20 16:19:27] [config] disp-label-counts: true
[2023-07-20 16:19:27] [config] dropout-rnn: 0
[2023-07-20 16:19:27] [config] dropout-src: 0
[2023-07-20 16:19:27] [config] dropout-trg: 0
[2023-07-20 16:19:27] [config] dump-config: ""
[2023-07-20 16:19:27] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] early-stopping: 200
[2023-07-20 16:19:27] [config] early-stopping-on: first
[2023-07-20 16:19:27] [config] embedding-fix-src: false
[2023-07-20 16:19:27] [config] embedding-fix-trg: false
[2023-07-20 16:19:27] [config] embedding-normalization: false
[2023-07-20 16:19:27] [config] embedding-vectors:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] enc-cell: gru
[2023-07-20 16:19:27] [config] enc-cell-depth: 1
[2023-07-20 16:19:27] [config] enc-depth: 1
[2023-07-20 16:19:27] [config] enc-type: bidirectional
[2023-07-20 16:19:27] [config] english-title-case-every: 0
[2023-07-20 16:19:27] [config] exponential-smoothing: 0
[2023-07-20 16:19:27] [config] factor-weight: 1
[2023-07-20 16:19:27] [config] factors-combine: sum
[2023-07-20 16:19:27] [config] factors-dim-emb: 0
[2023-07-20 16:19:27] [config] gradient-checkpointing: false
[2023-07-20 16:19:27] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:27] [config] guided-alignment: none
[2023-07-20 16:19:27] [config] guided-alignment-cost: mse
[2023-07-20 16:19:27] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:27] [config] ignore-model-config: false
[2023-07-20 16:19:27] [config] input-types:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] interpolate-env-vars: false
[2023-07-20 16:19:27] [config] keep-best: false
[2023-07-20 16:19:27] [config] label-smoothing: 0
[2023-07-20 16:19:27] [config] layer-normalization: false
[2023-07-20 16:19:27] [config] learn-rate: 0.0001
[2023-07-20 16:19:27] [config] lemma-dependency: ""
[2023-07-20 16:19:27] [config] lemma-dim-emb: 0
[2023-07-20 16:19:27] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:27] [config] log-level: info
[2023-07-20 16:19:27] [config] log-time-zone: ""
[2023-07-20 16:19:27] [config] logical-epoch:
[2023-07-20 16:19:27] [config]   - 1e
[2023-07-20 16:19:27] [config]   - 0
[2023-07-20 16:19:27] [config] lr-decay: 0
[2023-07-20 16:19:27] [config] lr-decay-freq: 50000
[2023-07-20 16:19:27] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:27] [config]   - 0
[2023-07-20 16:19:27] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:27] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:27] [config] lr-decay-start:
[2023-07-20 16:19:27] [config]   - 10
[2023-07-20 16:19:27] [config]   - 1
[2023-07-20 16:19:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:27] [config] lr-report: false
[2023-07-20 16:19:27] [config] lr-warmup: 0
[2023-07-20 16:19:27] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:27] [config] lr-warmup-cycle: false
[2023-07-20 16:19:27] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:27] [config] max-length: 150
[2023-07-20 16:19:27] [config] max-length-crop: true
[2023-07-20 16:19:27] [config] max-length-factor: 3
[2023-07-20 16:19:27] [config] maxi-batch: 100
[2023-07-20 16:19:27] [config] maxi-batch-sort: trg
[2023-07-20 16:19:27] [config] mini-batch: 64
[2023-07-20 16:19:27] [config] mini-batch-fit: true
[2023-07-20 16:19:27] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:27] [config] mini-batch-round-up: true
[2023-07-20 16:19:27] [config] mini-batch-track-lr: false
[2023-07-20 16:19:27] [config] mini-batch-warmup: 0
[2023-07-20 16:19:27] [config] mini-batch-words: 0
[2023-07-20 16:19:27] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:27] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:19:27] [config] multi-loss-type: sum
[2023-07-20 16:19:27] [config] n-best: false
[2023-07-20 16:19:27] [config] no-nccl: false
[2023-07-20 16:19:27] [config] no-reload: false
[2023-07-20 16:19:27] [config] no-restore-corpus: false
[2023-07-20 16:19:27] [config] normalize: 0
[2023-07-20 16:19:27] [config] normalize-gradient: false
[2023-07-20 16:19:27] [config] num-devices: 0
[2023-07-20 16:19:27] [config] optimizer: adam
[2023-07-20 16:19:27] [config] optimizer-delay: 1
[2023-07-20 16:19:27] [config] optimizer-params:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] output-omit-bias: false
[2023-07-20 16:19:27] [config] overwrite: true
[2023-07-20 16:19:27] [config] precision:
[2023-07-20 16:19:27] [config]   - float16
[2023-07-20 16:19:27] [config]   - float32
[2023-07-20 16:19:27] [config] pretrained-model: ""
[2023-07-20 16:19:27] [config] quantize-biases: false
[2023-07-20 16:19:27] [config] quantize-bits: 0
[2023-07-20 16:19:27] [config] quantize-log-based: false
[2023-07-20 16:19:27] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:27] [config] quiet: false
[2023-07-20 16:19:27] [config] quiet-translation: true
[2023-07-20 16:19:27] [config] relative-paths: false
[2023-07-20 16:19:27] [config] right-left: false
[2023-07-20 16:19:27] [config] save-freq: 10000u
[2023-07-20 16:19:27] [config] seed: 1234
[2023-07-20 16:19:27] [config] sentencepiece-alphas:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:27] [config] sentencepiece-options: ""
[2023-07-20 16:19:27] [config] sharding: global
[2023-07-20 16:19:27] [config] shuffle: data
[2023-07-20 16:19:27] [config] shuffle-in-ram: false
[2023-07-20 16:19:27] [config] sigterm: save-and-exit
[2023-07-20 16:19:27] [config] skip: false
[2023-07-20 16:19:27] [config] sqlite: ""
[2023-07-20 16:19:27] [config] sqlite-drop: false
[2023-07-20 16:19:27] [config] sync-freq: 200u
[2023-07-20 16:19:27] [config] sync-sgd: false
[2023-07-20 16:19:27] [config] tempdir: /tmp
[2023-07-20 16:19:27] [config] tied-embeddings: false
[2023-07-20 16:19:27] [config] tied-embeddings-all: true
[2023-07-20 16:19:27] [config] tied-embeddings-src: false
[2023-07-20 16:19:27] [config] train-embedder-rank:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] train-sets:
[2023-07-20 16:19:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:27] [config] transformer-aan-activation: swish
[2023-07-20 16:19:27] [config] transformer-aan-depth: 2
[2023-07-20 16:19:27] [config] transformer-aan-nogate: false
[2023-07-20 16:19:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:27] [config] transformer-depth-scaling: false
[2023-07-20 16:19:27] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:27] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:27] [config] transformer-dropout: 0
[2023-07-20 16:19:27] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:27] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:27] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:27] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:27] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:27] [config] transformer-heads: 8
[2023-07-20 16:19:27] [config] transformer-no-projection: false
[2023-07-20 16:19:27] [config] transformer-pool: false
[2023-07-20 16:19:27] [config] transformer-postprocess: dan
[2023-07-20 16:19:27] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:27] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:27] [config] transformer-preprocess: ""
[2023-07-20 16:19:27] [config] transformer-tied-layers:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:27] [config] tsv: false
[2023-07-20 16:19:27] [config] tsv-fields: 0
[2023-07-20 16:19:27] [config] type: amun
[2023-07-20 16:19:27] [config] ulr: false
[2023-07-20 16:19:27] [config] ulr-dim-emb: 0
[2023-07-20 16:19:27] [config] ulr-dropout: 0
[2023-07-20 16:19:27] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:27] [config] ulr-query-vectors: ""
[2023-07-20 16:19:27] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:27] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:27] [config] unlikelihood-loss: false
[2023-07-20 16:19:27] [config] valid-freq: 50000000
[2023-07-20 16:19:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:27] [config] valid-max-length: 1000
[2023-07-20 16:19:27] [config] valid-metrics:
[2023-07-20 16:19:27] [config]   - cross-entropy
[2023-07-20 16:19:27] [config]   - translation
[2023-07-20 16:19:27] [config] valid-mini-batch: 32
[2023-07-20 16:19:27] [config] valid-reset-stalled: false
[2023-07-20 16:19:27] [config] valid-script-args:
[2023-07-20 16:19:27] [config]   []
[2023-07-20 16:19:27] [config] valid-script-path: ""
[2023-07-20 16:19:27] [config] valid-sets:
[2023-07-20 16:19:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:27] [config] vocabs:
[2023-07-20 16:19:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:27] [config] word-penalty: 0
[2023-07-20 16:19:27] [config] word-scores: false
[2023-07-20 16:19:27] [config] workspace: 5500
[2023-07-20 16:19:27] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:27] [training] Using single-device training
[2023-07-20 16:19:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:30] [marian] Running on node23.datos.cluster.uy as process 3392 with command line:
[2023-07-20 16:19:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:19:30] [config] after: 0e
[2023-07-20 16:19:30] [config] after-batches: 0
[2023-07-20 16:19:30] [config] after-epochs: 10
[2023-07-20 16:19:30] [config] all-caps-every: 0
[2023-07-20 16:19:30] [config] allow-unk: false
[2023-07-20 16:19:30] [config] authors: false
[2023-07-20 16:19:30] [config] beam-size: 12
[2023-07-20 16:19:30] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:30] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:30] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:30] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:30] [config] build-info: ""
[2023-07-20 16:19:30] [config] check-gradient-nan: false
[2023-07-20 16:19:30] [config] check-nan: false
[2023-07-20 16:19:30] [config] cite: false
[2023-07-20 16:19:30] [config] clip-norm: 1
[2023-07-20 16:19:30] [config] cost-scaling:
[2023-07-20 16:19:30] [config]   - 256.f
[2023-07-20 16:19:30] [config]   - 1000
[2023-07-20 16:19:30] [config]   - 2.f
[2023-07-20 16:19:30] [config]   - 256.f
[2023-07-20 16:19:30] [config] cost-type: ce-sum
[2023-07-20 16:19:30] [config] cpu-threads: 0
[2023-07-20 16:19:30] [config] data-threads: 8
[2023-07-20 16:19:30] [config] data-weighting: ""
[2023-07-20 16:19:30] [config] data-weighting-type: sentence
[2023-07-20 16:19:30] [config] dec-cell: gru
[2023-07-20 16:19:30] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:30] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:30] [config] dec-depth: 1
[2023-07-20 16:19:30] [config] devices:
[2023-07-20 16:19:30] [config]   - 0
[2023-07-20 16:19:30] [config] dim-emb: 512
[2023-07-20 16:19:30] [config] dim-rnn: 1024
[2023-07-20 16:19:30] [config] dim-vocabs:
[2023-07-20 16:19:30] [config]   - 16384
[2023-07-20 16:19:30] [config]   - 16384
[2023-07-20 16:19:30] [config] disp-first: 0
[2023-07-20 16:19:30] [config] disp-freq: 1000u
[2023-07-20 16:19:30] [config] disp-label-counts: true
[2023-07-20 16:19:30] [config] dropout-rnn: 0
[2023-07-20 16:19:30] [config] dropout-src: 0
[2023-07-20 16:19:30] [config] dropout-trg: 0
[2023-07-20 16:19:30] [config] dump-config: ""
[2023-07-20 16:19:30] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] early-stopping: 200
[2023-07-20 16:19:30] [config] early-stopping-on: first
[2023-07-20 16:19:30] [config] embedding-fix-src: false
[2023-07-20 16:19:30] [config] embedding-fix-trg: false
[2023-07-20 16:19:30] [config] embedding-normalization: false
[2023-07-20 16:19:30] [config] embedding-vectors:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] enc-cell: gru
[2023-07-20 16:19:30] [config] enc-cell-depth: 1
[2023-07-20 16:19:30] [config] enc-depth: 1
[2023-07-20 16:19:30] [config] enc-type: bidirectional
[2023-07-20 16:19:30] [config] english-title-case-every: 0
[2023-07-20 16:19:30] [config] exponential-smoothing: 0
[2023-07-20 16:19:30] [config] factor-weight: 1
[2023-07-20 16:19:30] [config] factors-combine: sum
[2023-07-20 16:19:30] [config] factors-dim-emb: 0
[2023-07-20 16:19:30] [config] gradient-checkpointing: false
[2023-07-20 16:19:30] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:30] [config] guided-alignment: none
[2023-07-20 16:19:30] [config] guided-alignment-cost: mse
[2023-07-20 16:19:30] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:30] [config] ignore-model-config: false
[2023-07-20 16:19:30] [config] input-types:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] interpolate-env-vars: false
[2023-07-20 16:19:30] [config] keep-best: false
[2023-07-20 16:19:30] [config] label-smoothing: 0
[2023-07-20 16:19:30] [config] layer-normalization: false
[2023-07-20 16:19:30] [config] learn-rate: 0.0001
[2023-07-20 16:19:30] [config] lemma-dependency: ""
[2023-07-20 16:19:30] [config] lemma-dim-emb: 0
[2023-07-20 16:19:30] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:30] [config] log-level: info
[2023-07-20 16:19:30] [config] log-time-zone: ""
[2023-07-20 16:19:30] [config] logical-epoch:
[2023-07-20 16:19:30] [config]   - 1e
[2023-07-20 16:19:30] [config]   - 0
[2023-07-20 16:19:30] [config] lr-decay: 0
[2023-07-20 16:19:30] [config] lr-decay-freq: 50000
[2023-07-20 16:19:30] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:30] [config]   - 0
[2023-07-20 16:19:30] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:30] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:30] [config] lr-decay-start:
[2023-07-20 16:19:30] [config]   - 10
[2023-07-20 16:19:30] [config]   - 1
[2023-07-20 16:19:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:30] [config] lr-report: false
[2023-07-20 16:19:30] [config] lr-warmup: 0
[2023-07-20 16:19:30] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:30] [config] lr-warmup-cycle: false
[2023-07-20 16:19:30] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:30] [config] max-length: 150
[2023-07-20 16:19:30] [config] max-length-crop: true
[2023-07-20 16:19:30] [config] max-length-factor: 3
[2023-07-20 16:19:30] [config] maxi-batch: 100
[2023-07-20 16:19:30] [config] maxi-batch-sort: trg
[2023-07-20 16:19:30] [config] mini-batch: 64
[2023-07-20 16:19:30] [config] mini-batch-fit: true
[2023-07-20 16:19:30] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:30] [config] mini-batch-round-up: true
[2023-07-20 16:19:30] [config] mini-batch-track-lr: false
[2023-07-20 16:19:30] [config] mini-batch-warmup: 0
[2023-07-20 16:19:30] [config] mini-batch-words: 0
[2023-07-20 16:19:30] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:30] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:19:30] [config] multi-loss-type: sum
[2023-07-20 16:19:30] [config] n-best: false
[2023-07-20 16:19:30] [config] no-nccl: false
[2023-07-20 16:19:30] [config] no-reload: false
[2023-07-20 16:19:30] [config] no-restore-corpus: false
[2023-07-20 16:19:30] [config] normalize: 0
[2023-07-20 16:19:30] [config] normalize-gradient: false
[2023-07-20 16:19:30] [config] num-devices: 0
[2023-07-20 16:19:30] [config] optimizer: adam
[2023-07-20 16:19:30] [config] optimizer-delay: 1
[2023-07-20 16:19:30] [config] optimizer-params:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] output-omit-bias: false
[2023-07-20 16:19:30] [config] overwrite: true
[2023-07-20 16:19:30] [config] precision:
[2023-07-20 16:19:30] [config]   - float16
[2023-07-20 16:19:30] [config]   - float32
[2023-07-20 16:19:30] [config] pretrained-model: ""
[2023-07-20 16:19:30] [config] quantize-biases: false
[2023-07-20 16:19:30] [config] quantize-bits: 0
[2023-07-20 16:19:30] [config] quantize-log-based: false
[2023-07-20 16:19:30] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:30] [config] quiet: false
[2023-07-20 16:19:30] [config] quiet-translation: true
[2023-07-20 16:19:30] [config] relative-paths: false
[2023-07-20 16:19:30] [config] right-left: false
[2023-07-20 16:19:30] [config] save-freq: 10000u
[2023-07-20 16:19:30] [config] seed: 1234
[2023-07-20 16:19:30] [config] sentencepiece-alphas:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:30] [config] sentencepiece-options: ""
[2023-07-20 16:19:30] [config] sharding: global
[2023-07-20 16:19:30] [config] shuffle: data
[2023-07-20 16:19:30] [config] shuffle-in-ram: false
[2023-07-20 16:19:30] [config] sigterm: save-and-exit
[2023-07-20 16:19:30] [config] skip: false
[2023-07-20 16:19:30] [config] sqlite: ""
[2023-07-20 16:19:30] [config] sqlite-drop: false
[2023-07-20 16:19:30] [config] sync-freq: 200u
[2023-07-20 16:19:30] [config] sync-sgd: false
[2023-07-20 16:19:30] [config] tempdir: /tmp
[2023-07-20 16:19:30] [config] tied-embeddings: false
[2023-07-20 16:19:30] [config] tied-embeddings-all: true
[2023-07-20 16:19:30] [config] tied-embeddings-src: false
[2023-07-20 16:19:30] [config] train-embedder-rank:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] train-sets:
[2023-07-20 16:19:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:30] [config] transformer-aan-activation: swish
[2023-07-20 16:19:30] [config] transformer-aan-depth: 2
[2023-07-20 16:19:30] [config] transformer-aan-nogate: false
[2023-07-20 16:19:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:30] [config] transformer-depth-scaling: false
[2023-07-20 16:19:30] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:30] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:30] [config] transformer-dropout: 0
[2023-07-20 16:19:30] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:30] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:30] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:30] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:30] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:30] [config] transformer-heads: 8
[2023-07-20 16:19:30] [config] transformer-no-projection: false
[2023-07-20 16:19:30] [config] transformer-pool: false
[2023-07-20 16:19:30] [config] transformer-postprocess: dan
[2023-07-20 16:19:30] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:30] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:30] [config] transformer-preprocess: ""
[2023-07-20 16:19:30] [config] transformer-tied-layers:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:30] [config] tsv: false
[2023-07-20 16:19:30] [config] tsv-fields: 0
[2023-07-20 16:19:30] [config] type: amun
[2023-07-20 16:19:30] [config] ulr: false
[2023-07-20 16:19:30] [config] ulr-dim-emb: 0
[2023-07-20 16:19:30] [config] ulr-dropout: 0
[2023-07-20 16:19:30] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:30] [config] ulr-query-vectors: ""
[2023-07-20 16:19:30] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:30] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:30] [config] unlikelihood-loss: false
[2023-07-20 16:19:30] [config] valid-freq: 50000000
[2023-07-20 16:19:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:30] [config] valid-max-length: 1000
[2023-07-20 16:19:30] [config] valid-metrics:
[2023-07-20 16:19:30] [config]   - cross-entropy
[2023-07-20 16:19:30] [config]   - translation
[2023-07-20 16:19:30] [config] valid-mini-batch: 32
[2023-07-20 16:19:30] [config] valid-reset-stalled: false
[2023-07-20 16:19:30] [config] valid-script-args:
[2023-07-20 16:19:30] [config]   []
[2023-07-20 16:19:30] [config] valid-script-path: ""
[2023-07-20 16:19:30] [config] valid-sets:
[2023-07-20 16:19:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:30] [config] vocabs:
[2023-07-20 16:19:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:30] [config] word-penalty: 0
[2023-07-20 16:19:30] [config] word-scores: false
[2023-07-20 16:19:30] [config] workspace: 5500
[2023-07-20 16:19:30] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:30] [training] Using single-device training
[2023-07-20 16:19:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:32] [marian] Running on node23.datos.cluster.uy as process 3482 with command line:
[2023-07-20 16:19:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:19:32] [config] after: 0e
[2023-07-20 16:19:32] [config] after-batches: 0
[2023-07-20 16:19:32] [config] after-epochs: 10
[2023-07-20 16:19:32] [config] all-caps-every: 0
[2023-07-20 16:19:32] [config] allow-unk: false
[2023-07-20 16:19:32] [config] authors: false
[2023-07-20 16:19:32] [config] beam-size: 12
[2023-07-20 16:19:32] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:32] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:32] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:32] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:32] [config] build-info: ""
[2023-07-20 16:19:32] [config] check-gradient-nan: false
[2023-07-20 16:19:32] [config] check-nan: false
[2023-07-20 16:19:32] [config] cite: false
[2023-07-20 16:19:32] [config] clip-norm: 1
[2023-07-20 16:19:32] [config] cost-scaling:
[2023-07-20 16:19:32] [config]   - 256.f
[2023-07-20 16:19:32] [config]   - 1000
[2023-07-20 16:19:32] [config]   - 2.f
[2023-07-20 16:19:32] [config]   - 256.f
[2023-07-20 16:19:32] [config] cost-type: ce-sum
[2023-07-20 16:19:32] [config] cpu-threads: 0
[2023-07-20 16:19:32] [config] data-threads: 8
[2023-07-20 16:19:32] [config] data-weighting: ""
[2023-07-20 16:19:32] [config] data-weighting-type: sentence
[2023-07-20 16:19:32] [config] dec-cell: gru
[2023-07-20 16:19:32] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:32] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:32] [config] dec-depth: 1
[2023-07-20 16:19:32] [config] devices:
[2023-07-20 16:19:32] [config]   - 0
[2023-07-20 16:19:32] [config] dim-emb: 512
[2023-07-20 16:19:32] [config] dim-rnn: 1024
[2023-07-20 16:19:32] [config] dim-vocabs:
[2023-07-20 16:19:32] [config]   - 16384
[2023-07-20 16:19:32] [config]   - 16384
[2023-07-20 16:19:32] [config] disp-first: 0
[2023-07-20 16:19:32] [config] disp-freq: 1000u
[2023-07-20 16:19:32] [config] disp-label-counts: true
[2023-07-20 16:19:32] [config] dropout-rnn: 0
[2023-07-20 16:19:32] [config] dropout-src: 0
[2023-07-20 16:19:32] [config] dropout-trg: 0
[2023-07-20 16:19:32] [config] dump-config: ""
[2023-07-20 16:19:32] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] early-stopping: 200
[2023-07-20 16:19:32] [config] early-stopping-on: first
[2023-07-20 16:19:32] [config] embedding-fix-src: false
[2023-07-20 16:19:32] [config] embedding-fix-trg: false
[2023-07-20 16:19:32] [config] embedding-normalization: false
[2023-07-20 16:19:32] [config] embedding-vectors:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] enc-cell: gru
[2023-07-20 16:19:32] [config] enc-cell-depth: 1
[2023-07-20 16:19:32] [config] enc-depth: 1
[2023-07-20 16:19:32] [config] enc-type: bidirectional
[2023-07-20 16:19:32] [config] english-title-case-every: 0
[2023-07-20 16:19:32] [config] exponential-smoothing: 0
[2023-07-20 16:19:32] [config] factor-weight: 1
[2023-07-20 16:19:32] [config] factors-combine: sum
[2023-07-20 16:19:32] [config] factors-dim-emb: 0
[2023-07-20 16:19:32] [config] gradient-checkpointing: false
[2023-07-20 16:19:32] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:32] [config] guided-alignment: none
[2023-07-20 16:19:32] [config] guided-alignment-cost: mse
[2023-07-20 16:19:32] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:32] [config] ignore-model-config: false
[2023-07-20 16:19:32] [config] input-types:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] interpolate-env-vars: false
[2023-07-20 16:19:32] [config] keep-best: false
[2023-07-20 16:19:32] [config] label-smoothing: 0
[2023-07-20 16:19:32] [config] layer-normalization: false
[2023-07-20 16:19:32] [config] learn-rate: 0.0001
[2023-07-20 16:19:32] [config] lemma-dependency: ""
[2023-07-20 16:19:32] [config] lemma-dim-emb: 0
[2023-07-20 16:19:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:32] [config] log-level: info
[2023-07-20 16:19:32] [config] log-time-zone: ""
[2023-07-20 16:19:32] [config] logical-epoch:
[2023-07-20 16:19:32] [config]   - 1e
[2023-07-20 16:19:32] [config]   - 0
[2023-07-20 16:19:32] [config] lr-decay: 0
[2023-07-20 16:19:32] [config] lr-decay-freq: 50000
[2023-07-20 16:19:32] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:32] [config]   - 0
[2023-07-20 16:19:32] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:32] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:32] [config] lr-decay-start:
[2023-07-20 16:19:32] [config]   - 10
[2023-07-20 16:19:32] [config]   - 1
[2023-07-20 16:19:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:32] [config] lr-report: false
[2023-07-20 16:19:32] [config] lr-warmup: 0
[2023-07-20 16:19:32] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:32] [config] lr-warmup-cycle: false
[2023-07-20 16:19:32] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:32] [config] max-length: 150
[2023-07-20 16:19:32] [config] max-length-crop: true
[2023-07-20 16:19:32] [config] max-length-factor: 3
[2023-07-20 16:19:32] [config] maxi-batch: 100
[2023-07-20 16:19:32] [config] maxi-batch-sort: trg
[2023-07-20 16:19:32] [config] mini-batch: 64
[2023-07-20 16:19:32] [config] mini-batch-fit: true
[2023-07-20 16:19:32] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:32] [config] mini-batch-round-up: true
[2023-07-20 16:19:32] [config] mini-batch-track-lr: false
[2023-07-20 16:19:32] [config] mini-batch-warmup: 0
[2023-07-20 16:19:32] [config] mini-batch-words: 0
[2023-07-20 16:19:32] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:19:32] [config] multi-loss-type: sum
[2023-07-20 16:19:32] [config] n-best: false
[2023-07-20 16:19:32] [config] no-nccl: false
[2023-07-20 16:19:32] [config] no-reload: false
[2023-07-20 16:19:32] [config] no-restore-corpus: false
[2023-07-20 16:19:32] [config] normalize: 0
[2023-07-20 16:19:32] [config] normalize-gradient: false
[2023-07-20 16:19:32] [config] num-devices: 0
[2023-07-20 16:19:32] [config] optimizer: adam
[2023-07-20 16:19:32] [config] optimizer-delay: 1
[2023-07-20 16:19:32] [config] optimizer-params:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] output-omit-bias: false
[2023-07-20 16:19:32] [config] overwrite: true
[2023-07-20 16:19:32] [config] precision:
[2023-07-20 16:19:32] [config]   - float16
[2023-07-20 16:19:32] [config]   - float32
[2023-07-20 16:19:32] [config] pretrained-model: ""
[2023-07-20 16:19:32] [config] quantize-biases: false
[2023-07-20 16:19:32] [config] quantize-bits: 0
[2023-07-20 16:19:32] [config] quantize-log-based: false
[2023-07-20 16:19:32] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:32] [config] quiet: false
[2023-07-20 16:19:32] [config] quiet-translation: true
[2023-07-20 16:19:32] [config] relative-paths: false
[2023-07-20 16:19:32] [config] right-left: false
[2023-07-20 16:19:32] [config] save-freq: 10000u
[2023-07-20 16:19:32] [config] seed: 1234
[2023-07-20 16:19:32] [config] sentencepiece-alphas:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:32] [config] sentencepiece-options: ""
[2023-07-20 16:19:32] [config] sharding: global
[2023-07-20 16:19:32] [config] shuffle: data
[2023-07-20 16:19:32] [config] shuffle-in-ram: false
[2023-07-20 16:19:32] [config] sigterm: save-and-exit
[2023-07-20 16:19:32] [config] skip: false
[2023-07-20 16:19:32] [config] sqlite: ""
[2023-07-20 16:19:32] [config] sqlite-drop: false
[2023-07-20 16:19:32] [config] sync-freq: 200u
[2023-07-20 16:19:32] [config] sync-sgd: false
[2023-07-20 16:19:32] [config] tempdir: /tmp
[2023-07-20 16:19:32] [config] tied-embeddings: false
[2023-07-20 16:19:32] [config] tied-embeddings-all: true
[2023-07-20 16:19:32] [config] tied-embeddings-src: false
[2023-07-20 16:19:32] [config] train-embedder-rank:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] train-sets:
[2023-07-20 16:19:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:32] [config] transformer-aan-activation: swish
[2023-07-20 16:19:32] [config] transformer-aan-depth: 2
[2023-07-20 16:19:32] [config] transformer-aan-nogate: false
[2023-07-20 16:19:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:32] [config] transformer-depth-scaling: false
[2023-07-20 16:19:32] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:32] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:32] [config] transformer-dropout: 0
[2023-07-20 16:19:32] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:32] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:32] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:32] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:32] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:32] [config] transformer-heads: 8
[2023-07-20 16:19:32] [config] transformer-no-projection: false
[2023-07-20 16:19:32] [config] transformer-pool: false
[2023-07-20 16:19:32] [config] transformer-postprocess: dan
[2023-07-20 16:19:32] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:32] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:32] [config] transformer-preprocess: ""
[2023-07-20 16:19:32] [config] transformer-tied-layers:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:32] [config] tsv: false
[2023-07-20 16:19:32] [config] tsv-fields: 0
[2023-07-20 16:19:32] [config] type: amun
[2023-07-20 16:19:32] [config] ulr: false
[2023-07-20 16:19:32] [config] ulr-dim-emb: 0
[2023-07-20 16:19:32] [config] ulr-dropout: 0
[2023-07-20 16:19:32] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:32] [config] ulr-query-vectors: ""
[2023-07-20 16:19:32] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:32] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:32] [config] unlikelihood-loss: false
[2023-07-20 16:19:32] [config] valid-freq: 50000000
[2023-07-20 16:19:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:32] [config] valid-max-length: 1000
[2023-07-20 16:19:32] [config] valid-metrics:
[2023-07-20 16:19:32] [config]   - cross-entropy
[2023-07-20 16:19:32] [config]   - translation
[2023-07-20 16:19:32] [config] valid-mini-batch: 32
[2023-07-20 16:19:32] [config] valid-reset-stalled: false
[2023-07-20 16:19:32] [config] valid-script-args:
[2023-07-20 16:19:32] [config]   []
[2023-07-20 16:19:32] [config] valid-script-path: ""
[2023-07-20 16:19:32] [config] valid-sets:
[2023-07-20 16:19:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:32] [config] vocabs:
[2023-07-20 16:19:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:32] [config] word-penalty: 0
[2023-07-20 16:19:32] [config] word-scores: false
[2023-07-20 16:19:32] [config] workspace: 5500
[2023-07-20 16:19:32] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:32] [training] Using single-device training
[2023-07-20 16:19:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:45] [marian] Running on node23.datos.cluster.uy as process 3586 with command line:
[2023-07-20 16:19:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:19:45] [config] after: 0e
[2023-07-20 16:19:45] [config] after-batches: 0
[2023-07-20 16:19:45] [config] after-epochs: 10
[2023-07-20 16:19:45] [config] all-caps-every: 0
[2023-07-20 16:19:45] [config] allow-unk: false
[2023-07-20 16:19:45] [config] authors: false
[2023-07-20 16:19:45] [config] beam-size: 12
[2023-07-20 16:19:45] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:19:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:19:45] [config] bert-masking-fraction: 0.15
[2023-07-20 16:19:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:19:45] [config] bert-train-type-embeddings: true
[2023-07-20 16:19:45] [config] bert-type-vocab-size: 2
[2023-07-20 16:19:45] [config] build-info: ""
[2023-07-20 16:19:45] [config] check-gradient-nan: false
[2023-07-20 16:19:45] [config] check-nan: false
[2023-07-20 16:19:45] [config] cite: false
[2023-07-20 16:19:45] [config] clip-norm: 1
[2023-07-20 16:19:45] [config] cost-scaling:
[2023-07-20 16:19:45] [config]   - 256.f
[2023-07-20 16:19:45] [config]   - 1000
[2023-07-20 16:19:45] [config]   - 2.f
[2023-07-20 16:19:45] [config]   - 256.f
[2023-07-20 16:19:45] [config] cost-type: ce-sum
[2023-07-20 16:19:45] [config] cpu-threads: 0
[2023-07-20 16:19:45] [config] data-threads: 8
[2023-07-20 16:19:45] [config] data-weighting: ""
[2023-07-20 16:19:45] [config] data-weighting-type: sentence
[2023-07-20 16:19:45] [config] dec-cell: gru
[2023-07-20 16:19:45] [config] dec-cell-base-depth: 2
[2023-07-20 16:19:45] [config] dec-cell-high-depth: 1
[2023-07-20 16:19:45] [config] dec-depth: 1
[2023-07-20 16:19:45] [config] devices:
[2023-07-20 16:19:45] [config]   - 0
[2023-07-20 16:19:45] [config] dim-emb: 512
[2023-07-20 16:19:45] [config] dim-rnn: 1024
[2023-07-20 16:19:45] [config] dim-vocabs:
[2023-07-20 16:19:45] [config]   - 16384
[2023-07-20 16:19:45] [config]   - 16384
[2023-07-20 16:19:45] [config] disp-first: 0
[2023-07-20 16:19:45] [config] disp-freq: 1000u
[2023-07-20 16:19:45] [config] disp-label-counts: true
[2023-07-20 16:19:45] [config] dropout-rnn: 0
[2023-07-20 16:19:45] [config] dropout-src: 0
[2023-07-20 16:19:45] [config] dropout-trg: 0
[2023-07-20 16:19:45] [config] dump-config: ""
[2023-07-20 16:19:45] [config] dynamic-gradient-scaling:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] early-stopping: 200
[2023-07-20 16:19:45] [config] early-stopping-on: first
[2023-07-20 16:19:45] [config] embedding-fix-src: false
[2023-07-20 16:19:45] [config] embedding-fix-trg: false
[2023-07-20 16:19:45] [config] embedding-normalization: false
[2023-07-20 16:19:45] [config] embedding-vectors:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] enc-cell: gru
[2023-07-20 16:19:45] [config] enc-cell-depth: 1
[2023-07-20 16:19:45] [config] enc-depth: 1
[2023-07-20 16:19:45] [config] enc-type: bidirectional
[2023-07-20 16:19:45] [config] english-title-case-every: 0
[2023-07-20 16:19:45] [config] exponential-smoothing: 0
[2023-07-20 16:19:45] [config] factor-weight: 1
[2023-07-20 16:19:45] [config] factors-combine: sum
[2023-07-20 16:19:45] [config] factors-dim-emb: 0
[2023-07-20 16:19:45] [config] gradient-checkpointing: false
[2023-07-20 16:19:45] [config] gradient-norm-average-window: 100
[2023-07-20 16:19:45] [config] guided-alignment: none
[2023-07-20 16:19:45] [config] guided-alignment-cost: mse
[2023-07-20 16:19:45] [config] guided-alignment-weight: 0.1
[2023-07-20 16:19:45] [config] ignore-model-config: false
[2023-07-20 16:19:45] [config] input-types:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] interpolate-env-vars: false
[2023-07-20 16:19:45] [config] keep-best: false
[2023-07-20 16:19:45] [config] label-smoothing: 0
[2023-07-20 16:19:45] [config] layer-normalization: false
[2023-07-20 16:19:45] [config] learn-rate: 0.0001
[2023-07-20 16:19:45] [config] lemma-dependency: ""
[2023-07-20 16:19:45] [config] lemma-dim-emb: 0
[2023-07-20 16:19:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:45] [config] log-level: info
[2023-07-20 16:19:45] [config] log-time-zone: ""
[2023-07-20 16:19:45] [config] logical-epoch:
[2023-07-20 16:19:45] [config]   - 1e
[2023-07-20 16:19:45] [config]   - 0
[2023-07-20 16:19:45] [config] lr-decay: 0
[2023-07-20 16:19:45] [config] lr-decay-freq: 50000
[2023-07-20 16:19:45] [config] lr-decay-inv-sqrt:
[2023-07-20 16:19:45] [config]   - 0
[2023-07-20 16:19:45] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:19:45] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:19:45] [config] lr-decay-start:
[2023-07-20 16:19:45] [config]   - 10
[2023-07-20 16:19:45] [config]   - 1
[2023-07-20 16:19:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:19:45] [config] lr-report: false
[2023-07-20 16:19:45] [config] lr-warmup: 0
[2023-07-20 16:19:45] [config] lr-warmup-at-reload: false
[2023-07-20 16:19:45] [config] lr-warmup-cycle: false
[2023-07-20 16:19:45] [config] lr-warmup-start-rate: 0
[2023-07-20 16:19:45] [config] max-length: 150
[2023-07-20 16:19:45] [config] max-length-crop: true
[2023-07-20 16:19:45] [config] max-length-factor: 3
[2023-07-20 16:19:45] [config] maxi-batch: 100
[2023-07-20 16:19:45] [config] maxi-batch-sort: trg
[2023-07-20 16:19:45] [config] mini-batch: 64
[2023-07-20 16:19:45] [config] mini-batch-fit: true
[2023-07-20 16:19:45] [config] mini-batch-fit-step: 10
[2023-07-20 16:19:45] [config] mini-batch-round-up: true
[2023-07-20 16:19:45] [config] mini-batch-track-lr: false
[2023-07-20 16:19:45] [config] mini-batch-warmup: 0
[2023-07-20 16:19:45] [config] mini-batch-words: 0
[2023-07-20 16:19:45] [config] mini-batch-words-ref: 0
[2023-07-20 16:19:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:19:45] [config] multi-loss-type: sum
[2023-07-20 16:19:45] [config] n-best: false
[2023-07-20 16:19:45] [config] no-nccl: false
[2023-07-20 16:19:45] [config] no-reload: false
[2023-07-20 16:19:45] [config] no-restore-corpus: false
[2023-07-20 16:19:45] [config] normalize: 0
[2023-07-20 16:19:45] [config] normalize-gradient: false
[2023-07-20 16:19:45] [config] num-devices: 0
[2023-07-20 16:19:45] [config] optimizer: adam
[2023-07-20 16:19:45] [config] optimizer-delay: 1
[2023-07-20 16:19:45] [config] optimizer-params:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] output-omit-bias: false
[2023-07-20 16:19:45] [config] overwrite: true
[2023-07-20 16:19:45] [config] precision:
[2023-07-20 16:19:45] [config]   - float16
[2023-07-20 16:19:45] [config]   - float32
[2023-07-20 16:19:45] [config] pretrained-model: ""
[2023-07-20 16:19:45] [config] quantize-biases: false
[2023-07-20 16:19:45] [config] quantize-bits: 0
[2023-07-20 16:19:45] [config] quantize-log-based: false
[2023-07-20 16:19:45] [config] quantize-optimization-steps: 0
[2023-07-20 16:19:45] [config] quiet: false
[2023-07-20 16:19:45] [config] quiet-translation: true
[2023-07-20 16:19:45] [config] relative-paths: false
[2023-07-20 16:19:45] [config] right-left: false
[2023-07-20 16:19:45] [config] save-freq: 10000u
[2023-07-20 16:19:45] [config] seed: 1234
[2023-07-20 16:19:45] [config] sentencepiece-alphas:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:19:45] [config] sentencepiece-options: ""
[2023-07-20 16:19:45] [config] sharding: global
[2023-07-20 16:19:45] [config] shuffle: data
[2023-07-20 16:19:45] [config] shuffle-in-ram: false
[2023-07-20 16:19:45] [config] sigterm: save-and-exit
[2023-07-20 16:19:45] [config] skip: false
[2023-07-20 16:19:45] [config] sqlite: ""
[2023-07-20 16:19:45] [config] sqlite-drop: false
[2023-07-20 16:19:45] [config] sync-freq: 200u
[2023-07-20 16:19:45] [config] sync-sgd: false
[2023-07-20 16:19:45] [config] tempdir: /tmp
[2023-07-20 16:19:45] [config] tied-embeddings: false
[2023-07-20 16:19:45] [config] tied-embeddings-all: true
[2023-07-20 16:19:45] [config] tied-embeddings-src: false
[2023-07-20 16:19:45] [config] train-embedder-rank:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] train-sets:
[2023-07-20 16:19:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:19:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:19:45] [config] transformer-aan-activation: swish
[2023-07-20 16:19:45] [config] transformer-aan-depth: 2
[2023-07-20 16:19:45] [config] transformer-aan-nogate: false
[2023-07-20 16:19:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:19:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:19:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:19:45] [config] transformer-depth-scaling: false
[2023-07-20 16:19:45] [config] transformer-dim-aan: 2048
[2023-07-20 16:19:45] [config] transformer-dim-ffn: 2048
[2023-07-20 16:19:45] [config] transformer-dropout: 0
[2023-07-20 16:19:45] [config] transformer-dropout-attention: 0
[2023-07-20 16:19:45] [config] transformer-dropout-ffn: 0
[2023-07-20 16:19:45] [config] transformer-ffn-activation: swish
[2023-07-20 16:19:45] [config] transformer-ffn-depth: 2
[2023-07-20 16:19:45] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:19:45] [config] transformer-heads: 8
[2023-07-20 16:19:45] [config] transformer-no-projection: false
[2023-07-20 16:19:45] [config] transformer-pool: false
[2023-07-20 16:19:45] [config] transformer-postprocess: dan
[2023-07-20 16:19:45] [config] transformer-postprocess-emb: d
[2023-07-20 16:19:45] [config] transformer-postprocess-top: ""
[2023-07-20 16:19:45] [config] transformer-preprocess: ""
[2023-07-20 16:19:45] [config] transformer-tied-layers:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] transformer-train-position-embeddings: false
[2023-07-20 16:19:45] [config] tsv: false
[2023-07-20 16:19:45] [config] tsv-fields: 0
[2023-07-20 16:19:45] [config] type: amun
[2023-07-20 16:19:45] [config] ulr: false
[2023-07-20 16:19:45] [config] ulr-dim-emb: 0
[2023-07-20 16:19:45] [config] ulr-dropout: 0
[2023-07-20 16:19:45] [config] ulr-keys-vectors: ""
[2023-07-20 16:19:45] [config] ulr-query-vectors: ""
[2023-07-20 16:19:45] [config] ulr-softmax-temperature: 1
[2023-07-20 16:19:45] [config] ulr-trainable-transformation: false
[2023-07-20 16:19:45] [config] unlikelihood-loss: false
[2023-07-20 16:19:45] [config] valid-freq: 50000000
[2023-07-20 16:19:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:19:45] [config] valid-max-length: 1000
[2023-07-20 16:19:45] [config] valid-metrics:
[2023-07-20 16:19:45] [config]   - cross-entropy
[2023-07-20 16:19:45] [config]   - translation
[2023-07-20 16:19:45] [config] valid-mini-batch: 32
[2023-07-20 16:19:45] [config] valid-reset-stalled: false
[2023-07-20 16:19:45] [config] valid-script-args:
[2023-07-20 16:19:45] [config]   []
[2023-07-20 16:19:45] [config] valid-script-path: ""
[2023-07-20 16:19:45] [config] valid-sets:
[2023-07-20 16:19:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:19:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:19:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:19:45] [config] vocabs:
[2023-07-20 16:19:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:45] [config] word-penalty: 0
[2023-07-20 16:19:45] [config] word-scores: false
[2023-07-20 16:19:45] [config] workspace: 5500
[2023-07-20 16:19:45] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:19:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:45] [training] Using single-device training
[2023-07-20 16:19:46] Synced seed 1234
[2023-07-20 16:19:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:19:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 16:19:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:19:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 16:19:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 16:19:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:19:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 16:19:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 16:19:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 16:19:48] [comm] Using global sharding
[2023-07-20 16:19:48] [comm] NCCLCommunicators constructed successfully
[2023-07-20 16:19:48] [training] Using 1 GPUs
[2023-07-20 16:19:48] [logits] Applying loss function for 1 factor(s)
[2023-07-20 16:19:48] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:19:52] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 16:19:52] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:21:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:21:26] [marian] Running on node23.datos.cluster.uy as process 4215 with command line:
[2023-07-20 16:21:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 16:21:26] [config] after: 0e
[2023-07-20 16:21:26] [config] after-batches: 0
[2023-07-20 16:21:26] [config] after-epochs: 10
[2023-07-20 16:21:26] [config] all-caps-every: 0
[2023-07-20 16:21:26] [config] allow-unk: false
[2023-07-20 16:21:26] [config] authors: false
[2023-07-20 16:21:26] [config] beam-size: 12
[2023-07-20 16:21:26] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:21:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:21:26] [config] bert-masking-fraction: 0.15
[2023-07-20 16:21:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:21:26] [config] bert-train-type-embeddings: true
[2023-07-20 16:21:26] [config] bert-type-vocab-size: 2
[2023-07-20 16:21:26] [config] build-info: ""
[2023-07-20 16:21:26] [config] check-gradient-nan: false
[2023-07-20 16:21:26] [config] check-nan: false
[2023-07-20 16:21:26] [config] cite: false
[2023-07-20 16:21:26] [config] clip-norm: 1
[2023-07-20 16:21:26] [config] cost-scaling:
[2023-07-20 16:21:26] [config]   - 256.f
[2023-07-20 16:21:26] [config]   - 1000
[2023-07-20 16:21:26] [config]   - 2.f
[2023-07-20 16:21:26] [config]   - 256.f
[2023-07-20 16:21:26] [config] cost-type: ce-sum
[2023-07-20 16:21:26] [config] cpu-threads: 0
[2023-07-20 16:21:26] [config] data-threads: 8
[2023-07-20 16:21:26] [config] data-weighting: ""
[2023-07-20 16:21:26] [config] data-weighting-type: sentence
[2023-07-20 16:21:26] [config] dec-cell: gru
[2023-07-20 16:21:26] [config] dec-cell-base-depth: 2
[2023-07-20 16:21:26] [config] dec-cell-high-depth: 1
[2023-07-20 16:21:26] [config] dec-depth: 1
[2023-07-20 16:21:26] [config] devices:
[2023-07-20 16:21:26] [config]   - 0
[2023-07-20 16:21:26] [config] dim-emb: 512
[2023-07-20 16:21:26] [config] dim-rnn: 1024
[2023-07-20 16:21:26] [config] dim-vocabs:
[2023-07-20 16:21:26] [config]   - 16384
[2023-07-20 16:21:26] [config]   - 16384
[2023-07-20 16:21:26] [config] disp-first: 0
[2023-07-20 16:21:26] [config] disp-freq: 1000u
[2023-07-20 16:21:26] [config] disp-label-counts: true
[2023-07-20 16:21:26] [config] dropout-rnn: 0
[2023-07-20 16:21:26] [config] dropout-src: 0
[2023-07-20 16:21:26] [config] dropout-trg: 0
[2023-07-20 16:21:26] [config] dump-config: ""
[2023-07-20 16:21:26] [config] dynamic-gradient-scaling:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] early-stopping: 200
[2023-07-20 16:21:26] [config] early-stopping-on: first
[2023-07-20 16:21:26] [config] embedding-fix-src: false
[2023-07-20 16:21:26] [config] embedding-fix-trg: false
[2023-07-20 16:21:26] [config] embedding-normalization: false
[2023-07-20 16:21:26] [config] embedding-vectors:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] enc-cell: gru
[2023-07-20 16:21:26] [config] enc-cell-depth: 1
[2023-07-20 16:21:26] [config] enc-depth: 1
[2023-07-20 16:21:26] [config] enc-type: bidirectional
[2023-07-20 16:21:26] [config] english-title-case-every: 0
[2023-07-20 16:21:26] [config] exponential-smoothing: 0
[2023-07-20 16:21:26] [config] factor-weight: 1
[2023-07-20 16:21:26] [config] factors-combine: sum
[2023-07-20 16:21:26] [config] factors-dim-emb: 0
[2023-07-20 16:21:26] [config] gradient-checkpointing: false
[2023-07-20 16:21:26] [config] gradient-norm-average-window: 100
[2023-07-20 16:21:26] [config] guided-alignment: none
[2023-07-20 16:21:26] [config] guided-alignment-cost: mse
[2023-07-20 16:21:26] [config] guided-alignment-weight: 0.1
[2023-07-20 16:21:26] [config] ignore-model-config: false
[2023-07-20 16:21:26] [config] input-types:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] interpolate-env-vars: false
[2023-07-20 16:21:26] [config] keep-best: false
[2023-07-20 16:21:26] [config] label-smoothing: 0
[2023-07-20 16:21:26] [config] layer-normalization: false
[2023-07-20 16:21:26] [config] learn-rate: 0.0001
[2023-07-20 16:21:26] [config] lemma-dependency: ""
[2023-07-20 16:21:26] [config] lemma-dim-emb: 0
[2023-07-20 16:21:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:21:26] [config] log-level: info
[2023-07-20 16:21:26] [config] log-time-zone: ""
[2023-07-20 16:21:26] [config] logical-epoch:
[2023-07-20 16:21:26] [config]   - 1e
[2023-07-20 16:21:26] [config]   - 0
[2023-07-20 16:21:26] [config] lr-decay: 0
[2023-07-20 16:21:26] [config] lr-decay-freq: 50000
[2023-07-20 16:21:26] [config] lr-decay-inv-sqrt:
[2023-07-20 16:21:26] [config]   - 0
[2023-07-20 16:21:26] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:21:26] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:21:26] [config] lr-decay-start:
[2023-07-20 16:21:26] [config]   - 10
[2023-07-20 16:21:26] [config]   - 1
[2023-07-20 16:21:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:21:26] [config] lr-report: false
[2023-07-20 16:21:26] [config] lr-warmup: 0
[2023-07-20 16:21:26] [config] lr-warmup-at-reload: false
[2023-07-20 16:21:26] [config] lr-warmup-cycle: false
[2023-07-20 16:21:26] [config] lr-warmup-start-rate: 0
[2023-07-20 16:21:26] [config] max-length: 150
[2023-07-20 16:21:26] [config] max-length-crop: true
[2023-07-20 16:21:26] [config] max-length-factor: 3
[2023-07-20 16:21:26] [config] maxi-batch: 100
[2023-07-20 16:21:26] [config] maxi-batch-sort: trg
[2023-07-20 16:21:26] [config] mini-batch: 64
[2023-07-20 16:21:26] [config] mini-batch-fit: true
[2023-07-20 16:21:26] [config] mini-batch-fit-step: 10
[2023-07-20 16:21:26] [config] mini-batch-round-up: true
[2023-07-20 16:21:26] [config] mini-batch-track-lr: false
[2023-07-20 16:21:26] [config] mini-batch-warmup: 0
[2023-07-20 16:21:26] [config] mini-batch-words: 0
[2023-07-20 16:21:26] [config] mini-batch-words-ref: 0
[2023-07-20 16:21:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 16:21:26] [config] multi-loss-type: sum
[2023-07-20 16:21:26] [config] n-best: false
[2023-07-20 16:21:26] [config] no-nccl: false
[2023-07-20 16:21:26] [config] no-reload: false
[2023-07-20 16:21:26] [config] no-restore-corpus: false
[2023-07-20 16:21:26] [config] normalize: 0
[2023-07-20 16:21:26] [config] normalize-gradient: false
[2023-07-20 16:21:26] [config] num-devices: 0
[2023-07-20 16:21:26] [config] optimizer: adam
[2023-07-20 16:21:26] [config] optimizer-delay: 1
[2023-07-20 16:21:26] [config] optimizer-params:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] output-omit-bias: false
[2023-07-20 16:21:26] [config] overwrite: true
[2023-07-20 16:21:26] [config] precision:
[2023-07-20 16:21:26] [config]   - float16
[2023-07-20 16:21:26] [config]   - float32
[2023-07-20 16:21:26] [config] pretrained-model: ""
[2023-07-20 16:21:26] [config] quantize-biases: false
[2023-07-20 16:21:26] [config] quantize-bits: 0
[2023-07-20 16:21:26] [config] quantize-log-based: false
[2023-07-20 16:21:26] [config] quantize-optimization-steps: 0
[2023-07-20 16:21:26] [config] quiet: false
[2023-07-20 16:21:26] [config] quiet-translation: true
[2023-07-20 16:21:26] [config] relative-paths: false
[2023-07-20 16:21:26] [config] right-left: false
[2023-07-20 16:21:26] [config] save-freq: 10000u
[2023-07-20 16:21:26] [config] seed: 1234
[2023-07-20 16:21:26] [config] sentencepiece-alphas:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:21:26] [config] sentencepiece-options: ""
[2023-07-20 16:21:26] [config] sharding: global
[2023-07-20 16:21:26] [config] shuffle: data
[2023-07-20 16:21:26] [config] shuffle-in-ram: false
[2023-07-20 16:21:26] [config] sigterm: save-and-exit
[2023-07-20 16:21:26] [config] skip: false
[2023-07-20 16:21:26] [config] sqlite: ""
[2023-07-20 16:21:26] [config] sqlite-drop: false
[2023-07-20 16:21:26] [config] sync-freq: 200u
[2023-07-20 16:21:26] [config] sync-sgd: false
[2023-07-20 16:21:26] [config] tempdir: /tmp
[2023-07-20 16:21:26] [config] tied-embeddings: false
[2023-07-20 16:21:26] [config] tied-embeddings-all: true
[2023-07-20 16:21:26] [config] tied-embeddings-src: false
[2023-07-20 16:21:26] [config] train-embedder-rank:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] train-sets:
[2023-07-20 16:21:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:21:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:21:26] [config] transformer-aan-activation: swish
[2023-07-20 16:21:26] [config] transformer-aan-depth: 2
[2023-07-20 16:21:26] [config] transformer-aan-nogate: false
[2023-07-20 16:21:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:21:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:21:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:21:26] [config] transformer-depth-scaling: false
[2023-07-20 16:21:26] [config] transformer-dim-aan: 2048
[2023-07-20 16:21:26] [config] transformer-dim-ffn: 2048
[2023-07-20 16:21:26] [config] transformer-dropout: 0
[2023-07-20 16:21:26] [config] transformer-dropout-attention: 0
[2023-07-20 16:21:26] [config] transformer-dropout-ffn: 0
[2023-07-20 16:21:26] [config] transformer-ffn-activation: swish
[2023-07-20 16:21:26] [config] transformer-ffn-depth: 2
[2023-07-20 16:21:26] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:21:26] [config] transformer-heads: 8
[2023-07-20 16:21:26] [config] transformer-no-projection: false
[2023-07-20 16:21:26] [config] transformer-pool: false
[2023-07-20 16:21:26] [config] transformer-postprocess: dan
[2023-07-20 16:21:26] [config] transformer-postprocess-emb: d
[2023-07-20 16:21:26] [config] transformer-postprocess-top: ""
[2023-07-20 16:21:26] [config] transformer-preprocess: ""
[2023-07-20 16:21:26] [config] transformer-tied-layers:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] transformer-train-position-embeddings: false
[2023-07-20 16:21:26] [config] tsv: false
[2023-07-20 16:21:26] [config] tsv-fields: 0
[2023-07-20 16:21:26] [config] type: amun
[2023-07-20 16:21:26] [config] ulr: false
[2023-07-20 16:21:26] [config] ulr-dim-emb: 0
[2023-07-20 16:21:26] [config] ulr-dropout: 0
[2023-07-20 16:21:26] [config] ulr-keys-vectors: ""
[2023-07-20 16:21:26] [config] ulr-query-vectors: ""
[2023-07-20 16:21:26] [config] ulr-softmax-temperature: 1
[2023-07-20 16:21:26] [config] ulr-trainable-transformation: false
[2023-07-20 16:21:26] [config] unlikelihood-loss: false
[2023-07-20 16:21:26] [config] valid-freq: 50000000
[2023-07-20 16:21:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 16:21:26] [config] valid-max-length: 1000
[2023-07-20 16:21:26] [config] valid-metrics:
[2023-07-20 16:21:26] [config]   - cross-entropy
[2023-07-20 16:21:26] [config]   - translation
[2023-07-20 16:21:26] [config] valid-mini-batch: 32
[2023-07-20 16:21:26] [config] valid-reset-stalled: false
[2023-07-20 16:21:26] [config] valid-script-args:
[2023-07-20 16:21:26] [config]   []
[2023-07-20 16:21:26] [config] valid-script-path: ""
[2023-07-20 16:21:26] [config] valid-sets:
[2023-07-20 16:21:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:21:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:21:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 16:21:26] [config] vocabs:
[2023-07-20 16:21:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:21:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:21:26] [config] word-penalty: 0
[2023-07-20 16:21:26] [config] word-scores: false
[2023-07-20 16:21:26] [config] workspace: 5500
[2023-07-20 16:21:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:21:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:21:26] [training] Using single-device training
[2023-07-20 16:21:27] Synced seed 1234
[2023-07-20 16:21:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:21:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 16:21:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:21:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 16:21:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 16:21:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:21:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 16:21:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 16:21:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 16:21:28] [comm] Using global sharding
[2023-07-20 16:21:28] [comm] NCCLCommunicators constructed successfully
[2023-07-20 16:21:28] [training] Using 1 GPUs
[2023-07-20 16:21:28] [logits] Applying loss function for 1 factor(s)
[2023-07-20 16:21:28] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:21:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 16:21:30] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:48:10] [batching] Done. Typical MB size is 35,978 target words
[2023-07-20 16:48:10] [valid] No post-processing script given for validating translator
[2023-07-20 16:48:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:48:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 16:48:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 16:48:11] [comm] Using global sharding
[2023-07-20 16:48:11] [comm] NCCLCommunicators constructed successfully
[2023-07-20 16:48:11] [training] Using 1 GPUs
[2023-07-20 16:48:11] Training started
[2023-07-20 16:48:11] [data] Shuffling data
[2023-07-20 16:48:11] [data] Done reading 20,192 sentences
[2023-07-20 16:48:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 16:48:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 16:48:11] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:48:13] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:48:24] Parameter type float16, optimization type float32, casting types true
[2023-07-20 16:48:24] Allocating memory for general optimizer shards
[2023-07-20 16:48:24] [memory] Reserving 322 MB, device gpu0
[2023-07-20 16:48:24] Allocating memory for Adam-specific shards
[2023-07-20 16:48:24] [memory] Reserving 322 MB, device gpu0
[2023-07-20 16:52:13] Seen 20,192 samples
[2023-07-20 16:52:13] Starting data epoch 2 in logical epoch 2
[2023-07-20 16:52:13] [data] Shuffling data
[2023-07-20 16:52:13] [data] Done reading 20,192 sentences
[2023-07-20 16:52:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 16:57:12] Seen 20,192 samples
[2023-07-20 16:57:12] Starting data epoch 3 in logical epoch 3
[2023-07-20 16:57:12] [data] Shuffling data
[2023-07-20 16:57:12] [data] Done reading 20,192 sentences
[2023-07-20 16:57:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:02:22] Seen 20,192 samples
[2023-07-20 17:02:22] Starting data epoch 4 in logical epoch 4
[2023-07-20 17:02:22] [data] Shuffling data
[2023-07-20 17:02:22] [data] Done reading 20,192 sentences
[2023-07-20 17:02:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:06:51] Seen 20,192 samples
[2023-07-20 17:06:51] Starting data epoch 5 in logical epoch 5
[2023-07-20 17:06:51] [data] Shuffling data
[2023-07-20 17:06:51] [data] Done reading 20,192 sentences
[2023-07-20 17:06:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:11:34] Seen 20,192 samples
[2023-07-20 17:11:34] Starting data epoch 6 in logical epoch 6
[2023-07-20 17:11:34] [data] Shuffling data
[2023-07-20 17:11:34] [data] Done reading 20,192 sentences
[2023-07-20 17:11:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:15:30] Seen 20,192 samples
[2023-07-20 17:15:30] Starting data epoch 7 in logical epoch 7
[2023-07-20 17:15:30] [data] Shuffling data
[2023-07-20 17:15:30] [data] Done reading 20,192 sentences
[2023-07-20 17:15:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:20:21] Seen 20,192 samples
[2023-07-20 17:20:21] Starting data epoch 8 in logical epoch 8
[2023-07-20 17:20:21] [data] Shuffling data
[2023-07-20 17:20:21] [data] Done reading 20,192 sentences
[2023-07-20 17:20:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:25:12] Seen 20,192 samples
[2023-07-20 17:25:12] Starting data epoch 9 in logical epoch 9
[2023-07-20 17:25:12] [data] Shuffling data
[2023-07-20 17:25:12] [data] Done reading 20,192 sentences
[2023-07-20 17:25:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:29:59] Seen 20,192 samples
[2023-07-20 17:29:59] Starting data epoch 10 in logical epoch 10
[2023-07-20 17:29:59] [data] Shuffling data
[2023-07-20 17:29:59] [data] Done reading 20,192 sentences
[2023-07-20 17:29:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:35:18] Seen 20,192 samples
[2023-07-20 17:35:18] Starting data epoch 11 in logical epoch 11
[2023-07-20 17:35:18] Training finished
[2023-07-20 17:35:32] [valid] Ep. 11 : Up. 384 : cross-entropy : 187.564 : new best
[2023-07-20 17:37:43] [valid] Ep. 11 : Up. 384 : translation : 0 : new best
[2023-07-20 17:37:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 17:37:45] Saving Adam parameters
[2023-07-20 17:37:45] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 17:37:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 17:37:53] [marian] Running on node23.datos.cluster.uy as process 9142 with command line:
[2023-07-20 17:37:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 17:37:53] [config] after: 0e
[2023-07-20 17:37:53] [config] after-batches: 0
[2023-07-20 17:37:53] [config] after-epochs: 20
[2023-07-20 17:37:53] [config] all-caps-every: 0
[2023-07-20 17:37:53] [config] allow-unk: false
[2023-07-20 17:37:53] [config] authors: false
[2023-07-20 17:37:53] [config] beam-size: 12
[2023-07-20 17:37:53] [config] bert-class-symbol: "[CLS]"
[2023-07-20 17:37:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 17:37:53] [config] bert-masking-fraction: 0.15
[2023-07-20 17:37:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 17:37:53] [config] bert-train-type-embeddings: true
[2023-07-20 17:37:53] [config] bert-type-vocab-size: 2
[2023-07-20 17:37:53] [config] build-info: ""
[2023-07-20 17:37:53] [config] check-gradient-nan: false
[2023-07-20 17:37:53] [config] check-nan: false
[2023-07-20 17:37:53] [config] cite: false
[2023-07-20 17:37:53] [config] clip-norm: 1
[2023-07-20 17:37:53] [config] cost-scaling:
[2023-07-20 17:37:53] [config]   - 256.f
[2023-07-20 17:37:53] [config]   - 1000
[2023-07-20 17:37:53] [config]   - 2.f
[2023-07-20 17:37:53] [config]   - 256.f
[2023-07-20 17:37:53] [config] cost-type: ce-sum
[2023-07-20 17:37:53] [config] cpu-threads: 0
[2023-07-20 17:37:53] [config] data-threads: 8
[2023-07-20 17:37:53] [config] data-weighting: ""
[2023-07-20 17:37:53] [config] data-weighting-type: sentence
[2023-07-20 17:37:53] [config] dec-cell: gru
[2023-07-20 17:37:53] [config] dec-cell-base-depth: 2
[2023-07-20 17:37:53] [config] dec-cell-high-depth: 1
[2023-07-20 17:37:53] [config] dec-depth: 1
[2023-07-20 17:37:53] [config] devices:
[2023-07-20 17:37:53] [config]   - 0
[2023-07-20 17:37:53] [config] dim-emb: 512
[2023-07-20 17:37:53] [config] dim-rnn: 1024
[2023-07-20 17:37:53] [config] dim-vocabs:
[2023-07-20 17:37:53] [config]   - 16384
[2023-07-20 17:37:53] [config]   - 16384
[2023-07-20 17:37:53] [config] disp-first: 0
[2023-07-20 17:37:53] [config] disp-freq: 1000u
[2023-07-20 17:37:53] [config] disp-label-counts: true
[2023-07-20 17:37:53] [config] dropout-rnn: 0
[2023-07-20 17:37:53] [config] dropout-src: 0
[2023-07-20 17:37:53] [config] dropout-trg: 0
[2023-07-20 17:37:53] [config] dump-config: ""
[2023-07-20 17:37:53] [config] dynamic-gradient-scaling:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] early-stopping: 200
[2023-07-20 17:37:53] [config] early-stopping-on: first
[2023-07-20 17:37:53] [config] embedding-fix-src: false
[2023-07-20 17:37:53] [config] embedding-fix-trg: false
[2023-07-20 17:37:53] [config] embedding-normalization: false
[2023-07-20 17:37:53] [config] embedding-vectors:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] enc-cell: gru
[2023-07-20 17:37:53] [config] enc-cell-depth: 1
[2023-07-20 17:37:53] [config] enc-depth: 1
[2023-07-20 17:37:53] [config] enc-type: bidirectional
[2023-07-20 17:37:53] [config] english-title-case-every: 0
[2023-07-20 17:37:53] [config] exponential-smoothing: 0
[2023-07-20 17:37:53] [config] factor-weight: 1
[2023-07-20 17:37:53] [config] factors-combine: sum
[2023-07-20 17:37:53] [config] factors-dim-emb: 0
[2023-07-20 17:37:53] [config] gradient-checkpointing: false
[2023-07-20 17:37:53] [config] gradient-norm-average-window: 100
[2023-07-20 17:37:53] [config] guided-alignment: none
[2023-07-20 17:37:53] [config] guided-alignment-cost: mse
[2023-07-20 17:37:53] [config] guided-alignment-weight: 0.1
[2023-07-20 17:37:53] [config] ignore-model-config: false
[2023-07-20 17:37:53] [config] input-types:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] interpolate-env-vars: false
[2023-07-20 17:37:53] [config] keep-best: false
[2023-07-20 17:37:53] [config] label-smoothing: 0
[2023-07-20 17:37:53] [config] layer-normalization: false
[2023-07-20 17:37:53] [config] learn-rate: 0.0001
[2023-07-20 17:37:53] [config] lemma-dependency: ""
[2023-07-20 17:37:53] [config] lemma-dim-emb: 0
[2023-07-20 17:37:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 17:37:53] [config] log-level: info
[2023-07-20 17:37:53] [config] log-time-zone: ""
[2023-07-20 17:37:53] [config] logical-epoch:
[2023-07-20 17:37:53] [config]   - 1e
[2023-07-20 17:37:53] [config]   - 0
[2023-07-20 17:37:53] [config] lr-decay: 0
[2023-07-20 17:37:53] [config] lr-decay-freq: 50000
[2023-07-20 17:37:53] [config] lr-decay-inv-sqrt:
[2023-07-20 17:37:53] [config]   - 0
[2023-07-20 17:37:53] [config] lr-decay-repeat-warmup: false
[2023-07-20 17:37:53] [config] lr-decay-reset-optimizer: false
[2023-07-20 17:37:53] [config] lr-decay-start:
[2023-07-20 17:37:53] [config]   - 10
[2023-07-20 17:37:53] [config]   - 1
[2023-07-20 17:37:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 17:37:53] [config] lr-report: false
[2023-07-20 17:37:53] [config] lr-warmup: 0
[2023-07-20 17:37:53] [config] lr-warmup-at-reload: false
[2023-07-20 17:37:53] [config] lr-warmup-cycle: false
[2023-07-20 17:37:53] [config] lr-warmup-start-rate: 0
[2023-07-20 17:37:53] [config] max-length: 150
[2023-07-20 17:37:53] [config] max-length-crop: true
[2023-07-20 17:37:53] [config] max-length-factor: 3
[2023-07-20 17:37:53] [config] maxi-batch: 100
[2023-07-20 17:37:53] [config] maxi-batch-sort: trg
[2023-07-20 17:37:53] [config] mini-batch: 64
[2023-07-20 17:37:53] [config] mini-batch-fit: true
[2023-07-20 17:37:53] [config] mini-batch-fit-step: 10
[2023-07-20 17:37:53] [config] mini-batch-round-up: true
[2023-07-20 17:37:53] [config] mini-batch-track-lr: false
[2023-07-20 17:37:53] [config] mini-batch-warmup: 0
[2023-07-20 17:37:53] [config] mini-batch-words: 0
[2023-07-20 17:37:53] [config] mini-batch-words-ref: 0
[2023-07-20 17:37:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 17:37:53] [config] multi-loss-type: sum
[2023-07-20 17:37:53] [config] n-best: false
[2023-07-20 17:37:53] [config] no-nccl: false
[2023-07-20 17:37:53] [config] no-reload: false
[2023-07-20 17:37:53] [config] no-restore-corpus: false
[2023-07-20 17:37:53] [config] normalize: 0
[2023-07-20 17:37:53] [config] normalize-gradient: false
[2023-07-20 17:37:53] [config] num-devices: 0
[2023-07-20 17:37:53] [config] optimizer: adam
[2023-07-20 17:37:53] [config] optimizer-delay: 1
[2023-07-20 17:37:53] [config] optimizer-params:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] output-omit-bias: false
[2023-07-20 17:37:53] [config] overwrite: true
[2023-07-20 17:37:53] [config] precision:
[2023-07-20 17:37:53] [config]   - float16
[2023-07-20 17:37:53] [config]   - float32
[2023-07-20 17:37:53] [config] pretrained-model: ""
[2023-07-20 17:37:53] [config] quantize-biases: false
[2023-07-20 17:37:53] [config] quantize-bits: 0
[2023-07-20 17:37:53] [config] quantize-log-based: false
[2023-07-20 17:37:53] [config] quantize-optimization-steps: 0
[2023-07-20 17:37:53] [config] quiet: false
[2023-07-20 17:37:53] [config] quiet-translation: true
[2023-07-20 17:37:53] [config] relative-paths: false
[2023-07-20 17:37:53] [config] right-left: false
[2023-07-20 17:37:53] [config] save-freq: 10000u
[2023-07-20 17:37:53] [config] seed: 1234
[2023-07-20 17:37:53] [config] sentencepiece-alphas:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] sentencepiece-max-lines: 2000000
[2023-07-20 17:37:53] [config] sentencepiece-options: ""
[2023-07-20 17:37:53] [config] sharding: global
[2023-07-20 17:37:53] [config] shuffle: data
[2023-07-20 17:37:53] [config] shuffle-in-ram: false
[2023-07-20 17:37:53] [config] sigterm: save-and-exit
[2023-07-20 17:37:53] [config] skip: false
[2023-07-20 17:37:53] [config] sqlite: ""
[2023-07-20 17:37:53] [config] sqlite-drop: false
[2023-07-20 17:37:53] [config] sync-freq: 200u
[2023-07-20 17:37:53] [config] sync-sgd: false
[2023-07-20 17:37:53] [config] tempdir: /tmp
[2023-07-20 17:37:53] [config] tied-embeddings: false
[2023-07-20 17:37:53] [config] tied-embeddings-all: true
[2023-07-20 17:37:53] [config] tied-embeddings-src: false
[2023-07-20 17:37:53] [config] train-embedder-rank:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] train-sets:
[2023-07-20 17:37:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 17:37:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 17:37:53] [config] transformer-aan-activation: swish
[2023-07-20 17:37:53] [config] transformer-aan-depth: 2
[2023-07-20 17:37:53] [config] transformer-aan-nogate: false
[2023-07-20 17:37:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 17:37:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 17:37:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 17:37:53] [config] transformer-depth-scaling: false
[2023-07-20 17:37:53] [config] transformer-dim-aan: 2048
[2023-07-20 17:37:53] [config] transformer-dim-ffn: 2048
[2023-07-20 17:37:53] [config] transformer-dropout: 0
[2023-07-20 17:37:53] [config] transformer-dropout-attention: 0
[2023-07-20 17:37:53] [config] transformer-dropout-ffn: 0
[2023-07-20 17:37:53] [config] transformer-ffn-activation: swish
[2023-07-20 17:37:53] [config] transformer-ffn-depth: 2
[2023-07-20 17:37:53] [config] transformer-guided-alignment-layer: last
[2023-07-20 17:37:53] [config] transformer-heads: 8
[2023-07-20 17:37:53] [config] transformer-no-projection: false
[2023-07-20 17:37:53] [config] transformer-pool: false
[2023-07-20 17:37:53] [config] transformer-postprocess: dan
[2023-07-20 17:37:53] [config] transformer-postprocess-emb: d
[2023-07-20 17:37:53] [config] transformer-postprocess-top: ""
[2023-07-20 17:37:53] [config] transformer-preprocess: ""
[2023-07-20 17:37:53] [config] transformer-tied-layers:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] transformer-train-position-embeddings: false
[2023-07-20 17:37:53] [config] tsv: false
[2023-07-20 17:37:53] [config] tsv-fields: 0
[2023-07-20 17:37:53] [config] type: amun
[2023-07-20 17:37:53] [config] ulr: false
[2023-07-20 17:37:53] [config] ulr-dim-emb: 0
[2023-07-20 17:37:53] [config] ulr-dropout: 0
[2023-07-20 17:37:53] [config] ulr-keys-vectors: ""
[2023-07-20 17:37:53] [config] ulr-query-vectors: ""
[2023-07-20 17:37:53] [config] ulr-softmax-temperature: 1
[2023-07-20 17:37:53] [config] ulr-trainable-transformation: false
[2023-07-20 17:37:53] [config] unlikelihood-loss: false
[2023-07-20 17:37:53] [config] valid-freq: 50000000
[2023-07-20 17:37:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 17:37:53] [config] valid-max-length: 1000
[2023-07-20 17:37:53] [config] valid-metrics:
[2023-07-20 17:37:53] [config]   - cross-entropy
[2023-07-20 17:37:53] [config]   - translation
[2023-07-20 17:37:53] [config] valid-mini-batch: 32
[2023-07-20 17:37:53] [config] valid-reset-stalled: false
[2023-07-20 17:37:53] [config] valid-script-args:
[2023-07-20 17:37:53] [config]   []
[2023-07-20 17:37:53] [config] valid-script-path: ""
[2023-07-20 17:37:53] [config] valid-sets:
[2023-07-20 17:37:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 17:37:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 17:37:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 17:37:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 17:37:53] [config] vocabs:
[2023-07-20 17:37:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 17:37:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 17:37:53] [config] word-penalty: 0
[2023-07-20 17:37:53] [config] word-scores: false
[2023-07-20 17:37:53] [config] workspace: 5500
[2023-07-20 17:37:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 17:37:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 17:37:53] [training] Using single-device training
[2023-07-20 17:37:55] Synced seed 1234
[2023-07-20 17:37:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 17:37:55] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 17:37:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 17:37:55] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 17:37:55] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 17:37:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 17:37:55] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 17:37:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 17:37:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 17:37:56] [comm] Using global sharding
[2023-07-20 17:37:56] [comm] NCCLCommunicators constructed successfully
[2023-07-20 17:37:56] [training] Using 1 GPUs
[2023-07-20 17:37:56] [logits] Applying loss function for 1 factor(s)
[2023-07-20 17:37:56] [memory] Reserving 80 MB, device gpu0
[2023-07-20 17:37:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 17:37:56] [memory] Reserving 80 MB, device gpu0
[2023-07-20 18:09:12] [batching] Done. Typical MB size is 35,978 target words
[2023-07-20 18:09:12] [valid] No post-processing script given for validating translator
[2023-07-20 18:09:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 18:09:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 18:09:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 18:09:12] [comm] Using global sharding
[2023-07-20 18:09:12] [comm] NCCLCommunicators constructed successfully
[2023-07-20 18:09:12] [training] Using 1 GPUs
[2023-07-20 18:09:12] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 18:09:20] Allocating memory for general optimizer shards
[2023-07-20 18:09:20] [memory] Reserving 322 MB, device gpu0
[2023-07-20 18:09:20] Loading Adam parameters
[2023-07-20 18:09:20] [memory] Reserving 322 MB, device gpu0
[2023-07-20 18:09:20] [memory] Reserving 80 MB, device gpu0
[2023-07-20 18:09:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 18:09:21] [data] Restoring the corpus state to epoch 11, batch 384
[2023-07-20 18:09:21] [data] Shuffling data
[2023-07-20 18:09:21] [data] Done reading 20,192 sentences
[2023-07-20 18:09:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:09:21] Training started
[2023-07-20 18:09:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 18:09:21] [memory] Reserving 80 MB, device gpu0
[2023-07-20 18:09:28] Parameter type float16, optimization type float32, casting types true
[2023-07-20 18:14:12] Seen 20,192 samples
[2023-07-20 18:14:12] Starting data epoch 12 in logical epoch 12
[2023-07-20 18:14:12] [data] Shuffling data
[2023-07-20 18:14:12] [data] Done reading 20,192 sentences
[2023-07-20 18:14:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:19:15] Seen 20,192 samples
[2023-07-20 18:19:15] Starting data epoch 13 in logical epoch 13
[2023-07-20 18:19:15] [data] Shuffling data
[2023-07-20 18:19:15] [data] Done reading 20,192 sentences
[2023-07-20 18:19:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:24:24] Seen 20,192 samples
[2023-07-20 18:24:24] Starting data epoch 14 in logical epoch 14
[2023-07-20 18:24:24] [data] Shuffling data
[2023-07-20 18:24:24] [data] Done reading 20,192 sentences
[2023-07-20 18:24:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:29:47] Seen 20,192 samples
[2023-07-20 18:29:47] Starting data epoch 15 in logical epoch 15
[2023-07-20 18:29:47] [data] Shuffling data
[2023-07-20 18:29:47] [data] Done reading 20,192 sentences
[2023-07-20 18:29:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:35:06] Seen 20,192 samples
[2023-07-20 18:35:06] Starting data epoch 16 in logical epoch 16
[2023-07-20 18:35:06] [data] Shuffling data
[2023-07-20 18:35:06] [data] Done reading 20,192 sentences
[2023-07-20 18:35:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:40:34] Seen 20,192 samples
[2023-07-20 18:40:34] Starting data epoch 17 in logical epoch 17
[2023-07-20 18:40:34] [data] Shuffling data
[2023-07-20 18:40:34] [data] Done reading 20,192 sentences
[2023-07-20 18:40:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:46:17] Seen 20,192 samples
[2023-07-20 18:46:17] Starting data epoch 18 in logical epoch 18
[2023-07-20 18:46:17] [data] Shuffling data
[2023-07-20 18:46:17] [data] Done reading 20,192 sentences
[2023-07-20 18:46:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:51:57] Seen 20,192 samples
[2023-07-20 18:51:57] Starting data epoch 19 in logical epoch 19
[2023-07-20 18:51:57] [data] Shuffling data
[2023-07-20 18:51:57] [data] Done reading 20,192 sentences
[2023-07-20 18:51:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:57:24] Seen 20,192 samples
[2023-07-20 18:57:24] Starting data epoch 20 in logical epoch 20
[2023-07-20 18:57:24] [data] Shuffling data
[2023-07-20 18:57:24] [data] Done reading 20,192 sentences
[2023-07-20 18:57:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:02:59] Seen 20,192 samples
[2023-07-20 19:02:59] Starting data epoch 21 in logical epoch 21
[2023-07-20 19:02:59] Training finished
[2023-07-20 19:03:13] [valid] Ep. 21 : Up. 765 : cross-entropy : 172.574 : new best
[2023-07-20 19:08:00] [valid] Ep. 21 : Up. 765 : translation : 0 : new best
[2023-07-20 19:08:00] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 19:08:02] Saving Adam parameters
[2023-07-20 19:08:02] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 19:08:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 19:08:10] [marian] Running on node23.datos.cluster.uy as process 15198 with command line:
[2023-07-20 19:08:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 19:08:10] [config] after: 0e
[2023-07-20 19:08:10] [config] after-batches: 0
[2023-07-20 19:08:10] [config] after-epochs: 30
[2023-07-20 19:08:10] [config] all-caps-every: 0
[2023-07-20 19:08:10] [config] allow-unk: false
[2023-07-20 19:08:10] [config] authors: false
[2023-07-20 19:08:10] [config] beam-size: 12
[2023-07-20 19:08:10] [config] bert-class-symbol: "[CLS]"
[2023-07-20 19:08:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 19:08:10] [config] bert-masking-fraction: 0.15
[2023-07-20 19:08:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 19:08:10] [config] bert-train-type-embeddings: true
[2023-07-20 19:08:10] [config] bert-type-vocab-size: 2
[2023-07-20 19:08:10] [config] build-info: ""
[2023-07-20 19:08:10] [config] check-gradient-nan: false
[2023-07-20 19:08:10] [config] check-nan: false
[2023-07-20 19:08:10] [config] cite: false
[2023-07-20 19:08:10] [config] clip-norm: 1
[2023-07-20 19:08:10] [config] cost-scaling:
[2023-07-20 19:08:10] [config]   - 256.f
[2023-07-20 19:08:10] [config]   - 1000
[2023-07-20 19:08:10] [config]   - 2.f
[2023-07-20 19:08:10] [config]   - 256.f
[2023-07-20 19:08:10] [config] cost-type: ce-sum
[2023-07-20 19:08:10] [config] cpu-threads: 0
[2023-07-20 19:08:10] [config] data-threads: 8
[2023-07-20 19:08:10] [config] data-weighting: ""
[2023-07-20 19:08:10] [config] data-weighting-type: sentence
[2023-07-20 19:08:10] [config] dec-cell: gru
[2023-07-20 19:08:10] [config] dec-cell-base-depth: 2
[2023-07-20 19:08:10] [config] dec-cell-high-depth: 1
[2023-07-20 19:08:10] [config] dec-depth: 1
[2023-07-20 19:08:10] [config] devices:
[2023-07-20 19:08:10] [config]   - 0
[2023-07-20 19:08:10] [config] dim-emb: 512
[2023-07-20 19:08:10] [config] dim-rnn: 1024
[2023-07-20 19:08:10] [config] dim-vocabs:
[2023-07-20 19:08:10] [config]   - 16384
[2023-07-20 19:08:10] [config]   - 16384
[2023-07-20 19:08:10] [config] disp-first: 0
[2023-07-20 19:08:10] [config] disp-freq: 1000u
[2023-07-20 19:08:10] [config] disp-label-counts: true
[2023-07-20 19:08:10] [config] dropout-rnn: 0
[2023-07-20 19:08:10] [config] dropout-src: 0
[2023-07-20 19:08:10] [config] dropout-trg: 0
[2023-07-20 19:08:10] [config] dump-config: ""
[2023-07-20 19:08:10] [config] dynamic-gradient-scaling:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] early-stopping: 200
[2023-07-20 19:08:10] [config] early-stopping-on: first
[2023-07-20 19:08:10] [config] embedding-fix-src: false
[2023-07-20 19:08:10] [config] embedding-fix-trg: false
[2023-07-20 19:08:10] [config] embedding-normalization: false
[2023-07-20 19:08:10] [config] embedding-vectors:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] enc-cell: gru
[2023-07-20 19:08:10] [config] enc-cell-depth: 1
[2023-07-20 19:08:10] [config] enc-depth: 1
[2023-07-20 19:08:10] [config] enc-type: bidirectional
[2023-07-20 19:08:10] [config] english-title-case-every: 0
[2023-07-20 19:08:10] [config] exponential-smoothing: 0
[2023-07-20 19:08:10] [config] factor-weight: 1
[2023-07-20 19:08:10] [config] factors-combine: sum
[2023-07-20 19:08:10] [config] factors-dim-emb: 0
[2023-07-20 19:08:10] [config] gradient-checkpointing: false
[2023-07-20 19:08:10] [config] gradient-norm-average-window: 100
[2023-07-20 19:08:10] [config] guided-alignment: none
[2023-07-20 19:08:10] [config] guided-alignment-cost: mse
[2023-07-20 19:08:10] [config] guided-alignment-weight: 0.1
[2023-07-20 19:08:10] [config] ignore-model-config: false
[2023-07-20 19:08:10] [config] input-types:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] interpolate-env-vars: false
[2023-07-20 19:08:10] [config] keep-best: false
[2023-07-20 19:08:10] [config] label-smoothing: 0
[2023-07-20 19:08:10] [config] layer-normalization: false
[2023-07-20 19:08:10] [config] learn-rate: 0.0001
[2023-07-20 19:08:10] [config] lemma-dependency: ""
[2023-07-20 19:08:10] [config] lemma-dim-emb: 0
[2023-07-20 19:08:10] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 19:08:10] [config] log-level: info
[2023-07-20 19:08:10] [config] log-time-zone: ""
[2023-07-20 19:08:10] [config] logical-epoch:
[2023-07-20 19:08:10] [config]   - 1e
[2023-07-20 19:08:10] [config]   - 0
[2023-07-20 19:08:10] [config] lr-decay: 0
[2023-07-20 19:08:10] [config] lr-decay-freq: 50000
[2023-07-20 19:08:10] [config] lr-decay-inv-sqrt:
[2023-07-20 19:08:10] [config]   - 0
[2023-07-20 19:08:10] [config] lr-decay-repeat-warmup: false
[2023-07-20 19:08:10] [config] lr-decay-reset-optimizer: false
[2023-07-20 19:08:10] [config] lr-decay-start:
[2023-07-20 19:08:10] [config]   - 10
[2023-07-20 19:08:10] [config]   - 1
[2023-07-20 19:08:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 19:08:10] [config] lr-report: false
[2023-07-20 19:08:10] [config] lr-warmup: 0
[2023-07-20 19:08:10] [config] lr-warmup-at-reload: false
[2023-07-20 19:08:10] [config] lr-warmup-cycle: false
[2023-07-20 19:08:10] [config] lr-warmup-start-rate: 0
[2023-07-20 19:08:10] [config] max-length: 150
[2023-07-20 19:08:10] [config] max-length-crop: true
[2023-07-20 19:08:10] [config] max-length-factor: 3
[2023-07-20 19:08:10] [config] maxi-batch: 100
[2023-07-20 19:08:10] [config] maxi-batch-sort: trg
[2023-07-20 19:08:10] [config] mini-batch: 64
[2023-07-20 19:08:10] [config] mini-batch-fit: true
[2023-07-20 19:08:10] [config] mini-batch-fit-step: 10
[2023-07-20 19:08:10] [config] mini-batch-round-up: true
[2023-07-20 19:08:10] [config] mini-batch-track-lr: false
[2023-07-20 19:08:10] [config] mini-batch-warmup: 0
[2023-07-20 19:08:10] [config] mini-batch-words: 0
[2023-07-20 19:08:10] [config] mini-batch-words-ref: 0
[2023-07-20 19:08:10] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 19:08:10] [config] multi-loss-type: sum
[2023-07-20 19:08:10] [config] n-best: false
[2023-07-20 19:08:10] [config] no-nccl: false
[2023-07-20 19:08:10] [config] no-reload: false
[2023-07-20 19:08:10] [config] no-restore-corpus: false
[2023-07-20 19:08:10] [config] normalize: 0
[2023-07-20 19:08:10] [config] normalize-gradient: false
[2023-07-20 19:08:10] [config] num-devices: 0
[2023-07-20 19:08:10] [config] optimizer: adam
[2023-07-20 19:08:10] [config] optimizer-delay: 1
[2023-07-20 19:08:10] [config] optimizer-params:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] output-omit-bias: false
[2023-07-20 19:08:10] [config] overwrite: true
[2023-07-20 19:08:10] [config] precision:
[2023-07-20 19:08:10] [config]   - float16
[2023-07-20 19:08:10] [config]   - float32
[2023-07-20 19:08:10] [config] pretrained-model: ""
[2023-07-20 19:08:10] [config] quantize-biases: false
[2023-07-20 19:08:10] [config] quantize-bits: 0
[2023-07-20 19:08:10] [config] quantize-log-based: false
[2023-07-20 19:08:10] [config] quantize-optimization-steps: 0
[2023-07-20 19:08:10] [config] quiet: false
[2023-07-20 19:08:10] [config] quiet-translation: true
[2023-07-20 19:08:10] [config] relative-paths: false
[2023-07-20 19:08:10] [config] right-left: false
[2023-07-20 19:08:10] [config] save-freq: 10000u
[2023-07-20 19:08:10] [config] seed: 1234
[2023-07-20 19:08:10] [config] sentencepiece-alphas:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] sentencepiece-max-lines: 2000000
[2023-07-20 19:08:10] [config] sentencepiece-options: ""
[2023-07-20 19:08:10] [config] sharding: global
[2023-07-20 19:08:10] [config] shuffle: data
[2023-07-20 19:08:10] [config] shuffle-in-ram: false
[2023-07-20 19:08:10] [config] sigterm: save-and-exit
[2023-07-20 19:08:10] [config] skip: false
[2023-07-20 19:08:10] [config] sqlite: ""
[2023-07-20 19:08:10] [config] sqlite-drop: false
[2023-07-20 19:08:10] [config] sync-freq: 200u
[2023-07-20 19:08:10] [config] sync-sgd: false
[2023-07-20 19:08:10] [config] tempdir: /tmp
[2023-07-20 19:08:10] [config] tied-embeddings: false
[2023-07-20 19:08:10] [config] tied-embeddings-all: true
[2023-07-20 19:08:10] [config] tied-embeddings-src: false
[2023-07-20 19:08:10] [config] train-embedder-rank:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] train-sets:
[2023-07-20 19:08:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 19:08:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 19:08:10] [config] transformer-aan-activation: swish
[2023-07-20 19:08:10] [config] transformer-aan-depth: 2
[2023-07-20 19:08:10] [config] transformer-aan-nogate: false
[2023-07-20 19:08:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 19:08:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 19:08:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 19:08:10] [config] transformer-depth-scaling: false
[2023-07-20 19:08:10] [config] transformer-dim-aan: 2048
[2023-07-20 19:08:10] [config] transformer-dim-ffn: 2048
[2023-07-20 19:08:10] [config] transformer-dropout: 0
[2023-07-20 19:08:10] [config] transformer-dropout-attention: 0
[2023-07-20 19:08:10] [config] transformer-dropout-ffn: 0
[2023-07-20 19:08:10] [config] transformer-ffn-activation: swish
[2023-07-20 19:08:10] [config] transformer-ffn-depth: 2
[2023-07-20 19:08:10] [config] transformer-guided-alignment-layer: last
[2023-07-20 19:08:10] [config] transformer-heads: 8
[2023-07-20 19:08:10] [config] transformer-no-projection: false
[2023-07-20 19:08:10] [config] transformer-pool: false
[2023-07-20 19:08:10] [config] transformer-postprocess: dan
[2023-07-20 19:08:10] [config] transformer-postprocess-emb: d
[2023-07-20 19:08:10] [config] transformer-postprocess-top: ""
[2023-07-20 19:08:10] [config] transformer-preprocess: ""
[2023-07-20 19:08:10] [config] transformer-tied-layers:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] transformer-train-position-embeddings: false
[2023-07-20 19:08:10] [config] tsv: false
[2023-07-20 19:08:10] [config] tsv-fields: 0
[2023-07-20 19:08:10] [config] type: amun
[2023-07-20 19:08:10] [config] ulr: false
[2023-07-20 19:08:10] [config] ulr-dim-emb: 0
[2023-07-20 19:08:10] [config] ulr-dropout: 0
[2023-07-20 19:08:10] [config] ulr-keys-vectors: ""
[2023-07-20 19:08:10] [config] ulr-query-vectors: ""
[2023-07-20 19:08:10] [config] ulr-softmax-temperature: 1
[2023-07-20 19:08:10] [config] ulr-trainable-transformation: false
[2023-07-20 19:08:10] [config] unlikelihood-loss: false
[2023-07-20 19:08:10] [config] valid-freq: 50000000
[2023-07-20 19:08:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 19:08:10] [config] valid-max-length: 1000
[2023-07-20 19:08:10] [config] valid-metrics:
[2023-07-20 19:08:10] [config]   - cross-entropy
[2023-07-20 19:08:10] [config]   - translation
[2023-07-20 19:08:10] [config] valid-mini-batch: 32
[2023-07-20 19:08:10] [config] valid-reset-stalled: false
[2023-07-20 19:08:10] [config] valid-script-args:
[2023-07-20 19:08:10] [config]   []
[2023-07-20 19:08:10] [config] valid-script-path: ""
[2023-07-20 19:08:10] [config] valid-sets:
[2023-07-20 19:08:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 19:08:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 19:08:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 19:08:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 19:08:10] [config] vocabs:
[2023-07-20 19:08:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 19:08:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 19:08:10] [config] word-penalty: 0
[2023-07-20 19:08:10] [config] word-scores: false
[2023-07-20 19:08:10] [config] workspace: 5500
[2023-07-20 19:08:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 19:08:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 19:08:10] [training] Using single-device training
[2023-07-20 19:08:11] Synced seed 1234
[2023-07-20 19:08:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 19:08:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 19:08:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 19:08:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 19:08:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 19:08:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 19:08:12] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 19:08:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 19:08:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 19:08:13] [comm] Using global sharding
[2023-07-20 19:08:13] [comm] NCCLCommunicators constructed successfully
[2023-07-20 19:08:13] [training] Using 1 GPUs
[2023-07-20 19:08:13] [logits] Applying loss function for 1 factor(s)
[2023-07-20 19:08:13] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:08:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 19:08:13] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:39:30] [batching] Done. Typical MB size is 35,978 target words
[2023-07-20 19:39:30] [valid] No post-processing script given for validating translator
[2023-07-20 19:39:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 19:39:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 19:39:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 19:39:30] [comm] Using global sharding
[2023-07-20 19:39:30] [comm] NCCLCommunicators constructed successfully
[2023-07-20 19:39:30] [training] Using 1 GPUs
[2023-07-20 19:39:30] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 19:39:35] Allocating memory for general optimizer shards
[2023-07-20 19:39:35] [memory] Reserving 322 MB, device gpu0
[2023-07-20 19:39:35] Loading Adam parameters
[2023-07-20 19:39:36] [memory] Reserving 322 MB, device gpu0
[2023-07-20 19:39:36] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:39:36] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 19:39:36] [data] Restoring the corpus state to epoch 21, batch 765
[2023-07-20 19:39:36] [data] Shuffling data
[2023-07-20 19:39:36] [data] Done reading 20,192 sentences
[2023-07-20 19:39:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:39:36] Training started
[2023-07-20 19:39:36] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 19:39:37] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:39:47] Parameter type float16, optimization type float32, casting types true
[2023-07-20 19:45:15] Seen 20,192 samples
[2023-07-20 19:45:15] Starting data epoch 22 in logical epoch 22
[2023-07-20 19:45:15] [data] Shuffling data
[2023-07-20 19:45:15] [data] Done reading 20,192 sentences
[2023-07-20 19:45:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:50:46] Seen 20,192 samples
[2023-07-20 19:50:46] Starting data epoch 23 in logical epoch 23
[2023-07-20 19:50:46] [data] Shuffling data
[2023-07-20 19:50:47] [data] Done reading 20,192 sentences
[2023-07-20 19:50:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:56:39] Seen 20,192 samples
[2023-07-20 19:56:39] Starting data epoch 24 in logical epoch 24
[2023-07-20 19:56:39] [data] Shuffling data
[2023-07-20 19:56:39] [data] Done reading 20,192 sentences
[2023-07-20 19:56:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:02:24] Seen 20,192 samples
[2023-07-20 20:02:24] Starting data epoch 25 in logical epoch 25
[2023-07-20 20:02:24] [data] Shuffling data
[2023-07-20 20:02:24] [data] Done reading 20,192 sentences
[2023-07-20 20:02:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:08:11] Seen 20,192 samples
[2023-07-20 20:08:11] Starting data epoch 26 in logical epoch 26
[2023-07-20 20:08:11] [data] Shuffling data
[2023-07-20 20:08:12] [data] Done reading 20,192 sentences
[2023-07-20 20:08:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:14:00] Seen 20,192 samples
[2023-07-20 20:14:00] Starting data epoch 27 in logical epoch 27
[2023-07-20 20:14:00] [data] Shuffling data
[2023-07-20 20:14:00] [data] Done reading 20,192 sentences
[2023-07-20 20:14:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:15:11] Ep. 27 : Up. 1000 : Sen. 4,405 : Cost 6.30117559 * 16,239,189 @ 19,232 after 16,239,189 : Time 2141.19s : 7584.19 words/s : gNorm 0.8970
[2023-07-20 20:19:59] Seen 20,192 samples
[2023-07-20 20:19:59] Starting data epoch 28 in logical epoch 28
[2023-07-20 20:19:59] [data] Shuffling data
[2023-07-20 20:19:59] [data] Done reading 20,192 sentences
[2023-07-20 20:19:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:25:44] Seen 20,192 samples
[2023-07-20 20:25:44] Starting data epoch 29 in logical epoch 29
[2023-07-20 20:25:44] [data] Shuffling data
[2023-07-20 20:25:44] [data] Done reading 20,192 sentences
[2023-07-20 20:25:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:31:37] Seen 20,192 samples
[2023-07-20 20:31:37] Starting data epoch 30 in logical epoch 30
[2023-07-20 20:31:37] [data] Shuffling data
[2023-07-20 20:31:37] [data] Done reading 20,192 sentences
[2023-07-20 20:31:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:37:28] Seen 20,192 samples
[2023-07-20 20:37:28] Starting data epoch 31 in logical epoch 31
[2023-07-20 20:37:28] Training finished
[2023-07-20 20:37:41] [valid] Ep. 31 : Up. 1144 : cross-entropy : 159.986 : new best
[2023-07-20 20:41:14] [valid] Ep. 31 : Up. 1144 : translation : 0 : new best
[2023-07-20 20:41:14] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 20:41:16] Saving Adam parameters
[2023-07-20 20:41:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 20:41:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 20:41:24] [marian] Running on node23.datos.cluster.uy as process 21404 with command line:
[2023-07-20 20:41:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 20:41:25] [config] after: 0e
[2023-07-20 20:41:25] [config] after-batches: 0
[2023-07-20 20:41:25] [config] after-epochs: 40
[2023-07-20 20:41:25] [config] all-caps-every: 0
[2023-07-20 20:41:25] [config] allow-unk: false
[2023-07-20 20:41:25] [config] authors: false
[2023-07-20 20:41:25] [config] beam-size: 12
[2023-07-20 20:41:25] [config] bert-class-symbol: "[CLS]"
[2023-07-20 20:41:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 20:41:25] [config] bert-masking-fraction: 0.15
[2023-07-20 20:41:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 20:41:25] [config] bert-train-type-embeddings: true
[2023-07-20 20:41:25] [config] bert-type-vocab-size: 2
[2023-07-20 20:41:25] [config] build-info: ""
[2023-07-20 20:41:25] [config] check-gradient-nan: false
[2023-07-20 20:41:25] [config] check-nan: false
[2023-07-20 20:41:25] [config] cite: false
[2023-07-20 20:41:25] [config] clip-norm: 1
[2023-07-20 20:41:25] [config] cost-scaling:
[2023-07-20 20:41:25] [config]   - 256.f
[2023-07-20 20:41:25] [config]   - 1000
[2023-07-20 20:41:25] [config]   - 2.f
[2023-07-20 20:41:25] [config]   - 256.f
[2023-07-20 20:41:25] [config] cost-type: ce-sum
[2023-07-20 20:41:25] [config] cpu-threads: 0
[2023-07-20 20:41:25] [config] data-threads: 8
[2023-07-20 20:41:25] [config] data-weighting: ""
[2023-07-20 20:41:25] [config] data-weighting-type: sentence
[2023-07-20 20:41:25] [config] dec-cell: gru
[2023-07-20 20:41:25] [config] dec-cell-base-depth: 2
[2023-07-20 20:41:25] [config] dec-cell-high-depth: 1
[2023-07-20 20:41:25] [config] dec-depth: 1
[2023-07-20 20:41:25] [config] devices:
[2023-07-20 20:41:25] [config]   - 0
[2023-07-20 20:41:25] [config] dim-emb: 512
[2023-07-20 20:41:25] [config] dim-rnn: 1024
[2023-07-20 20:41:25] [config] dim-vocabs:
[2023-07-20 20:41:25] [config]   - 16384
[2023-07-20 20:41:25] [config]   - 16384
[2023-07-20 20:41:25] [config] disp-first: 0
[2023-07-20 20:41:25] [config] disp-freq: 1000u
[2023-07-20 20:41:25] [config] disp-label-counts: true
[2023-07-20 20:41:25] [config] dropout-rnn: 0
[2023-07-20 20:41:25] [config] dropout-src: 0
[2023-07-20 20:41:25] [config] dropout-trg: 0
[2023-07-20 20:41:25] [config] dump-config: ""
[2023-07-20 20:41:25] [config] dynamic-gradient-scaling:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] early-stopping: 200
[2023-07-20 20:41:25] [config] early-stopping-on: first
[2023-07-20 20:41:25] [config] embedding-fix-src: false
[2023-07-20 20:41:25] [config] embedding-fix-trg: false
[2023-07-20 20:41:25] [config] embedding-normalization: false
[2023-07-20 20:41:25] [config] embedding-vectors:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] enc-cell: gru
[2023-07-20 20:41:25] [config] enc-cell-depth: 1
[2023-07-20 20:41:25] [config] enc-depth: 1
[2023-07-20 20:41:25] [config] enc-type: bidirectional
[2023-07-20 20:41:25] [config] english-title-case-every: 0
[2023-07-20 20:41:25] [config] exponential-smoothing: 0
[2023-07-20 20:41:25] [config] factor-weight: 1
[2023-07-20 20:41:25] [config] factors-combine: sum
[2023-07-20 20:41:25] [config] factors-dim-emb: 0
[2023-07-20 20:41:25] [config] gradient-checkpointing: false
[2023-07-20 20:41:25] [config] gradient-norm-average-window: 100
[2023-07-20 20:41:25] [config] guided-alignment: none
[2023-07-20 20:41:25] [config] guided-alignment-cost: mse
[2023-07-20 20:41:25] [config] guided-alignment-weight: 0.1
[2023-07-20 20:41:25] [config] ignore-model-config: false
[2023-07-20 20:41:25] [config] input-types:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] interpolate-env-vars: false
[2023-07-20 20:41:25] [config] keep-best: false
[2023-07-20 20:41:25] [config] label-smoothing: 0
[2023-07-20 20:41:25] [config] layer-normalization: false
[2023-07-20 20:41:25] [config] learn-rate: 0.0001
[2023-07-20 20:41:25] [config] lemma-dependency: ""
[2023-07-20 20:41:25] [config] lemma-dim-emb: 0
[2023-07-20 20:41:25] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 20:41:25] [config] log-level: info
[2023-07-20 20:41:25] [config] log-time-zone: ""
[2023-07-20 20:41:25] [config] logical-epoch:
[2023-07-20 20:41:25] [config]   - 1e
[2023-07-20 20:41:25] [config]   - 0
[2023-07-20 20:41:25] [config] lr-decay: 0
[2023-07-20 20:41:25] [config] lr-decay-freq: 50000
[2023-07-20 20:41:25] [config] lr-decay-inv-sqrt:
[2023-07-20 20:41:25] [config]   - 0
[2023-07-20 20:41:25] [config] lr-decay-repeat-warmup: false
[2023-07-20 20:41:25] [config] lr-decay-reset-optimizer: false
[2023-07-20 20:41:25] [config] lr-decay-start:
[2023-07-20 20:41:25] [config]   - 10
[2023-07-20 20:41:25] [config]   - 1
[2023-07-20 20:41:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 20:41:25] [config] lr-report: false
[2023-07-20 20:41:25] [config] lr-warmup: 0
[2023-07-20 20:41:25] [config] lr-warmup-at-reload: false
[2023-07-20 20:41:25] [config] lr-warmup-cycle: false
[2023-07-20 20:41:25] [config] lr-warmup-start-rate: 0
[2023-07-20 20:41:25] [config] max-length: 150
[2023-07-20 20:41:25] [config] max-length-crop: true
[2023-07-20 20:41:25] [config] max-length-factor: 3
[2023-07-20 20:41:25] [config] maxi-batch: 100
[2023-07-20 20:41:25] [config] maxi-batch-sort: trg
[2023-07-20 20:41:25] [config] mini-batch: 64
[2023-07-20 20:41:25] [config] mini-batch-fit: true
[2023-07-20 20:41:25] [config] mini-batch-fit-step: 10
[2023-07-20 20:41:25] [config] mini-batch-round-up: true
[2023-07-20 20:41:25] [config] mini-batch-track-lr: false
[2023-07-20 20:41:25] [config] mini-batch-warmup: 0
[2023-07-20 20:41:25] [config] mini-batch-words: 0
[2023-07-20 20:41:25] [config] mini-batch-words-ref: 0
[2023-07-20 20:41:25] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 20:41:25] [config] multi-loss-type: sum
[2023-07-20 20:41:25] [config] n-best: false
[2023-07-20 20:41:25] [config] no-nccl: false
[2023-07-20 20:41:25] [config] no-reload: false
[2023-07-20 20:41:25] [config] no-restore-corpus: false
[2023-07-20 20:41:25] [config] normalize: 0
[2023-07-20 20:41:25] [config] normalize-gradient: false
[2023-07-20 20:41:25] [config] num-devices: 0
[2023-07-20 20:41:25] [config] optimizer: adam
[2023-07-20 20:41:25] [config] optimizer-delay: 1
[2023-07-20 20:41:25] [config] optimizer-params:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] output-omit-bias: false
[2023-07-20 20:41:25] [config] overwrite: true
[2023-07-20 20:41:25] [config] precision:
[2023-07-20 20:41:25] [config]   - float16
[2023-07-20 20:41:25] [config]   - float32
[2023-07-20 20:41:25] [config] pretrained-model: ""
[2023-07-20 20:41:25] [config] quantize-biases: false
[2023-07-20 20:41:25] [config] quantize-bits: 0
[2023-07-20 20:41:25] [config] quantize-log-based: false
[2023-07-20 20:41:25] [config] quantize-optimization-steps: 0
[2023-07-20 20:41:25] [config] quiet: false
[2023-07-20 20:41:25] [config] quiet-translation: true
[2023-07-20 20:41:25] [config] relative-paths: false
[2023-07-20 20:41:25] [config] right-left: false
[2023-07-20 20:41:25] [config] save-freq: 10000u
[2023-07-20 20:41:25] [config] seed: 1234
[2023-07-20 20:41:25] [config] sentencepiece-alphas:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] sentencepiece-max-lines: 2000000
[2023-07-20 20:41:25] [config] sentencepiece-options: ""
[2023-07-20 20:41:25] [config] sharding: global
[2023-07-20 20:41:25] [config] shuffle: data
[2023-07-20 20:41:25] [config] shuffle-in-ram: false
[2023-07-20 20:41:25] [config] sigterm: save-and-exit
[2023-07-20 20:41:25] [config] skip: false
[2023-07-20 20:41:25] [config] sqlite: ""
[2023-07-20 20:41:25] [config] sqlite-drop: false
[2023-07-20 20:41:25] [config] sync-freq: 200u
[2023-07-20 20:41:25] [config] sync-sgd: false
[2023-07-20 20:41:25] [config] tempdir: /tmp
[2023-07-20 20:41:25] [config] tied-embeddings: false
[2023-07-20 20:41:25] [config] tied-embeddings-all: true
[2023-07-20 20:41:25] [config] tied-embeddings-src: false
[2023-07-20 20:41:25] [config] train-embedder-rank:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] train-sets:
[2023-07-20 20:41:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 20:41:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 20:41:25] [config] transformer-aan-activation: swish
[2023-07-20 20:41:25] [config] transformer-aan-depth: 2
[2023-07-20 20:41:25] [config] transformer-aan-nogate: false
[2023-07-20 20:41:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 20:41:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 20:41:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 20:41:25] [config] transformer-depth-scaling: false
[2023-07-20 20:41:25] [config] transformer-dim-aan: 2048
[2023-07-20 20:41:25] [config] transformer-dim-ffn: 2048
[2023-07-20 20:41:25] [config] transformer-dropout: 0
[2023-07-20 20:41:25] [config] transformer-dropout-attention: 0
[2023-07-20 20:41:25] [config] transformer-dropout-ffn: 0
[2023-07-20 20:41:25] [config] transformer-ffn-activation: swish
[2023-07-20 20:41:25] [config] transformer-ffn-depth: 2
[2023-07-20 20:41:25] [config] transformer-guided-alignment-layer: last
[2023-07-20 20:41:25] [config] transformer-heads: 8
[2023-07-20 20:41:25] [config] transformer-no-projection: false
[2023-07-20 20:41:25] [config] transformer-pool: false
[2023-07-20 20:41:25] [config] transformer-postprocess: dan
[2023-07-20 20:41:25] [config] transformer-postprocess-emb: d
[2023-07-20 20:41:25] [config] transformer-postprocess-top: ""
[2023-07-20 20:41:25] [config] transformer-preprocess: ""
[2023-07-20 20:41:25] [config] transformer-tied-layers:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] transformer-train-position-embeddings: false
[2023-07-20 20:41:25] [config] tsv: false
[2023-07-20 20:41:25] [config] tsv-fields: 0
[2023-07-20 20:41:25] [config] type: amun
[2023-07-20 20:41:25] [config] ulr: false
[2023-07-20 20:41:25] [config] ulr-dim-emb: 0
[2023-07-20 20:41:25] [config] ulr-dropout: 0
[2023-07-20 20:41:25] [config] ulr-keys-vectors: ""
[2023-07-20 20:41:25] [config] ulr-query-vectors: ""
[2023-07-20 20:41:25] [config] ulr-softmax-temperature: 1
[2023-07-20 20:41:25] [config] ulr-trainable-transformation: false
[2023-07-20 20:41:25] [config] unlikelihood-loss: false
[2023-07-20 20:41:25] [config] valid-freq: 50000000
[2023-07-20 20:41:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 20:41:25] [config] valid-max-length: 1000
[2023-07-20 20:41:25] [config] valid-metrics:
[2023-07-20 20:41:25] [config]   - cross-entropy
[2023-07-20 20:41:25] [config]   - translation
[2023-07-20 20:41:25] [config] valid-mini-batch: 32
[2023-07-20 20:41:25] [config] valid-reset-stalled: false
[2023-07-20 20:41:25] [config] valid-script-args:
[2023-07-20 20:41:25] [config]   []
[2023-07-20 20:41:25] [config] valid-script-path: ""
[2023-07-20 20:41:25] [config] valid-sets:
[2023-07-20 20:41:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 20:41:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 20:41:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 20:41:25] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 20:41:25] [config] vocabs:
[2023-07-20 20:41:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 20:41:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 20:41:25] [config] word-penalty: 0
[2023-07-20 20:41:25] [config] word-scores: false
[2023-07-20 20:41:25] [config] workspace: 5500
[2023-07-20 20:41:25] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 20:41:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 20:41:25] [training] Using single-device training
[2023-07-20 20:41:25] Synced seed 1234
[2023-07-20 20:41:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 20:41:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 20:41:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 20:41:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 20:41:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 20:41:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 20:41:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 20:41:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 20:41:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 20:41:26] [comm] Using global sharding
[2023-07-20 20:41:26] [comm] NCCLCommunicators constructed successfully
[2023-07-20 20:41:26] [training] Using 1 GPUs
[2023-07-20 20:41:26] [logits] Applying loss function for 1 factor(s)
[2023-07-20 20:41:26] [memory] Reserving 80 MB, device gpu0
[2023-07-20 20:41:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 20:41:26] [memory] Reserving 80 MB, device gpu0
[2023-07-20 21:12:31] [batching] Done. Typical MB size is 35,978 target words
[2023-07-20 21:12:31] [valid] No post-processing script given for validating translator
[2023-07-20 21:12:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 21:12:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 21:12:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 21:12:31] [comm] Using global sharding
[2023-07-20 21:12:31] [comm] NCCLCommunicators constructed successfully
[2023-07-20 21:12:31] [training] Using 1 GPUs
[2023-07-20 21:12:31] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 21:12:37] Allocating memory for general optimizer shards
[2023-07-20 21:12:37] [memory] Reserving 322 MB, device gpu0
[2023-07-20 21:12:37] Loading Adam parameters
[2023-07-20 21:12:37] [memory] Reserving 322 MB, device gpu0
[2023-07-20 21:12:37] [memory] Reserving 80 MB, device gpu0
[2023-07-20 21:12:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 21:12:38] [data] Restoring the corpus state to epoch 31, batch 1144
[2023-07-20 21:12:38] [data] Shuffling data
[2023-07-20 21:12:38] [data] Done reading 20,192 sentences
[2023-07-20 21:12:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:12:38] Training started
[2023-07-20 21:12:38] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 21:12:38] [memory] Reserving 80 MB, device gpu0
[2023-07-20 21:12:45] Parameter type float16, optimization type float32, casting types true
[2023-07-20 21:18:14] Seen 20,192 samples
[2023-07-20 21:18:14] Starting data epoch 32 in logical epoch 32
[2023-07-20 21:18:14] [data] Shuffling data
[2023-07-20 21:18:14] [data] Done reading 20,192 sentences
[2023-07-20 21:18:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:24:15] Seen 20,192 samples
[2023-07-20 21:24:15] Starting data epoch 33 in logical epoch 33
[2023-07-20 21:24:15] [data] Shuffling data
[2023-07-20 21:24:15] [data] Done reading 20,192 sentences
[2023-07-20 21:24:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:30:16] Seen 20,192 samples
[2023-07-20 21:30:16] Starting data epoch 34 in logical epoch 34
[2023-07-20 21:30:16] [data] Shuffling data
[2023-07-20 21:30:16] [data] Done reading 20,192 sentences
[2023-07-20 21:30:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:36:11] Seen 20,192 samples
[2023-07-20 21:36:11] Starting data epoch 35 in logical epoch 35
[2023-07-20 21:36:11] [data] Shuffling data
[2023-07-20 21:36:11] [data] Done reading 20,192 sentences
[2023-07-20 21:36:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:42:18] Seen 20,192 samples
[2023-07-20 21:42:18] Starting data epoch 36 in logical epoch 36
[2023-07-20 21:42:18] [data] Shuffling data
[2023-07-20 21:42:18] [data] Done reading 20,192 sentences
[2023-07-20 21:42:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:48:16] Seen 20,192 samples
[2023-07-20 21:48:16] Starting data epoch 37 in logical epoch 37
[2023-07-20 21:48:16] [data] Shuffling data
[2023-07-20 21:48:16] [data] Done reading 20,192 sentences
[2023-07-20 21:48:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:54:10] Seen 20,192 samples
[2023-07-20 21:54:10] Starting data epoch 38 in logical epoch 38
[2023-07-20 21:54:10] [data] Shuffling data
[2023-07-20 21:54:10] [data] Done reading 20,192 sentences
[2023-07-20 21:54:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:00:10] Seen 20,192 samples
[2023-07-20 22:00:10] Starting data epoch 39 in logical epoch 39
[2023-07-20 22:00:10] [data] Shuffling data
[2023-07-20 22:00:10] [data] Done reading 20,192 sentences
[2023-07-20 22:00:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:06:17] Seen 20,192 samples
[2023-07-20 22:06:17] Starting data epoch 40 in logical epoch 40
[2023-07-20 22:06:17] [data] Shuffling data
[2023-07-20 22:06:17] [data] Done reading 20,192 sentences
[2023-07-20 22:06:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:12:22] Seen 20,192 samples
[2023-07-20 22:12:22] Starting data epoch 41 in logical epoch 41
[2023-07-20 22:12:22] Training finished
[2023-07-20 22:12:37] [valid] Ep. 41 : Up. 1528 : cross-entropy : 151.07 : new best
[2023-07-20 22:15:08] [valid] Ep. 41 : Up. 1528 : translation : 0 : new best
[2023-07-20 22:15:08] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 22:15:10] Saving Adam parameters
[2023-07-20 22:15:11] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 22:15:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 22:15:18] [marian] Running on node23.datos.cluster.uy as process 27616 with command line:
[2023-07-20 22:15:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 22:15:18] [config] after: 0e
[2023-07-20 22:15:18] [config] after-batches: 0
[2023-07-20 22:15:18] [config] after-epochs: 50
[2023-07-20 22:15:18] [config] all-caps-every: 0
[2023-07-20 22:15:18] [config] allow-unk: false
[2023-07-20 22:15:18] [config] authors: false
[2023-07-20 22:15:18] [config] beam-size: 12
[2023-07-20 22:15:18] [config] bert-class-symbol: "[CLS]"
[2023-07-20 22:15:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 22:15:18] [config] bert-masking-fraction: 0.15
[2023-07-20 22:15:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 22:15:18] [config] bert-train-type-embeddings: true
[2023-07-20 22:15:18] [config] bert-type-vocab-size: 2
[2023-07-20 22:15:18] [config] build-info: ""
[2023-07-20 22:15:18] [config] check-gradient-nan: false
[2023-07-20 22:15:18] [config] check-nan: false
[2023-07-20 22:15:18] [config] cite: false
[2023-07-20 22:15:18] [config] clip-norm: 1
[2023-07-20 22:15:18] [config] cost-scaling:
[2023-07-20 22:15:18] [config]   - 256.f
[2023-07-20 22:15:18] [config]   - 1000
[2023-07-20 22:15:18] [config]   - 2.f
[2023-07-20 22:15:18] [config]   - 256.f
[2023-07-20 22:15:18] [config] cost-type: ce-sum
[2023-07-20 22:15:18] [config] cpu-threads: 0
[2023-07-20 22:15:18] [config] data-threads: 8
[2023-07-20 22:15:18] [config] data-weighting: ""
[2023-07-20 22:15:18] [config] data-weighting-type: sentence
[2023-07-20 22:15:18] [config] dec-cell: gru
[2023-07-20 22:15:18] [config] dec-cell-base-depth: 2
[2023-07-20 22:15:18] [config] dec-cell-high-depth: 1
[2023-07-20 22:15:18] [config] dec-depth: 1
[2023-07-20 22:15:18] [config] devices:
[2023-07-20 22:15:18] [config]   - 0
[2023-07-20 22:15:18] [config] dim-emb: 512
[2023-07-20 22:15:18] [config] dim-rnn: 1024
[2023-07-20 22:15:18] [config] dim-vocabs:
[2023-07-20 22:15:18] [config]   - 16384
[2023-07-20 22:15:18] [config]   - 16384
[2023-07-20 22:15:18] [config] disp-first: 0
[2023-07-20 22:15:18] [config] disp-freq: 1000u
[2023-07-20 22:15:18] [config] disp-label-counts: true
[2023-07-20 22:15:18] [config] dropout-rnn: 0
[2023-07-20 22:15:18] [config] dropout-src: 0
[2023-07-20 22:15:18] [config] dropout-trg: 0
[2023-07-20 22:15:18] [config] dump-config: ""
[2023-07-20 22:15:18] [config] dynamic-gradient-scaling:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] early-stopping: 200
[2023-07-20 22:15:18] [config] early-stopping-on: first
[2023-07-20 22:15:18] [config] embedding-fix-src: false
[2023-07-20 22:15:18] [config] embedding-fix-trg: false
[2023-07-20 22:15:18] [config] embedding-normalization: false
[2023-07-20 22:15:18] [config] embedding-vectors:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] enc-cell: gru
[2023-07-20 22:15:18] [config] enc-cell-depth: 1
[2023-07-20 22:15:18] [config] enc-depth: 1
[2023-07-20 22:15:18] [config] enc-type: bidirectional
[2023-07-20 22:15:18] [config] english-title-case-every: 0
[2023-07-20 22:15:18] [config] exponential-smoothing: 0
[2023-07-20 22:15:18] [config] factor-weight: 1
[2023-07-20 22:15:18] [config] factors-combine: sum
[2023-07-20 22:15:18] [config] factors-dim-emb: 0
[2023-07-20 22:15:18] [config] gradient-checkpointing: false
[2023-07-20 22:15:18] [config] gradient-norm-average-window: 100
[2023-07-20 22:15:18] [config] guided-alignment: none
[2023-07-20 22:15:18] [config] guided-alignment-cost: mse
[2023-07-20 22:15:18] [config] guided-alignment-weight: 0.1
[2023-07-20 22:15:18] [config] ignore-model-config: false
[2023-07-20 22:15:18] [config] input-types:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] interpolate-env-vars: false
[2023-07-20 22:15:18] [config] keep-best: false
[2023-07-20 22:15:18] [config] label-smoothing: 0
[2023-07-20 22:15:18] [config] layer-normalization: false
[2023-07-20 22:15:18] [config] learn-rate: 0.0001
[2023-07-20 22:15:18] [config] lemma-dependency: ""
[2023-07-20 22:15:18] [config] lemma-dim-emb: 0
[2023-07-20 22:15:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 22:15:18] [config] log-level: info
[2023-07-20 22:15:18] [config] log-time-zone: ""
[2023-07-20 22:15:18] [config] logical-epoch:
[2023-07-20 22:15:18] [config]   - 1e
[2023-07-20 22:15:18] [config]   - 0
[2023-07-20 22:15:18] [config] lr-decay: 0
[2023-07-20 22:15:18] [config] lr-decay-freq: 50000
[2023-07-20 22:15:18] [config] lr-decay-inv-sqrt:
[2023-07-20 22:15:18] [config]   - 0
[2023-07-20 22:15:18] [config] lr-decay-repeat-warmup: false
[2023-07-20 22:15:18] [config] lr-decay-reset-optimizer: false
[2023-07-20 22:15:18] [config] lr-decay-start:
[2023-07-20 22:15:18] [config]   - 10
[2023-07-20 22:15:18] [config]   - 1
[2023-07-20 22:15:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 22:15:18] [config] lr-report: false
[2023-07-20 22:15:18] [config] lr-warmup: 0
[2023-07-20 22:15:18] [config] lr-warmup-at-reload: false
[2023-07-20 22:15:18] [config] lr-warmup-cycle: false
[2023-07-20 22:15:18] [config] lr-warmup-start-rate: 0
[2023-07-20 22:15:18] [config] max-length: 150
[2023-07-20 22:15:18] [config] max-length-crop: true
[2023-07-20 22:15:18] [config] max-length-factor: 3
[2023-07-20 22:15:18] [config] maxi-batch: 100
[2023-07-20 22:15:18] [config] maxi-batch-sort: trg
[2023-07-20 22:15:18] [config] mini-batch: 64
[2023-07-20 22:15:18] [config] mini-batch-fit: true
[2023-07-20 22:15:18] [config] mini-batch-fit-step: 10
[2023-07-20 22:15:18] [config] mini-batch-round-up: true
[2023-07-20 22:15:18] [config] mini-batch-track-lr: false
[2023-07-20 22:15:18] [config] mini-batch-warmup: 0
[2023-07-20 22:15:18] [config] mini-batch-words: 0
[2023-07-20 22:15:18] [config] mini-batch-words-ref: 0
[2023-07-20 22:15:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 22:15:18] [config] multi-loss-type: sum
[2023-07-20 22:15:18] [config] n-best: false
[2023-07-20 22:15:18] [config] no-nccl: false
[2023-07-20 22:15:18] [config] no-reload: false
[2023-07-20 22:15:18] [config] no-restore-corpus: false
[2023-07-20 22:15:18] [config] normalize: 0
[2023-07-20 22:15:18] [config] normalize-gradient: false
[2023-07-20 22:15:18] [config] num-devices: 0
[2023-07-20 22:15:18] [config] optimizer: adam
[2023-07-20 22:15:18] [config] optimizer-delay: 1
[2023-07-20 22:15:18] [config] optimizer-params:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] output-omit-bias: false
[2023-07-20 22:15:18] [config] overwrite: true
[2023-07-20 22:15:18] [config] precision:
[2023-07-20 22:15:18] [config]   - float16
[2023-07-20 22:15:18] [config]   - float32
[2023-07-20 22:15:18] [config] pretrained-model: ""
[2023-07-20 22:15:18] [config] quantize-biases: false
[2023-07-20 22:15:18] [config] quantize-bits: 0
[2023-07-20 22:15:18] [config] quantize-log-based: false
[2023-07-20 22:15:18] [config] quantize-optimization-steps: 0
[2023-07-20 22:15:18] [config] quiet: false
[2023-07-20 22:15:18] [config] quiet-translation: true
[2023-07-20 22:15:18] [config] relative-paths: false
[2023-07-20 22:15:18] [config] right-left: false
[2023-07-20 22:15:18] [config] save-freq: 10000u
[2023-07-20 22:15:18] [config] seed: 1234
[2023-07-20 22:15:18] [config] sentencepiece-alphas:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] sentencepiece-max-lines: 2000000
[2023-07-20 22:15:18] [config] sentencepiece-options: ""
[2023-07-20 22:15:18] [config] sharding: global
[2023-07-20 22:15:18] [config] shuffle: data
[2023-07-20 22:15:18] [config] shuffle-in-ram: false
[2023-07-20 22:15:18] [config] sigterm: save-and-exit
[2023-07-20 22:15:18] [config] skip: false
[2023-07-20 22:15:18] [config] sqlite: ""
[2023-07-20 22:15:18] [config] sqlite-drop: false
[2023-07-20 22:15:18] [config] sync-freq: 200u
[2023-07-20 22:15:18] [config] sync-sgd: false
[2023-07-20 22:15:18] [config] tempdir: /tmp
[2023-07-20 22:15:18] [config] tied-embeddings: false
[2023-07-20 22:15:18] [config] tied-embeddings-all: true
[2023-07-20 22:15:18] [config] tied-embeddings-src: false
[2023-07-20 22:15:18] [config] train-embedder-rank:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] train-sets:
[2023-07-20 22:15:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 22:15:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 22:15:18] [config] transformer-aan-activation: swish
[2023-07-20 22:15:18] [config] transformer-aan-depth: 2
[2023-07-20 22:15:18] [config] transformer-aan-nogate: false
[2023-07-20 22:15:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 22:15:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 22:15:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 22:15:18] [config] transformer-depth-scaling: false
[2023-07-20 22:15:18] [config] transformer-dim-aan: 2048
[2023-07-20 22:15:18] [config] transformer-dim-ffn: 2048
[2023-07-20 22:15:18] [config] transformer-dropout: 0
[2023-07-20 22:15:18] [config] transformer-dropout-attention: 0
[2023-07-20 22:15:18] [config] transformer-dropout-ffn: 0
[2023-07-20 22:15:18] [config] transformer-ffn-activation: swish
[2023-07-20 22:15:18] [config] transformer-ffn-depth: 2
[2023-07-20 22:15:18] [config] transformer-guided-alignment-layer: last
[2023-07-20 22:15:18] [config] transformer-heads: 8
[2023-07-20 22:15:18] [config] transformer-no-projection: false
[2023-07-20 22:15:18] [config] transformer-pool: false
[2023-07-20 22:15:18] [config] transformer-postprocess: dan
[2023-07-20 22:15:18] [config] transformer-postprocess-emb: d
[2023-07-20 22:15:18] [config] transformer-postprocess-top: ""
[2023-07-20 22:15:18] [config] transformer-preprocess: ""
[2023-07-20 22:15:18] [config] transformer-tied-layers:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] transformer-train-position-embeddings: false
[2023-07-20 22:15:18] [config] tsv: false
[2023-07-20 22:15:18] [config] tsv-fields: 0
[2023-07-20 22:15:18] [config] type: amun
[2023-07-20 22:15:18] [config] ulr: false
[2023-07-20 22:15:18] [config] ulr-dim-emb: 0
[2023-07-20 22:15:18] [config] ulr-dropout: 0
[2023-07-20 22:15:18] [config] ulr-keys-vectors: ""
[2023-07-20 22:15:18] [config] ulr-query-vectors: ""
[2023-07-20 22:15:18] [config] ulr-softmax-temperature: 1
[2023-07-20 22:15:18] [config] ulr-trainable-transformation: false
[2023-07-20 22:15:18] [config] unlikelihood-loss: false
[2023-07-20 22:15:18] [config] valid-freq: 50000000
[2023-07-20 22:15:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 22:15:18] [config] valid-max-length: 1000
[2023-07-20 22:15:18] [config] valid-metrics:
[2023-07-20 22:15:18] [config]   - cross-entropy
[2023-07-20 22:15:18] [config]   - translation
[2023-07-20 22:15:18] [config] valid-mini-batch: 32
[2023-07-20 22:15:18] [config] valid-reset-stalled: false
[2023-07-20 22:15:18] [config] valid-script-args:
[2023-07-20 22:15:18] [config]   []
[2023-07-20 22:15:18] [config] valid-script-path: ""
[2023-07-20 22:15:18] [config] valid-sets:
[2023-07-20 22:15:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 22:15:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 22:15:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 22:15:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 22:15:18] [config] vocabs:
[2023-07-20 22:15:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 22:15:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 22:15:18] [config] word-penalty: 0
[2023-07-20 22:15:18] [config] word-scores: false
[2023-07-20 22:15:18] [config] workspace: 5500
[2023-07-20 22:15:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 22:15:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 22:15:18] [training] Using single-device training
[2023-07-20 22:15:19] Synced seed 1234
[2023-07-20 22:15:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 22:15:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 22:15:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 22:15:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 22:15:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 22:15:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 22:15:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 22:15:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 22:15:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 22:15:20] [comm] Using global sharding
[2023-07-20 22:15:20] [comm] NCCLCommunicators constructed successfully
[2023-07-20 22:15:20] [training] Using 1 GPUs
[2023-07-20 22:15:20] [logits] Applying loss function for 1 factor(s)
[2023-07-20 22:15:20] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:15:21] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 22:15:21] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:47:00] [batching] Done. Typical MB size is 35,978 target words
[2023-07-20 22:47:00] [valid] No post-processing script given for validating translator
[2023-07-20 22:47:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 22:47:00] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 22:47:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 22:47:00] [comm] Using global sharding
[2023-07-20 22:47:00] [comm] NCCLCommunicators constructed successfully
[2023-07-20 22:47:00] [training] Using 1 GPUs
[2023-07-20 22:47:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 22:47:06] Allocating memory for general optimizer shards
[2023-07-20 22:47:06] [memory] Reserving 322 MB, device gpu0
[2023-07-20 22:47:06] Loading Adam parameters
[2023-07-20 22:47:06] [memory] Reserving 322 MB, device gpu0
[2023-07-20 22:47:06] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:47:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 22:47:06] [data] Restoring the corpus state to epoch 41, batch 1528
[2023-07-20 22:47:06] [data] Shuffling data
[2023-07-20 22:47:06] [data] Done reading 20,192 sentences
[2023-07-20 22:47:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:47:06] Training started
[2023-07-20 22:47:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 22:47:07] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:47:11] Parameter type float16, optimization type float32, casting types true
[2023-07-20 22:52:37] Seen 20,192 samples
[2023-07-20 22:52:37] Starting data epoch 42 in logical epoch 42
[2023-07-20 22:52:37] [data] Shuffling data
[2023-07-20 22:52:37] [data] Done reading 20,192 sentences
[2023-07-20 22:52:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:58:22] Seen 20,192 samples
[2023-07-20 22:58:22] Starting data epoch 43 in logical epoch 43
[2023-07-20 22:58:22] [data] Shuffling data
[2023-07-20 22:58:22] [data] Done reading 20,192 sentences
[2023-07-20 22:58:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:04:09] Seen 20,192 samples
[2023-07-20 23:04:09] Starting data epoch 44 in logical epoch 44
[2023-07-20 23:04:09] [data] Shuffling data
[2023-07-20 23:04:09] [data] Done reading 20,192 sentences
[2023-07-20 23:04:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:10:08] Seen 20,192 samples
[2023-07-20 23:10:08] Starting data epoch 45 in logical epoch 45
[2023-07-20 23:10:08] [data] Shuffling data
[2023-07-20 23:10:08] [data] Done reading 20,192 sentences
[2023-07-20 23:10:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:15:51] Seen 20,192 samples
[2023-07-20 23:15:51] Starting data epoch 46 in logical epoch 46
[2023-07-20 23:15:51] [data] Shuffling data
[2023-07-20 23:15:51] [data] Done reading 20,192 sentences
[2023-07-20 23:15:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:21:26] Seen 20,192 samples
[2023-07-20 23:21:26] Starting data epoch 47 in logical epoch 47
[2023-07-20 23:21:26] [data] Shuffling data
[2023-07-20 23:21:26] [data] Done reading 20,192 sentences
[2023-07-20 23:21:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:27:07] Seen 20,192 samples
[2023-07-20 23:27:07] Starting data epoch 48 in logical epoch 48
[2023-07-20 23:27:07] [data] Shuffling data
[2023-07-20 23:27:07] [data] Done reading 20,192 sentences
[2023-07-20 23:27:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:33:09] Seen 20,192 samples
[2023-07-20 23:33:09] Starting data epoch 49 in logical epoch 49
[2023-07-20 23:33:09] [data] Shuffling data
[2023-07-20 23:33:09] [data] Done reading 20,192 sentences
[2023-07-20 23:33:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:39:00] Seen 20,192 samples
[2023-07-20 23:39:00] Starting data epoch 50 in logical epoch 50
[2023-07-20 23:39:00] [data] Shuffling data
[2023-07-20 23:39:00] [data] Done reading 20,192 sentences
[2023-07-20 23:39:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:44:57] Seen 20,192 samples
[2023-07-20 23:44:57] Starting data epoch 51 in logical epoch 51
[2023-07-20 23:44:57] Training finished
[2023-07-20 23:45:10] [valid] Ep. 51 : Up. 1908 : cross-entropy : 145.903 : new best
[2023-07-20 23:47:53] [valid] Ep. 51 : Up. 1908 : translation : 0 : new best
[2023-07-20 23:47:53] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 23:47:55] Saving Adam parameters
[2023-07-20 23:47:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-20 23:48:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 23:48:05] [marian] Running on node23.datos.cluster.uy as process 33820 with command line:
[2023-07-20 23:48:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-20 23:48:05] [config] after: 0e
[2023-07-20 23:48:05] [config] after-batches: 0
[2023-07-20 23:48:05] [config] after-epochs: 60
[2023-07-20 23:48:05] [config] all-caps-every: 0
[2023-07-20 23:48:05] [config] allow-unk: false
[2023-07-20 23:48:05] [config] authors: false
[2023-07-20 23:48:05] [config] beam-size: 12
[2023-07-20 23:48:05] [config] bert-class-symbol: "[CLS]"
[2023-07-20 23:48:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 23:48:05] [config] bert-masking-fraction: 0.15
[2023-07-20 23:48:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 23:48:05] [config] bert-train-type-embeddings: true
[2023-07-20 23:48:05] [config] bert-type-vocab-size: 2
[2023-07-20 23:48:05] [config] build-info: ""
[2023-07-20 23:48:05] [config] check-gradient-nan: false
[2023-07-20 23:48:05] [config] check-nan: false
[2023-07-20 23:48:05] [config] cite: false
[2023-07-20 23:48:05] [config] clip-norm: 1
[2023-07-20 23:48:05] [config] cost-scaling:
[2023-07-20 23:48:05] [config]   - 256.f
[2023-07-20 23:48:05] [config]   - 1000
[2023-07-20 23:48:05] [config]   - 2.f
[2023-07-20 23:48:05] [config]   - 256.f
[2023-07-20 23:48:05] [config] cost-type: ce-sum
[2023-07-20 23:48:05] [config] cpu-threads: 0
[2023-07-20 23:48:05] [config] data-threads: 8
[2023-07-20 23:48:05] [config] data-weighting: ""
[2023-07-20 23:48:05] [config] data-weighting-type: sentence
[2023-07-20 23:48:05] [config] dec-cell: gru
[2023-07-20 23:48:05] [config] dec-cell-base-depth: 2
[2023-07-20 23:48:05] [config] dec-cell-high-depth: 1
[2023-07-20 23:48:05] [config] dec-depth: 1
[2023-07-20 23:48:05] [config] devices:
[2023-07-20 23:48:05] [config]   - 0
[2023-07-20 23:48:05] [config] dim-emb: 512
[2023-07-20 23:48:05] [config] dim-rnn: 1024
[2023-07-20 23:48:05] [config] dim-vocabs:
[2023-07-20 23:48:05] [config]   - 16384
[2023-07-20 23:48:05] [config]   - 16384
[2023-07-20 23:48:05] [config] disp-first: 0
[2023-07-20 23:48:05] [config] disp-freq: 1000u
[2023-07-20 23:48:05] [config] disp-label-counts: true
[2023-07-20 23:48:05] [config] dropout-rnn: 0
[2023-07-20 23:48:05] [config] dropout-src: 0
[2023-07-20 23:48:05] [config] dropout-trg: 0
[2023-07-20 23:48:05] [config] dump-config: ""
[2023-07-20 23:48:05] [config] dynamic-gradient-scaling:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] early-stopping: 200
[2023-07-20 23:48:05] [config] early-stopping-on: first
[2023-07-20 23:48:05] [config] embedding-fix-src: false
[2023-07-20 23:48:05] [config] embedding-fix-trg: false
[2023-07-20 23:48:05] [config] embedding-normalization: false
[2023-07-20 23:48:05] [config] embedding-vectors:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] enc-cell: gru
[2023-07-20 23:48:05] [config] enc-cell-depth: 1
[2023-07-20 23:48:05] [config] enc-depth: 1
[2023-07-20 23:48:05] [config] enc-type: bidirectional
[2023-07-20 23:48:05] [config] english-title-case-every: 0
[2023-07-20 23:48:05] [config] exponential-smoothing: 0
[2023-07-20 23:48:05] [config] factor-weight: 1
[2023-07-20 23:48:05] [config] factors-combine: sum
[2023-07-20 23:48:05] [config] factors-dim-emb: 0
[2023-07-20 23:48:05] [config] gradient-checkpointing: false
[2023-07-20 23:48:05] [config] gradient-norm-average-window: 100
[2023-07-20 23:48:05] [config] guided-alignment: none
[2023-07-20 23:48:05] [config] guided-alignment-cost: mse
[2023-07-20 23:48:05] [config] guided-alignment-weight: 0.1
[2023-07-20 23:48:05] [config] ignore-model-config: false
[2023-07-20 23:48:05] [config] input-types:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] interpolate-env-vars: false
[2023-07-20 23:48:05] [config] keep-best: false
[2023-07-20 23:48:05] [config] label-smoothing: 0
[2023-07-20 23:48:05] [config] layer-normalization: false
[2023-07-20 23:48:05] [config] learn-rate: 0.0001
[2023-07-20 23:48:05] [config] lemma-dependency: ""
[2023-07-20 23:48:05] [config] lemma-dim-emb: 0
[2023-07-20 23:48:05] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 23:48:05] [config] log-level: info
[2023-07-20 23:48:05] [config] log-time-zone: ""
[2023-07-20 23:48:05] [config] logical-epoch:
[2023-07-20 23:48:05] [config]   - 1e
[2023-07-20 23:48:05] [config]   - 0
[2023-07-20 23:48:05] [config] lr-decay: 0
[2023-07-20 23:48:05] [config] lr-decay-freq: 50000
[2023-07-20 23:48:05] [config] lr-decay-inv-sqrt:
[2023-07-20 23:48:05] [config]   - 0
[2023-07-20 23:48:05] [config] lr-decay-repeat-warmup: false
[2023-07-20 23:48:05] [config] lr-decay-reset-optimizer: false
[2023-07-20 23:48:05] [config] lr-decay-start:
[2023-07-20 23:48:05] [config]   - 10
[2023-07-20 23:48:05] [config]   - 1
[2023-07-20 23:48:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 23:48:05] [config] lr-report: false
[2023-07-20 23:48:05] [config] lr-warmup: 0
[2023-07-20 23:48:05] [config] lr-warmup-at-reload: false
[2023-07-20 23:48:05] [config] lr-warmup-cycle: false
[2023-07-20 23:48:05] [config] lr-warmup-start-rate: 0
[2023-07-20 23:48:05] [config] max-length: 150
[2023-07-20 23:48:05] [config] max-length-crop: true
[2023-07-20 23:48:05] [config] max-length-factor: 3
[2023-07-20 23:48:05] [config] maxi-batch: 100
[2023-07-20 23:48:05] [config] maxi-batch-sort: trg
[2023-07-20 23:48:05] [config] mini-batch: 64
[2023-07-20 23:48:05] [config] mini-batch-fit: true
[2023-07-20 23:48:05] [config] mini-batch-fit-step: 10
[2023-07-20 23:48:05] [config] mini-batch-round-up: true
[2023-07-20 23:48:05] [config] mini-batch-track-lr: false
[2023-07-20 23:48:05] [config] mini-batch-warmup: 0
[2023-07-20 23:48:05] [config] mini-batch-words: 0
[2023-07-20 23:48:05] [config] mini-batch-words-ref: 0
[2023-07-20 23:48:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-20 23:48:05] [config] multi-loss-type: sum
[2023-07-20 23:48:05] [config] n-best: false
[2023-07-20 23:48:05] [config] no-nccl: false
[2023-07-20 23:48:05] [config] no-reload: false
[2023-07-20 23:48:05] [config] no-restore-corpus: false
[2023-07-20 23:48:05] [config] normalize: 0
[2023-07-20 23:48:05] [config] normalize-gradient: false
[2023-07-20 23:48:05] [config] num-devices: 0
[2023-07-20 23:48:05] [config] optimizer: adam
[2023-07-20 23:48:05] [config] optimizer-delay: 1
[2023-07-20 23:48:05] [config] optimizer-params:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] output-omit-bias: false
[2023-07-20 23:48:05] [config] overwrite: true
[2023-07-20 23:48:05] [config] precision:
[2023-07-20 23:48:05] [config]   - float16
[2023-07-20 23:48:05] [config]   - float32
[2023-07-20 23:48:05] [config] pretrained-model: ""
[2023-07-20 23:48:05] [config] quantize-biases: false
[2023-07-20 23:48:05] [config] quantize-bits: 0
[2023-07-20 23:48:05] [config] quantize-log-based: false
[2023-07-20 23:48:05] [config] quantize-optimization-steps: 0
[2023-07-20 23:48:05] [config] quiet: false
[2023-07-20 23:48:05] [config] quiet-translation: true
[2023-07-20 23:48:05] [config] relative-paths: false
[2023-07-20 23:48:05] [config] right-left: false
[2023-07-20 23:48:05] [config] save-freq: 10000u
[2023-07-20 23:48:05] [config] seed: 1234
[2023-07-20 23:48:05] [config] sentencepiece-alphas:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] sentencepiece-max-lines: 2000000
[2023-07-20 23:48:05] [config] sentencepiece-options: ""
[2023-07-20 23:48:05] [config] sharding: global
[2023-07-20 23:48:05] [config] shuffle: data
[2023-07-20 23:48:05] [config] shuffle-in-ram: false
[2023-07-20 23:48:05] [config] sigterm: save-and-exit
[2023-07-20 23:48:05] [config] skip: false
[2023-07-20 23:48:05] [config] sqlite: ""
[2023-07-20 23:48:05] [config] sqlite-drop: false
[2023-07-20 23:48:05] [config] sync-freq: 200u
[2023-07-20 23:48:05] [config] sync-sgd: false
[2023-07-20 23:48:05] [config] tempdir: /tmp
[2023-07-20 23:48:05] [config] tied-embeddings: false
[2023-07-20 23:48:05] [config] tied-embeddings-all: true
[2023-07-20 23:48:05] [config] tied-embeddings-src: false
[2023-07-20 23:48:05] [config] train-embedder-rank:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] train-sets:
[2023-07-20 23:48:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 23:48:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 23:48:05] [config] transformer-aan-activation: swish
[2023-07-20 23:48:05] [config] transformer-aan-depth: 2
[2023-07-20 23:48:05] [config] transformer-aan-nogate: false
[2023-07-20 23:48:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 23:48:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 23:48:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 23:48:05] [config] transformer-depth-scaling: false
[2023-07-20 23:48:05] [config] transformer-dim-aan: 2048
[2023-07-20 23:48:05] [config] transformer-dim-ffn: 2048
[2023-07-20 23:48:05] [config] transformer-dropout: 0
[2023-07-20 23:48:05] [config] transformer-dropout-attention: 0
[2023-07-20 23:48:05] [config] transformer-dropout-ffn: 0
[2023-07-20 23:48:05] [config] transformer-ffn-activation: swish
[2023-07-20 23:48:05] [config] transformer-ffn-depth: 2
[2023-07-20 23:48:05] [config] transformer-guided-alignment-layer: last
[2023-07-20 23:48:05] [config] transformer-heads: 8
[2023-07-20 23:48:05] [config] transformer-no-projection: false
[2023-07-20 23:48:05] [config] transformer-pool: false
[2023-07-20 23:48:05] [config] transformer-postprocess: dan
[2023-07-20 23:48:05] [config] transformer-postprocess-emb: d
[2023-07-20 23:48:05] [config] transformer-postprocess-top: ""
[2023-07-20 23:48:05] [config] transformer-preprocess: ""
[2023-07-20 23:48:05] [config] transformer-tied-layers:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] transformer-train-position-embeddings: false
[2023-07-20 23:48:05] [config] tsv: false
[2023-07-20 23:48:05] [config] tsv-fields: 0
[2023-07-20 23:48:05] [config] type: amun
[2023-07-20 23:48:05] [config] ulr: false
[2023-07-20 23:48:05] [config] ulr-dim-emb: 0
[2023-07-20 23:48:05] [config] ulr-dropout: 0
[2023-07-20 23:48:05] [config] ulr-keys-vectors: ""
[2023-07-20 23:48:05] [config] ulr-query-vectors: ""
[2023-07-20 23:48:05] [config] ulr-softmax-temperature: 1
[2023-07-20 23:48:05] [config] ulr-trainable-transformation: false
[2023-07-20 23:48:05] [config] unlikelihood-loss: false
[2023-07-20 23:48:05] [config] valid-freq: 50000000
[2023-07-20 23:48:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-20 23:48:05] [config] valid-max-length: 1000
[2023-07-20 23:48:05] [config] valid-metrics:
[2023-07-20 23:48:05] [config]   - cross-entropy
[2023-07-20 23:48:05] [config]   - translation
[2023-07-20 23:48:05] [config] valid-mini-batch: 32
[2023-07-20 23:48:05] [config] valid-reset-stalled: false
[2023-07-20 23:48:05] [config] valid-script-args:
[2023-07-20 23:48:05] [config]   []
[2023-07-20 23:48:05] [config] valid-script-path: ""
[2023-07-20 23:48:05] [config] valid-sets:
[2023-07-20 23:48:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 23:48:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 23:48:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-20 23:48:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 23:48:05] [config] vocabs:
[2023-07-20 23:48:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 23:48:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 23:48:05] [config] word-penalty: 0
[2023-07-20 23:48:05] [config] word-scores: false
[2023-07-20 23:48:05] [config] workspace: 5500
[2023-07-20 23:48:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 23:48:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 23:48:05] [training] Using single-device training
[2023-07-20 23:48:06] Synced seed 1234
[2023-07-20 23:48:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 23:48:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 23:48:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 23:48:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 23:48:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 23:48:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 23:48:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 23:48:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 23:48:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 23:48:07] [comm] Using global sharding
[2023-07-20 23:48:07] [comm] NCCLCommunicators constructed successfully
[2023-07-20 23:48:07] [training] Using 1 GPUs
[2023-07-20 23:48:07] [logits] Applying loss function for 1 factor(s)
[2023-07-20 23:48:07] [memory] Reserving 80 MB, device gpu0
[2023-07-20 23:48:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 23:48:08] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:19:38] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 00:19:38] [valid] No post-processing script given for validating translator
[2023-07-21 00:19:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 00:19:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 00:19:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 00:19:38] [comm] Using global sharding
[2023-07-21 00:19:38] [comm] NCCLCommunicators constructed successfully
[2023-07-21 00:19:38] [training] Using 1 GPUs
[2023-07-21 00:19:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 00:19:46] Allocating memory for general optimizer shards
[2023-07-21 00:19:46] [memory] Reserving 322 MB, device gpu0
[2023-07-21 00:19:46] Loading Adam parameters
[2023-07-21 00:19:46] [memory] Reserving 322 MB, device gpu0
[2023-07-21 00:19:46] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:19:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 00:19:46] [data] Restoring the corpus state to epoch 51, batch 1908
[2023-07-21 00:19:46] [data] Shuffling data
[2023-07-21 00:19:46] [data] Done reading 20,192 sentences
[2023-07-21 00:19:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:19:47] Training started
[2023-07-21 00:19:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 00:19:47] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:19:57] Parameter type float16, optimization type float32, casting types true
[2023-07-21 00:25:34] Seen 20,192 samples
[2023-07-21 00:25:34] Starting data epoch 52 in logical epoch 52
[2023-07-21 00:25:34] [data] Shuffling data
[2023-07-21 00:25:34] [data] Done reading 20,192 sentences
[2023-07-21 00:25:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:31:20] Seen 20,192 samples
[2023-07-21 00:31:20] Starting data epoch 53 in logical epoch 53
[2023-07-21 00:31:20] [data] Shuffling data
[2023-07-21 00:31:20] [data] Done reading 20,192 sentences
[2023-07-21 00:31:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:33:47] Ep. 53 : Up. 2000 : Sen. 9,789 : Cost 4.95307779 * 16,270,132 @ 1,153 after 32,509,322 : Time 848.99s : 19164.20 words/s : gNorm 0.8981
[2023-07-21 00:37:15] Seen 20,192 samples
[2023-07-21 00:37:15] Starting data epoch 54 in logical epoch 54
[2023-07-21 00:37:15] [data] Shuffling data
[2023-07-21 00:37:16] [data] Done reading 20,192 sentences
[2023-07-21 00:37:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:43:10] Seen 20,192 samples
[2023-07-21 00:43:10] Starting data epoch 55 in logical epoch 55
[2023-07-21 00:43:10] [data] Shuffling data
[2023-07-21 00:43:10] [data] Done reading 20,192 sentences
[2023-07-21 00:43:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:49:02] Seen 20,192 samples
[2023-07-21 00:49:02] Starting data epoch 56 in logical epoch 56
[2023-07-21 00:49:02] [data] Shuffling data
[2023-07-21 00:49:02] [data] Done reading 20,192 sentences
[2023-07-21 00:49:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:54:51] Seen 20,192 samples
[2023-07-21 00:54:51] Starting data epoch 57 in logical epoch 57
[2023-07-21 00:54:51] [data] Shuffling data
[2023-07-21 00:54:51] [data] Done reading 20,192 sentences
[2023-07-21 00:54:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:00:40] Seen 20,192 samples
[2023-07-21 01:00:40] Starting data epoch 58 in logical epoch 58
[2023-07-21 01:00:40] [data] Shuffling data
[2023-07-21 01:00:40] [data] Done reading 20,192 sentences
[2023-07-21 01:00:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:06:34] Seen 20,192 samples
[2023-07-21 01:06:34] Starting data epoch 59 in logical epoch 59
[2023-07-21 01:06:34] [data] Shuffling data
[2023-07-21 01:06:35] [data] Done reading 20,192 sentences
[2023-07-21 01:06:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:12:21] Seen 20,192 samples
[2023-07-21 01:12:21] Starting data epoch 60 in logical epoch 60
[2023-07-21 01:12:21] [data] Shuffling data
[2023-07-21 01:12:21] [data] Done reading 20,192 sentences
[2023-07-21 01:12:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:18:19] Seen 20,192 samples
[2023-07-21 01:18:19] Starting data epoch 61 in logical epoch 61
[2023-07-21 01:18:19] Training finished
[2023-07-21 01:18:38] [valid] Ep. 61 : Up. 2287 : cross-entropy : 141.625 : new best
[2023-07-21 01:21:04] [valid] Ep. 61 : Up. 2287 : translation : 0 : new best
[2023-07-21 01:21:04] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 01:21:06] Saving Adam parameters
[2023-07-21 01:21:07] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 01:21:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 01:21:16] [marian] Running on node23.datos.cluster.uy as process 40375 with command line:
[2023-07-21 01:21:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 01:21:16] [config] after: 0e
[2023-07-21 01:21:16] [config] after-batches: 0
[2023-07-21 01:21:16] [config] after-epochs: 70
[2023-07-21 01:21:16] [config] all-caps-every: 0
[2023-07-21 01:21:16] [config] allow-unk: false
[2023-07-21 01:21:16] [config] authors: false
[2023-07-21 01:21:16] [config] beam-size: 12
[2023-07-21 01:21:16] [config] bert-class-symbol: "[CLS]"
[2023-07-21 01:21:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 01:21:16] [config] bert-masking-fraction: 0.15
[2023-07-21 01:21:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 01:21:16] [config] bert-train-type-embeddings: true
[2023-07-21 01:21:16] [config] bert-type-vocab-size: 2
[2023-07-21 01:21:16] [config] build-info: ""
[2023-07-21 01:21:16] [config] check-gradient-nan: false
[2023-07-21 01:21:16] [config] check-nan: false
[2023-07-21 01:21:16] [config] cite: false
[2023-07-21 01:21:16] [config] clip-norm: 1
[2023-07-21 01:21:16] [config] cost-scaling:
[2023-07-21 01:21:16] [config]   - 256.f
[2023-07-21 01:21:16] [config]   - 1000
[2023-07-21 01:21:16] [config]   - 2.f
[2023-07-21 01:21:16] [config]   - 256.f
[2023-07-21 01:21:16] [config] cost-type: ce-sum
[2023-07-21 01:21:16] [config] cpu-threads: 0
[2023-07-21 01:21:16] [config] data-threads: 8
[2023-07-21 01:21:16] [config] data-weighting: ""
[2023-07-21 01:21:16] [config] data-weighting-type: sentence
[2023-07-21 01:21:16] [config] dec-cell: gru
[2023-07-21 01:21:16] [config] dec-cell-base-depth: 2
[2023-07-21 01:21:16] [config] dec-cell-high-depth: 1
[2023-07-21 01:21:16] [config] dec-depth: 1
[2023-07-21 01:21:16] [config] devices:
[2023-07-21 01:21:16] [config]   - 0
[2023-07-21 01:21:16] [config] dim-emb: 512
[2023-07-21 01:21:16] [config] dim-rnn: 1024
[2023-07-21 01:21:16] [config] dim-vocabs:
[2023-07-21 01:21:16] [config]   - 16384
[2023-07-21 01:21:16] [config]   - 16384
[2023-07-21 01:21:16] [config] disp-first: 0
[2023-07-21 01:21:16] [config] disp-freq: 1000u
[2023-07-21 01:21:16] [config] disp-label-counts: true
[2023-07-21 01:21:16] [config] dropout-rnn: 0
[2023-07-21 01:21:16] [config] dropout-src: 0
[2023-07-21 01:21:16] [config] dropout-trg: 0
[2023-07-21 01:21:16] [config] dump-config: ""
[2023-07-21 01:21:16] [config] dynamic-gradient-scaling:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] early-stopping: 200
[2023-07-21 01:21:16] [config] early-stopping-on: first
[2023-07-21 01:21:16] [config] embedding-fix-src: false
[2023-07-21 01:21:16] [config] embedding-fix-trg: false
[2023-07-21 01:21:16] [config] embedding-normalization: false
[2023-07-21 01:21:16] [config] embedding-vectors:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] enc-cell: gru
[2023-07-21 01:21:16] [config] enc-cell-depth: 1
[2023-07-21 01:21:16] [config] enc-depth: 1
[2023-07-21 01:21:16] [config] enc-type: bidirectional
[2023-07-21 01:21:16] [config] english-title-case-every: 0
[2023-07-21 01:21:16] [config] exponential-smoothing: 0
[2023-07-21 01:21:16] [config] factor-weight: 1
[2023-07-21 01:21:16] [config] factors-combine: sum
[2023-07-21 01:21:16] [config] factors-dim-emb: 0
[2023-07-21 01:21:16] [config] gradient-checkpointing: false
[2023-07-21 01:21:16] [config] gradient-norm-average-window: 100
[2023-07-21 01:21:16] [config] guided-alignment: none
[2023-07-21 01:21:16] [config] guided-alignment-cost: mse
[2023-07-21 01:21:16] [config] guided-alignment-weight: 0.1
[2023-07-21 01:21:16] [config] ignore-model-config: false
[2023-07-21 01:21:16] [config] input-types:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] interpolate-env-vars: false
[2023-07-21 01:21:16] [config] keep-best: false
[2023-07-21 01:21:16] [config] label-smoothing: 0
[2023-07-21 01:21:16] [config] layer-normalization: false
[2023-07-21 01:21:16] [config] learn-rate: 0.0001
[2023-07-21 01:21:16] [config] lemma-dependency: ""
[2023-07-21 01:21:16] [config] lemma-dim-emb: 0
[2023-07-21 01:21:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 01:21:16] [config] log-level: info
[2023-07-21 01:21:16] [config] log-time-zone: ""
[2023-07-21 01:21:16] [config] logical-epoch:
[2023-07-21 01:21:16] [config]   - 1e
[2023-07-21 01:21:16] [config]   - 0
[2023-07-21 01:21:16] [config] lr-decay: 0
[2023-07-21 01:21:16] [config] lr-decay-freq: 50000
[2023-07-21 01:21:16] [config] lr-decay-inv-sqrt:
[2023-07-21 01:21:16] [config]   - 0
[2023-07-21 01:21:16] [config] lr-decay-repeat-warmup: false
[2023-07-21 01:21:16] [config] lr-decay-reset-optimizer: false
[2023-07-21 01:21:16] [config] lr-decay-start:
[2023-07-21 01:21:16] [config]   - 10
[2023-07-21 01:21:16] [config]   - 1
[2023-07-21 01:21:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 01:21:16] [config] lr-report: false
[2023-07-21 01:21:16] [config] lr-warmup: 0
[2023-07-21 01:21:16] [config] lr-warmup-at-reload: false
[2023-07-21 01:21:16] [config] lr-warmup-cycle: false
[2023-07-21 01:21:16] [config] lr-warmup-start-rate: 0
[2023-07-21 01:21:16] [config] max-length: 150
[2023-07-21 01:21:16] [config] max-length-crop: true
[2023-07-21 01:21:16] [config] max-length-factor: 3
[2023-07-21 01:21:16] [config] maxi-batch: 100
[2023-07-21 01:21:16] [config] maxi-batch-sort: trg
[2023-07-21 01:21:16] [config] mini-batch: 64
[2023-07-21 01:21:16] [config] mini-batch-fit: true
[2023-07-21 01:21:16] [config] mini-batch-fit-step: 10
[2023-07-21 01:21:16] [config] mini-batch-round-up: true
[2023-07-21 01:21:16] [config] mini-batch-track-lr: false
[2023-07-21 01:21:16] [config] mini-batch-warmup: 0
[2023-07-21 01:21:16] [config] mini-batch-words: 0
[2023-07-21 01:21:16] [config] mini-batch-words-ref: 0
[2023-07-21 01:21:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 01:21:16] [config] multi-loss-type: sum
[2023-07-21 01:21:16] [config] n-best: false
[2023-07-21 01:21:16] [config] no-nccl: false
[2023-07-21 01:21:16] [config] no-reload: false
[2023-07-21 01:21:16] [config] no-restore-corpus: false
[2023-07-21 01:21:16] [config] normalize: 0
[2023-07-21 01:21:16] [config] normalize-gradient: false
[2023-07-21 01:21:16] [config] num-devices: 0
[2023-07-21 01:21:16] [config] optimizer: adam
[2023-07-21 01:21:16] [config] optimizer-delay: 1
[2023-07-21 01:21:16] [config] optimizer-params:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] output-omit-bias: false
[2023-07-21 01:21:16] [config] overwrite: true
[2023-07-21 01:21:16] [config] precision:
[2023-07-21 01:21:16] [config]   - float16
[2023-07-21 01:21:16] [config]   - float32
[2023-07-21 01:21:16] [config] pretrained-model: ""
[2023-07-21 01:21:16] [config] quantize-biases: false
[2023-07-21 01:21:16] [config] quantize-bits: 0
[2023-07-21 01:21:16] [config] quantize-log-based: false
[2023-07-21 01:21:16] [config] quantize-optimization-steps: 0
[2023-07-21 01:21:16] [config] quiet: false
[2023-07-21 01:21:16] [config] quiet-translation: true
[2023-07-21 01:21:16] [config] relative-paths: false
[2023-07-21 01:21:16] [config] right-left: false
[2023-07-21 01:21:16] [config] save-freq: 10000u
[2023-07-21 01:21:16] [config] seed: 1234
[2023-07-21 01:21:16] [config] sentencepiece-alphas:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] sentencepiece-max-lines: 2000000
[2023-07-21 01:21:16] [config] sentencepiece-options: ""
[2023-07-21 01:21:16] [config] sharding: global
[2023-07-21 01:21:16] [config] shuffle: data
[2023-07-21 01:21:16] [config] shuffle-in-ram: false
[2023-07-21 01:21:16] [config] sigterm: save-and-exit
[2023-07-21 01:21:16] [config] skip: false
[2023-07-21 01:21:16] [config] sqlite: ""
[2023-07-21 01:21:16] [config] sqlite-drop: false
[2023-07-21 01:21:16] [config] sync-freq: 200u
[2023-07-21 01:21:16] [config] sync-sgd: false
[2023-07-21 01:21:16] [config] tempdir: /tmp
[2023-07-21 01:21:16] [config] tied-embeddings: false
[2023-07-21 01:21:16] [config] tied-embeddings-all: true
[2023-07-21 01:21:16] [config] tied-embeddings-src: false
[2023-07-21 01:21:16] [config] train-embedder-rank:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] train-sets:
[2023-07-21 01:21:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 01:21:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 01:21:16] [config] transformer-aan-activation: swish
[2023-07-21 01:21:16] [config] transformer-aan-depth: 2
[2023-07-21 01:21:16] [config] transformer-aan-nogate: false
[2023-07-21 01:21:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 01:21:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 01:21:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 01:21:16] [config] transformer-depth-scaling: false
[2023-07-21 01:21:16] [config] transformer-dim-aan: 2048
[2023-07-21 01:21:16] [config] transformer-dim-ffn: 2048
[2023-07-21 01:21:16] [config] transformer-dropout: 0
[2023-07-21 01:21:16] [config] transformer-dropout-attention: 0
[2023-07-21 01:21:16] [config] transformer-dropout-ffn: 0
[2023-07-21 01:21:16] [config] transformer-ffn-activation: swish
[2023-07-21 01:21:16] [config] transformer-ffn-depth: 2
[2023-07-21 01:21:16] [config] transformer-guided-alignment-layer: last
[2023-07-21 01:21:16] [config] transformer-heads: 8
[2023-07-21 01:21:16] [config] transformer-no-projection: false
[2023-07-21 01:21:16] [config] transformer-pool: false
[2023-07-21 01:21:16] [config] transformer-postprocess: dan
[2023-07-21 01:21:16] [config] transformer-postprocess-emb: d
[2023-07-21 01:21:16] [config] transformer-postprocess-top: ""
[2023-07-21 01:21:16] [config] transformer-preprocess: ""
[2023-07-21 01:21:16] [config] transformer-tied-layers:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] transformer-train-position-embeddings: false
[2023-07-21 01:21:16] [config] tsv: false
[2023-07-21 01:21:16] [config] tsv-fields: 0
[2023-07-21 01:21:16] [config] type: amun
[2023-07-21 01:21:16] [config] ulr: false
[2023-07-21 01:21:16] [config] ulr-dim-emb: 0
[2023-07-21 01:21:16] [config] ulr-dropout: 0
[2023-07-21 01:21:16] [config] ulr-keys-vectors: ""
[2023-07-21 01:21:16] [config] ulr-query-vectors: ""
[2023-07-21 01:21:16] [config] ulr-softmax-temperature: 1
[2023-07-21 01:21:16] [config] ulr-trainable-transformation: false
[2023-07-21 01:21:16] [config] unlikelihood-loss: false
[2023-07-21 01:21:16] [config] valid-freq: 50000000
[2023-07-21 01:21:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 01:21:16] [config] valid-max-length: 1000
[2023-07-21 01:21:16] [config] valid-metrics:
[2023-07-21 01:21:16] [config]   - cross-entropy
[2023-07-21 01:21:16] [config]   - translation
[2023-07-21 01:21:16] [config] valid-mini-batch: 32
[2023-07-21 01:21:16] [config] valid-reset-stalled: false
[2023-07-21 01:21:16] [config] valid-script-args:
[2023-07-21 01:21:16] [config]   []
[2023-07-21 01:21:16] [config] valid-script-path: ""
[2023-07-21 01:21:16] [config] valid-sets:
[2023-07-21 01:21:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 01:21:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 01:21:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 01:21:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 01:21:16] [config] vocabs:
[2023-07-21 01:21:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 01:21:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 01:21:16] [config] word-penalty: 0
[2023-07-21 01:21:16] [config] word-scores: false
[2023-07-21 01:21:16] [config] workspace: 5500
[2023-07-21 01:21:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 01:21:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 01:21:16] [training] Using single-device training
[2023-07-21 01:21:16] Synced seed 1234
[2023-07-21 01:21:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 01:21:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 01:21:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 01:21:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 01:21:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 01:21:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 01:21:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 01:21:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 01:21:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 01:21:18] [comm] Using global sharding
[2023-07-21 01:21:18] [comm] NCCLCommunicators constructed successfully
[2023-07-21 01:21:18] [training] Using 1 GPUs
[2023-07-21 01:21:18] [logits] Applying loss function for 1 factor(s)
[2023-07-21 01:21:18] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:21:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 01:21:18] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:52:28] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 01:52:29] [valid] No post-processing script given for validating translator
[2023-07-21 01:52:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 01:52:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 01:52:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 01:52:29] [comm] Using global sharding
[2023-07-21 01:52:29] [comm] NCCLCommunicators constructed successfully
[2023-07-21 01:52:29] [training] Using 1 GPUs
[2023-07-21 01:52:29] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 01:52:37] Allocating memory for general optimizer shards
[2023-07-21 01:52:37] [memory] Reserving 322 MB, device gpu0
[2023-07-21 01:52:37] Loading Adam parameters
[2023-07-21 01:52:37] [memory] Reserving 322 MB, device gpu0
[2023-07-21 01:52:37] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:52:37] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 01:52:37] [data] Restoring the corpus state to epoch 61, batch 2287
[2023-07-21 01:52:37] [data] Shuffling data
[2023-07-21 01:52:37] [data] Done reading 20,192 sentences
[2023-07-21 01:52:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:52:37] Training started
[2023-07-21 01:52:37] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 01:52:38] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:52:42] Parameter type float16, optimization type float32, casting types true
[2023-07-21 01:57:55] Seen 20,192 samples
[2023-07-21 01:57:55] Starting data epoch 62 in logical epoch 62
[2023-07-21 01:57:55] [data] Shuffling data
[2023-07-21 01:57:55] [data] Done reading 20,192 sentences
[2023-07-21 01:57:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:03:27] Seen 20,192 samples
[2023-07-21 02:03:27] Starting data epoch 63 in logical epoch 63
[2023-07-21 02:03:27] [data] Shuffling data
[2023-07-21 02:03:27] [data] Done reading 20,192 sentences
[2023-07-21 02:03:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:09:04] Seen 20,192 samples
[2023-07-21 02:09:04] Starting data epoch 64 in logical epoch 64
[2023-07-21 02:09:04] [data] Shuffling data
[2023-07-21 02:09:04] [data] Done reading 20,192 sentences
[2023-07-21 02:09:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:14:47] Seen 20,192 samples
[2023-07-21 02:14:47] Starting data epoch 65 in logical epoch 65
[2023-07-21 02:14:47] [data] Shuffling data
[2023-07-21 02:14:47] [data] Done reading 20,192 sentences
[2023-07-21 02:14:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:20:18] Seen 20,192 samples
[2023-07-21 02:20:18] Starting data epoch 66 in logical epoch 66
[2023-07-21 02:20:18] [data] Shuffling data
[2023-07-21 02:20:18] [data] Done reading 20,192 sentences
[2023-07-21 02:20:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:25:51] Seen 20,192 samples
[2023-07-21 02:25:51] Starting data epoch 67 in logical epoch 67
[2023-07-21 02:25:51] [data] Shuffling data
[2023-07-21 02:25:51] [data] Done reading 20,192 sentences
[2023-07-21 02:25:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:31:22] Seen 20,192 samples
[2023-07-21 02:31:22] Starting data epoch 68 in logical epoch 68
[2023-07-21 02:31:22] [data] Shuffling data
[2023-07-21 02:31:22] [data] Done reading 20,192 sentences
[2023-07-21 02:31:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:37:06] Seen 20,192 samples
[2023-07-21 02:37:06] Starting data epoch 69 in logical epoch 69
[2023-07-21 02:37:06] [data] Shuffling data
[2023-07-21 02:37:06] [data] Done reading 20,192 sentences
[2023-07-21 02:37:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:42:43] Seen 20,192 samples
[2023-07-21 02:42:43] Starting data epoch 70 in logical epoch 70
[2023-07-21 02:42:43] [data] Shuffling data
[2023-07-21 02:42:43] [data] Done reading 20,192 sentences
[2023-07-21 02:42:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:48:14] Seen 20,192 samples
[2023-07-21 02:48:14] Starting data epoch 71 in logical epoch 71
[2023-07-21 02:48:14] Training finished
[2023-07-21 02:48:30] [valid] Ep. 71 : Up. 2669 : cross-entropy : 138.347 : new best
[2023-07-21 02:50:53] [valid] Ep. 71 : Up. 2669 : translation : 0 : new best
[2023-07-21 02:50:53] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 02:50:56] Saving Adam parameters
[2023-07-21 02:50:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 02:51:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 02:51:03] [marian] Running on node23.datos.cluster.uy as process 5959 with command line:
[2023-07-21 02:51:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 02:51:03] [config] after: 0e
[2023-07-21 02:51:03] [config] after-batches: 0
[2023-07-21 02:51:03] [config] after-epochs: 80
[2023-07-21 02:51:03] [config] all-caps-every: 0
[2023-07-21 02:51:03] [config] allow-unk: false
[2023-07-21 02:51:03] [config] authors: false
[2023-07-21 02:51:03] [config] beam-size: 12
[2023-07-21 02:51:03] [config] bert-class-symbol: "[CLS]"
[2023-07-21 02:51:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 02:51:03] [config] bert-masking-fraction: 0.15
[2023-07-21 02:51:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 02:51:03] [config] bert-train-type-embeddings: true
[2023-07-21 02:51:03] [config] bert-type-vocab-size: 2
[2023-07-21 02:51:03] [config] build-info: ""
[2023-07-21 02:51:03] [config] check-gradient-nan: false
[2023-07-21 02:51:03] [config] check-nan: false
[2023-07-21 02:51:03] [config] cite: false
[2023-07-21 02:51:03] [config] clip-norm: 1
[2023-07-21 02:51:03] [config] cost-scaling:
[2023-07-21 02:51:03] [config]   - 256.f
[2023-07-21 02:51:03] [config]   - 1000
[2023-07-21 02:51:03] [config]   - 2.f
[2023-07-21 02:51:03] [config]   - 256.f
[2023-07-21 02:51:03] [config] cost-type: ce-sum
[2023-07-21 02:51:03] [config] cpu-threads: 0
[2023-07-21 02:51:03] [config] data-threads: 8
[2023-07-21 02:51:03] [config] data-weighting: ""
[2023-07-21 02:51:03] [config] data-weighting-type: sentence
[2023-07-21 02:51:03] [config] dec-cell: gru
[2023-07-21 02:51:03] [config] dec-cell-base-depth: 2
[2023-07-21 02:51:03] [config] dec-cell-high-depth: 1
[2023-07-21 02:51:03] [config] dec-depth: 1
[2023-07-21 02:51:03] [config] devices:
[2023-07-21 02:51:03] [config]   - 0
[2023-07-21 02:51:03] [config] dim-emb: 512
[2023-07-21 02:51:03] [config] dim-rnn: 1024
[2023-07-21 02:51:03] [config] dim-vocabs:
[2023-07-21 02:51:03] [config]   - 16384
[2023-07-21 02:51:03] [config]   - 16384
[2023-07-21 02:51:03] [config] disp-first: 0
[2023-07-21 02:51:03] [config] disp-freq: 1000u
[2023-07-21 02:51:03] [config] disp-label-counts: true
[2023-07-21 02:51:03] [config] dropout-rnn: 0
[2023-07-21 02:51:03] [config] dropout-src: 0
[2023-07-21 02:51:03] [config] dropout-trg: 0
[2023-07-21 02:51:03] [config] dump-config: ""
[2023-07-21 02:51:03] [config] dynamic-gradient-scaling:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] early-stopping: 200
[2023-07-21 02:51:03] [config] early-stopping-on: first
[2023-07-21 02:51:03] [config] embedding-fix-src: false
[2023-07-21 02:51:03] [config] embedding-fix-trg: false
[2023-07-21 02:51:03] [config] embedding-normalization: false
[2023-07-21 02:51:03] [config] embedding-vectors:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] enc-cell: gru
[2023-07-21 02:51:03] [config] enc-cell-depth: 1
[2023-07-21 02:51:03] [config] enc-depth: 1
[2023-07-21 02:51:03] [config] enc-type: bidirectional
[2023-07-21 02:51:03] [config] english-title-case-every: 0
[2023-07-21 02:51:03] [config] exponential-smoothing: 0
[2023-07-21 02:51:03] [config] factor-weight: 1
[2023-07-21 02:51:03] [config] factors-combine: sum
[2023-07-21 02:51:03] [config] factors-dim-emb: 0
[2023-07-21 02:51:03] [config] gradient-checkpointing: false
[2023-07-21 02:51:03] [config] gradient-norm-average-window: 100
[2023-07-21 02:51:03] [config] guided-alignment: none
[2023-07-21 02:51:03] [config] guided-alignment-cost: mse
[2023-07-21 02:51:03] [config] guided-alignment-weight: 0.1
[2023-07-21 02:51:03] [config] ignore-model-config: false
[2023-07-21 02:51:03] [config] input-types:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] interpolate-env-vars: false
[2023-07-21 02:51:03] [config] keep-best: false
[2023-07-21 02:51:03] [config] label-smoothing: 0
[2023-07-21 02:51:03] [config] layer-normalization: false
[2023-07-21 02:51:03] [config] learn-rate: 0.0001
[2023-07-21 02:51:03] [config] lemma-dependency: ""
[2023-07-21 02:51:03] [config] lemma-dim-emb: 0
[2023-07-21 02:51:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 02:51:03] [config] log-level: info
[2023-07-21 02:51:03] [config] log-time-zone: ""
[2023-07-21 02:51:03] [config] logical-epoch:
[2023-07-21 02:51:03] [config]   - 1e
[2023-07-21 02:51:03] [config]   - 0
[2023-07-21 02:51:03] [config] lr-decay: 0
[2023-07-21 02:51:03] [config] lr-decay-freq: 50000
[2023-07-21 02:51:03] [config] lr-decay-inv-sqrt:
[2023-07-21 02:51:03] [config]   - 0
[2023-07-21 02:51:03] [config] lr-decay-repeat-warmup: false
[2023-07-21 02:51:03] [config] lr-decay-reset-optimizer: false
[2023-07-21 02:51:03] [config] lr-decay-start:
[2023-07-21 02:51:03] [config]   - 10
[2023-07-21 02:51:03] [config]   - 1
[2023-07-21 02:51:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 02:51:03] [config] lr-report: false
[2023-07-21 02:51:03] [config] lr-warmup: 0
[2023-07-21 02:51:03] [config] lr-warmup-at-reload: false
[2023-07-21 02:51:03] [config] lr-warmup-cycle: false
[2023-07-21 02:51:03] [config] lr-warmup-start-rate: 0
[2023-07-21 02:51:03] [config] max-length: 150
[2023-07-21 02:51:03] [config] max-length-crop: true
[2023-07-21 02:51:03] [config] max-length-factor: 3
[2023-07-21 02:51:03] [config] maxi-batch: 100
[2023-07-21 02:51:03] [config] maxi-batch-sort: trg
[2023-07-21 02:51:03] [config] mini-batch: 64
[2023-07-21 02:51:03] [config] mini-batch-fit: true
[2023-07-21 02:51:03] [config] mini-batch-fit-step: 10
[2023-07-21 02:51:03] [config] mini-batch-round-up: true
[2023-07-21 02:51:03] [config] mini-batch-track-lr: false
[2023-07-21 02:51:03] [config] mini-batch-warmup: 0
[2023-07-21 02:51:03] [config] mini-batch-words: 0
[2023-07-21 02:51:03] [config] mini-batch-words-ref: 0
[2023-07-21 02:51:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 02:51:03] [config] multi-loss-type: sum
[2023-07-21 02:51:03] [config] n-best: false
[2023-07-21 02:51:03] [config] no-nccl: false
[2023-07-21 02:51:03] [config] no-reload: false
[2023-07-21 02:51:03] [config] no-restore-corpus: false
[2023-07-21 02:51:03] [config] normalize: 0
[2023-07-21 02:51:03] [config] normalize-gradient: false
[2023-07-21 02:51:03] [config] num-devices: 0
[2023-07-21 02:51:03] [config] optimizer: adam
[2023-07-21 02:51:03] [config] optimizer-delay: 1
[2023-07-21 02:51:03] [config] optimizer-params:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] output-omit-bias: false
[2023-07-21 02:51:03] [config] overwrite: true
[2023-07-21 02:51:03] [config] precision:
[2023-07-21 02:51:03] [config]   - float16
[2023-07-21 02:51:03] [config]   - float32
[2023-07-21 02:51:03] [config] pretrained-model: ""
[2023-07-21 02:51:03] [config] quantize-biases: false
[2023-07-21 02:51:03] [config] quantize-bits: 0
[2023-07-21 02:51:03] [config] quantize-log-based: false
[2023-07-21 02:51:03] [config] quantize-optimization-steps: 0
[2023-07-21 02:51:03] [config] quiet: false
[2023-07-21 02:51:03] [config] quiet-translation: true
[2023-07-21 02:51:03] [config] relative-paths: false
[2023-07-21 02:51:03] [config] right-left: false
[2023-07-21 02:51:03] [config] save-freq: 10000u
[2023-07-21 02:51:03] [config] seed: 1234
[2023-07-21 02:51:03] [config] sentencepiece-alphas:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] sentencepiece-max-lines: 2000000
[2023-07-21 02:51:03] [config] sentencepiece-options: ""
[2023-07-21 02:51:03] [config] sharding: global
[2023-07-21 02:51:03] [config] shuffle: data
[2023-07-21 02:51:03] [config] shuffle-in-ram: false
[2023-07-21 02:51:03] [config] sigterm: save-and-exit
[2023-07-21 02:51:03] [config] skip: false
[2023-07-21 02:51:03] [config] sqlite: ""
[2023-07-21 02:51:03] [config] sqlite-drop: false
[2023-07-21 02:51:03] [config] sync-freq: 200u
[2023-07-21 02:51:03] [config] sync-sgd: false
[2023-07-21 02:51:03] [config] tempdir: /tmp
[2023-07-21 02:51:03] [config] tied-embeddings: false
[2023-07-21 02:51:03] [config] tied-embeddings-all: true
[2023-07-21 02:51:03] [config] tied-embeddings-src: false
[2023-07-21 02:51:03] [config] train-embedder-rank:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] train-sets:
[2023-07-21 02:51:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 02:51:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 02:51:03] [config] transformer-aan-activation: swish
[2023-07-21 02:51:03] [config] transformer-aan-depth: 2
[2023-07-21 02:51:03] [config] transformer-aan-nogate: false
[2023-07-21 02:51:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 02:51:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 02:51:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 02:51:03] [config] transformer-depth-scaling: false
[2023-07-21 02:51:03] [config] transformer-dim-aan: 2048
[2023-07-21 02:51:03] [config] transformer-dim-ffn: 2048
[2023-07-21 02:51:03] [config] transformer-dropout: 0
[2023-07-21 02:51:03] [config] transformer-dropout-attention: 0
[2023-07-21 02:51:03] [config] transformer-dropout-ffn: 0
[2023-07-21 02:51:03] [config] transformer-ffn-activation: swish
[2023-07-21 02:51:03] [config] transformer-ffn-depth: 2
[2023-07-21 02:51:03] [config] transformer-guided-alignment-layer: last
[2023-07-21 02:51:03] [config] transformer-heads: 8
[2023-07-21 02:51:03] [config] transformer-no-projection: false
[2023-07-21 02:51:03] [config] transformer-pool: false
[2023-07-21 02:51:03] [config] transformer-postprocess: dan
[2023-07-21 02:51:03] [config] transformer-postprocess-emb: d
[2023-07-21 02:51:03] [config] transformer-postprocess-top: ""
[2023-07-21 02:51:03] [config] transformer-preprocess: ""
[2023-07-21 02:51:03] [config] transformer-tied-layers:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] transformer-train-position-embeddings: false
[2023-07-21 02:51:03] [config] tsv: false
[2023-07-21 02:51:03] [config] tsv-fields: 0
[2023-07-21 02:51:03] [config] type: amun
[2023-07-21 02:51:03] [config] ulr: false
[2023-07-21 02:51:03] [config] ulr-dim-emb: 0
[2023-07-21 02:51:03] [config] ulr-dropout: 0
[2023-07-21 02:51:03] [config] ulr-keys-vectors: ""
[2023-07-21 02:51:03] [config] ulr-query-vectors: ""
[2023-07-21 02:51:03] [config] ulr-softmax-temperature: 1
[2023-07-21 02:51:03] [config] ulr-trainable-transformation: false
[2023-07-21 02:51:03] [config] unlikelihood-loss: false
[2023-07-21 02:51:03] [config] valid-freq: 50000000
[2023-07-21 02:51:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 02:51:03] [config] valid-max-length: 1000
[2023-07-21 02:51:03] [config] valid-metrics:
[2023-07-21 02:51:03] [config]   - cross-entropy
[2023-07-21 02:51:03] [config]   - translation
[2023-07-21 02:51:03] [config] valid-mini-batch: 32
[2023-07-21 02:51:03] [config] valid-reset-stalled: false
[2023-07-21 02:51:03] [config] valid-script-args:
[2023-07-21 02:51:03] [config]   []
[2023-07-21 02:51:03] [config] valid-script-path: ""
[2023-07-21 02:51:03] [config] valid-sets:
[2023-07-21 02:51:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 02:51:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 02:51:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 02:51:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 02:51:03] [config] vocabs:
[2023-07-21 02:51:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 02:51:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 02:51:03] [config] word-penalty: 0
[2023-07-21 02:51:03] [config] word-scores: false
[2023-07-21 02:51:03] [config] workspace: 5500
[2023-07-21 02:51:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 02:51:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 02:51:03] [training] Using single-device training
[2023-07-21 02:51:05] Synced seed 1234
[2023-07-21 02:51:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 02:51:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 02:51:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 02:51:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 02:51:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 02:51:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 02:51:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 02:51:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 02:51:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 02:51:06] [comm] Using global sharding
[2023-07-21 02:51:06] [comm] NCCLCommunicators constructed successfully
[2023-07-21 02:51:06] [training] Using 1 GPUs
[2023-07-21 02:51:06] [logits] Applying loss function for 1 factor(s)
[2023-07-21 02:51:06] [memory] Reserving 80 MB, device gpu0
[2023-07-21 02:51:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 02:51:06] [memory] Reserving 80 MB, device gpu0
[2023-07-21 03:22:00] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 03:22:00] [valid] No post-processing script given for validating translator
[2023-07-21 03:22:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 03:22:00] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 03:22:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 03:22:00] [comm] Using global sharding
[2023-07-21 03:22:00] [comm] NCCLCommunicators constructed successfully
[2023-07-21 03:22:00] [training] Using 1 GPUs
[2023-07-21 03:22:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 03:22:09] Allocating memory for general optimizer shards
[2023-07-21 03:22:09] [memory] Reserving 322 MB, device gpu0
[2023-07-21 03:22:09] Loading Adam parameters
[2023-07-21 03:22:09] [memory] Reserving 322 MB, device gpu0
[2023-07-21 03:22:09] [memory] Reserving 80 MB, device gpu0
[2023-07-21 03:22:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 03:22:09] [data] Restoring the corpus state to epoch 71, batch 2669
[2023-07-21 03:22:09] [data] Shuffling data
[2023-07-21 03:22:10] [data] Done reading 20,192 sentences
[2023-07-21 03:22:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:22:10] Training started
[2023-07-21 03:22:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 03:22:11] [memory] Reserving 80 MB, device gpu0
[2023-07-21 03:22:26] Parameter type float16, optimization type float32, casting types true
[2023-07-21 03:27:14] Seen 20,192 samples
[2023-07-21 03:27:14] Starting data epoch 72 in logical epoch 72
[2023-07-21 03:27:14] [data] Shuffling data
[2023-07-21 03:27:14] [data] Done reading 20,192 sentences
[2023-07-21 03:27:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:32:38] Seen 20,192 samples
[2023-07-21 03:32:38] Starting data epoch 73 in logical epoch 73
[2023-07-21 03:32:38] [data] Shuffling data
[2023-07-21 03:32:38] [data] Done reading 20,192 sentences
[2023-07-21 03:32:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:38:12] Seen 20,192 samples
[2023-07-21 03:38:12] Starting data epoch 74 in logical epoch 74
[2023-07-21 03:38:12] [data] Shuffling data
[2023-07-21 03:38:12] [data] Done reading 20,192 sentences
[2023-07-21 03:38:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:43:40] Seen 20,192 samples
[2023-07-21 03:43:40] Starting data epoch 75 in logical epoch 75
[2023-07-21 03:43:40] [data] Shuffling data
[2023-07-21 03:43:40] [data] Done reading 20,192 sentences
[2023-07-21 03:43:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:49:10] Seen 20,192 samples
[2023-07-21 03:49:10] Starting data epoch 76 in logical epoch 76
[2023-07-21 03:49:10] [data] Shuffling data
[2023-07-21 03:49:10] [data] Done reading 20,192 sentences
[2023-07-21 03:49:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:54:28] Seen 20,192 samples
[2023-07-21 03:54:28] Starting data epoch 77 in logical epoch 77
[2023-07-21 03:54:28] [data] Shuffling data
[2023-07-21 03:54:28] [data] Done reading 20,192 sentences
[2023-07-21 03:54:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:59:48] Seen 20,192 samples
[2023-07-21 03:59:48] Starting data epoch 78 in logical epoch 78
[2023-07-21 03:59:48] [data] Shuffling data
[2023-07-21 03:59:48] [data] Done reading 20,192 sentences
[2023-07-21 03:59:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:05:11] Seen 20,192 samples
[2023-07-21 04:05:11] Starting data epoch 79 in logical epoch 79
[2023-07-21 04:05:11] [data] Shuffling data
[2023-07-21 04:05:11] [data] Done reading 20,192 sentences
[2023-07-21 04:05:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:08:39] Ep. 79 : Up. 3000 : Sen. 14,003 : Cost 4.28245878 * 16,259,238 @ 10,750 after 48,768,558 : Time 2799.35s : 5808.23 words/s : gNorm 1.0244
[2023-07-21 04:10:39] Seen 20,192 samples
[2023-07-21 04:10:39] Starting data epoch 80 in logical epoch 80
[2023-07-21 04:10:39] [data] Shuffling data
[2023-07-21 04:10:39] [data] Done reading 20,192 sentences
[2023-07-21 04:10:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:16:05] Seen 20,192 samples
[2023-07-21 04:16:05] Starting data epoch 81 in logical epoch 81
[2023-07-21 04:16:05] Training finished
[2023-07-21 04:16:24] [valid] Ep. 81 : Up. 3053 : cross-entropy : 135.914 : new best
[2023-07-21 04:19:09] [valid] Ep. 81 : Up. 3053 : translation : 0 : new best
[2023-07-21 04:19:09] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 04:19:12] Saving Adam parameters
[2023-07-21 04:19:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 04:19:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 04:19:19] [marian] Running on node23.datos.cluster.uy as process 11679 with command line:
[2023-07-21 04:19:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 04:19:19] [config] after: 0e
[2023-07-21 04:19:19] [config] after-batches: 0
[2023-07-21 04:19:19] [config] after-epochs: 90
[2023-07-21 04:19:19] [config] all-caps-every: 0
[2023-07-21 04:19:19] [config] allow-unk: false
[2023-07-21 04:19:19] [config] authors: false
[2023-07-21 04:19:19] [config] beam-size: 12
[2023-07-21 04:19:19] [config] bert-class-symbol: "[CLS]"
[2023-07-21 04:19:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 04:19:19] [config] bert-masking-fraction: 0.15
[2023-07-21 04:19:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 04:19:19] [config] bert-train-type-embeddings: true
[2023-07-21 04:19:19] [config] bert-type-vocab-size: 2
[2023-07-21 04:19:19] [config] build-info: ""
[2023-07-21 04:19:19] [config] check-gradient-nan: false
[2023-07-21 04:19:19] [config] check-nan: false
[2023-07-21 04:19:19] [config] cite: false
[2023-07-21 04:19:19] [config] clip-norm: 1
[2023-07-21 04:19:19] [config] cost-scaling:
[2023-07-21 04:19:19] [config]   - 256.f
[2023-07-21 04:19:19] [config]   - 1000
[2023-07-21 04:19:19] [config]   - 2.f
[2023-07-21 04:19:19] [config]   - 256.f
[2023-07-21 04:19:19] [config] cost-type: ce-sum
[2023-07-21 04:19:19] [config] cpu-threads: 0
[2023-07-21 04:19:19] [config] data-threads: 8
[2023-07-21 04:19:19] [config] data-weighting: ""
[2023-07-21 04:19:19] [config] data-weighting-type: sentence
[2023-07-21 04:19:19] [config] dec-cell: gru
[2023-07-21 04:19:19] [config] dec-cell-base-depth: 2
[2023-07-21 04:19:19] [config] dec-cell-high-depth: 1
[2023-07-21 04:19:19] [config] dec-depth: 1
[2023-07-21 04:19:19] [config] devices:
[2023-07-21 04:19:19] [config]   - 0
[2023-07-21 04:19:19] [config] dim-emb: 512
[2023-07-21 04:19:19] [config] dim-rnn: 1024
[2023-07-21 04:19:19] [config] dim-vocabs:
[2023-07-21 04:19:19] [config]   - 16384
[2023-07-21 04:19:19] [config]   - 16384
[2023-07-21 04:19:19] [config] disp-first: 0
[2023-07-21 04:19:19] [config] disp-freq: 1000u
[2023-07-21 04:19:19] [config] disp-label-counts: true
[2023-07-21 04:19:19] [config] dropout-rnn: 0
[2023-07-21 04:19:19] [config] dropout-src: 0
[2023-07-21 04:19:19] [config] dropout-trg: 0
[2023-07-21 04:19:19] [config] dump-config: ""
[2023-07-21 04:19:19] [config] dynamic-gradient-scaling:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] early-stopping: 200
[2023-07-21 04:19:19] [config] early-stopping-on: first
[2023-07-21 04:19:19] [config] embedding-fix-src: false
[2023-07-21 04:19:19] [config] embedding-fix-trg: false
[2023-07-21 04:19:19] [config] embedding-normalization: false
[2023-07-21 04:19:19] [config] embedding-vectors:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] enc-cell: gru
[2023-07-21 04:19:19] [config] enc-cell-depth: 1
[2023-07-21 04:19:19] [config] enc-depth: 1
[2023-07-21 04:19:19] [config] enc-type: bidirectional
[2023-07-21 04:19:19] [config] english-title-case-every: 0
[2023-07-21 04:19:19] [config] exponential-smoothing: 0
[2023-07-21 04:19:19] [config] factor-weight: 1
[2023-07-21 04:19:19] [config] factors-combine: sum
[2023-07-21 04:19:19] [config] factors-dim-emb: 0
[2023-07-21 04:19:19] [config] gradient-checkpointing: false
[2023-07-21 04:19:19] [config] gradient-norm-average-window: 100
[2023-07-21 04:19:19] [config] guided-alignment: none
[2023-07-21 04:19:19] [config] guided-alignment-cost: mse
[2023-07-21 04:19:19] [config] guided-alignment-weight: 0.1
[2023-07-21 04:19:19] [config] ignore-model-config: false
[2023-07-21 04:19:19] [config] input-types:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] interpolate-env-vars: false
[2023-07-21 04:19:19] [config] keep-best: false
[2023-07-21 04:19:19] [config] label-smoothing: 0
[2023-07-21 04:19:19] [config] layer-normalization: false
[2023-07-21 04:19:19] [config] learn-rate: 0.0001
[2023-07-21 04:19:19] [config] lemma-dependency: ""
[2023-07-21 04:19:19] [config] lemma-dim-emb: 0
[2023-07-21 04:19:19] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 04:19:19] [config] log-level: info
[2023-07-21 04:19:19] [config] log-time-zone: ""
[2023-07-21 04:19:19] [config] logical-epoch:
[2023-07-21 04:19:19] [config]   - 1e
[2023-07-21 04:19:19] [config]   - 0
[2023-07-21 04:19:19] [config] lr-decay: 0
[2023-07-21 04:19:19] [config] lr-decay-freq: 50000
[2023-07-21 04:19:19] [config] lr-decay-inv-sqrt:
[2023-07-21 04:19:19] [config]   - 0
[2023-07-21 04:19:19] [config] lr-decay-repeat-warmup: false
[2023-07-21 04:19:19] [config] lr-decay-reset-optimizer: false
[2023-07-21 04:19:19] [config] lr-decay-start:
[2023-07-21 04:19:19] [config]   - 10
[2023-07-21 04:19:19] [config]   - 1
[2023-07-21 04:19:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 04:19:19] [config] lr-report: false
[2023-07-21 04:19:19] [config] lr-warmup: 0
[2023-07-21 04:19:19] [config] lr-warmup-at-reload: false
[2023-07-21 04:19:19] [config] lr-warmup-cycle: false
[2023-07-21 04:19:19] [config] lr-warmup-start-rate: 0
[2023-07-21 04:19:19] [config] max-length: 150
[2023-07-21 04:19:19] [config] max-length-crop: true
[2023-07-21 04:19:19] [config] max-length-factor: 3
[2023-07-21 04:19:19] [config] maxi-batch: 100
[2023-07-21 04:19:19] [config] maxi-batch-sort: trg
[2023-07-21 04:19:19] [config] mini-batch: 64
[2023-07-21 04:19:19] [config] mini-batch-fit: true
[2023-07-21 04:19:19] [config] mini-batch-fit-step: 10
[2023-07-21 04:19:19] [config] mini-batch-round-up: true
[2023-07-21 04:19:19] [config] mini-batch-track-lr: false
[2023-07-21 04:19:19] [config] mini-batch-warmup: 0
[2023-07-21 04:19:19] [config] mini-batch-words: 0
[2023-07-21 04:19:19] [config] mini-batch-words-ref: 0
[2023-07-21 04:19:19] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 04:19:19] [config] multi-loss-type: sum
[2023-07-21 04:19:19] [config] n-best: false
[2023-07-21 04:19:19] [config] no-nccl: false
[2023-07-21 04:19:19] [config] no-reload: false
[2023-07-21 04:19:19] [config] no-restore-corpus: false
[2023-07-21 04:19:19] [config] normalize: 0
[2023-07-21 04:19:19] [config] normalize-gradient: false
[2023-07-21 04:19:19] [config] num-devices: 0
[2023-07-21 04:19:19] [config] optimizer: adam
[2023-07-21 04:19:19] [config] optimizer-delay: 1
[2023-07-21 04:19:19] [config] optimizer-params:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] output-omit-bias: false
[2023-07-21 04:19:19] [config] overwrite: true
[2023-07-21 04:19:19] [config] precision:
[2023-07-21 04:19:19] [config]   - float16
[2023-07-21 04:19:19] [config]   - float32
[2023-07-21 04:19:19] [config] pretrained-model: ""
[2023-07-21 04:19:19] [config] quantize-biases: false
[2023-07-21 04:19:19] [config] quantize-bits: 0
[2023-07-21 04:19:19] [config] quantize-log-based: false
[2023-07-21 04:19:19] [config] quantize-optimization-steps: 0
[2023-07-21 04:19:19] [config] quiet: false
[2023-07-21 04:19:19] [config] quiet-translation: true
[2023-07-21 04:19:19] [config] relative-paths: false
[2023-07-21 04:19:19] [config] right-left: false
[2023-07-21 04:19:19] [config] save-freq: 10000u
[2023-07-21 04:19:19] [config] seed: 1234
[2023-07-21 04:19:19] [config] sentencepiece-alphas:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] sentencepiece-max-lines: 2000000
[2023-07-21 04:19:19] [config] sentencepiece-options: ""
[2023-07-21 04:19:19] [config] sharding: global
[2023-07-21 04:19:19] [config] shuffle: data
[2023-07-21 04:19:19] [config] shuffle-in-ram: false
[2023-07-21 04:19:19] [config] sigterm: save-and-exit
[2023-07-21 04:19:19] [config] skip: false
[2023-07-21 04:19:19] [config] sqlite: ""
[2023-07-21 04:19:19] [config] sqlite-drop: false
[2023-07-21 04:19:19] [config] sync-freq: 200u
[2023-07-21 04:19:19] [config] sync-sgd: false
[2023-07-21 04:19:19] [config] tempdir: /tmp
[2023-07-21 04:19:19] [config] tied-embeddings: false
[2023-07-21 04:19:19] [config] tied-embeddings-all: true
[2023-07-21 04:19:19] [config] tied-embeddings-src: false
[2023-07-21 04:19:19] [config] train-embedder-rank:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] train-sets:
[2023-07-21 04:19:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 04:19:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 04:19:19] [config] transformer-aan-activation: swish
[2023-07-21 04:19:19] [config] transformer-aan-depth: 2
[2023-07-21 04:19:19] [config] transformer-aan-nogate: false
[2023-07-21 04:19:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 04:19:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 04:19:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 04:19:19] [config] transformer-depth-scaling: false
[2023-07-21 04:19:19] [config] transformer-dim-aan: 2048
[2023-07-21 04:19:19] [config] transformer-dim-ffn: 2048
[2023-07-21 04:19:19] [config] transformer-dropout: 0
[2023-07-21 04:19:19] [config] transformer-dropout-attention: 0
[2023-07-21 04:19:19] [config] transformer-dropout-ffn: 0
[2023-07-21 04:19:19] [config] transformer-ffn-activation: swish
[2023-07-21 04:19:19] [config] transformer-ffn-depth: 2
[2023-07-21 04:19:19] [config] transformer-guided-alignment-layer: last
[2023-07-21 04:19:19] [config] transformer-heads: 8
[2023-07-21 04:19:19] [config] transformer-no-projection: false
[2023-07-21 04:19:19] [config] transformer-pool: false
[2023-07-21 04:19:19] [config] transformer-postprocess: dan
[2023-07-21 04:19:19] [config] transformer-postprocess-emb: d
[2023-07-21 04:19:19] [config] transformer-postprocess-top: ""
[2023-07-21 04:19:19] [config] transformer-preprocess: ""
[2023-07-21 04:19:19] [config] transformer-tied-layers:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] transformer-train-position-embeddings: false
[2023-07-21 04:19:19] [config] tsv: false
[2023-07-21 04:19:19] [config] tsv-fields: 0
[2023-07-21 04:19:19] [config] type: amun
[2023-07-21 04:19:19] [config] ulr: false
[2023-07-21 04:19:19] [config] ulr-dim-emb: 0
[2023-07-21 04:19:19] [config] ulr-dropout: 0
[2023-07-21 04:19:19] [config] ulr-keys-vectors: ""
[2023-07-21 04:19:19] [config] ulr-query-vectors: ""
[2023-07-21 04:19:19] [config] ulr-softmax-temperature: 1
[2023-07-21 04:19:19] [config] ulr-trainable-transformation: false
[2023-07-21 04:19:19] [config] unlikelihood-loss: false
[2023-07-21 04:19:19] [config] valid-freq: 50000000
[2023-07-21 04:19:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 04:19:19] [config] valid-max-length: 1000
[2023-07-21 04:19:19] [config] valid-metrics:
[2023-07-21 04:19:19] [config]   - cross-entropy
[2023-07-21 04:19:19] [config]   - translation
[2023-07-21 04:19:19] [config] valid-mini-batch: 32
[2023-07-21 04:19:19] [config] valid-reset-stalled: false
[2023-07-21 04:19:19] [config] valid-script-args:
[2023-07-21 04:19:19] [config]   []
[2023-07-21 04:19:19] [config] valid-script-path: ""
[2023-07-21 04:19:19] [config] valid-sets:
[2023-07-21 04:19:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 04:19:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 04:19:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 04:19:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 04:19:19] [config] vocabs:
[2023-07-21 04:19:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 04:19:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 04:19:19] [config] word-penalty: 0
[2023-07-21 04:19:19] [config] word-scores: false
[2023-07-21 04:19:19] [config] workspace: 5500
[2023-07-21 04:19:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 04:19:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 04:19:19] [training] Using single-device training
[2023-07-21 04:19:19] Synced seed 1234
[2023-07-21 04:19:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 04:19:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 04:19:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 04:19:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 04:19:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 04:19:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 04:19:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 04:19:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 04:19:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 04:19:21] [comm] Using global sharding
[2023-07-21 04:19:21] [comm] NCCLCommunicators constructed successfully
[2023-07-21 04:19:21] [training] Using 1 GPUs
[2023-07-21 04:19:21] [logits] Applying loss function for 1 factor(s)
[2023-07-21 04:19:21] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:19:21] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 04:19:21] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:50:22] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 04:50:23] [valid] No post-processing script given for validating translator
[2023-07-21 04:50:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 04:50:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 04:50:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 04:50:23] [comm] Using global sharding
[2023-07-21 04:50:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 04:50:23] [training] Using 1 GPUs
[2023-07-21 04:50:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 04:50:29] Allocating memory for general optimizer shards
[2023-07-21 04:50:29] [memory] Reserving 322 MB, device gpu0
[2023-07-21 04:50:29] Loading Adam parameters
[2023-07-21 04:50:29] [memory] Reserving 322 MB, device gpu0
[2023-07-21 04:50:29] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:50:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 04:50:29] [data] Restoring the corpus state to epoch 81, batch 3053
[2023-07-21 04:50:29] [data] Shuffling data
[2023-07-21 04:50:29] [data] Done reading 20,192 sentences
[2023-07-21 04:50:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:50:30] Training started
[2023-07-21 04:50:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 04:50:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:50:39] Parameter type float16, optimization type float32, casting types true
[2023-07-21 04:55:25] Seen 20,192 samples
[2023-07-21 04:55:25] Starting data epoch 82 in logical epoch 82
[2023-07-21 04:55:25] [data] Shuffling data
[2023-07-21 04:55:25] [data] Done reading 20,192 sentences
[2023-07-21 04:55:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:00:43] Seen 20,192 samples
[2023-07-21 05:00:43] Starting data epoch 83 in logical epoch 83
[2023-07-21 05:00:43] [data] Shuffling data
[2023-07-21 05:00:43] [data] Done reading 20,192 sentences
[2023-07-21 05:00:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:06:09] Seen 20,192 samples
[2023-07-21 05:06:09] Starting data epoch 84 in logical epoch 84
[2023-07-21 05:06:09] [data] Shuffling data
[2023-07-21 05:06:09] [data] Done reading 20,192 sentences
[2023-07-21 05:06:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:11:42] Seen 20,192 samples
[2023-07-21 05:11:42] Starting data epoch 85 in logical epoch 85
[2023-07-21 05:11:42] [data] Shuffling data
[2023-07-21 05:11:42] [data] Done reading 20,192 sentences
[2023-07-21 05:11:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:17:06] Seen 20,192 samples
[2023-07-21 05:17:06] Starting data epoch 86 in logical epoch 86
[2023-07-21 05:17:06] [data] Shuffling data
[2023-07-21 05:17:06] [data] Done reading 20,192 sentences
[2023-07-21 05:17:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:22:06] Seen 20,192 samples
[2023-07-21 05:22:06] Starting data epoch 87 in logical epoch 87
[2023-07-21 05:22:06] [data] Shuffling data
[2023-07-21 05:22:07] [data] Done reading 20,192 sentences
[2023-07-21 05:22:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:27:15] Seen 20,192 samples
[2023-07-21 05:27:15] Starting data epoch 88 in logical epoch 88
[2023-07-21 05:27:15] [data] Shuffling data
[2023-07-21 05:27:15] [data] Done reading 20,192 sentences
[2023-07-21 05:27:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:32:31] Seen 20,192 samples
[2023-07-21 05:32:31] Starting data epoch 89 in logical epoch 89
[2023-07-21 05:32:31] [data] Shuffling data
[2023-07-21 05:32:31] [data] Done reading 20,192 sentences
[2023-07-21 05:32:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:37:52] Seen 20,192 samples
[2023-07-21 05:37:52] Starting data epoch 90 in logical epoch 90
[2023-07-21 05:37:52] [data] Shuffling data
[2023-07-21 05:37:52] [data] Done reading 20,192 sentences
[2023-07-21 05:37:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:43:07] Seen 20,192 samples
[2023-07-21 05:43:07] Starting data epoch 91 in logical epoch 91
[2023-07-21 05:43:07] Training finished
[2023-07-21 05:43:24] [valid] Ep. 91 : Up. 3437 : cross-entropy : 133.589 : new best
[2023-07-21 05:46:14] [valid] Ep. 91 : Up. 3437 : translation : 0 : new best
[2023-07-21 05:46:14] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 05:46:16] Saving Adam parameters
[2023-07-21 05:46:17] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 05:46:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 05:46:26] [marian] Running on node23.datos.cluster.uy as process 18128 with command line:
[2023-07-21 05:46:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 05:46:26] [config] after: 0e
[2023-07-21 05:46:26] [config] after-batches: 0
[2023-07-21 05:46:26] [config] after-epochs: 100
[2023-07-21 05:46:26] [config] all-caps-every: 0
[2023-07-21 05:46:26] [config] allow-unk: false
[2023-07-21 05:46:26] [config] authors: false
[2023-07-21 05:46:26] [config] beam-size: 12
[2023-07-21 05:46:26] [config] bert-class-symbol: "[CLS]"
[2023-07-21 05:46:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 05:46:26] [config] bert-masking-fraction: 0.15
[2023-07-21 05:46:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 05:46:26] [config] bert-train-type-embeddings: true
[2023-07-21 05:46:26] [config] bert-type-vocab-size: 2
[2023-07-21 05:46:26] [config] build-info: ""
[2023-07-21 05:46:26] [config] check-gradient-nan: false
[2023-07-21 05:46:26] [config] check-nan: false
[2023-07-21 05:46:26] [config] cite: false
[2023-07-21 05:46:26] [config] clip-norm: 1
[2023-07-21 05:46:26] [config] cost-scaling:
[2023-07-21 05:46:26] [config]   - 256.f
[2023-07-21 05:46:26] [config]   - 1000
[2023-07-21 05:46:26] [config]   - 2.f
[2023-07-21 05:46:26] [config]   - 256.f
[2023-07-21 05:46:26] [config] cost-type: ce-sum
[2023-07-21 05:46:26] [config] cpu-threads: 0
[2023-07-21 05:46:26] [config] data-threads: 8
[2023-07-21 05:46:26] [config] data-weighting: ""
[2023-07-21 05:46:26] [config] data-weighting-type: sentence
[2023-07-21 05:46:26] [config] dec-cell: gru
[2023-07-21 05:46:26] [config] dec-cell-base-depth: 2
[2023-07-21 05:46:26] [config] dec-cell-high-depth: 1
[2023-07-21 05:46:26] [config] dec-depth: 1
[2023-07-21 05:46:26] [config] devices:
[2023-07-21 05:46:26] [config]   - 0
[2023-07-21 05:46:26] [config] dim-emb: 512
[2023-07-21 05:46:26] [config] dim-rnn: 1024
[2023-07-21 05:46:26] [config] dim-vocabs:
[2023-07-21 05:46:26] [config]   - 16384
[2023-07-21 05:46:26] [config]   - 16384
[2023-07-21 05:46:26] [config] disp-first: 0
[2023-07-21 05:46:26] [config] disp-freq: 1000u
[2023-07-21 05:46:26] [config] disp-label-counts: true
[2023-07-21 05:46:26] [config] dropout-rnn: 0
[2023-07-21 05:46:26] [config] dropout-src: 0
[2023-07-21 05:46:26] [config] dropout-trg: 0
[2023-07-21 05:46:26] [config] dump-config: ""
[2023-07-21 05:46:26] [config] dynamic-gradient-scaling:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] early-stopping: 200
[2023-07-21 05:46:26] [config] early-stopping-on: first
[2023-07-21 05:46:26] [config] embedding-fix-src: false
[2023-07-21 05:46:26] [config] embedding-fix-trg: false
[2023-07-21 05:46:26] [config] embedding-normalization: false
[2023-07-21 05:46:26] [config] embedding-vectors:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] enc-cell: gru
[2023-07-21 05:46:26] [config] enc-cell-depth: 1
[2023-07-21 05:46:26] [config] enc-depth: 1
[2023-07-21 05:46:26] [config] enc-type: bidirectional
[2023-07-21 05:46:26] [config] english-title-case-every: 0
[2023-07-21 05:46:26] [config] exponential-smoothing: 0
[2023-07-21 05:46:26] [config] factor-weight: 1
[2023-07-21 05:46:26] [config] factors-combine: sum
[2023-07-21 05:46:26] [config] factors-dim-emb: 0
[2023-07-21 05:46:26] [config] gradient-checkpointing: false
[2023-07-21 05:46:26] [config] gradient-norm-average-window: 100
[2023-07-21 05:46:26] [config] guided-alignment: none
[2023-07-21 05:46:26] [config] guided-alignment-cost: mse
[2023-07-21 05:46:26] [config] guided-alignment-weight: 0.1
[2023-07-21 05:46:26] [config] ignore-model-config: false
[2023-07-21 05:46:26] [config] input-types:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] interpolate-env-vars: false
[2023-07-21 05:46:26] [config] keep-best: false
[2023-07-21 05:46:26] [config] label-smoothing: 0
[2023-07-21 05:46:26] [config] layer-normalization: false
[2023-07-21 05:46:26] [config] learn-rate: 0.0001
[2023-07-21 05:46:26] [config] lemma-dependency: ""
[2023-07-21 05:46:26] [config] lemma-dim-emb: 0
[2023-07-21 05:46:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 05:46:26] [config] log-level: info
[2023-07-21 05:46:26] [config] log-time-zone: ""
[2023-07-21 05:46:26] [config] logical-epoch:
[2023-07-21 05:46:26] [config]   - 1e
[2023-07-21 05:46:26] [config]   - 0
[2023-07-21 05:46:26] [config] lr-decay: 0
[2023-07-21 05:46:26] [config] lr-decay-freq: 50000
[2023-07-21 05:46:26] [config] lr-decay-inv-sqrt:
[2023-07-21 05:46:26] [config]   - 0
[2023-07-21 05:46:26] [config] lr-decay-repeat-warmup: false
[2023-07-21 05:46:26] [config] lr-decay-reset-optimizer: false
[2023-07-21 05:46:26] [config] lr-decay-start:
[2023-07-21 05:46:26] [config]   - 10
[2023-07-21 05:46:26] [config]   - 1
[2023-07-21 05:46:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 05:46:26] [config] lr-report: false
[2023-07-21 05:46:26] [config] lr-warmup: 0
[2023-07-21 05:46:26] [config] lr-warmup-at-reload: false
[2023-07-21 05:46:26] [config] lr-warmup-cycle: false
[2023-07-21 05:46:26] [config] lr-warmup-start-rate: 0
[2023-07-21 05:46:26] [config] max-length: 150
[2023-07-21 05:46:26] [config] max-length-crop: true
[2023-07-21 05:46:26] [config] max-length-factor: 3
[2023-07-21 05:46:26] [config] maxi-batch: 100
[2023-07-21 05:46:26] [config] maxi-batch-sort: trg
[2023-07-21 05:46:26] [config] mini-batch: 64
[2023-07-21 05:46:26] [config] mini-batch-fit: true
[2023-07-21 05:46:26] [config] mini-batch-fit-step: 10
[2023-07-21 05:46:26] [config] mini-batch-round-up: true
[2023-07-21 05:46:26] [config] mini-batch-track-lr: false
[2023-07-21 05:46:26] [config] mini-batch-warmup: 0
[2023-07-21 05:46:26] [config] mini-batch-words: 0
[2023-07-21 05:46:26] [config] mini-batch-words-ref: 0
[2023-07-21 05:46:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 05:46:26] [config] multi-loss-type: sum
[2023-07-21 05:46:26] [config] n-best: false
[2023-07-21 05:46:26] [config] no-nccl: false
[2023-07-21 05:46:26] [config] no-reload: false
[2023-07-21 05:46:26] [config] no-restore-corpus: false
[2023-07-21 05:46:26] [config] normalize: 0
[2023-07-21 05:46:26] [config] normalize-gradient: false
[2023-07-21 05:46:26] [config] num-devices: 0
[2023-07-21 05:46:26] [config] optimizer: adam
[2023-07-21 05:46:26] [config] optimizer-delay: 1
[2023-07-21 05:46:26] [config] optimizer-params:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] output-omit-bias: false
[2023-07-21 05:46:26] [config] overwrite: true
[2023-07-21 05:46:26] [config] precision:
[2023-07-21 05:46:26] [config]   - float16
[2023-07-21 05:46:26] [config]   - float32
[2023-07-21 05:46:26] [config] pretrained-model: ""
[2023-07-21 05:46:26] [config] quantize-biases: false
[2023-07-21 05:46:26] [config] quantize-bits: 0
[2023-07-21 05:46:26] [config] quantize-log-based: false
[2023-07-21 05:46:26] [config] quantize-optimization-steps: 0
[2023-07-21 05:46:26] [config] quiet: false
[2023-07-21 05:46:26] [config] quiet-translation: true
[2023-07-21 05:46:26] [config] relative-paths: false
[2023-07-21 05:46:26] [config] right-left: false
[2023-07-21 05:46:26] [config] save-freq: 10000u
[2023-07-21 05:46:26] [config] seed: 1234
[2023-07-21 05:46:26] [config] sentencepiece-alphas:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] sentencepiece-max-lines: 2000000
[2023-07-21 05:46:26] [config] sentencepiece-options: ""
[2023-07-21 05:46:26] [config] sharding: global
[2023-07-21 05:46:26] [config] shuffle: data
[2023-07-21 05:46:26] [config] shuffle-in-ram: false
[2023-07-21 05:46:26] [config] sigterm: save-and-exit
[2023-07-21 05:46:26] [config] skip: false
[2023-07-21 05:46:26] [config] sqlite: ""
[2023-07-21 05:46:26] [config] sqlite-drop: false
[2023-07-21 05:46:26] [config] sync-freq: 200u
[2023-07-21 05:46:26] [config] sync-sgd: false
[2023-07-21 05:46:26] [config] tempdir: /tmp
[2023-07-21 05:46:26] [config] tied-embeddings: false
[2023-07-21 05:46:26] [config] tied-embeddings-all: true
[2023-07-21 05:46:26] [config] tied-embeddings-src: false
[2023-07-21 05:46:26] [config] train-embedder-rank:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] train-sets:
[2023-07-21 05:46:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 05:46:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 05:46:26] [config] transformer-aan-activation: swish
[2023-07-21 05:46:26] [config] transformer-aan-depth: 2
[2023-07-21 05:46:26] [config] transformer-aan-nogate: false
[2023-07-21 05:46:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 05:46:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 05:46:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 05:46:26] [config] transformer-depth-scaling: false
[2023-07-21 05:46:26] [config] transformer-dim-aan: 2048
[2023-07-21 05:46:26] [config] transformer-dim-ffn: 2048
[2023-07-21 05:46:26] [config] transformer-dropout: 0
[2023-07-21 05:46:26] [config] transformer-dropout-attention: 0
[2023-07-21 05:46:26] [config] transformer-dropout-ffn: 0
[2023-07-21 05:46:26] [config] transformer-ffn-activation: swish
[2023-07-21 05:46:26] [config] transformer-ffn-depth: 2
[2023-07-21 05:46:26] [config] transformer-guided-alignment-layer: last
[2023-07-21 05:46:26] [config] transformer-heads: 8
[2023-07-21 05:46:26] [config] transformer-no-projection: false
[2023-07-21 05:46:26] [config] transformer-pool: false
[2023-07-21 05:46:26] [config] transformer-postprocess: dan
[2023-07-21 05:46:26] [config] transformer-postprocess-emb: d
[2023-07-21 05:46:26] [config] transformer-postprocess-top: ""
[2023-07-21 05:46:26] [config] transformer-preprocess: ""
[2023-07-21 05:46:26] [config] transformer-tied-layers:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] transformer-train-position-embeddings: false
[2023-07-21 05:46:26] [config] tsv: false
[2023-07-21 05:46:26] [config] tsv-fields: 0
[2023-07-21 05:46:26] [config] type: amun
[2023-07-21 05:46:26] [config] ulr: false
[2023-07-21 05:46:26] [config] ulr-dim-emb: 0
[2023-07-21 05:46:26] [config] ulr-dropout: 0
[2023-07-21 05:46:26] [config] ulr-keys-vectors: ""
[2023-07-21 05:46:26] [config] ulr-query-vectors: ""
[2023-07-21 05:46:26] [config] ulr-softmax-temperature: 1
[2023-07-21 05:46:26] [config] ulr-trainable-transformation: false
[2023-07-21 05:46:26] [config] unlikelihood-loss: false
[2023-07-21 05:46:26] [config] valid-freq: 50000000
[2023-07-21 05:46:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 05:46:26] [config] valid-max-length: 1000
[2023-07-21 05:46:26] [config] valid-metrics:
[2023-07-21 05:46:26] [config]   - cross-entropy
[2023-07-21 05:46:26] [config]   - translation
[2023-07-21 05:46:26] [config] valid-mini-batch: 32
[2023-07-21 05:46:26] [config] valid-reset-stalled: false
[2023-07-21 05:46:26] [config] valid-script-args:
[2023-07-21 05:46:26] [config]   []
[2023-07-21 05:46:26] [config] valid-script-path: ""
[2023-07-21 05:46:26] [config] valid-sets:
[2023-07-21 05:46:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 05:46:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 05:46:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 05:46:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 05:46:26] [config] vocabs:
[2023-07-21 05:46:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 05:46:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 05:46:26] [config] word-penalty: 0
[2023-07-21 05:46:26] [config] word-scores: false
[2023-07-21 05:46:26] [config] workspace: 5500
[2023-07-21 05:46:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 05:46:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 05:46:26] [training] Using single-device training
[2023-07-21 05:46:28] Synced seed 1234
[2023-07-21 05:46:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 05:46:28] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 05:46:28] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 05:46:28] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 05:46:28] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 05:46:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 05:46:28] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 05:46:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 05:46:30] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 05:46:30] [comm] Using global sharding
[2023-07-21 05:46:30] [comm] NCCLCommunicators constructed successfully
[2023-07-21 05:46:30] [training] Using 1 GPUs
[2023-07-21 05:46:30] [logits] Applying loss function for 1 factor(s)
[2023-07-21 05:46:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 05:46:30] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 05:46:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:18:03] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 06:18:03] [valid] No post-processing script given for validating translator
[2023-07-21 06:18:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 06:18:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 06:18:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 06:18:03] [comm] Using global sharding
[2023-07-21 06:18:03] [comm] NCCLCommunicators constructed successfully
[2023-07-21 06:18:03] [training] Using 1 GPUs
[2023-07-21 06:18:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 06:18:09] Allocating memory for general optimizer shards
[2023-07-21 06:18:09] [memory] Reserving 322 MB, device gpu0
[2023-07-21 06:18:09] Loading Adam parameters
[2023-07-21 06:18:09] [memory] Reserving 322 MB, device gpu0
[2023-07-21 06:18:09] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:18:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 06:18:09] [data] Restoring the corpus state to epoch 91, batch 3437
[2023-07-21 06:18:09] [data] Shuffling data
[2023-07-21 06:18:09] [data] Done reading 20,192 sentences
[2023-07-21 06:18:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:18:09] Training started
[2023-07-21 06:18:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 06:18:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:18:17] Parameter type float16, optimization type float32, casting types true
[2023-07-21 06:22:54] Seen 20,192 samples
[2023-07-21 06:22:54] Starting data epoch 92 in logical epoch 92
[2023-07-21 06:22:54] [data] Shuffling data
[2023-07-21 06:22:54] [data] Done reading 20,192 sentences
[2023-07-21 06:22:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:28:10] Seen 20,192 samples
[2023-07-21 06:28:10] Starting data epoch 93 in logical epoch 93
[2023-07-21 06:28:10] [data] Shuffling data
[2023-07-21 06:28:10] [data] Done reading 20,192 sentences
[2023-07-21 06:28:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:33:33] Seen 20,192 samples
[2023-07-21 06:33:33] Starting data epoch 94 in logical epoch 94
[2023-07-21 06:33:33] [data] Shuffling data
[2023-07-21 06:33:33] [data] Done reading 20,192 sentences
[2023-07-21 06:33:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:38:49] Seen 20,192 samples
[2023-07-21 06:38:49] Starting data epoch 95 in logical epoch 95
[2023-07-21 06:38:49] [data] Shuffling data
[2023-07-21 06:38:49] [data] Done reading 20,192 sentences
[2023-07-21 06:38:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:44:01] Seen 20,192 samples
[2023-07-21 06:44:01] Starting data epoch 96 in logical epoch 96
[2023-07-21 06:44:01] [data] Shuffling data
[2023-07-21 06:44:01] [data] Done reading 20,192 sentences
[2023-07-21 06:44:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:49:25] Seen 20,192 samples
[2023-07-21 06:49:25] Starting data epoch 97 in logical epoch 97
[2023-07-21 06:49:25] [data] Shuffling data
[2023-07-21 06:49:25] [data] Done reading 20,192 sentences
[2023-07-21 06:49:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:54:43] Seen 20,192 samples
[2023-07-21 06:54:43] Starting data epoch 98 in logical epoch 98
[2023-07-21 06:54:43] [data] Shuffling data
[2023-07-21 06:54:43] [data] Done reading 20,192 sentences
[2023-07-21 06:54:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:59:59] Seen 20,192 samples
[2023-07-21 06:59:59] Starting data epoch 99 in logical epoch 99
[2023-07-21 06:59:59] [data] Shuffling data
[2023-07-21 06:59:59] [data] Done reading 20,192 sentences
[2023-07-21 06:59:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:05:17] Seen 20,192 samples
[2023-07-21 07:05:17] Starting data epoch 100 in logical epoch 100
[2023-07-21 07:05:17] [data] Shuffling data
[2023-07-21 07:05:17] [data] Done reading 20,192 sentences
[2023-07-21 07:05:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:10:36] Seen 20,192 samples
[2023-07-21 07:10:36] Starting data epoch 101 in logical epoch 101
[2023-07-21 07:10:36] Training finished
[2023-07-21 07:10:52] [valid] Ep. 101 : Up. 3818 : cross-entropy : 131.328 : new best
[2023-07-21 07:13:59] [valid] Ep. 101 : Up. 3818 : translation : 0 : new best
[2023-07-21 07:13:59] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 07:14:02] Saving Adam parameters
[2023-07-21 07:14:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 07:14:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 07:14:11] [marian] Running on node23.datos.cluster.uy as process 6312 with command line:
[2023-07-21 07:14:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 07:14:11] [config] after: 0e
[2023-07-21 07:14:11] [config] after-batches: 0
[2023-07-21 07:14:11] [config] after-epochs: 110
[2023-07-21 07:14:11] [config] all-caps-every: 0
[2023-07-21 07:14:11] [config] allow-unk: false
[2023-07-21 07:14:11] [config] authors: false
[2023-07-21 07:14:11] [config] beam-size: 12
[2023-07-21 07:14:11] [config] bert-class-symbol: "[CLS]"
[2023-07-21 07:14:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 07:14:11] [config] bert-masking-fraction: 0.15
[2023-07-21 07:14:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 07:14:11] [config] bert-train-type-embeddings: true
[2023-07-21 07:14:11] [config] bert-type-vocab-size: 2
[2023-07-21 07:14:11] [config] build-info: ""
[2023-07-21 07:14:11] [config] check-gradient-nan: false
[2023-07-21 07:14:11] [config] check-nan: false
[2023-07-21 07:14:11] [config] cite: false
[2023-07-21 07:14:11] [config] clip-norm: 1
[2023-07-21 07:14:11] [config] cost-scaling:
[2023-07-21 07:14:11] [config]   - 256.f
[2023-07-21 07:14:11] [config]   - 1000
[2023-07-21 07:14:11] [config]   - 2.f
[2023-07-21 07:14:11] [config]   - 256.f
[2023-07-21 07:14:11] [config] cost-type: ce-sum
[2023-07-21 07:14:11] [config] cpu-threads: 0
[2023-07-21 07:14:11] [config] data-threads: 8
[2023-07-21 07:14:11] [config] data-weighting: ""
[2023-07-21 07:14:11] [config] data-weighting-type: sentence
[2023-07-21 07:14:11] [config] dec-cell: gru
[2023-07-21 07:14:11] [config] dec-cell-base-depth: 2
[2023-07-21 07:14:11] [config] dec-cell-high-depth: 1
[2023-07-21 07:14:11] [config] dec-depth: 1
[2023-07-21 07:14:11] [config] devices:
[2023-07-21 07:14:11] [config]   - 0
[2023-07-21 07:14:11] [config] dim-emb: 512
[2023-07-21 07:14:11] [config] dim-rnn: 1024
[2023-07-21 07:14:11] [config] dim-vocabs:
[2023-07-21 07:14:11] [config]   - 16384
[2023-07-21 07:14:11] [config]   - 16384
[2023-07-21 07:14:11] [config] disp-first: 0
[2023-07-21 07:14:11] [config] disp-freq: 1000u
[2023-07-21 07:14:11] [config] disp-label-counts: true
[2023-07-21 07:14:11] [config] dropout-rnn: 0
[2023-07-21 07:14:11] [config] dropout-src: 0
[2023-07-21 07:14:11] [config] dropout-trg: 0
[2023-07-21 07:14:11] [config] dump-config: ""
[2023-07-21 07:14:11] [config] dynamic-gradient-scaling:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] early-stopping: 200
[2023-07-21 07:14:11] [config] early-stopping-on: first
[2023-07-21 07:14:11] [config] embedding-fix-src: false
[2023-07-21 07:14:11] [config] embedding-fix-trg: false
[2023-07-21 07:14:11] [config] embedding-normalization: false
[2023-07-21 07:14:11] [config] embedding-vectors:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] enc-cell: gru
[2023-07-21 07:14:11] [config] enc-cell-depth: 1
[2023-07-21 07:14:11] [config] enc-depth: 1
[2023-07-21 07:14:11] [config] enc-type: bidirectional
[2023-07-21 07:14:11] [config] english-title-case-every: 0
[2023-07-21 07:14:11] [config] exponential-smoothing: 0
[2023-07-21 07:14:11] [config] factor-weight: 1
[2023-07-21 07:14:11] [config] factors-combine: sum
[2023-07-21 07:14:11] [config] factors-dim-emb: 0
[2023-07-21 07:14:11] [config] gradient-checkpointing: false
[2023-07-21 07:14:11] [config] gradient-norm-average-window: 100
[2023-07-21 07:14:11] [config] guided-alignment: none
[2023-07-21 07:14:11] [config] guided-alignment-cost: mse
[2023-07-21 07:14:11] [config] guided-alignment-weight: 0.1
[2023-07-21 07:14:11] [config] ignore-model-config: false
[2023-07-21 07:14:11] [config] input-types:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] interpolate-env-vars: false
[2023-07-21 07:14:11] [config] keep-best: false
[2023-07-21 07:14:11] [config] label-smoothing: 0
[2023-07-21 07:14:11] [config] layer-normalization: false
[2023-07-21 07:14:11] [config] learn-rate: 0.0001
[2023-07-21 07:14:11] [config] lemma-dependency: ""
[2023-07-21 07:14:11] [config] lemma-dim-emb: 0
[2023-07-21 07:14:11] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 07:14:11] [config] log-level: info
[2023-07-21 07:14:11] [config] log-time-zone: ""
[2023-07-21 07:14:11] [config] logical-epoch:
[2023-07-21 07:14:11] [config]   - 1e
[2023-07-21 07:14:11] [config]   - 0
[2023-07-21 07:14:11] [config] lr-decay: 0
[2023-07-21 07:14:11] [config] lr-decay-freq: 50000
[2023-07-21 07:14:11] [config] lr-decay-inv-sqrt:
[2023-07-21 07:14:11] [config]   - 0
[2023-07-21 07:14:11] [config] lr-decay-repeat-warmup: false
[2023-07-21 07:14:11] [config] lr-decay-reset-optimizer: false
[2023-07-21 07:14:11] [config] lr-decay-start:
[2023-07-21 07:14:11] [config]   - 10
[2023-07-21 07:14:11] [config]   - 1
[2023-07-21 07:14:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 07:14:11] [config] lr-report: false
[2023-07-21 07:14:11] [config] lr-warmup: 0
[2023-07-21 07:14:11] [config] lr-warmup-at-reload: false
[2023-07-21 07:14:11] [config] lr-warmup-cycle: false
[2023-07-21 07:14:11] [config] lr-warmup-start-rate: 0
[2023-07-21 07:14:11] [config] max-length: 150
[2023-07-21 07:14:11] [config] max-length-crop: true
[2023-07-21 07:14:11] [config] max-length-factor: 3
[2023-07-21 07:14:11] [config] maxi-batch: 100
[2023-07-21 07:14:11] [config] maxi-batch-sort: trg
[2023-07-21 07:14:11] [config] mini-batch: 64
[2023-07-21 07:14:11] [config] mini-batch-fit: true
[2023-07-21 07:14:11] [config] mini-batch-fit-step: 10
[2023-07-21 07:14:11] [config] mini-batch-round-up: true
[2023-07-21 07:14:11] [config] mini-batch-track-lr: false
[2023-07-21 07:14:11] [config] mini-batch-warmup: 0
[2023-07-21 07:14:11] [config] mini-batch-words: 0
[2023-07-21 07:14:11] [config] mini-batch-words-ref: 0
[2023-07-21 07:14:11] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 07:14:11] [config] multi-loss-type: sum
[2023-07-21 07:14:11] [config] n-best: false
[2023-07-21 07:14:11] [config] no-nccl: false
[2023-07-21 07:14:11] [config] no-reload: false
[2023-07-21 07:14:11] [config] no-restore-corpus: false
[2023-07-21 07:14:11] [config] normalize: 0
[2023-07-21 07:14:11] [config] normalize-gradient: false
[2023-07-21 07:14:11] [config] num-devices: 0
[2023-07-21 07:14:11] [config] optimizer: adam
[2023-07-21 07:14:11] [config] optimizer-delay: 1
[2023-07-21 07:14:11] [config] optimizer-params:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] output-omit-bias: false
[2023-07-21 07:14:11] [config] overwrite: true
[2023-07-21 07:14:11] [config] precision:
[2023-07-21 07:14:11] [config]   - float16
[2023-07-21 07:14:11] [config]   - float32
[2023-07-21 07:14:11] [config] pretrained-model: ""
[2023-07-21 07:14:11] [config] quantize-biases: false
[2023-07-21 07:14:11] [config] quantize-bits: 0
[2023-07-21 07:14:11] [config] quantize-log-based: false
[2023-07-21 07:14:11] [config] quantize-optimization-steps: 0
[2023-07-21 07:14:11] [config] quiet: false
[2023-07-21 07:14:11] [config] quiet-translation: true
[2023-07-21 07:14:11] [config] relative-paths: false
[2023-07-21 07:14:11] [config] right-left: false
[2023-07-21 07:14:11] [config] save-freq: 10000u
[2023-07-21 07:14:11] [config] seed: 1234
[2023-07-21 07:14:11] [config] sentencepiece-alphas:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] sentencepiece-max-lines: 2000000
[2023-07-21 07:14:11] [config] sentencepiece-options: ""
[2023-07-21 07:14:11] [config] sharding: global
[2023-07-21 07:14:11] [config] shuffle: data
[2023-07-21 07:14:11] [config] shuffle-in-ram: false
[2023-07-21 07:14:11] [config] sigterm: save-and-exit
[2023-07-21 07:14:11] [config] skip: false
[2023-07-21 07:14:11] [config] sqlite: ""
[2023-07-21 07:14:11] [config] sqlite-drop: false
[2023-07-21 07:14:11] [config] sync-freq: 200u
[2023-07-21 07:14:11] [config] sync-sgd: false
[2023-07-21 07:14:11] [config] tempdir: /tmp
[2023-07-21 07:14:11] [config] tied-embeddings: false
[2023-07-21 07:14:11] [config] tied-embeddings-all: true
[2023-07-21 07:14:11] [config] tied-embeddings-src: false
[2023-07-21 07:14:11] [config] train-embedder-rank:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] train-sets:
[2023-07-21 07:14:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 07:14:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 07:14:11] [config] transformer-aan-activation: swish
[2023-07-21 07:14:11] [config] transformer-aan-depth: 2
[2023-07-21 07:14:11] [config] transformer-aan-nogate: false
[2023-07-21 07:14:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 07:14:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 07:14:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 07:14:11] [config] transformer-depth-scaling: false
[2023-07-21 07:14:11] [config] transformer-dim-aan: 2048
[2023-07-21 07:14:11] [config] transformer-dim-ffn: 2048
[2023-07-21 07:14:11] [config] transformer-dropout: 0
[2023-07-21 07:14:11] [config] transformer-dropout-attention: 0
[2023-07-21 07:14:11] [config] transformer-dropout-ffn: 0
[2023-07-21 07:14:11] [config] transformer-ffn-activation: swish
[2023-07-21 07:14:11] [config] transformer-ffn-depth: 2
[2023-07-21 07:14:11] [config] transformer-guided-alignment-layer: last
[2023-07-21 07:14:11] [config] transformer-heads: 8
[2023-07-21 07:14:11] [config] transformer-no-projection: false
[2023-07-21 07:14:11] [config] transformer-pool: false
[2023-07-21 07:14:11] [config] transformer-postprocess: dan
[2023-07-21 07:14:11] [config] transformer-postprocess-emb: d
[2023-07-21 07:14:11] [config] transformer-postprocess-top: ""
[2023-07-21 07:14:11] [config] transformer-preprocess: ""
[2023-07-21 07:14:11] [config] transformer-tied-layers:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] transformer-train-position-embeddings: false
[2023-07-21 07:14:11] [config] tsv: false
[2023-07-21 07:14:11] [config] tsv-fields: 0
[2023-07-21 07:14:11] [config] type: amun
[2023-07-21 07:14:11] [config] ulr: false
[2023-07-21 07:14:11] [config] ulr-dim-emb: 0
[2023-07-21 07:14:11] [config] ulr-dropout: 0
[2023-07-21 07:14:11] [config] ulr-keys-vectors: ""
[2023-07-21 07:14:11] [config] ulr-query-vectors: ""
[2023-07-21 07:14:11] [config] ulr-softmax-temperature: 1
[2023-07-21 07:14:11] [config] ulr-trainable-transformation: false
[2023-07-21 07:14:11] [config] unlikelihood-loss: false
[2023-07-21 07:14:11] [config] valid-freq: 50000000
[2023-07-21 07:14:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 07:14:11] [config] valid-max-length: 1000
[2023-07-21 07:14:11] [config] valid-metrics:
[2023-07-21 07:14:11] [config]   - cross-entropy
[2023-07-21 07:14:11] [config]   - translation
[2023-07-21 07:14:11] [config] valid-mini-batch: 32
[2023-07-21 07:14:11] [config] valid-reset-stalled: false
[2023-07-21 07:14:11] [config] valid-script-args:
[2023-07-21 07:14:11] [config]   []
[2023-07-21 07:14:11] [config] valid-script-path: ""
[2023-07-21 07:14:11] [config] valid-sets:
[2023-07-21 07:14:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 07:14:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 07:14:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 07:14:11] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 07:14:11] [config] vocabs:
[2023-07-21 07:14:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 07:14:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 07:14:11] [config] word-penalty: 0
[2023-07-21 07:14:11] [config] word-scores: false
[2023-07-21 07:14:11] [config] workspace: 5500
[2023-07-21 07:14:11] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 07:14:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 07:14:11] [training] Using single-device training
[2023-07-21 07:14:12] Synced seed 1234
[2023-07-21 07:14:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 07:14:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 07:14:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 07:14:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 07:14:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 07:14:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 07:14:12] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 07:14:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 07:14:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 07:14:13] [comm] Using global sharding
[2023-07-21 07:14:13] [comm] NCCLCommunicators constructed successfully
[2023-07-21 07:14:13] [training] Using 1 GPUs
[2023-07-21 07:14:13] [logits] Applying loss function for 1 factor(s)
[2023-07-21 07:14:13] [memory] Reserving 80 MB, device gpu0
[2023-07-21 07:14:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 07:14:13] [memory] Reserving 80 MB, device gpu0
[2023-07-21 07:45:59] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 07:45:59] [valid] No post-processing script given for validating translator
[2023-07-21 07:45:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 07:45:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 07:45:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 07:45:59] [comm] Using global sharding
[2023-07-21 07:45:59] [comm] NCCLCommunicators constructed successfully
[2023-07-21 07:45:59] [training] Using 1 GPUs
[2023-07-21 07:45:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 07:46:07] Allocating memory for general optimizer shards
[2023-07-21 07:46:07] [memory] Reserving 322 MB, device gpu0
[2023-07-21 07:46:07] Loading Adam parameters
[2023-07-21 07:46:07] [memory] Reserving 322 MB, device gpu0
[2023-07-21 07:46:07] [memory] Reserving 80 MB, device gpu0
[2023-07-21 07:46:07] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 07:46:07] [data] Restoring the corpus state to epoch 101, batch 3818
[2023-07-21 07:46:07] [data] Shuffling data
[2023-07-21 07:46:07] [data] Done reading 20,192 sentences
[2023-07-21 07:46:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:46:07] Training started
[2023-07-21 07:46:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 07:46:08] [memory] Reserving 80 MB, device gpu0
[2023-07-21 07:46:13] Parameter type float16, optimization type float32, casting types true
[2023-07-21 07:50:57] Seen 20,192 samples
[2023-07-21 07:50:57] Starting data epoch 102 in logical epoch 102
[2023-07-21 07:50:57] [data] Shuffling data
[2023-07-21 07:50:57] [data] Done reading 20,192 sentences
[2023-07-21 07:50:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:55:54] Seen 20,192 samples
[2023-07-21 07:55:54] Starting data epoch 103 in logical epoch 103
[2023-07-21 07:55:54] [data] Shuffling data
[2023-07-21 07:55:54] [data] Done reading 20,192 sentences
[2023-07-21 07:55:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:01:04] Seen 20,192 samples
[2023-07-21 08:01:04] Starting data epoch 104 in logical epoch 104
[2023-07-21 08:01:04] [data] Shuffling data
[2023-07-21 08:01:04] [data] Done reading 20,192 sentences
[2023-07-21 08:01:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:06:10] Seen 20,192 samples
[2023-07-21 08:06:10] Starting data epoch 105 in logical epoch 105
[2023-07-21 08:06:10] [data] Shuffling data
[2023-07-21 08:06:10] [data] Done reading 20,192 sentences
[2023-07-21 08:06:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:10:09] Ep. 105 : Up. 4000 : Sen. 16,374 : Cost 3.79206467 * 16,212,366 @ 21,569 after 64,980,926 : Time 1450.02s : 11180.80 words/s : gNorm 1.1805
[2023-07-21 08:11:20] Seen 20,192 samples
[2023-07-21 08:11:20] Starting data epoch 106 in logical epoch 106
[2023-07-21 08:11:20] [data] Shuffling data
[2023-07-21 08:11:20] [data] Done reading 20,192 sentences
[2023-07-21 08:11:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:16:31] Seen 20,192 samples
[2023-07-21 08:16:31] Starting data epoch 107 in logical epoch 107
[2023-07-21 08:16:31] [data] Shuffling data
[2023-07-21 08:16:31] [data] Done reading 20,192 sentences
[2023-07-21 08:16:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:21:31] Seen 20,192 samples
[2023-07-21 08:21:31] Starting data epoch 108 in logical epoch 108
[2023-07-21 08:21:31] [data] Shuffling data
[2023-07-21 08:21:31] [data] Done reading 20,192 sentences
[2023-07-21 08:21:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:26:46] Seen 20,192 samples
[2023-07-21 08:26:46] Starting data epoch 109 in logical epoch 109
[2023-07-21 08:26:46] [data] Shuffling data
[2023-07-21 08:26:46] [data] Done reading 20,192 sentences
[2023-07-21 08:26:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:32:03] Seen 20,192 samples
[2023-07-21 08:32:03] Starting data epoch 110 in logical epoch 110
[2023-07-21 08:32:03] [data] Shuffling data
[2023-07-21 08:32:03] [data] Done reading 20,192 sentences
[2023-07-21 08:32:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:37:14] Seen 20,192 samples
[2023-07-21 08:37:14] Starting data epoch 111 in logical epoch 111
[2023-07-21 08:37:14] Training finished
[2023-07-21 08:37:33] [valid] Ep. 111 : Up. 4198 : cross-entropy : 129.377 : new best
[2023-07-21 08:40:15] [valid] Ep. 111 : Up. 4198 : translation : 0 : new best
[2023-07-21 08:40:15] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 08:40:19] Saving Adam parameters
[2023-07-21 08:40:19] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 08:40:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 08:40:26] [marian] Running on node23.datos.cluster.uy as process 12073 with command line:
[2023-07-21 08:40:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 08:40:26] [config] after: 0e
[2023-07-21 08:40:26] [config] after-batches: 0
[2023-07-21 08:40:26] [config] after-epochs: 120
[2023-07-21 08:40:26] [config] all-caps-every: 0
[2023-07-21 08:40:26] [config] allow-unk: false
[2023-07-21 08:40:26] [config] authors: false
[2023-07-21 08:40:26] [config] beam-size: 12
[2023-07-21 08:40:26] [config] bert-class-symbol: "[CLS]"
[2023-07-21 08:40:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 08:40:26] [config] bert-masking-fraction: 0.15
[2023-07-21 08:40:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 08:40:26] [config] bert-train-type-embeddings: true
[2023-07-21 08:40:26] [config] bert-type-vocab-size: 2
[2023-07-21 08:40:26] [config] build-info: ""
[2023-07-21 08:40:26] [config] check-gradient-nan: false
[2023-07-21 08:40:26] [config] check-nan: false
[2023-07-21 08:40:26] [config] cite: false
[2023-07-21 08:40:26] [config] clip-norm: 1
[2023-07-21 08:40:26] [config] cost-scaling:
[2023-07-21 08:40:26] [config]   - 256.f
[2023-07-21 08:40:26] [config]   - 1000
[2023-07-21 08:40:26] [config]   - 2.f
[2023-07-21 08:40:26] [config]   - 256.f
[2023-07-21 08:40:26] [config] cost-type: ce-sum
[2023-07-21 08:40:26] [config] cpu-threads: 0
[2023-07-21 08:40:26] [config] data-threads: 8
[2023-07-21 08:40:26] [config] data-weighting: ""
[2023-07-21 08:40:26] [config] data-weighting-type: sentence
[2023-07-21 08:40:26] [config] dec-cell: gru
[2023-07-21 08:40:26] [config] dec-cell-base-depth: 2
[2023-07-21 08:40:26] [config] dec-cell-high-depth: 1
[2023-07-21 08:40:26] [config] dec-depth: 1
[2023-07-21 08:40:26] [config] devices:
[2023-07-21 08:40:26] [config]   - 0
[2023-07-21 08:40:26] [config] dim-emb: 512
[2023-07-21 08:40:26] [config] dim-rnn: 1024
[2023-07-21 08:40:26] [config] dim-vocabs:
[2023-07-21 08:40:26] [config]   - 16384
[2023-07-21 08:40:26] [config]   - 16384
[2023-07-21 08:40:26] [config] disp-first: 0
[2023-07-21 08:40:26] [config] disp-freq: 1000u
[2023-07-21 08:40:26] [config] disp-label-counts: true
[2023-07-21 08:40:26] [config] dropout-rnn: 0
[2023-07-21 08:40:26] [config] dropout-src: 0
[2023-07-21 08:40:26] [config] dropout-trg: 0
[2023-07-21 08:40:26] [config] dump-config: ""
[2023-07-21 08:40:26] [config] dynamic-gradient-scaling:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] early-stopping: 200
[2023-07-21 08:40:26] [config] early-stopping-on: first
[2023-07-21 08:40:26] [config] embedding-fix-src: false
[2023-07-21 08:40:26] [config] embedding-fix-trg: false
[2023-07-21 08:40:26] [config] embedding-normalization: false
[2023-07-21 08:40:26] [config] embedding-vectors:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] enc-cell: gru
[2023-07-21 08:40:26] [config] enc-cell-depth: 1
[2023-07-21 08:40:26] [config] enc-depth: 1
[2023-07-21 08:40:26] [config] enc-type: bidirectional
[2023-07-21 08:40:26] [config] english-title-case-every: 0
[2023-07-21 08:40:26] [config] exponential-smoothing: 0
[2023-07-21 08:40:26] [config] factor-weight: 1
[2023-07-21 08:40:26] [config] factors-combine: sum
[2023-07-21 08:40:26] [config] factors-dim-emb: 0
[2023-07-21 08:40:26] [config] gradient-checkpointing: false
[2023-07-21 08:40:26] [config] gradient-norm-average-window: 100
[2023-07-21 08:40:26] [config] guided-alignment: none
[2023-07-21 08:40:26] [config] guided-alignment-cost: mse
[2023-07-21 08:40:26] [config] guided-alignment-weight: 0.1
[2023-07-21 08:40:26] [config] ignore-model-config: false
[2023-07-21 08:40:26] [config] input-types:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] interpolate-env-vars: false
[2023-07-21 08:40:26] [config] keep-best: false
[2023-07-21 08:40:26] [config] label-smoothing: 0
[2023-07-21 08:40:26] [config] layer-normalization: false
[2023-07-21 08:40:26] [config] learn-rate: 0.0001
[2023-07-21 08:40:26] [config] lemma-dependency: ""
[2023-07-21 08:40:26] [config] lemma-dim-emb: 0
[2023-07-21 08:40:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 08:40:26] [config] log-level: info
[2023-07-21 08:40:26] [config] log-time-zone: ""
[2023-07-21 08:40:26] [config] logical-epoch:
[2023-07-21 08:40:26] [config]   - 1e
[2023-07-21 08:40:26] [config]   - 0
[2023-07-21 08:40:26] [config] lr-decay: 0
[2023-07-21 08:40:26] [config] lr-decay-freq: 50000
[2023-07-21 08:40:26] [config] lr-decay-inv-sqrt:
[2023-07-21 08:40:26] [config]   - 0
[2023-07-21 08:40:26] [config] lr-decay-repeat-warmup: false
[2023-07-21 08:40:26] [config] lr-decay-reset-optimizer: false
[2023-07-21 08:40:26] [config] lr-decay-start:
[2023-07-21 08:40:26] [config]   - 10
[2023-07-21 08:40:26] [config]   - 1
[2023-07-21 08:40:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 08:40:26] [config] lr-report: false
[2023-07-21 08:40:26] [config] lr-warmup: 0
[2023-07-21 08:40:26] [config] lr-warmup-at-reload: false
[2023-07-21 08:40:26] [config] lr-warmup-cycle: false
[2023-07-21 08:40:26] [config] lr-warmup-start-rate: 0
[2023-07-21 08:40:26] [config] max-length: 150
[2023-07-21 08:40:26] [config] max-length-crop: true
[2023-07-21 08:40:26] [config] max-length-factor: 3
[2023-07-21 08:40:26] [config] maxi-batch: 100
[2023-07-21 08:40:26] [config] maxi-batch-sort: trg
[2023-07-21 08:40:26] [config] mini-batch: 64
[2023-07-21 08:40:26] [config] mini-batch-fit: true
[2023-07-21 08:40:26] [config] mini-batch-fit-step: 10
[2023-07-21 08:40:26] [config] mini-batch-round-up: true
[2023-07-21 08:40:26] [config] mini-batch-track-lr: false
[2023-07-21 08:40:26] [config] mini-batch-warmup: 0
[2023-07-21 08:40:26] [config] mini-batch-words: 0
[2023-07-21 08:40:26] [config] mini-batch-words-ref: 0
[2023-07-21 08:40:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 08:40:26] [config] multi-loss-type: sum
[2023-07-21 08:40:26] [config] n-best: false
[2023-07-21 08:40:26] [config] no-nccl: false
[2023-07-21 08:40:26] [config] no-reload: false
[2023-07-21 08:40:26] [config] no-restore-corpus: false
[2023-07-21 08:40:26] [config] normalize: 0
[2023-07-21 08:40:26] [config] normalize-gradient: false
[2023-07-21 08:40:26] [config] num-devices: 0
[2023-07-21 08:40:26] [config] optimizer: adam
[2023-07-21 08:40:26] [config] optimizer-delay: 1
[2023-07-21 08:40:26] [config] optimizer-params:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] output-omit-bias: false
[2023-07-21 08:40:26] [config] overwrite: true
[2023-07-21 08:40:26] [config] precision:
[2023-07-21 08:40:26] [config]   - float16
[2023-07-21 08:40:26] [config]   - float32
[2023-07-21 08:40:26] [config] pretrained-model: ""
[2023-07-21 08:40:26] [config] quantize-biases: false
[2023-07-21 08:40:26] [config] quantize-bits: 0
[2023-07-21 08:40:26] [config] quantize-log-based: false
[2023-07-21 08:40:26] [config] quantize-optimization-steps: 0
[2023-07-21 08:40:26] [config] quiet: false
[2023-07-21 08:40:26] [config] quiet-translation: true
[2023-07-21 08:40:26] [config] relative-paths: false
[2023-07-21 08:40:26] [config] right-left: false
[2023-07-21 08:40:26] [config] save-freq: 10000u
[2023-07-21 08:40:26] [config] seed: 1234
[2023-07-21 08:40:26] [config] sentencepiece-alphas:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] sentencepiece-max-lines: 2000000
[2023-07-21 08:40:26] [config] sentencepiece-options: ""
[2023-07-21 08:40:26] [config] sharding: global
[2023-07-21 08:40:26] [config] shuffle: data
[2023-07-21 08:40:26] [config] shuffle-in-ram: false
[2023-07-21 08:40:26] [config] sigterm: save-and-exit
[2023-07-21 08:40:26] [config] skip: false
[2023-07-21 08:40:26] [config] sqlite: ""
[2023-07-21 08:40:26] [config] sqlite-drop: false
[2023-07-21 08:40:26] [config] sync-freq: 200u
[2023-07-21 08:40:26] [config] sync-sgd: false
[2023-07-21 08:40:26] [config] tempdir: /tmp
[2023-07-21 08:40:26] [config] tied-embeddings: false
[2023-07-21 08:40:26] [config] tied-embeddings-all: true
[2023-07-21 08:40:26] [config] tied-embeddings-src: false
[2023-07-21 08:40:26] [config] train-embedder-rank:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] train-sets:
[2023-07-21 08:40:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 08:40:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 08:40:26] [config] transformer-aan-activation: swish
[2023-07-21 08:40:26] [config] transformer-aan-depth: 2
[2023-07-21 08:40:26] [config] transformer-aan-nogate: false
[2023-07-21 08:40:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 08:40:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 08:40:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 08:40:26] [config] transformer-depth-scaling: false
[2023-07-21 08:40:26] [config] transformer-dim-aan: 2048
[2023-07-21 08:40:26] [config] transformer-dim-ffn: 2048
[2023-07-21 08:40:26] [config] transformer-dropout: 0
[2023-07-21 08:40:26] [config] transformer-dropout-attention: 0
[2023-07-21 08:40:26] [config] transformer-dropout-ffn: 0
[2023-07-21 08:40:26] [config] transformer-ffn-activation: swish
[2023-07-21 08:40:26] [config] transformer-ffn-depth: 2
[2023-07-21 08:40:26] [config] transformer-guided-alignment-layer: last
[2023-07-21 08:40:26] [config] transformer-heads: 8
[2023-07-21 08:40:26] [config] transformer-no-projection: false
[2023-07-21 08:40:26] [config] transformer-pool: false
[2023-07-21 08:40:26] [config] transformer-postprocess: dan
[2023-07-21 08:40:26] [config] transformer-postprocess-emb: d
[2023-07-21 08:40:26] [config] transformer-postprocess-top: ""
[2023-07-21 08:40:26] [config] transformer-preprocess: ""
[2023-07-21 08:40:26] [config] transformer-tied-layers:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] transformer-train-position-embeddings: false
[2023-07-21 08:40:26] [config] tsv: false
[2023-07-21 08:40:26] [config] tsv-fields: 0
[2023-07-21 08:40:26] [config] type: amun
[2023-07-21 08:40:26] [config] ulr: false
[2023-07-21 08:40:26] [config] ulr-dim-emb: 0
[2023-07-21 08:40:26] [config] ulr-dropout: 0
[2023-07-21 08:40:26] [config] ulr-keys-vectors: ""
[2023-07-21 08:40:26] [config] ulr-query-vectors: ""
[2023-07-21 08:40:26] [config] ulr-softmax-temperature: 1
[2023-07-21 08:40:26] [config] ulr-trainable-transformation: false
[2023-07-21 08:40:26] [config] unlikelihood-loss: false
[2023-07-21 08:40:26] [config] valid-freq: 50000000
[2023-07-21 08:40:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 08:40:26] [config] valid-max-length: 1000
[2023-07-21 08:40:26] [config] valid-metrics:
[2023-07-21 08:40:26] [config]   - cross-entropy
[2023-07-21 08:40:26] [config]   - translation
[2023-07-21 08:40:26] [config] valid-mini-batch: 32
[2023-07-21 08:40:26] [config] valid-reset-stalled: false
[2023-07-21 08:40:26] [config] valid-script-args:
[2023-07-21 08:40:26] [config]   []
[2023-07-21 08:40:26] [config] valid-script-path: ""
[2023-07-21 08:40:26] [config] valid-sets:
[2023-07-21 08:40:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 08:40:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 08:40:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 08:40:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 08:40:26] [config] vocabs:
[2023-07-21 08:40:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 08:40:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 08:40:26] [config] word-penalty: 0
[2023-07-21 08:40:26] [config] word-scores: false
[2023-07-21 08:40:26] [config] workspace: 5500
[2023-07-21 08:40:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 08:40:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 08:40:26] [training] Using single-device training
[2023-07-21 08:40:27] Synced seed 1234
[2023-07-21 08:40:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 08:40:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 08:40:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 08:40:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 08:40:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 08:40:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 08:40:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 08:40:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 08:40:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 08:40:28] [comm] Using global sharding
[2023-07-21 08:40:28] [comm] NCCLCommunicators constructed successfully
[2023-07-21 08:40:28] [training] Using 1 GPUs
[2023-07-21 08:40:28] [logits] Applying loss function for 1 factor(s)
[2023-07-21 08:40:28] [memory] Reserving 80 MB, device gpu0
[2023-07-21 08:40:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 08:40:28] [memory] Reserving 80 MB, device gpu0
[2023-07-21 09:11:39] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 09:11:39] [valid] No post-processing script given for validating translator
[2023-07-21 09:11:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 09:11:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 09:11:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 09:11:39] [comm] Using global sharding
[2023-07-21 09:11:39] [comm] NCCLCommunicators constructed successfully
[2023-07-21 09:11:39] [training] Using 1 GPUs
[2023-07-21 09:11:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 09:11:46] Allocating memory for general optimizer shards
[2023-07-21 09:11:46] [memory] Reserving 322 MB, device gpu0
[2023-07-21 09:11:46] Loading Adam parameters
[2023-07-21 09:11:47] [memory] Reserving 322 MB, device gpu0
[2023-07-21 09:11:47] [memory] Reserving 80 MB, device gpu0
[2023-07-21 09:11:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 09:11:47] [data] Restoring the corpus state to epoch 111, batch 4198
[2023-07-21 09:11:47] [data] Shuffling data
[2023-07-21 09:11:47] [data] Done reading 20,192 sentences
[2023-07-21 09:11:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:11:47] Training started
[2023-07-21 09:11:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 09:11:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 09:11:53] Parameter type float16, optimization type float32, casting types true
[2023-07-21 09:16:24] Seen 20,192 samples
[2023-07-21 09:16:24] Starting data epoch 112 in logical epoch 112
[2023-07-21 09:16:24] [data] Shuffling data
[2023-07-21 09:16:24] [data] Done reading 20,192 sentences
[2023-07-21 09:16:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:21:18] Seen 20,192 samples
[2023-07-21 09:21:18] Starting data epoch 113 in logical epoch 113
[2023-07-21 09:21:18] [data] Shuffling data
[2023-07-21 09:21:18] [data] Done reading 20,192 sentences
[2023-07-21 09:21:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:26:26] Seen 20,192 samples
[2023-07-21 09:26:26] Starting data epoch 114 in logical epoch 114
[2023-07-21 09:26:26] [data] Shuffling data
[2023-07-21 09:26:26] [data] Done reading 20,192 sentences
[2023-07-21 09:26:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:31:38] Seen 20,192 samples
[2023-07-21 09:31:38] Starting data epoch 115 in logical epoch 115
[2023-07-21 09:31:38] [data] Shuffling data
[2023-07-21 09:31:38] [data] Done reading 20,192 sentences
[2023-07-21 09:31:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:36:43] Seen 20,192 samples
[2023-07-21 09:36:43] Starting data epoch 116 in logical epoch 116
[2023-07-21 09:36:43] [data] Shuffling data
[2023-07-21 09:36:43] [data] Done reading 20,192 sentences
[2023-07-21 09:36:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:41:35] Seen 20,192 samples
[2023-07-21 09:41:35] Starting data epoch 117 in logical epoch 117
[2023-07-21 09:41:35] [data] Shuffling data
[2023-07-21 09:41:35] [data] Done reading 20,192 sentences
[2023-07-21 09:41:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:46:17] Seen 20,192 samples
[2023-07-21 09:46:17] Starting data epoch 118 in logical epoch 118
[2023-07-21 09:46:17] [data] Shuffling data
[2023-07-21 09:46:17] [data] Done reading 20,192 sentences
[2023-07-21 09:46:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:51:03] Seen 20,192 samples
[2023-07-21 09:51:03] Starting data epoch 119 in logical epoch 119
[2023-07-21 09:51:03] [data] Shuffling data
[2023-07-21 09:51:03] [data] Done reading 20,192 sentences
[2023-07-21 09:51:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:55:56] Seen 20,192 samples
[2023-07-21 09:55:56] Starting data epoch 120 in logical epoch 120
[2023-07-21 09:55:56] [data] Shuffling data
[2023-07-21 09:55:56] [data] Done reading 20,192 sentences
[2023-07-21 09:55:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:00:51] Seen 20,192 samples
[2023-07-21 10:00:51] Starting data epoch 121 in logical epoch 121
[2023-07-21 10:00:51] Training finished
[2023-07-21 10:01:04] [valid] Ep. 121 : Up. 4578 : cross-entropy : 127.515 : new best
[2023-07-21 10:03:14] [valid] Ep. 121 : Up. 4578 : translation : 0 : new best
[2023-07-21 10:03:14] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 10:03:17] Saving Adam parameters
[2023-07-21 10:03:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 10:03:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 10:03:26] [marian] Running on node23.datos.cluster.uy as process 17707 with command line:
[2023-07-21 10:03:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 10:03:26] [config] after: 0e
[2023-07-21 10:03:26] [config] after-batches: 0
[2023-07-21 10:03:26] [config] after-epochs: 130
[2023-07-21 10:03:26] [config] all-caps-every: 0
[2023-07-21 10:03:26] [config] allow-unk: false
[2023-07-21 10:03:26] [config] authors: false
[2023-07-21 10:03:26] [config] beam-size: 12
[2023-07-21 10:03:26] [config] bert-class-symbol: "[CLS]"
[2023-07-21 10:03:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 10:03:26] [config] bert-masking-fraction: 0.15
[2023-07-21 10:03:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 10:03:26] [config] bert-train-type-embeddings: true
[2023-07-21 10:03:26] [config] bert-type-vocab-size: 2
[2023-07-21 10:03:26] [config] build-info: ""
[2023-07-21 10:03:26] [config] check-gradient-nan: false
[2023-07-21 10:03:26] [config] check-nan: false
[2023-07-21 10:03:26] [config] cite: false
[2023-07-21 10:03:26] [config] clip-norm: 1
[2023-07-21 10:03:26] [config] cost-scaling:
[2023-07-21 10:03:26] [config]   - 256.f
[2023-07-21 10:03:26] [config]   - 1000
[2023-07-21 10:03:26] [config]   - 2.f
[2023-07-21 10:03:26] [config]   - 256.f
[2023-07-21 10:03:26] [config] cost-type: ce-sum
[2023-07-21 10:03:26] [config] cpu-threads: 0
[2023-07-21 10:03:26] [config] data-threads: 8
[2023-07-21 10:03:26] [config] data-weighting: ""
[2023-07-21 10:03:26] [config] data-weighting-type: sentence
[2023-07-21 10:03:26] [config] dec-cell: gru
[2023-07-21 10:03:26] [config] dec-cell-base-depth: 2
[2023-07-21 10:03:26] [config] dec-cell-high-depth: 1
[2023-07-21 10:03:26] [config] dec-depth: 1
[2023-07-21 10:03:26] [config] devices:
[2023-07-21 10:03:26] [config]   - 0
[2023-07-21 10:03:26] [config] dim-emb: 512
[2023-07-21 10:03:26] [config] dim-rnn: 1024
[2023-07-21 10:03:26] [config] dim-vocabs:
[2023-07-21 10:03:26] [config]   - 16384
[2023-07-21 10:03:26] [config]   - 16384
[2023-07-21 10:03:26] [config] disp-first: 0
[2023-07-21 10:03:26] [config] disp-freq: 1000u
[2023-07-21 10:03:26] [config] disp-label-counts: true
[2023-07-21 10:03:26] [config] dropout-rnn: 0
[2023-07-21 10:03:26] [config] dropout-src: 0
[2023-07-21 10:03:26] [config] dropout-trg: 0
[2023-07-21 10:03:26] [config] dump-config: ""
[2023-07-21 10:03:26] [config] dynamic-gradient-scaling:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] early-stopping: 200
[2023-07-21 10:03:26] [config] early-stopping-on: first
[2023-07-21 10:03:26] [config] embedding-fix-src: false
[2023-07-21 10:03:26] [config] embedding-fix-trg: false
[2023-07-21 10:03:26] [config] embedding-normalization: false
[2023-07-21 10:03:26] [config] embedding-vectors:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] enc-cell: gru
[2023-07-21 10:03:26] [config] enc-cell-depth: 1
[2023-07-21 10:03:26] [config] enc-depth: 1
[2023-07-21 10:03:26] [config] enc-type: bidirectional
[2023-07-21 10:03:26] [config] english-title-case-every: 0
[2023-07-21 10:03:26] [config] exponential-smoothing: 0
[2023-07-21 10:03:26] [config] factor-weight: 1
[2023-07-21 10:03:26] [config] factors-combine: sum
[2023-07-21 10:03:26] [config] factors-dim-emb: 0
[2023-07-21 10:03:26] [config] gradient-checkpointing: false
[2023-07-21 10:03:26] [config] gradient-norm-average-window: 100
[2023-07-21 10:03:26] [config] guided-alignment: none
[2023-07-21 10:03:26] [config] guided-alignment-cost: mse
[2023-07-21 10:03:26] [config] guided-alignment-weight: 0.1
[2023-07-21 10:03:26] [config] ignore-model-config: false
[2023-07-21 10:03:26] [config] input-types:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] interpolate-env-vars: false
[2023-07-21 10:03:26] [config] keep-best: false
[2023-07-21 10:03:26] [config] label-smoothing: 0
[2023-07-21 10:03:26] [config] layer-normalization: false
[2023-07-21 10:03:26] [config] learn-rate: 0.0001
[2023-07-21 10:03:26] [config] lemma-dependency: ""
[2023-07-21 10:03:26] [config] lemma-dim-emb: 0
[2023-07-21 10:03:26] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 10:03:26] [config] log-level: info
[2023-07-21 10:03:26] [config] log-time-zone: ""
[2023-07-21 10:03:26] [config] logical-epoch:
[2023-07-21 10:03:26] [config]   - 1e
[2023-07-21 10:03:26] [config]   - 0
[2023-07-21 10:03:26] [config] lr-decay: 0
[2023-07-21 10:03:26] [config] lr-decay-freq: 50000
[2023-07-21 10:03:26] [config] lr-decay-inv-sqrt:
[2023-07-21 10:03:26] [config]   - 0
[2023-07-21 10:03:26] [config] lr-decay-repeat-warmup: false
[2023-07-21 10:03:26] [config] lr-decay-reset-optimizer: false
[2023-07-21 10:03:26] [config] lr-decay-start:
[2023-07-21 10:03:26] [config]   - 10
[2023-07-21 10:03:26] [config]   - 1
[2023-07-21 10:03:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 10:03:26] [config] lr-report: false
[2023-07-21 10:03:26] [config] lr-warmup: 0
[2023-07-21 10:03:26] [config] lr-warmup-at-reload: false
[2023-07-21 10:03:26] [config] lr-warmup-cycle: false
[2023-07-21 10:03:26] [config] lr-warmup-start-rate: 0
[2023-07-21 10:03:26] [config] max-length: 150
[2023-07-21 10:03:26] [config] max-length-crop: true
[2023-07-21 10:03:26] [config] max-length-factor: 3
[2023-07-21 10:03:26] [config] maxi-batch: 100
[2023-07-21 10:03:26] [config] maxi-batch-sort: trg
[2023-07-21 10:03:26] [config] mini-batch: 64
[2023-07-21 10:03:26] [config] mini-batch-fit: true
[2023-07-21 10:03:26] [config] mini-batch-fit-step: 10
[2023-07-21 10:03:26] [config] mini-batch-round-up: true
[2023-07-21 10:03:26] [config] mini-batch-track-lr: false
[2023-07-21 10:03:26] [config] mini-batch-warmup: 0
[2023-07-21 10:03:26] [config] mini-batch-words: 0
[2023-07-21 10:03:26] [config] mini-batch-words-ref: 0
[2023-07-21 10:03:26] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 10:03:26] [config] multi-loss-type: sum
[2023-07-21 10:03:26] [config] n-best: false
[2023-07-21 10:03:26] [config] no-nccl: false
[2023-07-21 10:03:26] [config] no-reload: false
[2023-07-21 10:03:26] [config] no-restore-corpus: false
[2023-07-21 10:03:26] [config] normalize: 0
[2023-07-21 10:03:26] [config] normalize-gradient: false
[2023-07-21 10:03:26] [config] num-devices: 0
[2023-07-21 10:03:26] [config] optimizer: adam
[2023-07-21 10:03:26] [config] optimizer-delay: 1
[2023-07-21 10:03:26] [config] optimizer-params:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] output-omit-bias: false
[2023-07-21 10:03:26] [config] overwrite: true
[2023-07-21 10:03:26] [config] precision:
[2023-07-21 10:03:26] [config]   - float16
[2023-07-21 10:03:26] [config]   - float32
[2023-07-21 10:03:26] [config] pretrained-model: ""
[2023-07-21 10:03:26] [config] quantize-biases: false
[2023-07-21 10:03:26] [config] quantize-bits: 0
[2023-07-21 10:03:26] [config] quantize-log-based: false
[2023-07-21 10:03:26] [config] quantize-optimization-steps: 0
[2023-07-21 10:03:26] [config] quiet: false
[2023-07-21 10:03:26] [config] quiet-translation: true
[2023-07-21 10:03:26] [config] relative-paths: false
[2023-07-21 10:03:26] [config] right-left: false
[2023-07-21 10:03:26] [config] save-freq: 10000u
[2023-07-21 10:03:26] [config] seed: 1234
[2023-07-21 10:03:26] [config] sentencepiece-alphas:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] sentencepiece-max-lines: 2000000
[2023-07-21 10:03:26] [config] sentencepiece-options: ""
[2023-07-21 10:03:26] [config] sharding: global
[2023-07-21 10:03:26] [config] shuffle: data
[2023-07-21 10:03:26] [config] shuffle-in-ram: false
[2023-07-21 10:03:26] [config] sigterm: save-and-exit
[2023-07-21 10:03:26] [config] skip: false
[2023-07-21 10:03:26] [config] sqlite: ""
[2023-07-21 10:03:26] [config] sqlite-drop: false
[2023-07-21 10:03:26] [config] sync-freq: 200u
[2023-07-21 10:03:26] [config] sync-sgd: false
[2023-07-21 10:03:26] [config] tempdir: /tmp
[2023-07-21 10:03:26] [config] tied-embeddings: false
[2023-07-21 10:03:26] [config] tied-embeddings-all: true
[2023-07-21 10:03:26] [config] tied-embeddings-src: false
[2023-07-21 10:03:26] [config] train-embedder-rank:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] train-sets:
[2023-07-21 10:03:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 10:03:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 10:03:26] [config] transformer-aan-activation: swish
[2023-07-21 10:03:26] [config] transformer-aan-depth: 2
[2023-07-21 10:03:26] [config] transformer-aan-nogate: false
[2023-07-21 10:03:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 10:03:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 10:03:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 10:03:26] [config] transformer-depth-scaling: false
[2023-07-21 10:03:26] [config] transformer-dim-aan: 2048
[2023-07-21 10:03:26] [config] transformer-dim-ffn: 2048
[2023-07-21 10:03:26] [config] transformer-dropout: 0
[2023-07-21 10:03:26] [config] transformer-dropout-attention: 0
[2023-07-21 10:03:26] [config] transformer-dropout-ffn: 0
[2023-07-21 10:03:26] [config] transformer-ffn-activation: swish
[2023-07-21 10:03:26] [config] transformer-ffn-depth: 2
[2023-07-21 10:03:26] [config] transformer-guided-alignment-layer: last
[2023-07-21 10:03:26] [config] transformer-heads: 8
[2023-07-21 10:03:26] [config] transformer-no-projection: false
[2023-07-21 10:03:26] [config] transformer-pool: false
[2023-07-21 10:03:26] [config] transformer-postprocess: dan
[2023-07-21 10:03:26] [config] transformer-postprocess-emb: d
[2023-07-21 10:03:26] [config] transformer-postprocess-top: ""
[2023-07-21 10:03:26] [config] transformer-preprocess: ""
[2023-07-21 10:03:26] [config] transformer-tied-layers:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] transformer-train-position-embeddings: false
[2023-07-21 10:03:26] [config] tsv: false
[2023-07-21 10:03:26] [config] tsv-fields: 0
[2023-07-21 10:03:26] [config] type: amun
[2023-07-21 10:03:26] [config] ulr: false
[2023-07-21 10:03:26] [config] ulr-dim-emb: 0
[2023-07-21 10:03:26] [config] ulr-dropout: 0
[2023-07-21 10:03:26] [config] ulr-keys-vectors: ""
[2023-07-21 10:03:26] [config] ulr-query-vectors: ""
[2023-07-21 10:03:26] [config] ulr-softmax-temperature: 1
[2023-07-21 10:03:26] [config] ulr-trainable-transformation: false
[2023-07-21 10:03:26] [config] unlikelihood-loss: false
[2023-07-21 10:03:26] [config] valid-freq: 50000000
[2023-07-21 10:03:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 10:03:26] [config] valid-max-length: 1000
[2023-07-21 10:03:26] [config] valid-metrics:
[2023-07-21 10:03:26] [config]   - cross-entropy
[2023-07-21 10:03:26] [config]   - translation
[2023-07-21 10:03:26] [config] valid-mini-batch: 32
[2023-07-21 10:03:26] [config] valid-reset-stalled: false
[2023-07-21 10:03:26] [config] valid-script-args:
[2023-07-21 10:03:26] [config]   []
[2023-07-21 10:03:26] [config] valid-script-path: ""
[2023-07-21 10:03:26] [config] valid-sets:
[2023-07-21 10:03:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 10:03:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 10:03:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 10:03:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 10:03:26] [config] vocabs:
[2023-07-21 10:03:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 10:03:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 10:03:26] [config] word-penalty: 0
[2023-07-21 10:03:26] [config] word-scores: false
[2023-07-21 10:03:26] [config] workspace: 5500
[2023-07-21 10:03:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 10:03:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 10:03:26] [training] Using single-device training
[2023-07-21 10:03:27] Synced seed 1234
[2023-07-21 10:03:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 10:03:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 10:03:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 10:03:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 10:03:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 10:03:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 10:03:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 10:03:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 10:03:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 10:03:29] [comm] Using global sharding
[2023-07-21 10:03:29] [comm] NCCLCommunicators constructed successfully
[2023-07-21 10:03:29] [training] Using 1 GPUs
[2023-07-21 10:03:29] [logits] Applying loss function for 1 factor(s)
[2023-07-21 10:03:29] [memory] Reserving 80 MB, device gpu0
[2023-07-21 10:03:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 10:03:29] [memory] Reserving 80 MB, device gpu0
[2023-07-21 10:33:39] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 10:33:39] [valid] No post-processing script given for validating translator
[2023-07-21 10:33:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 10:33:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 10:33:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 10:33:39] [comm] Using global sharding
[2023-07-21 10:33:39] [comm] NCCLCommunicators constructed successfully
[2023-07-21 10:33:39] [training] Using 1 GPUs
[2023-07-21 10:33:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 10:33:47] Allocating memory for general optimizer shards
[2023-07-21 10:33:47] [memory] Reserving 322 MB, device gpu0
[2023-07-21 10:33:47] Loading Adam parameters
[2023-07-21 10:33:47] [memory] Reserving 322 MB, device gpu0
[2023-07-21 10:33:47] [memory] Reserving 80 MB, device gpu0
[2023-07-21 10:33:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 10:33:47] [data] Restoring the corpus state to epoch 121, batch 4578
[2023-07-21 10:33:47] [data] Shuffling data
[2023-07-21 10:33:47] [data] Done reading 20,192 sentences
[2023-07-21 10:33:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:33:47] Training started
[2023-07-21 10:33:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 10:33:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 10:33:55] Parameter type float16, optimization type float32, casting types true
[2023-07-21 10:38:01] Seen 20,192 samples
[2023-07-21 10:38:01] Starting data epoch 122 in logical epoch 122
[2023-07-21 10:38:01] [data] Shuffling data
[2023-07-21 10:38:01] [data] Done reading 20,192 sentences
[2023-07-21 10:38:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:42:31] Seen 20,192 samples
[2023-07-21 10:42:31] Starting data epoch 123 in logical epoch 123
[2023-07-21 10:42:31] [data] Shuffling data
[2023-07-21 10:42:31] [data] Done reading 20,192 sentences
[2023-07-21 10:42:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:47:10] Seen 20,192 samples
[2023-07-21 10:47:10] Starting data epoch 124 in logical epoch 124
[2023-07-21 10:47:10] [data] Shuffling data
[2023-07-21 10:47:10] [data] Done reading 20,192 sentences
[2023-07-21 10:47:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:51:36] Seen 20,192 samples
[2023-07-21 10:51:36] Starting data epoch 125 in logical epoch 125
[2023-07-21 10:51:36] [data] Shuffling data
[2023-07-21 10:51:36] [data] Done reading 20,192 sentences
[2023-07-21 10:51:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:56:16] Seen 20,192 samples
[2023-07-21 10:56:16] Starting data epoch 126 in logical epoch 126
[2023-07-21 10:56:16] [data] Shuffling data
[2023-07-21 10:56:16] [data] Done reading 20,192 sentences
[2023-07-21 10:56:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:00:24] Seen 20,192 samples
[2023-07-21 11:00:24] Starting data epoch 127 in logical epoch 127
[2023-07-21 11:00:24] [data] Shuffling data
[2023-07-21 11:00:24] [data] Done reading 20,192 sentences
[2023-07-21 11:00:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:04:59] Seen 20,192 samples
[2023-07-21 11:04:59] Starting data epoch 128 in logical epoch 128
[2023-07-21 11:04:59] [data] Shuffling data
[2023-07-21 11:04:59] [data] Done reading 20,192 sentences
[2023-07-21 11:04:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:09:41] Seen 20,192 samples
[2023-07-21 11:09:41] Starting data epoch 129 in logical epoch 129
[2023-07-21 11:09:41] [data] Shuffling data
[2023-07-21 11:09:41] [data] Done reading 20,192 sentences
[2023-07-21 11:09:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:14:29] Seen 20,192 samples
[2023-07-21 11:14:29] Starting data epoch 130 in logical epoch 130
[2023-07-21 11:14:29] [data] Shuffling data
[2023-07-21 11:14:29] [data] Done reading 20,192 sentences
[2023-07-21 11:14:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:19:18] Seen 20,192 samples
[2023-07-21 11:19:18] Starting data epoch 131 in logical epoch 131
[2023-07-21 11:19:18] Training finished
[2023-07-21 11:19:33] [valid] Ep. 131 : Up. 4961 : cross-entropy : 126.211 : new best
[2023-07-21 11:22:21] [valid] Ep. 131 : Up. 4961 : translation : 0 : new best
[2023-07-21 11:22:21] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 11:22:23] Saving Adam parameters
[2023-07-21 11:22:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 11:22:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 11:22:31] [marian] Running on node23.datos.cluster.uy as process 22954 with command line:
[2023-07-21 11:22:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 11:22:31] [config] after: 0e
[2023-07-21 11:22:31] [config] after-batches: 0
[2023-07-21 11:22:31] [config] after-epochs: 140
[2023-07-21 11:22:31] [config] all-caps-every: 0
[2023-07-21 11:22:31] [config] allow-unk: false
[2023-07-21 11:22:31] [config] authors: false
[2023-07-21 11:22:31] [config] beam-size: 12
[2023-07-21 11:22:31] [config] bert-class-symbol: "[CLS]"
[2023-07-21 11:22:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 11:22:31] [config] bert-masking-fraction: 0.15
[2023-07-21 11:22:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 11:22:31] [config] bert-train-type-embeddings: true
[2023-07-21 11:22:31] [config] bert-type-vocab-size: 2
[2023-07-21 11:22:31] [config] build-info: ""
[2023-07-21 11:22:31] [config] check-gradient-nan: false
[2023-07-21 11:22:31] [config] check-nan: false
[2023-07-21 11:22:31] [config] cite: false
[2023-07-21 11:22:31] [config] clip-norm: 1
[2023-07-21 11:22:31] [config] cost-scaling:
[2023-07-21 11:22:31] [config]   - 256.f
[2023-07-21 11:22:31] [config]   - 1000
[2023-07-21 11:22:31] [config]   - 2.f
[2023-07-21 11:22:31] [config]   - 256.f
[2023-07-21 11:22:31] [config] cost-type: ce-sum
[2023-07-21 11:22:31] [config] cpu-threads: 0
[2023-07-21 11:22:31] [config] data-threads: 8
[2023-07-21 11:22:31] [config] data-weighting: ""
[2023-07-21 11:22:31] [config] data-weighting-type: sentence
[2023-07-21 11:22:31] [config] dec-cell: gru
[2023-07-21 11:22:31] [config] dec-cell-base-depth: 2
[2023-07-21 11:22:31] [config] dec-cell-high-depth: 1
[2023-07-21 11:22:31] [config] dec-depth: 1
[2023-07-21 11:22:31] [config] devices:
[2023-07-21 11:22:31] [config]   - 0
[2023-07-21 11:22:31] [config] dim-emb: 512
[2023-07-21 11:22:31] [config] dim-rnn: 1024
[2023-07-21 11:22:31] [config] dim-vocabs:
[2023-07-21 11:22:31] [config]   - 16384
[2023-07-21 11:22:31] [config]   - 16384
[2023-07-21 11:22:31] [config] disp-first: 0
[2023-07-21 11:22:31] [config] disp-freq: 1000u
[2023-07-21 11:22:31] [config] disp-label-counts: true
[2023-07-21 11:22:31] [config] dropout-rnn: 0
[2023-07-21 11:22:31] [config] dropout-src: 0
[2023-07-21 11:22:31] [config] dropout-trg: 0
[2023-07-21 11:22:31] [config] dump-config: ""
[2023-07-21 11:22:31] [config] dynamic-gradient-scaling:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] early-stopping: 200
[2023-07-21 11:22:31] [config] early-stopping-on: first
[2023-07-21 11:22:31] [config] embedding-fix-src: false
[2023-07-21 11:22:31] [config] embedding-fix-trg: false
[2023-07-21 11:22:31] [config] embedding-normalization: false
[2023-07-21 11:22:31] [config] embedding-vectors:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] enc-cell: gru
[2023-07-21 11:22:31] [config] enc-cell-depth: 1
[2023-07-21 11:22:31] [config] enc-depth: 1
[2023-07-21 11:22:31] [config] enc-type: bidirectional
[2023-07-21 11:22:31] [config] english-title-case-every: 0
[2023-07-21 11:22:31] [config] exponential-smoothing: 0
[2023-07-21 11:22:31] [config] factor-weight: 1
[2023-07-21 11:22:31] [config] factors-combine: sum
[2023-07-21 11:22:31] [config] factors-dim-emb: 0
[2023-07-21 11:22:31] [config] gradient-checkpointing: false
[2023-07-21 11:22:31] [config] gradient-norm-average-window: 100
[2023-07-21 11:22:31] [config] guided-alignment: none
[2023-07-21 11:22:31] [config] guided-alignment-cost: mse
[2023-07-21 11:22:31] [config] guided-alignment-weight: 0.1
[2023-07-21 11:22:31] [config] ignore-model-config: false
[2023-07-21 11:22:31] [config] input-types:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] interpolate-env-vars: false
[2023-07-21 11:22:31] [config] keep-best: false
[2023-07-21 11:22:31] [config] label-smoothing: 0
[2023-07-21 11:22:31] [config] layer-normalization: false
[2023-07-21 11:22:31] [config] learn-rate: 0.0001
[2023-07-21 11:22:31] [config] lemma-dependency: ""
[2023-07-21 11:22:31] [config] lemma-dim-emb: 0
[2023-07-21 11:22:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 11:22:31] [config] log-level: info
[2023-07-21 11:22:31] [config] log-time-zone: ""
[2023-07-21 11:22:31] [config] logical-epoch:
[2023-07-21 11:22:31] [config]   - 1e
[2023-07-21 11:22:31] [config]   - 0
[2023-07-21 11:22:31] [config] lr-decay: 0
[2023-07-21 11:22:31] [config] lr-decay-freq: 50000
[2023-07-21 11:22:31] [config] lr-decay-inv-sqrt:
[2023-07-21 11:22:31] [config]   - 0
[2023-07-21 11:22:31] [config] lr-decay-repeat-warmup: false
[2023-07-21 11:22:31] [config] lr-decay-reset-optimizer: false
[2023-07-21 11:22:31] [config] lr-decay-start:
[2023-07-21 11:22:31] [config]   - 10
[2023-07-21 11:22:31] [config]   - 1
[2023-07-21 11:22:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 11:22:31] [config] lr-report: false
[2023-07-21 11:22:31] [config] lr-warmup: 0
[2023-07-21 11:22:31] [config] lr-warmup-at-reload: false
[2023-07-21 11:22:31] [config] lr-warmup-cycle: false
[2023-07-21 11:22:31] [config] lr-warmup-start-rate: 0
[2023-07-21 11:22:31] [config] max-length: 150
[2023-07-21 11:22:31] [config] max-length-crop: true
[2023-07-21 11:22:31] [config] max-length-factor: 3
[2023-07-21 11:22:31] [config] maxi-batch: 100
[2023-07-21 11:22:31] [config] maxi-batch-sort: trg
[2023-07-21 11:22:31] [config] mini-batch: 64
[2023-07-21 11:22:31] [config] mini-batch-fit: true
[2023-07-21 11:22:31] [config] mini-batch-fit-step: 10
[2023-07-21 11:22:31] [config] mini-batch-round-up: true
[2023-07-21 11:22:31] [config] mini-batch-track-lr: false
[2023-07-21 11:22:31] [config] mini-batch-warmup: 0
[2023-07-21 11:22:31] [config] mini-batch-words: 0
[2023-07-21 11:22:31] [config] mini-batch-words-ref: 0
[2023-07-21 11:22:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 11:22:31] [config] multi-loss-type: sum
[2023-07-21 11:22:31] [config] n-best: false
[2023-07-21 11:22:31] [config] no-nccl: false
[2023-07-21 11:22:31] [config] no-reload: false
[2023-07-21 11:22:31] [config] no-restore-corpus: false
[2023-07-21 11:22:31] [config] normalize: 0
[2023-07-21 11:22:31] [config] normalize-gradient: false
[2023-07-21 11:22:31] [config] num-devices: 0
[2023-07-21 11:22:31] [config] optimizer: adam
[2023-07-21 11:22:31] [config] optimizer-delay: 1
[2023-07-21 11:22:31] [config] optimizer-params:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] output-omit-bias: false
[2023-07-21 11:22:31] [config] overwrite: true
[2023-07-21 11:22:31] [config] precision:
[2023-07-21 11:22:31] [config]   - float16
[2023-07-21 11:22:31] [config]   - float32
[2023-07-21 11:22:31] [config] pretrained-model: ""
[2023-07-21 11:22:31] [config] quantize-biases: false
[2023-07-21 11:22:31] [config] quantize-bits: 0
[2023-07-21 11:22:31] [config] quantize-log-based: false
[2023-07-21 11:22:31] [config] quantize-optimization-steps: 0
[2023-07-21 11:22:31] [config] quiet: false
[2023-07-21 11:22:31] [config] quiet-translation: true
[2023-07-21 11:22:31] [config] relative-paths: false
[2023-07-21 11:22:31] [config] right-left: false
[2023-07-21 11:22:31] [config] save-freq: 10000u
[2023-07-21 11:22:31] [config] seed: 1234
[2023-07-21 11:22:31] [config] sentencepiece-alphas:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] sentencepiece-max-lines: 2000000
[2023-07-21 11:22:31] [config] sentencepiece-options: ""
[2023-07-21 11:22:31] [config] sharding: global
[2023-07-21 11:22:31] [config] shuffle: data
[2023-07-21 11:22:31] [config] shuffle-in-ram: false
[2023-07-21 11:22:31] [config] sigterm: save-and-exit
[2023-07-21 11:22:31] [config] skip: false
[2023-07-21 11:22:31] [config] sqlite: ""
[2023-07-21 11:22:31] [config] sqlite-drop: false
[2023-07-21 11:22:31] [config] sync-freq: 200u
[2023-07-21 11:22:31] [config] sync-sgd: false
[2023-07-21 11:22:31] [config] tempdir: /tmp
[2023-07-21 11:22:31] [config] tied-embeddings: false
[2023-07-21 11:22:31] [config] tied-embeddings-all: true
[2023-07-21 11:22:31] [config] tied-embeddings-src: false
[2023-07-21 11:22:31] [config] train-embedder-rank:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] train-sets:
[2023-07-21 11:22:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 11:22:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 11:22:31] [config] transformer-aan-activation: swish
[2023-07-21 11:22:31] [config] transformer-aan-depth: 2
[2023-07-21 11:22:31] [config] transformer-aan-nogate: false
[2023-07-21 11:22:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 11:22:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 11:22:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 11:22:31] [config] transformer-depth-scaling: false
[2023-07-21 11:22:31] [config] transformer-dim-aan: 2048
[2023-07-21 11:22:31] [config] transformer-dim-ffn: 2048
[2023-07-21 11:22:31] [config] transformer-dropout: 0
[2023-07-21 11:22:31] [config] transformer-dropout-attention: 0
[2023-07-21 11:22:31] [config] transformer-dropout-ffn: 0
[2023-07-21 11:22:31] [config] transformer-ffn-activation: swish
[2023-07-21 11:22:31] [config] transformer-ffn-depth: 2
[2023-07-21 11:22:31] [config] transformer-guided-alignment-layer: last
[2023-07-21 11:22:31] [config] transformer-heads: 8
[2023-07-21 11:22:31] [config] transformer-no-projection: false
[2023-07-21 11:22:31] [config] transformer-pool: false
[2023-07-21 11:22:31] [config] transformer-postprocess: dan
[2023-07-21 11:22:31] [config] transformer-postprocess-emb: d
[2023-07-21 11:22:31] [config] transformer-postprocess-top: ""
[2023-07-21 11:22:31] [config] transformer-preprocess: ""
[2023-07-21 11:22:31] [config] transformer-tied-layers:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] transformer-train-position-embeddings: false
[2023-07-21 11:22:31] [config] tsv: false
[2023-07-21 11:22:31] [config] tsv-fields: 0
[2023-07-21 11:22:31] [config] type: amun
[2023-07-21 11:22:31] [config] ulr: false
[2023-07-21 11:22:31] [config] ulr-dim-emb: 0
[2023-07-21 11:22:31] [config] ulr-dropout: 0
[2023-07-21 11:22:31] [config] ulr-keys-vectors: ""
[2023-07-21 11:22:31] [config] ulr-query-vectors: ""
[2023-07-21 11:22:31] [config] ulr-softmax-temperature: 1
[2023-07-21 11:22:31] [config] ulr-trainable-transformation: false
[2023-07-21 11:22:31] [config] unlikelihood-loss: false
[2023-07-21 11:22:31] [config] valid-freq: 50000000
[2023-07-21 11:22:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 11:22:31] [config] valid-max-length: 1000
[2023-07-21 11:22:31] [config] valid-metrics:
[2023-07-21 11:22:31] [config]   - cross-entropy
[2023-07-21 11:22:31] [config]   - translation
[2023-07-21 11:22:31] [config] valid-mini-batch: 32
[2023-07-21 11:22:31] [config] valid-reset-stalled: false
[2023-07-21 11:22:31] [config] valid-script-args:
[2023-07-21 11:22:31] [config]   []
[2023-07-21 11:22:31] [config] valid-script-path: ""
[2023-07-21 11:22:31] [config] valid-sets:
[2023-07-21 11:22:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 11:22:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 11:22:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 11:22:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 11:22:31] [config] vocabs:
[2023-07-21 11:22:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 11:22:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 11:22:31] [config] word-penalty: 0
[2023-07-21 11:22:31] [config] word-scores: false
[2023-07-21 11:22:31] [config] workspace: 5500
[2023-07-21 11:22:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 11:22:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 11:22:31] [training] Using single-device training
[2023-07-21 11:22:32] Synced seed 1234
[2023-07-21 11:22:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 11:22:32] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 11:22:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 11:22:32] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 11:22:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 11:22:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 11:22:32] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 11:22:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 11:22:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 11:22:33] [comm] Using global sharding
[2023-07-21 11:22:34] [comm] NCCLCommunicators constructed successfully
[2023-07-21 11:22:34] [training] Using 1 GPUs
[2023-07-21 11:22:34] [logits] Applying loss function for 1 factor(s)
[2023-07-21 11:22:34] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:22:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 11:22:34] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:51:39] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 11:51:39] [valid] No post-processing script given for validating translator
[2023-07-21 11:51:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 11:51:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 11:51:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 11:51:40] [comm] Using global sharding
[2023-07-21 11:51:40] [comm] NCCLCommunicators constructed successfully
[2023-07-21 11:51:40] [training] Using 1 GPUs
[2023-07-21 11:51:40] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 11:51:48] Allocating memory for general optimizer shards
[2023-07-21 11:51:48] [memory] Reserving 322 MB, device gpu0
[2023-07-21 11:51:48] Loading Adam parameters
[2023-07-21 11:51:48] [memory] Reserving 322 MB, device gpu0
[2023-07-21 11:51:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:51:49] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 11:51:49] [data] Restoring the corpus state to epoch 131, batch 4961
[2023-07-21 11:51:49] [data] Shuffling data
[2023-07-21 11:51:49] [data] Done reading 20,192 sentences
[2023-07-21 11:51:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:51:49] Training started
[2023-07-21 11:51:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 11:51:50] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:51:56] Parameter type float16, optimization type float32, casting types true
[2023-07-21 11:56:14] Seen 20,192 samples
[2023-07-21 11:56:14] Starting data epoch 132 in logical epoch 132
[2023-07-21 11:56:14] [data] Shuffling data
[2023-07-21 11:56:14] [data] Done reading 20,192 sentences
[2023-07-21 11:56:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:56:28] Ep. 132 : Up. 5000 : Sen. 239 : Cost 3.31217217 * 16,264,419 @ 20,764 after 81,245,349 : Time 288.14s : 56445.53 words/s : gNorm 1.3087
[2023-07-21 12:00:52] Seen 20,192 samples
[2023-07-21 12:00:52] Starting data epoch 133 in logical epoch 133
[2023-07-21 12:00:52] [data] Shuffling data
[2023-07-21 12:00:52] [data] Done reading 20,192 sentences
[2023-07-21 12:00:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:05:13] Seen 20,192 samples
[2023-07-21 12:05:13] Starting data epoch 134 in logical epoch 134
[2023-07-21 12:05:13] [data] Shuffling data
[2023-07-21 12:05:13] [data] Done reading 20,192 sentences
[2023-07-21 12:05:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:09:29] Seen 20,192 samples
[2023-07-21 12:09:29] Starting data epoch 135 in logical epoch 135
[2023-07-21 12:09:29] [data] Shuffling data
[2023-07-21 12:09:29] [data] Done reading 20,192 sentences
[2023-07-21 12:09:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:14:02] Seen 20,192 samples
[2023-07-21 12:14:02] Starting data epoch 136 in logical epoch 136
[2023-07-21 12:14:02] [data] Shuffling data
[2023-07-21 12:14:02] [data] Done reading 20,192 sentences
[2023-07-21 12:14:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:18:38] Seen 20,192 samples
[2023-07-21 12:18:38] Starting data epoch 137 in logical epoch 137
[2023-07-21 12:18:38] [data] Shuffling data
[2023-07-21 12:18:38] [data] Done reading 20,192 sentences
[2023-07-21 12:18:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:22:41] Seen 20,192 samples
[2023-07-21 12:22:41] Starting data epoch 138 in logical epoch 138
[2023-07-21 12:22:41] [data] Shuffling data
[2023-07-21 12:22:41] [data] Done reading 20,192 sentences
[2023-07-21 12:22:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:26:58] Seen 20,192 samples
[2023-07-21 12:26:58] Starting data epoch 139 in logical epoch 139
[2023-07-21 12:26:58] [data] Shuffling data
[2023-07-21 12:26:58] [data] Done reading 20,192 sentences
[2023-07-21 12:26:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:31:32] Seen 20,192 samples
[2023-07-21 12:31:32] Starting data epoch 140 in logical epoch 140
[2023-07-21 12:31:32] [data] Shuffling data
[2023-07-21 12:31:32] [data] Done reading 20,192 sentences
[2023-07-21 12:31:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:35:40] Seen 20,192 samples
[2023-07-21 12:35:40] Starting data epoch 141 in logical epoch 141
[2023-07-21 12:35:40] Training finished
[2023-07-21 12:35:51] [valid] Ep. 141 : Up. 5340 : cross-entropy : 128.149 : stalled 1 times (last best: 126.211)
[2023-07-21 12:38:09] [valid] Ep. 141 : Up. 5340 : translation : 0 : new best
[2023-07-21 12:38:09] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 12:38:12] Saving Adam parameters
[2023-07-21 12:38:13] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 12:38:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 12:38:21] [marian] Running on node23.datos.cluster.uy as process 27645 with command line:
[2023-07-21 12:38:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 12:38:21] [config] after: 0e
[2023-07-21 12:38:21] [config] after-batches: 0
[2023-07-21 12:38:21] [config] after-epochs: 150
[2023-07-21 12:38:21] [config] all-caps-every: 0
[2023-07-21 12:38:21] [config] allow-unk: false
[2023-07-21 12:38:21] [config] authors: false
[2023-07-21 12:38:21] [config] beam-size: 12
[2023-07-21 12:38:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 12:38:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 12:38:21] [config] bert-masking-fraction: 0.15
[2023-07-21 12:38:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 12:38:21] [config] bert-train-type-embeddings: true
[2023-07-21 12:38:21] [config] bert-type-vocab-size: 2
[2023-07-21 12:38:21] [config] build-info: ""
[2023-07-21 12:38:21] [config] check-gradient-nan: false
[2023-07-21 12:38:21] [config] check-nan: false
[2023-07-21 12:38:21] [config] cite: false
[2023-07-21 12:38:21] [config] clip-norm: 1
[2023-07-21 12:38:21] [config] cost-scaling:
[2023-07-21 12:38:21] [config]   - 256.f
[2023-07-21 12:38:21] [config]   - 1000
[2023-07-21 12:38:21] [config]   - 2.f
[2023-07-21 12:38:21] [config]   - 256.f
[2023-07-21 12:38:21] [config] cost-type: ce-sum
[2023-07-21 12:38:21] [config] cpu-threads: 0
[2023-07-21 12:38:21] [config] data-threads: 8
[2023-07-21 12:38:21] [config] data-weighting: ""
[2023-07-21 12:38:21] [config] data-weighting-type: sentence
[2023-07-21 12:38:21] [config] dec-cell: gru
[2023-07-21 12:38:21] [config] dec-cell-base-depth: 2
[2023-07-21 12:38:21] [config] dec-cell-high-depth: 1
[2023-07-21 12:38:21] [config] dec-depth: 1
[2023-07-21 12:38:21] [config] devices:
[2023-07-21 12:38:21] [config]   - 0
[2023-07-21 12:38:21] [config] dim-emb: 512
[2023-07-21 12:38:21] [config] dim-rnn: 1024
[2023-07-21 12:38:21] [config] dim-vocabs:
[2023-07-21 12:38:21] [config]   - 16384
[2023-07-21 12:38:21] [config]   - 16384
[2023-07-21 12:38:21] [config] disp-first: 0
[2023-07-21 12:38:21] [config] disp-freq: 1000u
[2023-07-21 12:38:21] [config] disp-label-counts: true
[2023-07-21 12:38:21] [config] dropout-rnn: 0
[2023-07-21 12:38:21] [config] dropout-src: 0
[2023-07-21 12:38:21] [config] dropout-trg: 0
[2023-07-21 12:38:21] [config] dump-config: ""
[2023-07-21 12:38:21] [config] dynamic-gradient-scaling:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] early-stopping: 200
[2023-07-21 12:38:21] [config] early-stopping-on: first
[2023-07-21 12:38:21] [config] embedding-fix-src: false
[2023-07-21 12:38:21] [config] embedding-fix-trg: false
[2023-07-21 12:38:21] [config] embedding-normalization: false
[2023-07-21 12:38:21] [config] embedding-vectors:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] enc-cell: gru
[2023-07-21 12:38:21] [config] enc-cell-depth: 1
[2023-07-21 12:38:21] [config] enc-depth: 1
[2023-07-21 12:38:21] [config] enc-type: bidirectional
[2023-07-21 12:38:21] [config] english-title-case-every: 0
[2023-07-21 12:38:21] [config] exponential-smoothing: 0
[2023-07-21 12:38:21] [config] factor-weight: 1
[2023-07-21 12:38:21] [config] factors-combine: sum
[2023-07-21 12:38:21] [config] factors-dim-emb: 0
[2023-07-21 12:38:21] [config] gradient-checkpointing: false
[2023-07-21 12:38:21] [config] gradient-norm-average-window: 100
[2023-07-21 12:38:21] [config] guided-alignment: none
[2023-07-21 12:38:21] [config] guided-alignment-cost: mse
[2023-07-21 12:38:21] [config] guided-alignment-weight: 0.1
[2023-07-21 12:38:21] [config] ignore-model-config: false
[2023-07-21 12:38:21] [config] input-types:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] interpolate-env-vars: false
[2023-07-21 12:38:21] [config] keep-best: false
[2023-07-21 12:38:21] [config] label-smoothing: 0
[2023-07-21 12:38:21] [config] layer-normalization: false
[2023-07-21 12:38:21] [config] learn-rate: 0.0001
[2023-07-21 12:38:21] [config] lemma-dependency: ""
[2023-07-21 12:38:21] [config] lemma-dim-emb: 0
[2023-07-21 12:38:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 12:38:21] [config] log-level: info
[2023-07-21 12:38:21] [config] log-time-zone: ""
[2023-07-21 12:38:21] [config] logical-epoch:
[2023-07-21 12:38:21] [config]   - 1e
[2023-07-21 12:38:21] [config]   - 0
[2023-07-21 12:38:21] [config] lr-decay: 0
[2023-07-21 12:38:21] [config] lr-decay-freq: 50000
[2023-07-21 12:38:21] [config] lr-decay-inv-sqrt:
[2023-07-21 12:38:21] [config]   - 0
[2023-07-21 12:38:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 12:38:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 12:38:21] [config] lr-decay-start:
[2023-07-21 12:38:21] [config]   - 10
[2023-07-21 12:38:21] [config]   - 1
[2023-07-21 12:38:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 12:38:21] [config] lr-report: false
[2023-07-21 12:38:21] [config] lr-warmup: 0
[2023-07-21 12:38:21] [config] lr-warmup-at-reload: false
[2023-07-21 12:38:21] [config] lr-warmup-cycle: false
[2023-07-21 12:38:21] [config] lr-warmup-start-rate: 0
[2023-07-21 12:38:21] [config] max-length: 150
[2023-07-21 12:38:21] [config] max-length-crop: true
[2023-07-21 12:38:21] [config] max-length-factor: 3
[2023-07-21 12:38:21] [config] maxi-batch: 100
[2023-07-21 12:38:21] [config] maxi-batch-sort: trg
[2023-07-21 12:38:21] [config] mini-batch: 64
[2023-07-21 12:38:21] [config] mini-batch-fit: true
[2023-07-21 12:38:21] [config] mini-batch-fit-step: 10
[2023-07-21 12:38:21] [config] mini-batch-round-up: true
[2023-07-21 12:38:21] [config] mini-batch-track-lr: false
[2023-07-21 12:38:21] [config] mini-batch-warmup: 0
[2023-07-21 12:38:21] [config] mini-batch-words: 0
[2023-07-21 12:38:21] [config] mini-batch-words-ref: 0
[2023-07-21 12:38:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 12:38:21] [config] multi-loss-type: sum
[2023-07-21 12:38:21] [config] n-best: false
[2023-07-21 12:38:21] [config] no-nccl: false
[2023-07-21 12:38:21] [config] no-reload: false
[2023-07-21 12:38:21] [config] no-restore-corpus: false
[2023-07-21 12:38:21] [config] normalize: 0
[2023-07-21 12:38:21] [config] normalize-gradient: false
[2023-07-21 12:38:21] [config] num-devices: 0
[2023-07-21 12:38:21] [config] optimizer: adam
[2023-07-21 12:38:21] [config] optimizer-delay: 1
[2023-07-21 12:38:21] [config] optimizer-params:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] output-omit-bias: false
[2023-07-21 12:38:21] [config] overwrite: true
[2023-07-21 12:38:21] [config] precision:
[2023-07-21 12:38:21] [config]   - float16
[2023-07-21 12:38:21] [config]   - float32
[2023-07-21 12:38:21] [config] pretrained-model: ""
[2023-07-21 12:38:21] [config] quantize-biases: false
[2023-07-21 12:38:21] [config] quantize-bits: 0
[2023-07-21 12:38:21] [config] quantize-log-based: false
[2023-07-21 12:38:21] [config] quantize-optimization-steps: 0
[2023-07-21 12:38:21] [config] quiet: false
[2023-07-21 12:38:21] [config] quiet-translation: true
[2023-07-21 12:38:21] [config] relative-paths: false
[2023-07-21 12:38:21] [config] right-left: false
[2023-07-21 12:38:21] [config] save-freq: 10000u
[2023-07-21 12:38:21] [config] seed: 1234
[2023-07-21 12:38:21] [config] sentencepiece-alphas:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 12:38:21] [config] sentencepiece-options: ""
[2023-07-21 12:38:21] [config] sharding: global
[2023-07-21 12:38:21] [config] shuffle: data
[2023-07-21 12:38:21] [config] shuffle-in-ram: false
[2023-07-21 12:38:21] [config] sigterm: save-and-exit
[2023-07-21 12:38:21] [config] skip: false
[2023-07-21 12:38:21] [config] sqlite: ""
[2023-07-21 12:38:21] [config] sqlite-drop: false
[2023-07-21 12:38:21] [config] sync-freq: 200u
[2023-07-21 12:38:21] [config] sync-sgd: false
[2023-07-21 12:38:21] [config] tempdir: /tmp
[2023-07-21 12:38:21] [config] tied-embeddings: false
[2023-07-21 12:38:21] [config] tied-embeddings-all: true
[2023-07-21 12:38:21] [config] tied-embeddings-src: false
[2023-07-21 12:38:21] [config] train-embedder-rank:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] train-sets:
[2023-07-21 12:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 12:38:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 12:38:21] [config] transformer-aan-activation: swish
[2023-07-21 12:38:21] [config] transformer-aan-depth: 2
[2023-07-21 12:38:21] [config] transformer-aan-nogate: false
[2023-07-21 12:38:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 12:38:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 12:38:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 12:38:21] [config] transformer-depth-scaling: false
[2023-07-21 12:38:21] [config] transformer-dim-aan: 2048
[2023-07-21 12:38:21] [config] transformer-dim-ffn: 2048
[2023-07-21 12:38:21] [config] transformer-dropout: 0
[2023-07-21 12:38:21] [config] transformer-dropout-attention: 0
[2023-07-21 12:38:21] [config] transformer-dropout-ffn: 0
[2023-07-21 12:38:21] [config] transformer-ffn-activation: swish
[2023-07-21 12:38:21] [config] transformer-ffn-depth: 2
[2023-07-21 12:38:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 12:38:21] [config] transformer-heads: 8
[2023-07-21 12:38:21] [config] transformer-no-projection: false
[2023-07-21 12:38:21] [config] transformer-pool: false
[2023-07-21 12:38:21] [config] transformer-postprocess: dan
[2023-07-21 12:38:21] [config] transformer-postprocess-emb: d
[2023-07-21 12:38:21] [config] transformer-postprocess-top: ""
[2023-07-21 12:38:21] [config] transformer-preprocess: ""
[2023-07-21 12:38:21] [config] transformer-tied-layers:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] transformer-train-position-embeddings: false
[2023-07-21 12:38:21] [config] tsv: false
[2023-07-21 12:38:21] [config] tsv-fields: 0
[2023-07-21 12:38:21] [config] type: amun
[2023-07-21 12:38:21] [config] ulr: false
[2023-07-21 12:38:21] [config] ulr-dim-emb: 0
[2023-07-21 12:38:21] [config] ulr-dropout: 0
[2023-07-21 12:38:21] [config] ulr-keys-vectors: ""
[2023-07-21 12:38:21] [config] ulr-query-vectors: ""
[2023-07-21 12:38:21] [config] ulr-softmax-temperature: 1
[2023-07-21 12:38:21] [config] ulr-trainable-transformation: false
[2023-07-21 12:38:21] [config] unlikelihood-loss: false
[2023-07-21 12:38:21] [config] valid-freq: 50000000
[2023-07-21 12:38:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 12:38:21] [config] valid-max-length: 1000
[2023-07-21 12:38:21] [config] valid-metrics:
[2023-07-21 12:38:21] [config]   - cross-entropy
[2023-07-21 12:38:21] [config]   - translation
[2023-07-21 12:38:21] [config] valid-mini-batch: 32
[2023-07-21 12:38:21] [config] valid-reset-stalled: false
[2023-07-21 12:38:21] [config] valid-script-args:
[2023-07-21 12:38:21] [config]   []
[2023-07-21 12:38:21] [config] valid-script-path: ""
[2023-07-21 12:38:21] [config] valid-sets:
[2023-07-21 12:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 12:38:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 12:38:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 12:38:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 12:38:21] [config] vocabs:
[2023-07-21 12:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 12:38:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 12:38:21] [config] word-penalty: 0
[2023-07-21 12:38:21] [config] word-scores: false
[2023-07-21 12:38:21] [config] workspace: 5500
[2023-07-21 12:38:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 12:38:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 12:38:21] [training] Using single-device training
[2023-07-21 12:38:21] Synced seed 1234
[2023-07-21 12:38:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 12:38:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 12:38:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 12:38:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 12:38:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 12:38:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 12:38:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 12:38:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 12:38:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 12:38:23] [comm] Using global sharding
[2023-07-21 12:38:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 12:38:23] [training] Using 1 GPUs
[2023-07-21 12:38:23] [logits] Applying loss function for 1 factor(s)
[2023-07-21 12:38:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 12:38:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 12:38:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 13:08:07] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 13:08:07] [valid] No post-processing script given for validating translator
[2023-07-21 13:08:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 13:08:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 13:08:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 13:08:07] [comm] Using global sharding
[2023-07-21 13:08:07] [comm] NCCLCommunicators constructed successfully
[2023-07-21 13:08:07] [training] Using 1 GPUs
[2023-07-21 13:08:07] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 13:08:17] Allocating memory for general optimizer shards
[2023-07-21 13:08:17] [memory] Reserving 322 MB, device gpu0
[2023-07-21 13:08:17] Loading Adam parameters
[2023-07-21 13:08:17] [memory] Reserving 322 MB, device gpu0
[2023-07-21 13:08:17] [memory] Reserving 80 MB, device gpu0
[2023-07-21 13:08:18] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 13:08:18] [data] Restoring the corpus state to epoch 141, batch 5340
[2023-07-21 13:08:18] [data] Shuffling data
[2023-07-21 13:08:18] [data] Done reading 20,192 sentences
[2023-07-21 13:08:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:08:18] Training started
[2023-07-21 13:08:18] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 13:08:18] [memory] Reserving 80 MB, device gpu0
[2023-07-21 13:08:22] Parameter type float16, optimization type float32, casting types true
[2023-07-21 13:12:31] Seen 20,192 samples
[2023-07-21 13:12:31] Starting data epoch 142 in logical epoch 142
[2023-07-21 13:12:31] [data] Shuffling data
[2023-07-21 13:12:31] [data] Done reading 20,192 sentences
[2023-07-21 13:12:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:17:07] Seen 20,192 samples
[2023-07-21 13:17:07] Starting data epoch 143 in logical epoch 143
[2023-07-21 13:17:07] [data] Shuffling data
[2023-07-21 13:17:07] [data] Done reading 20,192 sentences
[2023-07-21 13:17:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:21:37] Seen 20,192 samples
[2023-07-21 13:21:37] Starting data epoch 144 in logical epoch 144
[2023-07-21 13:21:37] [data] Shuffling data
[2023-07-21 13:21:37] [data] Done reading 20,192 sentences
[2023-07-21 13:21:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:26:21] Seen 20,192 samples
[2023-07-21 13:26:21] Starting data epoch 145 in logical epoch 145
[2023-07-21 13:26:21] [data] Shuffling data
[2023-07-21 13:26:21] [data] Done reading 20,192 sentences
[2023-07-21 13:26:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:31:02] Seen 20,192 samples
[2023-07-21 13:31:02] Starting data epoch 146 in logical epoch 146
[2023-07-21 13:31:02] [data] Shuffling data
[2023-07-21 13:31:02] [data] Done reading 20,192 sentences
[2023-07-21 13:31:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:35:37] Seen 20,192 samples
[2023-07-21 13:35:37] Starting data epoch 147 in logical epoch 147
[2023-07-21 13:35:37] [data] Shuffling data
[2023-07-21 13:35:37] [data] Done reading 20,192 sentences
[2023-07-21 13:35:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:39:58] Seen 20,192 samples
[2023-07-21 13:39:58] Starting data epoch 148 in logical epoch 148
[2023-07-21 13:39:58] [data] Shuffling data
[2023-07-21 13:39:58] [data] Done reading 20,192 sentences
[2023-07-21 13:39:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:43:16] Seen 20,192 samples
[2023-07-21 13:43:16] Starting data epoch 149 in logical epoch 149
[2023-07-21 13:43:16] [data] Shuffling data
[2023-07-21 13:43:16] [data] Done reading 20,192 sentences
[2023-07-21 13:43:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:47:46] Seen 20,192 samples
[2023-07-21 13:47:46] Starting data epoch 150 in logical epoch 150
[2023-07-21 13:47:46] [data] Shuffling data
[2023-07-21 13:47:46] [data] Done reading 20,192 sentences
[2023-07-21 13:47:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:52:17] Seen 20,192 samples
[2023-07-21 13:52:17] Starting data epoch 151 in logical epoch 151
[2023-07-21 13:52:17] Training finished
[2023-07-21 13:52:30] [valid] Ep. 151 : Up. 5718 : cross-entropy : 124.483 : new best
[2023-07-21 13:55:07] [valid] Ep. 151 : Up. 5718 : translation : 0 : new best
[2023-07-21 13:55:07] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 13:55:12] Saving Adam parameters
[2023-07-21 13:55:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 13:55:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 13:55:21] [marian] Running on node23.datos.cluster.uy as process 33005 with command line:
[2023-07-21 13:55:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 13:55:21] [config] after: 0e
[2023-07-21 13:55:21] [config] after-batches: 0
[2023-07-21 13:55:21] [config] after-epochs: 160
[2023-07-21 13:55:21] [config] all-caps-every: 0
[2023-07-21 13:55:21] [config] allow-unk: false
[2023-07-21 13:55:21] [config] authors: false
[2023-07-21 13:55:21] [config] beam-size: 12
[2023-07-21 13:55:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 13:55:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 13:55:21] [config] bert-masking-fraction: 0.15
[2023-07-21 13:55:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 13:55:21] [config] bert-train-type-embeddings: true
[2023-07-21 13:55:21] [config] bert-type-vocab-size: 2
[2023-07-21 13:55:21] [config] build-info: ""
[2023-07-21 13:55:21] [config] check-gradient-nan: false
[2023-07-21 13:55:21] [config] check-nan: false
[2023-07-21 13:55:21] [config] cite: false
[2023-07-21 13:55:21] [config] clip-norm: 1
[2023-07-21 13:55:21] [config] cost-scaling:
[2023-07-21 13:55:21] [config]   - 256.f
[2023-07-21 13:55:21] [config]   - 1000
[2023-07-21 13:55:21] [config]   - 2.f
[2023-07-21 13:55:21] [config]   - 256.f
[2023-07-21 13:55:21] [config] cost-type: ce-sum
[2023-07-21 13:55:21] [config] cpu-threads: 0
[2023-07-21 13:55:21] [config] data-threads: 8
[2023-07-21 13:55:21] [config] data-weighting: ""
[2023-07-21 13:55:21] [config] data-weighting-type: sentence
[2023-07-21 13:55:21] [config] dec-cell: gru
[2023-07-21 13:55:21] [config] dec-cell-base-depth: 2
[2023-07-21 13:55:21] [config] dec-cell-high-depth: 1
[2023-07-21 13:55:21] [config] dec-depth: 1
[2023-07-21 13:55:21] [config] devices:
[2023-07-21 13:55:21] [config]   - 0
[2023-07-21 13:55:21] [config] dim-emb: 512
[2023-07-21 13:55:21] [config] dim-rnn: 1024
[2023-07-21 13:55:21] [config] dim-vocabs:
[2023-07-21 13:55:21] [config]   - 16384
[2023-07-21 13:55:21] [config]   - 16384
[2023-07-21 13:55:21] [config] disp-first: 0
[2023-07-21 13:55:21] [config] disp-freq: 1000u
[2023-07-21 13:55:21] [config] disp-label-counts: true
[2023-07-21 13:55:21] [config] dropout-rnn: 0
[2023-07-21 13:55:21] [config] dropout-src: 0
[2023-07-21 13:55:21] [config] dropout-trg: 0
[2023-07-21 13:55:21] [config] dump-config: ""
[2023-07-21 13:55:21] [config] dynamic-gradient-scaling:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] early-stopping: 200
[2023-07-21 13:55:21] [config] early-stopping-on: first
[2023-07-21 13:55:21] [config] embedding-fix-src: false
[2023-07-21 13:55:21] [config] embedding-fix-trg: false
[2023-07-21 13:55:21] [config] embedding-normalization: false
[2023-07-21 13:55:21] [config] embedding-vectors:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] enc-cell: gru
[2023-07-21 13:55:21] [config] enc-cell-depth: 1
[2023-07-21 13:55:21] [config] enc-depth: 1
[2023-07-21 13:55:21] [config] enc-type: bidirectional
[2023-07-21 13:55:21] [config] english-title-case-every: 0
[2023-07-21 13:55:21] [config] exponential-smoothing: 0
[2023-07-21 13:55:21] [config] factor-weight: 1
[2023-07-21 13:55:21] [config] factors-combine: sum
[2023-07-21 13:55:21] [config] factors-dim-emb: 0
[2023-07-21 13:55:21] [config] gradient-checkpointing: false
[2023-07-21 13:55:21] [config] gradient-norm-average-window: 100
[2023-07-21 13:55:21] [config] guided-alignment: none
[2023-07-21 13:55:21] [config] guided-alignment-cost: mse
[2023-07-21 13:55:21] [config] guided-alignment-weight: 0.1
[2023-07-21 13:55:21] [config] ignore-model-config: false
[2023-07-21 13:55:21] [config] input-types:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] interpolate-env-vars: false
[2023-07-21 13:55:21] [config] keep-best: false
[2023-07-21 13:55:21] [config] label-smoothing: 0
[2023-07-21 13:55:21] [config] layer-normalization: false
[2023-07-21 13:55:21] [config] learn-rate: 0.0001
[2023-07-21 13:55:21] [config] lemma-dependency: ""
[2023-07-21 13:55:21] [config] lemma-dim-emb: 0
[2023-07-21 13:55:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 13:55:21] [config] log-level: info
[2023-07-21 13:55:21] [config] log-time-zone: ""
[2023-07-21 13:55:21] [config] logical-epoch:
[2023-07-21 13:55:21] [config]   - 1e
[2023-07-21 13:55:21] [config]   - 0
[2023-07-21 13:55:21] [config] lr-decay: 0
[2023-07-21 13:55:21] [config] lr-decay-freq: 50000
[2023-07-21 13:55:21] [config] lr-decay-inv-sqrt:
[2023-07-21 13:55:21] [config]   - 0
[2023-07-21 13:55:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 13:55:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 13:55:21] [config] lr-decay-start:
[2023-07-21 13:55:21] [config]   - 10
[2023-07-21 13:55:21] [config]   - 1
[2023-07-21 13:55:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 13:55:21] [config] lr-report: false
[2023-07-21 13:55:21] [config] lr-warmup: 0
[2023-07-21 13:55:21] [config] lr-warmup-at-reload: false
[2023-07-21 13:55:21] [config] lr-warmup-cycle: false
[2023-07-21 13:55:21] [config] lr-warmup-start-rate: 0
[2023-07-21 13:55:21] [config] max-length: 150
[2023-07-21 13:55:21] [config] max-length-crop: true
[2023-07-21 13:55:21] [config] max-length-factor: 3
[2023-07-21 13:55:21] [config] maxi-batch: 100
[2023-07-21 13:55:21] [config] maxi-batch-sort: trg
[2023-07-21 13:55:21] [config] mini-batch: 64
[2023-07-21 13:55:21] [config] mini-batch-fit: true
[2023-07-21 13:55:21] [config] mini-batch-fit-step: 10
[2023-07-21 13:55:21] [config] mini-batch-round-up: true
[2023-07-21 13:55:21] [config] mini-batch-track-lr: false
[2023-07-21 13:55:21] [config] mini-batch-warmup: 0
[2023-07-21 13:55:21] [config] mini-batch-words: 0
[2023-07-21 13:55:21] [config] mini-batch-words-ref: 0
[2023-07-21 13:55:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 13:55:21] [config] multi-loss-type: sum
[2023-07-21 13:55:21] [config] n-best: false
[2023-07-21 13:55:21] [config] no-nccl: false
[2023-07-21 13:55:21] [config] no-reload: false
[2023-07-21 13:55:21] [config] no-restore-corpus: false
[2023-07-21 13:55:21] [config] normalize: 0
[2023-07-21 13:55:21] [config] normalize-gradient: false
[2023-07-21 13:55:21] [config] num-devices: 0
[2023-07-21 13:55:21] [config] optimizer: adam
[2023-07-21 13:55:21] [config] optimizer-delay: 1
[2023-07-21 13:55:21] [config] optimizer-params:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] output-omit-bias: false
[2023-07-21 13:55:21] [config] overwrite: true
[2023-07-21 13:55:21] [config] precision:
[2023-07-21 13:55:21] [config]   - float16
[2023-07-21 13:55:21] [config]   - float32
[2023-07-21 13:55:21] [config] pretrained-model: ""
[2023-07-21 13:55:21] [config] quantize-biases: false
[2023-07-21 13:55:21] [config] quantize-bits: 0
[2023-07-21 13:55:21] [config] quantize-log-based: false
[2023-07-21 13:55:21] [config] quantize-optimization-steps: 0
[2023-07-21 13:55:21] [config] quiet: false
[2023-07-21 13:55:21] [config] quiet-translation: true
[2023-07-21 13:55:21] [config] relative-paths: false
[2023-07-21 13:55:21] [config] right-left: false
[2023-07-21 13:55:21] [config] save-freq: 10000u
[2023-07-21 13:55:21] [config] seed: 1234
[2023-07-21 13:55:21] [config] sentencepiece-alphas:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 13:55:21] [config] sentencepiece-options: ""
[2023-07-21 13:55:21] [config] sharding: global
[2023-07-21 13:55:21] [config] shuffle: data
[2023-07-21 13:55:21] [config] shuffle-in-ram: false
[2023-07-21 13:55:21] [config] sigterm: save-and-exit
[2023-07-21 13:55:21] [config] skip: false
[2023-07-21 13:55:21] [config] sqlite: ""
[2023-07-21 13:55:21] [config] sqlite-drop: false
[2023-07-21 13:55:21] [config] sync-freq: 200u
[2023-07-21 13:55:21] [config] sync-sgd: false
[2023-07-21 13:55:21] [config] tempdir: /tmp
[2023-07-21 13:55:21] [config] tied-embeddings: false
[2023-07-21 13:55:21] [config] tied-embeddings-all: true
[2023-07-21 13:55:21] [config] tied-embeddings-src: false
[2023-07-21 13:55:21] [config] train-embedder-rank:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] train-sets:
[2023-07-21 13:55:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 13:55:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 13:55:21] [config] transformer-aan-activation: swish
[2023-07-21 13:55:21] [config] transformer-aan-depth: 2
[2023-07-21 13:55:21] [config] transformer-aan-nogate: false
[2023-07-21 13:55:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 13:55:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 13:55:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 13:55:21] [config] transformer-depth-scaling: false
[2023-07-21 13:55:21] [config] transformer-dim-aan: 2048
[2023-07-21 13:55:21] [config] transformer-dim-ffn: 2048
[2023-07-21 13:55:21] [config] transformer-dropout: 0
[2023-07-21 13:55:21] [config] transformer-dropout-attention: 0
[2023-07-21 13:55:21] [config] transformer-dropout-ffn: 0
[2023-07-21 13:55:21] [config] transformer-ffn-activation: swish
[2023-07-21 13:55:21] [config] transformer-ffn-depth: 2
[2023-07-21 13:55:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 13:55:21] [config] transformer-heads: 8
[2023-07-21 13:55:21] [config] transformer-no-projection: false
[2023-07-21 13:55:21] [config] transformer-pool: false
[2023-07-21 13:55:21] [config] transformer-postprocess: dan
[2023-07-21 13:55:21] [config] transformer-postprocess-emb: d
[2023-07-21 13:55:21] [config] transformer-postprocess-top: ""
[2023-07-21 13:55:21] [config] transformer-preprocess: ""
[2023-07-21 13:55:21] [config] transformer-tied-layers:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] transformer-train-position-embeddings: false
[2023-07-21 13:55:21] [config] tsv: false
[2023-07-21 13:55:21] [config] tsv-fields: 0
[2023-07-21 13:55:21] [config] type: amun
[2023-07-21 13:55:21] [config] ulr: false
[2023-07-21 13:55:21] [config] ulr-dim-emb: 0
[2023-07-21 13:55:21] [config] ulr-dropout: 0
[2023-07-21 13:55:21] [config] ulr-keys-vectors: ""
[2023-07-21 13:55:21] [config] ulr-query-vectors: ""
[2023-07-21 13:55:21] [config] ulr-softmax-temperature: 1
[2023-07-21 13:55:21] [config] ulr-trainable-transformation: false
[2023-07-21 13:55:21] [config] unlikelihood-loss: false
[2023-07-21 13:55:21] [config] valid-freq: 50000000
[2023-07-21 13:55:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 13:55:21] [config] valid-max-length: 1000
[2023-07-21 13:55:21] [config] valid-metrics:
[2023-07-21 13:55:21] [config]   - cross-entropy
[2023-07-21 13:55:21] [config]   - translation
[2023-07-21 13:55:21] [config] valid-mini-batch: 32
[2023-07-21 13:55:21] [config] valid-reset-stalled: false
[2023-07-21 13:55:21] [config] valid-script-args:
[2023-07-21 13:55:21] [config]   []
[2023-07-21 13:55:21] [config] valid-script-path: ""
[2023-07-21 13:55:21] [config] valid-sets:
[2023-07-21 13:55:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 13:55:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 13:55:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 13:55:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 13:55:21] [config] vocabs:
[2023-07-21 13:55:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 13:55:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 13:55:21] [config] word-penalty: 0
[2023-07-21 13:55:21] [config] word-scores: false
[2023-07-21 13:55:21] [config] workspace: 5500
[2023-07-21 13:55:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 13:55:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 13:55:21] [training] Using single-device training
[2023-07-21 13:55:23] Synced seed 1234
[2023-07-21 13:55:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 13:55:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 13:55:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 13:55:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 13:55:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 13:55:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 13:55:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 13:55:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 13:55:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 13:55:24] [comm] Using global sharding
[2023-07-21 13:55:25] [comm] NCCLCommunicators constructed successfully
[2023-07-21 13:55:25] [training] Using 1 GPUs
[2023-07-21 13:55:25] [logits] Applying loss function for 1 factor(s)
[2023-07-21 13:55:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 13:55:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 13:55:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 14:26:24] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 14:26:24] [valid] No post-processing script given for validating translator
[2023-07-21 14:26:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 14:26:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 14:26:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 14:26:24] [comm] Using global sharding
[2023-07-21 14:26:25] [comm] NCCLCommunicators constructed successfully
[2023-07-21 14:26:25] [training] Using 1 GPUs
[2023-07-21 14:26:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 14:26:30] Allocating memory for general optimizer shards
[2023-07-21 14:26:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 14:26:30] Loading Adam parameters
[2023-07-21 14:26:31] [memory] Reserving 322 MB, device gpu0
[2023-07-21 14:26:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 14:26:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 14:26:31] [data] Restoring the corpus state to epoch 151, batch 5718
[2023-07-21 14:26:31] [data] Shuffling data
[2023-07-21 14:26:31] [data] Done reading 20,192 sentences
[2023-07-21 14:26:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:26:31] Training started
[2023-07-21 14:26:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 14:26:32] [memory] Reserving 80 MB, device gpu0
[2023-07-21 14:26:38] Parameter type float16, optimization type float32, casting types true
[2023-07-21 14:31:03] Seen 20,192 samples
[2023-07-21 14:31:03] Starting data epoch 152 in logical epoch 152
[2023-07-21 14:31:03] [data] Shuffling data
[2023-07-21 14:31:03] [data] Done reading 20,192 sentences
[2023-07-21 14:31:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:35:49] Seen 20,192 samples
[2023-07-21 14:35:49] Starting data epoch 153 in logical epoch 153
[2023-07-21 14:35:49] [data] Shuffling data
[2023-07-21 14:35:49] [data] Done reading 20,192 sentences
[2023-07-21 14:35:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:40:32] Seen 20,192 samples
[2023-07-21 14:40:32] Starting data epoch 154 in logical epoch 154
[2023-07-21 14:40:32] [data] Shuffling data
[2023-07-21 14:40:32] [data] Done reading 20,192 sentences
[2023-07-21 14:40:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:45:16] Seen 20,192 samples
[2023-07-21 14:45:16] Starting data epoch 155 in logical epoch 155
[2023-07-21 14:45:16] [data] Shuffling data
[2023-07-21 14:45:16] [data] Done reading 20,192 sentences
[2023-07-21 14:45:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:50:05] Seen 20,192 samples
[2023-07-21 14:50:05] Starting data epoch 156 in logical epoch 156
[2023-07-21 14:50:05] [data] Shuffling data
[2023-07-21 14:50:05] [data] Done reading 20,192 sentences
[2023-07-21 14:50:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:54:48] Seen 20,192 samples
[2023-07-21 14:54:48] Starting data epoch 157 in logical epoch 157
[2023-07-21 14:54:48] [data] Shuffling data
[2023-07-21 14:54:48] [data] Done reading 20,192 sentences
[2023-07-21 14:54:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:59:32] Seen 20,192 samples
[2023-07-21 14:59:32] Starting data epoch 158 in logical epoch 158
[2023-07-21 14:59:32] [data] Shuffling data
[2023-07-21 14:59:32] [data] Done reading 20,192 sentences
[2023-07-21 14:59:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:02:05] Ep. 158 : Up. 6000 : Sen. 9,842 : Cost 2.81318212 * 16,430,879 @ 18,524 after 97,676,229 : Time 2140.81s : 7675.08 words/s : gNorm 1.6034
[2023-07-21 15:04:28] Seen 20,192 samples
[2023-07-21 15:04:28] Starting data epoch 159 in logical epoch 159
[2023-07-21 15:04:28] [data] Shuffling data
[2023-07-21 15:04:28] [data] Done reading 20,192 sentences
[2023-07-21 15:04:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:09:17] Seen 20,192 samples
[2023-07-21 15:09:18] Starting data epoch 160 in logical epoch 160
[2023-07-21 15:09:18] [data] Shuffling data
[2023-07-21 15:09:18] [data] Done reading 20,192 sentences
[2023-07-21 15:09:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:14:08] Seen 20,192 samples
[2023-07-21 15:14:08] Starting data epoch 161 in logical epoch 161
[2023-07-21 15:14:08] Training finished
[2023-07-21 15:14:21] [valid] Ep. 161 : Up. 6095 : cross-entropy : 123.779 : new best
[2023-07-21 15:16:41] [valid] Ep. 161 : Up. 6095 : translation : 0 : new best
[2023-07-21 15:16:41] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 15:16:43] Saving Adam parameters
[2023-07-21 15:16:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 15:16:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 15:16:53] [marian] Running on node23.datos.cluster.uy as process 38016 with command line:
[2023-07-21 15:16:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 15:16:53] [config] after: 0e
[2023-07-21 15:16:53] [config] after-batches: 0
[2023-07-21 15:16:53] [config] after-epochs: 170
[2023-07-21 15:16:53] [config] all-caps-every: 0
[2023-07-21 15:16:53] [config] allow-unk: false
[2023-07-21 15:16:53] [config] authors: false
[2023-07-21 15:16:53] [config] beam-size: 12
[2023-07-21 15:16:53] [config] bert-class-symbol: "[CLS]"
[2023-07-21 15:16:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 15:16:53] [config] bert-masking-fraction: 0.15
[2023-07-21 15:16:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 15:16:53] [config] bert-train-type-embeddings: true
[2023-07-21 15:16:53] [config] bert-type-vocab-size: 2
[2023-07-21 15:16:53] [config] build-info: ""
[2023-07-21 15:16:53] [config] check-gradient-nan: false
[2023-07-21 15:16:53] [config] check-nan: false
[2023-07-21 15:16:53] [config] cite: false
[2023-07-21 15:16:53] [config] clip-norm: 1
[2023-07-21 15:16:53] [config] cost-scaling:
[2023-07-21 15:16:53] [config]   - 256.f
[2023-07-21 15:16:53] [config]   - 1000
[2023-07-21 15:16:53] [config]   - 2.f
[2023-07-21 15:16:53] [config]   - 256.f
[2023-07-21 15:16:53] [config] cost-type: ce-sum
[2023-07-21 15:16:53] [config] cpu-threads: 0
[2023-07-21 15:16:53] [config] data-threads: 8
[2023-07-21 15:16:53] [config] data-weighting: ""
[2023-07-21 15:16:53] [config] data-weighting-type: sentence
[2023-07-21 15:16:53] [config] dec-cell: gru
[2023-07-21 15:16:53] [config] dec-cell-base-depth: 2
[2023-07-21 15:16:53] [config] dec-cell-high-depth: 1
[2023-07-21 15:16:53] [config] dec-depth: 1
[2023-07-21 15:16:53] [config] devices:
[2023-07-21 15:16:53] [config]   - 0
[2023-07-21 15:16:53] [config] dim-emb: 512
[2023-07-21 15:16:53] [config] dim-rnn: 1024
[2023-07-21 15:16:53] [config] dim-vocabs:
[2023-07-21 15:16:53] [config]   - 16384
[2023-07-21 15:16:53] [config]   - 16384
[2023-07-21 15:16:53] [config] disp-first: 0
[2023-07-21 15:16:53] [config] disp-freq: 1000u
[2023-07-21 15:16:53] [config] disp-label-counts: true
[2023-07-21 15:16:53] [config] dropout-rnn: 0
[2023-07-21 15:16:53] [config] dropout-src: 0
[2023-07-21 15:16:53] [config] dropout-trg: 0
[2023-07-21 15:16:53] [config] dump-config: ""
[2023-07-21 15:16:53] [config] dynamic-gradient-scaling:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] early-stopping: 200
[2023-07-21 15:16:53] [config] early-stopping-on: first
[2023-07-21 15:16:53] [config] embedding-fix-src: false
[2023-07-21 15:16:53] [config] embedding-fix-trg: false
[2023-07-21 15:16:53] [config] embedding-normalization: false
[2023-07-21 15:16:53] [config] embedding-vectors:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] enc-cell: gru
[2023-07-21 15:16:53] [config] enc-cell-depth: 1
[2023-07-21 15:16:53] [config] enc-depth: 1
[2023-07-21 15:16:53] [config] enc-type: bidirectional
[2023-07-21 15:16:53] [config] english-title-case-every: 0
[2023-07-21 15:16:53] [config] exponential-smoothing: 0
[2023-07-21 15:16:53] [config] factor-weight: 1
[2023-07-21 15:16:53] [config] factors-combine: sum
[2023-07-21 15:16:53] [config] factors-dim-emb: 0
[2023-07-21 15:16:53] [config] gradient-checkpointing: false
[2023-07-21 15:16:53] [config] gradient-norm-average-window: 100
[2023-07-21 15:16:53] [config] guided-alignment: none
[2023-07-21 15:16:53] [config] guided-alignment-cost: mse
[2023-07-21 15:16:53] [config] guided-alignment-weight: 0.1
[2023-07-21 15:16:53] [config] ignore-model-config: false
[2023-07-21 15:16:53] [config] input-types:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] interpolate-env-vars: false
[2023-07-21 15:16:53] [config] keep-best: false
[2023-07-21 15:16:53] [config] label-smoothing: 0
[2023-07-21 15:16:53] [config] layer-normalization: false
[2023-07-21 15:16:53] [config] learn-rate: 0.0001
[2023-07-21 15:16:53] [config] lemma-dependency: ""
[2023-07-21 15:16:53] [config] lemma-dim-emb: 0
[2023-07-21 15:16:53] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 15:16:53] [config] log-level: info
[2023-07-21 15:16:53] [config] log-time-zone: ""
[2023-07-21 15:16:53] [config] logical-epoch:
[2023-07-21 15:16:53] [config]   - 1e
[2023-07-21 15:16:53] [config]   - 0
[2023-07-21 15:16:53] [config] lr-decay: 0
[2023-07-21 15:16:53] [config] lr-decay-freq: 50000
[2023-07-21 15:16:53] [config] lr-decay-inv-sqrt:
[2023-07-21 15:16:53] [config]   - 0
[2023-07-21 15:16:53] [config] lr-decay-repeat-warmup: false
[2023-07-21 15:16:53] [config] lr-decay-reset-optimizer: false
[2023-07-21 15:16:53] [config] lr-decay-start:
[2023-07-21 15:16:53] [config]   - 10
[2023-07-21 15:16:53] [config]   - 1
[2023-07-21 15:16:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 15:16:53] [config] lr-report: false
[2023-07-21 15:16:53] [config] lr-warmup: 0
[2023-07-21 15:16:53] [config] lr-warmup-at-reload: false
[2023-07-21 15:16:53] [config] lr-warmup-cycle: false
[2023-07-21 15:16:53] [config] lr-warmup-start-rate: 0
[2023-07-21 15:16:53] [config] max-length: 150
[2023-07-21 15:16:53] [config] max-length-crop: true
[2023-07-21 15:16:53] [config] max-length-factor: 3
[2023-07-21 15:16:53] [config] maxi-batch: 100
[2023-07-21 15:16:53] [config] maxi-batch-sort: trg
[2023-07-21 15:16:53] [config] mini-batch: 64
[2023-07-21 15:16:53] [config] mini-batch-fit: true
[2023-07-21 15:16:53] [config] mini-batch-fit-step: 10
[2023-07-21 15:16:53] [config] mini-batch-round-up: true
[2023-07-21 15:16:53] [config] mini-batch-track-lr: false
[2023-07-21 15:16:53] [config] mini-batch-warmup: 0
[2023-07-21 15:16:53] [config] mini-batch-words: 0
[2023-07-21 15:16:53] [config] mini-batch-words-ref: 0
[2023-07-21 15:16:53] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 15:16:53] [config] multi-loss-type: sum
[2023-07-21 15:16:53] [config] n-best: false
[2023-07-21 15:16:53] [config] no-nccl: false
[2023-07-21 15:16:53] [config] no-reload: false
[2023-07-21 15:16:53] [config] no-restore-corpus: false
[2023-07-21 15:16:53] [config] normalize: 0
[2023-07-21 15:16:53] [config] normalize-gradient: false
[2023-07-21 15:16:53] [config] num-devices: 0
[2023-07-21 15:16:53] [config] optimizer: adam
[2023-07-21 15:16:53] [config] optimizer-delay: 1
[2023-07-21 15:16:53] [config] optimizer-params:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] output-omit-bias: false
[2023-07-21 15:16:53] [config] overwrite: true
[2023-07-21 15:16:53] [config] precision:
[2023-07-21 15:16:53] [config]   - float16
[2023-07-21 15:16:53] [config]   - float32
[2023-07-21 15:16:53] [config] pretrained-model: ""
[2023-07-21 15:16:53] [config] quantize-biases: false
[2023-07-21 15:16:53] [config] quantize-bits: 0
[2023-07-21 15:16:53] [config] quantize-log-based: false
[2023-07-21 15:16:53] [config] quantize-optimization-steps: 0
[2023-07-21 15:16:53] [config] quiet: false
[2023-07-21 15:16:53] [config] quiet-translation: true
[2023-07-21 15:16:53] [config] relative-paths: false
[2023-07-21 15:16:53] [config] right-left: false
[2023-07-21 15:16:53] [config] save-freq: 10000u
[2023-07-21 15:16:53] [config] seed: 1234
[2023-07-21 15:16:53] [config] sentencepiece-alphas:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] sentencepiece-max-lines: 2000000
[2023-07-21 15:16:53] [config] sentencepiece-options: ""
[2023-07-21 15:16:53] [config] sharding: global
[2023-07-21 15:16:53] [config] shuffle: data
[2023-07-21 15:16:53] [config] shuffle-in-ram: false
[2023-07-21 15:16:53] [config] sigterm: save-and-exit
[2023-07-21 15:16:53] [config] skip: false
[2023-07-21 15:16:53] [config] sqlite: ""
[2023-07-21 15:16:53] [config] sqlite-drop: false
[2023-07-21 15:16:53] [config] sync-freq: 200u
[2023-07-21 15:16:53] [config] sync-sgd: false
[2023-07-21 15:16:53] [config] tempdir: /tmp
[2023-07-21 15:16:53] [config] tied-embeddings: false
[2023-07-21 15:16:53] [config] tied-embeddings-all: true
[2023-07-21 15:16:53] [config] tied-embeddings-src: false
[2023-07-21 15:16:53] [config] train-embedder-rank:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] train-sets:
[2023-07-21 15:16:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 15:16:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 15:16:53] [config] transformer-aan-activation: swish
[2023-07-21 15:16:53] [config] transformer-aan-depth: 2
[2023-07-21 15:16:53] [config] transformer-aan-nogate: false
[2023-07-21 15:16:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 15:16:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 15:16:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 15:16:53] [config] transformer-depth-scaling: false
[2023-07-21 15:16:53] [config] transformer-dim-aan: 2048
[2023-07-21 15:16:53] [config] transformer-dim-ffn: 2048
[2023-07-21 15:16:53] [config] transformer-dropout: 0
[2023-07-21 15:16:53] [config] transformer-dropout-attention: 0
[2023-07-21 15:16:53] [config] transformer-dropout-ffn: 0
[2023-07-21 15:16:53] [config] transformer-ffn-activation: swish
[2023-07-21 15:16:53] [config] transformer-ffn-depth: 2
[2023-07-21 15:16:53] [config] transformer-guided-alignment-layer: last
[2023-07-21 15:16:53] [config] transformer-heads: 8
[2023-07-21 15:16:53] [config] transformer-no-projection: false
[2023-07-21 15:16:53] [config] transformer-pool: false
[2023-07-21 15:16:53] [config] transformer-postprocess: dan
[2023-07-21 15:16:53] [config] transformer-postprocess-emb: d
[2023-07-21 15:16:53] [config] transformer-postprocess-top: ""
[2023-07-21 15:16:53] [config] transformer-preprocess: ""
[2023-07-21 15:16:53] [config] transformer-tied-layers:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] transformer-train-position-embeddings: false
[2023-07-21 15:16:53] [config] tsv: false
[2023-07-21 15:16:53] [config] tsv-fields: 0
[2023-07-21 15:16:53] [config] type: amun
[2023-07-21 15:16:53] [config] ulr: false
[2023-07-21 15:16:53] [config] ulr-dim-emb: 0
[2023-07-21 15:16:53] [config] ulr-dropout: 0
[2023-07-21 15:16:53] [config] ulr-keys-vectors: ""
[2023-07-21 15:16:53] [config] ulr-query-vectors: ""
[2023-07-21 15:16:53] [config] ulr-softmax-temperature: 1
[2023-07-21 15:16:53] [config] ulr-trainable-transformation: false
[2023-07-21 15:16:53] [config] unlikelihood-loss: false
[2023-07-21 15:16:53] [config] valid-freq: 50000000
[2023-07-21 15:16:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 15:16:53] [config] valid-max-length: 1000
[2023-07-21 15:16:53] [config] valid-metrics:
[2023-07-21 15:16:53] [config]   - cross-entropy
[2023-07-21 15:16:53] [config]   - translation
[2023-07-21 15:16:53] [config] valid-mini-batch: 32
[2023-07-21 15:16:53] [config] valid-reset-stalled: false
[2023-07-21 15:16:53] [config] valid-script-args:
[2023-07-21 15:16:53] [config]   []
[2023-07-21 15:16:53] [config] valid-script-path: ""
[2023-07-21 15:16:53] [config] valid-sets:
[2023-07-21 15:16:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 15:16:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 15:16:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 15:16:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 15:16:53] [config] vocabs:
[2023-07-21 15:16:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 15:16:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 15:16:53] [config] word-penalty: 0
[2023-07-21 15:16:53] [config] word-scores: false
[2023-07-21 15:16:53] [config] workspace: 5500
[2023-07-21 15:16:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 15:16:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 15:16:53] [training] Using single-device training
[2023-07-21 15:16:54] Synced seed 1234
[2023-07-21 15:16:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 15:16:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 15:16:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 15:16:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 15:16:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 15:16:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 15:16:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 15:16:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 15:16:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 15:16:56] [comm] Using global sharding
[2023-07-21 15:16:56] [comm] NCCLCommunicators constructed successfully
[2023-07-21 15:16:56] [training] Using 1 GPUs
[2023-07-21 15:16:56] [logits] Applying loss function for 1 factor(s)
[2023-07-21 15:16:56] [memory] Reserving 80 MB, device gpu0
[2023-07-21 15:16:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 15:16:56] [memory] Reserving 80 MB, device gpu0
[2023-07-21 15:47:52] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 15:47:52] [valid] No post-processing script given for validating translator
[2023-07-21 15:47:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 15:47:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 15:47:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 15:47:52] [comm] Using global sharding
[2023-07-21 15:47:52] [comm] NCCLCommunicators constructed successfully
[2023-07-21 15:47:52] [training] Using 1 GPUs
[2023-07-21 15:47:52] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 15:47:59] Allocating memory for general optimizer shards
[2023-07-21 15:47:59] [memory] Reserving 322 MB, device gpu0
[2023-07-21 15:47:59] Loading Adam parameters
[2023-07-21 15:47:59] [memory] Reserving 322 MB, device gpu0
[2023-07-21 15:47:59] [memory] Reserving 80 MB, device gpu0
[2023-07-21 15:48:00] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 15:48:00] [data] Restoring the corpus state to epoch 161, batch 6095
[2023-07-21 15:48:00] [data] Shuffling data
[2023-07-21 15:48:00] [data] Done reading 20,192 sentences
[2023-07-21 15:48:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:48:00] Training started
[2023-07-21 15:48:00] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 15:48:00] [memory] Reserving 80 MB, device gpu0
[2023-07-21 15:48:01] Parameter type float16, optimization type float32, casting types true
[2023-07-21 15:52:06] Seen 20,192 samples
[2023-07-21 15:52:06] Starting data epoch 162 in logical epoch 162
[2023-07-21 15:52:06] [data] Shuffling data
[2023-07-21 15:52:06] [data] Done reading 20,192 sentences
[2023-07-21 15:52:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:56:44] Seen 20,192 samples
[2023-07-21 15:56:44] Starting data epoch 163 in logical epoch 163
[2023-07-21 15:56:44] [data] Shuffling data
[2023-07-21 15:56:44] [data] Done reading 20,192 sentences
[2023-07-21 15:56:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:01:24] Seen 20,192 samples
[2023-07-21 16:01:24] Starting data epoch 164 in logical epoch 164
[2023-07-21 16:01:24] [data] Shuffling data
[2023-07-21 16:01:24] [data] Done reading 20,192 sentences
[2023-07-21 16:01:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:06:07] Seen 20,192 samples
[2023-07-21 16:06:07] Starting data epoch 165 in logical epoch 165
[2023-07-21 16:06:07] [data] Shuffling data
[2023-07-21 16:06:07] [data] Done reading 20,192 sentences
[2023-07-21 16:06:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:11:01] Seen 20,192 samples
[2023-07-21 16:11:01] Starting data epoch 166 in logical epoch 166
[2023-07-21 16:11:01] [data] Shuffling data
[2023-07-21 16:11:01] [data] Done reading 20,192 sentences
[2023-07-21 16:11:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:15:55] Seen 20,192 samples
[2023-07-21 16:15:55] Starting data epoch 167 in logical epoch 167
[2023-07-21 16:15:55] [data] Shuffling data
[2023-07-21 16:15:55] [data] Done reading 20,192 sentences
[2023-07-21 16:15:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:20:48] Seen 20,192 samples
[2023-07-21 16:20:48] Starting data epoch 168 in logical epoch 168
[2023-07-21 16:20:48] [data] Shuffling data
[2023-07-21 16:20:48] [data] Done reading 20,192 sentences
[2023-07-21 16:20:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:25:41] Seen 20,192 samples
[2023-07-21 16:25:41] Starting data epoch 169 in logical epoch 169
[2023-07-21 16:25:41] [data] Shuffling data
[2023-07-21 16:25:41] [data] Done reading 20,192 sentences
[2023-07-21 16:25:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:30:29] Seen 20,192 samples
[2023-07-21 16:30:29] Starting data epoch 170 in logical epoch 170
[2023-07-21 16:30:29] [data] Shuffling data
[2023-07-21 16:30:29] [data] Done reading 20,192 sentences
[2023-07-21 16:30:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:35:28] Seen 20,192 samples
[2023-07-21 16:35:28] Starting data epoch 171 in logical epoch 171
[2023-07-21 16:35:28] Training finished
[2023-07-21 16:35:43] [valid] Ep. 171 : Up. 6478 : cross-entropy : 124.618 : stalled 1 times (last best: 123.779)
[2023-07-21 16:37:56] [valid] Ep. 171 : Up. 6478 : translation : 0 : new best
[2023-07-21 16:37:56] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 16:37:58] Saving Adam parameters
[2023-07-21 16:37:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 16:38:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 16:38:07] [marian] Running on node23.datos.cluster.uy as process 2793 with command line:
[2023-07-21 16:38:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 150
[2023-07-21 16:38:07] [config] after: 0e
[2023-07-21 16:38:07] [config] after-batches: 0
[2023-07-21 16:38:07] [config] after-epochs: 180
[2023-07-21 16:38:07] [config] all-caps-every: 0
[2023-07-21 16:38:07] [config] allow-unk: false
[2023-07-21 16:38:07] [config] authors: false
[2023-07-21 16:38:07] [config] beam-size: 12
[2023-07-21 16:38:07] [config] bert-class-symbol: "[CLS]"
[2023-07-21 16:38:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 16:38:07] [config] bert-masking-fraction: 0.15
[2023-07-21 16:38:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 16:38:07] [config] bert-train-type-embeddings: true
[2023-07-21 16:38:07] [config] bert-type-vocab-size: 2
[2023-07-21 16:38:07] [config] build-info: ""
[2023-07-21 16:38:07] [config] check-gradient-nan: false
[2023-07-21 16:38:07] [config] check-nan: false
[2023-07-21 16:38:07] [config] cite: false
[2023-07-21 16:38:07] [config] clip-norm: 1
[2023-07-21 16:38:07] [config] cost-scaling:
[2023-07-21 16:38:07] [config]   - 256.f
[2023-07-21 16:38:07] [config]   - 1000
[2023-07-21 16:38:07] [config]   - 2.f
[2023-07-21 16:38:07] [config]   - 256.f
[2023-07-21 16:38:07] [config] cost-type: ce-sum
[2023-07-21 16:38:07] [config] cpu-threads: 0
[2023-07-21 16:38:07] [config] data-threads: 8
[2023-07-21 16:38:07] [config] data-weighting: ""
[2023-07-21 16:38:07] [config] data-weighting-type: sentence
[2023-07-21 16:38:07] [config] dec-cell: gru
[2023-07-21 16:38:07] [config] dec-cell-base-depth: 2
[2023-07-21 16:38:07] [config] dec-cell-high-depth: 1
[2023-07-21 16:38:07] [config] dec-depth: 1
[2023-07-21 16:38:07] [config] devices:
[2023-07-21 16:38:07] [config]   - 0
[2023-07-21 16:38:07] [config] dim-emb: 512
[2023-07-21 16:38:07] [config] dim-rnn: 1024
[2023-07-21 16:38:07] [config] dim-vocabs:
[2023-07-21 16:38:07] [config]   - 16384
[2023-07-21 16:38:07] [config]   - 16384
[2023-07-21 16:38:07] [config] disp-first: 0
[2023-07-21 16:38:07] [config] disp-freq: 1000u
[2023-07-21 16:38:07] [config] disp-label-counts: true
[2023-07-21 16:38:07] [config] dropout-rnn: 0
[2023-07-21 16:38:07] [config] dropout-src: 0
[2023-07-21 16:38:07] [config] dropout-trg: 0
[2023-07-21 16:38:07] [config] dump-config: ""
[2023-07-21 16:38:07] [config] dynamic-gradient-scaling:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] early-stopping: 200
[2023-07-21 16:38:07] [config] early-stopping-on: first
[2023-07-21 16:38:07] [config] embedding-fix-src: false
[2023-07-21 16:38:07] [config] embedding-fix-trg: false
[2023-07-21 16:38:07] [config] embedding-normalization: false
[2023-07-21 16:38:07] [config] embedding-vectors:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] enc-cell: gru
[2023-07-21 16:38:07] [config] enc-cell-depth: 1
[2023-07-21 16:38:07] [config] enc-depth: 1
[2023-07-21 16:38:07] [config] enc-type: bidirectional
[2023-07-21 16:38:07] [config] english-title-case-every: 0
[2023-07-21 16:38:07] [config] exponential-smoothing: 0
[2023-07-21 16:38:07] [config] factor-weight: 1
[2023-07-21 16:38:07] [config] factors-combine: sum
[2023-07-21 16:38:07] [config] factors-dim-emb: 0
[2023-07-21 16:38:07] [config] gradient-checkpointing: false
[2023-07-21 16:38:07] [config] gradient-norm-average-window: 100
[2023-07-21 16:38:07] [config] guided-alignment: none
[2023-07-21 16:38:07] [config] guided-alignment-cost: mse
[2023-07-21 16:38:07] [config] guided-alignment-weight: 0.1
[2023-07-21 16:38:07] [config] ignore-model-config: false
[2023-07-21 16:38:07] [config] input-types:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] interpolate-env-vars: false
[2023-07-21 16:38:07] [config] keep-best: false
[2023-07-21 16:38:07] [config] label-smoothing: 0
[2023-07-21 16:38:07] [config] layer-normalization: false
[2023-07-21 16:38:07] [config] learn-rate: 0.0001
[2023-07-21 16:38:07] [config] lemma-dependency: ""
[2023-07-21 16:38:07] [config] lemma-dim-emb: 0
[2023-07-21 16:38:07] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 16:38:07] [config] log-level: info
[2023-07-21 16:38:07] [config] log-time-zone: ""
[2023-07-21 16:38:07] [config] logical-epoch:
[2023-07-21 16:38:07] [config]   - 1e
[2023-07-21 16:38:07] [config]   - 0
[2023-07-21 16:38:07] [config] lr-decay: 0
[2023-07-21 16:38:07] [config] lr-decay-freq: 50000
[2023-07-21 16:38:07] [config] lr-decay-inv-sqrt:
[2023-07-21 16:38:07] [config]   - 0
[2023-07-21 16:38:07] [config] lr-decay-repeat-warmup: false
[2023-07-21 16:38:07] [config] lr-decay-reset-optimizer: false
[2023-07-21 16:38:07] [config] lr-decay-start:
[2023-07-21 16:38:07] [config]   - 10
[2023-07-21 16:38:07] [config]   - 1
[2023-07-21 16:38:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 16:38:07] [config] lr-report: false
[2023-07-21 16:38:07] [config] lr-warmup: 0
[2023-07-21 16:38:07] [config] lr-warmup-at-reload: false
[2023-07-21 16:38:07] [config] lr-warmup-cycle: false
[2023-07-21 16:38:07] [config] lr-warmup-start-rate: 0
[2023-07-21 16:38:07] [config] max-length: 150
[2023-07-21 16:38:07] [config] max-length-crop: true
[2023-07-21 16:38:07] [config] max-length-factor: 3
[2023-07-21 16:38:07] [config] maxi-batch: 100
[2023-07-21 16:38:07] [config] maxi-batch-sort: trg
[2023-07-21 16:38:07] [config] mini-batch: 64
[2023-07-21 16:38:07] [config] mini-batch-fit: true
[2023-07-21 16:38:07] [config] mini-batch-fit-step: 10
[2023-07-21 16:38:07] [config] mini-batch-round-up: true
[2023-07-21 16:38:07] [config] mini-batch-track-lr: false
[2023-07-21 16:38:07] [config] mini-batch-warmup: 0
[2023-07-21 16:38:07] [config] mini-batch-words: 0
[2023-07-21 16:38:07] [config] mini-batch-words-ref: 0
[2023-07-21 16:38:07] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 16:38:07] [config] multi-loss-type: sum
[2023-07-21 16:38:07] [config] n-best: false
[2023-07-21 16:38:07] [config] no-nccl: false
[2023-07-21 16:38:07] [config] no-reload: false
[2023-07-21 16:38:07] [config] no-restore-corpus: false
[2023-07-21 16:38:07] [config] normalize: 0
[2023-07-21 16:38:07] [config] normalize-gradient: false
[2023-07-21 16:38:07] [config] num-devices: 0
[2023-07-21 16:38:07] [config] optimizer: adam
[2023-07-21 16:38:07] [config] optimizer-delay: 1
[2023-07-21 16:38:07] [config] optimizer-params:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] output-omit-bias: false
[2023-07-21 16:38:07] [config] overwrite: true
[2023-07-21 16:38:07] [config] precision:
[2023-07-21 16:38:07] [config]   - float16
[2023-07-21 16:38:07] [config]   - float32
[2023-07-21 16:38:07] [config] pretrained-model: ""
[2023-07-21 16:38:07] [config] quantize-biases: false
[2023-07-21 16:38:07] [config] quantize-bits: 0
[2023-07-21 16:38:07] [config] quantize-log-based: false
[2023-07-21 16:38:07] [config] quantize-optimization-steps: 0
[2023-07-21 16:38:07] [config] quiet: false
[2023-07-21 16:38:07] [config] quiet-translation: true
[2023-07-21 16:38:07] [config] relative-paths: false
[2023-07-21 16:38:07] [config] right-left: false
[2023-07-21 16:38:07] [config] save-freq: 10000u
[2023-07-21 16:38:07] [config] seed: 1234
[2023-07-21 16:38:07] [config] sentencepiece-alphas:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] sentencepiece-max-lines: 2000000
[2023-07-21 16:38:07] [config] sentencepiece-options: ""
[2023-07-21 16:38:07] [config] sharding: global
[2023-07-21 16:38:07] [config] shuffle: data
[2023-07-21 16:38:07] [config] shuffle-in-ram: false
[2023-07-21 16:38:07] [config] sigterm: save-and-exit
[2023-07-21 16:38:07] [config] skip: false
[2023-07-21 16:38:07] [config] sqlite: ""
[2023-07-21 16:38:07] [config] sqlite-drop: false
[2023-07-21 16:38:07] [config] sync-freq: 200u
[2023-07-21 16:38:07] [config] sync-sgd: false
[2023-07-21 16:38:07] [config] tempdir: /tmp
[2023-07-21 16:38:07] [config] tied-embeddings: false
[2023-07-21 16:38:07] [config] tied-embeddings-all: true
[2023-07-21 16:38:07] [config] tied-embeddings-src: false
[2023-07-21 16:38:07] [config] train-embedder-rank:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] train-sets:
[2023-07-21 16:38:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 16:38:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 16:38:07] [config] transformer-aan-activation: swish
[2023-07-21 16:38:07] [config] transformer-aan-depth: 2
[2023-07-21 16:38:07] [config] transformer-aan-nogate: false
[2023-07-21 16:38:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 16:38:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 16:38:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 16:38:07] [config] transformer-depth-scaling: false
[2023-07-21 16:38:07] [config] transformer-dim-aan: 2048
[2023-07-21 16:38:07] [config] transformer-dim-ffn: 2048
[2023-07-21 16:38:07] [config] transformer-dropout: 0
[2023-07-21 16:38:07] [config] transformer-dropout-attention: 0
[2023-07-21 16:38:07] [config] transformer-dropout-ffn: 0
[2023-07-21 16:38:07] [config] transformer-ffn-activation: swish
[2023-07-21 16:38:07] [config] transformer-ffn-depth: 2
[2023-07-21 16:38:07] [config] transformer-guided-alignment-layer: last
[2023-07-21 16:38:07] [config] transformer-heads: 8
[2023-07-21 16:38:07] [config] transformer-no-projection: false
[2023-07-21 16:38:07] [config] transformer-pool: false
[2023-07-21 16:38:07] [config] transformer-postprocess: dan
[2023-07-21 16:38:07] [config] transformer-postprocess-emb: d
[2023-07-21 16:38:07] [config] transformer-postprocess-top: ""
[2023-07-21 16:38:07] [config] transformer-preprocess: ""
[2023-07-21 16:38:07] [config] transformer-tied-layers:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] transformer-train-position-embeddings: false
[2023-07-21 16:38:07] [config] tsv: false
[2023-07-21 16:38:07] [config] tsv-fields: 0
[2023-07-21 16:38:07] [config] type: amun
[2023-07-21 16:38:07] [config] ulr: false
[2023-07-21 16:38:07] [config] ulr-dim-emb: 0
[2023-07-21 16:38:07] [config] ulr-dropout: 0
[2023-07-21 16:38:07] [config] ulr-keys-vectors: ""
[2023-07-21 16:38:07] [config] ulr-query-vectors: ""
[2023-07-21 16:38:07] [config] ulr-softmax-temperature: 1
[2023-07-21 16:38:07] [config] ulr-trainable-transformation: false
[2023-07-21 16:38:07] [config] unlikelihood-loss: false
[2023-07-21 16:38:07] [config] valid-freq: 50000000
[2023-07-21 16:38:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node23.log
[2023-07-21 16:38:07] [config] valid-max-length: 1000
[2023-07-21 16:38:07] [config] valid-metrics:
[2023-07-21 16:38:07] [config]   - cross-entropy
[2023-07-21 16:38:07] [config]   - translation
[2023-07-21 16:38:07] [config] valid-mini-batch: 32
[2023-07-21 16:38:07] [config] valid-reset-stalled: false
[2023-07-21 16:38:07] [config] valid-script-args:
[2023-07-21 16:38:07] [config]   []
[2023-07-21 16:38:07] [config] valid-script-path: ""
[2023-07-21 16:38:07] [config] valid-sets:
[2023-07-21 16:38:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 16:38:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 16:38:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 16:38:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 16:38:07] [config] vocabs:
[2023-07-21 16:38:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 16:38:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 16:38:07] [config] word-penalty: 0
[2023-07-21 16:38:07] [config] word-scores: false
[2023-07-21 16:38:07] [config] workspace: 5500
[2023-07-21 16:38:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 16:38:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 16:38:07] [training] Using single-device training
[2023-07-21 16:38:08] Synced seed 1234
[2023-07-21 16:38:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 16:38:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 16:38:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 16:38:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 16:38:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 16:38:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 16:38:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 16:38:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 16:38:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 16:38:09] [comm] Using global sharding
[2023-07-21 16:38:09] [comm] NCCLCommunicators constructed successfully
[2023-07-21 16:38:09] [training] Using 1 GPUs
[2023-07-21 16:38:09] [logits] Applying loss function for 1 factor(s)
[2023-07-21 16:38:09] [memory] Reserving 80 MB, device gpu0
[2023-07-21 16:38:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 16:38:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:09:22] [batching] Done. Typical MB size is 35,978 target words
[2023-07-21 17:09:23] [valid] No post-processing script given for validating translator
[2023-07-21 17:09:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:09:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 17:09:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 17:09:23] [comm] Using global sharding
[2023-07-21 17:09:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 17:09:23] [training] Using 1 GPUs
[2023-07-21 17:09:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz
[2023-07-21 17:09:30] Allocating memory for general optimizer shards
[2023-07-21 17:09:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 17:09:30] Loading Adam parameters
[2023-07-21 17:09:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 17:09:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:09:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node23/gn_es_test_grid_lvl2_july_node23_max-length_150.npz.optimizer.npz
[2023-07-21 17:09:30] [data] Restoring the corpus state to epoch 171, batch 6478
[2023-07-21 17:09:30] [data] Shuffling data
[2023-07-21 17:09:30] [data] Done reading 20,192 sentences
[2023-07-21 17:09:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:09:30] Training started
[2023-07-21 17:09:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 17:09:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:09:38] Parameter type float16, optimization type float32, casting types true
[2023-07-21 17:13:41] Seen 20,192 samples
[2023-07-21 17:13:41] Starting data epoch 172 in logical epoch 172
[2023-07-21 17:13:41] [data] Shuffling data
[2023-07-21 17:13:41] [data] Done reading 20,192 sentences
[2023-07-21 17:13:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:18:19] Seen 20,192 samples
[2023-07-21 17:18:19] Starting data epoch 173 in logical epoch 173
[2023-07-21 17:18:19] [data] Shuffling data
[2023-07-21 17:18:19] [data] Done reading 20,192 sentences
[2023-07-21 17:18:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:23:03] Seen 20,192 samples
[2023-07-21 17:23:03] Starting data epoch 174 in logical epoch 174
[2023-07-21 17:23:03] [data] Shuffling data
[2023-07-21 17:23:03] [data] Done reading 20,192 sentences
[2023-07-21 17:23:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:27:52] Seen 20,192 samples
[2023-07-21 17:27:52] Starting data epoch 175 in logical epoch 175
[2023-07-21 17:27:52] [data] Shuffling data
[2023-07-21 17:27:52] [data] Done reading 20,192 sentences
[2023-07-21 17:27:52] [data] Done shuffling 20,192 sentences to temp files
