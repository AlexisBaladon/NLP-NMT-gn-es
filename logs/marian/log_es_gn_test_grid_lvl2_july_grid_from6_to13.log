[2023-07-21 17:48:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:48:24] [marian] Running on node23.datos.cluster.uy as process 7346 with command line:
[2023-07-21 17:48:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 17:48:24] [config] after: 0e
[2023-07-21 17:48:24] [config] after-batches: 0
[2023-07-21 17:48:24] [config] after-epochs: 10
[2023-07-21 17:48:24] [config] all-caps-every: 0
[2023-07-21 17:48:24] [config] allow-unk: false
[2023-07-21 17:48:24] [config] authors: false
[2023-07-21 17:48:24] [config] beam-size: 12
[2023-07-21 17:48:24] [config] bert-class-symbol: "[CLS]"
[2023-07-21 17:48:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 17:48:24] [config] bert-masking-fraction: 0.15
[2023-07-21 17:48:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 17:48:24] [config] bert-train-type-embeddings: true
[2023-07-21 17:48:24] [config] bert-type-vocab-size: 2
[2023-07-21 17:48:24] [config] build-info: ""
[2023-07-21 17:48:24] [config] check-gradient-nan: false
[2023-07-21 17:48:24] [config] check-nan: false
[2023-07-21 17:48:24] [config] cite: false
[2023-07-21 17:48:24] [config] clip-norm: 1
[2023-07-21 17:48:24] [config] cost-scaling:
[2023-07-21 17:48:24] [config]   - 256.f
[2023-07-21 17:48:24] [config]   - 1000
[2023-07-21 17:48:24] [config]   - 2.f
[2023-07-21 17:48:24] [config]   - 256.f
[2023-07-21 17:48:24] [config] cost-type: ce-sum
[2023-07-21 17:48:24] [config] cpu-threads: 0
[2023-07-21 17:48:24] [config] data-threads: 8
[2023-07-21 17:48:24] [config] data-weighting: ""
[2023-07-21 17:48:24] [config] data-weighting-type: sentence
[2023-07-21 17:48:24] [config] dec-cell: gru
[2023-07-21 17:48:24] [config] dec-cell-base-depth: 2
[2023-07-21 17:48:24] [config] dec-cell-high-depth: 1
[2023-07-21 17:48:24] [config] dec-depth: 1
[2023-07-21 17:48:24] [config] devices:
[2023-07-21 17:48:24] [config]   - 0
[2023-07-21 17:48:24] [config] dim-emb: 512
[2023-07-21 17:48:24] [config] dim-rnn: 1024
[2023-07-21 17:48:24] [config] dim-vocabs:
[2023-07-21 17:48:24] [config]   - 16384
[2023-07-21 17:48:24] [config]   - 16384
[2023-07-21 17:48:24] [config] disp-first: 0
[2023-07-21 17:48:24] [config] disp-freq: 1000u
[2023-07-21 17:48:24] [config] disp-label-counts: true
[2023-07-21 17:48:24] [config] dropout-rnn: 0.5
[2023-07-21 17:48:24] [config] dropout-src: 0
[2023-07-21 17:48:24] [config] dropout-trg: 0
[2023-07-21 17:48:24] [config] dump-config: ""
[2023-07-21 17:48:24] [config] dynamic-gradient-scaling:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] early-stopping: 200
[2023-07-21 17:48:24] [config] early-stopping-on: first
[2023-07-21 17:48:24] [config] embedding-fix-src: false
[2023-07-21 17:48:24] [config] embedding-fix-trg: false
[2023-07-21 17:48:24] [config] embedding-normalization: false
[2023-07-21 17:48:24] [config] embedding-vectors:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] enc-cell: gru
[2023-07-21 17:48:24] [config] enc-cell-depth: 1
[2023-07-21 17:48:24] [config] enc-depth: 1
[2023-07-21 17:48:24] [config] enc-type: bidirectional
[2023-07-21 17:48:24] [config] english-title-case-every: 0
[2023-07-21 17:48:24] [config] exponential-smoothing: 0
[2023-07-21 17:48:24] [config] factor-weight: 1
[2023-07-21 17:48:24] [config] factors-combine: sum
[2023-07-21 17:48:24] [config] factors-dim-emb: 0
[2023-07-21 17:48:24] [config] gradient-checkpointing: false
[2023-07-21 17:48:24] [config] gradient-norm-average-window: 100
[2023-07-21 17:48:24] [config] guided-alignment: none
[2023-07-21 17:48:24] [config] guided-alignment-cost: mse
[2023-07-21 17:48:24] [config] guided-alignment-weight: 0.1
[2023-07-21 17:48:24] [config] ignore-model-config: false
[2023-07-21 17:48:24] [config] input-types:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] interpolate-env-vars: false
[2023-07-21 17:48:24] [config] keep-best: false
[2023-07-21 17:48:24] [config] label-smoothing: 0
[2023-07-21 17:48:24] [config] layer-normalization: false
[2023-07-21 17:48:24] [config] learn-rate: 0.0001
[2023-07-21 17:48:24] [config] lemma-dependency: ""
[2023-07-21 17:48:24] [config] lemma-dim-emb: 0
[2023-07-21 17:48:24] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 17:48:24] [config] log-level: info
[2023-07-21 17:48:24] [config] log-time-zone: ""
[2023-07-21 17:48:24] [config] logical-epoch:
[2023-07-21 17:48:24] [config]   - 1e
[2023-07-21 17:48:24] [config]   - 0
[2023-07-21 17:48:24] [config] lr-decay: 0
[2023-07-21 17:48:24] [config] lr-decay-freq: 50000
[2023-07-21 17:48:24] [config] lr-decay-inv-sqrt:
[2023-07-21 17:48:24] [config]   - 0
[2023-07-21 17:48:24] [config] lr-decay-repeat-warmup: false
[2023-07-21 17:48:24] [config] lr-decay-reset-optimizer: false
[2023-07-21 17:48:24] [config] lr-decay-start:
[2023-07-21 17:48:24] [config]   - 10
[2023-07-21 17:48:24] [config]   - 1
[2023-07-21 17:48:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 17:48:24] [config] lr-report: false
[2023-07-21 17:48:24] [config] lr-warmup: 0
[2023-07-21 17:48:24] [config] lr-warmup-at-reload: false
[2023-07-21 17:48:24] [config] lr-warmup-cycle: false
[2023-07-21 17:48:24] [config] lr-warmup-start-rate: 0
[2023-07-21 17:48:24] [config] max-length: 50
[2023-07-21 17:48:24] [config] max-length-crop: true
[2023-07-21 17:48:24] [config] max-length-factor: 3
[2023-07-21 17:48:24] [config] maxi-batch: 100
[2023-07-21 17:48:24] [config] maxi-batch-sort: trg
[2023-07-21 17:48:24] [config] mini-batch: 64
[2023-07-21 17:48:24] [config] mini-batch-fit: true
[2023-07-21 17:48:24] [config] mini-batch-fit-step: 10
[2023-07-21 17:48:24] [config] mini-batch-round-up: true
[2023-07-21 17:48:24] [config] mini-batch-track-lr: false
[2023-07-21 17:48:24] [config] mini-batch-warmup: 0
[2023-07-21 17:48:24] [config] mini-batch-words: 0
[2023-07-21 17:48:24] [config] mini-batch-words-ref: 0
[2023-07-21 17:48:24] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 17:48:24] [config] multi-loss-type: sum
[2023-07-21 17:48:24] [config] n-best: false
[2023-07-21 17:48:24] [config] no-nccl: false
[2023-07-21 17:48:24] [config] no-reload: false
[2023-07-21 17:48:24] [config] no-restore-corpus: false
[2023-07-21 17:48:24] [config] normalize: 0
[2023-07-21 17:48:24] [config] normalize-gradient: false
[2023-07-21 17:48:24] [config] num-devices: 0
[2023-07-21 17:48:24] [config] optimizer: adam
[2023-07-21 17:48:24] [config] optimizer-delay: 1
[2023-07-21 17:48:24] [config] optimizer-params:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] output-omit-bias: false
[2023-07-21 17:48:24] [config] overwrite: true
[2023-07-21 17:48:24] [config] precision:
[2023-07-21 17:48:24] [config]   - float16
[2023-07-21 17:48:24] [config]   - float32
[2023-07-21 17:48:24] [config] pretrained-model: ""
[2023-07-21 17:48:24] [config] quantize-biases: false
[2023-07-21 17:48:24] [config] quantize-bits: 0
[2023-07-21 17:48:24] [config] quantize-log-based: false
[2023-07-21 17:48:24] [config] quantize-optimization-steps: 0
[2023-07-21 17:48:24] [config] quiet: false
[2023-07-21 17:48:24] [config] quiet-translation: true
[2023-07-21 17:48:24] [config] relative-paths: false
[2023-07-21 17:48:24] [config] right-left: false
[2023-07-21 17:48:24] [config] save-freq: 10000u
[2023-07-21 17:48:24] [config] seed: 1234
[2023-07-21 17:48:24] [config] sentencepiece-alphas:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] sentencepiece-max-lines: 2000000
[2023-07-21 17:48:24] [config] sentencepiece-options: ""
[2023-07-21 17:48:24] [config] sharding: global
[2023-07-21 17:48:24] [config] shuffle: data
[2023-07-21 17:48:24] [config] shuffle-in-ram: false
[2023-07-21 17:48:24] [config] sigterm: save-and-exit
[2023-07-21 17:48:24] [config] skip: false
[2023-07-21 17:48:24] [config] sqlite: ""
[2023-07-21 17:48:24] [config] sqlite-drop: false
[2023-07-21 17:48:24] [config] sync-freq: 200u
[2023-07-21 17:48:24] [config] sync-sgd: false
[2023-07-21 17:48:24] [config] tempdir: /tmp
[2023-07-21 17:48:24] [config] tied-embeddings: false
[2023-07-21 17:48:24] [config] tied-embeddings-all: true
[2023-07-21 17:48:24] [config] tied-embeddings-src: false
[2023-07-21 17:48:24] [config] train-embedder-rank:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] train-sets:
[2023-07-21 17:48:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 17:48:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 17:48:24] [config] transformer-aan-activation: swish
[2023-07-21 17:48:24] [config] transformer-aan-depth: 2
[2023-07-21 17:48:24] [config] transformer-aan-nogate: false
[2023-07-21 17:48:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 17:48:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 17:48:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 17:48:24] [config] transformer-depth-scaling: false
[2023-07-21 17:48:24] [config] transformer-dim-aan: 2048
[2023-07-21 17:48:24] [config] transformer-dim-ffn: 2048
[2023-07-21 17:48:24] [config] transformer-dropout: 0
[2023-07-21 17:48:24] [config] transformer-dropout-attention: 0
[2023-07-21 17:48:24] [config] transformer-dropout-ffn: 0
[2023-07-21 17:48:24] [config] transformer-ffn-activation: swish
[2023-07-21 17:48:24] [config] transformer-ffn-depth: 2
[2023-07-21 17:48:24] [config] transformer-guided-alignment-layer: last
[2023-07-21 17:48:24] [config] transformer-heads: 8
[2023-07-21 17:48:24] [config] transformer-no-projection: false
[2023-07-21 17:48:24] [config] transformer-pool: false
[2023-07-21 17:48:24] [config] transformer-postprocess: dan
[2023-07-21 17:48:24] [config] transformer-postprocess-emb: d
[2023-07-21 17:48:24] [config] transformer-postprocess-top: ""
[2023-07-21 17:48:24] [config] transformer-preprocess: ""
[2023-07-21 17:48:24] [config] transformer-tied-layers:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] transformer-train-position-embeddings: false
[2023-07-21 17:48:24] [config] tsv: false
[2023-07-21 17:48:24] [config] tsv-fields: 0
[2023-07-21 17:48:24] [config] type: amun
[2023-07-21 17:48:24] [config] ulr: false
[2023-07-21 17:48:24] [config] ulr-dim-emb: 0
[2023-07-21 17:48:24] [config] ulr-dropout: 0
[2023-07-21 17:48:24] [config] ulr-keys-vectors: ""
[2023-07-21 17:48:24] [config] ulr-query-vectors: ""
[2023-07-21 17:48:24] [config] ulr-softmax-temperature: 1
[2023-07-21 17:48:24] [config] ulr-trainable-transformation: false
[2023-07-21 17:48:24] [config] unlikelihood-loss: false
[2023-07-21 17:48:24] [config] valid-freq: 50000000
[2023-07-21 17:48:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 17:48:24] [config] valid-max-length: 1000
[2023-07-21 17:48:24] [config] valid-metrics:
[2023-07-21 17:48:24] [config]   - cross-entropy
[2023-07-21 17:48:24] [config]   - translation
[2023-07-21 17:48:24] [config] valid-mini-batch: 32
[2023-07-21 17:48:24] [config] valid-reset-stalled: false
[2023-07-21 17:48:24] [config] valid-script-args:
[2023-07-21 17:48:24] [config]   []
[2023-07-21 17:48:24] [config] valid-script-path: ""
[2023-07-21 17:48:24] [config] valid-sets:
[2023-07-21 17:48:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 17:48:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 17:48:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 17:48:24] [config] vocabs:
[2023-07-21 17:48:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 17:48:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 17:48:24] [config] word-penalty: 0
[2023-07-21 17:48:24] [config] word-scores: false
[2023-07-21 17:48:24] [config] workspace: 5500
[2023-07-21 17:48:24] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:48:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:48:24] [training] Using single-device training
[2023-07-21 17:48:24] Synced seed 1234
[2023-07-21 17:48:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 17:48:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 17:48:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 17:48:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 17:48:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 17:48:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:48:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 17:48:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 17:48:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 17:48:26] [comm] Using global sharding
[2023-07-21 17:48:26] [comm] NCCLCommunicators constructed successfully
[2023-07-21 17:48:26] [training] Using 1 GPUs
[2023-07-21 17:48:26] [logits] Applying loss function for 1 factor(s)
[2023-07-21 17:48:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:48:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 17:48:28] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:52:33] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 17:52:34] [valid] No post-processing script given for validating translator
[2023-07-21 17:52:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:52:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 17:52:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 17:52:34] [comm] Using global sharding
[2023-07-21 17:52:34] [comm] NCCLCommunicators constructed successfully
[2023-07-21 17:52:34] [training] Using 1 GPUs
[2023-07-21 17:52:34] Training started
[2023-07-21 17:52:34] [data] Shuffling data
[2023-07-21 17:52:34] [data] Done reading 20,192 sentences
[2023-07-21 17:52:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:52:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 17:52:34] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:52:34] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:52:38] Parameter type float16, optimization type float32, casting types true
[2023-07-21 17:52:38] Allocating memory for general optimizer shards
[2023-07-21 17:52:38] [memory] Reserving 322 MB, device gpu0
[2023-07-21 17:52:38] Allocating memory for Adam-specific shards
[2023-07-21 17:52:38] [memory] Reserving 322 MB, device gpu0
[2023-07-21 17:54:40] Seen 20,192 samples
[2023-07-21 17:54:40] Starting data epoch 2 in logical epoch 2
[2023-07-21 17:54:40] [data] Shuffling data
[2023-07-21 17:54:40] [data] Done reading 20,192 sentences
[2023-07-21 17:54:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:57:25] Seen 20,192 samples
[2023-07-21 17:57:25] Starting data epoch 3 in logical epoch 3
[2023-07-21 17:57:25] [data] Shuffling data
[2023-07-21 17:57:25] [data] Done reading 20,192 sentences
[2023-07-21 17:57:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:00:22] Seen 20,192 samples
[2023-07-21 18:00:22] Starting data epoch 4 in logical epoch 4
[2023-07-21 18:00:22] [data] Shuffling data
[2023-07-21 18:00:22] [data] Done reading 20,192 sentences
[2023-07-21 18:00:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:03:37] Seen 20,192 samples
[2023-07-21 18:03:37] Starting data epoch 5 in logical epoch 5
[2023-07-21 18:03:37] [data] Shuffling data
[2023-07-21 18:03:37] [data] Done reading 20,192 sentences
[2023-07-21 18:03:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:06:56] Seen 20,192 samples
[2023-07-21 18:06:56] Starting data epoch 6 in logical epoch 6
[2023-07-21 18:06:56] [data] Shuffling data
[2023-07-21 18:06:56] [data] Done reading 20,192 sentences
[2023-07-21 18:06:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:09:53] Seen 20,192 samples
[2023-07-21 18:09:53] Starting data epoch 7 in logical epoch 7
[2023-07-21 18:09:53] [data] Shuffling data
[2023-07-21 18:09:53] [data] Done reading 20,192 sentences
[2023-07-21 18:09:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:12:45] Seen 20,192 samples
[2023-07-21 18:12:45] Starting data epoch 8 in logical epoch 8
[2023-07-21 18:12:45] [data] Shuffling data
[2023-07-21 18:12:45] [data] Done reading 20,192 sentences
[2023-07-21 18:12:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:15:42] Seen 20,192 samples
[2023-07-21 18:15:42] Starting data epoch 9 in logical epoch 9
[2023-07-21 18:15:42] [data] Shuffling data
[2023-07-21 18:15:42] [data] Done reading 20,192 sentences
[2023-07-21 18:15:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:18:43] Seen 20,192 samples
[2023-07-21 18:18:43] Starting data epoch 10 in logical epoch 10
[2023-07-21 18:18:43] [data] Shuffling data
[2023-07-21 18:18:43] [data] Done reading 20,192 sentences
[2023-07-21 18:18:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:21:51] Seen 20,192 samples
[2023-07-21 18:21:51] Starting data epoch 11 in logical epoch 11
[2023-07-21 18:21:51] Training finished
[2023-07-21 18:22:02] [valid] Ep. 11 : Up. 320 : cross-entropy : 183.299 : new best
[2023-07-21 18:25:57] [valid] Ep. 11 : Up. 320 : translation : 0 : new best
[2023-07-21 18:25:57] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 18:25:59] Saving Adam parameters
[2023-07-21 18:26:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 18:26:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:26:07] [marian] Running on node23.datos.cluster.uy as process 10035 with command line:
[2023-07-21 18:26:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 18:26:07] [config] after: 0e
[2023-07-21 18:26:07] [config] after-batches: 0
[2023-07-21 18:26:07] [config] after-epochs: 20
[2023-07-21 18:26:07] [config] all-caps-every: 0
[2023-07-21 18:26:07] [config] allow-unk: false
[2023-07-21 18:26:07] [config] authors: false
[2023-07-21 18:26:07] [config] beam-size: 12
[2023-07-21 18:26:07] [config] bert-class-symbol: "[CLS]"
[2023-07-21 18:26:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 18:26:07] [config] bert-masking-fraction: 0.15
[2023-07-21 18:26:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 18:26:07] [config] bert-train-type-embeddings: true
[2023-07-21 18:26:07] [config] bert-type-vocab-size: 2
[2023-07-21 18:26:07] [config] build-info: ""
[2023-07-21 18:26:07] [config] check-gradient-nan: false
[2023-07-21 18:26:07] [config] check-nan: false
[2023-07-21 18:26:07] [config] cite: false
[2023-07-21 18:26:07] [config] clip-norm: 1
[2023-07-21 18:26:07] [config] cost-scaling:
[2023-07-21 18:26:07] [config]   - 256.f
[2023-07-21 18:26:07] [config]   - 1000
[2023-07-21 18:26:07] [config]   - 2.f
[2023-07-21 18:26:07] [config]   - 256.f
[2023-07-21 18:26:07] [config] cost-type: ce-sum
[2023-07-21 18:26:07] [config] cpu-threads: 0
[2023-07-21 18:26:07] [config] data-threads: 8
[2023-07-21 18:26:07] [config] data-weighting: ""
[2023-07-21 18:26:07] [config] data-weighting-type: sentence
[2023-07-21 18:26:07] [config] dec-cell: gru
[2023-07-21 18:26:07] [config] dec-cell-base-depth: 2
[2023-07-21 18:26:07] [config] dec-cell-high-depth: 1
[2023-07-21 18:26:07] [config] dec-depth: 1
[2023-07-21 18:26:07] [config] devices:
[2023-07-21 18:26:07] [config]   - 0
[2023-07-21 18:26:07] [config] dim-emb: 512
[2023-07-21 18:26:07] [config] dim-rnn: 1024
[2023-07-21 18:26:07] [config] dim-vocabs:
[2023-07-21 18:26:07] [config]   - 16384
[2023-07-21 18:26:07] [config]   - 16384
[2023-07-21 18:26:07] [config] disp-first: 0
[2023-07-21 18:26:07] [config] disp-freq: 1000u
[2023-07-21 18:26:07] [config] disp-label-counts: true
[2023-07-21 18:26:07] [config] dropout-rnn: 0.5
[2023-07-21 18:26:07] [config] dropout-src: 0
[2023-07-21 18:26:07] [config] dropout-trg: 0
[2023-07-21 18:26:07] [config] dump-config: ""
[2023-07-21 18:26:07] [config] dynamic-gradient-scaling:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] early-stopping: 200
[2023-07-21 18:26:07] [config] early-stopping-on: first
[2023-07-21 18:26:07] [config] embedding-fix-src: false
[2023-07-21 18:26:07] [config] embedding-fix-trg: false
[2023-07-21 18:26:07] [config] embedding-normalization: false
[2023-07-21 18:26:07] [config] embedding-vectors:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] enc-cell: gru
[2023-07-21 18:26:07] [config] enc-cell-depth: 1
[2023-07-21 18:26:07] [config] enc-depth: 1
[2023-07-21 18:26:07] [config] enc-type: bidirectional
[2023-07-21 18:26:07] [config] english-title-case-every: 0
[2023-07-21 18:26:07] [config] exponential-smoothing: 0
[2023-07-21 18:26:07] [config] factor-weight: 1
[2023-07-21 18:26:07] [config] factors-combine: sum
[2023-07-21 18:26:07] [config] factors-dim-emb: 0
[2023-07-21 18:26:07] [config] gradient-checkpointing: false
[2023-07-21 18:26:07] [config] gradient-norm-average-window: 100
[2023-07-21 18:26:07] [config] guided-alignment: none
[2023-07-21 18:26:07] [config] guided-alignment-cost: mse
[2023-07-21 18:26:07] [config] guided-alignment-weight: 0.1
[2023-07-21 18:26:07] [config] ignore-model-config: false
[2023-07-21 18:26:07] [config] input-types:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] interpolate-env-vars: false
[2023-07-21 18:26:07] [config] keep-best: false
[2023-07-21 18:26:07] [config] label-smoothing: 0
[2023-07-21 18:26:07] [config] layer-normalization: false
[2023-07-21 18:26:07] [config] learn-rate: 0.0001
[2023-07-21 18:26:07] [config] lemma-dependency: ""
[2023-07-21 18:26:07] [config] lemma-dim-emb: 0
[2023-07-21 18:26:07] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 18:26:07] [config] log-level: info
[2023-07-21 18:26:07] [config] log-time-zone: ""
[2023-07-21 18:26:07] [config] logical-epoch:
[2023-07-21 18:26:07] [config]   - 1e
[2023-07-21 18:26:07] [config]   - 0
[2023-07-21 18:26:07] [config] lr-decay: 0
[2023-07-21 18:26:07] [config] lr-decay-freq: 50000
[2023-07-21 18:26:07] [config] lr-decay-inv-sqrt:
[2023-07-21 18:26:07] [config]   - 0
[2023-07-21 18:26:07] [config] lr-decay-repeat-warmup: false
[2023-07-21 18:26:07] [config] lr-decay-reset-optimizer: false
[2023-07-21 18:26:07] [config] lr-decay-start:
[2023-07-21 18:26:07] [config]   - 10
[2023-07-21 18:26:07] [config]   - 1
[2023-07-21 18:26:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 18:26:07] [config] lr-report: false
[2023-07-21 18:26:07] [config] lr-warmup: 0
[2023-07-21 18:26:07] [config] lr-warmup-at-reload: false
[2023-07-21 18:26:07] [config] lr-warmup-cycle: false
[2023-07-21 18:26:07] [config] lr-warmup-start-rate: 0
[2023-07-21 18:26:07] [config] max-length: 50
[2023-07-21 18:26:07] [config] max-length-crop: true
[2023-07-21 18:26:07] [config] max-length-factor: 3
[2023-07-21 18:26:07] [config] maxi-batch: 100
[2023-07-21 18:26:07] [config] maxi-batch-sort: trg
[2023-07-21 18:26:07] [config] mini-batch: 64
[2023-07-21 18:26:07] [config] mini-batch-fit: true
[2023-07-21 18:26:07] [config] mini-batch-fit-step: 10
[2023-07-21 18:26:07] [config] mini-batch-round-up: true
[2023-07-21 18:26:07] [config] mini-batch-track-lr: false
[2023-07-21 18:26:07] [config] mini-batch-warmup: 0
[2023-07-21 18:26:07] [config] mini-batch-words: 0
[2023-07-21 18:26:07] [config] mini-batch-words-ref: 0
[2023-07-21 18:26:07] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 18:26:07] [config] multi-loss-type: sum
[2023-07-21 18:26:07] [config] n-best: false
[2023-07-21 18:26:07] [config] no-nccl: false
[2023-07-21 18:26:07] [config] no-reload: false
[2023-07-21 18:26:07] [config] no-restore-corpus: false
[2023-07-21 18:26:07] [config] normalize: 0
[2023-07-21 18:26:07] [config] normalize-gradient: false
[2023-07-21 18:26:07] [config] num-devices: 0
[2023-07-21 18:26:07] [config] optimizer: adam
[2023-07-21 18:26:07] [config] optimizer-delay: 1
[2023-07-21 18:26:07] [config] optimizer-params:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] output-omit-bias: false
[2023-07-21 18:26:07] [config] overwrite: true
[2023-07-21 18:26:07] [config] precision:
[2023-07-21 18:26:07] [config]   - float16
[2023-07-21 18:26:07] [config]   - float32
[2023-07-21 18:26:07] [config] pretrained-model: ""
[2023-07-21 18:26:07] [config] quantize-biases: false
[2023-07-21 18:26:07] [config] quantize-bits: 0
[2023-07-21 18:26:07] [config] quantize-log-based: false
[2023-07-21 18:26:07] [config] quantize-optimization-steps: 0
[2023-07-21 18:26:07] [config] quiet: false
[2023-07-21 18:26:07] [config] quiet-translation: true
[2023-07-21 18:26:07] [config] relative-paths: false
[2023-07-21 18:26:07] [config] right-left: false
[2023-07-21 18:26:07] [config] save-freq: 10000u
[2023-07-21 18:26:07] [config] seed: 1234
[2023-07-21 18:26:07] [config] sentencepiece-alphas:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] sentencepiece-max-lines: 2000000
[2023-07-21 18:26:07] [config] sentencepiece-options: ""
[2023-07-21 18:26:07] [config] sharding: global
[2023-07-21 18:26:07] [config] shuffle: data
[2023-07-21 18:26:07] [config] shuffle-in-ram: false
[2023-07-21 18:26:07] [config] sigterm: save-and-exit
[2023-07-21 18:26:07] [config] skip: false
[2023-07-21 18:26:07] [config] sqlite: ""
[2023-07-21 18:26:07] [config] sqlite-drop: false
[2023-07-21 18:26:07] [config] sync-freq: 200u
[2023-07-21 18:26:07] [config] sync-sgd: false
[2023-07-21 18:26:07] [config] tempdir: /tmp
[2023-07-21 18:26:07] [config] tied-embeddings: false
[2023-07-21 18:26:07] [config] tied-embeddings-all: true
[2023-07-21 18:26:07] [config] tied-embeddings-src: false
[2023-07-21 18:26:07] [config] train-embedder-rank:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] train-sets:
[2023-07-21 18:26:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 18:26:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 18:26:07] [config] transformer-aan-activation: swish
[2023-07-21 18:26:07] [config] transformer-aan-depth: 2
[2023-07-21 18:26:07] [config] transformer-aan-nogate: false
[2023-07-21 18:26:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 18:26:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 18:26:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 18:26:07] [config] transformer-depth-scaling: false
[2023-07-21 18:26:07] [config] transformer-dim-aan: 2048
[2023-07-21 18:26:07] [config] transformer-dim-ffn: 2048
[2023-07-21 18:26:07] [config] transformer-dropout: 0
[2023-07-21 18:26:07] [config] transformer-dropout-attention: 0
[2023-07-21 18:26:07] [config] transformer-dropout-ffn: 0
[2023-07-21 18:26:07] [config] transformer-ffn-activation: swish
[2023-07-21 18:26:07] [config] transformer-ffn-depth: 2
[2023-07-21 18:26:07] [config] transformer-guided-alignment-layer: last
[2023-07-21 18:26:07] [config] transformer-heads: 8
[2023-07-21 18:26:07] [config] transformer-no-projection: false
[2023-07-21 18:26:07] [config] transformer-pool: false
[2023-07-21 18:26:07] [config] transformer-postprocess: dan
[2023-07-21 18:26:07] [config] transformer-postprocess-emb: d
[2023-07-21 18:26:07] [config] transformer-postprocess-top: ""
[2023-07-21 18:26:07] [config] transformer-preprocess: ""
[2023-07-21 18:26:07] [config] transformer-tied-layers:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] transformer-train-position-embeddings: false
[2023-07-21 18:26:07] [config] tsv: false
[2023-07-21 18:26:07] [config] tsv-fields: 0
[2023-07-21 18:26:07] [config] type: amun
[2023-07-21 18:26:07] [config] ulr: false
[2023-07-21 18:26:07] [config] ulr-dim-emb: 0
[2023-07-21 18:26:07] [config] ulr-dropout: 0
[2023-07-21 18:26:07] [config] ulr-keys-vectors: ""
[2023-07-21 18:26:07] [config] ulr-query-vectors: ""
[2023-07-21 18:26:07] [config] ulr-softmax-temperature: 1
[2023-07-21 18:26:07] [config] ulr-trainable-transformation: false
[2023-07-21 18:26:07] [config] unlikelihood-loss: false
[2023-07-21 18:26:07] [config] valid-freq: 50000000
[2023-07-21 18:26:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 18:26:07] [config] valid-max-length: 1000
[2023-07-21 18:26:07] [config] valid-metrics:
[2023-07-21 18:26:07] [config]   - cross-entropy
[2023-07-21 18:26:07] [config]   - translation
[2023-07-21 18:26:07] [config] valid-mini-batch: 32
[2023-07-21 18:26:07] [config] valid-reset-stalled: false
[2023-07-21 18:26:07] [config] valid-script-args:
[2023-07-21 18:26:07] [config]   []
[2023-07-21 18:26:07] [config] valid-script-path: ""
[2023-07-21 18:26:07] [config] valid-sets:
[2023-07-21 18:26:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 18:26:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 18:26:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 18:26:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:26:07] [config] vocabs:
[2023-07-21 18:26:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:26:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:26:07] [config] word-penalty: 0
[2023-07-21 18:26:07] [config] word-scores: false
[2023-07-21 18:26:07] [config] workspace: 5500
[2023-07-21 18:26:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:26:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:26:07] [training] Using single-device training
[2023-07-21 18:26:09] Synced seed 1234
[2023-07-21 18:26:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:26:09] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 18:26:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:26:09] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 18:26:09] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 18:26:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:26:09] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 18:26:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:26:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:26:10] [comm] Using global sharding
[2023-07-21 18:26:10] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:26:10] [training] Using 1 GPUs
[2023-07-21 18:26:10] [logits] Applying loss function for 1 factor(s)
[2023-07-21 18:26:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:26:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 18:26:11] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:32:24] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 18:32:24] [valid] No post-processing script given for validating translator
[2023-07-21 18:32:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:32:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:32:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:32:24] [comm] Using global sharding
[2023-07-21 18:32:24] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:32:24] [training] Using 1 GPUs
[2023-07-21 18:32:24] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 18:32:25] Allocating memory for general optimizer shards
[2023-07-21 18:32:25] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:32:25] Loading Adam parameters
[2023-07-21 18:32:25] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:32:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:32:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 18:32:26] [data] Restoring the corpus state to epoch 11, batch 320
[2023-07-21 18:32:26] [data] Shuffling data
[2023-07-21 18:32:26] [data] Done reading 20,192 sentences
[2023-07-21 18:32:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:32:26] Training started
[2023-07-21 18:32:26] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 18:32:27] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:32:30] Parameter type float16, optimization type float32, casting types true
[2023-07-21 18:35:28] Seen 20,192 samples
[2023-07-21 18:35:28] Starting data epoch 12 in logical epoch 12
[2023-07-21 18:35:28] [data] Shuffling data
[2023-07-21 18:35:28] [data] Done reading 20,192 sentences
[2023-07-21 18:35:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:38:31] Seen 20,192 samples
[2023-07-21 18:38:31] Starting data epoch 13 in logical epoch 13
[2023-07-21 18:38:31] [data] Shuffling data
[2023-07-21 18:38:31] [data] Done reading 20,192 sentences
[2023-07-21 18:38:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:41:35] Seen 20,192 samples
[2023-07-21 18:41:35] Starting data epoch 14 in logical epoch 14
[2023-07-21 18:41:35] [data] Shuffling data
[2023-07-21 18:41:35] [data] Done reading 20,192 sentences
[2023-07-21 18:41:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:44:43] Seen 20,192 samples
[2023-07-21 18:44:43] Starting data epoch 15 in logical epoch 15
[2023-07-21 18:44:43] [data] Shuffling data
[2023-07-21 18:44:43] [data] Done reading 20,192 sentences
[2023-07-21 18:44:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:47:46] Seen 20,192 samples
[2023-07-21 18:47:46] Starting data epoch 16 in logical epoch 16
[2023-07-21 18:47:46] [data] Shuffling data
[2023-07-21 18:47:46] [data] Done reading 20,192 sentences
[2023-07-21 18:47:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:50:49] Seen 20,192 samples
[2023-07-21 18:50:49] Starting data epoch 17 in logical epoch 17
[2023-07-21 18:50:49] [data] Shuffling data
[2023-07-21 18:50:49] [data] Done reading 20,192 sentences
[2023-07-21 18:50:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:53:51] Seen 20,192 samples
[2023-07-21 18:53:51] Starting data epoch 18 in logical epoch 18
[2023-07-21 18:53:51] [data] Shuffling data
[2023-07-21 18:53:52] [data] Done reading 20,192 sentences
[2023-07-21 18:53:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:56:52] Seen 20,192 samples
[2023-07-21 18:56:52] Starting data epoch 19 in logical epoch 19
[2023-07-21 18:56:52] [data] Shuffling data
[2023-07-21 18:56:52] [data] Done reading 20,192 sentences
[2023-07-21 18:56:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:59:57] Seen 20,192 samples
[2023-07-21 18:59:57] Starting data epoch 20 in logical epoch 20
[2023-07-21 18:59:57] [data] Shuffling data
[2023-07-21 18:59:57] [data] Done reading 20,192 sentences
[2023-07-21 18:59:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:03:09] Seen 20,192 samples
[2023-07-21 19:03:09] Starting data epoch 21 in logical epoch 21
[2023-07-21 19:03:09] Training finished
[2023-07-21 19:03:21] [valid] Ep. 21 : Up. 640 : cross-entropy : 173.933 : new best
[2023-07-21 19:05:00] [valid] Ep. 21 : Up. 640 : translation : 0 : new best
[2023-07-21 19:05:00] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 19:05:03] Saving Adam parameters
[2023-07-21 19:05:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 19:05:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 19:05:10] [marian] Running on node23.datos.cluster.uy as process 12505 with command line:
[2023-07-21 19:05:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 19:05:10] [config] after: 0e
[2023-07-21 19:05:10] [config] after-batches: 0
[2023-07-21 19:05:10] [config] after-epochs: 30
[2023-07-21 19:05:10] [config] all-caps-every: 0
[2023-07-21 19:05:10] [config] allow-unk: false
[2023-07-21 19:05:10] [config] authors: false
[2023-07-21 19:05:10] [config] beam-size: 12
[2023-07-21 19:05:10] [config] bert-class-symbol: "[CLS]"
[2023-07-21 19:05:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 19:05:10] [config] bert-masking-fraction: 0.15
[2023-07-21 19:05:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 19:05:10] [config] bert-train-type-embeddings: true
[2023-07-21 19:05:10] [config] bert-type-vocab-size: 2
[2023-07-21 19:05:10] [config] build-info: ""
[2023-07-21 19:05:10] [config] check-gradient-nan: false
[2023-07-21 19:05:10] [config] check-nan: false
[2023-07-21 19:05:10] [config] cite: false
[2023-07-21 19:05:10] [config] clip-norm: 1
[2023-07-21 19:05:10] [config] cost-scaling:
[2023-07-21 19:05:10] [config]   - 256.f
[2023-07-21 19:05:10] [config]   - 1000
[2023-07-21 19:05:10] [config]   - 2.f
[2023-07-21 19:05:10] [config]   - 256.f
[2023-07-21 19:05:10] [config] cost-type: ce-sum
[2023-07-21 19:05:10] [config] cpu-threads: 0
[2023-07-21 19:05:10] [config] data-threads: 8
[2023-07-21 19:05:10] [config] data-weighting: ""
[2023-07-21 19:05:10] [config] data-weighting-type: sentence
[2023-07-21 19:05:10] [config] dec-cell: gru
[2023-07-21 19:05:10] [config] dec-cell-base-depth: 2
[2023-07-21 19:05:10] [config] dec-cell-high-depth: 1
[2023-07-21 19:05:10] [config] dec-depth: 1
[2023-07-21 19:05:10] [config] devices:
[2023-07-21 19:05:10] [config]   - 0
[2023-07-21 19:05:10] [config] dim-emb: 512
[2023-07-21 19:05:10] [config] dim-rnn: 1024
[2023-07-21 19:05:10] [config] dim-vocabs:
[2023-07-21 19:05:10] [config]   - 16384
[2023-07-21 19:05:10] [config]   - 16384
[2023-07-21 19:05:10] [config] disp-first: 0
[2023-07-21 19:05:10] [config] disp-freq: 1000u
[2023-07-21 19:05:10] [config] disp-label-counts: true
[2023-07-21 19:05:10] [config] dropout-rnn: 0.5
[2023-07-21 19:05:10] [config] dropout-src: 0
[2023-07-21 19:05:10] [config] dropout-trg: 0
[2023-07-21 19:05:10] [config] dump-config: ""
[2023-07-21 19:05:10] [config] dynamic-gradient-scaling:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] early-stopping: 200
[2023-07-21 19:05:10] [config] early-stopping-on: first
[2023-07-21 19:05:10] [config] embedding-fix-src: false
[2023-07-21 19:05:10] [config] embedding-fix-trg: false
[2023-07-21 19:05:10] [config] embedding-normalization: false
[2023-07-21 19:05:10] [config] embedding-vectors:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] enc-cell: gru
[2023-07-21 19:05:10] [config] enc-cell-depth: 1
[2023-07-21 19:05:10] [config] enc-depth: 1
[2023-07-21 19:05:10] [config] enc-type: bidirectional
[2023-07-21 19:05:10] [config] english-title-case-every: 0
[2023-07-21 19:05:10] [config] exponential-smoothing: 0
[2023-07-21 19:05:10] [config] factor-weight: 1
[2023-07-21 19:05:10] [config] factors-combine: sum
[2023-07-21 19:05:10] [config] factors-dim-emb: 0
[2023-07-21 19:05:10] [config] gradient-checkpointing: false
[2023-07-21 19:05:10] [config] gradient-norm-average-window: 100
[2023-07-21 19:05:10] [config] guided-alignment: none
[2023-07-21 19:05:10] [config] guided-alignment-cost: mse
[2023-07-21 19:05:10] [config] guided-alignment-weight: 0.1
[2023-07-21 19:05:10] [config] ignore-model-config: false
[2023-07-21 19:05:10] [config] input-types:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] interpolate-env-vars: false
[2023-07-21 19:05:10] [config] keep-best: false
[2023-07-21 19:05:10] [config] label-smoothing: 0
[2023-07-21 19:05:10] [config] layer-normalization: false
[2023-07-21 19:05:10] [config] learn-rate: 0.0001
[2023-07-21 19:05:10] [config] lemma-dependency: ""
[2023-07-21 19:05:10] [config] lemma-dim-emb: 0
[2023-07-21 19:05:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 19:05:10] [config] log-level: info
[2023-07-21 19:05:10] [config] log-time-zone: ""
[2023-07-21 19:05:10] [config] logical-epoch:
[2023-07-21 19:05:10] [config]   - 1e
[2023-07-21 19:05:10] [config]   - 0
[2023-07-21 19:05:10] [config] lr-decay: 0
[2023-07-21 19:05:10] [config] lr-decay-freq: 50000
[2023-07-21 19:05:10] [config] lr-decay-inv-sqrt:
[2023-07-21 19:05:10] [config]   - 0
[2023-07-21 19:05:10] [config] lr-decay-repeat-warmup: false
[2023-07-21 19:05:10] [config] lr-decay-reset-optimizer: false
[2023-07-21 19:05:10] [config] lr-decay-start:
[2023-07-21 19:05:10] [config]   - 10
[2023-07-21 19:05:10] [config]   - 1
[2023-07-21 19:05:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 19:05:10] [config] lr-report: false
[2023-07-21 19:05:10] [config] lr-warmup: 0
[2023-07-21 19:05:10] [config] lr-warmup-at-reload: false
[2023-07-21 19:05:10] [config] lr-warmup-cycle: false
[2023-07-21 19:05:10] [config] lr-warmup-start-rate: 0
[2023-07-21 19:05:10] [config] max-length: 50
[2023-07-21 19:05:10] [config] max-length-crop: true
[2023-07-21 19:05:10] [config] max-length-factor: 3
[2023-07-21 19:05:10] [config] maxi-batch: 100
[2023-07-21 19:05:10] [config] maxi-batch-sort: trg
[2023-07-21 19:05:10] [config] mini-batch: 64
[2023-07-21 19:05:10] [config] mini-batch-fit: true
[2023-07-21 19:05:10] [config] mini-batch-fit-step: 10
[2023-07-21 19:05:10] [config] mini-batch-round-up: true
[2023-07-21 19:05:10] [config] mini-batch-track-lr: false
[2023-07-21 19:05:10] [config] mini-batch-warmup: 0
[2023-07-21 19:05:10] [config] mini-batch-words: 0
[2023-07-21 19:05:10] [config] mini-batch-words-ref: 0
[2023-07-21 19:05:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 19:05:10] [config] multi-loss-type: sum
[2023-07-21 19:05:10] [config] n-best: false
[2023-07-21 19:05:10] [config] no-nccl: false
[2023-07-21 19:05:10] [config] no-reload: false
[2023-07-21 19:05:10] [config] no-restore-corpus: false
[2023-07-21 19:05:10] [config] normalize: 0
[2023-07-21 19:05:10] [config] normalize-gradient: false
[2023-07-21 19:05:10] [config] num-devices: 0
[2023-07-21 19:05:10] [config] optimizer: adam
[2023-07-21 19:05:10] [config] optimizer-delay: 1
[2023-07-21 19:05:10] [config] optimizer-params:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] output-omit-bias: false
[2023-07-21 19:05:10] [config] overwrite: true
[2023-07-21 19:05:10] [config] precision:
[2023-07-21 19:05:10] [config]   - float16
[2023-07-21 19:05:10] [config]   - float32
[2023-07-21 19:05:10] [config] pretrained-model: ""
[2023-07-21 19:05:10] [config] quantize-biases: false
[2023-07-21 19:05:10] [config] quantize-bits: 0
[2023-07-21 19:05:10] [config] quantize-log-based: false
[2023-07-21 19:05:10] [config] quantize-optimization-steps: 0
[2023-07-21 19:05:10] [config] quiet: false
[2023-07-21 19:05:10] [config] quiet-translation: true
[2023-07-21 19:05:10] [config] relative-paths: false
[2023-07-21 19:05:10] [config] right-left: false
[2023-07-21 19:05:10] [config] save-freq: 10000u
[2023-07-21 19:05:10] [config] seed: 1234
[2023-07-21 19:05:10] [config] sentencepiece-alphas:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] sentencepiece-max-lines: 2000000
[2023-07-21 19:05:10] [config] sentencepiece-options: ""
[2023-07-21 19:05:10] [config] sharding: global
[2023-07-21 19:05:10] [config] shuffle: data
[2023-07-21 19:05:10] [config] shuffle-in-ram: false
[2023-07-21 19:05:10] [config] sigterm: save-and-exit
[2023-07-21 19:05:10] [config] skip: false
[2023-07-21 19:05:10] [config] sqlite: ""
[2023-07-21 19:05:10] [config] sqlite-drop: false
[2023-07-21 19:05:10] [config] sync-freq: 200u
[2023-07-21 19:05:10] [config] sync-sgd: false
[2023-07-21 19:05:10] [config] tempdir: /tmp
[2023-07-21 19:05:10] [config] tied-embeddings: false
[2023-07-21 19:05:10] [config] tied-embeddings-all: true
[2023-07-21 19:05:10] [config] tied-embeddings-src: false
[2023-07-21 19:05:10] [config] train-embedder-rank:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] train-sets:
[2023-07-21 19:05:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 19:05:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 19:05:10] [config] transformer-aan-activation: swish
[2023-07-21 19:05:10] [config] transformer-aan-depth: 2
[2023-07-21 19:05:10] [config] transformer-aan-nogate: false
[2023-07-21 19:05:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 19:05:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 19:05:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 19:05:10] [config] transformer-depth-scaling: false
[2023-07-21 19:05:10] [config] transformer-dim-aan: 2048
[2023-07-21 19:05:10] [config] transformer-dim-ffn: 2048
[2023-07-21 19:05:10] [config] transformer-dropout: 0
[2023-07-21 19:05:10] [config] transformer-dropout-attention: 0
[2023-07-21 19:05:10] [config] transformer-dropout-ffn: 0
[2023-07-21 19:05:10] [config] transformer-ffn-activation: swish
[2023-07-21 19:05:10] [config] transformer-ffn-depth: 2
[2023-07-21 19:05:10] [config] transformer-guided-alignment-layer: last
[2023-07-21 19:05:10] [config] transformer-heads: 8
[2023-07-21 19:05:10] [config] transformer-no-projection: false
[2023-07-21 19:05:10] [config] transformer-pool: false
[2023-07-21 19:05:10] [config] transformer-postprocess: dan
[2023-07-21 19:05:10] [config] transformer-postprocess-emb: d
[2023-07-21 19:05:10] [config] transformer-postprocess-top: ""
[2023-07-21 19:05:10] [config] transformer-preprocess: ""
[2023-07-21 19:05:10] [config] transformer-tied-layers:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] transformer-train-position-embeddings: false
[2023-07-21 19:05:10] [config] tsv: false
[2023-07-21 19:05:10] [config] tsv-fields: 0
[2023-07-21 19:05:10] [config] type: amun
[2023-07-21 19:05:10] [config] ulr: false
[2023-07-21 19:05:10] [config] ulr-dim-emb: 0
[2023-07-21 19:05:10] [config] ulr-dropout: 0
[2023-07-21 19:05:10] [config] ulr-keys-vectors: ""
[2023-07-21 19:05:10] [config] ulr-query-vectors: ""
[2023-07-21 19:05:10] [config] ulr-softmax-temperature: 1
[2023-07-21 19:05:10] [config] ulr-trainable-transformation: false
[2023-07-21 19:05:10] [config] unlikelihood-loss: false
[2023-07-21 19:05:10] [config] valid-freq: 50000000
[2023-07-21 19:05:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 19:05:10] [config] valid-max-length: 1000
[2023-07-21 19:05:10] [config] valid-metrics:
[2023-07-21 19:05:10] [config]   - cross-entropy
[2023-07-21 19:05:10] [config]   - translation
[2023-07-21 19:05:10] [config] valid-mini-batch: 32
[2023-07-21 19:05:10] [config] valid-reset-stalled: false
[2023-07-21 19:05:10] [config] valid-script-args:
[2023-07-21 19:05:10] [config]   []
[2023-07-21 19:05:10] [config] valid-script-path: ""
[2023-07-21 19:05:10] [config] valid-sets:
[2023-07-21 19:05:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 19:05:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 19:05:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 19:05:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 19:05:10] [config] vocabs:
[2023-07-21 19:05:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 19:05:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 19:05:10] [config] word-penalty: 0
[2023-07-21 19:05:10] [config] word-scores: false
[2023-07-21 19:05:10] [config] workspace: 5500
[2023-07-21 19:05:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 19:05:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:05:10] [training] Using single-device training
[2023-07-21 19:05:10] Synced seed 1234
[2023-07-21 19:05:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 19:05:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 19:05:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 19:05:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 19:05:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 19:05:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:05:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 19:05:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:05:11] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:05:11] [comm] Using global sharding
[2023-07-21 19:05:12] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:05:12] [training] Using 1 GPUs
[2023-07-21 19:05:12] [logits] Applying loss function for 1 factor(s)
[2023-07-21 19:05:12] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:05:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 19:05:12] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:11:14] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 19:11:15] [valid] No post-processing script given for validating translator
[2023-07-21 19:11:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:11:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:11:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:11:15] [comm] Using global sharding
[2023-07-21 19:11:15] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:11:15] [training] Using 1 GPUs
[2023-07-21 19:11:15] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 19:11:16] Allocating memory for general optimizer shards
[2023-07-21 19:11:16] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:11:16] Loading Adam parameters
[2023-07-21 19:11:16] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:11:16] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:11:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 19:11:16] [data] Restoring the corpus state to epoch 21, batch 640
[2023-07-21 19:11:16] [data] Shuffling data
[2023-07-21 19:11:16] [data] Done reading 20,192 sentences
[2023-07-21 19:11:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:11:16] Training started
[2023-07-21 19:11:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 19:11:18] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:11:27] Parameter type float16, optimization type float32, casting types true
[2023-07-21 19:14:18] Seen 20,192 samples
[2023-07-21 19:14:18] Starting data epoch 22 in logical epoch 22
[2023-07-21 19:14:18] [data] Shuffling data
[2023-07-21 19:14:18] [data] Done reading 20,192 sentences
[2023-07-21 19:14:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:17:23] Seen 20,192 samples
[2023-07-21 19:17:23] Starting data epoch 23 in logical epoch 23
[2023-07-21 19:17:23] [data] Shuffling data
[2023-07-21 19:17:23] [data] Done reading 20,192 sentences
[2023-07-21 19:17:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:20:40] Seen 20,192 samples
[2023-07-21 19:20:40] Starting data epoch 24 in logical epoch 24
[2023-07-21 19:20:40] [data] Shuffling data
[2023-07-21 19:20:40] [data] Done reading 20,192 sentences
[2023-07-21 19:20:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:23:56] Seen 20,192 samples
[2023-07-21 19:23:56] Starting data epoch 25 in logical epoch 25
[2023-07-21 19:23:56] [data] Shuffling data
[2023-07-21 19:23:56] [data] Done reading 20,192 sentences
[2023-07-21 19:23:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:27:09] Seen 20,192 samples
[2023-07-21 19:27:09] Starting data epoch 26 in logical epoch 26
[2023-07-21 19:27:09] [data] Shuffling data
[2023-07-21 19:27:09] [data] Done reading 20,192 sentences
[2023-07-21 19:27:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:30:24] Seen 20,192 samples
[2023-07-21 19:30:24] Starting data epoch 27 in logical epoch 27
[2023-07-21 19:30:24] [data] Shuffling data
[2023-07-21 19:30:24] [data] Done reading 20,192 sentences
[2023-07-21 19:30:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:33:41] Seen 20,192 samples
[2023-07-21 19:33:41] Starting data epoch 28 in logical epoch 28
[2023-07-21 19:33:41] [data] Shuffling data
[2023-07-21 19:33:41] [data] Done reading 20,192 sentences
[2023-07-21 19:33:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:36:56] Seen 20,192 samples
[2023-07-21 19:36:56] Starting data epoch 29 in logical epoch 29
[2023-07-21 19:36:56] [data] Shuffling data
[2023-07-21 19:36:56] [data] Done reading 20,192 sentences
[2023-07-21 19:36:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:40:22] Seen 20,192 samples
[2023-07-21 19:40:22] Starting data epoch 30 in logical epoch 30
[2023-07-21 19:40:22] [data] Shuffling data
[2023-07-21 19:40:22] [data] Done reading 20,192 sentences
[2023-07-21 19:40:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:43:47] Seen 20,192 samples
[2023-07-21 19:43:47] Starting data epoch 31 in logical epoch 31
[2023-07-21 19:43:47] Training finished
[2023-07-21 19:44:05] [valid] Ep. 31 : Up. 960 : cross-entropy : 168.174 : new best
[2023-07-21 19:47:57] [valid] Ep. 31 : Up. 960 : translation : 0 : new best
[2023-07-21 19:47:57] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 19:48:00] Saving Adam parameters
[2023-07-21 19:48:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 19:48:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 19:48:06] [marian] Running on node23.datos.cluster.uy as process 15137 with command line:
[2023-07-21 19:48:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 19:48:06] [config] after: 0e
[2023-07-21 19:48:06] [config] after-batches: 0
[2023-07-21 19:48:06] [config] after-epochs: 40
[2023-07-21 19:48:06] [config] all-caps-every: 0
[2023-07-21 19:48:06] [config] allow-unk: false
[2023-07-21 19:48:06] [config] authors: false
[2023-07-21 19:48:06] [config] beam-size: 12
[2023-07-21 19:48:06] [config] bert-class-symbol: "[CLS]"
[2023-07-21 19:48:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 19:48:06] [config] bert-masking-fraction: 0.15
[2023-07-21 19:48:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 19:48:06] [config] bert-train-type-embeddings: true
[2023-07-21 19:48:06] [config] bert-type-vocab-size: 2
[2023-07-21 19:48:06] [config] build-info: ""
[2023-07-21 19:48:06] [config] check-gradient-nan: false
[2023-07-21 19:48:06] [config] check-nan: false
[2023-07-21 19:48:06] [config] cite: false
[2023-07-21 19:48:06] [config] clip-norm: 1
[2023-07-21 19:48:06] [config] cost-scaling:
[2023-07-21 19:48:06] [config]   - 256.f
[2023-07-21 19:48:06] [config]   - 1000
[2023-07-21 19:48:06] [config]   - 2.f
[2023-07-21 19:48:06] [config]   - 256.f
[2023-07-21 19:48:06] [config] cost-type: ce-sum
[2023-07-21 19:48:06] [config] cpu-threads: 0
[2023-07-21 19:48:06] [config] data-threads: 8
[2023-07-21 19:48:06] [config] data-weighting: ""
[2023-07-21 19:48:06] [config] data-weighting-type: sentence
[2023-07-21 19:48:06] [config] dec-cell: gru
[2023-07-21 19:48:06] [config] dec-cell-base-depth: 2
[2023-07-21 19:48:06] [config] dec-cell-high-depth: 1
[2023-07-21 19:48:06] [config] dec-depth: 1
[2023-07-21 19:48:06] [config] devices:
[2023-07-21 19:48:06] [config]   - 0
[2023-07-21 19:48:06] [config] dim-emb: 512
[2023-07-21 19:48:06] [config] dim-rnn: 1024
[2023-07-21 19:48:06] [config] dim-vocabs:
[2023-07-21 19:48:06] [config]   - 16384
[2023-07-21 19:48:06] [config]   - 16384
[2023-07-21 19:48:06] [config] disp-first: 0
[2023-07-21 19:48:06] [config] disp-freq: 1000u
[2023-07-21 19:48:06] [config] disp-label-counts: true
[2023-07-21 19:48:06] [config] dropout-rnn: 0.5
[2023-07-21 19:48:06] [config] dropout-src: 0
[2023-07-21 19:48:06] [config] dropout-trg: 0
[2023-07-21 19:48:06] [config] dump-config: ""
[2023-07-21 19:48:06] [config] dynamic-gradient-scaling:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] early-stopping: 200
[2023-07-21 19:48:06] [config] early-stopping-on: first
[2023-07-21 19:48:06] [config] embedding-fix-src: false
[2023-07-21 19:48:06] [config] embedding-fix-trg: false
[2023-07-21 19:48:06] [config] embedding-normalization: false
[2023-07-21 19:48:06] [config] embedding-vectors:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] enc-cell: gru
[2023-07-21 19:48:06] [config] enc-cell-depth: 1
[2023-07-21 19:48:06] [config] enc-depth: 1
[2023-07-21 19:48:06] [config] enc-type: bidirectional
[2023-07-21 19:48:06] [config] english-title-case-every: 0
[2023-07-21 19:48:06] [config] exponential-smoothing: 0
[2023-07-21 19:48:06] [config] factor-weight: 1
[2023-07-21 19:48:06] [config] factors-combine: sum
[2023-07-21 19:48:06] [config] factors-dim-emb: 0
[2023-07-21 19:48:06] [config] gradient-checkpointing: false
[2023-07-21 19:48:06] [config] gradient-norm-average-window: 100
[2023-07-21 19:48:06] [config] guided-alignment: none
[2023-07-21 19:48:06] [config] guided-alignment-cost: mse
[2023-07-21 19:48:06] [config] guided-alignment-weight: 0.1
[2023-07-21 19:48:06] [config] ignore-model-config: false
[2023-07-21 19:48:06] [config] input-types:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] interpolate-env-vars: false
[2023-07-21 19:48:06] [config] keep-best: false
[2023-07-21 19:48:06] [config] label-smoothing: 0
[2023-07-21 19:48:06] [config] layer-normalization: false
[2023-07-21 19:48:06] [config] learn-rate: 0.0001
[2023-07-21 19:48:06] [config] lemma-dependency: ""
[2023-07-21 19:48:06] [config] lemma-dim-emb: 0
[2023-07-21 19:48:06] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 19:48:06] [config] log-level: info
[2023-07-21 19:48:06] [config] log-time-zone: ""
[2023-07-21 19:48:06] [config] logical-epoch:
[2023-07-21 19:48:06] [config]   - 1e
[2023-07-21 19:48:06] [config]   - 0
[2023-07-21 19:48:06] [config] lr-decay: 0
[2023-07-21 19:48:06] [config] lr-decay-freq: 50000
[2023-07-21 19:48:06] [config] lr-decay-inv-sqrt:
[2023-07-21 19:48:06] [config]   - 0
[2023-07-21 19:48:06] [config] lr-decay-repeat-warmup: false
[2023-07-21 19:48:06] [config] lr-decay-reset-optimizer: false
[2023-07-21 19:48:06] [config] lr-decay-start:
[2023-07-21 19:48:06] [config]   - 10
[2023-07-21 19:48:06] [config]   - 1
[2023-07-21 19:48:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 19:48:06] [config] lr-report: false
[2023-07-21 19:48:06] [config] lr-warmup: 0
[2023-07-21 19:48:06] [config] lr-warmup-at-reload: false
[2023-07-21 19:48:06] [config] lr-warmup-cycle: false
[2023-07-21 19:48:06] [config] lr-warmup-start-rate: 0
[2023-07-21 19:48:06] [config] max-length: 50
[2023-07-21 19:48:06] [config] max-length-crop: true
[2023-07-21 19:48:06] [config] max-length-factor: 3
[2023-07-21 19:48:06] [config] maxi-batch: 100
[2023-07-21 19:48:06] [config] maxi-batch-sort: trg
[2023-07-21 19:48:06] [config] mini-batch: 64
[2023-07-21 19:48:06] [config] mini-batch-fit: true
[2023-07-21 19:48:06] [config] mini-batch-fit-step: 10
[2023-07-21 19:48:06] [config] mini-batch-round-up: true
[2023-07-21 19:48:06] [config] mini-batch-track-lr: false
[2023-07-21 19:48:06] [config] mini-batch-warmup: 0
[2023-07-21 19:48:06] [config] mini-batch-words: 0
[2023-07-21 19:48:06] [config] mini-batch-words-ref: 0
[2023-07-21 19:48:06] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 19:48:06] [config] multi-loss-type: sum
[2023-07-21 19:48:06] [config] n-best: false
[2023-07-21 19:48:06] [config] no-nccl: false
[2023-07-21 19:48:06] [config] no-reload: false
[2023-07-21 19:48:06] [config] no-restore-corpus: false
[2023-07-21 19:48:06] [config] normalize: 0
[2023-07-21 19:48:06] [config] normalize-gradient: false
[2023-07-21 19:48:06] [config] num-devices: 0
[2023-07-21 19:48:06] [config] optimizer: adam
[2023-07-21 19:48:06] [config] optimizer-delay: 1
[2023-07-21 19:48:06] [config] optimizer-params:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] output-omit-bias: false
[2023-07-21 19:48:06] [config] overwrite: true
[2023-07-21 19:48:06] [config] precision:
[2023-07-21 19:48:06] [config]   - float16
[2023-07-21 19:48:06] [config]   - float32
[2023-07-21 19:48:06] [config] pretrained-model: ""
[2023-07-21 19:48:06] [config] quantize-biases: false
[2023-07-21 19:48:06] [config] quantize-bits: 0
[2023-07-21 19:48:06] [config] quantize-log-based: false
[2023-07-21 19:48:06] [config] quantize-optimization-steps: 0
[2023-07-21 19:48:06] [config] quiet: false
[2023-07-21 19:48:06] [config] quiet-translation: true
[2023-07-21 19:48:06] [config] relative-paths: false
[2023-07-21 19:48:06] [config] right-left: false
[2023-07-21 19:48:06] [config] save-freq: 10000u
[2023-07-21 19:48:06] [config] seed: 1234
[2023-07-21 19:48:06] [config] sentencepiece-alphas:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] sentencepiece-max-lines: 2000000
[2023-07-21 19:48:06] [config] sentencepiece-options: ""
[2023-07-21 19:48:06] [config] sharding: global
[2023-07-21 19:48:06] [config] shuffle: data
[2023-07-21 19:48:06] [config] shuffle-in-ram: false
[2023-07-21 19:48:06] [config] sigterm: save-and-exit
[2023-07-21 19:48:06] [config] skip: false
[2023-07-21 19:48:06] [config] sqlite: ""
[2023-07-21 19:48:06] [config] sqlite-drop: false
[2023-07-21 19:48:06] [config] sync-freq: 200u
[2023-07-21 19:48:06] [config] sync-sgd: false
[2023-07-21 19:48:06] [config] tempdir: /tmp
[2023-07-21 19:48:06] [config] tied-embeddings: false
[2023-07-21 19:48:06] [config] tied-embeddings-all: true
[2023-07-21 19:48:06] [config] tied-embeddings-src: false
[2023-07-21 19:48:06] [config] train-embedder-rank:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] train-sets:
[2023-07-21 19:48:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 19:48:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 19:48:06] [config] transformer-aan-activation: swish
[2023-07-21 19:48:06] [config] transformer-aan-depth: 2
[2023-07-21 19:48:06] [config] transformer-aan-nogate: false
[2023-07-21 19:48:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 19:48:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 19:48:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 19:48:06] [config] transformer-depth-scaling: false
[2023-07-21 19:48:06] [config] transformer-dim-aan: 2048
[2023-07-21 19:48:06] [config] transformer-dim-ffn: 2048
[2023-07-21 19:48:06] [config] transformer-dropout: 0
[2023-07-21 19:48:06] [config] transformer-dropout-attention: 0
[2023-07-21 19:48:06] [config] transformer-dropout-ffn: 0
[2023-07-21 19:48:06] [config] transformer-ffn-activation: swish
[2023-07-21 19:48:06] [config] transformer-ffn-depth: 2
[2023-07-21 19:48:06] [config] transformer-guided-alignment-layer: last
[2023-07-21 19:48:06] [config] transformer-heads: 8
[2023-07-21 19:48:06] [config] transformer-no-projection: false
[2023-07-21 19:48:06] [config] transformer-pool: false
[2023-07-21 19:48:06] [config] transformer-postprocess: dan
[2023-07-21 19:48:06] [config] transformer-postprocess-emb: d
[2023-07-21 19:48:06] [config] transformer-postprocess-top: ""
[2023-07-21 19:48:06] [config] transformer-preprocess: ""
[2023-07-21 19:48:06] [config] transformer-tied-layers:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] transformer-train-position-embeddings: false
[2023-07-21 19:48:06] [config] tsv: false
[2023-07-21 19:48:06] [config] tsv-fields: 0
[2023-07-21 19:48:06] [config] type: amun
[2023-07-21 19:48:06] [config] ulr: false
[2023-07-21 19:48:06] [config] ulr-dim-emb: 0
[2023-07-21 19:48:06] [config] ulr-dropout: 0
[2023-07-21 19:48:06] [config] ulr-keys-vectors: ""
[2023-07-21 19:48:06] [config] ulr-query-vectors: ""
[2023-07-21 19:48:06] [config] ulr-softmax-temperature: 1
[2023-07-21 19:48:06] [config] ulr-trainable-transformation: false
[2023-07-21 19:48:06] [config] unlikelihood-loss: false
[2023-07-21 19:48:06] [config] valid-freq: 50000000
[2023-07-21 19:48:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 19:48:06] [config] valid-max-length: 1000
[2023-07-21 19:48:06] [config] valid-metrics:
[2023-07-21 19:48:06] [config]   - cross-entropy
[2023-07-21 19:48:06] [config]   - translation
[2023-07-21 19:48:06] [config] valid-mini-batch: 32
[2023-07-21 19:48:06] [config] valid-reset-stalled: false
[2023-07-21 19:48:06] [config] valid-script-args:
[2023-07-21 19:48:06] [config]   []
[2023-07-21 19:48:06] [config] valid-script-path: ""
[2023-07-21 19:48:06] [config] valid-sets:
[2023-07-21 19:48:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 19:48:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 19:48:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 19:48:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 19:48:06] [config] vocabs:
[2023-07-21 19:48:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 19:48:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 19:48:06] [config] word-penalty: 0
[2023-07-21 19:48:06] [config] word-scores: false
[2023-07-21 19:48:06] [config] workspace: 5500
[2023-07-21 19:48:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 19:48:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:48:06] [training] Using single-device training
[2023-07-21 19:48:07] Synced seed 1234
[2023-07-21 19:48:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 19:48:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 19:48:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 19:48:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 19:48:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 19:48:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:48:07] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 19:48:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:48:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:48:08] [comm] Using global sharding
[2023-07-21 19:48:08] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:48:08] [training] Using 1 GPUs
[2023-07-21 19:48:08] [logits] Applying loss function for 1 factor(s)
[2023-07-21 19:48:08] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:48:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 19:48:09] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:54:12] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 19:54:12] [valid] No post-processing script given for validating translator
[2023-07-21 19:54:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:54:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:54:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:54:12] [comm] Using global sharding
[2023-07-21 19:54:12] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:54:12] [training] Using 1 GPUs
[2023-07-21 19:54:12] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 19:54:13] Allocating memory for general optimizer shards
[2023-07-21 19:54:13] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:54:13] Loading Adam parameters
[2023-07-21 19:54:14] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:54:14] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:54:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 19:54:14] [data] Restoring the corpus state to epoch 31, batch 960
[2023-07-21 19:54:14] [data] Shuffling data
[2023-07-21 19:54:14] [data] Done reading 20,192 sentences
[2023-07-21 19:54:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:54:14] Training started
[2023-07-21 19:54:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 19:54:15] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:54:21] Parameter type float16, optimization type float32, casting types true
[2023-07-21 19:57:33] Seen 20,192 samples
[2023-07-21 19:57:33] Starting data epoch 32 in logical epoch 32
[2023-07-21 19:57:33] [data] Shuffling data
[2023-07-21 19:57:33] [data] Done reading 20,192 sentences
[2023-07-21 19:57:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:58:24] Ep. 32 : Up. 1000 : Sen. 5,130 : Cost 6.99091244 * 16,029,691 @ 3,264 after 16,029,691 : Time 252.01s : 63608.58 words/s : gNorm 1.1448
[2023-07-21 20:01:05] Seen 20,192 samples
[2023-07-21 20:01:05] Starting data epoch 33 in logical epoch 33
[2023-07-21 20:01:05] [data] Shuffling data
[2023-07-21 20:01:05] [data] Done reading 20,192 sentences
[2023-07-21 20:01:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:04:31] Seen 20,192 samples
[2023-07-21 20:04:31] Starting data epoch 34 in logical epoch 34
[2023-07-21 20:04:31] [data] Shuffling data
[2023-07-21 20:04:31] [data] Done reading 20,192 sentences
[2023-07-21 20:04:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:08:10] Seen 20,192 samples
[2023-07-21 20:08:10] Starting data epoch 35 in logical epoch 35
[2023-07-21 20:08:10] [data] Shuffling data
[2023-07-21 20:08:10] [data] Done reading 20,192 sentences
[2023-07-21 20:08:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:11:41] Seen 20,192 samples
[2023-07-21 20:11:41] Starting data epoch 36 in logical epoch 36
[2023-07-21 20:11:41] [data] Shuffling data
[2023-07-21 20:11:41] [data] Done reading 20,192 sentences
[2023-07-21 20:11:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:15:06] Seen 20,192 samples
[2023-07-21 20:15:06] Starting data epoch 37 in logical epoch 37
[2023-07-21 20:15:06] [data] Shuffling data
[2023-07-21 20:15:06] [data] Done reading 20,192 sentences
[2023-07-21 20:15:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:18:35] Seen 20,192 samples
[2023-07-21 20:18:35] Starting data epoch 38 in logical epoch 38
[2023-07-21 20:18:35] [data] Shuffling data
[2023-07-21 20:18:35] [data] Done reading 20,192 sentences
[2023-07-21 20:18:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:22:02] Seen 20,192 samples
[2023-07-21 20:22:02] Starting data epoch 39 in logical epoch 39
[2023-07-21 20:22:02] [data] Shuffling data
[2023-07-21 20:22:02] [data] Done reading 20,192 sentences
[2023-07-21 20:22:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:25:22] Seen 20,192 samples
[2023-07-21 20:25:22] Starting data epoch 40 in logical epoch 40
[2023-07-21 20:25:22] [data] Shuffling data
[2023-07-21 20:25:22] [data] Done reading 20,192 sentences
[2023-07-21 20:25:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:28:49] Seen 20,192 samples
[2023-07-21 20:28:49] Starting data epoch 41 in logical epoch 41
[2023-07-21 20:28:49] Training finished
[2023-07-21 20:29:05] [valid] Ep. 41 : Up. 1280 : cross-entropy : 162.572 : new best
[2023-07-21 20:34:12] [valid] Ep. 41 : Up. 1280 : translation : 0 : new best
[2023-07-21 20:34:12] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 20:34:14] Saving Adam parameters
[2023-07-21 20:34:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 20:34:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:34:21] [marian] Running on node23.datos.cluster.uy as process 18289 with command line:
[2023-07-21 20:34:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 20:34:21] [config] after: 0e
[2023-07-21 20:34:21] [config] after-batches: 0
[2023-07-21 20:34:21] [config] after-epochs: 50
[2023-07-21 20:34:21] [config] all-caps-every: 0
[2023-07-21 20:34:21] [config] allow-unk: false
[2023-07-21 20:34:21] [config] authors: false
[2023-07-21 20:34:21] [config] beam-size: 12
[2023-07-21 20:34:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 20:34:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 20:34:21] [config] bert-masking-fraction: 0.15
[2023-07-21 20:34:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 20:34:21] [config] bert-train-type-embeddings: true
[2023-07-21 20:34:21] [config] bert-type-vocab-size: 2
[2023-07-21 20:34:21] [config] build-info: ""
[2023-07-21 20:34:21] [config] check-gradient-nan: false
[2023-07-21 20:34:21] [config] check-nan: false
[2023-07-21 20:34:21] [config] cite: false
[2023-07-21 20:34:21] [config] clip-norm: 1
[2023-07-21 20:34:21] [config] cost-scaling:
[2023-07-21 20:34:21] [config]   - 256.f
[2023-07-21 20:34:21] [config]   - 1000
[2023-07-21 20:34:21] [config]   - 2.f
[2023-07-21 20:34:21] [config]   - 256.f
[2023-07-21 20:34:21] [config] cost-type: ce-sum
[2023-07-21 20:34:21] [config] cpu-threads: 0
[2023-07-21 20:34:21] [config] data-threads: 8
[2023-07-21 20:34:21] [config] data-weighting: ""
[2023-07-21 20:34:21] [config] data-weighting-type: sentence
[2023-07-21 20:34:21] [config] dec-cell: gru
[2023-07-21 20:34:21] [config] dec-cell-base-depth: 2
[2023-07-21 20:34:21] [config] dec-cell-high-depth: 1
[2023-07-21 20:34:21] [config] dec-depth: 1
[2023-07-21 20:34:21] [config] devices:
[2023-07-21 20:34:21] [config]   - 0
[2023-07-21 20:34:21] [config] dim-emb: 512
[2023-07-21 20:34:21] [config] dim-rnn: 1024
[2023-07-21 20:34:21] [config] dim-vocabs:
[2023-07-21 20:34:21] [config]   - 16384
[2023-07-21 20:34:21] [config]   - 16384
[2023-07-21 20:34:21] [config] disp-first: 0
[2023-07-21 20:34:21] [config] disp-freq: 1000u
[2023-07-21 20:34:21] [config] disp-label-counts: true
[2023-07-21 20:34:21] [config] dropout-rnn: 0.5
[2023-07-21 20:34:21] [config] dropout-src: 0
[2023-07-21 20:34:21] [config] dropout-trg: 0
[2023-07-21 20:34:21] [config] dump-config: ""
[2023-07-21 20:34:21] [config] dynamic-gradient-scaling:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] early-stopping: 200
[2023-07-21 20:34:21] [config] early-stopping-on: first
[2023-07-21 20:34:21] [config] embedding-fix-src: false
[2023-07-21 20:34:21] [config] embedding-fix-trg: false
[2023-07-21 20:34:21] [config] embedding-normalization: false
[2023-07-21 20:34:21] [config] embedding-vectors:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] enc-cell: gru
[2023-07-21 20:34:21] [config] enc-cell-depth: 1
[2023-07-21 20:34:21] [config] enc-depth: 1
[2023-07-21 20:34:21] [config] enc-type: bidirectional
[2023-07-21 20:34:21] [config] english-title-case-every: 0
[2023-07-21 20:34:21] [config] exponential-smoothing: 0
[2023-07-21 20:34:21] [config] factor-weight: 1
[2023-07-21 20:34:21] [config] factors-combine: sum
[2023-07-21 20:34:21] [config] factors-dim-emb: 0
[2023-07-21 20:34:21] [config] gradient-checkpointing: false
[2023-07-21 20:34:21] [config] gradient-norm-average-window: 100
[2023-07-21 20:34:21] [config] guided-alignment: none
[2023-07-21 20:34:21] [config] guided-alignment-cost: mse
[2023-07-21 20:34:21] [config] guided-alignment-weight: 0.1
[2023-07-21 20:34:21] [config] ignore-model-config: false
[2023-07-21 20:34:21] [config] input-types:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] interpolate-env-vars: false
[2023-07-21 20:34:21] [config] keep-best: false
[2023-07-21 20:34:21] [config] label-smoothing: 0
[2023-07-21 20:34:21] [config] layer-normalization: false
[2023-07-21 20:34:21] [config] learn-rate: 0.0001
[2023-07-21 20:34:21] [config] lemma-dependency: ""
[2023-07-21 20:34:21] [config] lemma-dim-emb: 0
[2023-07-21 20:34:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 20:34:21] [config] log-level: info
[2023-07-21 20:34:21] [config] log-time-zone: ""
[2023-07-21 20:34:21] [config] logical-epoch:
[2023-07-21 20:34:21] [config]   - 1e
[2023-07-21 20:34:21] [config]   - 0
[2023-07-21 20:34:21] [config] lr-decay: 0
[2023-07-21 20:34:21] [config] lr-decay-freq: 50000
[2023-07-21 20:34:21] [config] lr-decay-inv-sqrt:
[2023-07-21 20:34:21] [config]   - 0
[2023-07-21 20:34:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 20:34:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 20:34:21] [config] lr-decay-start:
[2023-07-21 20:34:21] [config]   - 10
[2023-07-21 20:34:21] [config]   - 1
[2023-07-21 20:34:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 20:34:21] [config] lr-report: false
[2023-07-21 20:34:21] [config] lr-warmup: 0
[2023-07-21 20:34:21] [config] lr-warmup-at-reload: false
[2023-07-21 20:34:21] [config] lr-warmup-cycle: false
[2023-07-21 20:34:21] [config] lr-warmup-start-rate: 0
[2023-07-21 20:34:21] [config] max-length: 50
[2023-07-21 20:34:21] [config] max-length-crop: true
[2023-07-21 20:34:21] [config] max-length-factor: 3
[2023-07-21 20:34:21] [config] maxi-batch: 100
[2023-07-21 20:34:21] [config] maxi-batch-sort: trg
[2023-07-21 20:34:21] [config] mini-batch: 64
[2023-07-21 20:34:21] [config] mini-batch-fit: true
[2023-07-21 20:34:21] [config] mini-batch-fit-step: 10
[2023-07-21 20:34:21] [config] mini-batch-round-up: true
[2023-07-21 20:34:21] [config] mini-batch-track-lr: false
[2023-07-21 20:34:21] [config] mini-batch-warmup: 0
[2023-07-21 20:34:21] [config] mini-batch-words: 0
[2023-07-21 20:34:21] [config] mini-batch-words-ref: 0
[2023-07-21 20:34:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 20:34:21] [config] multi-loss-type: sum
[2023-07-21 20:34:21] [config] n-best: false
[2023-07-21 20:34:21] [config] no-nccl: false
[2023-07-21 20:34:21] [config] no-reload: false
[2023-07-21 20:34:21] [config] no-restore-corpus: false
[2023-07-21 20:34:21] [config] normalize: 0
[2023-07-21 20:34:21] [config] normalize-gradient: false
[2023-07-21 20:34:21] [config] num-devices: 0
[2023-07-21 20:34:21] [config] optimizer: adam
[2023-07-21 20:34:21] [config] optimizer-delay: 1
[2023-07-21 20:34:21] [config] optimizer-params:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] output-omit-bias: false
[2023-07-21 20:34:21] [config] overwrite: true
[2023-07-21 20:34:21] [config] precision:
[2023-07-21 20:34:21] [config]   - float16
[2023-07-21 20:34:21] [config]   - float32
[2023-07-21 20:34:21] [config] pretrained-model: ""
[2023-07-21 20:34:21] [config] quantize-biases: false
[2023-07-21 20:34:21] [config] quantize-bits: 0
[2023-07-21 20:34:21] [config] quantize-log-based: false
[2023-07-21 20:34:21] [config] quantize-optimization-steps: 0
[2023-07-21 20:34:21] [config] quiet: false
[2023-07-21 20:34:21] [config] quiet-translation: true
[2023-07-21 20:34:21] [config] relative-paths: false
[2023-07-21 20:34:21] [config] right-left: false
[2023-07-21 20:34:21] [config] save-freq: 10000u
[2023-07-21 20:34:21] [config] seed: 1234
[2023-07-21 20:34:21] [config] sentencepiece-alphas:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 20:34:21] [config] sentencepiece-options: ""
[2023-07-21 20:34:21] [config] sharding: global
[2023-07-21 20:34:21] [config] shuffle: data
[2023-07-21 20:34:21] [config] shuffle-in-ram: false
[2023-07-21 20:34:21] [config] sigterm: save-and-exit
[2023-07-21 20:34:21] [config] skip: false
[2023-07-21 20:34:21] [config] sqlite: ""
[2023-07-21 20:34:21] [config] sqlite-drop: false
[2023-07-21 20:34:21] [config] sync-freq: 200u
[2023-07-21 20:34:21] [config] sync-sgd: false
[2023-07-21 20:34:21] [config] tempdir: /tmp
[2023-07-21 20:34:21] [config] tied-embeddings: false
[2023-07-21 20:34:21] [config] tied-embeddings-all: true
[2023-07-21 20:34:21] [config] tied-embeddings-src: false
[2023-07-21 20:34:21] [config] train-embedder-rank:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] train-sets:
[2023-07-21 20:34:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 20:34:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 20:34:21] [config] transformer-aan-activation: swish
[2023-07-21 20:34:21] [config] transformer-aan-depth: 2
[2023-07-21 20:34:21] [config] transformer-aan-nogate: false
[2023-07-21 20:34:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 20:34:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 20:34:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 20:34:21] [config] transformer-depth-scaling: false
[2023-07-21 20:34:21] [config] transformer-dim-aan: 2048
[2023-07-21 20:34:21] [config] transformer-dim-ffn: 2048
[2023-07-21 20:34:21] [config] transformer-dropout: 0
[2023-07-21 20:34:21] [config] transformer-dropout-attention: 0
[2023-07-21 20:34:21] [config] transformer-dropout-ffn: 0
[2023-07-21 20:34:21] [config] transformer-ffn-activation: swish
[2023-07-21 20:34:21] [config] transformer-ffn-depth: 2
[2023-07-21 20:34:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 20:34:21] [config] transformer-heads: 8
[2023-07-21 20:34:21] [config] transformer-no-projection: false
[2023-07-21 20:34:21] [config] transformer-pool: false
[2023-07-21 20:34:21] [config] transformer-postprocess: dan
[2023-07-21 20:34:21] [config] transformer-postprocess-emb: d
[2023-07-21 20:34:21] [config] transformer-postprocess-top: ""
[2023-07-21 20:34:21] [config] transformer-preprocess: ""
[2023-07-21 20:34:21] [config] transformer-tied-layers:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] transformer-train-position-embeddings: false
[2023-07-21 20:34:21] [config] tsv: false
[2023-07-21 20:34:21] [config] tsv-fields: 0
[2023-07-21 20:34:21] [config] type: amun
[2023-07-21 20:34:21] [config] ulr: false
[2023-07-21 20:34:21] [config] ulr-dim-emb: 0
[2023-07-21 20:34:21] [config] ulr-dropout: 0
[2023-07-21 20:34:21] [config] ulr-keys-vectors: ""
[2023-07-21 20:34:21] [config] ulr-query-vectors: ""
[2023-07-21 20:34:21] [config] ulr-softmax-temperature: 1
[2023-07-21 20:34:21] [config] ulr-trainable-transformation: false
[2023-07-21 20:34:21] [config] unlikelihood-loss: false
[2023-07-21 20:34:21] [config] valid-freq: 50000000
[2023-07-21 20:34:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 20:34:21] [config] valid-max-length: 1000
[2023-07-21 20:34:21] [config] valid-metrics:
[2023-07-21 20:34:21] [config]   - cross-entropy
[2023-07-21 20:34:21] [config]   - translation
[2023-07-21 20:34:21] [config] valid-mini-batch: 32
[2023-07-21 20:34:21] [config] valid-reset-stalled: false
[2023-07-21 20:34:21] [config] valid-script-args:
[2023-07-21 20:34:21] [config]   []
[2023-07-21 20:34:21] [config] valid-script-path: ""
[2023-07-21 20:34:21] [config] valid-sets:
[2023-07-21 20:34:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 20:34:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 20:34:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 20:34:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:34:21] [config] vocabs:
[2023-07-21 20:34:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:34:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:34:21] [config] word-penalty: 0
[2023-07-21 20:34:21] [config] word-scores: false
[2023-07-21 20:34:21] [config] workspace: 5500
[2023-07-21 20:34:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:34:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:34:21] [training] Using single-device training
[2023-07-21 20:34:22] Synced seed 1234
[2023-07-21 20:34:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:34:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 20:34:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:34:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 20:34:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 20:34:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:34:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 20:34:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 20:34:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 20:34:23] [comm] Using global sharding
[2023-07-21 20:34:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 20:34:23] [training] Using 1 GPUs
[2023-07-21 20:34:23] [logits] Applying loss function for 1 factor(s)
[2023-07-21 20:34:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:34:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 20:34:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:40:46] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 20:40:46] [valid] No post-processing script given for validating translator
[2023-07-21 20:40:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:40:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 20:40:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 20:40:46] [comm] Using global sharding
[2023-07-21 20:40:47] [comm] NCCLCommunicators constructed successfully
[2023-07-21 20:40:47] [training] Using 1 GPUs
[2023-07-21 20:40:47] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 20:40:48] Allocating memory for general optimizer shards
[2023-07-21 20:40:48] [memory] Reserving 322 MB, device gpu0
[2023-07-21 20:40:48] Loading Adam parameters
[2023-07-21 20:40:48] [memory] Reserving 322 MB, device gpu0
[2023-07-21 20:40:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:40:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 20:40:48] [data] Restoring the corpus state to epoch 41, batch 1280
[2023-07-21 20:40:48] [data] Shuffling data
[2023-07-21 20:40:48] [data] Done reading 20,192 sentences
[2023-07-21 20:40:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:40:48] Training started
[2023-07-21 20:40:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 20:40:50] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:41:02] Parameter type float16, optimization type float32, casting types true
[2023-07-21 20:44:05] Seen 20,192 samples
[2023-07-21 20:44:05] Starting data epoch 42 in logical epoch 42
[2023-07-21 20:44:05] [data] Shuffling data
[2023-07-21 20:44:06] [data] Done reading 20,192 sentences
[2023-07-21 20:44:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:47:29] Seen 20,192 samples
[2023-07-21 20:47:29] Starting data epoch 43 in logical epoch 43
[2023-07-21 20:47:29] [data] Shuffling data
[2023-07-21 20:47:29] [data] Done reading 20,192 sentences
[2023-07-21 20:47:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:50:44] Seen 20,192 samples
[2023-07-21 20:50:44] Starting data epoch 44 in logical epoch 44
[2023-07-21 20:50:44] [data] Shuffling data
[2023-07-21 20:50:44] [data] Done reading 20,192 sentences
[2023-07-21 20:50:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:53:55] Seen 20,192 samples
[2023-07-21 20:53:55] Starting data epoch 45 in logical epoch 45
[2023-07-21 20:53:55] [data] Shuffling data
[2023-07-21 20:53:55] [data] Done reading 20,192 sentences
[2023-07-21 20:53:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:57:17] Seen 20,192 samples
[2023-07-21 20:57:17] Starting data epoch 46 in logical epoch 46
[2023-07-21 20:57:17] [data] Shuffling data
[2023-07-21 20:57:17] [data] Done reading 20,192 sentences
[2023-07-21 20:57:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:00:40] Seen 20,192 samples
[2023-07-21 21:00:40] Starting data epoch 47 in logical epoch 47
[2023-07-21 21:00:40] [data] Shuffling data
[2023-07-21 21:00:40] [data] Done reading 20,192 sentences
[2023-07-21 21:00:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:04:10] Seen 20,192 samples
[2023-07-21 21:04:10] Starting data epoch 48 in logical epoch 48
[2023-07-21 21:04:10] [data] Shuffling data
[2023-07-21 21:04:10] [data] Done reading 20,192 sentences
[2023-07-21 21:04:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:07:36] Seen 20,192 samples
[2023-07-21 21:07:36] Starting data epoch 49 in logical epoch 49
[2023-07-21 21:07:36] [data] Shuffling data
[2023-07-21 21:07:36] [data] Done reading 20,192 sentences
[2023-07-21 21:07:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:11:07] Seen 20,192 samples
[2023-07-21 21:11:07] Starting data epoch 50 in logical epoch 50
[2023-07-21 21:11:07] [data] Shuffling data
[2023-07-21 21:11:07] [data] Done reading 20,192 sentences
[2023-07-21 21:11:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:14:42] Seen 20,192 samples
[2023-07-21 21:14:42] Starting data epoch 51 in logical epoch 51
[2023-07-21 21:14:42] Training finished
[2023-07-21 21:14:55] [valid] Ep. 51 : Up. 1600 : cross-entropy : 157.081 : new best
[2023-07-21 21:17:21] [valid] Ep. 51 : Up. 1600 : translation : 0 : new best
[2023-07-21 21:17:21] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 21:17:23] Saving Adam parameters
[2023-07-21 21:17:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 21:17:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 21:17:31] [marian] Running on node23.datos.cluster.uy as process 20956 with command line:
[2023-07-21 21:17:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 21:17:31] [config] after: 0e
[2023-07-21 21:17:31] [config] after-batches: 0
[2023-07-21 21:17:31] [config] after-epochs: 60
[2023-07-21 21:17:31] [config] all-caps-every: 0
[2023-07-21 21:17:31] [config] allow-unk: false
[2023-07-21 21:17:31] [config] authors: false
[2023-07-21 21:17:31] [config] beam-size: 12
[2023-07-21 21:17:31] [config] bert-class-symbol: "[CLS]"
[2023-07-21 21:17:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 21:17:31] [config] bert-masking-fraction: 0.15
[2023-07-21 21:17:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 21:17:31] [config] bert-train-type-embeddings: true
[2023-07-21 21:17:31] [config] bert-type-vocab-size: 2
[2023-07-21 21:17:31] [config] build-info: ""
[2023-07-21 21:17:31] [config] check-gradient-nan: false
[2023-07-21 21:17:31] [config] check-nan: false
[2023-07-21 21:17:31] [config] cite: false
[2023-07-21 21:17:31] [config] clip-norm: 1
[2023-07-21 21:17:31] [config] cost-scaling:
[2023-07-21 21:17:31] [config]   - 256.f
[2023-07-21 21:17:31] [config]   - 1000
[2023-07-21 21:17:31] [config]   - 2.f
[2023-07-21 21:17:31] [config]   - 256.f
[2023-07-21 21:17:31] [config] cost-type: ce-sum
[2023-07-21 21:17:31] [config] cpu-threads: 0
[2023-07-21 21:17:31] [config] data-threads: 8
[2023-07-21 21:17:31] [config] data-weighting: ""
[2023-07-21 21:17:31] [config] data-weighting-type: sentence
[2023-07-21 21:17:31] [config] dec-cell: gru
[2023-07-21 21:17:31] [config] dec-cell-base-depth: 2
[2023-07-21 21:17:31] [config] dec-cell-high-depth: 1
[2023-07-21 21:17:31] [config] dec-depth: 1
[2023-07-21 21:17:31] [config] devices:
[2023-07-21 21:17:31] [config]   - 0
[2023-07-21 21:17:31] [config] dim-emb: 512
[2023-07-21 21:17:31] [config] dim-rnn: 1024
[2023-07-21 21:17:31] [config] dim-vocabs:
[2023-07-21 21:17:31] [config]   - 16384
[2023-07-21 21:17:31] [config]   - 16384
[2023-07-21 21:17:31] [config] disp-first: 0
[2023-07-21 21:17:31] [config] disp-freq: 1000u
[2023-07-21 21:17:31] [config] disp-label-counts: true
[2023-07-21 21:17:31] [config] dropout-rnn: 0.5
[2023-07-21 21:17:31] [config] dropout-src: 0
[2023-07-21 21:17:31] [config] dropout-trg: 0
[2023-07-21 21:17:31] [config] dump-config: ""
[2023-07-21 21:17:31] [config] dynamic-gradient-scaling:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] early-stopping: 200
[2023-07-21 21:17:31] [config] early-stopping-on: first
[2023-07-21 21:17:31] [config] embedding-fix-src: false
[2023-07-21 21:17:31] [config] embedding-fix-trg: false
[2023-07-21 21:17:31] [config] embedding-normalization: false
[2023-07-21 21:17:31] [config] embedding-vectors:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] enc-cell: gru
[2023-07-21 21:17:31] [config] enc-cell-depth: 1
[2023-07-21 21:17:31] [config] enc-depth: 1
[2023-07-21 21:17:31] [config] enc-type: bidirectional
[2023-07-21 21:17:31] [config] english-title-case-every: 0
[2023-07-21 21:17:31] [config] exponential-smoothing: 0
[2023-07-21 21:17:31] [config] factor-weight: 1
[2023-07-21 21:17:31] [config] factors-combine: sum
[2023-07-21 21:17:31] [config] factors-dim-emb: 0
[2023-07-21 21:17:31] [config] gradient-checkpointing: false
[2023-07-21 21:17:31] [config] gradient-norm-average-window: 100
[2023-07-21 21:17:31] [config] guided-alignment: none
[2023-07-21 21:17:31] [config] guided-alignment-cost: mse
[2023-07-21 21:17:31] [config] guided-alignment-weight: 0.1
[2023-07-21 21:17:31] [config] ignore-model-config: false
[2023-07-21 21:17:31] [config] input-types:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] interpolate-env-vars: false
[2023-07-21 21:17:31] [config] keep-best: false
[2023-07-21 21:17:31] [config] label-smoothing: 0
[2023-07-21 21:17:31] [config] layer-normalization: false
[2023-07-21 21:17:31] [config] learn-rate: 0.0001
[2023-07-21 21:17:31] [config] lemma-dependency: ""
[2023-07-21 21:17:31] [config] lemma-dim-emb: 0
[2023-07-21 21:17:31] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 21:17:31] [config] log-level: info
[2023-07-21 21:17:31] [config] log-time-zone: ""
[2023-07-21 21:17:31] [config] logical-epoch:
[2023-07-21 21:17:31] [config]   - 1e
[2023-07-21 21:17:31] [config]   - 0
[2023-07-21 21:17:31] [config] lr-decay: 0
[2023-07-21 21:17:31] [config] lr-decay-freq: 50000
[2023-07-21 21:17:31] [config] lr-decay-inv-sqrt:
[2023-07-21 21:17:31] [config]   - 0
[2023-07-21 21:17:31] [config] lr-decay-repeat-warmup: false
[2023-07-21 21:17:31] [config] lr-decay-reset-optimizer: false
[2023-07-21 21:17:31] [config] lr-decay-start:
[2023-07-21 21:17:31] [config]   - 10
[2023-07-21 21:17:31] [config]   - 1
[2023-07-21 21:17:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 21:17:31] [config] lr-report: false
[2023-07-21 21:17:31] [config] lr-warmup: 0
[2023-07-21 21:17:31] [config] lr-warmup-at-reload: false
[2023-07-21 21:17:31] [config] lr-warmup-cycle: false
[2023-07-21 21:17:31] [config] lr-warmup-start-rate: 0
[2023-07-21 21:17:31] [config] max-length: 50
[2023-07-21 21:17:31] [config] max-length-crop: true
[2023-07-21 21:17:31] [config] max-length-factor: 3
[2023-07-21 21:17:31] [config] maxi-batch: 100
[2023-07-21 21:17:31] [config] maxi-batch-sort: trg
[2023-07-21 21:17:31] [config] mini-batch: 64
[2023-07-21 21:17:31] [config] mini-batch-fit: true
[2023-07-21 21:17:31] [config] mini-batch-fit-step: 10
[2023-07-21 21:17:31] [config] mini-batch-round-up: true
[2023-07-21 21:17:31] [config] mini-batch-track-lr: false
[2023-07-21 21:17:31] [config] mini-batch-warmup: 0
[2023-07-21 21:17:31] [config] mini-batch-words: 0
[2023-07-21 21:17:31] [config] mini-batch-words-ref: 0
[2023-07-21 21:17:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 21:17:31] [config] multi-loss-type: sum
[2023-07-21 21:17:31] [config] n-best: false
[2023-07-21 21:17:31] [config] no-nccl: false
[2023-07-21 21:17:31] [config] no-reload: false
[2023-07-21 21:17:31] [config] no-restore-corpus: false
[2023-07-21 21:17:31] [config] normalize: 0
[2023-07-21 21:17:31] [config] normalize-gradient: false
[2023-07-21 21:17:31] [config] num-devices: 0
[2023-07-21 21:17:31] [config] optimizer: adam
[2023-07-21 21:17:31] [config] optimizer-delay: 1
[2023-07-21 21:17:31] [config] optimizer-params:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] output-omit-bias: false
[2023-07-21 21:17:31] [config] overwrite: true
[2023-07-21 21:17:31] [config] precision:
[2023-07-21 21:17:31] [config]   - float16
[2023-07-21 21:17:31] [config]   - float32
[2023-07-21 21:17:31] [config] pretrained-model: ""
[2023-07-21 21:17:31] [config] quantize-biases: false
[2023-07-21 21:17:31] [config] quantize-bits: 0
[2023-07-21 21:17:31] [config] quantize-log-based: false
[2023-07-21 21:17:31] [config] quantize-optimization-steps: 0
[2023-07-21 21:17:31] [config] quiet: false
[2023-07-21 21:17:31] [config] quiet-translation: true
[2023-07-21 21:17:31] [config] relative-paths: false
[2023-07-21 21:17:31] [config] right-left: false
[2023-07-21 21:17:31] [config] save-freq: 10000u
[2023-07-21 21:17:31] [config] seed: 1234
[2023-07-21 21:17:31] [config] sentencepiece-alphas:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] sentencepiece-max-lines: 2000000
[2023-07-21 21:17:31] [config] sentencepiece-options: ""
[2023-07-21 21:17:31] [config] sharding: global
[2023-07-21 21:17:31] [config] shuffle: data
[2023-07-21 21:17:31] [config] shuffle-in-ram: false
[2023-07-21 21:17:31] [config] sigterm: save-and-exit
[2023-07-21 21:17:31] [config] skip: false
[2023-07-21 21:17:31] [config] sqlite: ""
[2023-07-21 21:17:31] [config] sqlite-drop: false
[2023-07-21 21:17:31] [config] sync-freq: 200u
[2023-07-21 21:17:31] [config] sync-sgd: false
[2023-07-21 21:17:31] [config] tempdir: /tmp
[2023-07-21 21:17:31] [config] tied-embeddings: false
[2023-07-21 21:17:31] [config] tied-embeddings-all: true
[2023-07-21 21:17:31] [config] tied-embeddings-src: false
[2023-07-21 21:17:31] [config] train-embedder-rank:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] train-sets:
[2023-07-21 21:17:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 21:17:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 21:17:31] [config] transformer-aan-activation: swish
[2023-07-21 21:17:31] [config] transformer-aan-depth: 2
[2023-07-21 21:17:31] [config] transformer-aan-nogate: false
[2023-07-21 21:17:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 21:17:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 21:17:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 21:17:31] [config] transformer-depth-scaling: false
[2023-07-21 21:17:31] [config] transformer-dim-aan: 2048
[2023-07-21 21:17:31] [config] transformer-dim-ffn: 2048
[2023-07-21 21:17:31] [config] transformer-dropout: 0
[2023-07-21 21:17:31] [config] transformer-dropout-attention: 0
[2023-07-21 21:17:31] [config] transformer-dropout-ffn: 0
[2023-07-21 21:17:31] [config] transformer-ffn-activation: swish
[2023-07-21 21:17:31] [config] transformer-ffn-depth: 2
[2023-07-21 21:17:31] [config] transformer-guided-alignment-layer: last
[2023-07-21 21:17:31] [config] transformer-heads: 8
[2023-07-21 21:17:31] [config] transformer-no-projection: false
[2023-07-21 21:17:31] [config] transformer-pool: false
[2023-07-21 21:17:31] [config] transformer-postprocess: dan
[2023-07-21 21:17:31] [config] transformer-postprocess-emb: d
[2023-07-21 21:17:31] [config] transformer-postprocess-top: ""
[2023-07-21 21:17:31] [config] transformer-preprocess: ""
[2023-07-21 21:17:31] [config] transformer-tied-layers:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] transformer-train-position-embeddings: false
[2023-07-21 21:17:31] [config] tsv: false
[2023-07-21 21:17:31] [config] tsv-fields: 0
[2023-07-21 21:17:31] [config] type: amun
[2023-07-21 21:17:31] [config] ulr: false
[2023-07-21 21:17:31] [config] ulr-dim-emb: 0
[2023-07-21 21:17:31] [config] ulr-dropout: 0
[2023-07-21 21:17:31] [config] ulr-keys-vectors: ""
[2023-07-21 21:17:31] [config] ulr-query-vectors: ""
[2023-07-21 21:17:31] [config] ulr-softmax-temperature: 1
[2023-07-21 21:17:31] [config] ulr-trainable-transformation: false
[2023-07-21 21:17:31] [config] unlikelihood-loss: false
[2023-07-21 21:17:31] [config] valid-freq: 50000000
[2023-07-21 21:17:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 21:17:31] [config] valid-max-length: 1000
[2023-07-21 21:17:31] [config] valid-metrics:
[2023-07-21 21:17:31] [config]   - cross-entropy
[2023-07-21 21:17:31] [config]   - translation
[2023-07-21 21:17:31] [config] valid-mini-batch: 32
[2023-07-21 21:17:31] [config] valid-reset-stalled: false
[2023-07-21 21:17:31] [config] valid-script-args:
[2023-07-21 21:17:31] [config]   []
[2023-07-21 21:17:31] [config] valid-script-path: ""
[2023-07-21 21:17:31] [config] valid-sets:
[2023-07-21 21:17:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 21:17:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 21:17:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 21:17:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 21:17:31] [config] vocabs:
[2023-07-21 21:17:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 21:17:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 21:17:31] [config] word-penalty: 0
[2023-07-21 21:17:31] [config] word-scores: false
[2023-07-21 21:17:31] [config] workspace: 5500
[2023-07-21 21:17:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 21:17:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:17:31] [training] Using single-device training
[2023-07-21 21:17:31] Synced seed 1234
[2023-07-21 21:17:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 21:17:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 21:17:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 21:17:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 21:17:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 21:17:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:17:31] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 21:17:32] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 21:17:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 21:17:33] [comm] Using global sharding
[2023-07-21 21:17:33] [comm] NCCLCommunicators constructed successfully
[2023-07-21 21:17:33] [training] Using 1 GPUs
[2023-07-21 21:17:33] [logits] Applying loss function for 1 factor(s)
[2023-07-21 21:17:33] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:17:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 21:17:33] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:23:49] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 21:23:49] [valid] No post-processing script given for validating translator
[2023-07-21 21:23:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:23:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 21:23:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 21:23:49] [comm] Using global sharding
[2023-07-21 21:23:49] [comm] NCCLCommunicators constructed successfully
[2023-07-21 21:23:49] [training] Using 1 GPUs
[2023-07-21 21:23:49] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 21:23:53] Allocating memory for general optimizer shards
[2023-07-21 21:23:53] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:23:53] Loading Adam parameters
[2023-07-21 21:23:53] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:23:53] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:23:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 21:23:53] [data] Restoring the corpus state to epoch 51, batch 1600
[2023-07-21 21:23:53] [data] Shuffling data
[2023-07-21 21:23:53] [data] Done reading 20,192 sentences
[2023-07-21 21:23:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:23:53] Training started
[2023-07-21 21:23:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 21:23:54] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:23:57] Parameter type float16, optimization type float32, casting types true
[2023-07-21 21:27:13] Seen 20,192 samples
[2023-07-21 21:27:13] Starting data epoch 52 in logical epoch 52
[2023-07-21 21:27:13] [data] Shuffling data
[2023-07-21 21:27:13] [data] Done reading 20,192 sentences
[2023-07-21 21:27:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:30:42] Seen 20,192 samples
[2023-07-21 21:30:42] Starting data epoch 53 in logical epoch 53
[2023-07-21 21:30:42] [data] Shuffling data
[2023-07-21 21:30:42] [data] Done reading 20,192 sentences
[2023-07-21 21:30:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:34:10] Seen 20,192 samples
[2023-07-21 21:34:10] Starting data epoch 54 in logical epoch 54
[2023-07-21 21:34:10] [data] Shuffling data
[2023-07-21 21:34:10] [data] Done reading 20,192 sentences
[2023-07-21 21:34:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:37:39] Seen 20,192 samples
[2023-07-21 21:37:39] Starting data epoch 55 in logical epoch 55
[2023-07-21 21:37:39] [data] Shuffling data
[2023-07-21 21:37:39] [data] Done reading 20,192 sentences
[2023-07-21 21:37:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:41:16] Seen 20,192 samples
[2023-07-21 21:41:16] Starting data epoch 56 in logical epoch 56
[2023-07-21 21:41:16] [data] Shuffling data
[2023-07-21 21:41:16] [data] Done reading 20,192 sentences
[2023-07-21 21:41:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:45:03] Seen 20,192 samples
[2023-07-21 21:45:03] Starting data epoch 57 in logical epoch 57
[2023-07-21 21:45:03] [data] Shuffling data
[2023-07-21 21:45:03] [data] Done reading 20,192 sentences
[2023-07-21 21:45:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:48:46] Seen 20,192 samples
[2023-07-21 21:48:46] Starting data epoch 58 in logical epoch 58
[2023-07-21 21:48:46] [data] Shuffling data
[2023-07-21 21:48:46] [data] Done reading 20,192 sentences
[2023-07-21 21:48:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:52:26] Seen 20,192 samples
[2023-07-21 21:52:26] Starting data epoch 59 in logical epoch 59
[2023-07-21 21:52:26] [data] Shuffling data
[2023-07-21 21:52:26] [data] Done reading 20,192 sentences
[2023-07-21 21:52:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:56:04] Seen 20,192 samples
[2023-07-21 21:56:04] Starting data epoch 60 in logical epoch 60
[2023-07-21 21:56:04] [data] Shuffling data
[2023-07-21 21:56:04] [data] Done reading 20,192 sentences
[2023-07-21 21:56:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:59:48] Seen 20,192 samples
[2023-07-21 21:59:48] Starting data epoch 61 in logical epoch 61
[2023-07-21 21:59:48] Training finished
[2023-07-21 22:00:03] [valid] Ep. 61 : Up. 1920 : cross-entropy : 154.084 : new best
[2023-07-21 22:05:45] [valid] Ep. 61 : Up. 1920 : translation : 0 : new best
[2023-07-21 22:05:45] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 22:05:48] Saving Adam parameters
[2023-07-21 22:05:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 22:05:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:05:55] [marian] Running on node23.datos.cluster.uy as process 24208 with command line:
[2023-07-21 22:05:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 22:05:55] [config] after: 0e
[2023-07-21 22:05:55] [config] after-batches: 0
[2023-07-21 22:05:55] [config] after-epochs: 70
[2023-07-21 22:05:55] [config] all-caps-every: 0
[2023-07-21 22:05:55] [config] allow-unk: false
[2023-07-21 22:05:55] [config] authors: false
[2023-07-21 22:05:55] [config] beam-size: 12
[2023-07-21 22:05:55] [config] bert-class-symbol: "[CLS]"
[2023-07-21 22:05:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 22:05:55] [config] bert-masking-fraction: 0.15
[2023-07-21 22:05:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 22:05:55] [config] bert-train-type-embeddings: true
[2023-07-21 22:05:55] [config] bert-type-vocab-size: 2
[2023-07-21 22:05:55] [config] build-info: ""
[2023-07-21 22:05:55] [config] check-gradient-nan: false
[2023-07-21 22:05:55] [config] check-nan: false
[2023-07-21 22:05:55] [config] cite: false
[2023-07-21 22:05:55] [config] clip-norm: 1
[2023-07-21 22:05:55] [config] cost-scaling:
[2023-07-21 22:05:55] [config]   - 256.f
[2023-07-21 22:05:55] [config]   - 1000
[2023-07-21 22:05:55] [config]   - 2.f
[2023-07-21 22:05:55] [config]   - 256.f
[2023-07-21 22:05:55] [config] cost-type: ce-sum
[2023-07-21 22:05:55] [config] cpu-threads: 0
[2023-07-21 22:05:55] [config] data-threads: 8
[2023-07-21 22:05:55] [config] data-weighting: ""
[2023-07-21 22:05:55] [config] data-weighting-type: sentence
[2023-07-21 22:05:55] [config] dec-cell: gru
[2023-07-21 22:05:55] [config] dec-cell-base-depth: 2
[2023-07-21 22:05:55] [config] dec-cell-high-depth: 1
[2023-07-21 22:05:55] [config] dec-depth: 1
[2023-07-21 22:05:55] [config] devices:
[2023-07-21 22:05:55] [config]   - 0
[2023-07-21 22:05:55] [config] dim-emb: 512
[2023-07-21 22:05:55] [config] dim-rnn: 1024
[2023-07-21 22:05:55] [config] dim-vocabs:
[2023-07-21 22:05:55] [config]   - 16384
[2023-07-21 22:05:55] [config]   - 16384
[2023-07-21 22:05:55] [config] disp-first: 0
[2023-07-21 22:05:55] [config] disp-freq: 1000u
[2023-07-21 22:05:55] [config] disp-label-counts: true
[2023-07-21 22:05:55] [config] dropout-rnn: 0.5
[2023-07-21 22:05:55] [config] dropout-src: 0
[2023-07-21 22:05:55] [config] dropout-trg: 0
[2023-07-21 22:05:55] [config] dump-config: ""
[2023-07-21 22:05:55] [config] dynamic-gradient-scaling:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] early-stopping: 200
[2023-07-21 22:05:55] [config] early-stopping-on: first
[2023-07-21 22:05:55] [config] embedding-fix-src: false
[2023-07-21 22:05:55] [config] embedding-fix-trg: false
[2023-07-21 22:05:55] [config] embedding-normalization: false
[2023-07-21 22:05:55] [config] embedding-vectors:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] enc-cell: gru
[2023-07-21 22:05:55] [config] enc-cell-depth: 1
[2023-07-21 22:05:55] [config] enc-depth: 1
[2023-07-21 22:05:55] [config] enc-type: bidirectional
[2023-07-21 22:05:55] [config] english-title-case-every: 0
[2023-07-21 22:05:55] [config] exponential-smoothing: 0
[2023-07-21 22:05:55] [config] factor-weight: 1
[2023-07-21 22:05:55] [config] factors-combine: sum
[2023-07-21 22:05:55] [config] factors-dim-emb: 0
[2023-07-21 22:05:55] [config] gradient-checkpointing: false
[2023-07-21 22:05:55] [config] gradient-norm-average-window: 100
[2023-07-21 22:05:55] [config] guided-alignment: none
[2023-07-21 22:05:55] [config] guided-alignment-cost: mse
[2023-07-21 22:05:55] [config] guided-alignment-weight: 0.1
[2023-07-21 22:05:55] [config] ignore-model-config: false
[2023-07-21 22:05:55] [config] input-types:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] interpolate-env-vars: false
[2023-07-21 22:05:55] [config] keep-best: false
[2023-07-21 22:05:55] [config] label-smoothing: 0
[2023-07-21 22:05:55] [config] layer-normalization: false
[2023-07-21 22:05:55] [config] learn-rate: 0.0001
[2023-07-21 22:05:55] [config] lemma-dependency: ""
[2023-07-21 22:05:55] [config] lemma-dim-emb: 0
[2023-07-21 22:05:55] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 22:05:55] [config] log-level: info
[2023-07-21 22:05:55] [config] log-time-zone: ""
[2023-07-21 22:05:55] [config] logical-epoch:
[2023-07-21 22:05:55] [config]   - 1e
[2023-07-21 22:05:55] [config]   - 0
[2023-07-21 22:05:55] [config] lr-decay: 0
[2023-07-21 22:05:55] [config] lr-decay-freq: 50000
[2023-07-21 22:05:55] [config] lr-decay-inv-sqrt:
[2023-07-21 22:05:55] [config]   - 0
[2023-07-21 22:05:55] [config] lr-decay-repeat-warmup: false
[2023-07-21 22:05:55] [config] lr-decay-reset-optimizer: false
[2023-07-21 22:05:55] [config] lr-decay-start:
[2023-07-21 22:05:55] [config]   - 10
[2023-07-21 22:05:55] [config]   - 1
[2023-07-21 22:05:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 22:05:55] [config] lr-report: false
[2023-07-21 22:05:55] [config] lr-warmup: 0
[2023-07-21 22:05:55] [config] lr-warmup-at-reload: false
[2023-07-21 22:05:55] [config] lr-warmup-cycle: false
[2023-07-21 22:05:55] [config] lr-warmup-start-rate: 0
[2023-07-21 22:05:55] [config] max-length: 50
[2023-07-21 22:05:55] [config] max-length-crop: true
[2023-07-21 22:05:55] [config] max-length-factor: 3
[2023-07-21 22:05:55] [config] maxi-batch: 100
[2023-07-21 22:05:55] [config] maxi-batch-sort: trg
[2023-07-21 22:05:55] [config] mini-batch: 64
[2023-07-21 22:05:55] [config] mini-batch-fit: true
[2023-07-21 22:05:55] [config] mini-batch-fit-step: 10
[2023-07-21 22:05:55] [config] mini-batch-round-up: true
[2023-07-21 22:05:55] [config] mini-batch-track-lr: false
[2023-07-21 22:05:55] [config] mini-batch-warmup: 0
[2023-07-21 22:05:55] [config] mini-batch-words: 0
[2023-07-21 22:05:55] [config] mini-batch-words-ref: 0
[2023-07-21 22:05:55] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 22:05:55] [config] multi-loss-type: sum
[2023-07-21 22:05:55] [config] n-best: false
[2023-07-21 22:05:55] [config] no-nccl: false
[2023-07-21 22:05:55] [config] no-reload: false
[2023-07-21 22:05:55] [config] no-restore-corpus: false
[2023-07-21 22:05:55] [config] normalize: 0
[2023-07-21 22:05:55] [config] normalize-gradient: false
[2023-07-21 22:05:55] [config] num-devices: 0
[2023-07-21 22:05:55] [config] optimizer: adam
[2023-07-21 22:05:55] [config] optimizer-delay: 1
[2023-07-21 22:05:55] [config] optimizer-params:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] output-omit-bias: false
[2023-07-21 22:05:55] [config] overwrite: true
[2023-07-21 22:05:55] [config] precision:
[2023-07-21 22:05:55] [config]   - float16
[2023-07-21 22:05:55] [config]   - float32
[2023-07-21 22:05:55] [config] pretrained-model: ""
[2023-07-21 22:05:55] [config] quantize-biases: false
[2023-07-21 22:05:55] [config] quantize-bits: 0
[2023-07-21 22:05:55] [config] quantize-log-based: false
[2023-07-21 22:05:55] [config] quantize-optimization-steps: 0
[2023-07-21 22:05:55] [config] quiet: false
[2023-07-21 22:05:55] [config] quiet-translation: true
[2023-07-21 22:05:55] [config] relative-paths: false
[2023-07-21 22:05:55] [config] right-left: false
[2023-07-21 22:05:55] [config] save-freq: 10000u
[2023-07-21 22:05:55] [config] seed: 1234
[2023-07-21 22:05:55] [config] sentencepiece-alphas:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] sentencepiece-max-lines: 2000000
[2023-07-21 22:05:55] [config] sentencepiece-options: ""
[2023-07-21 22:05:55] [config] sharding: global
[2023-07-21 22:05:55] [config] shuffle: data
[2023-07-21 22:05:55] [config] shuffle-in-ram: false
[2023-07-21 22:05:55] [config] sigterm: save-and-exit
[2023-07-21 22:05:55] [config] skip: false
[2023-07-21 22:05:55] [config] sqlite: ""
[2023-07-21 22:05:55] [config] sqlite-drop: false
[2023-07-21 22:05:55] [config] sync-freq: 200u
[2023-07-21 22:05:55] [config] sync-sgd: false
[2023-07-21 22:05:55] [config] tempdir: /tmp
[2023-07-21 22:05:55] [config] tied-embeddings: false
[2023-07-21 22:05:55] [config] tied-embeddings-all: true
[2023-07-21 22:05:55] [config] tied-embeddings-src: false
[2023-07-21 22:05:55] [config] train-embedder-rank:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] train-sets:
[2023-07-21 22:05:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 22:05:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 22:05:55] [config] transformer-aan-activation: swish
[2023-07-21 22:05:55] [config] transformer-aan-depth: 2
[2023-07-21 22:05:55] [config] transformer-aan-nogate: false
[2023-07-21 22:05:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 22:05:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 22:05:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 22:05:55] [config] transformer-depth-scaling: false
[2023-07-21 22:05:55] [config] transformer-dim-aan: 2048
[2023-07-21 22:05:55] [config] transformer-dim-ffn: 2048
[2023-07-21 22:05:55] [config] transformer-dropout: 0
[2023-07-21 22:05:55] [config] transformer-dropout-attention: 0
[2023-07-21 22:05:55] [config] transformer-dropout-ffn: 0
[2023-07-21 22:05:55] [config] transformer-ffn-activation: swish
[2023-07-21 22:05:55] [config] transformer-ffn-depth: 2
[2023-07-21 22:05:55] [config] transformer-guided-alignment-layer: last
[2023-07-21 22:05:55] [config] transformer-heads: 8
[2023-07-21 22:05:55] [config] transformer-no-projection: false
[2023-07-21 22:05:55] [config] transformer-pool: false
[2023-07-21 22:05:55] [config] transformer-postprocess: dan
[2023-07-21 22:05:55] [config] transformer-postprocess-emb: d
[2023-07-21 22:05:55] [config] transformer-postprocess-top: ""
[2023-07-21 22:05:55] [config] transformer-preprocess: ""
[2023-07-21 22:05:55] [config] transformer-tied-layers:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] transformer-train-position-embeddings: false
[2023-07-21 22:05:55] [config] tsv: false
[2023-07-21 22:05:55] [config] tsv-fields: 0
[2023-07-21 22:05:55] [config] type: amun
[2023-07-21 22:05:55] [config] ulr: false
[2023-07-21 22:05:55] [config] ulr-dim-emb: 0
[2023-07-21 22:05:55] [config] ulr-dropout: 0
[2023-07-21 22:05:55] [config] ulr-keys-vectors: ""
[2023-07-21 22:05:55] [config] ulr-query-vectors: ""
[2023-07-21 22:05:55] [config] ulr-softmax-temperature: 1
[2023-07-21 22:05:55] [config] ulr-trainable-transformation: false
[2023-07-21 22:05:55] [config] unlikelihood-loss: false
[2023-07-21 22:05:55] [config] valid-freq: 50000000
[2023-07-21 22:05:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 22:05:55] [config] valid-max-length: 1000
[2023-07-21 22:05:55] [config] valid-metrics:
[2023-07-21 22:05:55] [config]   - cross-entropy
[2023-07-21 22:05:55] [config]   - translation
[2023-07-21 22:05:55] [config] valid-mini-batch: 32
[2023-07-21 22:05:55] [config] valid-reset-stalled: false
[2023-07-21 22:05:55] [config] valid-script-args:
[2023-07-21 22:05:55] [config]   []
[2023-07-21 22:05:55] [config] valid-script-path: ""
[2023-07-21 22:05:55] [config] valid-sets:
[2023-07-21 22:05:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 22:05:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 22:05:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 22:05:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:05:55] [config] vocabs:
[2023-07-21 22:05:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:05:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:05:55] [config] word-penalty: 0
[2023-07-21 22:05:55] [config] word-scores: false
[2023-07-21 22:05:55] [config] workspace: 5500
[2023-07-21 22:05:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:05:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:05:55] [training] Using single-device training
[2023-07-21 22:05:56] Synced seed 1234
[2023-07-21 22:05:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:05:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 22:05:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:05:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 22:05:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 22:05:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:05:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 22:05:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 22:05:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 22:05:57] [comm] Using global sharding
[2023-07-21 22:05:57] [comm] NCCLCommunicators constructed successfully
[2023-07-21 22:05:57] [training] Using 1 GPUs
[2023-07-21 22:05:57] [logits] Applying loss function for 1 factor(s)
[2023-07-21 22:05:57] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:05:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 22:05:58] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:12:01] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 22:12:01] [valid] No post-processing script given for validating translator
[2023-07-21 22:12:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:12:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 22:12:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 22:12:01] [comm] Using global sharding
[2023-07-21 22:12:01] [comm] NCCLCommunicators constructed successfully
[2023-07-21 22:12:01] [training] Using 1 GPUs
[2023-07-21 22:12:01] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 22:12:03] Allocating memory for general optimizer shards
[2023-07-21 22:12:03] [memory] Reserving 322 MB, device gpu0
[2023-07-21 22:12:03] Loading Adam parameters
[2023-07-21 22:12:03] [memory] Reserving 322 MB, device gpu0
[2023-07-21 22:12:03] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:12:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 22:12:03] [data] Restoring the corpus state to epoch 61, batch 1920
[2023-07-21 22:12:03] [data] Shuffling data
[2023-07-21 22:12:03] [data] Done reading 20,192 sentences
[2023-07-21 22:12:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:12:03] Training started
[2023-07-21 22:12:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 22:12:04] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:12:08] Parameter type float16, optimization type float32, casting types true
[2023-07-21 22:15:37] Seen 20,192 samples
[2023-07-21 22:15:37] Starting data epoch 62 in logical epoch 62
[2023-07-21 22:15:37] [data] Shuffling data
[2023-07-21 22:15:37] [data] Done reading 20,192 sentences
[2023-07-21 22:15:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:19:14] Seen 20,192 samples
[2023-07-21 22:19:14] Starting data epoch 63 in logical epoch 63
[2023-07-21 22:19:14] [data] Shuffling data
[2023-07-21 22:19:14] [data] Done reading 20,192 sentences
[2023-07-21 22:19:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:21:06] Ep. 63 : Up. 2000 : Sen. 10,210 : Cost 6.02682543 * 16,039,016 @ 19,865 after 32,068,706 : Time 544.40s : 29461.99 words/s : gNorm 0.8994
[2023-07-21 22:22:54] Seen 20,192 samples
[2023-07-21 22:22:54] Starting data epoch 64 in logical epoch 64
[2023-07-21 22:22:54] [data] Shuffling data
[2023-07-21 22:22:54] [data] Done reading 20,192 sentences
[2023-07-21 22:22:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:26:40] Seen 20,192 samples
[2023-07-21 22:26:40] Starting data epoch 65 in logical epoch 65
[2023-07-21 22:26:40] [data] Shuffling data
[2023-07-21 22:26:40] [data] Done reading 20,192 sentences
[2023-07-21 22:26:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:30:26] Seen 20,192 samples
[2023-07-21 22:30:26] Starting data epoch 66 in logical epoch 66
[2023-07-21 22:30:26] [data] Shuffling data
[2023-07-21 22:30:26] [data] Done reading 20,192 sentences
[2023-07-21 22:30:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:34:18] Seen 20,192 samples
[2023-07-21 22:34:18] Starting data epoch 67 in logical epoch 67
[2023-07-21 22:34:18] [data] Shuffling data
[2023-07-21 22:34:18] [data] Done reading 20,192 sentences
[2023-07-21 22:34:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:38:13] Seen 20,192 samples
[2023-07-21 22:38:13] Starting data epoch 68 in logical epoch 68
[2023-07-21 22:38:13] [data] Shuffling data
[2023-07-21 22:38:13] [data] Done reading 20,192 sentences
[2023-07-21 22:38:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:42:01] Seen 20,192 samples
[2023-07-21 22:42:01] Starting data epoch 69 in logical epoch 69
[2023-07-21 22:42:01] [data] Shuffling data
[2023-07-21 22:42:01] [data] Done reading 20,192 sentences
[2023-07-21 22:42:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:45:52] Seen 20,192 samples
[2023-07-21 22:45:52] Starting data epoch 70 in logical epoch 70
[2023-07-21 22:45:52] [data] Shuffling data
[2023-07-21 22:45:52] [data] Done reading 20,192 sentences
[2023-07-21 22:45:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:49:48] Seen 20,192 samples
[2023-07-21 22:49:48] Starting data epoch 71 in logical epoch 71
[2023-07-21 22:49:48] Training finished
[2023-07-21 22:50:00] [valid] Ep. 71 : Up. 2240 : cross-entropy : 149.518 : new best
[2023-07-21 22:56:10] [valid] Ep. 71 : Up. 2240 : translation : 0 : new best
[2023-07-21 22:56:10] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 22:56:13] Saving Adam parameters
[2023-07-21 22:56:13] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 22:56:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:56:20] [marian] Running on node23.datos.cluster.uy as process 27547 with command line:
[2023-07-21 22:56:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 22:56:20] [config] after: 0e
[2023-07-21 22:56:20] [config] after-batches: 0
[2023-07-21 22:56:20] [config] after-epochs: 80
[2023-07-21 22:56:20] [config] all-caps-every: 0
[2023-07-21 22:56:20] [config] allow-unk: false
[2023-07-21 22:56:20] [config] authors: false
[2023-07-21 22:56:20] [config] beam-size: 12
[2023-07-21 22:56:20] [config] bert-class-symbol: "[CLS]"
[2023-07-21 22:56:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 22:56:20] [config] bert-masking-fraction: 0.15
[2023-07-21 22:56:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 22:56:20] [config] bert-train-type-embeddings: true
[2023-07-21 22:56:20] [config] bert-type-vocab-size: 2
[2023-07-21 22:56:20] [config] build-info: ""
[2023-07-21 22:56:20] [config] check-gradient-nan: false
[2023-07-21 22:56:20] [config] check-nan: false
[2023-07-21 22:56:20] [config] cite: false
[2023-07-21 22:56:20] [config] clip-norm: 1
[2023-07-21 22:56:20] [config] cost-scaling:
[2023-07-21 22:56:20] [config]   - 256.f
[2023-07-21 22:56:20] [config]   - 1000
[2023-07-21 22:56:20] [config]   - 2.f
[2023-07-21 22:56:20] [config]   - 256.f
[2023-07-21 22:56:20] [config] cost-type: ce-sum
[2023-07-21 22:56:20] [config] cpu-threads: 0
[2023-07-21 22:56:20] [config] data-threads: 8
[2023-07-21 22:56:20] [config] data-weighting: ""
[2023-07-21 22:56:20] [config] data-weighting-type: sentence
[2023-07-21 22:56:20] [config] dec-cell: gru
[2023-07-21 22:56:20] [config] dec-cell-base-depth: 2
[2023-07-21 22:56:20] [config] dec-cell-high-depth: 1
[2023-07-21 22:56:20] [config] dec-depth: 1
[2023-07-21 22:56:20] [config] devices:
[2023-07-21 22:56:20] [config]   - 0
[2023-07-21 22:56:20] [config] dim-emb: 512
[2023-07-21 22:56:20] [config] dim-rnn: 1024
[2023-07-21 22:56:20] [config] dim-vocabs:
[2023-07-21 22:56:20] [config]   - 16384
[2023-07-21 22:56:20] [config]   - 16384
[2023-07-21 22:56:20] [config] disp-first: 0
[2023-07-21 22:56:20] [config] disp-freq: 1000u
[2023-07-21 22:56:20] [config] disp-label-counts: true
[2023-07-21 22:56:20] [config] dropout-rnn: 0.5
[2023-07-21 22:56:20] [config] dropout-src: 0
[2023-07-21 22:56:20] [config] dropout-trg: 0
[2023-07-21 22:56:20] [config] dump-config: ""
[2023-07-21 22:56:20] [config] dynamic-gradient-scaling:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] early-stopping: 200
[2023-07-21 22:56:20] [config] early-stopping-on: first
[2023-07-21 22:56:20] [config] embedding-fix-src: false
[2023-07-21 22:56:20] [config] embedding-fix-trg: false
[2023-07-21 22:56:20] [config] embedding-normalization: false
[2023-07-21 22:56:20] [config] embedding-vectors:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] enc-cell: gru
[2023-07-21 22:56:20] [config] enc-cell-depth: 1
[2023-07-21 22:56:20] [config] enc-depth: 1
[2023-07-21 22:56:20] [config] enc-type: bidirectional
[2023-07-21 22:56:20] [config] english-title-case-every: 0
[2023-07-21 22:56:20] [config] exponential-smoothing: 0
[2023-07-21 22:56:20] [config] factor-weight: 1
[2023-07-21 22:56:20] [config] factors-combine: sum
[2023-07-21 22:56:20] [config] factors-dim-emb: 0
[2023-07-21 22:56:20] [config] gradient-checkpointing: false
[2023-07-21 22:56:20] [config] gradient-norm-average-window: 100
[2023-07-21 22:56:20] [config] guided-alignment: none
[2023-07-21 22:56:20] [config] guided-alignment-cost: mse
[2023-07-21 22:56:20] [config] guided-alignment-weight: 0.1
[2023-07-21 22:56:20] [config] ignore-model-config: false
[2023-07-21 22:56:20] [config] input-types:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] interpolate-env-vars: false
[2023-07-21 22:56:20] [config] keep-best: false
[2023-07-21 22:56:20] [config] label-smoothing: 0
[2023-07-21 22:56:20] [config] layer-normalization: false
[2023-07-21 22:56:20] [config] learn-rate: 0.0001
[2023-07-21 22:56:20] [config] lemma-dependency: ""
[2023-07-21 22:56:20] [config] lemma-dim-emb: 0
[2023-07-21 22:56:20] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 22:56:20] [config] log-level: info
[2023-07-21 22:56:20] [config] log-time-zone: ""
[2023-07-21 22:56:20] [config] logical-epoch:
[2023-07-21 22:56:20] [config]   - 1e
[2023-07-21 22:56:20] [config]   - 0
[2023-07-21 22:56:20] [config] lr-decay: 0
[2023-07-21 22:56:20] [config] lr-decay-freq: 50000
[2023-07-21 22:56:20] [config] lr-decay-inv-sqrt:
[2023-07-21 22:56:20] [config]   - 0
[2023-07-21 22:56:20] [config] lr-decay-repeat-warmup: false
[2023-07-21 22:56:20] [config] lr-decay-reset-optimizer: false
[2023-07-21 22:56:20] [config] lr-decay-start:
[2023-07-21 22:56:20] [config]   - 10
[2023-07-21 22:56:20] [config]   - 1
[2023-07-21 22:56:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 22:56:20] [config] lr-report: false
[2023-07-21 22:56:20] [config] lr-warmup: 0
[2023-07-21 22:56:20] [config] lr-warmup-at-reload: false
[2023-07-21 22:56:20] [config] lr-warmup-cycle: false
[2023-07-21 22:56:20] [config] lr-warmup-start-rate: 0
[2023-07-21 22:56:20] [config] max-length: 50
[2023-07-21 22:56:20] [config] max-length-crop: true
[2023-07-21 22:56:20] [config] max-length-factor: 3
[2023-07-21 22:56:20] [config] maxi-batch: 100
[2023-07-21 22:56:20] [config] maxi-batch-sort: trg
[2023-07-21 22:56:20] [config] mini-batch: 64
[2023-07-21 22:56:20] [config] mini-batch-fit: true
[2023-07-21 22:56:20] [config] mini-batch-fit-step: 10
[2023-07-21 22:56:20] [config] mini-batch-round-up: true
[2023-07-21 22:56:20] [config] mini-batch-track-lr: false
[2023-07-21 22:56:20] [config] mini-batch-warmup: 0
[2023-07-21 22:56:20] [config] mini-batch-words: 0
[2023-07-21 22:56:20] [config] mini-batch-words-ref: 0
[2023-07-21 22:56:20] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 22:56:20] [config] multi-loss-type: sum
[2023-07-21 22:56:20] [config] n-best: false
[2023-07-21 22:56:20] [config] no-nccl: false
[2023-07-21 22:56:20] [config] no-reload: false
[2023-07-21 22:56:20] [config] no-restore-corpus: false
[2023-07-21 22:56:20] [config] normalize: 0
[2023-07-21 22:56:20] [config] normalize-gradient: false
[2023-07-21 22:56:20] [config] num-devices: 0
[2023-07-21 22:56:20] [config] optimizer: adam
[2023-07-21 22:56:20] [config] optimizer-delay: 1
[2023-07-21 22:56:20] [config] optimizer-params:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] output-omit-bias: false
[2023-07-21 22:56:20] [config] overwrite: true
[2023-07-21 22:56:20] [config] precision:
[2023-07-21 22:56:20] [config]   - float16
[2023-07-21 22:56:20] [config]   - float32
[2023-07-21 22:56:20] [config] pretrained-model: ""
[2023-07-21 22:56:20] [config] quantize-biases: false
[2023-07-21 22:56:20] [config] quantize-bits: 0
[2023-07-21 22:56:20] [config] quantize-log-based: false
[2023-07-21 22:56:20] [config] quantize-optimization-steps: 0
[2023-07-21 22:56:20] [config] quiet: false
[2023-07-21 22:56:20] [config] quiet-translation: true
[2023-07-21 22:56:20] [config] relative-paths: false
[2023-07-21 22:56:20] [config] right-left: false
[2023-07-21 22:56:20] [config] save-freq: 10000u
[2023-07-21 22:56:20] [config] seed: 1234
[2023-07-21 22:56:20] [config] sentencepiece-alphas:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] sentencepiece-max-lines: 2000000
[2023-07-21 22:56:20] [config] sentencepiece-options: ""
[2023-07-21 22:56:20] [config] sharding: global
[2023-07-21 22:56:20] [config] shuffle: data
[2023-07-21 22:56:20] [config] shuffle-in-ram: false
[2023-07-21 22:56:20] [config] sigterm: save-and-exit
[2023-07-21 22:56:20] [config] skip: false
[2023-07-21 22:56:20] [config] sqlite: ""
[2023-07-21 22:56:20] [config] sqlite-drop: false
[2023-07-21 22:56:20] [config] sync-freq: 200u
[2023-07-21 22:56:20] [config] sync-sgd: false
[2023-07-21 22:56:20] [config] tempdir: /tmp
[2023-07-21 22:56:20] [config] tied-embeddings: false
[2023-07-21 22:56:20] [config] tied-embeddings-all: true
[2023-07-21 22:56:20] [config] tied-embeddings-src: false
[2023-07-21 22:56:20] [config] train-embedder-rank:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] train-sets:
[2023-07-21 22:56:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 22:56:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 22:56:20] [config] transformer-aan-activation: swish
[2023-07-21 22:56:20] [config] transformer-aan-depth: 2
[2023-07-21 22:56:20] [config] transformer-aan-nogate: false
[2023-07-21 22:56:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 22:56:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 22:56:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 22:56:20] [config] transformer-depth-scaling: false
[2023-07-21 22:56:20] [config] transformer-dim-aan: 2048
[2023-07-21 22:56:20] [config] transformer-dim-ffn: 2048
[2023-07-21 22:56:20] [config] transformer-dropout: 0
[2023-07-21 22:56:20] [config] transformer-dropout-attention: 0
[2023-07-21 22:56:20] [config] transformer-dropout-ffn: 0
[2023-07-21 22:56:20] [config] transformer-ffn-activation: swish
[2023-07-21 22:56:20] [config] transformer-ffn-depth: 2
[2023-07-21 22:56:20] [config] transformer-guided-alignment-layer: last
[2023-07-21 22:56:20] [config] transformer-heads: 8
[2023-07-21 22:56:20] [config] transformer-no-projection: false
[2023-07-21 22:56:20] [config] transformer-pool: false
[2023-07-21 22:56:20] [config] transformer-postprocess: dan
[2023-07-21 22:56:20] [config] transformer-postprocess-emb: d
[2023-07-21 22:56:20] [config] transformer-postprocess-top: ""
[2023-07-21 22:56:20] [config] transformer-preprocess: ""
[2023-07-21 22:56:20] [config] transformer-tied-layers:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] transformer-train-position-embeddings: false
[2023-07-21 22:56:20] [config] tsv: false
[2023-07-21 22:56:20] [config] tsv-fields: 0
[2023-07-21 22:56:20] [config] type: amun
[2023-07-21 22:56:20] [config] ulr: false
[2023-07-21 22:56:20] [config] ulr-dim-emb: 0
[2023-07-21 22:56:20] [config] ulr-dropout: 0
[2023-07-21 22:56:20] [config] ulr-keys-vectors: ""
[2023-07-21 22:56:20] [config] ulr-query-vectors: ""
[2023-07-21 22:56:20] [config] ulr-softmax-temperature: 1
[2023-07-21 22:56:20] [config] ulr-trainable-transformation: false
[2023-07-21 22:56:20] [config] unlikelihood-loss: false
[2023-07-21 22:56:20] [config] valid-freq: 50000000
[2023-07-21 22:56:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 22:56:20] [config] valid-max-length: 1000
[2023-07-21 22:56:20] [config] valid-metrics:
[2023-07-21 22:56:20] [config]   - cross-entropy
[2023-07-21 22:56:20] [config]   - translation
[2023-07-21 22:56:20] [config] valid-mini-batch: 32
[2023-07-21 22:56:20] [config] valid-reset-stalled: false
[2023-07-21 22:56:20] [config] valid-script-args:
[2023-07-21 22:56:20] [config]   []
[2023-07-21 22:56:20] [config] valid-script-path: ""
[2023-07-21 22:56:20] [config] valid-sets:
[2023-07-21 22:56:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 22:56:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 22:56:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 22:56:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:56:20] [config] vocabs:
[2023-07-21 22:56:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:56:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:56:20] [config] word-penalty: 0
[2023-07-21 22:56:20] [config] word-scores: false
[2023-07-21 22:56:20] [config] workspace: 5500
[2023-07-21 22:56:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:56:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:56:20] [training] Using single-device training
[2023-07-21 22:56:20] Synced seed 1234
[2023-07-21 22:56:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:56:20] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 22:56:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:56:20] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 22:56:20] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 22:56:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:56:20] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 22:56:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 22:56:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 22:56:22] [comm] Using global sharding
[2023-07-21 22:56:22] [comm] NCCLCommunicators constructed successfully
[2023-07-21 22:56:22] [training] Using 1 GPUs
[2023-07-21 22:56:22] [logits] Applying loss function for 1 factor(s)
[2023-07-21 22:56:22] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:56:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 22:56:22] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:02:28] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 23:02:28] [valid] No post-processing script given for validating translator
[2023-07-21 23:02:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:02:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:02:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:02:28] [comm] Using global sharding
[2023-07-21 23:02:28] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:02:28] [training] Using 1 GPUs
[2023-07-21 23:02:28] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 23:02:30] Allocating memory for general optimizer shards
[2023-07-21 23:02:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:02:30] Loading Adam parameters
[2023-07-21 23:02:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:02:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:02:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 23:02:30] [data] Restoring the corpus state to epoch 71, batch 2240
[2023-07-21 23:02:30] [data] Shuffling data
[2023-07-21 23:02:30] [data] Done reading 20,192 sentences
[2023-07-21 23:02:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:02:30] Training started
[2023-07-21 23:02:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 23:02:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:02:37] Parameter type float16, optimization type float32, casting types true
[2023-07-21 23:06:01] Seen 20,192 samples
[2023-07-21 23:06:01] Starting data epoch 72 in logical epoch 72
[2023-07-21 23:06:01] [data] Shuffling data
[2023-07-21 23:06:01] [data] Done reading 20,192 sentences
[2023-07-21 23:06:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:09:47] Seen 20,192 samples
[2023-07-21 23:09:47] Starting data epoch 73 in logical epoch 73
[2023-07-21 23:09:47] [data] Shuffling data
[2023-07-21 23:09:47] [data] Done reading 20,192 sentences
[2023-07-21 23:09:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:13:33] Seen 20,192 samples
[2023-07-21 23:13:33] Starting data epoch 74 in logical epoch 74
[2023-07-21 23:13:33] [data] Shuffling data
[2023-07-21 23:13:33] [data] Done reading 20,192 sentences
[2023-07-21 23:13:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:17:19] Seen 20,192 samples
[2023-07-21 23:17:19] Starting data epoch 75 in logical epoch 75
[2023-07-21 23:17:19] [data] Shuffling data
[2023-07-21 23:17:19] [data] Done reading 20,192 sentences
[2023-07-21 23:17:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:21:16] Seen 20,192 samples
[2023-07-21 23:21:16] Starting data epoch 76 in logical epoch 76
[2023-07-21 23:21:16] [data] Shuffling data
[2023-07-21 23:21:16] [data] Done reading 20,192 sentences
[2023-07-21 23:21:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:25:12] Seen 20,192 samples
[2023-07-21 23:25:12] Starting data epoch 77 in logical epoch 77
[2023-07-21 23:25:12] [data] Shuffling data
[2023-07-21 23:25:12] [data] Done reading 20,192 sentences
[2023-07-21 23:25:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:29:07] Seen 20,192 samples
[2023-07-21 23:29:07] Starting data epoch 78 in logical epoch 78
[2023-07-21 23:29:07] [data] Shuffling data
[2023-07-21 23:29:07] [data] Done reading 20,192 sentences
[2023-07-21 23:29:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:33:02] Seen 20,192 samples
[2023-07-21 23:33:02] Starting data epoch 79 in logical epoch 79
[2023-07-21 23:33:02] [data] Shuffling data
[2023-07-21 23:33:02] [data] Done reading 20,192 sentences
[2023-07-21 23:33:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:36:54] Seen 20,192 samples
[2023-07-21 23:36:54] Starting data epoch 80 in logical epoch 80
[2023-07-21 23:36:54] [data] Shuffling data
[2023-07-21 23:36:54] [data] Done reading 20,192 sentences
[2023-07-21 23:36:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:40:43] Seen 20,192 samples
[2023-07-21 23:40:43] Starting data epoch 81 in logical epoch 81
[2023-07-21 23:40:43] Training finished
[2023-07-21 23:40:53] [valid] Ep. 81 : Up. 2560 : cross-entropy : 146.816 : new best
[2023-07-21 23:45:34] [valid] Ep. 81 : Up. 2560 : translation : 0 : new best
[2023-07-21 23:45:34] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 23:45:36] Saving Adam parameters
[2023-07-21 23:45:37] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 23:45:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 23:45:43] [marian] Running on node23.datos.cluster.uy as process 30554 with command line:
[2023-07-21 23:45:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-21 23:45:43] [config] after: 0e
[2023-07-21 23:45:43] [config] after-batches: 0
[2023-07-21 23:45:43] [config] after-epochs: 90
[2023-07-21 23:45:43] [config] all-caps-every: 0
[2023-07-21 23:45:43] [config] allow-unk: false
[2023-07-21 23:45:43] [config] authors: false
[2023-07-21 23:45:43] [config] beam-size: 12
[2023-07-21 23:45:43] [config] bert-class-symbol: "[CLS]"
[2023-07-21 23:45:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 23:45:43] [config] bert-masking-fraction: 0.15
[2023-07-21 23:45:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 23:45:43] [config] bert-train-type-embeddings: true
[2023-07-21 23:45:43] [config] bert-type-vocab-size: 2
[2023-07-21 23:45:43] [config] build-info: ""
[2023-07-21 23:45:43] [config] check-gradient-nan: false
[2023-07-21 23:45:43] [config] check-nan: false
[2023-07-21 23:45:43] [config] cite: false
[2023-07-21 23:45:43] [config] clip-norm: 1
[2023-07-21 23:45:43] [config] cost-scaling:
[2023-07-21 23:45:43] [config]   - 256.f
[2023-07-21 23:45:43] [config]   - 1000
[2023-07-21 23:45:43] [config]   - 2.f
[2023-07-21 23:45:43] [config]   - 256.f
[2023-07-21 23:45:43] [config] cost-type: ce-sum
[2023-07-21 23:45:43] [config] cpu-threads: 0
[2023-07-21 23:45:43] [config] data-threads: 8
[2023-07-21 23:45:43] [config] data-weighting: ""
[2023-07-21 23:45:43] [config] data-weighting-type: sentence
[2023-07-21 23:45:43] [config] dec-cell: gru
[2023-07-21 23:45:43] [config] dec-cell-base-depth: 2
[2023-07-21 23:45:43] [config] dec-cell-high-depth: 1
[2023-07-21 23:45:43] [config] dec-depth: 1
[2023-07-21 23:45:43] [config] devices:
[2023-07-21 23:45:43] [config]   - 0
[2023-07-21 23:45:43] [config] dim-emb: 512
[2023-07-21 23:45:43] [config] dim-rnn: 1024
[2023-07-21 23:45:43] [config] dim-vocabs:
[2023-07-21 23:45:43] [config]   - 16384
[2023-07-21 23:45:43] [config]   - 16384
[2023-07-21 23:45:43] [config] disp-first: 0
[2023-07-21 23:45:43] [config] disp-freq: 1000u
[2023-07-21 23:45:43] [config] disp-label-counts: true
[2023-07-21 23:45:43] [config] dropout-rnn: 0.5
[2023-07-21 23:45:43] [config] dropout-src: 0
[2023-07-21 23:45:43] [config] dropout-trg: 0
[2023-07-21 23:45:43] [config] dump-config: ""
[2023-07-21 23:45:43] [config] dynamic-gradient-scaling:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] early-stopping: 200
[2023-07-21 23:45:43] [config] early-stopping-on: first
[2023-07-21 23:45:43] [config] embedding-fix-src: false
[2023-07-21 23:45:43] [config] embedding-fix-trg: false
[2023-07-21 23:45:43] [config] embedding-normalization: false
[2023-07-21 23:45:43] [config] embedding-vectors:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] enc-cell: gru
[2023-07-21 23:45:43] [config] enc-cell-depth: 1
[2023-07-21 23:45:43] [config] enc-depth: 1
[2023-07-21 23:45:43] [config] enc-type: bidirectional
[2023-07-21 23:45:43] [config] english-title-case-every: 0
[2023-07-21 23:45:43] [config] exponential-smoothing: 0
[2023-07-21 23:45:43] [config] factor-weight: 1
[2023-07-21 23:45:43] [config] factors-combine: sum
[2023-07-21 23:45:43] [config] factors-dim-emb: 0
[2023-07-21 23:45:43] [config] gradient-checkpointing: false
[2023-07-21 23:45:43] [config] gradient-norm-average-window: 100
[2023-07-21 23:45:43] [config] guided-alignment: none
[2023-07-21 23:45:43] [config] guided-alignment-cost: mse
[2023-07-21 23:45:43] [config] guided-alignment-weight: 0.1
[2023-07-21 23:45:43] [config] ignore-model-config: false
[2023-07-21 23:45:43] [config] input-types:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] interpolate-env-vars: false
[2023-07-21 23:45:43] [config] keep-best: false
[2023-07-21 23:45:43] [config] label-smoothing: 0
[2023-07-21 23:45:43] [config] layer-normalization: false
[2023-07-21 23:45:43] [config] learn-rate: 0.0001
[2023-07-21 23:45:43] [config] lemma-dependency: ""
[2023-07-21 23:45:43] [config] lemma-dim-emb: 0
[2023-07-21 23:45:43] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 23:45:43] [config] log-level: info
[2023-07-21 23:45:43] [config] log-time-zone: ""
[2023-07-21 23:45:43] [config] logical-epoch:
[2023-07-21 23:45:43] [config]   - 1e
[2023-07-21 23:45:43] [config]   - 0
[2023-07-21 23:45:43] [config] lr-decay: 0
[2023-07-21 23:45:43] [config] lr-decay-freq: 50000
[2023-07-21 23:45:43] [config] lr-decay-inv-sqrt:
[2023-07-21 23:45:43] [config]   - 0
[2023-07-21 23:45:43] [config] lr-decay-repeat-warmup: false
[2023-07-21 23:45:43] [config] lr-decay-reset-optimizer: false
[2023-07-21 23:45:43] [config] lr-decay-start:
[2023-07-21 23:45:43] [config]   - 10
[2023-07-21 23:45:43] [config]   - 1
[2023-07-21 23:45:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 23:45:43] [config] lr-report: false
[2023-07-21 23:45:43] [config] lr-warmup: 0
[2023-07-21 23:45:43] [config] lr-warmup-at-reload: false
[2023-07-21 23:45:43] [config] lr-warmup-cycle: false
[2023-07-21 23:45:43] [config] lr-warmup-start-rate: 0
[2023-07-21 23:45:43] [config] max-length: 50
[2023-07-21 23:45:43] [config] max-length-crop: true
[2023-07-21 23:45:43] [config] max-length-factor: 3
[2023-07-21 23:45:43] [config] maxi-batch: 100
[2023-07-21 23:45:43] [config] maxi-batch-sort: trg
[2023-07-21 23:45:43] [config] mini-batch: 64
[2023-07-21 23:45:43] [config] mini-batch-fit: true
[2023-07-21 23:45:43] [config] mini-batch-fit-step: 10
[2023-07-21 23:45:43] [config] mini-batch-round-up: true
[2023-07-21 23:45:43] [config] mini-batch-track-lr: false
[2023-07-21 23:45:43] [config] mini-batch-warmup: 0
[2023-07-21 23:45:43] [config] mini-batch-words: 0
[2023-07-21 23:45:43] [config] mini-batch-words-ref: 0
[2023-07-21 23:45:43] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 23:45:43] [config] multi-loss-type: sum
[2023-07-21 23:45:43] [config] n-best: false
[2023-07-21 23:45:43] [config] no-nccl: false
[2023-07-21 23:45:43] [config] no-reload: false
[2023-07-21 23:45:43] [config] no-restore-corpus: false
[2023-07-21 23:45:43] [config] normalize: 0
[2023-07-21 23:45:43] [config] normalize-gradient: false
[2023-07-21 23:45:43] [config] num-devices: 0
[2023-07-21 23:45:43] [config] optimizer: adam
[2023-07-21 23:45:43] [config] optimizer-delay: 1
[2023-07-21 23:45:43] [config] optimizer-params:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] output-omit-bias: false
[2023-07-21 23:45:43] [config] overwrite: true
[2023-07-21 23:45:43] [config] precision:
[2023-07-21 23:45:43] [config]   - float16
[2023-07-21 23:45:43] [config]   - float32
[2023-07-21 23:45:43] [config] pretrained-model: ""
[2023-07-21 23:45:43] [config] quantize-biases: false
[2023-07-21 23:45:43] [config] quantize-bits: 0
[2023-07-21 23:45:43] [config] quantize-log-based: false
[2023-07-21 23:45:43] [config] quantize-optimization-steps: 0
[2023-07-21 23:45:43] [config] quiet: false
[2023-07-21 23:45:43] [config] quiet-translation: true
[2023-07-21 23:45:43] [config] relative-paths: false
[2023-07-21 23:45:43] [config] right-left: false
[2023-07-21 23:45:43] [config] save-freq: 10000u
[2023-07-21 23:45:43] [config] seed: 1234
[2023-07-21 23:45:43] [config] sentencepiece-alphas:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] sentencepiece-max-lines: 2000000
[2023-07-21 23:45:43] [config] sentencepiece-options: ""
[2023-07-21 23:45:43] [config] sharding: global
[2023-07-21 23:45:43] [config] shuffle: data
[2023-07-21 23:45:43] [config] shuffle-in-ram: false
[2023-07-21 23:45:43] [config] sigterm: save-and-exit
[2023-07-21 23:45:43] [config] skip: false
[2023-07-21 23:45:43] [config] sqlite: ""
[2023-07-21 23:45:43] [config] sqlite-drop: false
[2023-07-21 23:45:43] [config] sync-freq: 200u
[2023-07-21 23:45:43] [config] sync-sgd: false
[2023-07-21 23:45:43] [config] tempdir: /tmp
[2023-07-21 23:45:43] [config] tied-embeddings: false
[2023-07-21 23:45:43] [config] tied-embeddings-all: true
[2023-07-21 23:45:43] [config] tied-embeddings-src: false
[2023-07-21 23:45:43] [config] train-embedder-rank:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] train-sets:
[2023-07-21 23:45:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 23:45:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 23:45:43] [config] transformer-aan-activation: swish
[2023-07-21 23:45:43] [config] transformer-aan-depth: 2
[2023-07-21 23:45:43] [config] transformer-aan-nogate: false
[2023-07-21 23:45:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 23:45:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 23:45:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 23:45:43] [config] transformer-depth-scaling: false
[2023-07-21 23:45:43] [config] transformer-dim-aan: 2048
[2023-07-21 23:45:43] [config] transformer-dim-ffn: 2048
[2023-07-21 23:45:43] [config] transformer-dropout: 0
[2023-07-21 23:45:43] [config] transformer-dropout-attention: 0
[2023-07-21 23:45:43] [config] transformer-dropout-ffn: 0
[2023-07-21 23:45:43] [config] transformer-ffn-activation: swish
[2023-07-21 23:45:43] [config] transformer-ffn-depth: 2
[2023-07-21 23:45:43] [config] transformer-guided-alignment-layer: last
[2023-07-21 23:45:43] [config] transformer-heads: 8
[2023-07-21 23:45:43] [config] transformer-no-projection: false
[2023-07-21 23:45:43] [config] transformer-pool: false
[2023-07-21 23:45:43] [config] transformer-postprocess: dan
[2023-07-21 23:45:43] [config] transformer-postprocess-emb: d
[2023-07-21 23:45:43] [config] transformer-postprocess-top: ""
[2023-07-21 23:45:43] [config] transformer-preprocess: ""
[2023-07-21 23:45:43] [config] transformer-tied-layers:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] transformer-train-position-embeddings: false
[2023-07-21 23:45:43] [config] tsv: false
[2023-07-21 23:45:43] [config] tsv-fields: 0
[2023-07-21 23:45:43] [config] type: amun
[2023-07-21 23:45:43] [config] ulr: false
[2023-07-21 23:45:43] [config] ulr-dim-emb: 0
[2023-07-21 23:45:43] [config] ulr-dropout: 0
[2023-07-21 23:45:43] [config] ulr-keys-vectors: ""
[2023-07-21 23:45:43] [config] ulr-query-vectors: ""
[2023-07-21 23:45:43] [config] ulr-softmax-temperature: 1
[2023-07-21 23:45:43] [config] ulr-trainable-transformation: false
[2023-07-21 23:45:43] [config] unlikelihood-loss: false
[2023-07-21 23:45:43] [config] valid-freq: 50000000
[2023-07-21 23:45:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-21 23:45:43] [config] valid-max-length: 1000
[2023-07-21 23:45:43] [config] valid-metrics:
[2023-07-21 23:45:43] [config]   - cross-entropy
[2023-07-21 23:45:43] [config]   - translation
[2023-07-21 23:45:43] [config] valid-mini-batch: 32
[2023-07-21 23:45:43] [config] valid-reset-stalled: false
[2023-07-21 23:45:43] [config] valid-script-args:
[2023-07-21 23:45:43] [config]   []
[2023-07-21 23:45:43] [config] valid-script-path: ""
[2023-07-21 23:45:43] [config] valid-sets:
[2023-07-21 23:45:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 23:45:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 23:45:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-21 23:45:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 23:45:43] [config] vocabs:
[2023-07-21 23:45:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 23:45:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 23:45:43] [config] word-penalty: 0
[2023-07-21 23:45:43] [config] word-scores: false
[2023-07-21 23:45:43] [config] workspace: 5500
[2023-07-21 23:45:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 23:45:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:45:43] [training] Using single-device training
[2023-07-21 23:45:43] Synced seed 1234
[2023-07-21 23:45:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 23:45:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 23:45:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 23:45:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 23:45:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 23:45:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:45:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 23:45:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:45:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:45:45] [comm] Using global sharding
[2023-07-21 23:45:45] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:45:45] [training] Using 1 GPUs
[2023-07-21 23:45:45] [logits] Applying loss function for 1 factor(s)
[2023-07-21 23:45:45] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:45:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 23:45:45] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:52:06] [batching] Done. Typical MB size is 31,728 target words
[2023-07-21 23:52:06] [valid] No post-processing script given for validating translator
[2023-07-21 23:52:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:52:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:52:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:52:06] [comm] Using global sharding
[2023-07-21 23:52:06] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:52:06] [training] Using 1 GPUs
[2023-07-21 23:52:06] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-21 23:52:07] Allocating memory for general optimizer shards
[2023-07-21 23:52:07] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:52:07] Loading Adam parameters
[2023-07-21 23:52:08] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:52:08] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:52:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-21 23:52:08] [data] Restoring the corpus state to epoch 81, batch 2560
[2023-07-21 23:52:08] [data] Shuffling data
[2023-07-21 23:52:08] [data] Done reading 20,192 sentences
[2023-07-21 23:52:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:52:08] Training started
[2023-07-21 23:52:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 23:52:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:52:20] Parameter type float16, optimization type float32, casting types true
[2023-07-21 23:55:54] Seen 20,192 samples
[2023-07-21 23:55:54] Starting data epoch 82 in logical epoch 82
[2023-07-21 23:55:54] [data] Shuffling data
[2023-07-21 23:55:54] [data] Done reading 20,192 sentences
[2023-07-21 23:55:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:59:45] Seen 20,192 samples
[2023-07-21 23:59:45] Starting data epoch 83 in logical epoch 83
[2023-07-21 23:59:45] [data] Shuffling data
[2023-07-21 23:59:45] [data] Done reading 20,192 sentences
[2023-07-21 23:59:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:03:39] Seen 20,192 samples
[2023-07-22 00:03:39] Starting data epoch 84 in logical epoch 84
[2023-07-22 00:03:39] [data] Shuffling data
[2023-07-22 00:03:39] [data] Done reading 20,192 sentences
[2023-07-22 00:03:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:07:26] Seen 20,192 samples
[2023-07-22 00:07:26] Starting data epoch 85 in logical epoch 85
[2023-07-22 00:07:26] [data] Shuffling data
[2023-07-22 00:07:26] [data] Done reading 20,192 sentences
[2023-07-22 00:07:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:11:20] Seen 20,192 samples
[2023-07-22 00:11:20] Starting data epoch 86 in logical epoch 86
[2023-07-22 00:11:20] [data] Shuffling data
[2023-07-22 00:11:20] [data] Done reading 20,192 sentences
[2023-07-22 00:11:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:15:16] Seen 20,192 samples
[2023-07-22 00:15:16] Starting data epoch 87 in logical epoch 87
[2023-07-22 00:15:16] [data] Shuffling data
[2023-07-22 00:15:16] [data] Done reading 20,192 sentences
[2023-07-22 00:15:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:19:19] Seen 20,192 samples
[2023-07-22 00:19:19] Starting data epoch 88 in logical epoch 88
[2023-07-22 00:19:19] [data] Shuffling data
[2023-07-22 00:19:19] [data] Done reading 20,192 sentences
[2023-07-22 00:19:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:23:10] Seen 20,192 samples
[2023-07-22 00:23:10] Starting data epoch 89 in logical epoch 89
[2023-07-22 00:23:10] [data] Shuffling data
[2023-07-22 00:23:10] [data] Done reading 20,192 sentences
[2023-07-22 00:23:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:27:03] Seen 20,192 samples
[2023-07-22 00:27:03] Starting data epoch 90 in logical epoch 90
[2023-07-22 00:27:03] [data] Shuffling data
[2023-07-22 00:27:03] [data] Done reading 20,192 sentences
[2023-07-22 00:27:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:31:00] Seen 20,192 samples
[2023-07-22 00:31:00] Starting data epoch 91 in logical epoch 91
[2023-07-22 00:31:00] Training finished
[2023-07-22 00:31:13] [valid] Ep. 91 : Up. 2880 : cross-entropy : 144.583 : new best
[2023-07-22 00:34:53] [valid] Ep. 91 : Up. 2880 : translation : 0 : new best
[2023-07-22 00:34:53] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 00:34:56] Saving Adam parameters
[2023-07-22 00:34:56] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 00:35:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:35:03] [marian] Running on node23.datos.cluster.uy as process 33882 with command line:
[2023-07-22 00:35:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 00:35:03] [config] after: 0e
[2023-07-22 00:35:03] [config] after-batches: 0
[2023-07-22 00:35:03] [config] after-epochs: 100
[2023-07-22 00:35:03] [config] all-caps-every: 0
[2023-07-22 00:35:03] [config] allow-unk: false
[2023-07-22 00:35:03] [config] authors: false
[2023-07-22 00:35:03] [config] beam-size: 12
[2023-07-22 00:35:03] [config] bert-class-symbol: "[CLS]"
[2023-07-22 00:35:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 00:35:03] [config] bert-masking-fraction: 0.15
[2023-07-22 00:35:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 00:35:03] [config] bert-train-type-embeddings: true
[2023-07-22 00:35:03] [config] bert-type-vocab-size: 2
[2023-07-22 00:35:03] [config] build-info: ""
[2023-07-22 00:35:03] [config] check-gradient-nan: false
[2023-07-22 00:35:03] [config] check-nan: false
[2023-07-22 00:35:03] [config] cite: false
[2023-07-22 00:35:03] [config] clip-norm: 1
[2023-07-22 00:35:03] [config] cost-scaling:
[2023-07-22 00:35:03] [config]   - 256.f
[2023-07-22 00:35:03] [config]   - 1000
[2023-07-22 00:35:03] [config]   - 2.f
[2023-07-22 00:35:03] [config]   - 256.f
[2023-07-22 00:35:03] [config] cost-type: ce-sum
[2023-07-22 00:35:03] [config] cpu-threads: 0
[2023-07-22 00:35:03] [config] data-threads: 8
[2023-07-22 00:35:03] [config] data-weighting: ""
[2023-07-22 00:35:03] [config] data-weighting-type: sentence
[2023-07-22 00:35:03] [config] dec-cell: gru
[2023-07-22 00:35:03] [config] dec-cell-base-depth: 2
[2023-07-22 00:35:03] [config] dec-cell-high-depth: 1
[2023-07-22 00:35:03] [config] dec-depth: 1
[2023-07-22 00:35:03] [config] devices:
[2023-07-22 00:35:03] [config]   - 0
[2023-07-22 00:35:03] [config] dim-emb: 512
[2023-07-22 00:35:03] [config] dim-rnn: 1024
[2023-07-22 00:35:03] [config] dim-vocabs:
[2023-07-22 00:35:03] [config]   - 16384
[2023-07-22 00:35:03] [config]   - 16384
[2023-07-22 00:35:03] [config] disp-first: 0
[2023-07-22 00:35:03] [config] disp-freq: 1000u
[2023-07-22 00:35:03] [config] disp-label-counts: true
[2023-07-22 00:35:03] [config] dropout-rnn: 0.5
[2023-07-22 00:35:03] [config] dropout-src: 0
[2023-07-22 00:35:03] [config] dropout-trg: 0
[2023-07-22 00:35:03] [config] dump-config: ""
[2023-07-22 00:35:03] [config] dynamic-gradient-scaling:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] early-stopping: 200
[2023-07-22 00:35:03] [config] early-stopping-on: first
[2023-07-22 00:35:03] [config] embedding-fix-src: false
[2023-07-22 00:35:03] [config] embedding-fix-trg: false
[2023-07-22 00:35:03] [config] embedding-normalization: false
[2023-07-22 00:35:03] [config] embedding-vectors:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] enc-cell: gru
[2023-07-22 00:35:03] [config] enc-cell-depth: 1
[2023-07-22 00:35:03] [config] enc-depth: 1
[2023-07-22 00:35:03] [config] enc-type: bidirectional
[2023-07-22 00:35:03] [config] english-title-case-every: 0
[2023-07-22 00:35:03] [config] exponential-smoothing: 0
[2023-07-22 00:35:03] [config] factor-weight: 1
[2023-07-22 00:35:03] [config] factors-combine: sum
[2023-07-22 00:35:03] [config] factors-dim-emb: 0
[2023-07-22 00:35:03] [config] gradient-checkpointing: false
[2023-07-22 00:35:03] [config] gradient-norm-average-window: 100
[2023-07-22 00:35:03] [config] guided-alignment: none
[2023-07-22 00:35:03] [config] guided-alignment-cost: mse
[2023-07-22 00:35:03] [config] guided-alignment-weight: 0.1
[2023-07-22 00:35:03] [config] ignore-model-config: false
[2023-07-22 00:35:03] [config] input-types:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] interpolate-env-vars: false
[2023-07-22 00:35:03] [config] keep-best: false
[2023-07-22 00:35:03] [config] label-smoothing: 0
[2023-07-22 00:35:03] [config] layer-normalization: false
[2023-07-22 00:35:03] [config] learn-rate: 0.0001
[2023-07-22 00:35:03] [config] lemma-dependency: ""
[2023-07-22 00:35:03] [config] lemma-dim-emb: 0
[2023-07-22 00:35:03] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 00:35:03] [config] log-level: info
[2023-07-22 00:35:03] [config] log-time-zone: ""
[2023-07-22 00:35:03] [config] logical-epoch:
[2023-07-22 00:35:03] [config]   - 1e
[2023-07-22 00:35:03] [config]   - 0
[2023-07-22 00:35:03] [config] lr-decay: 0
[2023-07-22 00:35:03] [config] lr-decay-freq: 50000
[2023-07-22 00:35:03] [config] lr-decay-inv-sqrt:
[2023-07-22 00:35:03] [config]   - 0
[2023-07-22 00:35:03] [config] lr-decay-repeat-warmup: false
[2023-07-22 00:35:03] [config] lr-decay-reset-optimizer: false
[2023-07-22 00:35:03] [config] lr-decay-start:
[2023-07-22 00:35:03] [config]   - 10
[2023-07-22 00:35:03] [config]   - 1
[2023-07-22 00:35:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 00:35:03] [config] lr-report: false
[2023-07-22 00:35:03] [config] lr-warmup: 0
[2023-07-22 00:35:03] [config] lr-warmup-at-reload: false
[2023-07-22 00:35:03] [config] lr-warmup-cycle: false
[2023-07-22 00:35:03] [config] lr-warmup-start-rate: 0
[2023-07-22 00:35:03] [config] max-length: 50
[2023-07-22 00:35:03] [config] max-length-crop: true
[2023-07-22 00:35:03] [config] max-length-factor: 3
[2023-07-22 00:35:03] [config] maxi-batch: 100
[2023-07-22 00:35:03] [config] maxi-batch-sort: trg
[2023-07-22 00:35:03] [config] mini-batch: 64
[2023-07-22 00:35:03] [config] mini-batch-fit: true
[2023-07-22 00:35:03] [config] mini-batch-fit-step: 10
[2023-07-22 00:35:03] [config] mini-batch-round-up: true
[2023-07-22 00:35:03] [config] mini-batch-track-lr: false
[2023-07-22 00:35:03] [config] mini-batch-warmup: 0
[2023-07-22 00:35:03] [config] mini-batch-words: 0
[2023-07-22 00:35:03] [config] mini-batch-words-ref: 0
[2023-07-22 00:35:03] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 00:35:03] [config] multi-loss-type: sum
[2023-07-22 00:35:03] [config] n-best: false
[2023-07-22 00:35:03] [config] no-nccl: false
[2023-07-22 00:35:03] [config] no-reload: false
[2023-07-22 00:35:03] [config] no-restore-corpus: false
[2023-07-22 00:35:03] [config] normalize: 0
[2023-07-22 00:35:03] [config] normalize-gradient: false
[2023-07-22 00:35:03] [config] num-devices: 0
[2023-07-22 00:35:03] [config] optimizer: adam
[2023-07-22 00:35:03] [config] optimizer-delay: 1
[2023-07-22 00:35:03] [config] optimizer-params:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] output-omit-bias: false
[2023-07-22 00:35:03] [config] overwrite: true
[2023-07-22 00:35:03] [config] precision:
[2023-07-22 00:35:03] [config]   - float16
[2023-07-22 00:35:03] [config]   - float32
[2023-07-22 00:35:03] [config] pretrained-model: ""
[2023-07-22 00:35:03] [config] quantize-biases: false
[2023-07-22 00:35:03] [config] quantize-bits: 0
[2023-07-22 00:35:03] [config] quantize-log-based: false
[2023-07-22 00:35:03] [config] quantize-optimization-steps: 0
[2023-07-22 00:35:03] [config] quiet: false
[2023-07-22 00:35:03] [config] quiet-translation: true
[2023-07-22 00:35:03] [config] relative-paths: false
[2023-07-22 00:35:03] [config] right-left: false
[2023-07-22 00:35:03] [config] save-freq: 10000u
[2023-07-22 00:35:03] [config] seed: 1234
[2023-07-22 00:35:03] [config] sentencepiece-alphas:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] sentencepiece-max-lines: 2000000
[2023-07-22 00:35:03] [config] sentencepiece-options: ""
[2023-07-22 00:35:03] [config] sharding: global
[2023-07-22 00:35:03] [config] shuffle: data
[2023-07-22 00:35:03] [config] shuffle-in-ram: false
[2023-07-22 00:35:03] [config] sigterm: save-and-exit
[2023-07-22 00:35:03] [config] skip: false
[2023-07-22 00:35:03] [config] sqlite: ""
[2023-07-22 00:35:03] [config] sqlite-drop: false
[2023-07-22 00:35:03] [config] sync-freq: 200u
[2023-07-22 00:35:03] [config] sync-sgd: false
[2023-07-22 00:35:03] [config] tempdir: /tmp
[2023-07-22 00:35:03] [config] tied-embeddings: false
[2023-07-22 00:35:03] [config] tied-embeddings-all: true
[2023-07-22 00:35:03] [config] tied-embeddings-src: false
[2023-07-22 00:35:03] [config] train-embedder-rank:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] train-sets:
[2023-07-22 00:35:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 00:35:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 00:35:03] [config] transformer-aan-activation: swish
[2023-07-22 00:35:03] [config] transformer-aan-depth: 2
[2023-07-22 00:35:03] [config] transformer-aan-nogate: false
[2023-07-22 00:35:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 00:35:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 00:35:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 00:35:03] [config] transformer-depth-scaling: false
[2023-07-22 00:35:03] [config] transformer-dim-aan: 2048
[2023-07-22 00:35:03] [config] transformer-dim-ffn: 2048
[2023-07-22 00:35:03] [config] transformer-dropout: 0
[2023-07-22 00:35:03] [config] transformer-dropout-attention: 0
[2023-07-22 00:35:03] [config] transformer-dropout-ffn: 0
[2023-07-22 00:35:03] [config] transformer-ffn-activation: swish
[2023-07-22 00:35:03] [config] transformer-ffn-depth: 2
[2023-07-22 00:35:03] [config] transformer-guided-alignment-layer: last
[2023-07-22 00:35:03] [config] transformer-heads: 8
[2023-07-22 00:35:03] [config] transformer-no-projection: false
[2023-07-22 00:35:03] [config] transformer-pool: false
[2023-07-22 00:35:03] [config] transformer-postprocess: dan
[2023-07-22 00:35:03] [config] transformer-postprocess-emb: d
[2023-07-22 00:35:03] [config] transformer-postprocess-top: ""
[2023-07-22 00:35:03] [config] transformer-preprocess: ""
[2023-07-22 00:35:03] [config] transformer-tied-layers:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] transformer-train-position-embeddings: false
[2023-07-22 00:35:03] [config] tsv: false
[2023-07-22 00:35:03] [config] tsv-fields: 0
[2023-07-22 00:35:03] [config] type: amun
[2023-07-22 00:35:03] [config] ulr: false
[2023-07-22 00:35:03] [config] ulr-dim-emb: 0
[2023-07-22 00:35:03] [config] ulr-dropout: 0
[2023-07-22 00:35:03] [config] ulr-keys-vectors: ""
[2023-07-22 00:35:03] [config] ulr-query-vectors: ""
[2023-07-22 00:35:03] [config] ulr-softmax-temperature: 1
[2023-07-22 00:35:03] [config] ulr-trainable-transformation: false
[2023-07-22 00:35:03] [config] unlikelihood-loss: false
[2023-07-22 00:35:03] [config] valid-freq: 50000000
[2023-07-22 00:35:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 00:35:03] [config] valid-max-length: 1000
[2023-07-22 00:35:03] [config] valid-metrics:
[2023-07-22 00:35:03] [config]   - cross-entropy
[2023-07-22 00:35:03] [config]   - translation
[2023-07-22 00:35:03] [config] valid-mini-batch: 32
[2023-07-22 00:35:03] [config] valid-reset-stalled: false
[2023-07-22 00:35:03] [config] valid-script-args:
[2023-07-22 00:35:03] [config]   []
[2023-07-22 00:35:03] [config] valid-script-path: ""
[2023-07-22 00:35:03] [config] valid-sets:
[2023-07-22 00:35:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 00:35:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 00:35:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 00:35:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:35:03] [config] vocabs:
[2023-07-22 00:35:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 00:35:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 00:35:03] [config] word-penalty: 0
[2023-07-22 00:35:03] [config] word-scores: false
[2023-07-22 00:35:03] [config] workspace: 5500
[2023-07-22 00:35:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:35:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:35:03] [training] Using single-device training
[2023-07-22 00:35:04] Synced seed 1234
[2023-07-22 00:35:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 00:35:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 00:35:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 00:35:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 00:35:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 00:35:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:35:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 00:35:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 00:35:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 00:35:05] [comm] Using global sharding
[2023-07-22 00:35:05] [comm] NCCLCommunicators constructed successfully
[2023-07-22 00:35:05] [training] Using 1 GPUs
[2023-07-22 00:35:05] [logits] Applying loss function for 1 factor(s)
[2023-07-22 00:35:05] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:35:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 00:35:05] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:41:15] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 00:41:15] [valid] No post-processing script given for validating translator
[2023-07-22 00:41:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:41:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 00:41:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 00:41:15] [comm] Using global sharding
[2023-07-22 00:41:15] [comm] NCCLCommunicators constructed successfully
[2023-07-22 00:41:15] [training] Using 1 GPUs
[2023-07-22 00:41:15] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 00:41:16] Allocating memory for general optimizer shards
[2023-07-22 00:41:16] [memory] Reserving 322 MB, device gpu0
[2023-07-22 00:41:16] Loading Adam parameters
[2023-07-22 00:41:16] [memory] Reserving 322 MB, device gpu0
[2023-07-22 00:41:16] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:41:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 00:41:17] [data] Restoring the corpus state to epoch 91, batch 2880
[2023-07-22 00:41:17] [data] Shuffling data
[2023-07-22 00:41:17] [data] Done reading 20,192 sentences
[2023-07-22 00:41:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:41:17] Training started
[2023-07-22 00:41:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 00:41:17] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:41:21] Parameter type float16, optimization type float32, casting types true
[2023-07-22 00:45:09] Seen 20,192 samples
[2023-07-22 00:45:09] Starting data epoch 92 in logical epoch 92
[2023-07-22 00:45:09] [data] Shuffling data
[2023-07-22 00:45:09] [data] Done reading 20,192 sentences
[2023-07-22 00:45:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:49:03] Seen 20,192 samples
[2023-07-22 00:49:03] Starting data epoch 93 in logical epoch 93
[2023-07-22 00:49:03] [data] Shuffling data
[2023-07-22 00:49:03] [data] Done reading 20,192 sentences
[2023-07-22 00:49:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:52:33] Seen 20,192 samples
[2023-07-22 00:52:33] Starting data epoch 94 in logical epoch 94
[2023-07-22 00:52:33] [data] Shuffling data
[2023-07-22 00:52:33] [data] Done reading 20,192 sentences
[2023-07-22 00:52:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:55:28] Ep. 94 : Up. 3000 : Sen. 14,966 : Cost 5.42110109 * 16,046,710 @ 786 after 48,115,420 : Time 853.09s : 18810.05 words/s : gNorm 0.8488
[2023-07-22 00:56:23] Seen 20,192 samples
[2023-07-22 00:56:23] Starting data epoch 95 in logical epoch 95
[2023-07-22 00:56:23] [data] Shuffling data
[2023-07-22 00:56:23] [data] Done reading 20,192 sentences
[2023-07-22 00:56:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:00:16] Seen 20,192 samples
[2023-07-22 01:00:16] Starting data epoch 96 in logical epoch 96
[2023-07-22 01:00:16] [data] Shuffling data
[2023-07-22 01:00:16] [data] Done reading 20,192 sentences
[2023-07-22 01:00:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:04:11] Seen 20,192 samples
[2023-07-22 01:04:11] Starting data epoch 97 in logical epoch 97
[2023-07-22 01:04:11] [data] Shuffling data
[2023-07-22 01:04:11] [data] Done reading 20,192 sentences
[2023-07-22 01:04:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:08:06] Seen 20,192 samples
[2023-07-22 01:08:06] Starting data epoch 98 in logical epoch 98
[2023-07-22 01:08:06] [data] Shuffling data
[2023-07-22 01:08:06] [data] Done reading 20,192 sentences
[2023-07-22 01:08:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:11:59] Seen 20,192 samples
[2023-07-22 01:11:59] Starting data epoch 99 in logical epoch 99
[2023-07-22 01:11:59] [data] Shuffling data
[2023-07-22 01:11:59] [data] Done reading 20,192 sentences
[2023-07-22 01:11:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:15:57] Seen 20,192 samples
[2023-07-22 01:15:57] Starting data epoch 100 in logical epoch 100
[2023-07-22 01:15:57] [data] Shuffling data
[2023-07-22 01:15:57] [data] Done reading 20,192 sentences
[2023-07-22 01:15:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:19:46] Seen 20,192 samples
[2023-07-22 01:19:46] Starting data epoch 101 in logical epoch 101
[2023-07-22 01:19:46] Training finished
[2023-07-22 01:19:59] [valid] Ep. 101 : Up. 3200 : cross-entropy : 144.163 : new best
[2023-07-22 01:21:33] [valid] Ep. 101 : Up. 3200 : translation : 0 : new best
[2023-07-22 01:21:33] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 01:21:34] Saving Adam parameters
[2023-07-22 01:21:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 01:21:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 01:21:42] [marian] Running on node23.datos.cluster.uy as process 37076 with command line:
[2023-07-22 01:21:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 01:21:43] [config] after: 0e
[2023-07-22 01:21:43] [config] after-batches: 0
[2023-07-22 01:21:43] [config] after-epochs: 110
[2023-07-22 01:21:43] [config] all-caps-every: 0
[2023-07-22 01:21:43] [config] allow-unk: false
[2023-07-22 01:21:43] [config] authors: false
[2023-07-22 01:21:43] [config] beam-size: 12
[2023-07-22 01:21:43] [config] bert-class-symbol: "[CLS]"
[2023-07-22 01:21:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 01:21:43] [config] bert-masking-fraction: 0.15
[2023-07-22 01:21:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 01:21:43] [config] bert-train-type-embeddings: true
[2023-07-22 01:21:43] [config] bert-type-vocab-size: 2
[2023-07-22 01:21:43] [config] build-info: ""
[2023-07-22 01:21:43] [config] check-gradient-nan: false
[2023-07-22 01:21:43] [config] check-nan: false
[2023-07-22 01:21:43] [config] cite: false
[2023-07-22 01:21:43] [config] clip-norm: 1
[2023-07-22 01:21:43] [config] cost-scaling:
[2023-07-22 01:21:43] [config]   - 256.f
[2023-07-22 01:21:43] [config]   - 1000
[2023-07-22 01:21:43] [config]   - 2.f
[2023-07-22 01:21:43] [config]   - 256.f
[2023-07-22 01:21:43] [config] cost-type: ce-sum
[2023-07-22 01:21:43] [config] cpu-threads: 0
[2023-07-22 01:21:43] [config] data-threads: 8
[2023-07-22 01:21:43] [config] data-weighting: ""
[2023-07-22 01:21:43] [config] data-weighting-type: sentence
[2023-07-22 01:21:43] [config] dec-cell: gru
[2023-07-22 01:21:43] [config] dec-cell-base-depth: 2
[2023-07-22 01:21:43] [config] dec-cell-high-depth: 1
[2023-07-22 01:21:43] [config] dec-depth: 1
[2023-07-22 01:21:43] [config] devices:
[2023-07-22 01:21:43] [config]   - 0
[2023-07-22 01:21:43] [config] dim-emb: 512
[2023-07-22 01:21:43] [config] dim-rnn: 1024
[2023-07-22 01:21:43] [config] dim-vocabs:
[2023-07-22 01:21:43] [config]   - 16384
[2023-07-22 01:21:43] [config]   - 16384
[2023-07-22 01:21:43] [config] disp-first: 0
[2023-07-22 01:21:43] [config] disp-freq: 1000u
[2023-07-22 01:21:43] [config] disp-label-counts: true
[2023-07-22 01:21:43] [config] dropout-rnn: 0.5
[2023-07-22 01:21:43] [config] dropout-src: 0
[2023-07-22 01:21:43] [config] dropout-trg: 0
[2023-07-22 01:21:43] [config] dump-config: ""
[2023-07-22 01:21:43] [config] dynamic-gradient-scaling:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] early-stopping: 200
[2023-07-22 01:21:43] [config] early-stopping-on: first
[2023-07-22 01:21:43] [config] embedding-fix-src: false
[2023-07-22 01:21:43] [config] embedding-fix-trg: false
[2023-07-22 01:21:43] [config] embedding-normalization: false
[2023-07-22 01:21:43] [config] embedding-vectors:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] enc-cell: gru
[2023-07-22 01:21:43] [config] enc-cell-depth: 1
[2023-07-22 01:21:43] [config] enc-depth: 1
[2023-07-22 01:21:43] [config] enc-type: bidirectional
[2023-07-22 01:21:43] [config] english-title-case-every: 0
[2023-07-22 01:21:43] [config] exponential-smoothing: 0
[2023-07-22 01:21:43] [config] factor-weight: 1
[2023-07-22 01:21:43] [config] factors-combine: sum
[2023-07-22 01:21:43] [config] factors-dim-emb: 0
[2023-07-22 01:21:43] [config] gradient-checkpointing: false
[2023-07-22 01:21:43] [config] gradient-norm-average-window: 100
[2023-07-22 01:21:43] [config] guided-alignment: none
[2023-07-22 01:21:43] [config] guided-alignment-cost: mse
[2023-07-22 01:21:43] [config] guided-alignment-weight: 0.1
[2023-07-22 01:21:43] [config] ignore-model-config: false
[2023-07-22 01:21:43] [config] input-types:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] interpolate-env-vars: false
[2023-07-22 01:21:43] [config] keep-best: false
[2023-07-22 01:21:43] [config] label-smoothing: 0
[2023-07-22 01:21:43] [config] layer-normalization: false
[2023-07-22 01:21:43] [config] learn-rate: 0.0001
[2023-07-22 01:21:43] [config] lemma-dependency: ""
[2023-07-22 01:21:43] [config] lemma-dim-emb: 0
[2023-07-22 01:21:43] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 01:21:43] [config] log-level: info
[2023-07-22 01:21:43] [config] log-time-zone: ""
[2023-07-22 01:21:43] [config] logical-epoch:
[2023-07-22 01:21:43] [config]   - 1e
[2023-07-22 01:21:43] [config]   - 0
[2023-07-22 01:21:43] [config] lr-decay: 0
[2023-07-22 01:21:43] [config] lr-decay-freq: 50000
[2023-07-22 01:21:43] [config] lr-decay-inv-sqrt:
[2023-07-22 01:21:43] [config]   - 0
[2023-07-22 01:21:43] [config] lr-decay-repeat-warmup: false
[2023-07-22 01:21:43] [config] lr-decay-reset-optimizer: false
[2023-07-22 01:21:43] [config] lr-decay-start:
[2023-07-22 01:21:43] [config]   - 10
[2023-07-22 01:21:43] [config]   - 1
[2023-07-22 01:21:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 01:21:43] [config] lr-report: false
[2023-07-22 01:21:43] [config] lr-warmup: 0
[2023-07-22 01:21:43] [config] lr-warmup-at-reload: false
[2023-07-22 01:21:43] [config] lr-warmup-cycle: false
[2023-07-22 01:21:43] [config] lr-warmup-start-rate: 0
[2023-07-22 01:21:43] [config] max-length: 50
[2023-07-22 01:21:43] [config] max-length-crop: true
[2023-07-22 01:21:43] [config] max-length-factor: 3
[2023-07-22 01:21:43] [config] maxi-batch: 100
[2023-07-22 01:21:43] [config] maxi-batch-sort: trg
[2023-07-22 01:21:43] [config] mini-batch: 64
[2023-07-22 01:21:43] [config] mini-batch-fit: true
[2023-07-22 01:21:43] [config] mini-batch-fit-step: 10
[2023-07-22 01:21:43] [config] mini-batch-round-up: true
[2023-07-22 01:21:43] [config] mini-batch-track-lr: false
[2023-07-22 01:21:43] [config] mini-batch-warmup: 0
[2023-07-22 01:21:43] [config] mini-batch-words: 0
[2023-07-22 01:21:43] [config] mini-batch-words-ref: 0
[2023-07-22 01:21:43] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 01:21:43] [config] multi-loss-type: sum
[2023-07-22 01:21:43] [config] n-best: false
[2023-07-22 01:21:43] [config] no-nccl: false
[2023-07-22 01:21:43] [config] no-reload: false
[2023-07-22 01:21:43] [config] no-restore-corpus: false
[2023-07-22 01:21:43] [config] normalize: 0
[2023-07-22 01:21:43] [config] normalize-gradient: false
[2023-07-22 01:21:43] [config] num-devices: 0
[2023-07-22 01:21:43] [config] optimizer: adam
[2023-07-22 01:21:43] [config] optimizer-delay: 1
[2023-07-22 01:21:43] [config] optimizer-params:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] output-omit-bias: false
[2023-07-22 01:21:43] [config] overwrite: true
[2023-07-22 01:21:43] [config] precision:
[2023-07-22 01:21:43] [config]   - float16
[2023-07-22 01:21:43] [config]   - float32
[2023-07-22 01:21:43] [config] pretrained-model: ""
[2023-07-22 01:21:43] [config] quantize-biases: false
[2023-07-22 01:21:43] [config] quantize-bits: 0
[2023-07-22 01:21:43] [config] quantize-log-based: false
[2023-07-22 01:21:43] [config] quantize-optimization-steps: 0
[2023-07-22 01:21:43] [config] quiet: false
[2023-07-22 01:21:43] [config] quiet-translation: true
[2023-07-22 01:21:43] [config] relative-paths: false
[2023-07-22 01:21:43] [config] right-left: false
[2023-07-22 01:21:43] [config] save-freq: 10000u
[2023-07-22 01:21:43] [config] seed: 1234
[2023-07-22 01:21:43] [config] sentencepiece-alphas:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] sentencepiece-max-lines: 2000000
[2023-07-22 01:21:43] [config] sentencepiece-options: ""
[2023-07-22 01:21:43] [config] sharding: global
[2023-07-22 01:21:43] [config] shuffle: data
[2023-07-22 01:21:43] [config] shuffle-in-ram: false
[2023-07-22 01:21:43] [config] sigterm: save-and-exit
[2023-07-22 01:21:43] [config] skip: false
[2023-07-22 01:21:43] [config] sqlite: ""
[2023-07-22 01:21:43] [config] sqlite-drop: false
[2023-07-22 01:21:43] [config] sync-freq: 200u
[2023-07-22 01:21:43] [config] sync-sgd: false
[2023-07-22 01:21:43] [config] tempdir: /tmp
[2023-07-22 01:21:43] [config] tied-embeddings: false
[2023-07-22 01:21:43] [config] tied-embeddings-all: true
[2023-07-22 01:21:43] [config] tied-embeddings-src: false
[2023-07-22 01:21:43] [config] train-embedder-rank:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] train-sets:
[2023-07-22 01:21:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 01:21:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 01:21:43] [config] transformer-aan-activation: swish
[2023-07-22 01:21:43] [config] transformer-aan-depth: 2
[2023-07-22 01:21:43] [config] transformer-aan-nogate: false
[2023-07-22 01:21:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 01:21:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 01:21:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 01:21:43] [config] transformer-depth-scaling: false
[2023-07-22 01:21:43] [config] transformer-dim-aan: 2048
[2023-07-22 01:21:43] [config] transformer-dim-ffn: 2048
[2023-07-22 01:21:43] [config] transformer-dropout: 0
[2023-07-22 01:21:43] [config] transformer-dropout-attention: 0
[2023-07-22 01:21:43] [config] transformer-dropout-ffn: 0
[2023-07-22 01:21:43] [config] transformer-ffn-activation: swish
[2023-07-22 01:21:43] [config] transformer-ffn-depth: 2
[2023-07-22 01:21:43] [config] transformer-guided-alignment-layer: last
[2023-07-22 01:21:43] [config] transformer-heads: 8
[2023-07-22 01:21:43] [config] transformer-no-projection: false
[2023-07-22 01:21:43] [config] transformer-pool: false
[2023-07-22 01:21:43] [config] transformer-postprocess: dan
[2023-07-22 01:21:43] [config] transformer-postprocess-emb: d
[2023-07-22 01:21:43] [config] transformer-postprocess-top: ""
[2023-07-22 01:21:43] [config] transformer-preprocess: ""
[2023-07-22 01:21:43] [config] transformer-tied-layers:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] transformer-train-position-embeddings: false
[2023-07-22 01:21:43] [config] tsv: false
[2023-07-22 01:21:43] [config] tsv-fields: 0
[2023-07-22 01:21:43] [config] type: amun
[2023-07-22 01:21:43] [config] ulr: false
[2023-07-22 01:21:43] [config] ulr-dim-emb: 0
[2023-07-22 01:21:43] [config] ulr-dropout: 0
[2023-07-22 01:21:43] [config] ulr-keys-vectors: ""
[2023-07-22 01:21:43] [config] ulr-query-vectors: ""
[2023-07-22 01:21:43] [config] ulr-softmax-temperature: 1
[2023-07-22 01:21:43] [config] ulr-trainable-transformation: false
[2023-07-22 01:21:43] [config] unlikelihood-loss: false
[2023-07-22 01:21:43] [config] valid-freq: 50000000
[2023-07-22 01:21:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 01:21:43] [config] valid-max-length: 1000
[2023-07-22 01:21:43] [config] valid-metrics:
[2023-07-22 01:21:43] [config]   - cross-entropy
[2023-07-22 01:21:43] [config]   - translation
[2023-07-22 01:21:43] [config] valid-mini-batch: 32
[2023-07-22 01:21:43] [config] valid-reset-stalled: false
[2023-07-22 01:21:43] [config] valid-script-args:
[2023-07-22 01:21:43] [config]   []
[2023-07-22 01:21:43] [config] valid-script-path: ""
[2023-07-22 01:21:43] [config] valid-sets:
[2023-07-22 01:21:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 01:21:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 01:21:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 01:21:43] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 01:21:43] [config] vocabs:
[2023-07-22 01:21:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 01:21:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 01:21:43] [config] word-penalty: 0
[2023-07-22 01:21:43] [config] word-scores: false
[2023-07-22 01:21:43] [config] workspace: 5500
[2023-07-22 01:21:43] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 01:21:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:21:43] [training] Using single-device training
[2023-07-22 01:21:43] Synced seed 1234
[2023-07-22 01:21:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 01:21:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 01:21:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 01:21:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 01:21:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 01:21:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:21:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 01:21:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 01:21:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 01:21:44] [comm] Using global sharding
[2023-07-22 01:21:44] [comm] NCCLCommunicators constructed successfully
[2023-07-22 01:21:44] [training] Using 1 GPUs
[2023-07-22 01:21:44] [logits] Applying loss function for 1 factor(s)
[2023-07-22 01:21:44] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:21:45] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 01:21:45] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:27:04] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 01:27:04] [valid] No post-processing script given for validating translator
[2023-07-22 01:27:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:27:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 01:27:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 01:27:05] [comm] Using global sharding
[2023-07-22 01:27:05] [comm] NCCLCommunicators constructed successfully
[2023-07-22 01:27:05] [training] Using 1 GPUs
[2023-07-22 01:27:05] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 01:27:06] Allocating memory for general optimizer shards
[2023-07-22 01:27:06] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:27:06] Loading Adam parameters
[2023-07-22 01:27:06] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:27:06] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:27:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 01:27:06] [data] Restoring the corpus state to epoch 101, batch 3200
[2023-07-22 01:27:06] [data] Shuffling data
[2023-07-22 01:27:06] [data] Done reading 20,192 sentences
[2023-07-22 01:27:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:27:07] Training started
[2023-07-22 01:27:07] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 01:27:08] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:27:14] Parameter type float16, optimization type float32, casting types true
[2023-07-22 01:30:52] Seen 20,192 samples
[2023-07-22 01:30:52] Starting data epoch 102 in logical epoch 102
[2023-07-22 01:30:52] [data] Shuffling data
[2023-07-22 01:30:52] [data] Done reading 20,192 sentences
[2023-07-22 01:30:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:34:44] Seen 20,192 samples
[2023-07-22 01:34:44] Starting data epoch 103 in logical epoch 103
[2023-07-22 01:34:44] [data] Shuffling data
[2023-07-22 01:34:44] [data] Done reading 20,192 sentences
[2023-07-22 01:34:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:38:42] Seen 20,192 samples
[2023-07-22 01:38:42] Starting data epoch 104 in logical epoch 104
[2023-07-22 01:38:42] [data] Shuffling data
[2023-07-22 01:38:42] [data] Done reading 20,192 sentences
[2023-07-22 01:38:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:42:39] Seen 20,192 samples
[2023-07-22 01:42:39] Starting data epoch 105 in logical epoch 105
[2023-07-22 01:42:39] [data] Shuffling data
[2023-07-22 01:42:39] [data] Done reading 20,192 sentences
[2023-07-22 01:42:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:46:31] Seen 20,192 samples
[2023-07-22 01:46:31] Starting data epoch 106 in logical epoch 106
[2023-07-22 01:46:31] [data] Shuffling data
[2023-07-22 01:46:31] [data] Done reading 20,192 sentences
[2023-07-22 01:46:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:50:25] Seen 20,192 samples
[2023-07-22 01:50:25] Starting data epoch 107 in logical epoch 107
[2023-07-22 01:50:25] [data] Shuffling data
[2023-07-22 01:50:25] [data] Done reading 20,192 sentences
[2023-07-22 01:50:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:54:20] Seen 20,192 samples
[2023-07-22 01:54:20] Starting data epoch 108 in logical epoch 108
[2023-07-22 01:54:20] [data] Shuffling data
[2023-07-22 01:54:20] [data] Done reading 20,192 sentences
[2023-07-22 01:54:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:58:19] Seen 20,192 samples
[2023-07-22 01:58:19] Starting data epoch 109 in logical epoch 109
[2023-07-22 01:58:19] [data] Shuffling data
[2023-07-22 01:58:19] [data] Done reading 20,192 sentences
[2023-07-22 01:58:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:02:19] Seen 20,192 samples
[2023-07-22 02:02:19] Starting data epoch 110 in logical epoch 110
[2023-07-22 02:02:19] [data] Shuffling data
[2023-07-22 02:02:19] [data] Done reading 20,192 sentences
[2023-07-22 02:02:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:06:11] Seen 20,192 samples
[2023-07-22 02:06:11] Starting data epoch 111 in logical epoch 111
[2023-07-22 02:06:11] Training finished
[2023-07-22 02:06:26] [valid] Ep. 111 : Up. 3520 : cross-entropy : 141.593 : new best
[2023-07-22 02:08:15] [valid] Ep. 111 : Up. 3520 : translation : 0 : new best
[2023-07-22 02:08:15] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 02:08:17] Saving Adam parameters
[2023-07-22 02:08:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 02:08:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:08:25] [marian] Running on node23.datos.cluster.uy as process 39942 with command line:
[2023-07-22 02:08:25] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 02:08:25] [config] after: 0e
[2023-07-22 02:08:25] [config] after-batches: 0
[2023-07-22 02:08:25] [config] after-epochs: 120
[2023-07-22 02:08:25] [config] all-caps-every: 0
[2023-07-22 02:08:25] [config] allow-unk: false
[2023-07-22 02:08:25] [config] authors: false
[2023-07-22 02:08:25] [config] beam-size: 12
[2023-07-22 02:08:25] [config] bert-class-symbol: "[CLS]"
[2023-07-22 02:08:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 02:08:25] [config] bert-masking-fraction: 0.15
[2023-07-22 02:08:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 02:08:25] [config] bert-train-type-embeddings: true
[2023-07-22 02:08:25] [config] bert-type-vocab-size: 2
[2023-07-22 02:08:25] [config] build-info: ""
[2023-07-22 02:08:25] [config] check-gradient-nan: false
[2023-07-22 02:08:25] [config] check-nan: false
[2023-07-22 02:08:25] [config] cite: false
[2023-07-22 02:08:25] [config] clip-norm: 1
[2023-07-22 02:08:25] [config] cost-scaling:
[2023-07-22 02:08:25] [config]   - 256.f
[2023-07-22 02:08:25] [config]   - 1000
[2023-07-22 02:08:25] [config]   - 2.f
[2023-07-22 02:08:25] [config]   - 256.f
[2023-07-22 02:08:25] [config] cost-type: ce-sum
[2023-07-22 02:08:25] [config] cpu-threads: 0
[2023-07-22 02:08:25] [config] data-threads: 8
[2023-07-22 02:08:25] [config] data-weighting: ""
[2023-07-22 02:08:25] [config] data-weighting-type: sentence
[2023-07-22 02:08:25] [config] dec-cell: gru
[2023-07-22 02:08:25] [config] dec-cell-base-depth: 2
[2023-07-22 02:08:25] [config] dec-cell-high-depth: 1
[2023-07-22 02:08:25] [config] dec-depth: 1
[2023-07-22 02:08:25] [config] devices:
[2023-07-22 02:08:25] [config]   - 0
[2023-07-22 02:08:25] [config] dim-emb: 512
[2023-07-22 02:08:25] [config] dim-rnn: 1024
[2023-07-22 02:08:25] [config] dim-vocabs:
[2023-07-22 02:08:25] [config]   - 16384
[2023-07-22 02:08:25] [config]   - 16384
[2023-07-22 02:08:25] [config] disp-first: 0
[2023-07-22 02:08:25] [config] disp-freq: 1000u
[2023-07-22 02:08:25] [config] disp-label-counts: true
[2023-07-22 02:08:25] [config] dropout-rnn: 0.5
[2023-07-22 02:08:25] [config] dropout-src: 0
[2023-07-22 02:08:25] [config] dropout-trg: 0
[2023-07-22 02:08:25] [config] dump-config: ""
[2023-07-22 02:08:25] [config] dynamic-gradient-scaling:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] early-stopping: 200
[2023-07-22 02:08:25] [config] early-stopping-on: first
[2023-07-22 02:08:25] [config] embedding-fix-src: false
[2023-07-22 02:08:25] [config] embedding-fix-trg: false
[2023-07-22 02:08:25] [config] embedding-normalization: false
[2023-07-22 02:08:25] [config] embedding-vectors:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] enc-cell: gru
[2023-07-22 02:08:25] [config] enc-cell-depth: 1
[2023-07-22 02:08:25] [config] enc-depth: 1
[2023-07-22 02:08:25] [config] enc-type: bidirectional
[2023-07-22 02:08:25] [config] english-title-case-every: 0
[2023-07-22 02:08:25] [config] exponential-smoothing: 0
[2023-07-22 02:08:25] [config] factor-weight: 1
[2023-07-22 02:08:25] [config] factors-combine: sum
[2023-07-22 02:08:25] [config] factors-dim-emb: 0
[2023-07-22 02:08:25] [config] gradient-checkpointing: false
[2023-07-22 02:08:25] [config] gradient-norm-average-window: 100
[2023-07-22 02:08:25] [config] guided-alignment: none
[2023-07-22 02:08:25] [config] guided-alignment-cost: mse
[2023-07-22 02:08:25] [config] guided-alignment-weight: 0.1
[2023-07-22 02:08:25] [config] ignore-model-config: false
[2023-07-22 02:08:25] [config] input-types:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] interpolate-env-vars: false
[2023-07-22 02:08:25] [config] keep-best: false
[2023-07-22 02:08:25] [config] label-smoothing: 0
[2023-07-22 02:08:25] [config] layer-normalization: false
[2023-07-22 02:08:25] [config] learn-rate: 0.0001
[2023-07-22 02:08:25] [config] lemma-dependency: ""
[2023-07-22 02:08:25] [config] lemma-dim-emb: 0
[2023-07-22 02:08:25] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 02:08:25] [config] log-level: info
[2023-07-22 02:08:25] [config] log-time-zone: ""
[2023-07-22 02:08:25] [config] logical-epoch:
[2023-07-22 02:08:25] [config]   - 1e
[2023-07-22 02:08:25] [config]   - 0
[2023-07-22 02:08:25] [config] lr-decay: 0
[2023-07-22 02:08:25] [config] lr-decay-freq: 50000
[2023-07-22 02:08:25] [config] lr-decay-inv-sqrt:
[2023-07-22 02:08:25] [config]   - 0
[2023-07-22 02:08:25] [config] lr-decay-repeat-warmup: false
[2023-07-22 02:08:25] [config] lr-decay-reset-optimizer: false
[2023-07-22 02:08:25] [config] lr-decay-start:
[2023-07-22 02:08:25] [config]   - 10
[2023-07-22 02:08:25] [config]   - 1
[2023-07-22 02:08:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 02:08:25] [config] lr-report: false
[2023-07-22 02:08:25] [config] lr-warmup: 0
[2023-07-22 02:08:25] [config] lr-warmup-at-reload: false
[2023-07-22 02:08:25] [config] lr-warmup-cycle: false
[2023-07-22 02:08:25] [config] lr-warmup-start-rate: 0
[2023-07-22 02:08:25] [config] max-length: 50
[2023-07-22 02:08:25] [config] max-length-crop: true
[2023-07-22 02:08:25] [config] max-length-factor: 3
[2023-07-22 02:08:25] [config] maxi-batch: 100
[2023-07-22 02:08:25] [config] maxi-batch-sort: trg
[2023-07-22 02:08:25] [config] mini-batch: 64
[2023-07-22 02:08:25] [config] mini-batch-fit: true
[2023-07-22 02:08:25] [config] mini-batch-fit-step: 10
[2023-07-22 02:08:25] [config] mini-batch-round-up: true
[2023-07-22 02:08:25] [config] mini-batch-track-lr: false
[2023-07-22 02:08:25] [config] mini-batch-warmup: 0
[2023-07-22 02:08:25] [config] mini-batch-words: 0
[2023-07-22 02:08:25] [config] mini-batch-words-ref: 0
[2023-07-22 02:08:25] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 02:08:25] [config] multi-loss-type: sum
[2023-07-22 02:08:25] [config] n-best: false
[2023-07-22 02:08:25] [config] no-nccl: false
[2023-07-22 02:08:25] [config] no-reload: false
[2023-07-22 02:08:25] [config] no-restore-corpus: false
[2023-07-22 02:08:25] [config] normalize: 0
[2023-07-22 02:08:25] [config] normalize-gradient: false
[2023-07-22 02:08:25] [config] num-devices: 0
[2023-07-22 02:08:25] [config] optimizer: adam
[2023-07-22 02:08:25] [config] optimizer-delay: 1
[2023-07-22 02:08:25] [config] optimizer-params:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] output-omit-bias: false
[2023-07-22 02:08:25] [config] overwrite: true
[2023-07-22 02:08:25] [config] precision:
[2023-07-22 02:08:25] [config]   - float16
[2023-07-22 02:08:25] [config]   - float32
[2023-07-22 02:08:25] [config] pretrained-model: ""
[2023-07-22 02:08:25] [config] quantize-biases: false
[2023-07-22 02:08:25] [config] quantize-bits: 0
[2023-07-22 02:08:25] [config] quantize-log-based: false
[2023-07-22 02:08:25] [config] quantize-optimization-steps: 0
[2023-07-22 02:08:25] [config] quiet: false
[2023-07-22 02:08:25] [config] quiet-translation: true
[2023-07-22 02:08:25] [config] relative-paths: false
[2023-07-22 02:08:25] [config] right-left: false
[2023-07-22 02:08:25] [config] save-freq: 10000u
[2023-07-22 02:08:25] [config] seed: 1234
[2023-07-22 02:08:25] [config] sentencepiece-alphas:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] sentencepiece-max-lines: 2000000
[2023-07-22 02:08:25] [config] sentencepiece-options: ""
[2023-07-22 02:08:25] [config] sharding: global
[2023-07-22 02:08:25] [config] shuffle: data
[2023-07-22 02:08:25] [config] shuffle-in-ram: false
[2023-07-22 02:08:25] [config] sigterm: save-and-exit
[2023-07-22 02:08:25] [config] skip: false
[2023-07-22 02:08:25] [config] sqlite: ""
[2023-07-22 02:08:25] [config] sqlite-drop: false
[2023-07-22 02:08:25] [config] sync-freq: 200u
[2023-07-22 02:08:25] [config] sync-sgd: false
[2023-07-22 02:08:25] [config] tempdir: /tmp
[2023-07-22 02:08:25] [config] tied-embeddings: false
[2023-07-22 02:08:25] [config] tied-embeddings-all: true
[2023-07-22 02:08:25] [config] tied-embeddings-src: false
[2023-07-22 02:08:25] [config] train-embedder-rank:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] train-sets:
[2023-07-22 02:08:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 02:08:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 02:08:25] [config] transformer-aan-activation: swish
[2023-07-22 02:08:25] [config] transformer-aan-depth: 2
[2023-07-22 02:08:25] [config] transformer-aan-nogate: false
[2023-07-22 02:08:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 02:08:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 02:08:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 02:08:25] [config] transformer-depth-scaling: false
[2023-07-22 02:08:25] [config] transformer-dim-aan: 2048
[2023-07-22 02:08:25] [config] transformer-dim-ffn: 2048
[2023-07-22 02:08:25] [config] transformer-dropout: 0
[2023-07-22 02:08:25] [config] transformer-dropout-attention: 0
[2023-07-22 02:08:25] [config] transformer-dropout-ffn: 0
[2023-07-22 02:08:25] [config] transformer-ffn-activation: swish
[2023-07-22 02:08:25] [config] transformer-ffn-depth: 2
[2023-07-22 02:08:25] [config] transformer-guided-alignment-layer: last
[2023-07-22 02:08:25] [config] transformer-heads: 8
[2023-07-22 02:08:25] [config] transformer-no-projection: false
[2023-07-22 02:08:25] [config] transformer-pool: false
[2023-07-22 02:08:25] [config] transformer-postprocess: dan
[2023-07-22 02:08:25] [config] transformer-postprocess-emb: d
[2023-07-22 02:08:25] [config] transformer-postprocess-top: ""
[2023-07-22 02:08:25] [config] transformer-preprocess: ""
[2023-07-22 02:08:25] [config] transformer-tied-layers:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] transformer-train-position-embeddings: false
[2023-07-22 02:08:25] [config] tsv: false
[2023-07-22 02:08:25] [config] tsv-fields: 0
[2023-07-22 02:08:25] [config] type: amun
[2023-07-22 02:08:25] [config] ulr: false
[2023-07-22 02:08:25] [config] ulr-dim-emb: 0
[2023-07-22 02:08:25] [config] ulr-dropout: 0
[2023-07-22 02:08:25] [config] ulr-keys-vectors: ""
[2023-07-22 02:08:25] [config] ulr-query-vectors: ""
[2023-07-22 02:08:25] [config] ulr-softmax-temperature: 1
[2023-07-22 02:08:25] [config] ulr-trainable-transformation: false
[2023-07-22 02:08:25] [config] unlikelihood-loss: false
[2023-07-22 02:08:25] [config] valid-freq: 50000000
[2023-07-22 02:08:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 02:08:25] [config] valid-max-length: 1000
[2023-07-22 02:08:25] [config] valid-metrics:
[2023-07-22 02:08:25] [config]   - cross-entropy
[2023-07-22 02:08:25] [config]   - translation
[2023-07-22 02:08:25] [config] valid-mini-batch: 32
[2023-07-22 02:08:25] [config] valid-reset-stalled: false
[2023-07-22 02:08:25] [config] valid-script-args:
[2023-07-22 02:08:25] [config]   []
[2023-07-22 02:08:25] [config] valid-script-path: ""
[2023-07-22 02:08:25] [config] valid-sets:
[2023-07-22 02:08:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 02:08:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 02:08:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 02:08:25] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:08:25] [config] vocabs:
[2023-07-22 02:08:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:08:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:08:25] [config] word-penalty: 0
[2023-07-22 02:08:25] [config] word-scores: false
[2023-07-22 02:08:25] [config] workspace: 5500
[2023-07-22 02:08:25] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:08:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:08:25] [training] Using single-device training
[2023-07-22 02:08:25] Synced seed 1234
[2023-07-22 02:08:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:08:25] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 02:08:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:08:25] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 02:08:25] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 02:08:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:08:25] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 02:08:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:08:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:08:27] [comm] Using global sharding
[2023-07-22 02:08:27] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:08:27] [training] Using 1 GPUs
[2023-07-22 02:08:27] [logits] Applying loss function for 1 factor(s)
[2023-07-22 02:08:27] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:08:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 02:08:27] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:14:36] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 02:14:36] [valid] No post-processing script given for validating translator
[2023-07-22 02:14:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:14:36] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:14:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:14:36] [comm] Using global sharding
[2023-07-22 02:14:36] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:14:36] [training] Using 1 GPUs
[2023-07-22 02:14:36] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 02:14:37] Allocating memory for general optimizer shards
[2023-07-22 02:14:37] [memory] Reserving 322 MB, device gpu0
[2023-07-22 02:14:37] Loading Adam parameters
[2023-07-22 02:14:37] [memory] Reserving 322 MB, device gpu0
[2023-07-22 02:14:37] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:14:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 02:14:38] [data] Restoring the corpus state to epoch 111, batch 3520
[2023-07-22 02:14:38] [data] Shuffling data
[2023-07-22 02:14:38] [data] Done reading 20,192 sentences
[2023-07-22 02:14:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:14:38] Training started
[2023-07-22 02:14:38] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 02:14:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:14:53] Parameter type float16, optimization type float32, casting types true
[2023-07-22 02:18:37] Seen 20,192 samples
[2023-07-22 02:18:37] Starting data epoch 112 in logical epoch 112
[2023-07-22 02:18:37] [data] Shuffling data
[2023-07-22 02:18:37] [data] Done reading 20,192 sentences
[2023-07-22 02:18:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:22:29] Seen 20,192 samples
[2023-07-22 02:22:29] Starting data epoch 113 in logical epoch 113
[2023-07-22 02:22:29] [data] Shuffling data
[2023-07-22 02:22:29] [data] Done reading 20,192 sentences
[2023-07-22 02:22:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:26:20] Seen 20,192 samples
[2023-07-22 02:26:20] Starting data epoch 114 in logical epoch 114
[2023-07-22 02:26:20] [data] Shuffling data
[2023-07-22 02:26:20] [data] Done reading 20,192 sentences
[2023-07-22 02:26:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:30:11] Seen 20,192 samples
[2023-07-22 02:30:11] Starting data epoch 115 in logical epoch 115
[2023-07-22 02:30:11] [data] Shuffling data
[2023-07-22 02:30:11] [data] Done reading 20,192 sentences
[2023-07-22 02:30:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:33:50] Seen 20,192 samples
[2023-07-22 02:33:50] Starting data epoch 116 in logical epoch 116
[2023-07-22 02:33:50] [data] Shuffling data
[2023-07-22 02:33:50] [data] Done reading 20,192 sentences
[2023-07-22 02:33:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:37:39] Seen 20,192 samples
[2023-07-22 02:37:39] Starting data epoch 117 in logical epoch 117
[2023-07-22 02:37:39] [data] Shuffling data
[2023-07-22 02:37:39] [data] Done reading 20,192 sentences
[2023-07-22 02:37:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:41:36] Seen 20,192 samples
[2023-07-22 02:41:36] Starting data epoch 118 in logical epoch 118
[2023-07-22 02:41:36] [data] Shuffling data
[2023-07-22 02:41:36] [data] Done reading 20,192 sentences
[2023-07-22 02:41:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:45:37] Seen 20,192 samples
[2023-07-22 02:45:37] Starting data epoch 119 in logical epoch 119
[2023-07-22 02:45:37] [data] Shuffling data
[2023-07-22 02:45:37] [data] Done reading 20,192 sentences
[2023-07-22 02:45:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:49:33] Seen 20,192 samples
[2023-07-22 02:49:33] Starting data epoch 120 in logical epoch 120
[2023-07-22 02:49:33] [data] Shuffling data
[2023-07-22 02:49:33] [data] Done reading 20,192 sentences
[2023-07-22 02:49:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:53:10] Seen 20,192 samples
[2023-07-22 02:53:12] Starting data epoch 121 in logical epoch 121
[2023-07-22 02:53:12] Training finished
[2023-07-22 02:53:24] [valid] Ep. 121 : Up. 3840 : cross-entropy : 139.99 : new best
[2023-07-22 02:57:27] [valid] Ep. 121 : Up. 3840 : translation : 0 : new best
[2023-07-22 02:57:27] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 02:57:30] Saving Adam parameters
[2023-07-22 02:57:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 02:57:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:57:37] [marian] Running on node23.datos.cluster.uy as process 2703 with command line:
[2023-07-22 02:57:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 02:57:37] [config] after: 0e
[2023-07-22 02:57:37] [config] after-batches: 0
[2023-07-22 02:57:37] [config] after-epochs: 130
[2023-07-22 02:57:37] [config] all-caps-every: 0
[2023-07-22 02:57:37] [config] allow-unk: false
[2023-07-22 02:57:37] [config] authors: false
[2023-07-22 02:57:37] [config] beam-size: 12
[2023-07-22 02:57:37] [config] bert-class-symbol: "[CLS]"
[2023-07-22 02:57:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 02:57:37] [config] bert-masking-fraction: 0.15
[2023-07-22 02:57:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 02:57:37] [config] bert-train-type-embeddings: true
[2023-07-22 02:57:37] [config] bert-type-vocab-size: 2
[2023-07-22 02:57:37] [config] build-info: ""
[2023-07-22 02:57:37] [config] check-gradient-nan: false
[2023-07-22 02:57:37] [config] check-nan: false
[2023-07-22 02:57:37] [config] cite: false
[2023-07-22 02:57:37] [config] clip-norm: 1
[2023-07-22 02:57:37] [config] cost-scaling:
[2023-07-22 02:57:37] [config]   - 256.f
[2023-07-22 02:57:37] [config]   - 1000
[2023-07-22 02:57:37] [config]   - 2.f
[2023-07-22 02:57:37] [config]   - 256.f
[2023-07-22 02:57:37] [config] cost-type: ce-sum
[2023-07-22 02:57:37] [config] cpu-threads: 0
[2023-07-22 02:57:37] [config] data-threads: 8
[2023-07-22 02:57:37] [config] data-weighting: ""
[2023-07-22 02:57:37] [config] data-weighting-type: sentence
[2023-07-22 02:57:37] [config] dec-cell: gru
[2023-07-22 02:57:37] [config] dec-cell-base-depth: 2
[2023-07-22 02:57:37] [config] dec-cell-high-depth: 1
[2023-07-22 02:57:37] [config] dec-depth: 1
[2023-07-22 02:57:37] [config] devices:
[2023-07-22 02:57:37] [config]   - 0
[2023-07-22 02:57:37] [config] dim-emb: 512
[2023-07-22 02:57:37] [config] dim-rnn: 1024
[2023-07-22 02:57:37] [config] dim-vocabs:
[2023-07-22 02:57:37] [config]   - 16384
[2023-07-22 02:57:37] [config]   - 16384
[2023-07-22 02:57:37] [config] disp-first: 0
[2023-07-22 02:57:37] [config] disp-freq: 1000u
[2023-07-22 02:57:37] [config] disp-label-counts: true
[2023-07-22 02:57:37] [config] dropout-rnn: 0.5
[2023-07-22 02:57:37] [config] dropout-src: 0
[2023-07-22 02:57:37] [config] dropout-trg: 0
[2023-07-22 02:57:37] [config] dump-config: ""
[2023-07-22 02:57:37] [config] dynamic-gradient-scaling:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] early-stopping: 200
[2023-07-22 02:57:37] [config] early-stopping-on: first
[2023-07-22 02:57:37] [config] embedding-fix-src: false
[2023-07-22 02:57:37] [config] embedding-fix-trg: false
[2023-07-22 02:57:37] [config] embedding-normalization: false
[2023-07-22 02:57:37] [config] embedding-vectors:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] enc-cell: gru
[2023-07-22 02:57:37] [config] enc-cell-depth: 1
[2023-07-22 02:57:37] [config] enc-depth: 1
[2023-07-22 02:57:37] [config] enc-type: bidirectional
[2023-07-22 02:57:37] [config] english-title-case-every: 0
[2023-07-22 02:57:37] [config] exponential-smoothing: 0
[2023-07-22 02:57:37] [config] factor-weight: 1
[2023-07-22 02:57:37] [config] factors-combine: sum
[2023-07-22 02:57:37] [config] factors-dim-emb: 0
[2023-07-22 02:57:37] [config] gradient-checkpointing: false
[2023-07-22 02:57:37] [config] gradient-norm-average-window: 100
[2023-07-22 02:57:37] [config] guided-alignment: none
[2023-07-22 02:57:37] [config] guided-alignment-cost: mse
[2023-07-22 02:57:37] [config] guided-alignment-weight: 0.1
[2023-07-22 02:57:37] [config] ignore-model-config: false
[2023-07-22 02:57:37] [config] input-types:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] interpolate-env-vars: false
[2023-07-22 02:57:37] [config] keep-best: false
[2023-07-22 02:57:37] [config] label-smoothing: 0
[2023-07-22 02:57:37] [config] layer-normalization: false
[2023-07-22 02:57:37] [config] learn-rate: 0.0001
[2023-07-22 02:57:37] [config] lemma-dependency: ""
[2023-07-22 02:57:37] [config] lemma-dim-emb: 0
[2023-07-22 02:57:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 02:57:37] [config] log-level: info
[2023-07-22 02:57:37] [config] log-time-zone: ""
[2023-07-22 02:57:37] [config] logical-epoch:
[2023-07-22 02:57:37] [config]   - 1e
[2023-07-22 02:57:37] [config]   - 0
[2023-07-22 02:57:37] [config] lr-decay: 0
[2023-07-22 02:57:37] [config] lr-decay-freq: 50000
[2023-07-22 02:57:37] [config] lr-decay-inv-sqrt:
[2023-07-22 02:57:37] [config]   - 0
[2023-07-22 02:57:37] [config] lr-decay-repeat-warmup: false
[2023-07-22 02:57:37] [config] lr-decay-reset-optimizer: false
[2023-07-22 02:57:37] [config] lr-decay-start:
[2023-07-22 02:57:37] [config]   - 10
[2023-07-22 02:57:37] [config]   - 1
[2023-07-22 02:57:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 02:57:37] [config] lr-report: false
[2023-07-22 02:57:37] [config] lr-warmup: 0
[2023-07-22 02:57:37] [config] lr-warmup-at-reload: false
[2023-07-22 02:57:37] [config] lr-warmup-cycle: false
[2023-07-22 02:57:37] [config] lr-warmup-start-rate: 0
[2023-07-22 02:57:37] [config] max-length: 50
[2023-07-22 02:57:37] [config] max-length-crop: true
[2023-07-22 02:57:37] [config] max-length-factor: 3
[2023-07-22 02:57:37] [config] maxi-batch: 100
[2023-07-22 02:57:37] [config] maxi-batch-sort: trg
[2023-07-22 02:57:37] [config] mini-batch: 64
[2023-07-22 02:57:37] [config] mini-batch-fit: true
[2023-07-22 02:57:37] [config] mini-batch-fit-step: 10
[2023-07-22 02:57:37] [config] mini-batch-round-up: true
[2023-07-22 02:57:37] [config] mini-batch-track-lr: false
[2023-07-22 02:57:37] [config] mini-batch-warmup: 0
[2023-07-22 02:57:37] [config] mini-batch-words: 0
[2023-07-22 02:57:37] [config] mini-batch-words-ref: 0
[2023-07-22 02:57:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 02:57:37] [config] multi-loss-type: sum
[2023-07-22 02:57:37] [config] n-best: false
[2023-07-22 02:57:37] [config] no-nccl: false
[2023-07-22 02:57:37] [config] no-reload: false
[2023-07-22 02:57:37] [config] no-restore-corpus: false
[2023-07-22 02:57:37] [config] normalize: 0
[2023-07-22 02:57:37] [config] normalize-gradient: false
[2023-07-22 02:57:37] [config] num-devices: 0
[2023-07-22 02:57:37] [config] optimizer: adam
[2023-07-22 02:57:37] [config] optimizer-delay: 1
[2023-07-22 02:57:37] [config] optimizer-params:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] output-omit-bias: false
[2023-07-22 02:57:37] [config] overwrite: true
[2023-07-22 02:57:37] [config] precision:
[2023-07-22 02:57:37] [config]   - float16
[2023-07-22 02:57:37] [config]   - float32
[2023-07-22 02:57:37] [config] pretrained-model: ""
[2023-07-22 02:57:37] [config] quantize-biases: false
[2023-07-22 02:57:37] [config] quantize-bits: 0
[2023-07-22 02:57:37] [config] quantize-log-based: false
[2023-07-22 02:57:37] [config] quantize-optimization-steps: 0
[2023-07-22 02:57:37] [config] quiet: false
[2023-07-22 02:57:37] [config] quiet-translation: true
[2023-07-22 02:57:37] [config] relative-paths: false
[2023-07-22 02:57:37] [config] right-left: false
[2023-07-22 02:57:37] [config] save-freq: 10000u
[2023-07-22 02:57:37] [config] seed: 1234
[2023-07-22 02:57:37] [config] sentencepiece-alphas:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] sentencepiece-max-lines: 2000000
[2023-07-22 02:57:37] [config] sentencepiece-options: ""
[2023-07-22 02:57:37] [config] sharding: global
[2023-07-22 02:57:37] [config] shuffle: data
[2023-07-22 02:57:37] [config] shuffle-in-ram: false
[2023-07-22 02:57:37] [config] sigterm: save-and-exit
[2023-07-22 02:57:37] [config] skip: false
[2023-07-22 02:57:37] [config] sqlite: ""
[2023-07-22 02:57:37] [config] sqlite-drop: false
[2023-07-22 02:57:37] [config] sync-freq: 200u
[2023-07-22 02:57:37] [config] sync-sgd: false
[2023-07-22 02:57:37] [config] tempdir: /tmp
[2023-07-22 02:57:37] [config] tied-embeddings: false
[2023-07-22 02:57:37] [config] tied-embeddings-all: true
[2023-07-22 02:57:37] [config] tied-embeddings-src: false
[2023-07-22 02:57:37] [config] train-embedder-rank:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] train-sets:
[2023-07-22 02:57:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 02:57:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 02:57:37] [config] transformer-aan-activation: swish
[2023-07-22 02:57:37] [config] transformer-aan-depth: 2
[2023-07-22 02:57:37] [config] transformer-aan-nogate: false
[2023-07-22 02:57:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 02:57:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 02:57:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 02:57:37] [config] transformer-depth-scaling: false
[2023-07-22 02:57:37] [config] transformer-dim-aan: 2048
[2023-07-22 02:57:37] [config] transformer-dim-ffn: 2048
[2023-07-22 02:57:37] [config] transformer-dropout: 0
[2023-07-22 02:57:37] [config] transformer-dropout-attention: 0
[2023-07-22 02:57:37] [config] transformer-dropout-ffn: 0
[2023-07-22 02:57:37] [config] transformer-ffn-activation: swish
[2023-07-22 02:57:37] [config] transformer-ffn-depth: 2
[2023-07-22 02:57:37] [config] transformer-guided-alignment-layer: last
[2023-07-22 02:57:37] [config] transformer-heads: 8
[2023-07-22 02:57:37] [config] transformer-no-projection: false
[2023-07-22 02:57:37] [config] transformer-pool: false
[2023-07-22 02:57:37] [config] transformer-postprocess: dan
[2023-07-22 02:57:37] [config] transformer-postprocess-emb: d
[2023-07-22 02:57:37] [config] transformer-postprocess-top: ""
[2023-07-22 02:57:37] [config] transformer-preprocess: ""
[2023-07-22 02:57:37] [config] transformer-tied-layers:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] transformer-train-position-embeddings: false
[2023-07-22 02:57:37] [config] tsv: false
[2023-07-22 02:57:37] [config] tsv-fields: 0
[2023-07-22 02:57:37] [config] type: amun
[2023-07-22 02:57:37] [config] ulr: false
[2023-07-22 02:57:37] [config] ulr-dim-emb: 0
[2023-07-22 02:57:37] [config] ulr-dropout: 0
[2023-07-22 02:57:37] [config] ulr-keys-vectors: ""
[2023-07-22 02:57:37] [config] ulr-query-vectors: ""
[2023-07-22 02:57:37] [config] ulr-softmax-temperature: 1
[2023-07-22 02:57:37] [config] ulr-trainable-transformation: false
[2023-07-22 02:57:37] [config] unlikelihood-loss: false
[2023-07-22 02:57:37] [config] valid-freq: 50000000
[2023-07-22 02:57:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 02:57:37] [config] valid-max-length: 1000
[2023-07-22 02:57:37] [config] valid-metrics:
[2023-07-22 02:57:37] [config]   - cross-entropy
[2023-07-22 02:57:37] [config]   - translation
[2023-07-22 02:57:37] [config] valid-mini-batch: 32
[2023-07-22 02:57:37] [config] valid-reset-stalled: false
[2023-07-22 02:57:37] [config] valid-script-args:
[2023-07-22 02:57:37] [config]   []
[2023-07-22 02:57:37] [config] valid-script-path: ""
[2023-07-22 02:57:37] [config] valid-sets:
[2023-07-22 02:57:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 02:57:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 02:57:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 02:57:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:57:37] [config] vocabs:
[2023-07-22 02:57:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:57:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:57:37] [config] word-penalty: 0
[2023-07-22 02:57:37] [config] word-scores: false
[2023-07-22 02:57:37] [config] workspace: 5500
[2023-07-22 02:57:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:57:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:57:37] [training] Using single-device training
[2023-07-22 02:57:39] Synced seed 1234
[2023-07-22 02:57:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:57:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 02:57:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:57:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 02:57:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 02:57:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:57:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 02:57:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:57:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:57:40] [comm] Using global sharding
[2023-07-22 02:57:40] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:57:40] [training] Using 1 GPUs
[2023-07-22 02:57:40] [logits] Applying loss function for 1 factor(s)
[2023-07-22 02:57:40] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:57:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 02:57:41] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:03:44] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 03:03:44] [valid] No post-processing script given for validating translator
[2023-07-22 03:03:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:03:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 03:03:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 03:03:44] [comm] Using global sharding
[2023-07-22 03:03:44] [comm] NCCLCommunicators constructed successfully
[2023-07-22 03:03:44] [training] Using 1 GPUs
[2023-07-22 03:03:44] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 03:03:45] Allocating memory for general optimizer shards
[2023-07-22 03:03:45] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:03:45] Loading Adam parameters
[2023-07-22 03:03:45] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:03:45] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:03:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 03:03:46] [data] Restoring the corpus state to epoch 121, batch 3840
[2023-07-22 03:03:46] [data] Shuffling data
[2023-07-22 03:03:46] [data] Done reading 20,192 sentences
[2023-07-22 03:03:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:03:46] Training started
[2023-07-22 03:03:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 03:03:48] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:04:01] Parameter type float16, optimization type float32, casting types true
[2023-07-22 03:07:38] Seen 20,192 samples
[2023-07-22 03:07:38] Starting data epoch 122 in logical epoch 122
[2023-07-22 03:07:38] [data] Shuffling data
[2023-07-22 03:07:38] [data] Done reading 20,192 sentences
[2023-07-22 03:07:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:11:32] Seen 20,192 samples
[2023-07-22 03:11:32] Starting data epoch 123 in logical epoch 123
[2023-07-22 03:11:32] [data] Shuffling data
[2023-07-22 03:11:32] [data] Done reading 20,192 sentences
[2023-07-22 03:11:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:15:25] Seen 20,192 samples
[2023-07-22 03:15:25] Starting data epoch 124 in logical epoch 124
[2023-07-22 03:15:25] [data] Shuffling data
[2023-07-22 03:15:25] [data] Done reading 20,192 sentences
[2023-07-22 03:15:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:19:14] Seen 20,192 samples
[2023-07-22 03:19:14] Starting data epoch 125 in logical epoch 125
[2023-07-22 03:19:14] [data] Shuffling data
[2023-07-22 03:19:14] [data] Done reading 20,192 sentences
[2023-07-22 03:19:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:22:32] Ep. 125 : Up. 4000 : Sen. 20,192 : Cost 4.99123478 * 16,023,330 @ 3,363 after 64,138,750 : Time 1127.82s : 14207.32 words/s : gNorm 0.7896
[2023-07-22 03:22:32] Seen 20,192 samples
[2023-07-22 03:22:32] Starting data epoch 126 in logical epoch 126
[2023-07-22 03:22:32] [data] Shuffling data
[2023-07-22 03:22:32] [data] Done reading 20,192 sentences
[2023-07-22 03:22:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:26:12] Seen 20,192 samples
[2023-07-22 03:26:12] Starting data epoch 127 in logical epoch 127
[2023-07-22 03:26:12] [data] Shuffling data
[2023-07-22 03:26:12] [data] Done reading 20,192 sentences
[2023-07-22 03:26:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:30:03] Seen 20,192 samples
[2023-07-22 03:30:03] Starting data epoch 128 in logical epoch 128
[2023-07-22 03:30:03] [data] Shuffling data
[2023-07-22 03:30:03] [data] Done reading 20,192 sentences
[2023-07-22 03:30:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:33:57] Seen 20,192 samples
[2023-07-22 03:33:57] Starting data epoch 129 in logical epoch 129
[2023-07-22 03:33:57] [data] Shuffling data
[2023-07-22 03:33:57] [data] Done reading 20,192 sentences
[2023-07-22 03:33:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:37:54] Seen 20,192 samples
[2023-07-22 03:37:54] Starting data epoch 130 in logical epoch 130
[2023-07-22 03:37:54] [data] Shuffling data
[2023-07-22 03:37:54] [data] Done reading 20,192 sentences
[2023-07-22 03:37:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:41:45] Seen 20,192 samples
[2023-07-22 03:41:45] Starting data epoch 131 in logical epoch 131
[2023-07-22 03:41:45] Training finished
[2023-07-22 03:42:02] [valid] Ep. 131 : Up. 4160 : cross-entropy : 138.935 : new best
[2023-07-22 03:46:21] [valid] Ep. 131 : Up. 4160 : translation : 0 : new best
[2023-07-22 03:46:21] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 03:46:22] Saving Adam parameters
[2023-07-22 03:46:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 03:46:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 03:46:29] [marian] Running on node23.datos.cluster.uy as process 5718 with command line:
[2023-07-22 03:46:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 03:46:29] [config] after: 0e
[2023-07-22 03:46:29] [config] after-batches: 0
[2023-07-22 03:46:29] [config] after-epochs: 140
[2023-07-22 03:46:29] [config] all-caps-every: 0
[2023-07-22 03:46:29] [config] allow-unk: false
[2023-07-22 03:46:29] [config] authors: false
[2023-07-22 03:46:29] [config] beam-size: 12
[2023-07-22 03:46:29] [config] bert-class-symbol: "[CLS]"
[2023-07-22 03:46:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 03:46:29] [config] bert-masking-fraction: 0.15
[2023-07-22 03:46:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 03:46:29] [config] bert-train-type-embeddings: true
[2023-07-22 03:46:29] [config] bert-type-vocab-size: 2
[2023-07-22 03:46:29] [config] build-info: ""
[2023-07-22 03:46:29] [config] check-gradient-nan: false
[2023-07-22 03:46:29] [config] check-nan: false
[2023-07-22 03:46:29] [config] cite: false
[2023-07-22 03:46:29] [config] clip-norm: 1
[2023-07-22 03:46:29] [config] cost-scaling:
[2023-07-22 03:46:29] [config]   - 256.f
[2023-07-22 03:46:29] [config]   - 1000
[2023-07-22 03:46:29] [config]   - 2.f
[2023-07-22 03:46:29] [config]   - 256.f
[2023-07-22 03:46:29] [config] cost-type: ce-sum
[2023-07-22 03:46:29] [config] cpu-threads: 0
[2023-07-22 03:46:29] [config] data-threads: 8
[2023-07-22 03:46:29] [config] data-weighting: ""
[2023-07-22 03:46:29] [config] data-weighting-type: sentence
[2023-07-22 03:46:29] [config] dec-cell: gru
[2023-07-22 03:46:29] [config] dec-cell-base-depth: 2
[2023-07-22 03:46:29] [config] dec-cell-high-depth: 1
[2023-07-22 03:46:29] [config] dec-depth: 1
[2023-07-22 03:46:29] [config] devices:
[2023-07-22 03:46:29] [config]   - 0
[2023-07-22 03:46:29] [config] dim-emb: 512
[2023-07-22 03:46:29] [config] dim-rnn: 1024
[2023-07-22 03:46:29] [config] dim-vocabs:
[2023-07-22 03:46:29] [config]   - 16384
[2023-07-22 03:46:29] [config]   - 16384
[2023-07-22 03:46:29] [config] disp-first: 0
[2023-07-22 03:46:29] [config] disp-freq: 1000u
[2023-07-22 03:46:29] [config] disp-label-counts: true
[2023-07-22 03:46:29] [config] dropout-rnn: 0.5
[2023-07-22 03:46:29] [config] dropout-src: 0
[2023-07-22 03:46:29] [config] dropout-trg: 0
[2023-07-22 03:46:29] [config] dump-config: ""
[2023-07-22 03:46:29] [config] dynamic-gradient-scaling:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] early-stopping: 200
[2023-07-22 03:46:29] [config] early-stopping-on: first
[2023-07-22 03:46:29] [config] embedding-fix-src: false
[2023-07-22 03:46:29] [config] embedding-fix-trg: false
[2023-07-22 03:46:29] [config] embedding-normalization: false
[2023-07-22 03:46:29] [config] embedding-vectors:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] enc-cell: gru
[2023-07-22 03:46:29] [config] enc-cell-depth: 1
[2023-07-22 03:46:29] [config] enc-depth: 1
[2023-07-22 03:46:29] [config] enc-type: bidirectional
[2023-07-22 03:46:29] [config] english-title-case-every: 0
[2023-07-22 03:46:29] [config] exponential-smoothing: 0
[2023-07-22 03:46:29] [config] factor-weight: 1
[2023-07-22 03:46:29] [config] factors-combine: sum
[2023-07-22 03:46:29] [config] factors-dim-emb: 0
[2023-07-22 03:46:29] [config] gradient-checkpointing: false
[2023-07-22 03:46:29] [config] gradient-norm-average-window: 100
[2023-07-22 03:46:29] [config] guided-alignment: none
[2023-07-22 03:46:29] [config] guided-alignment-cost: mse
[2023-07-22 03:46:29] [config] guided-alignment-weight: 0.1
[2023-07-22 03:46:29] [config] ignore-model-config: false
[2023-07-22 03:46:29] [config] input-types:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] interpolate-env-vars: false
[2023-07-22 03:46:29] [config] keep-best: false
[2023-07-22 03:46:29] [config] label-smoothing: 0
[2023-07-22 03:46:29] [config] layer-normalization: false
[2023-07-22 03:46:29] [config] learn-rate: 0.0001
[2023-07-22 03:46:29] [config] lemma-dependency: ""
[2023-07-22 03:46:29] [config] lemma-dim-emb: 0
[2023-07-22 03:46:29] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 03:46:29] [config] log-level: info
[2023-07-22 03:46:29] [config] log-time-zone: ""
[2023-07-22 03:46:29] [config] logical-epoch:
[2023-07-22 03:46:29] [config]   - 1e
[2023-07-22 03:46:29] [config]   - 0
[2023-07-22 03:46:29] [config] lr-decay: 0
[2023-07-22 03:46:29] [config] lr-decay-freq: 50000
[2023-07-22 03:46:29] [config] lr-decay-inv-sqrt:
[2023-07-22 03:46:29] [config]   - 0
[2023-07-22 03:46:29] [config] lr-decay-repeat-warmup: false
[2023-07-22 03:46:29] [config] lr-decay-reset-optimizer: false
[2023-07-22 03:46:29] [config] lr-decay-start:
[2023-07-22 03:46:29] [config]   - 10
[2023-07-22 03:46:29] [config]   - 1
[2023-07-22 03:46:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 03:46:29] [config] lr-report: false
[2023-07-22 03:46:29] [config] lr-warmup: 0
[2023-07-22 03:46:29] [config] lr-warmup-at-reload: false
[2023-07-22 03:46:29] [config] lr-warmup-cycle: false
[2023-07-22 03:46:29] [config] lr-warmup-start-rate: 0
[2023-07-22 03:46:29] [config] max-length: 50
[2023-07-22 03:46:29] [config] max-length-crop: true
[2023-07-22 03:46:29] [config] max-length-factor: 3
[2023-07-22 03:46:29] [config] maxi-batch: 100
[2023-07-22 03:46:29] [config] maxi-batch-sort: trg
[2023-07-22 03:46:29] [config] mini-batch: 64
[2023-07-22 03:46:29] [config] mini-batch-fit: true
[2023-07-22 03:46:29] [config] mini-batch-fit-step: 10
[2023-07-22 03:46:29] [config] mini-batch-round-up: true
[2023-07-22 03:46:29] [config] mini-batch-track-lr: false
[2023-07-22 03:46:29] [config] mini-batch-warmup: 0
[2023-07-22 03:46:29] [config] mini-batch-words: 0
[2023-07-22 03:46:29] [config] mini-batch-words-ref: 0
[2023-07-22 03:46:29] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 03:46:29] [config] multi-loss-type: sum
[2023-07-22 03:46:29] [config] n-best: false
[2023-07-22 03:46:29] [config] no-nccl: false
[2023-07-22 03:46:29] [config] no-reload: false
[2023-07-22 03:46:29] [config] no-restore-corpus: false
[2023-07-22 03:46:29] [config] normalize: 0
[2023-07-22 03:46:29] [config] normalize-gradient: false
[2023-07-22 03:46:29] [config] num-devices: 0
[2023-07-22 03:46:29] [config] optimizer: adam
[2023-07-22 03:46:29] [config] optimizer-delay: 1
[2023-07-22 03:46:29] [config] optimizer-params:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] output-omit-bias: false
[2023-07-22 03:46:29] [config] overwrite: true
[2023-07-22 03:46:29] [config] precision:
[2023-07-22 03:46:29] [config]   - float16
[2023-07-22 03:46:29] [config]   - float32
[2023-07-22 03:46:29] [config] pretrained-model: ""
[2023-07-22 03:46:29] [config] quantize-biases: false
[2023-07-22 03:46:29] [config] quantize-bits: 0
[2023-07-22 03:46:29] [config] quantize-log-based: false
[2023-07-22 03:46:29] [config] quantize-optimization-steps: 0
[2023-07-22 03:46:29] [config] quiet: false
[2023-07-22 03:46:29] [config] quiet-translation: true
[2023-07-22 03:46:29] [config] relative-paths: false
[2023-07-22 03:46:29] [config] right-left: false
[2023-07-22 03:46:29] [config] save-freq: 10000u
[2023-07-22 03:46:29] [config] seed: 1234
[2023-07-22 03:46:29] [config] sentencepiece-alphas:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] sentencepiece-max-lines: 2000000
[2023-07-22 03:46:29] [config] sentencepiece-options: ""
[2023-07-22 03:46:29] [config] sharding: global
[2023-07-22 03:46:29] [config] shuffle: data
[2023-07-22 03:46:29] [config] shuffle-in-ram: false
[2023-07-22 03:46:29] [config] sigterm: save-and-exit
[2023-07-22 03:46:29] [config] skip: false
[2023-07-22 03:46:29] [config] sqlite: ""
[2023-07-22 03:46:29] [config] sqlite-drop: false
[2023-07-22 03:46:29] [config] sync-freq: 200u
[2023-07-22 03:46:29] [config] sync-sgd: false
[2023-07-22 03:46:29] [config] tempdir: /tmp
[2023-07-22 03:46:29] [config] tied-embeddings: false
[2023-07-22 03:46:29] [config] tied-embeddings-all: true
[2023-07-22 03:46:29] [config] tied-embeddings-src: false
[2023-07-22 03:46:29] [config] train-embedder-rank:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] train-sets:
[2023-07-22 03:46:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 03:46:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 03:46:29] [config] transformer-aan-activation: swish
[2023-07-22 03:46:29] [config] transformer-aan-depth: 2
[2023-07-22 03:46:29] [config] transformer-aan-nogate: false
[2023-07-22 03:46:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 03:46:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 03:46:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 03:46:29] [config] transformer-depth-scaling: false
[2023-07-22 03:46:29] [config] transformer-dim-aan: 2048
[2023-07-22 03:46:29] [config] transformer-dim-ffn: 2048
[2023-07-22 03:46:29] [config] transformer-dropout: 0
[2023-07-22 03:46:29] [config] transformer-dropout-attention: 0
[2023-07-22 03:46:29] [config] transformer-dropout-ffn: 0
[2023-07-22 03:46:29] [config] transformer-ffn-activation: swish
[2023-07-22 03:46:29] [config] transformer-ffn-depth: 2
[2023-07-22 03:46:29] [config] transformer-guided-alignment-layer: last
[2023-07-22 03:46:29] [config] transformer-heads: 8
[2023-07-22 03:46:29] [config] transformer-no-projection: false
[2023-07-22 03:46:29] [config] transformer-pool: false
[2023-07-22 03:46:29] [config] transformer-postprocess: dan
[2023-07-22 03:46:29] [config] transformer-postprocess-emb: d
[2023-07-22 03:46:29] [config] transformer-postprocess-top: ""
[2023-07-22 03:46:29] [config] transformer-preprocess: ""
[2023-07-22 03:46:29] [config] transformer-tied-layers:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] transformer-train-position-embeddings: false
[2023-07-22 03:46:29] [config] tsv: false
[2023-07-22 03:46:29] [config] tsv-fields: 0
[2023-07-22 03:46:29] [config] type: amun
[2023-07-22 03:46:29] [config] ulr: false
[2023-07-22 03:46:29] [config] ulr-dim-emb: 0
[2023-07-22 03:46:29] [config] ulr-dropout: 0
[2023-07-22 03:46:29] [config] ulr-keys-vectors: ""
[2023-07-22 03:46:29] [config] ulr-query-vectors: ""
[2023-07-22 03:46:29] [config] ulr-softmax-temperature: 1
[2023-07-22 03:46:29] [config] ulr-trainable-transformation: false
[2023-07-22 03:46:29] [config] unlikelihood-loss: false
[2023-07-22 03:46:29] [config] valid-freq: 50000000
[2023-07-22 03:46:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 03:46:29] [config] valid-max-length: 1000
[2023-07-22 03:46:29] [config] valid-metrics:
[2023-07-22 03:46:29] [config]   - cross-entropy
[2023-07-22 03:46:29] [config]   - translation
[2023-07-22 03:46:29] [config] valid-mini-batch: 32
[2023-07-22 03:46:29] [config] valid-reset-stalled: false
[2023-07-22 03:46:29] [config] valid-script-args:
[2023-07-22 03:46:29] [config]   []
[2023-07-22 03:46:29] [config] valid-script-path: ""
[2023-07-22 03:46:29] [config] valid-sets:
[2023-07-22 03:46:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 03:46:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 03:46:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 03:46:29] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 03:46:29] [config] vocabs:
[2023-07-22 03:46:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 03:46:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 03:46:29] [config] word-penalty: 0
[2023-07-22 03:46:29] [config] word-scores: false
[2023-07-22 03:46:29] [config] workspace: 5500
[2023-07-22 03:46:29] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 03:46:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:46:29] [training] Using single-device training
[2023-07-22 03:46:30] Synced seed 1234
[2023-07-22 03:46:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 03:46:30] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 03:46:30] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 03:46:30] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 03:46:30] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 03:46:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:46:30] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 03:46:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 03:46:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 03:46:31] [comm] Using global sharding
[2023-07-22 03:46:31] [comm] NCCLCommunicators constructed successfully
[2023-07-22 03:46:31] [training] Using 1 GPUs
[2023-07-22 03:46:31] [logits] Applying loss function for 1 factor(s)
[2023-07-22 03:46:31] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:46:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 03:46:31] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:52:25] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 03:52:26] [valid] No post-processing script given for validating translator
[2023-07-22 03:52:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:52:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 03:52:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 03:52:26] [comm] Using global sharding
[2023-07-22 03:52:26] [comm] NCCLCommunicators constructed successfully
[2023-07-22 03:52:26] [training] Using 1 GPUs
[2023-07-22 03:52:26] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 03:52:27] Allocating memory for general optimizer shards
[2023-07-22 03:52:27] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:52:27] Loading Adam parameters
[2023-07-22 03:52:27] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:52:27] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:52:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 03:52:27] [data] Restoring the corpus state to epoch 131, batch 4160
[2023-07-22 03:52:27] [data] Shuffling data
[2023-07-22 03:52:27] [data] Done reading 20,192 sentences
[2023-07-22 03:52:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:52:28] Training started
[2023-07-22 03:52:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 03:52:28] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:52:32] Parameter type float16, optimization type float32, casting types true
[2023-07-22 03:55:54] Seen 20,192 samples
[2023-07-22 03:55:54] Starting data epoch 132 in logical epoch 132
[2023-07-22 03:55:54] [data] Shuffling data
[2023-07-22 03:55:54] [data] Done reading 20,192 sentences
[2023-07-22 03:55:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:59:43] Seen 20,192 samples
[2023-07-22 03:59:43] Starting data epoch 133 in logical epoch 133
[2023-07-22 03:59:43] [data] Shuffling data
[2023-07-22 03:59:43] [data] Done reading 20,192 sentences
[2023-07-22 03:59:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:03:33] Seen 20,192 samples
[2023-07-22 04:03:33] Starting data epoch 134 in logical epoch 134
[2023-07-22 04:03:33] [data] Shuffling data
[2023-07-22 04:03:33] [data] Done reading 20,192 sentences
[2023-07-22 04:03:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:07:23] Seen 20,192 samples
[2023-07-22 04:07:23] Starting data epoch 135 in logical epoch 135
[2023-07-22 04:07:23] [data] Shuffling data
[2023-07-22 04:07:23] [data] Done reading 20,192 sentences
[2023-07-22 04:07:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:11:08] Seen 20,192 samples
[2023-07-22 04:11:08] Starting data epoch 136 in logical epoch 136
[2023-07-22 04:11:08] [data] Shuffling data
[2023-07-22 04:11:08] [data] Done reading 20,192 sentences
[2023-07-22 04:11:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:14:58] Seen 20,192 samples
[2023-07-22 04:14:58] Starting data epoch 137 in logical epoch 137
[2023-07-22 04:14:58] [data] Shuffling data
[2023-07-22 04:14:58] [data] Done reading 20,192 sentences
[2023-07-22 04:14:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:18:45] Seen 20,192 samples
[2023-07-22 04:18:45] Starting data epoch 138 in logical epoch 138
[2023-07-22 04:18:45] [data] Shuffling data
[2023-07-22 04:18:45] [data] Done reading 20,192 sentences
[2023-07-22 04:18:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:22:36] Seen 20,192 samples
[2023-07-22 04:22:36] Starting data epoch 139 in logical epoch 139
[2023-07-22 04:22:36] [data] Shuffling data
[2023-07-22 04:22:36] [data] Done reading 20,192 sentences
[2023-07-22 04:22:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:26:28] Seen 20,192 samples
[2023-07-22 04:26:28] Starting data epoch 140 in logical epoch 140
[2023-07-22 04:26:28] [data] Shuffling data
[2023-07-22 04:26:28] [data] Done reading 20,192 sentences
[2023-07-22 04:26:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:30:19] Seen 20,192 samples
[2023-07-22 04:30:19] Starting data epoch 141 in logical epoch 141
[2023-07-22 04:30:19] Training finished
[2023-07-22 04:30:32] [valid] Ep. 141 : Up. 4480 : cross-entropy : 139.062 : stalled 1 times (last best: 138.934)
[2023-07-22 04:33:13] [valid] Ep. 141 : Up. 4480 : translation : 0 : new best
[2023-07-22 04:33:13] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 04:33:15] Saving Adam parameters
[2023-07-22 04:33:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 04:33:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:33:21] [marian] Running on node23.datos.cluster.uy as process 8918 with command line:
[2023-07-22 04:33:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 04:33:21] [config] after: 0e
[2023-07-22 04:33:21] [config] after-batches: 0
[2023-07-22 04:33:21] [config] after-epochs: 150
[2023-07-22 04:33:21] [config] all-caps-every: 0
[2023-07-22 04:33:21] [config] allow-unk: false
[2023-07-22 04:33:21] [config] authors: false
[2023-07-22 04:33:21] [config] beam-size: 12
[2023-07-22 04:33:21] [config] bert-class-symbol: "[CLS]"
[2023-07-22 04:33:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 04:33:21] [config] bert-masking-fraction: 0.15
[2023-07-22 04:33:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 04:33:21] [config] bert-train-type-embeddings: true
[2023-07-22 04:33:21] [config] bert-type-vocab-size: 2
[2023-07-22 04:33:21] [config] build-info: ""
[2023-07-22 04:33:21] [config] check-gradient-nan: false
[2023-07-22 04:33:21] [config] check-nan: false
[2023-07-22 04:33:21] [config] cite: false
[2023-07-22 04:33:21] [config] clip-norm: 1
[2023-07-22 04:33:21] [config] cost-scaling:
[2023-07-22 04:33:21] [config]   - 256.f
[2023-07-22 04:33:21] [config]   - 1000
[2023-07-22 04:33:21] [config]   - 2.f
[2023-07-22 04:33:21] [config]   - 256.f
[2023-07-22 04:33:21] [config] cost-type: ce-sum
[2023-07-22 04:33:21] [config] cpu-threads: 0
[2023-07-22 04:33:21] [config] data-threads: 8
[2023-07-22 04:33:21] [config] data-weighting: ""
[2023-07-22 04:33:21] [config] data-weighting-type: sentence
[2023-07-22 04:33:21] [config] dec-cell: gru
[2023-07-22 04:33:21] [config] dec-cell-base-depth: 2
[2023-07-22 04:33:21] [config] dec-cell-high-depth: 1
[2023-07-22 04:33:21] [config] dec-depth: 1
[2023-07-22 04:33:21] [config] devices:
[2023-07-22 04:33:21] [config]   - 0
[2023-07-22 04:33:21] [config] dim-emb: 512
[2023-07-22 04:33:21] [config] dim-rnn: 1024
[2023-07-22 04:33:21] [config] dim-vocabs:
[2023-07-22 04:33:21] [config]   - 16384
[2023-07-22 04:33:21] [config]   - 16384
[2023-07-22 04:33:21] [config] disp-first: 0
[2023-07-22 04:33:21] [config] disp-freq: 1000u
[2023-07-22 04:33:21] [config] disp-label-counts: true
[2023-07-22 04:33:21] [config] dropout-rnn: 0.5
[2023-07-22 04:33:21] [config] dropout-src: 0
[2023-07-22 04:33:21] [config] dropout-trg: 0
[2023-07-22 04:33:21] [config] dump-config: ""
[2023-07-22 04:33:21] [config] dynamic-gradient-scaling:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] early-stopping: 200
[2023-07-22 04:33:21] [config] early-stopping-on: first
[2023-07-22 04:33:21] [config] embedding-fix-src: false
[2023-07-22 04:33:21] [config] embedding-fix-trg: false
[2023-07-22 04:33:21] [config] embedding-normalization: false
[2023-07-22 04:33:21] [config] embedding-vectors:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] enc-cell: gru
[2023-07-22 04:33:21] [config] enc-cell-depth: 1
[2023-07-22 04:33:21] [config] enc-depth: 1
[2023-07-22 04:33:21] [config] enc-type: bidirectional
[2023-07-22 04:33:21] [config] english-title-case-every: 0
[2023-07-22 04:33:21] [config] exponential-smoothing: 0
[2023-07-22 04:33:21] [config] factor-weight: 1
[2023-07-22 04:33:21] [config] factors-combine: sum
[2023-07-22 04:33:21] [config] factors-dim-emb: 0
[2023-07-22 04:33:21] [config] gradient-checkpointing: false
[2023-07-22 04:33:21] [config] gradient-norm-average-window: 100
[2023-07-22 04:33:21] [config] guided-alignment: none
[2023-07-22 04:33:21] [config] guided-alignment-cost: mse
[2023-07-22 04:33:21] [config] guided-alignment-weight: 0.1
[2023-07-22 04:33:21] [config] ignore-model-config: false
[2023-07-22 04:33:21] [config] input-types:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] interpolate-env-vars: false
[2023-07-22 04:33:21] [config] keep-best: false
[2023-07-22 04:33:21] [config] label-smoothing: 0
[2023-07-22 04:33:21] [config] layer-normalization: false
[2023-07-22 04:33:21] [config] learn-rate: 0.0001
[2023-07-22 04:33:21] [config] lemma-dependency: ""
[2023-07-22 04:33:21] [config] lemma-dim-emb: 0
[2023-07-22 04:33:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 04:33:21] [config] log-level: info
[2023-07-22 04:33:21] [config] log-time-zone: ""
[2023-07-22 04:33:21] [config] logical-epoch:
[2023-07-22 04:33:21] [config]   - 1e
[2023-07-22 04:33:21] [config]   - 0
[2023-07-22 04:33:21] [config] lr-decay: 0
[2023-07-22 04:33:21] [config] lr-decay-freq: 50000
[2023-07-22 04:33:21] [config] lr-decay-inv-sqrt:
[2023-07-22 04:33:21] [config]   - 0
[2023-07-22 04:33:21] [config] lr-decay-repeat-warmup: false
[2023-07-22 04:33:21] [config] lr-decay-reset-optimizer: false
[2023-07-22 04:33:21] [config] lr-decay-start:
[2023-07-22 04:33:21] [config]   - 10
[2023-07-22 04:33:21] [config]   - 1
[2023-07-22 04:33:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 04:33:21] [config] lr-report: false
[2023-07-22 04:33:21] [config] lr-warmup: 0
[2023-07-22 04:33:21] [config] lr-warmup-at-reload: false
[2023-07-22 04:33:21] [config] lr-warmup-cycle: false
[2023-07-22 04:33:21] [config] lr-warmup-start-rate: 0
[2023-07-22 04:33:21] [config] max-length: 50
[2023-07-22 04:33:21] [config] max-length-crop: true
[2023-07-22 04:33:21] [config] max-length-factor: 3
[2023-07-22 04:33:21] [config] maxi-batch: 100
[2023-07-22 04:33:21] [config] maxi-batch-sort: trg
[2023-07-22 04:33:21] [config] mini-batch: 64
[2023-07-22 04:33:21] [config] mini-batch-fit: true
[2023-07-22 04:33:21] [config] mini-batch-fit-step: 10
[2023-07-22 04:33:21] [config] mini-batch-round-up: true
[2023-07-22 04:33:21] [config] mini-batch-track-lr: false
[2023-07-22 04:33:21] [config] mini-batch-warmup: 0
[2023-07-22 04:33:21] [config] mini-batch-words: 0
[2023-07-22 04:33:21] [config] mini-batch-words-ref: 0
[2023-07-22 04:33:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 04:33:21] [config] multi-loss-type: sum
[2023-07-22 04:33:21] [config] n-best: false
[2023-07-22 04:33:21] [config] no-nccl: false
[2023-07-22 04:33:21] [config] no-reload: false
[2023-07-22 04:33:21] [config] no-restore-corpus: false
[2023-07-22 04:33:21] [config] normalize: 0
[2023-07-22 04:33:21] [config] normalize-gradient: false
[2023-07-22 04:33:21] [config] num-devices: 0
[2023-07-22 04:33:21] [config] optimizer: adam
[2023-07-22 04:33:21] [config] optimizer-delay: 1
[2023-07-22 04:33:21] [config] optimizer-params:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] output-omit-bias: false
[2023-07-22 04:33:21] [config] overwrite: true
[2023-07-22 04:33:21] [config] precision:
[2023-07-22 04:33:21] [config]   - float16
[2023-07-22 04:33:21] [config]   - float32
[2023-07-22 04:33:21] [config] pretrained-model: ""
[2023-07-22 04:33:21] [config] quantize-biases: false
[2023-07-22 04:33:21] [config] quantize-bits: 0
[2023-07-22 04:33:21] [config] quantize-log-based: false
[2023-07-22 04:33:21] [config] quantize-optimization-steps: 0
[2023-07-22 04:33:21] [config] quiet: false
[2023-07-22 04:33:21] [config] quiet-translation: true
[2023-07-22 04:33:21] [config] relative-paths: false
[2023-07-22 04:33:21] [config] right-left: false
[2023-07-22 04:33:21] [config] save-freq: 10000u
[2023-07-22 04:33:21] [config] seed: 1234
[2023-07-22 04:33:21] [config] sentencepiece-alphas:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] sentencepiece-max-lines: 2000000
[2023-07-22 04:33:21] [config] sentencepiece-options: ""
[2023-07-22 04:33:21] [config] sharding: global
[2023-07-22 04:33:21] [config] shuffle: data
[2023-07-22 04:33:21] [config] shuffle-in-ram: false
[2023-07-22 04:33:21] [config] sigterm: save-and-exit
[2023-07-22 04:33:21] [config] skip: false
[2023-07-22 04:33:21] [config] sqlite: ""
[2023-07-22 04:33:21] [config] sqlite-drop: false
[2023-07-22 04:33:21] [config] sync-freq: 200u
[2023-07-22 04:33:21] [config] sync-sgd: false
[2023-07-22 04:33:21] [config] tempdir: /tmp
[2023-07-22 04:33:21] [config] tied-embeddings: false
[2023-07-22 04:33:21] [config] tied-embeddings-all: true
[2023-07-22 04:33:21] [config] tied-embeddings-src: false
[2023-07-22 04:33:21] [config] train-embedder-rank:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] train-sets:
[2023-07-22 04:33:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 04:33:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 04:33:21] [config] transformer-aan-activation: swish
[2023-07-22 04:33:21] [config] transformer-aan-depth: 2
[2023-07-22 04:33:21] [config] transformer-aan-nogate: false
[2023-07-22 04:33:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 04:33:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 04:33:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 04:33:21] [config] transformer-depth-scaling: false
[2023-07-22 04:33:21] [config] transformer-dim-aan: 2048
[2023-07-22 04:33:21] [config] transformer-dim-ffn: 2048
[2023-07-22 04:33:21] [config] transformer-dropout: 0
[2023-07-22 04:33:21] [config] transformer-dropout-attention: 0
[2023-07-22 04:33:21] [config] transformer-dropout-ffn: 0
[2023-07-22 04:33:21] [config] transformer-ffn-activation: swish
[2023-07-22 04:33:21] [config] transformer-ffn-depth: 2
[2023-07-22 04:33:21] [config] transformer-guided-alignment-layer: last
[2023-07-22 04:33:21] [config] transformer-heads: 8
[2023-07-22 04:33:21] [config] transformer-no-projection: false
[2023-07-22 04:33:21] [config] transformer-pool: false
[2023-07-22 04:33:21] [config] transformer-postprocess: dan
[2023-07-22 04:33:21] [config] transformer-postprocess-emb: d
[2023-07-22 04:33:21] [config] transformer-postprocess-top: ""
[2023-07-22 04:33:21] [config] transformer-preprocess: ""
[2023-07-22 04:33:21] [config] transformer-tied-layers:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] transformer-train-position-embeddings: false
[2023-07-22 04:33:21] [config] tsv: false
[2023-07-22 04:33:21] [config] tsv-fields: 0
[2023-07-22 04:33:21] [config] type: amun
[2023-07-22 04:33:21] [config] ulr: false
[2023-07-22 04:33:21] [config] ulr-dim-emb: 0
[2023-07-22 04:33:21] [config] ulr-dropout: 0
[2023-07-22 04:33:21] [config] ulr-keys-vectors: ""
[2023-07-22 04:33:21] [config] ulr-query-vectors: ""
[2023-07-22 04:33:21] [config] ulr-softmax-temperature: 1
[2023-07-22 04:33:21] [config] ulr-trainable-transformation: false
[2023-07-22 04:33:21] [config] unlikelihood-loss: false
[2023-07-22 04:33:21] [config] valid-freq: 50000000
[2023-07-22 04:33:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 04:33:21] [config] valid-max-length: 1000
[2023-07-22 04:33:21] [config] valid-metrics:
[2023-07-22 04:33:21] [config]   - cross-entropy
[2023-07-22 04:33:21] [config]   - translation
[2023-07-22 04:33:21] [config] valid-mini-batch: 32
[2023-07-22 04:33:21] [config] valid-reset-stalled: false
[2023-07-22 04:33:21] [config] valid-script-args:
[2023-07-22 04:33:21] [config]   []
[2023-07-22 04:33:21] [config] valid-script-path: ""
[2023-07-22 04:33:21] [config] valid-sets:
[2023-07-22 04:33:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 04:33:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 04:33:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 04:33:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:33:21] [config] vocabs:
[2023-07-22 04:33:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:33:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:33:21] [config] word-penalty: 0
[2023-07-22 04:33:21] [config] word-scores: false
[2023-07-22 04:33:21] [config] workspace: 5500
[2023-07-22 04:33:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:33:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:33:21] [training] Using single-device training
[2023-07-22 04:33:22] Synced seed 1234
[2023-07-22 04:33:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:33:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 04:33:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:33:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 04:33:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 04:33:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:33:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 04:33:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 04:33:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 04:33:23] [comm] Using global sharding
[2023-07-22 04:33:23] [comm] NCCLCommunicators constructed successfully
[2023-07-22 04:33:23] [training] Using 1 GPUs
[2023-07-22 04:33:23] [logits] Applying loss function for 1 factor(s)
[2023-07-22 04:33:23] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:33:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 04:33:23] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:39:48] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 04:39:48] [valid] No post-processing script given for validating translator
[2023-07-22 04:39:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:39:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 04:39:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 04:39:48] [comm] Using global sharding
[2023-07-22 04:39:48] [comm] NCCLCommunicators constructed successfully
[2023-07-22 04:39:48] [training] Using 1 GPUs
[2023-07-22 04:39:48] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 04:39:49] Allocating memory for general optimizer shards
[2023-07-22 04:39:49] [memory] Reserving 322 MB, device gpu0
[2023-07-22 04:39:49] Loading Adam parameters
[2023-07-22 04:39:49] [memory] Reserving 322 MB, device gpu0
[2023-07-22 04:39:50] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:39:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 04:39:50] [data] Restoring the corpus state to epoch 141, batch 4480
[2023-07-22 04:39:50] [data] Shuffling data
[2023-07-22 04:39:50] [data] Done reading 20,192 sentences
[2023-07-22 04:39:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:39:50] Training started
[2023-07-22 04:39:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 04:39:51] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:39:55] Parameter type float16, optimization type float32, casting types true
[2023-07-22 04:43:47] Seen 20,192 samples
[2023-07-22 04:43:47] Starting data epoch 142 in logical epoch 142
[2023-07-22 04:43:47] [data] Shuffling data
[2023-07-22 04:43:47] [data] Done reading 20,192 sentences
[2023-07-22 04:43:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:47:46] Seen 20,192 samples
[2023-07-22 04:47:46] Starting data epoch 143 in logical epoch 143
[2023-07-22 04:47:46] [data] Shuffling data
[2023-07-22 04:47:46] [data] Done reading 20,192 sentences
[2023-07-22 04:47:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:51:39] Seen 20,192 samples
[2023-07-22 04:51:39] Starting data epoch 144 in logical epoch 144
[2023-07-22 04:51:39] [data] Shuffling data
[2023-07-22 04:51:39] [data] Done reading 20,192 sentences
[2023-07-22 04:51:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:55:33] Seen 20,192 samples
[2023-07-22 04:55:33] Starting data epoch 145 in logical epoch 145
[2023-07-22 04:55:33] [data] Shuffling data
[2023-07-22 04:55:33] [data] Done reading 20,192 sentences
[2023-07-22 04:55:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:59:27] Seen 20,192 samples
[2023-07-22 04:59:27] Starting data epoch 146 in logical epoch 146
[2023-07-22 04:59:27] [data] Shuffling data
[2023-07-22 04:59:27] [data] Done reading 20,192 sentences
[2023-07-22 04:59:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:03:19] Seen 20,192 samples
[2023-07-22 05:03:19] Starting data epoch 147 in logical epoch 147
[2023-07-22 05:03:19] [data] Shuffling data
[2023-07-22 05:03:19] [data] Done reading 20,192 sentences
[2023-07-22 05:03:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:07:06] Seen 20,192 samples
[2023-07-22 05:07:06] Starting data epoch 148 in logical epoch 148
[2023-07-22 05:07:06] [data] Shuffling data
[2023-07-22 05:07:06] [data] Done reading 20,192 sentences
[2023-07-22 05:07:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:11:05] Seen 20,192 samples
[2023-07-22 05:11:05] Starting data epoch 149 in logical epoch 149
[2023-07-22 05:11:05] [data] Shuffling data
[2023-07-22 05:11:05] [data] Done reading 20,192 sentences
[2023-07-22 05:11:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:14:57] Seen 20,192 samples
[2023-07-22 05:14:57] Starting data epoch 150 in logical epoch 150
[2023-07-22 05:14:57] [data] Shuffling data
[2023-07-22 05:14:57] [data] Done reading 20,192 sentences
[2023-07-22 05:14:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:18:51] Seen 20,192 samples
[2023-07-22 05:18:51] Starting data epoch 151 in logical epoch 151
[2023-07-22 05:18:51] Training finished
[2023-07-22 05:19:04] [valid] Ep. 151 : Up. 4800 : cross-entropy : 136.342 : new best
[2023-07-22 05:21:11] [valid] Ep. 151 : Up. 4800 : translation : 0 : new best
[2023-07-22 05:21:11] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 05:21:14] Saving Adam parameters
[2023-07-22 05:21:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 05:21:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 05:21:20] [marian] Running on node23.datos.cluster.uy as process 12151 with command line:
[2023-07-22 05:21:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 05:21:20] [config] after: 0e
[2023-07-22 05:21:20] [config] after-batches: 0
[2023-07-22 05:21:20] [config] after-epochs: 160
[2023-07-22 05:21:20] [config] all-caps-every: 0
[2023-07-22 05:21:20] [config] allow-unk: false
[2023-07-22 05:21:20] [config] authors: false
[2023-07-22 05:21:20] [config] beam-size: 12
[2023-07-22 05:21:20] [config] bert-class-symbol: "[CLS]"
[2023-07-22 05:21:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 05:21:20] [config] bert-masking-fraction: 0.15
[2023-07-22 05:21:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 05:21:20] [config] bert-train-type-embeddings: true
[2023-07-22 05:21:20] [config] bert-type-vocab-size: 2
[2023-07-22 05:21:20] [config] build-info: ""
[2023-07-22 05:21:20] [config] check-gradient-nan: false
[2023-07-22 05:21:20] [config] check-nan: false
[2023-07-22 05:21:20] [config] cite: false
[2023-07-22 05:21:20] [config] clip-norm: 1
[2023-07-22 05:21:20] [config] cost-scaling:
[2023-07-22 05:21:20] [config]   - 256.f
[2023-07-22 05:21:20] [config]   - 1000
[2023-07-22 05:21:20] [config]   - 2.f
[2023-07-22 05:21:20] [config]   - 256.f
[2023-07-22 05:21:20] [config] cost-type: ce-sum
[2023-07-22 05:21:20] [config] cpu-threads: 0
[2023-07-22 05:21:20] [config] data-threads: 8
[2023-07-22 05:21:20] [config] data-weighting: ""
[2023-07-22 05:21:20] [config] data-weighting-type: sentence
[2023-07-22 05:21:20] [config] dec-cell: gru
[2023-07-22 05:21:20] [config] dec-cell-base-depth: 2
[2023-07-22 05:21:20] [config] dec-cell-high-depth: 1
[2023-07-22 05:21:20] [config] dec-depth: 1
[2023-07-22 05:21:20] [config] devices:
[2023-07-22 05:21:20] [config]   - 0
[2023-07-22 05:21:20] [config] dim-emb: 512
[2023-07-22 05:21:20] [config] dim-rnn: 1024
[2023-07-22 05:21:20] [config] dim-vocabs:
[2023-07-22 05:21:20] [config]   - 16384
[2023-07-22 05:21:20] [config]   - 16384
[2023-07-22 05:21:20] [config] disp-first: 0
[2023-07-22 05:21:20] [config] disp-freq: 1000u
[2023-07-22 05:21:20] [config] disp-label-counts: true
[2023-07-22 05:21:20] [config] dropout-rnn: 0.5
[2023-07-22 05:21:20] [config] dropout-src: 0
[2023-07-22 05:21:20] [config] dropout-trg: 0
[2023-07-22 05:21:20] [config] dump-config: ""
[2023-07-22 05:21:20] [config] dynamic-gradient-scaling:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] early-stopping: 200
[2023-07-22 05:21:20] [config] early-stopping-on: first
[2023-07-22 05:21:20] [config] embedding-fix-src: false
[2023-07-22 05:21:20] [config] embedding-fix-trg: false
[2023-07-22 05:21:20] [config] embedding-normalization: false
[2023-07-22 05:21:20] [config] embedding-vectors:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] enc-cell: gru
[2023-07-22 05:21:20] [config] enc-cell-depth: 1
[2023-07-22 05:21:20] [config] enc-depth: 1
[2023-07-22 05:21:20] [config] enc-type: bidirectional
[2023-07-22 05:21:20] [config] english-title-case-every: 0
[2023-07-22 05:21:20] [config] exponential-smoothing: 0
[2023-07-22 05:21:20] [config] factor-weight: 1
[2023-07-22 05:21:20] [config] factors-combine: sum
[2023-07-22 05:21:20] [config] factors-dim-emb: 0
[2023-07-22 05:21:20] [config] gradient-checkpointing: false
[2023-07-22 05:21:20] [config] gradient-norm-average-window: 100
[2023-07-22 05:21:20] [config] guided-alignment: none
[2023-07-22 05:21:20] [config] guided-alignment-cost: mse
[2023-07-22 05:21:20] [config] guided-alignment-weight: 0.1
[2023-07-22 05:21:20] [config] ignore-model-config: false
[2023-07-22 05:21:20] [config] input-types:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] interpolate-env-vars: false
[2023-07-22 05:21:20] [config] keep-best: false
[2023-07-22 05:21:20] [config] label-smoothing: 0
[2023-07-22 05:21:20] [config] layer-normalization: false
[2023-07-22 05:21:20] [config] learn-rate: 0.0001
[2023-07-22 05:21:20] [config] lemma-dependency: ""
[2023-07-22 05:21:20] [config] lemma-dim-emb: 0
[2023-07-22 05:21:20] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 05:21:20] [config] log-level: info
[2023-07-22 05:21:20] [config] log-time-zone: ""
[2023-07-22 05:21:20] [config] logical-epoch:
[2023-07-22 05:21:20] [config]   - 1e
[2023-07-22 05:21:20] [config]   - 0
[2023-07-22 05:21:20] [config] lr-decay: 0
[2023-07-22 05:21:20] [config] lr-decay-freq: 50000
[2023-07-22 05:21:20] [config] lr-decay-inv-sqrt:
[2023-07-22 05:21:20] [config]   - 0
[2023-07-22 05:21:20] [config] lr-decay-repeat-warmup: false
[2023-07-22 05:21:20] [config] lr-decay-reset-optimizer: false
[2023-07-22 05:21:20] [config] lr-decay-start:
[2023-07-22 05:21:20] [config]   - 10
[2023-07-22 05:21:20] [config]   - 1
[2023-07-22 05:21:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 05:21:20] [config] lr-report: false
[2023-07-22 05:21:20] [config] lr-warmup: 0
[2023-07-22 05:21:20] [config] lr-warmup-at-reload: false
[2023-07-22 05:21:20] [config] lr-warmup-cycle: false
[2023-07-22 05:21:20] [config] lr-warmup-start-rate: 0
[2023-07-22 05:21:20] [config] max-length: 50
[2023-07-22 05:21:20] [config] max-length-crop: true
[2023-07-22 05:21:20] [config] max-length-factor: 3
[2023-07-22 05:21:20] [config] maxi-batch: 100
[2023-07-22 05:21:20] [config] maxi-batch-sort: trg
[2023-07-22 05:21:20] [config] mini-batch: 64
[2023-07-22 05:21:20] [config] mini-batch-fit: true
[2023-07-22 05:21:20] [config] mini-batch-fit-step: 10
[2023-07-22 05:21:20] [config] mini-batch-round-up: true
[2023-07-22 05:21:20] [config] mini-batch-track-lr: false
[2023-07-22 05:21:20] [config] mini-batch-warmup: 0
[2023-07-22 05:21:20] [config] mini-batch-words: 0
[2023-07-22 05:21:20] [config] mini-batch-words-ref: 0
[2023-07-22 05:21:20] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 05:21:20] [config] multi-loss-type: sum
[2023-07-22 05:21:20] [config] n-best: false
[2023-07-22 05:21:20] [config] no-nccl: false
[2023-07-22 05:21:20] [config] no-reload: false
[2023-07-22 05:21:20] [config] no-restore-corpus: false
[2023-07-22 05:21:20] [config] normalize: 0
[2023-07-22 05:21:20] [config] normalize-gradient: false
[2023-07-22 05:21:20] [config] num-devices: 0
[2023-07-22 05:21:20] [config] optimizer: adam
[2023-07-22 05:21:20] [config] optimizer-delay: 1
[2023-07-22 05:21:20] [config] optimizer-params:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] output-omit-bias: false
[2023-07-22 05:21:20] [config] overwrite: true
[2023-07-22 05:21:20] [config] precision:
[2023-07-22 05:21:20] [config]   - float16
[2023-07-22 05:21:20] [config]   - float32
[2023-07-22 05:21:20] [config] pretrained-model: ""
[2023-07-22 05:21:20] [config] quantize-biases: false
[2023-07-22 05:21:20] [config] quantize-bits: 0
[2023-07-22 05:21:20] [config] quantize-log-based: false
[2023-07-22 05:21:20] [config] quantize-optimization-steps: 0
[2023-07-22 05:21:20] [config] quiet: false
[2023-07-22 05:21:20] [config] quiet-translation: true
[2023-07-22 05:21:20] [config] relative-paths: false
[2023-07-22 05:21:20] [config] right-left: false
[2023-07-22 05:21:20] [config] save-freq: 10000u
[2023-07-22 05:21:20] [config] seed: 1234
[2023-07-22 05:21:20] [config] sentencepiece-alphas:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] sentencepiece-max-lines: 2000000
[2023-07-22 05:21:20] [config] sentencepiece-options: ""
[2023-07-22 05:21:20] [config] sharding: global
[2023-07-22 05:21:20] [config] shuffle: data
[2023-07-22 05:21:20] [config] shuffle-in-ram: false
[2023-07-22 05:21:20] [config] sigterm: save-and-exit
[2023-07-22 05:21:20] [config] skip: false
[2023-07-22 05:21:20] [config] sqlite: ""
[2023-07-22 05:21:20] [config] sqlite-drop: false
[2023-07-22 05:21:20] [config] sync-freq: 200u
[2023-07-22 05:21:20] [config] sync-sgd: false
[2023-07-22 05:21:20] [config] tempdir: /tmp
[2023-07-22 05:21:20] [config] tied-embeddings: false
[2023-07-22 05:21:20] [config] tied-embeddings-all: true
[2023-07-22 05:21:20] [config] tied-embeddings-src: false
[2023-07-22 05:21:20] [config] train-embedder-rank:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] train-sets:
[2023-07-22 05:21:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 05:21:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 05:21:20] [config] transformer-aan-activation: swish
[2023-07-22 05:21:20] [config] transformer-aan-depth: 2
[2023-07-22 05:21:20] [config] transformer-aan-nogate: false
[2023-07-22 05:21:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 05:21:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 05:21:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 05:21:20] [config] transformer-depth-scaling: false
[2023-07-22 05:21:20] [config] transformer-dim-aan: 2048
[2023-07-22 05:21:20] [config] transformer-dim-ffn: 2048
[2023-07-22 05:21:20] [config] transformer-dropout: 0
[2023-07-22 05:21:20] [config] transformer-dropout-attention: 0
[2023-07-22 05:21:20] [config] transformer-dropout-ffn: 0
[2023-07-22 05:21:20] [config] transformer-ffn-activation: swish
[2023-07-22 05:21:20] [config] transformer-ffn-depth: 2
[2023-07-22 05:21:20] [config] transformer-guided-alignment-layer: last
[2023-07-22 05:21:20] [config] transformer-heads: 8
[2023-07-22 05:21:20] [config] transformer-no-projection: false
[2023-07-22 05:21:20] [config] transformer-pool: false
[2023-07-22 05:21:20] [config] transformer-postprocess: dan
[2023-07-22 05:21:20] [config] transformer-postprocess-emb: d
[2023-07-22 05:21:20] [config] transformer-postprocess-top: ""
[2023-07-22 05:21:20] [config] transformer-preprocess: ""
[2023-07-22 05:21:20] [config] transformer-tied-layers:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] transformer-train-position-embeddings: false
[2023-07-22 05:21:20] [config] tsv: false
[2023-07-22 05:21:20] [config] tsv-fields: 0
[2023-07-22 05:21:20] [config] type: amun
[2023-07-22 05:21:20] [config] ulr: false
[2023-07-22 05:21:20] [config] ulr-dim-emb: 0
[2023-07-22 05:21:20] [config] ulr-dropout: 0
[2023-07-22 05:21:20] [config] ulr-keys-vectors: ""
[2023-07-22 05:21:20] [config] ulr-query-vectors: ""
[2023-07-22 05:21:20] [config] ulr-softmax-temperature: 1
[2023-07-22 05:21:20] [config] ulr-trainable-transformation: false
[2023-07-22 05:21:20] [config] unlikelihood-loss: false
[2023-07-22 05:21:20] [config] valid-freq: 50000000
[2023-07-22 05:21:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 05:21:20] [config] valid-max-length: 1000
[2023-07-22 05:21:20] [config] valid-metrics:
[2023-07-22 05:21:20] [config]   - cross-entropy
[2023-07-22 05:21:20] [config]   - translation
[2023-07-22 05:21:20] [config] valid-mini-batch: 32
[2023-07-22 05:21:20] [config] valid-reset-stalled: false
[2023-07-22 05:21:20] [config] valid-script-args:
[2023-07-22 05:21:20] [config]   []
[2023-07-22 05:21:20] [config] valid-script-path: ""
[2023-07-22 05:21:20] [config] valid-sets:
[2023-07-22 05:21:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 05:21:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 05:21:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 05:21:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 05:21:20] [config] vocabs:
[2023-07-22 05:21:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 05:21:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 05:21:20] [config] word-penalty: 0
[2023-07-22 05:21:20] [config] word-scores: false
[2023-07-22 05:21:20] [config] workspace: 5500
[2023-07-22 05:21:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 05:21:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 05:21:20] [training] Using single-device training
[2023-07-22 05:21:21] Synced seed 1234
[2023-07-22 05:21:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 05:21:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 05:21:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 05:21:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 05:21:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 05:21:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 05:21:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 05:21:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 05:21:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 05:21:22] [comm] Using global sharding
[2023-07-22 05:21:22] [comm] NCCLCommunicators constructed successfully
[2023-07-22 05:21:22] [training] Using 1 GPUs
[2023-07-22 05:21:22] [logits] Applying loss function for 1 factor(s)
[2023-07-22 05:21:22] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:21:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 05:21:23] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:26:41] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 05:26:41] [valid] No post-processing script given for validating translator
[2023-07-22 05:26:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 05:26:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 05:26:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 05:26:41] [comm] Using global sharding
[2023-07-22 05:26:41] [comm] NCCLCommunicators constructed successfully
[2023-07-22 05:26:41] [training] Using 1 GPUs
[2023-07-22 05:26:41] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 05:26:42] Allocating memory for general optimizer shards
[2023-07-22 05:26:42] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:26:42] Loading Adam parameters
[2023-07-22 05:26:42] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:26:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:26:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 05:26:43] [data] Restoring the corpus state to epoch 151, batch 4800
[2023-07-22 05:26:43] [data] Shuffling data
[2023-07-22 05:26:43] [data] Done reading 20,192 sentences
[2023-07-22 05:26:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:26:43] Training started
[2023-07-22 05:26:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 05:26:43] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:26:47] Parameter type float16, optimization type float32, casting types true
[2023-07-22 05:30:22] Seen 20,192 samples
[2023-07-22 05:30:22] Starting data epoch 152 in logical epoch 152
[2023-07-22 05:30:22] [data] Shuffling data
[2023-07-22 05:30:22] [data] Done reading 20,192 sentences
[2023-07-22 05:30:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:34:13] Seen 20,192 samples
[2023-07-22 05:34:13] Starting data epoch 153 in logical epoch 153
[2023-07-22 05:34:13] [data] Shuffling data
[2023-07-22 05:34:13] [data] Done reading 20,192 sentences
[2023-07-22 05:34:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:38:03] Seen 20,192 samples
[2023-07-22 05:38:03] Starting data epoch 154 in logical epoch 154
[2023-07-22 05:38:03] [data] Shuffling data
[2023-07-22 05:38:03] [data] Done reading 20,192 sentences
[2023-07-22 05:38:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:41:55] Seen 20,192 samples
[2023-07-22 05:41:55] Starting data epoch 155 in logical epoch 155
[2023-07-22 05:41:55] [data] Shuffling data
[2023-07-22 05:41:56] [data] Done reading 20,192 sentences
[2023-07-22 05:41:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:45:45] Seen 20,192 samples
[2023-07-22 05:45:45] Starting data epoch 156 in logical epoch 156
[2023-07-22 05:45:45] [data] Shuffling data
[2023-07-22 05:45:45] [data] Done reading 20,192 sentences
[2023-07-22 05:45:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:49:39] Seen 20,192 samples
[2023-07-22 05:49:39] Starting data epoch 157 in logical epoch 157
[2023-07-22 05:49:39] [data] Shuffling data
[2023-07-22 05:49:39] [data] Done reading 20,192 sentences
[2023-07-22 05:49:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:50:33] Ep. 157 : Up. 5000 : Sen. 5,130 : Cost 4.65641975 * 16,028,898 @ 3,150 after 80,167,648 : Time 1432.09s : 11192.63 words/s : gNorm 0.8137
[2023-07-22 05:53:07] Seen 20,192 samples
[2023-07-22 05:53:07] Starting data epoch 158 in logical epoch 158
[2023-07-22 05:53:07] [data] Shuffling data
[2023-07-22 05:53:07] [data] Done reading 20,192 sentences
[2023-07-22 05:53:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:56:56] Seen 20,192 samples
[2023-07-22 05:56:56] Starting data epoch 159 in logical epoch 159
[2023-07-22 05:56:56] [data] Shuffling data
[2023-07-22 05:56:56] [data] Done reading 20,192 sentences
[2023-07-22 05:56:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:00:40] Seen 20,192 samples
[2023-07-22 06:00:40] Starting data epoch 160 in logical epoch 160
[2023-07-22 06:00:40] [data] Shuffling data
[2023-07-22 06:00:40] [data] Done reading 20,192 sentences
[2023-07-22 06:00:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:04:28] Seen 20,192 samples
[2023-07-22 06:04:28] Starting data epoch 161 in logical epoch 161
[2023-07-22 06:04:28] Training finished
[2023-07-22 06:04:45] [valid] Ep. 161 : Up. 5120 : cross-entropy : 134.416 : new best
[2023-07-22 06:08:38] [valid] Ep. 161 : Up. 5120 : translation : 0 : new best
[2023-07-22 06:08:38] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 06:08:39] Saving Adam parameters
[2023-07-22 06:08:40] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 06:08:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:08:48] [marian] Running on node23.datos.cluster.uy as process 15028 with command line:
[2023-07-22 06:08:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 06:08:48] [config] after: 0e
[2023-07-22 06:08:48] [config] after-batches: 0
[2023-07-22 06:08:48] [config] after-epochs: 170
[2023-07-22 06:08:48] [config] all-caps-every: 0
[2023-07-22 06:08:48] [config] allow-unk: false
[2023-07-22 06:08:48] [config] authors: false
[2023-07-22 06:08:48] [config] beam-size: 12
[2023-07-22 06:08:48] [config] bert-class-symbol: "[CLS]"
[2023-07-22 06:08:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 06:08:48] [config] bert-masking-fraction: 0.15
[2023-07-22 06:08:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 06:08:48] [config] bert-train-type-embeddings: true
[2023-07-22 06:08:48] [config] bert-type-vocab-size: 2
[2023-07-22 06:08:48] [config] build-info: ""
[2023-07-22 06:08:48] [config] check-gradient-nan: false
[2023-07-22 06:08:48] [config] check-nan: false
[2023-07-22 06:08:48] [config] cite: false
[2023-07-22 06:08:48] [config] clip-norm: 1
[2023-07-22 06:08:48] [config] cost-scaling:
[2023-07-22 06:08:48] [config]   - 256.f
[2023-07-22 06:08:48] [config]   - 1000
[2023-07-22 06:08:48] [config]   - 2.f
[2023-07-22 06:08:48] [config]   - 256.f
[2023-07-22 06:08:48] [config] cost-type: ce-sum
[2023-07-22 06:08:48] [config] cpu-threads: 0
[2023-07-22 06:08:48] [config] data-threads: 8
[2023-07-22 06:08:48] [config] data-weighting: ""
[2023-07-22 06:08:48] [config] data-weighting-type: sentence
[2023-07-22 06:08:48] [config] dec-cell: gru
[2023-07-22 06:08:48] [config] dec-cell-base-depth: 2
[2023-07-22 06:08:48] [config] dec-cell-high-depth: 1
[2023-07-22 06:08:48] [config] dec-depth: 1
[2023-07-22 06:08:48] [config] devices:
[2023-07-22 06:08:48] [config]   - 0
[2023-07-22 06:08:48] [config] dim-emb: 512
[2023-07-22 06:08:48] [config] dim-rnn: 1024
[2023-07-22 06:08:48] [config] dim-vocabs:
[2023-07-22 06:08:48] [config]   - 16384
[2023-07-22 06:08:48] [config]   - 16384
[2023-07-22 06:08:48] [config] disp-first: 0
[2023-07-22 06:08:48] [config] disp-freq: 1000u
[2023-07-22 06:08:48] [config] disp-label-counts: true
[2023-07-22 06:08:48] [config] dropout-rnn: 0.5
[2023-07-22 06:08:48] [config] dropout-src: 0
[2023-07-22 06:08:48] [config] dropout-trg: 0
[2023-07-22 06:08:48] [config] dump-config: ""
[2023-07-22 06:08:48] [config] dynamic-gradient-scaling:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] early-stopping: 200
[2023-07-22 06:08:48] [config] early-stopping-on: first
[2023-07-22 06:08:48] [config] embedding-fix-src: false
[2023-07-22 06:08:48] [config] embedding-fix-trg: false
[2023-07-22 06:08:48] [config] embedding-normalization: false
[2023-07-22 06:08:48] [config] embedding-vectors:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] enc-cell: gru
[2023-07-22 06:08:48] [config] enc-cell-depth: 1
[2023-07-22 06:08:48] [config] enc-depth: 1
[2023-07-22 06:08:48] [config] enc-type: bidirectional
[2023-07-22 06:08:48] [config] english-title-case-every: 0
[2023-07-22 06:08:48] [config] exponential-smoothing: 0
[2023-07-22 06:08:48] [config] factor-weight: 1
[2023-07-22 06:08:48] [config] factors-combine: sum
[2023-07-22 06:08:48] [config] factors-dim-emb: 0
[2023-07-22 06:08:48] [config] gradient-checkpointing: false
[2023-07-22 06:08:48] [config] gradient-norm-average-window: 100
[2023-07-22 06:08:48] [config] guided-alignment: none
[2023-07-22 06:08:48] [config] guided-alignment-cost: mse
[2023-07-22 06:08:48] [config] guided-alignment-weight: 0.1
[2023-07-22 06:08:48] [config] ignore-model-config: false
[2023-07-22 06:08:48] [config] input-types:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] interpolate-env-vars: false
[2023-07-22 06:08:48] [config] keep-best: false
[2023-07-22 06:08:48] [config] label-smoothing: 0
[2023-07-22 06:08:48] [config] layer-normalization: false
[2023-07-22 06:08:48] [config] learn-rate: 0.0001
[2023-07-22 06:08:48] [config] lemma-dependency: ""
[2023-07-22 06:08:48] [config] lemma-dim-emb: 0
[2023-07-22 06:08:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 06:08:48] [config] log-level: info
[2023-07-22 06:08:48] [config] log-time-zone: ""
[2023-07-22 06:08:48] [config] logical-epoch:
[2023-07-22 06:08:48] [config]   - 1e
[2023-07-22 06:08:48] [config]   - 0
[2023-07-22 06:08:48] [config] lr-decay: 0
[2023-07-22 06:08:48] [config] lr-decay-freq: 50000
[2023-07-22 06:08:48] [config] lr-decay-inv-sqrt:
[2023-07-22 06:08:48] [config]   - 0
[2023-07-22 06:08:48] [config] lr-decay-repeat-warmup: false
[2023-07-22 06:08:48] [config] lr-decay-reset-optimizer: false
[2023-07-22 06:08:48] [config] lr-decay-start:
[2023-07-22 06:08:48] [config]   - 10
[2023-07-22 06:08:48] [config]   - 1
[2023-07-22 06:08:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 06:08:48] [config] lr-report: false
[2023-07-22 06:08:48] [config] lr-warmup: 0
[2023-07-22 06:08:48] [config] lr-warmup-at-reload: false
[2023-07-22 06:08:48] [config] lr-warmup-cycle: false
[2023-07-22 06:08:48] [config] lr-warmup-start-rate: 0
[2023-07-22 06:08:48] [config] max-length: 50
[2023-07-22 06:08:48] [config] max-length-crop: true
[2023-07-22 06:08:48] [config] max-length-factor: 3
[2023-07-22 06:08:48] [config] maxi-batch: 100
[2023-07-22 06:08:48] [config] maxi-batch-sort: trg
[2023-07-22 06:08:48] [config] mini-batch: 64
[2023-07-22 06:08:48] [config] mini-batch-fit: true
[2023-07-22 06:08:48] [config] mini-batch-fit-step: 10
[2023-07-22 06:08:48] [config] mini-batch-round-up: true
[2023-07-22 06:08:48] [config] mini-batch-track-lr: false
[2023-07-22 06:08:48] [config] mini-batch-warmup: 0
[2023-07-22 06:08:48] [config] mini-batch-words: 0
[2023-07-22 06:08:48] [config] mini-batch-words-ref: 0
[2023-07-22 06:08:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 06:08:48] [config] multi-loss-type: sum
[2023-07-22 06:08:48] [config] n-best: false
[2023-07-22 06:08:48] [config] no-nccl: false
[2023-07-22 06:08:48] [config] no-reload: false
[2023-07-22 06:08:48] [config] no-restore-corpus: false
[2023-07-22 06:08:48] [config] normalize: 0
[2023-07-22 06:08:48] [config] normalize-gradient: false
[2023-07-22 06:08:48] [config] num-devices: 0
[2023-07-22 06:08:48] [config] optimizer: adam
[2023-07-22 06:08:48] [config] optimizer-delay: 1
[2023-07-22 06:08:48] [config] optimizer-params:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] output-omit-bias: false
[2023-07-22 06:08:48] [config] overwrite: true
[2023-07-22 06:08:48] [config] precision:
[2023-07-22 06:08:48] [config]   - float16
[2023-07-22 06:08:48] [config]   - float32
[2023-07-22 06:08:48] [config] pretrained-model: ""
[2023-07-22 06:08:48] [config] quantize-biases: false
[2023-07-22 06:08:48] [config] quantize-bits: 0
[2023-07-22 06:08:48] [config] quantize-log-based: false
[2023-07-22 06:08:48] [config] quantize-optimization-steps: 0
[2023-07-22 06:08:48] [config] quiet: false
[2023-07-22 06:08:48] [config] quiet-translation: true
[2023-07-22 06:08:48] [config] relative-paths: false
[2023-07-22 06:08:48] [config] right-left: false
[2023-07-22 06:08:48] [config] save-freq: 10000u
[2023-07-22 06:08:48] [config] seed: 1234
[2023-07-22 06:08:48] [config] sentencepiece-alphas:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] sentencepiece-max-lines: 2000000
[2023-07-22 06:08:48] [config] sentencepiece-options: ""
[2023-07-22 06:08:48] [config] sharding: global
[2023-07-22 06:08:48] [config] shuffle: data
[2023-07-22 06:08:48] [config] shuffle-in-ram: false
[2023-07-22 06:08:48] [config] sigterm: save-and-exit
[2023-07-22 06:08:48] [config] skip: false
[2023-07-22 06:08:48] [config] sqlite: ""
[2023-07-22 06:08:48] [config] sqlite-drop: false
[2023-07-22 06:08:48] [config] sync-freq: 200u
[2023-07-22 06:08:48] [config] sync-sgd: false
[2023-07-22 06:08:48] [config] tempdir: /tmp
[2023-07-22 06:08:48] [config] tied-embeddings: false
[2023-07-22 06:08:48] [config] tied-embeddings-all: true
[2023-07-22 06:08:48] [config] tied-embeddings-src: false
[2023-07-22 06:08:48] [config] train-embedder-rank:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] train-sets:
[2023-07-22 06:08:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 06:08:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 06:08:48] [config] transformer-aan-activation: swish
[2023-07-22 06:08:48] [config] transformer-aan-depth: 2
[2023-07-22 06:08:48] [config] transformer-aan-nogate: false
[2023-07-22 06:08:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 06:08:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 06:08:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 06:08:48] [config] transformer-depth-scaling: false
[2023-07-22 06:08:48] [config] transformer-dim-aan: 2048
[2023-07-22 06:08:48] [config] transformer-dim-ffn: 2048
[2023-07-22 06:08:48] [config] transformer-dropout: 0
[2023-07-22 06:08:48] [config] transformer-dropout-attention: 0
[2023-07-22 06:08:48] [config] transformer-dropout-ffn: 0
[2023-07-22 06:08:48] [config] transformer-ffn-activation: swish
[2023-07-22 06:08:48] [config] transformer-ffn-depth: 2
[2023-07-22 06:08:48] [config] transformer-guided-alignment-layer: last
[2023-07-22 06:08:48] [config] transformer-heads: 8
[2023-07-22 06:08:48] [config] transformer-no-projection: false
[2023-07-22 06:08:48] [config] transformer-pool: false
[2023-07-22 06:08:48] [config] transformer-postprocess: dan
[2023-07-22 06:08:48] [config] transformer-postprocess-emb: d
[2023-07-22 06:08:48] [config] transformer-postprocess-top: ""
[2023-07-22 06:08:48] [config] transformer-preprocess: ""
[2023-07-22 06:08:48] [config] transformer-tied-layers:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] transformer-train-position-embeddings: false
[2023-07-22 06:08:48] [config] tsv: false
[2023-07-22 06:08:48] [config] tsv-fields: 0
[2023-07-22 06:08:48] [config] type: amun
[2023-07-22 06:08:48] [config] ulr: false
[2023-07-22 06:08:48] [config] ulr-dim-emb: 0
[2023-07-22 06:08:48] [config] ulr-dropout: 0
[2023-07-22 06:08:48] [config] ulr-keys-vectors: ""
[2023-07-22 06:08:48] [config] ulr-query-vectors: ""
[2023-07-22 06:08:48] [config] ulr-softmax-temperature: 1
[2023-07-22 06:08:48] [config] ulr-trainable-transformation: false
[2023-07-22 06:08:48] [config] unlikelihood-loss: false
[2023-07-22 06:08:48] [config] valid-freq: 50000000
[2023-07-22 06:08:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 06:08:48] [config] valid-max-length: 1000
[2023-07-22 06:08:48] [config] valid-metrics:
[2023-07-22 06:08:48] [config]   - cross-entropy
[2023-07-22 06:08:48] [config]   - translation
[2023-07-22 06:08:48] [config] valid-mini-batch: 32
[2023-07-22 06:08:48] [config] valid-reset-stalled: false
[2023-07-22 06:08:48] [config] valid-script-args:
[2023-07-22 06:08:48] [config]   []
[2023-07-22 06:08:48] [config] valid-script-path: ""
[2023-07-22 06:08:48] [config] valid-sets:
[2023-07-22 06:08:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 06:08:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 06:08:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 06:08:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:08:48] [config] vocabs:
[2023-07-22 06:08:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:08:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:08:48] [config] word-penalty: 0
[2023-07-22 06:08:48] [config] word-scores: false
[2023-07-22 06:08:48] [config] workspace: 5500
[2023-07-22 06:08:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:08:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:08:48] [training] Using single-device training
[2023-07-22 06:08:49] Synced seed 1234
[2023-07-22 06:08:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:08:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 06:08:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:08:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 06:08:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 06:08:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:08:49] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 06:08:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:08:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:08:50] [comm] Using global sharding
[2023-07-22 06:08:50] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:08:50] [training] Using 1 GPUs
[2023-07-22 06:08:50] [logits] Applying loss function for 1 factor(s)
[2023-07-22 06:08:50] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:08:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 06:08:51] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:15:06] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 06:15:06] [valid] No post-processing script given for validating translator
[2023-07-22 06:15:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:15:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:15:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:15:06] [comm] Using global sharding
[2023-07-22 06:15:06] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:15:06] [training] Using 1 GPUs
[2023-07-22 06:15:06] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 06:15:07] Allocating memory for general optimizer shards
[2023-07-22 06:15:07] [memory] Reserving 322 MB, device gpu0
[2023-07-22 06:15:07] Loading Adam parameters
[2023-07-22 06:15:08] [memory] Reserving 322 MB, device gpu0
[2023-07-22 06:15:08] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:15:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 06:15:08] [data] Restoring the corpus state to epoch 161, batch 5120
[2023-07-22 06:15:08] [data] Shuffling data
[2023-07-22 06:15:08] [data] Done reading 20,192 sentences
[2023-07-22 06:15:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:15:08] Training started
[2023-07-22 06:15:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 06:15:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:15:12] Parameter type float16, optimization type float32, casting types true
[2023-07-22 06:18:55] Seen 20,192 samples
[2023-07-22 06:18:55] Starting data epoch 162 in logical epoch 162
[2023-07-22 06:18:55] [data] Shuffling data
[2023-07-22 06:18:55] [data] Done reading 20,192 sentences
[2023-07-22 06:18:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:22:47] Seen 20,192 samples
[2023-07-22 06:22:47] Starting data epoch 163 in logical epoch 163
[2023-07-22 06:22:47] [data] Shuffling data
[2023-07-22 06:22:47] [data] Done reading 20,192 sentences
[2023-07-22 06:22:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:26:39] Seen 20,192 samples
[2023-07-22 06:26:39] Starting data epoch 164 in logical epoch 164
[2023-07-22 06:26:39] [data] Shuffling data
[2023-07-22 06:26:39] [data] Done reading 20,192 sentences
[2023-07-22 06:26:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:30:31] Seen 20,192 samples
[2023-07-22 06:30:31] Starting data epoch 165 in logical epoch 165
[2023-07-22 06:30:31] [data] Shuffling data
[2023-07-22 06:30:31] [data] Done reading 20,192 sentences
[2023-07-22 06:30:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:34:25] Seen 20,192 samples
[2023-07-22 06:34:25] Starting data epoch 166 in logical epoch 166
[2023-07-22 06:34:25] [data] Shuffling data
[2023-07-22 06:34:25] [data] Done reading 20,192 sentences
[2023-07-22 06:34:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:38:11] Seen 20,192 samples
[2023-07-22 06:38:11] Starting data epoch 167 in logical epoch 167
[2023-07-22 06:38:11] [data] Shuffling data
[2023-07-22 06:38:11] [data] Done reading 20,192 sentences
[2023-07-22 06:38:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:42:04] Seen 20,192 samples
[2023-07-22 06:42:04] Starting data epoch 168 in logical epoch 168
[2023-07-22 06:42:04] [data] Shuffling data
[2023-07-22 06:42:04] [data] Done reading 20,192 sentences
[2023-07-22 06:42:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:45:56] Seen 20,192 samples
[2023-07-22 06:45:56] Starting data epoch 169 in logical epoch 169
[2023-07-22 06:45:56] [data] Shuffling data
[2023-07-22 06:45:56] [data] Done reading 20,192 sentences
[2023-07-22 06:45:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:49:46] Seen 20,192 samples
[2023-07-22 06:49:46] Starting data epoch 170 in logical epoch 170
[2023-07-22 06:49:46] [data] Shuffling data
[2023-07-22 06:49:46] [data] Done reading 20,192 sentences
[2023-07-22 06:49:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:53:38] Seen 20,192 samples
[2023-07-22 06:53:38] Starting data epoch 171 in logical epoch 171
[2023-07-22 06:53:38] Training finished
[2023-07-22 06:53:52] [valid] Ep. 171 : Up. 5440 : cross-entropy : 133.436 : new best
[2023-07-22 06:56:29] [valid] Ep. 171 : Up. 5440 : translation : 0 : new best
[2023-07-22 06:56:29] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 06:56:33] Saving Adam parameters
[2023-07-22 06:56:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 06:56:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:56:39] [marian] Running on node23.datos.cluster.uy as process 18272 with command line:
[2023-07-22 06:56:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 06:56:39] [config] after: 0e
[2023-07-22 06:56:39] [config] after-batches: 0
[2023-07-22 06:56:39] [config] after-epochs: 180
[2023-07-22 06:56:39] [config] all-caps-every: 0
[2023-07-22 06:56:39] [config] allow-unk: false
[2023-07-22 06:56:39] [config] authors: false
[2023-07-22 06:56:39] [config] beam-size: 12
[2023-07-22 06:56:39] [config] bert-class-symbol: "[CLS]"
[2023-07-22 06:56:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 06:56:39] [config] bert-masking-fraction: 0.15
[2023-07-22 06:56:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 06:56:39] [config] bert-train-type-embeddings: true
[2023-07-22 06:56:39] [config] bert-type-vocab-size: 2
[2023-07-22 06:56:39] [config] build-info: ""
[2023-07-22 06:56:39] [config] check-gradient-nan: false
[2023-07-22 06:56:39] [config] check-nan: false
[2023-07-22 06:56:39] [config] cite: false
[2023-07-22 06:56:39] [config] clip-norm: 1
[2023-07-22 06:56:39] [config] cost-scaling:
[2023-07-22 06:56:39] [config]   - 256.f
[2023-07-22 06:56:39] [config]   - 1000
[2023-07-22 06:56:39] [config]   - 2.f
[2023-07-22 06:56:39] [config]   - 256.f
[2023-07-22 06:56:39] [config] cost-type: ce-sum
[2023-07-22 06:56:39] [config] cpu-threads: 0
[2023-07-22 06:56:39] [config] data-threads: 8
[2023-07-22 06:56:39] [config] data-weighting: ""
[2023-07-22 06:56:39] [config] data-weighting-type: sentence
[2023-07-22 06:56:39] [config] dec-cell: gru
[2023-07-22 06:56:39] [config] dec-cell-base-depth: 2
[2023-07-22 06:56:39] [config] dec-cell-high-depth: 1
[2023-07-22 06:56:39] [config] dec-depth: 1
[2023-07-22 06:56:39] [config] devices:
[2023-07-22 06:56:39] [config]   - 0
[2023-07-22 06:56:39] [config] dim-emb: 512
[2023-07-22 06:56:39] [config] dim-rnn: 1024
[2023-07-22 06:56:39] [config] dim-vocabs:
[2023-07-22 06:56:39] [config]   - 16384
[2023-07-22 06:56:39] [config]   - 16384
[2023-07-22 06:56:39] [config] disp-first: 0
[2023-07-22 06:56:39] [config] disp-freq: 1000u
[2023-07-22 06:56:39] [config] disp-label-counts: true
[2023-07-22 06:56:39] [config] dropout-rnn: 0.5
[2023-07-22 06:56:39] [config] dropout-src: 0
[2023-07-22 06:56:39] [config] dropout-trg: 0
[2023-07-22 06:56:39] [config] dump-config: ""
[2023-07-22 06:56:39] [config] dynamic-gradient-scaling:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] early-stopping: 200
[2023-07-22 06:56:39] [config] early-stopping-on: first
[2023-07-22 06:56:39] [config] embedding-fix-src: false
[2023-07-22 06:56:39] [config] embedding-fix-trg: false
[2023-07-22 06:56:39] [config] embedding-normalization: false
[2023-07-22 06:56:39] [config] embedding-vectors:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] enc-cell: gru
[2023-07-22 06:56:39] [config] enc-cell-depth: 1
[2023-07-22 06:56:39] [config] enc-depth: 1
[2023-07-22 06:56:39] [config] enc-type: bidirectional
[2023-07-22 06:56:39] [config] english-title-case-every: 0
[2023-07-22 06:56:39] [config] exponential-smoothing: 0
[2023-07-22 06:56:39] [config] factor-weight: 1
[2023-07-22 06:56:39] [config] factors-combine: sum
[2023-07-22 06:56:39] [config] factors-dim-emb: 0
[2023-07-22 06:56:39] [config] gradient-checkpointing: false
[2023-07-22 06:56:39] [config] gradient-norm-average-window: 100
[2023-07-22 06:56:39] [config] guided-alignment: none
[2023-07-22 06:56:39] [config] guided-alignment-cost: mse
[2023-07-22 06:56:39] [config] guided-alignment-weight: 0.1
[2023-07-22 06:56:39] [config] ignore-model-config: false
[2023-07-22 06:56:39] [config] input-types:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] interpolate-env-vars: false
[2023-07-22 06:56:39] [config] keep-best: false
[2023-07-22 06:56:39] [config] label-smoothing: 0
[2023-07-22 06:56:39] [config] layer-normalization: false
[2023-07-22 06:56:39] [config] learn-rate: 0.0001
[2023-07-22 06:56:39] [config] lemma-dependency: ""
[2023-07-22 06:56:39] [config] lemma-dim-emb: 0
[2023-07-22 06:56:39] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 06:56:39] [config] log-level: info
[2023-07-22 06:56:39] [config] log-time-zone: ""
[2023-07-22 06:56:39] [config] logical-epoch:
[2023-07-22 06:56:39] [config]   - 1e
[2023-07-22 06:56:39] [config]   - 0
[2023-07-22 06:56:39] [config] lr-decay: 0
[2023-07-22 06:56:39] [config] lr-decay-freq: 50000
[2023-07-22 06:56:39] [config] lr-decay-inv-sqrt:
[2023-07-22 06:56:39] [config]   - 0
[2023-07-22 06:56:39] [config] lr-decay-repeat-warmup: false
[2023-07-22 06:56:39] [config] lr-decay-reset-optimizer: false
[2023-07-22 06:56:39] [config] lr-decay-start:
[2023-07-22 06:56:39] [config]   - 10
[2023-07-22 06:56:39] [config]   - 1
[2023-07-22 06:56:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 06:56:39] [config] lr-report: false
[2023-07-22 06:56:39] [config] lr-warmup: 0
[2023-07-22 06:56:39] [config] lr-warmup-at-reload: false
[2023-07-22 06:56:39] [config] lr-warmup-cycle: false
[2023-07-22 06:56:39] [config] lr-warmup-start-rate: 0
[2023-07-22 06:56:39] [config] max-length: 50
[2023-07-22 06:56:39] [config] max-length-crop: true
[2023-07-22 06:56:39] [config] max-length-factor: 3
[2023-07-22 06:56:39] [config] maxi-batch: 100
[2023-07-22 06:56:39] [config] maxi-batch-sort: trg
[2023-07-22 06:56:39] [config] mini-batch: 64
[2023-07-22 06:56:39] [config] mini-batch-fit: true
[2023-07-22 06:56:39] [config] mini-batch-fit-step: 10
[2023-07-22 06:56:39] [config] mini-batch-round-up: true
[2023-07-22 06:56:39] [config] mini-batch-track-lr: false
[2023-07-22 06:56:39] [config] mini-batch-warmup: 0
[2023-07-22 06:56:39] [config] mini-batch-words: 0
[2023-07-22 06:56:39] [config] mini-batch-words-ref: 0
[2023-07-22 06:56:39] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 06:56:39] [config] multi-loss-type: sum
[2023-07-22 06:56:39] [config] n-best: false
[2023-07-22 06:56:39] [config] no-nccl: false
[2023-07-22 06:56:39] [config] no-reload: false
[2023-07-22 06:56:39] [config] no-restore-corpus: false
[2023-07-22 06:56:39] [config] normalize: 0
[2023-07-22 06:56:39] [config] normalize-gradient: false
[2023-07-22 06:56:39] [config] num-devices: 0
[2023-07-22 06:56:39] [config] optimizer: adam
[2023-07-22 06:56:39] [config] optimizer-delay: 1
[2023-07-22 06:56:39] [config] optimizer-params:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] output-omit-bias: false
[2023-07-22 06:56:39] [config] overwrite: true
[2023-07-22 06:56:39] [config] precision:
[2023-07-22 06:56:39] [config]   - float16
[2023-07-22 06:56:39] [config]   - float32
[2023-07-22 06:56:39] [config] pretrained-model: ""
[2023-07-22 06:56:39] [config] quantize-biases: false
[2023-07-22 06:56:39] [config] quantize-bits: 0
[2023-07-22 06:56:39] [config] quantize-log-based: false
[2023-07-22 06:56:39] [config] quantize-optimization-steps: 0
[2023-07-22 06:56:39] [config] quiet: false
[2023-07-22 06:56:39] [config] quiet-translation: true
[2023-07-22 06:56:39] [config] relative-paths: false
[2023-07-22 06:56:39] [config] right-left: false
[2023-07-22 06:56:39] [config] save-freq: 10000u
[2023-07-22 06:56:39] [config] seed: 1234
[2023-07-22 06:56:39] [config] sentencepiece-alphas:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] sentencepiece-max-lines: 2000000
[2023-07-22 06:56:39] [config] sentencepiece-options: ""
[2023-07-22 06:56:39] [config] sharding: global
[2023-07-22 06:56:39] [config] shuffle: data
[2023-07-22 06:56:39] [config] shuffle-in-ram: false
[2023-07-22 06:56:39] [config] sigterm: save-and-exit
[2023-07-22 06:56:39] [config] skip: false
[2023-07-22 06:56:39] [config] sqlite: ""
[2023-07-22 06:56:39] [config] sqlite-drop: false
[2023-07-22 06:56:39] [config] sync-freq: 200u
[2023-07-22 06:56:39] [config] sync-sgd: false
[2023-07-22 06:56:39] [config] tempdir: /tmp
[2023-07-22 06:56:39] [config] tied-embeddings: false
[2023-07-22 06:56:39] [config] tied-embeddings-all: true
[2023-07-22 06:56:39] [config] tied-embeddings-src: false
[2023-07-22 06:56:39] [config] train-embedder-rank:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] train-sets:
[2023-07-22 06:56:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 06:56:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 06:56:39] [config] transformer-aan-activation: swish
[2023-07-22 06:56:39] [config] transformer-aan-depth: 2
[2023-07-22 06:56:39] [config] transformer-aan-nogate: false
[2023-07-22 06:56:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 06:56:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 06:56:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 06:56:39] [config] transformer-depth-scaling: false
[2023-07-22 06:56:39] [config] transformer-dim-aan: 2048
[2023-07-22 06:56:39] [config] transformer-dim-ffn: 2048
[2023-07-22 06:56:39] [config] transformer-dropout: 0
[2023-07-22 06:56:39] [config] transformer-dropout-attention: 0
[2023-07-22 06:56:39] [config] transformer-dropout-ffn: 0
[2023-07-22 06:56:39] [config] transformer-ffn-activation: swish
[2023-07-22 06:56:39] [config] transformer-ffn-depth: 2
[2023-07-22 06:56:39] [config] transformer-guided-alignment-layer: last
[2023-07-22 06:56:39] [config] transformer-heads: 8
[2023-07-22 06:56:39] [config] transformer-no-projection: false
[2023-07-22 06:56:39] [config] transformer-pool: false
[2023-07-22 06:56:39] [config] transformer-postprocess: dan
[2023-07-22 06:56:39] [config] transformer-postprocess-emb: d
[2023-07-22 06:56:39] [config] transformer-postprocess-top: ""
[2023-07-22 06:56:39] [config] transformer-preprocess: ""
[2023-07-22 06:56:39] [config] transformer-tied-layers:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] transformer-train-position-embeddings: false
[2023-07-22 06:56:39] [config] tsv: false
[2023-07-22 06:56:39] [config] tsv-fields: 0
[2023-07-22 06:56:39] [config] type: amun
[2023-07-22 06:56:39] [config] ulr: false
[2023-07-22 06:56:39] [config] ulr-dim-emb: 0
[2023-07-22 06:56:39] [config] ulr-dropout: 0
[2023-07-22 06:56:39] [config] ulr-keys-vectors: ""
[2023-07-22 06:56:39] [config] ulr-query-vectors: ""
[2023-07-22 06:56:39] [config] ulr-softmax-temperature: 1
[2023-07-22 06:56:39] [config] ulr-trainable-transformation: false
[2023-07-22 06:56:39] [config] unlikelihood-loss: false
[2023-07-22 06:56:39] [config] valid-freq: 50000000
[2023-07-22 06:56:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 06:56:39] [config] valid-max-length: 1000
[2023-07-22 06:56:39] [config] valid-metrics:
[2023-07-22 06:56:39] [config]   - cross-entropy
[2023-07-22 06:56:39] [config]   - translation
[2023-07-22 06:56:39] [config] valid-mini-batch: 32
[2023-07-22 06:56:39] [config] valid-reset-stalled: false
[2023-07-22 06:56:39] [config] valid-script-args:
[2023-07-22 06:56:39] [config]   []
[2023-07-22 06:56:39] [config] valid-script-path: ""
[2023-07-22 06:56:39] [config] valid-sets:
[2023-07-22 06:56:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 06:56:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 06:56:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 06:56:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:56:39] [config] vocabs:
[2023-07-22 06:56:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:56:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:56:39] [config] word-penalty: 0
[2023-07-22 06:56:39] [config] word-scores: false
[2023-07-22 06:56:39] [config] workspace: 5500
[2023-07-22 06:56:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:56:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:56:39] [training] Using single-device training
[2023-07-22 06:56:40] Synced seed 1234
[2023-07-22 06:56:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:56:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 06:56:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:56:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 06:56:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 06:56:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:56:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 06:56:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:56:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:56:41] [comm] Using global sharding
[2023-07-22 06:56:42] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:56:42] [training] Using 1 GPUs
[2023-07-22 06:56:42] [logits] Applying loss function for 1 factor(s)
[2023-07-22 06:56:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:56:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 06:56:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:02:51] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 07:02:51] [valid] No post-processing script given for validating translator
[2023-07-22 07:02:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:02:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:02:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:02:51] [comm] Using global sharding
[2023-07-22 07:02:51] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:02:51] [training] Using 1 GPUs
[2023-07-22 07:02:51] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 07:02:52] Allocating memory for general optimizer shards
[2023-07-22 07:02:52] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:02:52] Loading Adam parameters
[2023-07-22 07:02:53] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:02:53] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:02:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 07:02:53] [data] Restoring the corpus state to epoch 171, batch 5440
[2023-07-22 07:02:53] [data] Shuffling data
[2023-07-22 07:02:53] [data] Done reading 20,192 sentences
[2023-07-22 07:02:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:02:53] Training started
[2023-07-22 07:02:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 07:02:53] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:02:55] Parameter type float16, optimization type float32, casting types true
[2023-07-22 07:06:33] Seen 20,192 samples
[2023-07-22 07:06:33] Starting data epoch 172 in logical epoch 172
[2023-07-22 07:06:33] [data] Shuffling data
[2023-07-22 07:06:33] [data] Done reading 20,192 sentences
[2023-07-22 07:06:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:10:22] Seen 20,192 samples
[2023-07-22 07:10:22] Starting data epoch 173 in logical epoch 173
[2023-07-22 07:10:22] [data] Shuffling data
[2023-07-22 07:10:22] [data] Done reading 20,192 sentences
[2023-07-22 07:10:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:14:10] Seen 20,192 samples
[2023-07-22 07:14:10] Starting data epoch 174 in logical epoch 174
[2023-07-22 07:14:10] [data] Shuffling data
[2023-07-22 07:14:10] [data] Done reading 20,192 sentences
[2023-07-22 07:14:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:17:58] Seen 20,192 samples
[2023-07-22 07:17:58] Starting data epoch 175 in logical epoch 175
[2023-07-22 07:17:58] [data] Shuffling data
[2023-07-22 07:17:58] [data] Done reading 20,192 sentences
[2023-07-22 07:17:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:21:42] Seen 20,192 samples
[2023-07-22 07:21:42] Starting data epoch 176 in logical epoch 176
[2023-07-22 07:21:42] [data] Shuffling data
[2023-07-22 07:21:42] [data] Done reading 20,192 sentences
[2023-07-22 07:21:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:25:35] Seen 20,192 samples
[2023-07-22 07:25:35] Starting data epoch 177 in logical epoch 177
[2023-07-22 07:25:35] [data] Shuffling data
[2023-07-22 07:25:35] [data] Done reading 20,192 sentences
[2023-07-22 07:25:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:29:28] Seen 20,192 samples
[2023-07-22 07:29:28] Starting data epoch 178 in logical epoch 178
[2023-07-22 07:29:28] [data] Shuffling data
[2023-07-22 07:29:28] [data] Done reading 20,192 sentences
[2023-07-22 07:29:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:33:14] Seen 20,192 samples
[2023-07-22 07:33:14] Starting data epoch 179 in logical epoch 179
[2023-07-22 07:33:14] [data] Shuffling data
[2023-07-22 07:33:14] [data] Done reading 20,192 sentences
[2023-07-22 07:33:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:36:59] Seen 20,192 samples
[2023-07-22 07:36:59] Starting data epoch 180 in logical epoch 180
[2023-07-22 07:36:59] [data] Shuffling data
[2023-07-22 07:36:59] [data] Done reading 20,192 sentences
[2023-07-22 07:36:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:40:47] Seen 20,192 samples
[2023-07-22 07:40:47] Starting data epoch 181 in logical epoch 181
[2023-07-22 07:40:47] Training finished
[2023-07-22 07:41:01] [valid] Ep. 181 : Up. 5760 : cross-entropy : 134.366 : stalled 1 times (last best: 133.436)
[2023-07-22 07:42:09] [valid] Ep. 181 : Up. 5760 : translation : 0 : new best
[2023-07-22 07:42:09] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 07:42:11] Saving Adam parameters
[2023-07-22 07:42:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 07:42:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 07:42:19] [marian] Running on node23.datos.cluster.uy as process 21053 with command line:
[2023-07-22 07:42:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 07:42:19] [config] after: 0e
[2023-07-22 07:42:19] [config] after-batches: 0
[2023-07-22 07:42:19] [config] after-epochs: 190
[2023-07-22 07:42:19] [config] all-caps-every: 0
[2023-07-22 07:42:19] [config] allow-unk: false
[2023-07-22 07:42:19] [config] authors: false
[2023-07-22 07:42:19] [config] beam-size: 12
[2023-07-22 07:42:19] [config] bert-class-symbol: "[CLS]"
[2023-07-22 07:42:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 07:42:19] [config] bert-masking-fraction: 0.15
[2023-07-22 07:42:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 07:42:19] [config] bert-train-type-embeddings: true
[2023-07-22 07:42:19] [config] bert-type-vocab-size: 2
[2023-07-22 07:42:19] [config] build-info: ""
[2023-07-22 07:42:19] [config] check-gradient-nan: false
[2023-07-22 07:42:19] [config] check-nan: false
[2023-07-22 07:42:19] [config] cite: false
[2023-07-22 07:42:19] [config] clip-norm: 1
[2023-07-22 07:42:19] [config] cost-scaling:
[2023-07-22 07:42:19] [config]   - 256.f
[2023-07-22 07:42:19] [config]   - 1000
[2023-07-22 07:42:19] [config]   - 2.f
[2023-07-22 07:42:19] [config]   - 256.f
[2023-07-22 07:42:19] [config] cost-type: ce-sum
[2023-07-22 07:42:19] [config] cpu-threads: 0
[2023-07-22 07:42:19] [config] data-threads: 8
[2023-07-22 07:42:19] [config] data-weighting: ""
[2023-07-22 07:42:19] [config] data-weighting-type: sentence
[2023-07-22 07:42:19] [config] dec-cell: gru
[2023-07-22 07:42:19] [config] dec-cell-base-depth: 2
[2023-07-22 07:42:19] [config] dec-cell-high-depth: 1
[2023-07-22 07:42:19] [config] dec-depth: 1
[2023-07-22 07:42:19] [config] devices:
[2023-07-22 07:42:19] [config]   - 0
[2023-07-22 07:42:19] [config] dim-emb: 512
[2023-07-22 07:42:19] [config] dim-rnn: 1024
[2023-07-22 07:42:19] [config] dim-vocabs:
[2023-07-22 07:42:19] [config]   - 16384
[2023-07-22 07:42:19] [config]   - 16384
[2023-07-22 07:42:19] [config] disp-first: 0
[2023-07-22 07:42:19] [config] disp-freq: 1000u
[2023-07-22 07:42:19] [config] disp-label-counts: true
[2023-07-22 07:42:19] [config] dropout-rnn: 0.5
[2023-07-22 07:42:19] [config] dropout-src: 0
[2023-07-22 07:42:19] [config] dropout-trg: 0
[2023-07-22 07:42:19] [config] dump-config: ""
[2023-07-22 07:42:19] [config] dynamic-gradient-scaling:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] early-stopping: 200
[2023-07-22 07:42:19] [config] early-stopping-on: first
[2023-07-22 07:42:19] [config] embedding-fix-src: false
[2023-07-22 07:42:19] [config] embedding-fix-trg: false
[2023-07-22 07:42:19] [config] embedding-normalization: false
[2023-07-22 07:42:19] [config] embedding-vectors:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] enc-cell: gru
[2023-07-22 07:42:19] [config] enc-cell-depth: 1
[2023-07-22 07:42:19] [config] enc-depth: 1
[2023-07-22 07:42:19] [config] enc-type: bidirectional
[2023-07-22 07:42:19] [config] english-title-case-every: 0
[2023-07-22 07:42:19] [config] exponential-smoothing: 0
[2023-07-22 07:42:19] [config] factor-weight: 1
[2023-07-22 07:42:19] [config] factors-combine: sum
[2023-07-22 07:42:19] [config] factors-dim-emb: 0
[2023-07-22 07:42:19] [config] gradient-checkpointing: false
[2023-07-22 07:42:19] [config] gradient-norm-average-window: 100
[2023-07-22 07:42:19] [config] guided-alignment: none
[2023-07-22 07:42:19] [config] guided-alignment-cost: mse
[2023-07-22 07:42:19] [config] guided-alignment-weight: 0.1
[2023-07-22 07:42:19] [config] ignore-model-config: false
[2023-07-22 07:42:19] [config] input-types:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] interpolate-env-vars: false
[2023-07-22 07:42:19] [config] keep-best: false
[2023-07-22 07:42:19] [config] label-smoothing: 0
[2023-07-22 07:42:19] [config] layer-normalization: false
[2023-07-22 07:42:19] [config] learn-rate: 0.0001
[2023-07-22 07:42:19] [config] lemma-dependency: ""
[2023-07-22 07:42:19] [config] lemma-dim-emb: 0
[2023-07-22 07:42:19] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 07:42:19] [config] log-level: info
[2023-07-22 07:42:19] [config] log-time-zone: ""
[2023-07-22 07:42:19] [config] logical-epoch:
[2023-07-22 07:42:19] [config]   - 1e
[2023-07-22 07:42:19] [config]   - 0
[2023-07-22 07:42:19] [config] lr-decay: 0
[2023-07-22 07:42:19] [config] lr-decay-freq: 50000
[2023-07-22 07:42:19] [config] lr-decay-inv-sqrt:
[2023-07-22 07:42:19] [config]   - 0
[2023-07-22 07:42:19] [config] lr-decay-repeat-warmup: false
[2023-07-22 07:42:19] [config] lr-decay-reset-optimizer: false
[2023-07-22 07:42:19] [config] lr-decay-start:
[2023-07-22 07:42:19] [config]   - 10
[2023-07-22 07:42:19] [config]   - 1
[2023-07-22 07:42:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 07:42:19] [config] lr-report: false
[2023-07-22 07:42:19] [config] lr-warmup: 0
[2023-07-22 07:42:19] [config] lr-warmup-at-reload: false
[2023-07-22 07:42:19] [config] lr-warmup-cycle: false
[2023-07-22 07:42:19] [config] lr-warmup-start-rate: 0
[2023-07-22 07:42:19] [config] max-length: 50
[2023-07-22 07:42:19] [config] max-length-crop: true
[2023-07-22 07:42:19] [config] max-length-factor: 3
[2023-07-22 07:42:19] [config] maxi-batch: 100
[2023-07-22 07:42:19] [config] maxi-batch-sort: trg
[2023-07-22 07:42:19] [config] mini-batch: 64
[2023-07-22 07:42:19] [config] mini-batch-fit: true
[2023-07-22 07:42:19] [config] mini-batch-fit-step: 10
[2023-07-22 07:42:19] [config] mini-batch-round-up: true
[2023-07-22 07:42:19] [config] mini-batch-track-lr: false
[2023-07-22 07:42:19] [config] mini-batch-warmup: 0
[2023-07-22 07:42:19] [config] mini-batch-words: 0
[2023-07-22 07:42:19] [config] mini-batch-words-ref: 0
[2023-07-22 07:42:19] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 07:42:19] [config] multi-loss-type: sum
[2023-07-22 07:42:19] [config] n-best: false
[2023-07-22 07:42:19] [config] no-nccl: false
[2023-07-22 07:42:19] [config] no-reload: false
[2023-07-22 07:42:19] [config] no-restore-corpus: false
[2023-07-22 07:42:19] [config] normalize: 0
[2023-07-22 07:42:19] [config] normalize-gradient: false
[2023-07-22 07:42:19] [config] num-devices: 0
[2023-07-22 07:42:19] [config] optimizer: adam
[2023-07-22 07:42:19] [config] optimizer-delay: 1
[2023-07-22 07:42:19] [config] optimizer-params:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] output-omit-bias: false
[2023-07-22 07:42:19] [config] overwrite: true
[2023-07-22 07:42:19] [config] precision:
[2023-07-22 07:42:19] [config]   - float16
[2023-07-22 07:42:19] [config]   - float32
[2023-07-22 07:42:19] [config] pretrained-model: ""
[2023-07-22 07:42:19] [config] quantize-biases: false
[2023-07-22 07:42:19] [config] quantize-bits: 0
[2023-07-22 07:42:19] [config] quantize-log-based: false
[2023-07-22 07:42:19] [config] quantize-optimization-steps: 0
[2023-07-22 07:42:19] [config] quiet: false
[2023-07-22 07:42:19] [config] quiet-translation: true
[2023-07-22 07:42:19] [config] relative-paths: false
[2023-07-22 07:42:19] [config] right-left: false
[2023-07-22 07:42:19] [config] save-freq: 10000u
[2023-07-22 07:42:19] [config] seed: 1234
[2023-07-22 07:42:19] [config] sentencepiece-alphas:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] sentencepiece-max-lines: 2000000
[2023-07-22 07:42:19] [config] sentencepiece-options: ""
[2023-07-22 07:42:19] [config] sharding: global
[2023-07-22 07:42:19] [config] shuffle: data
[2023-07-22 07:42:19] [config] shuffle-in-ram: false
[2023-07-22 07:42:19] [config] sigterm: save-and-exit
[2023-07-22 07:42:19] [config] skip: false
[2023-07-22 07:42:19] [config] sqlite: ""
[2023-07-22 07:42:19] [config] sqlite-drop: false
[2023-07-22 07:42:19] [config] sync-freq: 200u
[2023-07-22 07:42:19] [config] sync-sgd: false
[2023-07-22 07:42:19] [config] tempdir: /tmp
[2023-07-22 07:42:19] [config] tied-embeddings: false
[2023-07-22 07:42:19] [config] tied-embeddings-all: true
[2023-07-22 07:42:19] [config] tied-embeddings-src: false
[2023-07-22 07:42:19] [config] train-embedder-rank:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] train-sets:
[2023-07-22 07:42:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 07:42:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 07:42:19] [config] transformer-aan-activation: swish
[2023-07-22 07:42:19] [config] transformer-aan-depth: 2
[2023-07-22 07:42:19] [config] transformer-aan-nogate: false
[2023-07-22 07:42:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 07:42:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 07:42:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 07:42:19] [config] transformer-depth-scaling: false
[2023-07-22 07:42:19] [config] transformer-dim-aan: 2048
[2023-07-22 07:42:19] [config] transformer-dim-ffn: 2048
[2023-07-22 07:42:19] [config] transformer-dropout: 0
[2023-07-22 07:42:19] [config] transformer-dropout-attention: 0
[2023-07-22 07:42:19] [config] transformer-dropout-ffn: 0
[2023-07-22 07:42:19] [config] transformer-ffn-activation: swish
[2023-07-22 07:42:19] [config] transformer-ffn-depth: 2
[2023-07-22 07:42:19] [config] transformer-guided-alignment-layer: last
[2023-07-22 07:42:19] [config] transformer-heads: 8
[2023-07-22 07:42:19] [config] transformer-no-projection: false
[2023-07-22 07:42:19] [config] transformer-pool: false
[2023-07-22 07:42:19] [config] transformer-postprocess: dan
[2023-07-22 07:42:19] [config] transformer-postprocess-emb: d
[2023-07-22 07:42:19] [config] transformer-postprocess-top: ""
[2023-07-22 07:42:19] [config] transformer-preprocess: ""
[2023-07-22 07:42:19] [config] transformer-tied-layers:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] transformer-train-position-embeddings: false
[2023-07-22 07:42:19] [config] tsv: false
[2023-07-22 07:42:19] [config] tsv-fields: 0
[2023-07-22 07:42:19] [config] type: amun
[2023-07-22 07:42:19] [config] ulr: false
[2023-07-22 07:42:19] [config] ulr-dim-emb: 0
[2023-07-22 07:42:19] [config] ulr-dropout: 0
[2023-07-22 07:42:19] [config] ulr-keys-vectors: ""
[2023-07-22 07:42:19] [config] ulr-query-vectors: ""
[2023-07-22 07:42:19] [config] ulr-softmax-temperature: 1
[2023-07-22 07:42:19] [config] ulr-trainable-transformation: false
[2023-07-22 07:42:19] [config] unlikelihood-loss: false
[2023-07-22 07:42:19] [config] valid-freq: 50000000
[2023-07-22 07:42:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 07:42:19] [config] valid-max-length: 1000
[2023-07-22 07:42:19] [config] valid-metrics:
[2023-07-22 07:42:19] [config]   - cross-entropy
[2023-07-22 07:42:19] [config]   - translation
[2023-07-22 07:42:19] [config] valid-mini-batch: 32
[2023-07-22 07:42:19] [config] valid-reset-stalled: false
[2023-07-22 07:42:19] [config] valid-script-args:
[2023-07-22 07:42:19] [config]   []
[2023-07-22 07:42:19] [config] valid-script-path: ""
[2023-07-22 07:42:19] [config] valid-sets:
[2023-07-22 07:42:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 07:42:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 07:42:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 07:42:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 07:42:19] [config] vocabs:
[2023-07-22 07:42:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 07:42:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 07:42:19] [config] word-penalty: 0
[2023-07-22 07:42:19] [config] word-scores: false
[2023-07-22 07:42:19] [config] workspace: 5500
[2023-07-22 07:42:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 07:42:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:42:19] [training] Using single-device training
[2023-07-22 07:42:20] Synced seed 1234
[2023-07-22 07:42:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 07:42:20] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 07:42:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 07:42:20] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 07:42:20] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 07:42:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:42:20] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 07:42:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:42:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:42:21] [comm] Using global sharding
[2023-07-22 07:42:21] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:42:21] [training] Using 1 GPUs
[2023-07-22 07:42:21] [logits] Applying loss function for 1 factor(s)
[2023-07-22 07:42:21] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:42:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 07:42:22] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:48:15] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 07:48:15] [valid] No post-processing script given for validating translator
[2023-07-22 07:48:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:48:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:48:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:48:15] [comm] Using global sharding
[2023-07-22 07:48:16] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:48:16] [training] Using 1 GPUs
[2023-07-22 07:48:16] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 07:48:17] Allocating memory for general optimizer shards
[2023-07-22 07:48:17] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:48:17] Loading Adam parameters
[2023-07-22 07:48:17] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:48:17] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:48:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 07:48:17] [data] Restoring the corpus state to epoch 181, batch 5760
[2023-07-22 07:48:17] [data] Shuffling data
[2023-07-22 07:48:17] [data] Done reading 20,192 sentences
[2023-07-22 07:48:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:48:17] Training started
[2023-07-22 07:48:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 07:48:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:48:25] Parameter type float16, optimization type float32, casting types true
[2023-07-22 07:51:59] Seen 20,192 samples
[2023-07-22 07:51:59] Starting data epoch 182 in logical epoch 182
[2023-07-22 07:51:59] [data] Shuffling data
[2023-07-22 07:51:59] [data] Done reading 20,192 sentences
[2023-07-22 07:51:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:55:43] Seen 20,192 samples
[2023-07-22 07:55:43] Starting data epoch 183 in logical epoch 183
[2023-07-22 07:55:43] [data] Shuffling data
[2023-07-22 07:55:43] [data] Done reading 20,192 sentences
[2023-07-22 07:55:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:59:26] Seen 20,192 samples
[2023-07-22 07:59:26] Starting data epoch 184 in logical epoch 184
[2023-07-22 07:59:26] [data] Shuffling data
[2023-07-22 07:59:26] [data] Done reading 20,192 sentences
[2023-07-22 07:59:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:03:14] Seen 20,192 samples
[2023-07-22 08:03:14] Starting data epoch 185 in logical epoch 185
[2023-07-22 08:03:14] [data] Shuffling data
[2023-07-22 08:03:14] [data] Done reading 20,192 sentences
[2023-07-22 08:03:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:06:57] Seen 20,192 samples
[2023-07-22 08:06:57] Starting data epoch 186 in logical epoch 186
[2023-07-22 08:06:57] [data] Shuffling data
[2023-07-22 08:06:57] [data] Done reading 20,192 sentences
[2023-07-22 08:06:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:10:48] Seen 20,192 samples
[2023-07-22 08:10:48] Starting data epoch 187 in logical epoch 187
[2023-07-22 08:10:48] [data] Shuffling data
[2023-07-22 08:10:48] [data] Done reading 20,192 sentences
[2023-07-22 08:10:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:14:31] Seen 20,192 samples
[2023-07-22 08:14:31] Starting data epoch 188 in logical epoch 188
[2023-07-22 08:14:31] [data] Shuffling data
[2023-07-22 08:14:31] [data] Done reading 20,192 sentences
[2023-07-22 08:14:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:16:28] Ep. 188 : Up. 6000 : Sen. 10,260 : Cost 4.37644482 * 16,049,905 @ 24,009 after 96,217,555 : Time 1692.84s : 9481.03 words/s : gNorm 0.8014
[2023-07-22 08:18:21] Seen 20,192 samples
[2023-07-22 08:18:21] Starting data epoch 189 in logical epoch 189
[2023-07-22 08:18:21] [data] Shuffling data
[2023-07-22 08:18:21] [data] Done reading 20,192 sentences
[2023-07-22 08:18:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:22:04] Seen 20,192 samples
[2023-07-22 08:22:04] Starting data epoch 190 in logical epoch 190
[2023-07-22 08:22:04] [data] Shuffling data
[2023-07-22 08:22:04] [data] Done reading 20,192 sentences
[2023-07-22 08:22:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:25:51] Seen 20,192 samples
[2023-07-22 08:25:51] Starting data epoch 191 in logical epoch 191
[2023-07-22 08:25:51] Training finished
[2023-07-22 08:26:06] [valid] Ep. 191 : Up. 6080 : cross-entropy : 132.893 : new best
[2023-07-22 08:27:58] [valid] Ep. 191 : Up. 6080 : translation : 0 : new best
[2023-07-22 08:27:58] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 08:28:00] Saving Adam parameters
[2023-07-22 08:28:00] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 08:28:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:28:07] [marian] Running on node23.datos.cluster.uy as process 24174 with command line:
[2023-07-22 08:28:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --dropout-rnn 0.5
[2023-07-22 08:28:07] [config] after: 0e
[2023-07-22 08:28:07] [config] after-batches: 0
[2023-07-22 08:28:07] [config] after-epochs: 200
[2023-07-22 08:28:07] [config] all-caps-every: 0
[2023-07-22 08:28:07] [config] allow-unk: false
[2023-07-22 08:28:07] [config] authors: false
[2023-07-22 08:28:07] [config] beam-size: 12
[2023-07-22 08:28:07] [config] bert-class-symbol: "[CLS]"
[2023-07-22 08:28:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 08:28:07] [config] bert-masking-fraction: 0.15
[2023-07-22 08:28:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 08:28:07] [config] bert-train-type-embeddings: true
[2023-07-22 08:28:07] [config] bert-type-vocab-size: 2
[2023-07-22 08:28:07] [config] build-info: ""
[2023-07-22 08:28:07] [config] check-gradient-nan: false
[2023-07-22 08:28:07] [config] check-nan: false
[2023-07-22 08:28:07] [config] cite: false
[2023-07-22 08:28:07] [config] clip-norm: 1
[2023-07-22 08:28:07] [config] cost-scaling:
[2023-07-22 08:28:07] [config]   - 256.f
[2023-07-22 08:28:07] [config]   - 1000
[2023-07-22 08:28:07] [config]   - 2.f
[2023-07-22 08:28:07] [config]   - 256.f
[2023-07-22 08:28:07] [config] cost-type: ce-sum
[2023-07-22 08:28:07] [config] cpu-threads: 0
[2023-07-22 08:28:07] [config] data-threads: 8
[2023-07-22 08:28:07] [config] data-weighting: ""
[2023-07-22 08:28:07] [config] data-weighting-type: sentence
[2023-07-22 08:28:07] [config] dec-cell: gru
[2023-07-22 08:28:07] [config] dec-cell-base-depth: 2
[2023-07-22 08:28:07] [config] dec-cell-high-depth: 1
[2023-07-22 08:28:07] [config] dec-depth: 1
[2023-07-22 08:28:07] [config] devices:
[2023-07-22 08:28:07] [config]   - 0
[2023-07-22 08:28:07] [config] dim-emb: 512
[2023-07-22 08:28:07] [config] dim-rnn: 1024
[2023-07-22 08:28:07] [config] dim-vocabs:
[2023-07-22 08:28:07] [config]   - 16384
[2023-07-22 08:28:07] [config]   - 16384
[2023-07-22 08:28:07] [config] disp-first: 0
[2023-07-22 08:28:07] [config] disp-freq: 1000u
[2023-07-22 08:28:07] [config] disp-label-counts: true
[2023-07-22 08:28:07] [config] dropout-rnn: 0.5
[2023-07-22 08:28:07] [config] dropout-src: 0
[2023-07-22 08:28:07] [config] dropout-trg: 0
[2023-07-22 08:28:07] [config] dump-config: ""
[2023-07-22 08:28:07] [config] dynamic-gradient-scaling:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] early-stopping: 200
[2023-07-22 08:28:07] [config] early-stopping-on: first
[2023-07-22 08:28:07] [config] embedding-fix-src: false
[2023-07-22 08:28:07] [config] embedding-fix-trg: false
[2023-07-22 08:28:07] [config] embedding-normalization: false
[2023-07-22 08:28:07] [config] embedding-vectors:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] enc-cell: gru
[2023-07-22 08:28:07] [config] enc-cell-depth: 1
[2023-07-22 08:28:07] [config] enc-depth: 1
[2023-07-22 08:28:07] [config] enc-type: bidirectional
[2023-07-22 08:28:07] [config] english-title-case-every: 0
[2023-07-22 08:28:07] [config] exponential-smoothing: 0
[2023-07-22 08:28:07] [config] factor-weight: 1
[2023-07-22 08:28:07] [config] factors-combine: sum
[2023-07-22 08:28:07] [config] factors-dim-emb: 0
[2023-07-22 08:28:07] [config] gradient-checkpointing: false
[2023-07-22 08:28:07] [config] gradient-norm-average-window: 100
[2023-07-22 08:28:07] [config] guided-alignment: none
[2023-07-22 08:28:07] [config] guided-alignment-cost: mse
[2023-07-22 08:28:07] [config] guided-alignment-weight: 0.1
[2023-07-22 08:28:07] [config] ignore-model-config: false
[2023-07-22 08:28:07] [config] input-types:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] interpolate-env-vars: false
[2023-07-22 08:28:07] [config] keep-best: false
[2023-07-22 08:28:07] [config] label-smoothing: 0
[2023-07-22 08:28:07] [config] layer-normalization: false
[2023-07-22 08:28:07] [config] learn-rate: 0.0001
[2023-07-22 08:28:07] [config] lemma-dependency: ""
[2023-07-22 08:28:07] [config] lemma-dim-emb: 0
[2023-07-22 08:28:07] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 08:28:07] [config] log-level: info
[2023-07-22 08:28:07] [config] log-time-zone: ""
[2023-07-22 08:28:07] [config] logical-epoch:
[2023-07-22 08:28:07] [config]   - 1e
[2023-07-22 08:28:07] [config]   - 0
[2023-07-22 08:28:07] [config] lr-decay: 0
[2023-07-22 08:28:07] [config] lr-decay-freq: 50000
[2023-07-22 08:28:07] [config] lr-decay-inv-sqrt:
[2023-07-22 08:28:07] [config]   - 0
[2023-07-22 08:28:07] [config] lr-decay-repeat-warmup: false
[2023-07-22 08:28:07] [config] lr-decay-reset-optimizer: false
[2023-07-22 08:28:07] [config] lr-decay-start:
[2023-07-22 08:28:07] [config]   - 10
[2023-07-22 08:28:07] [config]   - 1
[2023-07-22 08:28:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 08:28:07] [config] lr-report: false
[2023-07-22 08:28:07] [config] lr-warmup: 0
[2023-07-22 08:28:07] [config] lr-warmup-at-reload: false
[2023-07-22 08:28:07] [config] lr-warmup-cycle: false
[2023-07-22 08:28:07] [config] lr-warmup-start-rate: 0
[2023-07-22 08:28:07] [config] max-length: 50
[2023-07-22 08:28:07] [config] max-length-crop: true
[2023-07-22 08:28:07] [config] max-length-factor: 3
[2023-07-22 08:28:07] [config] maxi-batch: 100
[2023-07-22 08:28:07] [config] maxi-batch-sort: trg
[2023-07-22 08:28:07] [config] mini-batch: 64
[2023-07-22 08:28:07] [config] mini-batch-fit: true
[2023-07-22 08:28:07] [config] mini-batch-fit-step: 10
[2023-07-22 08:28:07] [config] mini-batch-round-up: true
[2023-07-22 08:28:07] [config] mini-batch-track-lr: false
[2023-07-22 08:28:07] [config] mini-batch-warmup: 0
[2023-07-22 08:28:07] [config] mini-batch-words: 0
[2023-07-22 08:28:07] [config] mini-batch-words-ref: 0
[2023-07-22 08:28:07] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 08:28:07] [config] multi-loss-type: sum
[2023-07-22 08:28:07] [config] n-best: false
[2023-07-22 08:28:07] [config] no-nccl: false
[2023-07-22 08:28:07] [config] no-reload: false
[2023-07-22 08:28:07] [config] no-restore-corpus: false
[2023-07-22 08:28:07] [config] normalize: 0
[2023-07-22 08:28:07] [config] normalize-gradient: false
[2023-07-22 08:28:07] [config] num-devices: 0
[2023-07-22 08:28:07] [config] optimizer: adam
[2023-07-22 08:28:07] [config] optimizer-delay: 1
[2023-07-22 08:28:07] [config] optimizer-params:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] output-omit-bias: false
[2023-07-22 08:28:07] [config] overwrite: true
[2023-07-22 08:28:07] [config] precision:
[2023-07-22 08:28:07] [config]   - float16
[2023-07-22 08:28:07] [config]   - float32
[2023-07-22 08:28:07] [config] pretrained-model: ""
[2023-07-22 08:28:07] [config] quantize-biases: false
[2023-07-22 08:28:07] [config] quantize-bits: 0
[2023-07-22 08:28:07] [config] quantize-log-based: false
[2023-07-22 08:28:07] [config] quantize-optimization-steps: 0
[2023-07-22 08:28:07] [config] quiet: false
[2023-07-22 08:28:07] [config] quiet-translation: true
[2023-07-22 08:28:07] [config] relative-paths: false
[2023-07-22 08:28:07] [config] right-left: false
[2023-07-22 08:28:07] [config] save-freq: 10000u
[2023-07-22 08:28:07] [config] seed: 1234
[2023-07-22 08:28:07] [config] sentencepiece-alphas:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] sentencepiece-max-lines: 2000000
[2023-07-22 08:28:07] [config] sentencepiece-options: ""
[2023-07-22 08:28:07] [config] sharding: global
[2023-07-22 08:28:07] [config] shuffle: data
[2023-07-22 08:28:07] [config] shuffle-in-ram: false
[2023-07-22 08:28:07] [config] sigterm: save-and-exit
[2023-07-22 08:28:07] [config] skip: false
[2023-07-22 08:28:07] [config] sqlite: ""
[2023-07-22 08:28:07] [config] sqlite-drop: false
[2023-07-22 08:28:07] [config] sync-freq: 200u
[2023-07-22 08:28:07] [config] sync-sgd: false
[2023-07-22 08:28:07] [config] tempdir: /tmp
[2023-07-22 08:28:07] [config] tied-embeddings: false
[2023-07-22 08:28:07] [config] tied-embeddings-all: true
[2023-07-22 08:28:07] [config] tied-embeddings-src: false
[2023-07-22 08:28:07] [config] train-embedder-rank:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] train-sets:
[2023-07-22 08:28:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 08:28:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 08:28:07] [config] transformer-aan-activation: swish
[2023-07-22 08:28:07] [config] transformer-aan-depth: 2
[2023-07-22 08:28:07] [config] transformer-aan-nogate: false
[2023-07-22 08:28:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 08:28:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 08:28:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 08:28:07] [config] transformer-depth-scaling: false
[2023-07-22 08:28:07] [config] transformer-dim-aan: 2048
[2023-07-22 08:28:07] [config] transformer-dim-ffn: 2048
[2023-07-22 08:28:07] [config] transformer-dropout: 0
[2023-07-22 08:28:07] [config] transformer-dropout-attention: 0
[2023-07-22 08:28:07] [config] transformer-dropout-ffn: 0
[2023-07-22 08:28:07] [config] transformer-ffn-activation: swish
[2023-07-22 08:28:07] [config] transformer-ffn-depth: 2
[2023-07-22 08:28:07] [config] transformer-guided-alignment-layer: last
[2023-07-22 08:28:07] [config] transformer-heads: 8
[2023-07-22 08:28:07] [config] transformer-no-projection: false
[2023-07-22 08:28:07] [config] transformer-pool: false
[2023-07-22 08:28:07] [config] transformer-postprocess: dan
[2023-07-22 08:28:07] [config] transformer-postprocess-emb: d
[2023-07-22 08:28:07] [config] transformer-postprocess-top: ""
[2023-07-22 08:28:07] [config] transformer-preprocess: ""
[2023-07-22 08:28:07] [config] transformer-tied-layers:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] transformer-train-position-embeddings: false
[2023-07-22 08:28:07] [config] tsv: false
[2023-07-22 08:28:07] [config] tsv-fields: 0
[2023-07-22 08:28:07] [config] type: amun
[2023-07-22 08:28:07] [config] ulr: false
[2023-07-22 08:28:07] [config] ulr-dim-emb: 0
[2023-07-22 08:28:07] [config] ulr-dropout: 0
[2023-07-22 08:28:07] [config] ulr-keys-vectors: ""
[2023-07-22 08:28:07] [config] ulr-query-vectors: ""
[2023-07-22 08:28:07] [config] ulr-softmax-temperature: 1
[2023-07-22 08:28:07] [config] ulr-trainable-transformation: false
[2023-07-22 08:28:07] [config] unlikelihood-loss: false
[2023-07-22 08:28:07] [config] valid-freq: 50000000
[2023-07-22 08:28:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 08:28:07] [config] valid-max-length: 1000
[2023-07-22 08:28:07] [config] valid-metrics:
[2023-07-22 08:28:07] [config]   - cross-entropy
[2023-07-22 08:28:07] [config]   - translation
[2023-07-22 08:28:07] [config] valid-mini-batch: 32
[2023-07-22 08:28:07] [config] valid-reset-stalled: false
[2023-07-22 08:28:07] [config] valid-script-args:
[2023-07-22 08:28:07] [config]   []
[2023-07-22 08:28:07] [config] valid-script-path: ""
[2023-07-22 08:28:07] [config] valid-sets:
[2023-07-22 08:28:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 08:28:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 08:28:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 08:28:07] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:28:07] [config] vocabs:
[2023-07-22 08:28:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:28:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:28:07] [config] word-penalty: 0
[2023-07-22 08:28:07] [config] word-scores: false
[2023-07-22 08:28:07] [config] workspace: 5500
[2023-07-22 08:28:07] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:28:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:28:07] [training] Using single-device training
[2023-07-22 08:28:08] Synced seed 1234
[2023-07-22 08:28:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:28:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 08:28:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:28:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 08:28:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 08:28:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:28:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 08:28:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 08:28:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 08:28:10] [comm] Using global sharding
[2023-07-22 08:28:10] [comm] NCCLCommunicators constructed successfully
[2023-07-22 08:28:10] [training] Using 1 GPUs
[2023-07-22 08:28:10] [logits] Applying loss function for 1 factor(s)
[2023-07-22 08:28:10] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:28:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 08:28:10] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:34:19] [batching] Done. Typical MB size is 31,728 target words
[2023-07-22 08:34:19] [valid] No post-processing script given for validating translator
[2023-07-22 08:34:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:34:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 08:34:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 08:34:19] [comm] Using global sharding
[2023-07-22 08:34:19] [comm] NCCLCommunicators constructed successfully
[2023-07-22 08:34:19] [training] Using 1 GPUs
[2023-07-22 08:34:19] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 08:34:20] Allocating memory for general optimizer shards
[2023-07-22 08:34:20] [memory] Reserving 322 MB, device gpu0
[2023-07-22 08:34:20] Loading Adam parameters
[2023-07-22 08:34:20] [memory] Reserving 322 MB, device gpu0
[2023-07-22 08:34:20] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:34:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 08:34:21] [data] Restoring the corpus state to epoch 191, batch 6080
[2023-07-22 08:34:21] [data] Shuffling data
[2023-07-22 08:34:21] [data] Done reading 20,192 sentences
[2023-07-22 08:34:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:34:21] Training started
[2023-07-22 08:34:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 08:34:21] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:34:24] Parameter type float16, optimization type float32, casting types true
[2023-07-22 08:37:44] Seen 20,192 samples
[2023-07-22 08:37:44] Starting data epoch 192 in logical epoch 192
[2023-07-22 08:37:44] [data] Shuffling data
[2023-07-22 08:37:44] [data] Done reading 20,192 sentences
[2023-07-22 08:37:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:41:28] Seen 20,192 samples
[2023-07-22 08:41:28] Starting data epoch 193 in logical epoch 193
[2023-07-22 08:41:28] [data] Shuffling data
[2023-07-22 08:41:28] [data] Done reading 20,192 sentences
[2023-07-22 08:41:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:45:08] Seen 20,192 samples
[2023-07-22 08:45:08] Starting data epoch 194 in logical epoch 194
[2023-07-22 08:45:08] [data] Shuffling data
[2023-07-22 08:45:08] [data] Done reading 20,192 sentences
[2023-07-22 08:45:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:48:48] Seen 20,192 samples
[2023-07-22 08:48:48] Starting data epoch 195 in logical epoch 195
[2023-07-22 08:48:48] [data] Shuffling data
[2023-07-22 08:48:48] [data] Done reading 20,192 sentences
[2023-07-22 08:48:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:52:23] Seen 20,192 samples
[2023-07-22 08:52:23] Starting data epoch 196 in logical epoch 196
[2023-07-22 08:52:23] [data] Shuffling data
[2023-07-22 08:52:23] [data] Done reading 20,192 sentences
[2023-07-22 08:52:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:56:04] Seen 20,192 samples
[2023-07-22 08:56:04] Starting data epoch 197 in logical epoch 197
[2023-07-22 08:56:04] [data] Shuffling data
[2023-07-22 08:56:04] [data] Done reading 20,192 sentences
[2023-07-22 08:56:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:59:49] Seen 20,192 samples
[2023-07-22 08:59:49] Starting data epoch 198 in logical epoch 198
[2023-07-22 08:59:49] [data] Shuffling data
[2023-07-22 08:59:49] [data] Done reading 20,192 sentences
[2023-07-22 08:59:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:03:39] Seen 20,192 samples
[2023-07-22 09:03:39] Starting data epoch 199 in logical epoch 199
[2023-07-22 09:03:39] [data] Shuffling data
[2023-07-22 09:03:39] [data] Done reading 20,192 sentences
[2023-07-22 09:03:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:07:19] Seen 20,192 samples
[2023-07-22 09:07:19] Starting data epoch 200 in logical epoch 200
[2023-07-22 09:07:19] [data] Shuffling data
[2023-07-22 09:07:19] [data] Done reading 20,192 sentences
[2023-07-22 09:07:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:11:08] Seen 20,192 samples
[2023-07-22 09:11:08] Starting data epoch 201 in logical epoch 201
[2023-07-22 09:11:08] Training finished
[2023-07-22 09:11:24] [valid] Ep. 201 : Up. 6400 : cross-entropy : 130.78 : new best
[2023-07-22 09:13:30] [valid] Ep. 201 : Up. 6400 : translation : 0 : new best
[2023-07-22 09:13:30] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz
[2023-07-22 09:13:32] Saving Adam parameters
[2023-07-22 09:13:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_dropout-rnn_0.5.npz.optimizer.npz
[2023-07-22 09:13:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:40] [marian] Running on node23.datos.cluster.uy as process 26962 with command line:
[2023-07-22 09:13:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:13:40] [config] after: 0e
[2023-07-22 09:13:40] [config] after-batches: 0
[2023-07-22 09:13:40] [config] after-epochs: 10
[2023-07-22 09:13:40] [config] all-caps-every: 0
[2023-07-22 09:13:40] [config] allow-unk: false
[2023-07-22 09:13:40] [config] authors: false
[2023-07-22 09:13:40] [config] beam-size: 12
[2023-07-22 09:13:40] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:13:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:13:40] [config] bert-masking-fraction: 0.15
[2023-07-22 09:13:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:13:40] [config] bert-train-type-embeddings: true
[2023-07-22 09:13:40] [config] bert-type-vocab-size: 2
[2023-07-22 09:13:40] [config] build-info: ""
[2023-07-22 09:13:40] [config] check-gradient-nan: false
[2023-07-22 09:13:40] [config] check-nan: false
[2023-07-22 09:13:40] [config] cite: false
[2023-07-22 09:13:40] [config] clip-norm: 1
[2023-07-22 09:13:40] [config] cost-scaling:
[2023-07-22 09:13:40] [config]   - 256.f
[2023-07-22 09:13:40] [config]   - 1000
[2023-07-22 09:13:40] [config]   - 2.f
[2023-07-22 09:13:40] [config]   - 256.f
[2023-07-22 09:13:40] [config] cost-type: ce-sum
[2023-07-22 09:13:40] [config] cpu-threads: 0
[2023-07-22 09:13:40] [config] data-threads: 8
[2023-07-22 09:13:40] [config] data-weighting: ""
[2023-07-22 09:13:40] [config] data-weighting-type: sentence
[2023-07-22 09:13:40] [config] dec-cell: gru
[2023-07-22 09:13:40] [config] dec-cell-base-depth: 2
[2023-07-22 09:13:40] [config] dec-cell-high-depth: 1
[2023-07-22 09:13:40] [config] dec-depth: 2
[2023-07-22 09:13:40] [config] devices:
[2023-07-22 09:13:40] [config]   - 0
[2023-07-22 09:13:40] [config] dim-emb: 512
[2023-07-22 09:13:40] [config] dim-rnn: 1024
[2023-07-22 09:13:40] [config] dim-vocabs:
[2023-07-22 09:13:40] [config]   - 16384
[2023-07-22 09:13:40] [config]   - 16384
[2023-07-22 09:13:40] [config] disp-first: 0
[2023-07-22 09:13:40] [config] disp-freq: 1000u
[2023-07-22 09:13:40] [config] disp-label-counts: true
[2023-07-22 09:13:40] [config] dropout-rnn: 0
[2023-07-22 09:13:40] [config] dropout-src: 0
[2023-07-22 09:13:40] [config] dropout-trg: 0
[2023-07-22 09:13:40] [config] dump-config: ""
[2023-07-22 09:13:40] [config] dynamic-gradient-scaling:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] early-stopping: 200
[2023-07-22 09:13:40] [config] early-stopping-on: first
[2023-07-22 09:13:40] [config] embedding-fix-src: false
[2023-07-22 09:13:40] [config] embedding-fix-trg: false
[2023-07-22 09:13:40] [config] embedding-normalization: false
[2023-07-22 09:13:40] [config] embedding-vectors:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] enc-cell: gru
[2023-07-22 09:13:40] [config] enc-cell-depth: 1
[2023-07-22 09:13:40] [config] enc-depth: 2
[2023-07-22 09:13:40] [config] enc-type: bidirectional
[2023-07-22 09:13:40] [config] english-title-case-every: 0
[2023-07-22 09:13:40] [config] exponential-smoothing: 0
[2023-07-22 09:13:40] [config] factor-weight: 1
[2023-07-22 09:13:40] [config] factors-combine: sum
[2023-07-22 09:13:40] [config] factors-dim-emb: 0
[2023-07-22 09:13:40] [config] gradient-checkpointing: false
[2023-07-22 09:13:40] [config] gradient-norm-average-window: 100
[2023-07-22 09:13:40] [config] guided-alignment: none
[2023-07-22 09:13:40] [config] guided-alignment-cost: mse
[2023-07-22 09:13:40] [config] guided-alignment-weight: 0.1
[2023-07-22 09:13:40] [config] ignore-model-config: false
[2023-07-22 09:13:40] [config] input-types:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] interpolate-env-vars: false
[2023-07-22 09:13:40] [config] keep-best: false
[2023-07-22 09:13:40] [config] label-smoothing: 0
[2023-07-22 09:13:40] [config] layer-normalization: false
[2023-07-22 09:13:40] [config] learn-rate: 0.0001
[2023-07-22 09:13:40] [config] lemma-dependency: ""
[2023-07-22 09:13:40] [config] lemma-dim-emb: 0
[2023-07-22 09:13:40] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:40] [config] log-level: info
[2023-07-22 09:13:40] [config] log-time-zone: ""
[2023-07-22 09:13:40] [config] logical-epoch:
[2023-07-22 09:13:40] [config]   - 1e
[2023-07-22 09:13:40] [config]   - 0
[2023-07-22 09:13:40] [config] lr-decay: 0
[2023-07-22 09:13:40] [config] lr-decay-freq: 50000
[2023-07-22 09:13:40] [config] lr-decay-inv-sqrt:
[2023-07-22 09:13:40] [config]   - 0
[2023-07-22 09:13:40] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:13:40] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:13:40] [config] lr-decay-start:
[2023-07-22 09:13:40] [config]   - 10
[2023-07-22 09:13:40] [config]   - 1
[2023-07-22 09:13:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:13:40] [config] lr-report: false
[2023-07-22 09:13:40] [config] lr-warmup: 0
[2023-07-22 09:13:40] [config] lr-warmup-at-reload: false
[2023-07-22 09:13:40] [config] lr-warmup-cycle: false
[2023-07-22 09:13:40] [config] lr-warmup-start-rate: 0
[2023-07-22 09:13:40] [config] max-length: 50
[2023-07-22 09:13:40] [config] max-length-crop: true
[2023-07-22 09:13:40] [config] max-length-factor: 3
[2023-07-22 09:13:40] [config] maxi-batch: 100
[2023-07-22 09:13:40] [config] maxi-batch-sort: trg
[2023-07-22 09:13:40] [config] mini-batch: 64
[2023-07-22 09:13:40] [config] mini-batch-fit: true
[2023-07-22 09:13:40] [config] mini-batch-fit-step: 10
[2023-07-22 09:13:40] [config] mini-batch-round-up: true
[2023-07-22 09:13:40] [config] mini-batch-track-lr: false
[2023-07-22 09:13:40] [config] mini-batch-warmup: 0
[2023-07-22 09:13:40] [config] mini-batch-words: 0
[2023-07-22 09:13:40] [config] mini-batch-words-ref: 0
[2023-07-22 09:13:40] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:13:40] [config] multi-loss-type: sum
[2023-07-22 09:13:40] [config] n-best: false
[2023-07-22 09:13:40] [config] no-nccl: false
[2023-07-22 09:13:40] [config] no-reload: false
[2023-07-22 09:13:40] [config] no-restore-corpus: false
[2023-07-22 09:13:40] [config] normalize: 0
[2023-07-22 09:13:40] [config] normalize-gradient: false
[2023-07-22 09:13:40] [config] num-devices: 0
[2023-07-22 09:13:40] [config] optimizer: adam
[2023-07-22 09:13:40] [config] optimizer-delay: 1
[2023-07-22 09:13:40] [config] optimizer-params:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] output-omit-bias: false
[2023-07-22 09:13:40] [config] overwrite: true
[2023-07-22 09:13:40] [config] precision:
[2023-07-22 09:13:40] [config]   - float16
[2023-07-22 09:13:40] [config]   - float32
[2023-07-22 09:13:40] [config] pretrained-model: ""
[2023-07-22 09:13:40] [config] quantize-biases: false
[2023-07-22 09:13:40] [config] quantize-bits: 0
[2023-07-22 09:13:40] [config] quantize-log-based: false
[2023-07-22 09:13:40] [config] quantize-optimization-steps: 0
[2023-07-22 09:13:40] [config] quiet: false
[2023-07-22 09:13:40] [config] quiet-translation: true
[2023-07-22 09:13:40] [config] relative-paths: false
[2023-07-22 09:13:40] [config] right-left: false
[2023-07-22 09:13:40] [config] save-freq: 10000u
[2023-07-22 09:13:40] [config] seed: 1234
[2023-07-22 09:13:40] [config] sentencepiece-alphas:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:13:40] [config] sentencepiece-options: ""
[2023-07-22 09:13:40] [config] sharding: global
[2023-07-22 09:13:40] [config] shuffle: data
[2023-07-22 09:13:40] [config] shuffle-in-ram: false
[2023-07-22 09:13:40] [config] sigterm: save-and-exit
[2023-07-22 09:13:40] [config] skip: false
[2023-07-22 09:13:40] [config] sqlite: ""
[2023-07-22 09:13:40] [config] sqlite-drop: false
[2023-07-22 09:13:40] [config] sync-freq: 200u
[2023-07-22 09:13:40] [config] sync-sgd: false
[2023-07-22 09:13:40] [config] tempdir: /tmp
[2023-07-22 09:13:40] [config] tied-embeddings: false
[2023-07-22 09:13:40] [config] tied-embeddings-all: true
[2023-07-22 09:13:40] [config] tied-embeddings-src: false
[2023-07-22 09:13:40] [config] train-embedder-rank:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] train-sets:
[2023-07-22 09:13:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:13:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:13:40] [config] transformer-aan-activation: swish
[2023-07-22 09:13:40] [config] transformer-aan-depth: 2
[2023-07-22 09:13:40] [config] transformer-aan-nogate: false
[2023-07-22 09:13:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:13:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:13:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:13:40] [config] transformer-depth-scaling: false
[2023-07-22 09:13:40] [config] transformer-dim-aan: 2048
[2023-07-22 09:13:40] [config] transformer-dim-ffn: 2048
[2023-07-22 09:13:40] [config] transformer-dropout: 0
[2023-07-22 09:13:40] [config] transformer-dropout-attention: 0
[2023-07-22 09:13:40] [config] transformer-dropout-ffn: 0
[2023-07-22 09:13:40] [config] transformer-ffn-activation: swish
[2023-07-22 09:13:40] [config] transformer-ffn-depth: 2
[2023-07-22 09:13:40] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:13:40] [config] transformer-heads: 8
[2023-07-22 09:13:40] [config] transformer-no-projection: false
[2023-07-22 09:13:40] [config] transformer-pool: false
[2023-07-22 09:13:40] [config] transformer-postprocess: dan
[2023-07-22 09:13:40] [config] transformer-postprocess-emb: d
[2023-07-22 09:13:40] [config] transformer-postprocess-top: ""
[2023-07-22 09:13:40] [config] transformer-preprocess: ""
[2023-07-22 09:13:40] [config] transformer-tied-layers:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] transformer-train-position-embeddings: false
[2023-07-22 09:13:40] [config] tsv: false
[2023-07-22 09:13:40] [config] tsv-fields: 0
[2023-07-22 09:13:40] [config] type: amun
[2023-07-22 09:13:40] [config] ulr: false
[2023-07-22 09:13:40] [config] ulr-dim-emb: 0
[2023-07-22 09:13:40] [config] ulr-dropout: 0
[2023-07-22 09:13:40] [config] ulr-keys-vectors: ""
[2023-07-22 09:13:40] [config] ulr-query-vectors: ""
[2023-07-22 09:13:40] [config] ulr-softmax-temperature: 1
[2023-07-22 09:13:40] [config] ulr-trainable-transformation: false
[2023-07-22 09:13:40] [config] unlikelihood-loss: false
[2023-07-22 09:13:40] [config] valid-freq: 50000000
[2023-07-22 09:13:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:40] [config] valid-max-length: 1000
[2023-07-22 09:13:40] [config] valid-metrics:
[2023-07-22 09:13:40] [config]   - cross-entropy
[2023-07-22 09:13:40] [config]   - translation
[2023-07-22 09:13:40] [config] valid-mini-batch: 32
[2023-07-22 09:13:40] [config] valid-reset-stalled: false
[2023-07-22 09:13:40] [config] valid-script-args:
[2023-07-22 09:13:40] [config]   []
[2023-07-22 09:13:40] [config] valid-script-path: ""
[2023-07-22 09:13:40] [config] valid-sets:
[2023-07-22 09:13:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:13:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:13:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:13:40] [config] vocabs:
[2023-07-22 09:13:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:40] [config] word-penalty: 0
[2023-07-22 09:13:40] [config] word-scores: false
[2023-07-22 09:13:40] [config] workspace: 5500
[2023-07-22 09:13:40] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:40] [training] Using single-device training
[2023-07-22 09:13:40] Synced seed 1234
[2023-07-22 09:13:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:13:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:13:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:13:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:13:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:13:42] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:13:42] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55b1286ac141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55b1285eeda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55b1285f31a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55b1285fa2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55b1287a6a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55b1287a7a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55b128780bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55b128282108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55b1281a42c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b12815bb9c]    main                                               + 0x3c
[0x7f1869cde0b3]    __libc_start_main                                  + 0xf3
[0x55b1281a2cbe]    _start                                             + 0x2e

[2023-07-22 09:13:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:45] [marian] Running on node23.datos.cluster.uy as process 26991 with command line:
[2023-07-22 09:13:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:13:45] [config] after: 0e
[2023-07-22 09:13:45] [config] after-batches: 0
[2023-07-22 09:13:45] [config] after-epochs: 20
[2023-07-22 09:13:45] [config] all-caps-every: 0
[2023-07-22 09:13:45] [config] allow-unk: false
[2023-07-22 09:13:45] [config] authors: false
[2023-07-22 09:13:45] [config] beam-size: 12
[2023-07-22 09:13:45] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:13:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:13:45] [config] bert-masking-fraction: 0.15
[2023-07-22 09:13:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:13:45] [config] bert-train-type-embeddings: true
[2023-07-22 09:13:45] [config] bert-type-vocab-size: 2
[2023-07-22 09:13:45] [config] build-info: ""
[2023-07-22 09:13:45] [config] check-gradient-nan: false
[2023-07-22 09:13:45] [config] check-nan: false
[2023-07-22 09:13:45] [config] cite: false
[2023-07-22 09:13:45] [config] clip-norm: 1
[2023-07-22 09:13:45] [config] cost-scaling:
[2023-07-22 09:13:45] [config]   - 256.f
[2023-07-22 09:13:45] [config]   - 1000
[2023-07-22 09:13:45] [config]   - 2.f
[2023-07-22 09:13:45] [config]   - 256.f
[2023-07-22 09:13:45] [config] cost-type: ce-sum
[2023-07-22 09:13:45] [config] cpu-threads: 0
[2023-07-22 09:13:45] [config] data-threads: 8
[2023-07-22 09:13:45] [config] data-weighting: ""
[2023-07-22 09:13:45] [config] data-weighting-type: sentence
[2023-07-22 09:13:45] [config] dec-cell: gru
[2023-07-22 09:13:45] [config] dec-cell-base-depth: 2
[2023-07-22 09:13:45] [config] dec-cell-high-depth: 1
[2023-07-22 09:13:45] [config] dec-depth: 2
[2023-07-22 09:13:45] [config] devices:
[2023-07-22 09:13:45] [config]   - 0
[2023-07-22 09:13:45] [config] dim-emb: 512
[2023-07-22 09:13:45] [config] dim-rnn: 1024
[2023-07-22 09:13:45] [config] dim-vocabs:
[2023-07-22 09:13:45] [config]   - 16384
[2023-07-22 09:13:45] [config]   - 16384
[2023-07-22 09:13:45] [config] disp-first: 0
[2023-07-22 09:13:45] [config] disp-freq: 1000u
[2023-07-22 09:13:45] [config] disp-label-counts: true
[2023-07-22 09:13:45] [config] dropout-rnn: 0
[2023-07-22 09:13:45] [config] dropout-src: 0
[2023-07-22 09:13:45] [config] dropout-trg: 0
[2023-07-22 09:13:45] [config] dump-config: ""
[2023-07-22 09:13:45] [config] dynamic-gradient-scaling:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] early-stopping: 200
[2023-07-22 09:13:45] [config] early-stopping-on: first
[2023-07-22 09:13:45] [config] embedding-fix-src: false
[2023-07-22 09:13:45] [config] embedding-fix-trg: false
[2023-07-22 09:13:45] [config] embedding-normalization: false
[2023-07-22 09:13:45] [config] embedding-vectors:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] enc-cell: gru
[2023-07-22 09:13:45] [config] enc-cell-depth: 1
[2023-07-22 09:13:45] [config] enc-depth: 2
[2023-07-22 09:13:45] [config] enc-type: bidirectional
[2023-07-22 09:13:45] [config] english-title-case-every: 0
[2023-07-22 09:13:45] [config] exponential-smoothing: 0
[2023-07-22 09:13:45] [config] factor-weight: 1
[2023-07-22 09:13:45] [config] factors-combine: sum
[2023-07-22 09:13:45] [config] factors-dim-emb: 0
[2023-07-22 09:13:45] [config] gradient-checkpointing: false
[2023-07-22 09:13:45] [config] gradient-norm-average-window: 100
[2023-07-22 09:13:45] [config] guided-alignment: none
[2023-07-22 09:13:45] [config] guided-alignment-cost: mse
[2023-07-22 09:13:45] [config] guided-alignment-weight: 0.1
[2023-07-22 09:13:45] [config] ignore-model-config: false
[2023-07-22 09:13:45] [config] input-types:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] interpolate-env-vars: false
[2023-07-22 09:13:45] [config] keep-best: false
[2023-07-22 09:13:45] [config] label-smoothing: 0
[2023-07-22 09:13:45] [config] layer-normalization: false
[2023-07-22 09:13:45] [config] learn-rate: 0.0001
[2023-07-22 09:13:45] [config] lemma-dependency: ""
[2023-07-22 09:13:45] [config] lemma-dim-emb: 0
[2023-07-22 09:13:45] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:45] [config] log-level: info
[2023-07-22 09:13:45] [config] log-time-zone: ""
[2023-07-22 09:13:45] [config] logical-epoch:
[2023-07-22 09:13:45] [config]   - 1e
[2023-07-22 09:13:45] [config]   - 0
[2023-07-22 09:13:45] [config] lr-decay: 0
[2023-07-22 09:13:45] [config] lr-decay-freq: 50000
[2023-07-22 09:13:45] [config] lr-decay-inv-sqrt:
[2023-07-22 09:13:45] [config]   - 0
[2023-07-22 09:13:45] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:13:45] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:13:45] [config] lr-decay-start:
[2023-07-22 09:13:45] [config]   - 10
[2023-07-22 09:13:45] [config]   - 1
[2023-07-22 09:13:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:13:45] [config] lr-report: false
[2023-07-22 09:13:45] [config] lr-warmup: 0
[2023-07-22 09:13:45] [config] lr-warmup-at-reload: false
[2023-07-22 09:13:45] [config] lr-warmup-cycle: false
[2023-07-22 09:13:45] [config] lr-warmup-start-rate: 0
[2023-07-22 09:13:45] [config] max-length: 50
[2023-07-22 09:13:45] [config] max-length-crop: true
[2023-07-22 09:13:45] [config] max-length-factor: 3
[2023-07-22 09:13:45] [config] maxi-batch: 100
[2023-07-22 09:13:45] [config] maxi-batch-sort: trg
[2023-07-22 09:13:45] [config] mini-batch: 64
[2023-07-22 09:13:45] [config] mini-batch-fit: true
[2023-07-22 09:13:45] [config] mini-batch-fit-step: 10
[2023-07-22 09:13:45] [config] mini-batch-round-up: true
[2023-07-22 09:13:45] [config] mini-batch-track-lr: false
[2023-07-22 09:13:45] [config] mini-batch-warmup: 0
[2023-07-22 09:13:45] [config] mini-batch-words: 0
[2023-07-22 09:13:45] [config] mini-batch-words-ref: 0
[2023-07-22 09:13:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:13:45] [config] multi-loss-type: sum
[2023-07-22 09:13:45] [config] n-best: false
[2023-07-22 09:13:45] [config] no-nccl: false
[2023-07-22 09:13:45] [config] no-reload: false
[2023-07-22 09:13:45] [config] no-restore-corpus: false
[2023-07-22 09:13:45] [config] normalize: 0
[2023-07-22 09:13:45] [config] normalize-gradient: false
[2023-07-22 09:13:45] [config] num-devices: 0
[2023-07-22 09:13:45] [config] optimizer: adam
[2023-07-22 09:13:45] [config] optimizer-delay: 1
[2023-07-22 09:13:45] [config] optimizer-params:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] output-omit-bias: false
[2023-07-22 09:13:45] [config] overwrite: true
[2023-07-22 09:13:45] [config] precision:
[2023-07-22 09:13:45] [config]   - float16
[2023-07-22 09:13:45] [config]   - float32
[2023-07-22 09:13:45] [config] pretrained-model: ""
[2023-07-22 09:13:45] [config] quantize-biases: false
[2023-07-22 09:13:45] [config] quantize-bits: 0
[2023-07-22 09:13:45] [config] quantize-log-based: false
[2023-07-22 09:13:45] [config] quantize-optimization-steps: 0
[2023-07-22 09:13:45] [config] quiet: false
[2023-07-22 09:13:45] [config] quiet-translation: true
[2023-07-22 09:13:45] [config] relative-paths: false
[2023-07-22 09:13:45] [config] right-left: false
[2023-07-22 09:13:45] [config] save-freq: 10000u
[2023-07-22 09:13:45] [config] seed: 1234
[2023-07-22 09:13:45] [config] sentencepiece-alphas:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:13:45] [config] sentencepiece-options: ""
[2023-07-22 09:13:45] [config] sharding: global
[2023-07-22 09:13:45] [config] shuffle: data
[2023-07-22 09:13:45] [config] shuffle-in-ram: false
[2023-07-22 09:13:45] [config] sigterm: save-and-exit
[2023-07-22 09:13:45] [config] skip: false
[2023-07-22 09:13:45] [config] sqlite: ""
[2023-07-22 09:13:45] [config] sqlite-drop: false
[2023-07-22 09:13:45] [config] sync-freq: 200u
[2023-07-22 09:13:45] [config] sync-sgd: false
[2023-07-22 09:13:45] [config] tempdir: /tmp
[2023-07-22 09:13:45] [config] tied-embeddings: false
[2023-07-22 09:13:45] [config] tied-embeddings-all: true
[2023-07-22 09:13:45] [config] tied-embeddings-src: false
[2023-07-22 09:13:45] [config] train-embedder-rank:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] train-sets:
[2023-07-22 09:13:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:13:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:13:45] [config] transformer-aan-activation: swish
[2023-07-22 09:13:45] [config] transformer-aan-depth: 2
[2023-07-22 09:13:45] [config] transformer-aan-nogate: false
[2023-07-22 09:13:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:13:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:13:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:13:45] [config] transformer-depth-scaling: false
[2023-07-22 09:13:45] [config] transformer-dim-aan: 2048
[2023-07-22 09:13:45] [config] transformer-dim-ffn: 2048
[2023-07-22 09:13:45] [config] transformer-dropout: 0
[2023-07-22 09:13:45] [config] transformer-dropout-attention: 0
[2023-07-22 09:13:45] [config] transformer-dropout-ffn: 0
[2023-07-22 09:13:45] [config] transformer-ffn-activation: swish
[2023-07-22 09:13:45] [config] transformer-ffn-depth: 2
[2023-07-22 09:13:45] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:13:45] [config] transformer-heads: 8
[2023-07-22 09:13:45] [config] transformer-no-projection: false
[2023-07-22 09:13:45] [config] transformer-pool: false
[2023-07-22 09:13:45] [config] transformer-postprocess: dan
[2023-07-22 09:13:45] [config] transformer-postprocess-emb: d
[2023-07-22 09:13:45] [config] transformer-postprocess-top: ""
[2023-07-22 09:13:45] [config] transformer-preprocess: ""
[2023-07-22 09:13:45] [config] transformer-tied-layers:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] transformer-train-position-embeddings: false
[2023-07-22 09:13:45] [config] tsv: false
[2023-07-22 09:13:45] [config] tsv-fields: 0
[2023-07-22 09:13:45] [config] type: amun
[2023-07-22 09:13:45] [config] ulr: false
[2023-07-22 09:13:45] [config] ulr-dim-emb: 0
[2023-07-22 09:13:45] [config] ulr-dropout: 0
[2023-07-22 09:13:45] [config] ulr-keys-vectors: ""
[2023-07-22 09:13:45] [config] ulr-query-vectors: ""
[2023-07-22 09:13:45] [config] ulr-softmax-temperature: 1
[2023-07-22 09:13:45] [config] ulr-trainable-transformation: false
[2023-07-22 09:13:45] [config] unlikelihood-loss: false
[2023-07-22 09:13:45] [config] valid-freq: 50000000
[2023-07-22 09:13:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:45] [config] valid-max-length: 1000
[2023-07-22 09:13:45] [config] valid-metrics:
[2023-07-22 09:13:45] [config]   - cross-entropy
[2023-07-22 09:13:45] [config]   - translation
[2023-07-22 09:13:45] [config] valid-mini-batch: 32
[2023-07-22 09:13:45] [config] valid-reset-stalled: false
[2023-07-22 09:13:45] [config] valid-script-args:
[2023-07-22 09:13:45] [config]   []
[2023-07-22 09:13:45] [config] valid-script-path: ""
[2023-07-22 09:13:45] [config] valid-sets:
[2023-07-22 09:13:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:13:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:13:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:13:45] [config] vocabs:
[2023-07-22 09:13:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:45] [config] word-penalty: 0
[2023-07-22 09:13:45] [config] word-scores: false
[2023-07-22 09:13:45] [config] workspace: 5500
[2023-07-22 09:13:45] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:45] [training] Using single-device training
[2023-07-22 09:13:45] Synced seed 1234
[2023-07-22 09:13:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:45] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:13:45] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:45] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:13:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:13:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:45] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:13:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:13:46] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:13:46] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x562078734141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x562078676da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x56207867b1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5620786822ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x56207882ea0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x56207882fa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x562078808bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x56207830a108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x56207822c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5620781e3b9c]    main                                               + 0x3c
[0x7f80608f20b3]    __libc_start_main                                  + 0xf3
[0x56207822acbe]    _start                                             + 0x2e

[2023-07-22 09:13:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:49] [marian] Running on node23.datos.cluster.uy as process 27018 with command line:
[2023-07-22 09:13:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:13:49] [config] after: 0e
[2023-07-22 09:13:49] [config] after-batches: 0
[2023-07-22 09:13:49] [config] after-epochs: 30
[2023-07-22 09:13:49] [config] all-caps-every: 0
[2023-07-22 09:13:49] [config] allow-unk: false
[2023-07-22 09:13:49] [config] authors: false
[2023-07-22 09:13:49] [config] beam-size: 12
[2023-07-22 09:13:49] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:13:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:13:49] [config] bert-masking-fraction: 0.15
[2023-07-22 09:13:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:13:49] [config] bert-train-type-embeddings: true
[2023-07-22 09:13:49] [config] bert-type-vocab-size: 2
[2023-07-22 09:13:49] [config] build-info: ""
[2023-07-22 09:13:49] [config] check-gradient-nan: false
[2023-07-22 09:13:49] [config] check-nan: false
[2023-07-22 09:13:49] [config] cite: false
[2023-07-22 09:13:49] [config] clip-norm: 1
[2023-07-22 09:13:49] [config] cost-scaling:
[2023-07-22 09:13:49] [config]   - 256.f
[2023-07-22 09:13:49] [config]   - 1000
[2023-07-22 09:13:49] [config]   - 2.f
[2023-07-22 09:13:49] [config]   - 256.f
[2023-07-22 09:13:49] [config] cost-type: ce-sum
[2023-07-22 09:13:49] [config] cpu-threads: 0
[2023-07-22 09:13:49] [config] data-threads: 8
[2023-07-22 09:13:49] [config] data-weighting: ""
[2023-07-22 09:13:49] [config] data-weighting-type: sentence
[2023-07-22 09:13:49] [config] dec-cell: gru
[2023-07-22 09:13:49] [config] dec-cell-base-depth: 2
[2023-07-22 09:13:49] [config] dec-cell-high-depth: 1
[2023-07-22 09:13:49] [config] dec-depth: 2
[2023-07-22 09:13:49] [config] devices:
[2023-07-22 09:13:49] [config]   - 0
[2023-07-22 09:13:49] [config] dim-emb: 512
[2023-07-22 09:13:49] [config] dim-rnn: 1024
[2023-07-22 09:13:49] [config] dim-vocabs:
[2023-07-22 09:13:49] [config]   - 16384
[2023-07-22 09:13:49] [config]   - 16384
[2023-07-22 09:13:49] [config] disp-first: 0
[2023-07-22 09:13:49] [config] disp-freq: 1000u
[2023-07-22 09:13:49] [config] disp-label-counts: true
[2023-07-22 09:13:49] [config] dropout-rnn: 0
[2023-07-22 09:13:49] [config] dropout-src: 0
[2023-07-22 09:13:49] [config] dropout-trg: 0
[2023-07-22 09:13:49] [config] dump-config: ""
[2023-07-22 09:13:49] [config] dynamic-gradient-scaling:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] early-stopping: 200
[2023-07-22 09:13:49] [config] early-stopping-on: first
[2023-07-22 09:13:49] [config] embedding-fix-src: false
[2023-07-22 09:13:49] [config] embedding-fix-trg: false
[2023-07-22 09:13:49] [config] embedding-normalization: false
[2023-07-22 09:13:49] [config] embedding-vectors:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] enc-cell: gru
[2023-07-22 09:13:49] [config] enc-cell-depth: 1
[2023-07-22 09:13:49] [config] enc-depth: 2
[2023-07-22 09:13:49] [config] enc-type: bidirectional
[2023-07-22 09:13:49] [config] english-title-case-every: 0
[2023-07-22 09:13:49] [config] exponential-smoothing: 0
[2023-07-22 09:13:49] [config] factor-weight: 1
[2023-07-22 09:13:49] [config] factors-combine: sum
[2023-07-22 09:13:49] [config] factors-dim-emb: 0
[2023-07-22 09:13:49] [config] gradient-checkpointing: false
[2023-07-22 09:13:49] [config] gradient-norm-average-window: 100
[2023-07-22 09:13:49] [config] guided-alignment: none
[2023-07-22 09:13:49] [config] guided-alignment-cost: mse
[2023-07-22 09:13:49] [config] guided-alignment-weight: 0.1
[2023-07-22 09:13:49] [config] ignore-model-config: false
[2023-07-22 09:13:49] [config] input-types:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] interpolate-env-vars: false
[2023-07-22 09:13:49] [config] keep-best: false
[2023-07-22 09:13:49] [config] label-smoothing: 0
[2023-07-22 09:13:49] [config] layer-normalization: false
[2023-07-22 09:13:49] [config] learn-rate: 0.0001
[2023-07-22 09:13:49] [config] lemma-dependency: ""
[2023-07-22 09:13:49] [config] lemma-dim-emb: 0
[2023-07-22 09:13:49] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:49] [config] log-level: info
[2023-07-22 09:13:49] [config] log-time-zone: ""
[2023-07-22 09:13:49] [config] logical-epoch:
[2023-07-22 09:13:49] [config]   - 1e
[2023-07-22 09:13:49] [config]   - 0
[2023-07-22 09:13:49] [config] lr-decay: 0
[2023-07-22 09:13:49] [config] lr-decay-freq: 50000
[2023-07-22 09:13:49] [config] lr-decay-inv-sqrt:
[2023-07-22 09:13:49] [config]   - 0
[2023-07-22 09:13:49] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:13:49] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:13:49] [config] lr-decay-start:
[2023-07-22 09:13:49] [config]   - 10
[2023-07-22 09:13:49] [config]   - 1
[2023-07-22 09:13:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:13:49] [config] lr-report: false
[2023-07-22 09:13:49] [config] lr-warmup: 0
[2023-07-22 09:13:49] [config] lr-warmup-at-reload: false
[2023-07-22 09:13:49] [config] lr-warmup-cycle: false
[2023-07-22 09:13:49] [config] lr-warmup-start-rate: 0
[2023-07-22 09:13:49] [config] max-length: 50
[2023-07-22 09:13:49] [config] max-length-crop: true
[2023-07-22 09:13:49] [config] max-length-factor: 3
[2023-07-22 09:13:49] [config] maxi-batch: 100
[2023-07-22 09:13:49] [config] maxi-batch-sort: trg
[2023-07-22 09:13:49] [config] mini-batch: 64
[2023-07-22 09:13:49] [config] mini-batch-fit: true
[2023-07-22 09:13:49] [config] mini-batch-fit-step: 10
[2023-07-22 09:13:49] [config] mini-batch-round-up: true
[2023-07-22 09:13:49] [config] mini-batch-track-lr: false
[2023-07-22 09:13:49] [config] mini-batch-warmup: 0
[2023-07-22 09:13:49] [config] mini-batch-words: 0
[2023-07-22 09:13:49] [config] mini-batch-words-ref: 0
[2023-07-22 09:13:49] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:13:49] [config] multi-loss-type: sum
[2023-07-22 09:13:49] [config] n-best: false
[2023-07-22 09:13:49] [config] no-nccl: false
[2023-07-22 09:13:49] [config] no-reload: false
[2023-07-22 09:13:49] [config] no-restore-corpus: false
[2023-07-22 09:13:49] [config] normalize: 0
[2023-07-22 09:13:49] [config] normalize-gradient: false
[2023-07-22 09:13:49] [config] num-devices: 0
[2023-07-22 09:13:49] [config] optimizer: adam
[2023-07-22 09:13:49] [config] optimizer-delay: 1
[2023-07-22 09:13:49] [config] optimizer-params:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] output-omit-bias: false
[2023-07-22 09:13:49] [config] overwrite: true
[2023-07-22 09:13:49] [config] precision:
[2023-07-22 09:13:49] [config]   - float16
[2023-07-22 09:13:49] [config]   - float32
[2023-07-22 09:13:49] [config] pretrained-model: ""
[2023-07-22 09:13:49] [config] quantize-biases: false
[2023-07-22 09:13:49] [config] quantize-bits: 0
[2023-07-22 09:13:49] [config] quantize-log-based: false
[2023-07-22 09:13:49] [config] quantize-optimization-steps: 0
[2023-07-22 09:13:49] [config] quiet: false
[2023-07-22 09:13:49] [config] quiet-translation: true
[2023-07-22 09:13:49] [config] relative-paths: false
[2023-07-22 09:13:49] [config] right-left: false
[2023-07-22 09:13:49] [config] save-freq: 10000u
[2023-07-22 09:13:49] [config] seed: 1234
[2023-07-22 09:13:49] [config] sentencepiece-alphas:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:13:49] [config] sentencepiece-options: ""
[2023-07-22 09:13:49] [config] sharding: global
[2023-07-22 09:13:49] [config] shuffle: data
[2023-07-22 09:13:49] [config] shuffle-in-ram: false
[2023-07-22 09:13:49] [config] sigterm: save-and-exit
[2023-07-22 09:13:49] [config] skip: false
[2023-07-22 09:13:49] [config] sqlite: ""
[2023-07-22 09:13:49] [config] sqlite-drop: false
[2023-07-22 09:13:49] [config] sync-freq: 200u
[2023-07-22 09:13:49] [config] sync-sgd: false
[2023-07-22 09:13:49] [config] tempdir: /tmp
[2023-07-22 09:13:49] [config] tied-embeddings: false
[2023-07-22 09:13:49] [config] tied-embeddings-all: true
[2023-07-22 09:13:49] [config] tied-embeddings-src: false
[2023-07-22 09:13:49] [config] train-embedder-rank:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] train-sets:
[2023-07-22 09:13:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:13:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:13:49] [config] transformer-aan-activation: swish
[2023-07-22 09:13:49] [config] transformer-aan-depth: 2
[2023-07-22 09:13:49] [config] transformer-aan-nogate: false
[2023-07-22 09:13:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:13:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:13:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:13:49] [config] transformer-depth-scaling: false
[2023-07-22 09:13:49] [config] transformer-dim-aan: 2048
[2023-07-22 09:13:49] [config] transformer-dim-ffn: 2048
[2023-07-22 09:13:49] [config] transformer-dropout: 0
[2023-07-22 09:13:49] [config] transformer-dropout-attention: 0
[2023-07-22 09:13:49] [config] transformer-dropout-ffn: 0
[2023-07-22 09:13:49] [config] transformer-ffn-activation: swish
[2023-07-22 09:13:49] [config] transformer-ffn-depth: 2
[2023-07-22 09:13:49] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:13:49] [config] transformer-heads: 8
[2023-07-22 09:13:49] [config] transformer-no-projection: false
[2023-07-22 09:13:49] [config] transformer-pool: false
[2023-07-22 09:13:49] [config] transformer-postprocess: dan
[2023-07-22 09:13:49] [config] transformer-postprocess-emb: d
[2023-07-22 09:13:49] [config] transformer-postprocess-top: ""
[2023-07-22 09:13:49] [config] transformer-preprocess: ""
[2023-07-22 09:13:49] [config] transformer-tied-layers:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] transformer-train-position-embeddings: false
[2023-07-22 09:13:49] [config] tsv: false
[2023-07-22 09:13:49] [config] tsv-fields: 0
[2023-07-22 09:13:49] [config] type: amun
[2023-07-22 09:13:49] [config] ulr: false
[2023-07-22 09:13:49] [config] ulr-dim-emb: 0
[2023-07-22 09:13:49] [config] ulr-dropout: 0
[2023-07-22 09:13:49] [config] ulr-keys-vectors: ""
[2023-07-22 09:13:49] [config] ulr-query-vectors: ""
[2023-07-22 09:13:49] [config] ulr-softmax-temperature: 1
[2023-07-22 09:13:49] [config] ulr-trainable-transformation: false
[2023-07-22 09:13:49] [config] unlikelihood-loss: false
[2023-07-22 09:13:49] [config] valid-freq: 50000000
[2023-07-22 09:13:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:49] [config] valid-max-length: 1000
[2023-07-22 09:13:49] [config] valid-metrics:
[2023-07-22 09:13:49] [config]   - cross-entropy
[2023-07-22 09:13:49] [config]   - translation
[2023-07-22 09:13:49] [config] valid-mini-batch: 32
[2023-07-22 09:13:49] [config] valid-reset-stalled: false
[2023-07-22 09:13:49] [config] valid-script-args:
[2023-07-22 09:13:49] [config]   []
[2023-07-22 09:13:49] [config] valid-script-path: ""
[2023-07-22 09:13:49] [config] valid-sets:
[2023-07-22 09:13:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:13:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:13:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:13:49] [config] vocabs:
[2023-07-22 09:13:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:49] [config] word-penalty: 0
[2023-07-22 09:13:49] [config] word-scores: false
[2023-07-22 09:13:49] [config] workspace: 5500
[2023-07-22 09:13:49] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:49] [training] Using single-device training
[2023-07-22 09:13:50] Synced seed 1234
[2023-07-22 09:13:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:50] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:13:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:50] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:13:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:13:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:50] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:13:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:13:51] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:13:51] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55e18290c141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55e18284eda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55e1828531a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55e18285a2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55e182a06a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55e182a07a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55e1829e0bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55e1824e2108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55e1824042c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55e1823bbb9c]    main                                               + 0x3c
[0x7f7e3a6980b3]    __libc_start_main                                  + 0xf3
[0x55e182402cbe]    _start                                             + 0x2e

[2023-07-22 09:13:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:55] [marian] Running on node23.datos.cluster.uy as process 27045 with command line:
[2023-07-22 09:13:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:13:55] [config] after: 0e
[2023-07-22 09:13:55] [config] after-batches: 0
[2023-07-22 09:13:55] [config] after-epochs: 40
[2023-07-22 09:13:55] [config] all-caps-every: 0
[2023-07-22 09:13:55] [config] allow-unk: false
[2023-07-22 09:13:55] [config] authors: false
[2023-07-22 09:13:55] [config] beam-size: 12
[2023-07-22 09:13:55] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:13:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:13:55] [config] bert-masking-fraction: 0.15
[2023-07-22 09:13:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:13:55] [config] bert-train-type-embeddings: true
[2023-07-22 09:13:55] [config] bert-type-vocab-size: 2
[2023-07-22 09:13:55] [config] build-info: ""
[2023-07-22 09:13:55] [config] check-gradient-nan: false
[2023-07-22 09:13:55] [config] check-nan: false
[2023-07-22 09:13:55] [config] cite: false
[2023-07-22 09:13:55] [config] clip-norm: 1
[2023-07-22 09:13:55] [config] cost-scaling:
[2023-07-22 09:13:55] [config]   - 256.f
[2023-07-22 09:13:55] [config]   - 1000
[2023-07-22 09:13:55] [config]   - 2.f
[2023-07-22 09:13:55] [config]   - 256.f
[2023-07-22 09:13:55] [config] cost-type: ce-sum
[2023-07-22 09:13:55] [config] cpu-threads: 0
[2023-07-22 09:13:55] [config] data-threads: 8
[2023-07-22 09:13:55] [config] data-weighting: ""
[2023-07-22 09:13:55] [config] data-weighting-type: sentence
[2023-07-22 09:13:55] [config] dec-cell: gru
[2023-07-22 09:13:55] [config] dec-cell-base-depth: 2
[2023-07-22 09:13:55] [config] dec-cell-high-depth: 1
[2023-07-22 09:13:55] [config] dec-depth: 2
[2023-07-22 09:13:55] [config] devices:
[2023-07-22 09:13:55] [config]   - 0
[2023-07-22 09:13:55] [config] dim-emb: 512
[2023-07-22 09:13:55] [config] dim-rnn: 1024
[2023-07-22 09:13:55] [config] dim-vocabs:
[2023-07-22 09:13:55] [config]   - 16384
[2023-07-22 09:13:55] [config]   - 16384
[2023-07-22 09:13:55] [config] disp-first: 0
[2023-07-22 09:13:55] [config] disp-freq: 1000u
[2023-07-22 09:13:55] [config] disp-label-counts: true
[2023-07-22 09:13:55] [config] dropout-rnn: 0
[2023-07-22 09:13:55] [config] dropout-src: 0
[2023-07-22 09:13:55] [config] dropout-trg: 0
[2023-07-22 09:13:55] [config] dump-config: ""
[2023-07-22 09:13:55] [config] dynamic-gradient-scaling:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] early-stopping: 200
[2023-07-22 09:13:55] [config] early-stopping-on: first
[2023-07-22 09:13:55] [config] embedding-fix-src: false
[2023-07-22 09:13:55] [config] embedding-fix-trg: false
[2023-07-22 09:13:55] [config] embedding-normalization: false
[2023-07-22 09:13:55] [config] embedding-vectors:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] enc-cell: gru
[2023-07-22 09:13:55] [config] enc-cell-depth: 1
[2023-07-22 09:13:55] [config] enc-depth: 2
[2023-07-22 09:13:55] [config] enc-type: bidirectional
[2023-07-22 09:13:55] [config] english-title-case-every: 0
[2023-07-22 09:13:55] [config] exponential-smoothing: 0
[2023-07-22 09:13:55] [config] factor-weight: 1
[2023-07-22 09:13:55] [config] factors-combine: sum
[2023-07-22 09:13:55] [config] factors-dim-emb: 0
[2023-07-22 09:13:55] [config] gradient-checkpointing: false
[2023-07-22 09:13:55] [config] gradient-norm-average-window: 100
[2023-07-22 09:13:55] [config] guided-alignment: none
[2023-07-22 09:13:55] [config] guided-alignment-cost: mse
[2023-07-22 09:13:55] [config] guided-alignment-weight: 0.1
[2023-07-22 09:13:55] [config] ignore-model-config: false
[2023-07-22 09:13:55] [config] input-types:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] interpolate-env-vars: false
[2023-07-22 09:13:55] [config] keep-best: false
[2023-07-22 09:13:55] [config] label-smoothing: 0
[2023-07-22 09:13:55] [config] layer-normalization: false
[2023-07-22 09:13:55] [config] learn-rate: 0.0001
[2023-07-22 09:13:55] [config] lemma-dependency: ""
[2023-07-22 09:13:55] [config] lemma-dim-emb: 0
[2023-07-22 09:13:55] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:55] [config] log-level: info
[2023-07-22 09:13:55] [config] log-time-zone: ""
[2023-07-22 09:13:55] [config] logical-epoch:
[2023-07-22 09:13:55] [config]   - 1e
[2023-07-22 09:13:55] [config]   - 0
[2023-07-22 09:13:55] [config] lr-decay: 0
[2023-07-22 09:13:55] [config] lr-decay-freq: 50000
[2023-07-22 09:13:55] [config] lr-decay-inv-sqrt:
[2023-07-22 09:13:55] [config]   - 0
[2023-07-22 09:13:55] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:13:55] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:13:55] [config] lr-decay-start:
[2023-07-22 09:13:55] [config]   - 10
[2023-07-22 09:13:55] [config]   - 1
[2023-07-22 09:13:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:13:55] [config] lr-report: false
[2023-07-22 09:13:55] [config] lr-warmup: 0
[2023-07-22 09:13:55] [config] lr-warmup-at-reload: false
[2023-07-22 09:13:55] [config] lr-warmup-cycle: false
[2023-07-22 09:13:55] [config] lr-warmup-start-rate: 0
[2023-07-22 09:13:55] [config] max-length: 50
[2023-07-22 09:13:55] [config] max-length-crop: true
[2023-07-22 09:13:55] [config] max-length-factor: 3
[2023-07-22 09:13:55] [config] maxi-batch: 100
[2023-07-22 09:13:55] [config] maxi-batch-sort: trg
[2023-07-22 09:13:55] [config] mini-batch: 64
[2023-07-22 09:13:55] [config] mini-batch-fit: true
[2023-07-22 09:13:55] [config] mini-batch-fit-step: 10
[2023-07-22 09:13:55] [config] mini-batch-round-up: true
[2023-07-22 09:13:55] [config] mini-batch-track-lr: false
[2023-07-22 09:13:55] [config] mini-batch-warmup: 0
[2023-07-22 09:13:55] [config] mini-batch-words: 0
[2023-07-22 09:13:55] [config] mini-batch-words-ref: 0
[2023-07-22 09:13:55] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:13:55] [config] multi-loss-type: sum
[2023-07-22 09:13:55] [config] n-best: false
[2023-07-22 09:13:55] [config] no-nccl: false
[2023-07-22 09:13:55] [config] no-reload: false
[2023-07-22 09:13:55] [config] no-restore-corpus: false
[2023-07-22 09:13:55] [config] normalize: 0
[2023-07-22 09:13:55] [config] normalize-gradient: false
[2023-07-22 09:13:55] [config] num-devices: 0
[2023-07-22 09:13:55] [config] optimizer: adam
[2023-07-22 09:13:55] [config] optimizer-delay: 1
[2023-07-22 09:13:55] [config] optimizer-params:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] output-omit-bias: false
[2023-07-22 09:13:55] [config] overwrite: true
[2023-07-22 09:13:55] [config] precision:
[2023-07-22 09:13:55] [config]   - float16
[2023-07-22 09:13:55] [config]   - float32
[2023-07-22 09:13:55] [config] pretrained-model: ""
[2023-07-22 09:13:55] [config] quantize-biases: false
[2023-07-22 09:13:55] [config] quantize-bits: 0
[2023-07-22 09:13:55] [config] quantize-log-based: false
[2023-07-22 09:13:55] [config] quantize-optimization-steps: 0
[2023-07-22 09:13:55] [config] quiet: false
[2023-07-22 09:13:55] [config] quiet-translation: true
[2023-07-22 09:13:55] [config] relative-paths: false
[2023-07-22 09:13:55] [config] right-left: false
[2023-07-22 09:13:55] [config] save-freq: 10000u
[2023-07-22 09:13:55] [config] seed: 1234
[2023-07-22 09:13:55] [config] sentencepiece-alphas:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:13:55] [config] sentencepiece-options: ""
[2023-07-22 09:13:55] [config] sharding: global
[2023-07-22 09:13:55] [config] shuffle: data
[2023-07-22 09:13:55] [config] shuffle-in-ram: false
[2023-07-22 09:13:55] [config] sigterm: save-and-exit
[2023-07-22 09:13:55] [config] skip: false
[2023-07-22 09:13:55] [config] sqlite: ""
[2023-07-22 09:13:55] [config] sqlite-drop: false
[2023-07-22 09:13:55] [config] sync-freq: 200u
[2023-07-22 09:13:55] [config] sync-sgd: false
[2023-07-22 09:13:55] [config] tempdir: /tmp
[2023-07-22 09:13:55] [config] tied-embeddings: false
[2023-07-22 09:13:55] [config] tied-embeddings-all: true
[2023-07-22 09:13:55] [config] tied-embeddings-src: false
[2023-07-22 09:13:55] [config] train-embedder-rank:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] train-sets:
[2023-07-22 09:13:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:13:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:13:55] [config] transformer-aan-activation: swish
[2023-07-22 09:13:55] [config] transformer-aan-depth: 2
[2023-07-22 09:13:55] [config] transformer-aan-nogate: false
[2023-07-22 09:13:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:13:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:13:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:13:55] [config] transformer-depth-scaling: false
[2023-07-22 09:13:55] [config] transformer-dim-aan: 2048
[2023-07-22 09:13:55] [config] transformer-dim-ffn: 2048
[2023-07-22 09:13:55] [config] transformer-dropout: 0
[2023-07-22 09:13:55] [config] transformer-dropout-attention: 0
[2023-07-22 09:13:55] [config] transformer-dropout-ffn: 0
[2023-07-22 09:13:55] [config] transformer-ffn-activation: swish
[2023-07-22 09:13:55] [config] transformer-ffn-depth: 2
[2023-07-22 09:13:55] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:13:55] [config] transformer-heads: 8
[2023-07-22 09:13:55] [config] transformer-no-projection: false
[2023-07-22 09:13:55] [config] transformer-pool: false
[2023-07-22 09:13:55] [config] transformer-postprocess: dan
[2023-07-22 09:13:55] [config] transformer-postprocess-emb: d
[2023-07-22 09:13:55] [config] transformer-postprocess-top: ""
[2023-07-22 09:13:55] [config] transformer-preprocess: ""
[2023-07-22 09:13:55] [config] transformer-tied-layers:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] transformer-train-position-embeddings: false
[2023-07-22 09:13:55] [config] tsv: false
[2023-07-22 09:13:55] [config] tsv-fields: 0
[2023-07-22 09:13:55] [config] type: amun
[2023-07-22 09:13:55] [config] ulr: false
[2023-07-22 09:13:55] [config] ulr-dim-emb: 0
[2023-07-22 09:13:55] [config] ulr-dropout: 0
[2023-07-22 09:13:55] [config] ulr-keys-vectors: ""
[2023-07-22 09:13:55] [config] ulr-query-vectors: ""
[2023-07-22 09:13:55] [config] ulr-softmax-temperature: 1
[2023-07-22 09:13:55] [config] ulr-trainable-transformation: false
[2023-07-22 09:13:55] [config] unlikelihood-loss: false
[2023-07-22 09:13:55] [config] valid-freq: 50000000
[2023-07-22 09:13:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:13:55] [config] valid-max-length: 1000
[2023-07-22 09:13:55] [config] valid-metrics:
[2023-07-22 09:13:55] [config]   - cross-entropy
[2023-07-22 09:13:55] [config]   - translation
[2023-07-22 09:13:55] [config] valid-mini-batch: 32
[2023-07-22 09:13:55] [config] valid-reset-stalled: false
[2023-07-22 09:13:55] [config] valid-script-args:
[2023-07-22 09:13:55] [config]   []
[2023-07-22 09:13:55] [config] valid-script-path: ""
[2023-07-22 09:13:55] [config] valid-sets:
[2023-07-22 09:13:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:13:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:13:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:13:55] [config] vocabs:
[2023-07-22 09:13:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:55] [config] word-penalty: 0
[2023-07-22 09:13:55] [config] word-scores: false
[2023-07-22 09:13:55] [config] workspace: 5500
[2023-07-22 09:13:55] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:13:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:55] [training] Using single-device training
[2023-07-22 09:13:55] Synced seed 1234
[2023-07-22 09:13:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:13:55] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:13:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:13:55] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:13:55] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:13:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:13:55] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:13:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:13:56] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:13:56] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x563c80993141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x563c808d5da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x563c808da1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x563c808e12ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x563c80a8da0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x563c80a8ea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x563c80a67bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x563c80569108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x563c8048b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563c80442b9c]    main                                               + 0x3c
[0x7f99f1ef60b3]    __libc_start_main                                  + 0xf3
[0x563c80489cbe]    _start                                             + 0x2e

[2023-07-22 09:14:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:00] [marian] Running on node23.datos.cluster.uy as process 27072 with command line:
[2023-07-22 09:14:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:00] [config] after: 0e
[2023-07-22 09:14:00] [config] after-batches: 0
[2023-07-22 09:14:00] [config] after-epochs: 50
[2023-07-22 09:14:00] [config] all-caps-every: 0
[2023-07-22 09:14:00] [config] allow-unk: false
[2023-07-22 09:14:00] [config] authors: false
[2023-07-22 09:14:00] [config] beam-size: 12
[2023-07-22 09:14:00] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:00] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:00] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:00] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:00] [config] build-info: ""
[2023-07-22 09:14:00] [config] check-gradient-nan: false
[2023-07-22 09:14:00] [config] check-nan: false
[2023-07-22 09:14:00] [config] cite: false
[2023-07-22 09:14:00] [config] clip-norm: 1
[2023-07-22 09:14:00] [config] cost-scaling:
[2023-07-22 09:14:00] [config]   - 256.f
[2023-07-22 09:14:00] [config]   - 1000
[2023-07-22 09:14:00] [config]   - 2.f
[2023-07-22 09:14:00] [config]   - 256.f
[2023-07-22 09:14:00] [config] cost-type: ce-sum
[2023-07-22 09:14:00] [config] cpu-threads: 0
[2023-07-22 09:14:00] [config] data-threads: 8
[2023-07-22 09:14:00] [config] data-weighting: ""
[2023-07-22 09:14:00] [config] data-weighting-type: sentence
[2023-07-22 09:14:00] [config] dec-cell: gru
[2023-07-22 09:14:00] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:00] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:00] [config] dec-depth: 2
[2023-07-22 09:14:00] [config] devices:
[2023-07-22 09:14:00] [config]   - 0
[2023-07-22 09:14:00] [config] dim-emb: 512
[2023-07-22 09:14:00] [config] dim-rnn: 1024
[2023-07-22 09:14:00] [config] dim-vocabs:
[2023-07-22 09:14:00] [config]   - 16384
[2023-07-22 09:14:00] [config]   - 16384
[2023-07-22 09:14:00] [config] disp-first: 0
[2023-07-22 09:14:00] [config] disp-freq: 1000u
[2023-07-22 09:14:00] [config] disp-label-counts: true
[2023-07-22 09:14:00] [config] dropout-rnn: 0
[2023-07-22 09:14:00] [config] dropout-src: 0
[2023-07-22 09:14:00] [config] dropout-trg: 0
[2023-07-22 09:14:00] [config] dump-config: ""
[2023-07-22 09:14:00] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] early-stopping: 200
[2023-07-22 09:14:00] [config] early-stopping-on: first
[2023-07-22 09:14:00] [config] embedding-fix-src: false
[2023-07-22 09:14:00] [config] embedding-fix-trg: false
[2023-07-22 09:14:00] [config] embedding-normalization: false
[2023-07-22 09:14:00] [config] embedding-vectors:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] enc-cell: gru
[2023-07-22 09:14:00] [config] enc-cell-depth: 1
[2023-07-22 09:14:00] [config] enc-depth: 2
[2023-07-22 09:14:00] [config] enc-type: bidirectional
[2023-07-22 09:14:00] [config] english-title-case-every: 0
[2023-07-22 09:14:00] [config] exponential-smoothing: 0
[2023-07-22 09:14:00] [config] factor-weight: 1
[2023-07-22 09:14:00] [config] factors-combine: sum
[2023-07-22 09:14:00] [config] factors-dim-emb: 0
[2023-07-22 09:14:00] [config] gradient-checkpointing: false
[2023-07-22 09:14:00] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:00] [config] guided-alignment: none
[2023-07-22 09:14:00] [config] guided-alignment-cost: mse
[2023-07-22 09:14:00] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:00] [config] ignore-model-config: false
[2023-07-22 09:14:00] [config] input-types:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] interpolate-env-vars: false
[2023-07-22 09:14:00] [config] keep-best: false
[2023-07-22 09:14:00] [config] label-smoothing: 0
[2023-07-22 09:14:00] [config] layer-normalization: false
[2023-07-22 09:14:00] [config] learn-rate: 0.0001
[2023-07-22 09:14:00] [config] lemma-dependency: ""
[2023-07-22 09:14:00] [config] lemma-dim-emb: 0
[2023-07-22 09:14:00] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:00] [config] log-level: info
[2023-07-22 09:14:00] [config] log-time-zone: ""
[2023-07-22 09:14:00] [config] logical-epoch:
[2023-07-22 09:14:00] [config]   - 1e
[2023-07-22 09:14:00] [config]   - 0
[2023-07-22 09:14:00] [config] lr-decay: 0
[2023-07-22 09:14:00] [config] lr-decay-freq: 50000
[2023-07-22 09:14:00] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:00] [config]   - 0
[2023-07-22 09:14:00] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:00] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:00] [config] lr-decay-start:
[2023-07-22 09:14:00] [config]   - 10
[2023-07-22 09:14:00] [config]   - 1
[2023-07-22 09:14:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:00] [config] lr-report: false
[2023-07-22 09:14:00] [config] lr-warmup: 0
[2023-07-22 09:14:00] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:00] [config] lr-warmup-cycle: false
[2023-07-22 09:14:00] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:00] [config] max-length: 50
[2023-07-22 09:14:00] [config] max-length-crop: true
[2023-07-22 09:14:00] [config] max-length-factor: 3
[2023-07-22 09:14:00] [config] maxi-batch: 100
[2023-07-22 09:14:00] [config] maxi-batch-sort: trg
[2023-07-22 09:14:00] [config] mini-batch: 64
[2023-07-22 09:14:00] [config] mini-batch-fit: true
[2023-07-22 09:14:00] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:00] [config] mini-batch-round-up: true
[2023-07-22 09:14:00] [config] mini-batch-track-lr: false
[2023-07-22 09:14:00] [config] mini-batch-warmup: 0
[2023-07-22 09:14:00] [config] mini-batch-words: 0
[2023-07-22 09:14:00] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:00] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:00] [config] multi-loss-type: sum
[2023-07-22 09:14:00] [config] n-best: false
[2023-07-22 09:14:00] [config] no-nccl: false
[2023-07-22 09:14:00] [config] no-reload: false
[2023-07-22 09:14:00] [config] no-restore-corpus: false
[2023-07-22 09:14:00] [config] normalize: 0
[2023-07-22 09:14:00] [config] normalize-gradient: false
[2023-07-22 09:14:00] [config] num-devices: 0
[2023-07-22 09:14:00] [config] optimizer: adam
[2023-07-22 09:14:00] [config] optimizer-delay: 1
[2023-07-22 09:14:00] [config] optimizer-params:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] output-omit-bias: false
[2023-07-22 09:14:00] [config] overwrite: true
[2023-07-22 09:14:00] [config] precision:
[2023-07-22 09:14:00] [config]   - float16
[2023-07-22 09:14:00] [config]   - float32
[2023-07-22 09:14:00] [config] pretrained-model: ""
[2023-07-22 09:14:00] [config] quantize-biases: false
[2023-07-22 09:14:00] [config] quantize-bits: 0
[2023-07-22 09:14:00] [config] quantize-log-based: false
[2023-07-22 09:14:00] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:00] [config] quiet: false
[2023-07-22 09:14:00] [config] quiet-translation: true
[2023-07-22 09:14:00] [config] relative-paths: false
[2023-07-22 09:14:00] [config] right-left: false
[2023-07-22 09:14:00] [config] save-freq: 10000u
[2023-07-22 09:14:00] [config] seed: 1234
[2023-07-22 09:14:00] [config] sentencepiece-alphas:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:00] [config] sentencepiece-options: ""
[2023-07-22 09:14:00] [config] sharding: global
[2023-07-22 09:14:00] [config] shuffle: data
[2023-07-22 09:14:00] [config] shuffle-in-ram: false
[2023-07-22 09:14:00] [config] sigterm: save-and-exit
[2023-07-22 09:14:00] [config] skip: false
[2023-07-22 09:14:00] [config] sqlite: ""
[2023-07-22 09:14:00] [config] sqlite-drop: false
[2023-07-22 09:14:00] [config] sync-freq: 200u
[2023-07-22 09:14:00] [config] sync-sgd: false
[2023-07-22 09:14:00] [config] tempdir: /tmp
[2023-07-22 09:14:00] [config] tied-embeddings: false
[2023-07-22 09:14:00] [config] tied-embeddings-all: true
[2023-07-22 09:14:00] [config] tied-embeddings-src: false
[2023-07-22 09:14:00] [config] train-embedder-rank:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] train-sets:
[2023-07-22 09:14:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:00] [config] transformer-aan-activation: swish
[2023-07-22 09:14:00] [config] transformer-aan-depth: 2
[2023-07-22 09:14:00] [config] transformer-aan-nogate: false
[2023-07-22 09:14:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:00] [config] transformer-depth-scaling: false
[2023-07-22 09:14:00] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:00] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:00] [config] transformer-dropout: 0
[2023-07-22 09:14:00] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:00] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:00] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:00] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:00] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:00] [config] transformer-heads: 8
[2023-07-22 09:14:00] [config] transformer-no-projection: false
[2023-07-22 09:14:00] [config] transformer-pool: false
[2023-07-22 09:14:00] [config] transformer-postprocess: dan
[2023-07-22 09:14:00] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:00] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:00] [config] transformer-preprocess: ""
[2023-07-22 09:14:00] [config] transformer-tied-layers:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:00] [config] tsv: false
[2023-07-22 09:14:00] [config] tsv-fields: 0
[2023-07-22 09:14:00] [config] type: amun
[2023-07-22 09:14:00] [config] ulr: false
[2023-07-22 09:14:00] [config] ulr-dim-emb: 0
[2023-07-22 09:14:00] [config] ulr-dropout: 0
[2023-07-22 09:14:00] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:00] [config] ulr-query-vectors: ""
[2023-07-22 09:14:00] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:00] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:00] [config] unlikelihood-loss: false
[2023-07-22 09:14:00] [config] valid-freq: 50000000
[2023-07-22 09:14:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:00] [config] valid-max-length: 1000
[2023-07-22 09:14:00] [config] valid-metrics:
[2023-07-22 09:14:00] [config]   - cross-entropy
[2023-07-22 09:14:00] [config]   - translation
[2023-07-22 09:14:00] [config] valid-mini-batch: 32
[2023-07-22 09:14:00] [config] valid-reset-stalled: false
[2023-07-22 09:14:00] [config] valid-script-args:
[2023-07-22 09:14:00] [config]   []
[2023-07-22 09:14:00] [config] valid-script-path: ""
[2023-07-22 09:14:00] [config] valid-sets:
[2023-07-22 09:14:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:00] [config] vocabs:
[2023-07-22 09:14:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:00] [config] word-penalty: 0
[2023-07-22 09:14:00] [config] word-scores: false
[2023-07-22 09:14:00] [config] workspace: 5500
[2023-07-22 09:14:00] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:00] [training] Using single-device training
[2023-07-22 09:14:00] Synced seed 1234
[2023-07-22 09:14:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:00] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:00] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:00] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:00] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:00] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:02] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:02] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x5617f3728141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x5617f366ada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5617f366f1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5617f36762ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5617f3822a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5617f3823a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5617f37fcbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5617f32fe108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5617f32202c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5617f31d7b9c]    main                                               + 0x3c
[0x7f7450c750b3]    __libc_start_main                                  + 0xf3
[0x5617f321ecbe]    _start                                             + 0x2e

[2023-07-22 09:14:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:05] [marian] Running on node23.datos.cluster.uy as process 27100 with command line:
[2023-07-22 09:14:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:05] [config] after: 0e
[2023-07-22 09:14:05] [config] after-batches: 0
[2023-07-22 09:14:05] [config] after-epochs: 60
[2023-07-22 09:14:05] [config] all-caps-every: 0
[2023-07-22 09:14:05] [config] allow-unk: false
[2023-07-22 09:14:05] [config] authors: false
[2023-07-22 09:14:05] [config] beam-size: 12
[2023-07-22 09:14:05] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:05] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:05] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:05] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:05] [config] build-info: ""
[2023-07-22 09:14:05] [config] check-gradient-nan: false
[2023-07-22 09:14:05] [config] check-nan: false
[2023-07-22 09:14:05] [config] cite: false
[2023-07-22 09:14:05] [config] clip-norm: 1
[2023-07-22 09:14:05] [config] cost-scaling:
[2023-07-22 09:14:05] [config]   - 256.f
[2023-07-22 09:14:05] [config]   - 1000
[2023-07-22 09:14:05] [config]   - 2.f
[2023-07-22 09:14:05] [config]   - 256.f
[2023-07-22 09:14:05] [config] cost-type: ce-sum
[2023-07-22 09:14:05] [config] cpu-threads: 0
[2023-07-22 09:14:05] [config] data-threads: 8
[2023-07-22 09:14:05] [config] data-weighting: ""
[2023-07-22 09:14:05] [config] data-weighting-type: sentence
[2023-07-22 09:14:05] [config] dec-cell: gru
[2023-07-22 09:14:05] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:05] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:05] [config] dec-depth: 2
[2023-07-22 09:14:05] [config] devices:
[2023-07-22 09:14:05] [config]   - 0
[2023-07-22 09:14:05] [config] dim-emb: 512
[2023-07-22 09:14:05] [config] dim-rnn: 1024
[2023-07-22 09:14:05] [config] dim-vocabs:
[2023-07-22 09:14:05] [config]   - 16384
[2023-07-22 09:14:05] [config]   - 16384
[2023-07-22 09:14:05] [config] disp-first: 0
[2023-07-22 09:14:05] [config] disp-freq: 1000u
[2023-07-22 09:14:05] [config] disp-label-counts: true
[2023-07-22 09:14:05] [config] dropout-rnn: 0
[2023-07-22 09:14:05] [config] dropout-src: 0
[2023-07-22 09:14:05] [config] dropout-trg: 0
[2023-07-22 09:14:05] [config] dump-config: ""
[2023-07-22 09:14:05] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] early-stopping: 200
[2023-07-22 09:14:05] [config] early-stopping-on: first
[2023-07-22 09:14:05] [config] embedding-fix-src: false
[2023-07-22 09:14:05] [config] embedding-fix-trg: false
[2023-07-22 09:14:05] [config] embedding-normalization: false
[2023-07-22 09:14:05] [config] embedding-vectors:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] enc-cell: gru
[2023-07-22 09:14:05] [config] enc-cell-depth: 1
[2023-07-22 09:14:05] [config] enc-depth: 2
[2023-07-22 09:14:05] [config] enc-type: bidirectional
[2023-07-22 09:14:05] [config] english-title-case-every: 0
[2023-07-22 09:14:05] [config] exponential-smoothing: 0
[2023-07-22 09:14:05] [config] factor-weight: 1
[2023-07-22 09:14:05] [config] factors-combine: sum
[2023-07-22 09:14:05] [config] factors-dim-emb: 0
[2023-07-22 09:14:05] [config] gradient-checkpointing: false
[2023-07-22 09:14:05] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:05] [config] guided-alignment: none
[2023-07-22 09:14:05] [config] guided-alignment-cost: mse
[2023-07-22 09:14:05] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:05] [config] ignore-model-config: false
[2023-07-22 09:14:05] [config] input-types:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] interpolate-env-vars: false
[2023-07-22 09:14:05] [config] keep-best: false
[2023-07-22 09:14:05] [config] label-smoothing: 0
[2023-07-22 09:14:05] [config] layer-normalization: false
[2023-07-22 09:14:05] [config] learn-rate: 0.0001
[2023-07-22 09:14:05] [config] lemma-dependency: ""
[2023-07-22 09:14:05] [config] lemma-dim-emb: 0
[2023-07-22 09:14:05] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:05] [config] log-level: info
[2023-07-22 09:14:05] [config] log-time-zone: ""
[2023-07-22 09:14:05] [config] logical-epoch:
[2023-07-22 09:14:05] [config]   - 1e
[2023-07-22 09:14:05] [config]   - 0
[2023-07-22 09:14:05] [config] lr-decay: 0
[2023-07-22 09:14:05] [config] lr-decay-freq: 50000
[2023-07-22 09:14:05] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:05] [config]   - 0
[2023-07-22 09:14:05] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:05] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:05] [config] lr-decay-start:
[2023-07-22 09:14:05] [config]   - 10
[2023-07-22 09:14:05] [config]   - 1
[2023-07-22 09:14:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:05] [config] lr-report: false
[2023-07-22 09:14:05] [config] lr-warmup: 0
[2023-07-22 09:14:05] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:05] [config] lr-warmup-cycle: false
[2023-07-22 09:14:05] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:05] [config] max-length: 50
[2023-07-22 09:14:05] [config] max-length-crop: true
[2023-07-22 09:14:05] [config] max-length-factor: 3
[2023-07-22 09:14:05] [config] maxi-batch: 100
[2023-07-22 09:14:05] [config] maxi-batch-sort: trg
[2023-07-22 09:14:05] [config] mini-batch: 64
[2023-07-22 09:14:05] [config] mini-batch-fit: true
[2023-07-22 09:14:05] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:05] [config] mini-batch-round-up: true
[2023-07-22 09:14:05] [config] mini-batch-track-lr: false
[2023-07-22 09:14:05] [config] mini-batch-warmup: 0
[2023-07-22 09:14:05] [config] mini-batch-words: 0
[2023-07-22 09:14:05] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:05] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:05] [config] multi-loss-type: sum
[2023-07-22 09:14:05] [config] n-best: false
[2023-07-22 09:14:05] [config] no-nccl: false
[2023-07-22 09:14:05] [config] no-reload: false
[2023-07-22 09:14:05] [config] no-restore-corpus: false
[2023-07-22 09:14:05] [config] normalize: 0
[2023-07-22 09:14:05] [config] normalize-gradient: false
[2023-07-22 09:14:05] [config] num-devices: 0
[2023-07-22 09:14:05] [config] optimizer: adam
[2023-07-22 09:14:05] [config] optimizer-delay: 1
[2023-07-22 09:14:05] [config] optimizer-params:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] output-omit-bias: false
[2023-07-22 09:14:05] [config] overwrite: true
[2023-07-22 09:14:05] [config] precision:
[2023-07-22 09:14:05] [config]   - float16
[2023-07-22 09:14:05] [config]   - float32
[2023-07-22 09:14:05] [config] pretrained-model: ""
[2023-07-22 09:14:05] [config] quantize-biases: false
[2023-07-22 09:14:05] [config] quantize-bits: 0
[2023-07-22 09:14:05] [config] quantize-log-based: false
[2023-07-22 09:14:05] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:05] [config] quiet: false
[2023-07-22 09:14:05] [config] quiet-translation: true
[2023-07-22 09:14:05] [config] relative-paths: false
[2023-07-22 09:14:05] [config] right-left: false
[2023-07-22 09:14:05] [config] save-freq: 10000u
[2023-07-22 09:14:05] [config] seed: 1234
[2023-07-22 09:14:05] [config] sentencepiece-alphas:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:05] [config] sentencepiece-options: ""
[2023-07-22 09:14:05] [config] sharding: global
[2023-07-22 09:14:05] [config] shuffle: data
[2023-07-22 09:14:05] [config] shuffle-in-ram: false
[2023-07-22 09:14:05] [config] sigterm: save-and-exit
[2023-07-22 09:14:05] [config] skip: false
[2023-07-22 09:14:05] [config] sqlite: ""
[2023-07-22 09:14:05] [config] sqlite-drop: false
[2023-07-22 09:14:05] [config] sync-freq: 200u
[2023-07-22 09:14:05] [config] sync-sgd: false
[2023-07-22 09:14:05] [config] tempdir: /tmp
[2023-07-22 09:14:05] [config] tied-embeddings: false
[2023-07-22 09:14:05] [config] tied-embeddings-all: true
[2023-07-22 09:14:05] [config] tied-embeddings-src: false
[2023-07-22 09:14:05] [config] train-embedder-rank:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] train-sets:
[2023-07-22 09:14:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:05] [config] transformer-aan-activation: swish
[2023-07-22 09:14:05] [config] transformer-aan-depth: 2
[2023-07-22 09:14:05] [config] transformer-aan-nogate: false
[2023-07-22 09:14:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:05] [config] transformer-depth-scaling: false
[2023-07-22 09:14:05] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:05] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:05] [config] transformer-dropout: 0
[2023-07-22 09:14:05] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:05] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:05] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:05] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:05] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:05] [config] transformer-heads: 8
[2023-07-22 09:14:05] [config] transformer-no-projection: false
[2023-07-22 09:14:05] [config] transformer-pool: false
[2023-07-22 09:14:05] [config] transformer-postprocess: dan
[2023-07-22 09:14:05] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:05] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:05] [config] transformer-preprocess: ""
[2023-07-22 09:14:05] [config] transformer-tied-layers:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:05] [config] tsv: false
[2023-07-22 09:14:05] [config] tsv-fields: 0
[2023-07-22 09:14:05] [config] type: amun
[2023-07-22 09:14:05] [config] ulr: false
[2023-07-22 09:14:05] [config] ulr-dim-emb: 0
[2023-07-22 09:14:05] [config] ulr-dropout: 0
[2023-07-22 09:14:05] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:05] [config] ulr-query-vectors: ""
[2023-07-22 09:14:05] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:05] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:05] [config] unlikelihood-loss: false
[2023-07-22 09:14:05] [config] valid-freq: 50000000
[2023-07-22 09:14:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:05] [config] valid-max-length: 1000
[2023-07-22 09:14:05] [config] valid-metrics:
[2023-07-22 09:14:05] [config]   - cross-entropy
[2023-07-22 09:14:05] [config]   - translation
[2023-07-22 09:14:05] [config] valid-mini-batch: 32
[2023-07-22 09:14:05] [config] valid-reset-stalled: false
[2023-07-22 09:14:05] [config] valid-script-args:
[2023-07-22 09:14:05] [config]   []
[2023-07-22 09:14:05] [config] valid-script-path: ""
[2023-07-22 09:14:05] [config] valid-sets:
[2023-07-22 09:14:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:05] [config] vocabs:
[2023-07-22 09:14:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:05] [config] word-penalty: 0
[2023-07-22 09:14:05] [config] word-scores: false
[2023-07-22 09:14:05] [config] workspace: 5500
[2023-07-22 09:14:05] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:05] [training] Using single-device training
[2023-07-22 09:14:05] Synced seed 1234
[2023-07-22 09:14:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:07] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:07] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x564620c33141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x564620b75da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x564620b7a1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x564620b812ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x564620d2da0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x564620d2ea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x564620d07bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x564620809108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x56462072b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5646206e2b9c]    main                                               + 0x3c
[0x7fe6bd2e30b3]    __libc_start_main                                  + 0xf3
[0x564620729cbe]    _start                                             + 0x2e

[2023-07-22 09:14:09] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:09] [marian] Running on node23.datos.cluster.uy as process 27127 with command line:
[2023-07-22 09:14:09] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:09] [config] after: 0e
[2023-07-22 09:14:09] [config] after-batches: 0
[2023-07-22 09:14:09] [config] after-epochs: 70
[2023-07-22 09:14:09] [config] all-caps-every: 0
[2023-07-22 09:14:09] [config] allow-unk: false
[2023-07-22 09:14:09] [config] authors: false
[2023-07-22 09:14:09] [config] beam-size: 12
[2023-07-22 09:14:09] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:09] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:09] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:09] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:09] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:09] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:09] [config] build-info: ""
[2023-07-22 09:14:09] [config] check-gradient-nan: false
[2023-07-22 09:14:09] [config] check-nan: false
[2023-07-22 09:14:09] [config] cite: false
[2023-07-22 09:14:09] [config] clip-norm: 1
[2023-07-22 09:14:09] [config] cost-scaling:
[2023-07-22 09:14:09] [config]   - 256.f
[2023-07-22 09:14:09] [config]   - 1000
[2023-07-22 09:14:09] [config]   - 2.f
[2023-07-22 09:14:09] [config]   - 256.f
[2023-07-22 09:14:09] [config] cost-type: ce-sum
[2023-07-22 09:14:09] [config] cpu-threads: 0
[2023-07-22 09:14:09] [config] data-threads: 8
[2023-07-22 09:14:09] [config] data-weighting: ""
[2023-07-22 09:14:09] [config] data-weighting-type: sentence
[2023-07-22 09:14:09] [config] dec-cell: gru
[2023-07-22 09:14:09] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:09] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:09] [config] dec-depth: 2
[2023-07-22 09:14:09] [config] devices:
[2023-07-22 09:14:09] [config]   - 0
[2023-07-22 09:14:09] [config] dim-emb: 512
[2023-07-22 09:14:09] [config] dim-rnn: 1024
[2023-07-22 09:14:09] [config] dim-vocabs:
[2023-07-22 09:14:09] [config]   - 16384
[2023-07-22 09:14:09] [config]   - 16384
[2023-07-22 09:14:09] [config] disp-first: 0
[2023-07-22 09:14:09] [config] disp-freq: 1000u
[2023-07-22 09:14:09] [config] disp-label-counts: true
[2023-07-22 09:14:09] [config] dropout-rnn: 0
[2023-07-22 09:14:09] [config] dropout-src: 0
[2023-07-22 09:14:09] [config] dropout-trg: 0
[2023-07-22 09:14:09] [config] dump-config: ""
[2023-07-22 09:14:09] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] early-stopping: 200
[2023-07-22 09:14:09] [config] early-stopping-on: first
[2023-07-22 09:14:09] [config] embedding-fix-src: false
[2023-07-22 09:14:09] [config] embedding-fix-trg: false
[2023-07-22 09:14:09] [config] embedding-normalization: false
[2023-07-22 09:14:09] [config] embedding-vectors:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] enc-cell: gru
[2023-07-22 09:14:09] [config] enc-cell-depth: 1
[2023-07-22 09:14:09] [config] enc-depth: 2
[2023-07-22 09:14:09] [config] enc-type: bidirectional
[2023-07-22 09:14:09] [config] english-title-case-every: 0
[2023-07-22 09:14:09] [config] exponential-smoothing: 0
[2023-07-22 09:14:09] [config] factor-weight: 1
[2023-07-22 09:14:09] [config] factors-combine: sum
[2023-07-22 09:14:09] [config] factors-dim-emb: 0
[2023-07-22 09:14:09] [config] gradient-checkpointing: false
[2023-07-22 09:14:09] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:09] [config] guided-alignment: none
[2023-07-22 09:14:09] [config] guided-alignment-cost: mse
[2023-07-22 09:14:09] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:09] [config] ignore-model-config: false
[2023-07-22 09:14:09] [config] input-types:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] interpolate-env-vars: false
[2023-07-22 09:14:09] [config] keep-best: false
[2023-07-22 09:14:09] [config] label-smoothing: 0
[2023-07-22 09:14:09] [config] layer-normalization: false
[2023-07-22 09:14:09] [config] learn-rate: 0.0001
[2023-07-22 09:14:09] [config] lemma-dependency: ""
[2023-07-22 09:14:09] [config] lemma-dim-emb: 0
[2023-07-22 09:14:09] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:09] [config] log-level: info
[2023-07-22 09:14:09] [config] log-time-zone: ""
[2023-07-22 09:14:09] [config] logical-epoch:
[2023-07-22 09:14:09] [config]   - 1e
[2023-07-22 09:14:09] [config]   - 0
[2023-07-22 09:14:09] [config] lr-decay: 0
[2023-07-22 09:14:09] [config] lr-decay-freq: 50000
[2023-07-22 09:14:09] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:09] [config]   - 0
[2023-07-22 09:14:09] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:09] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:09] [config] lr-decay-start:
[2023-07-22 09:14:09] [config]   - 10
[2023-07-22 09:14:09] [config]   - 1
[2023-07-22 09:14:09] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:09] [config] lr-report: false
[2023-07-22 09:14:09] [config] lr-warmup: 0
[2023-07-22 09:14:09] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:09] [config] lr-warmup-cycle: false
[2023-07-22 09:14:09] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:09] [config] max-length: 50
[2023-07-22 09:14:09] [config] max-length-crop: true
[2023-07-22 09:14:09] [config] max-length-factor: 3
[2023-07-22 09:14:09] [config] maxi-batch: 100
[2023-07-22 09:14:09] [config] maxi-batch-sort: trg
[2023-07-22 09:14:09] [config] mini-batch: 64
[2023-07-22 09:14:09] [config] mini-batch-fit: true
[2023-07-22 09:14:09] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:09] [config] mini-batch-round-up: true
[2023-07-22 09:14:09] [config] mini-batch-track-lr: false
[2023-07-22 09:14:09] [config] mini-batch-warmup: 0
[2023-07-22 09:14:09] [config] mini-batch-words: 0
[2023-07-22 09:14:09] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:09] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:09] [config] multi-loss-type: sum
[2023-07-22 09:14:09] [config] n-best: false
[2023-07-22 09:14:09] [config] no-nccl: false
[2023-07-22 09:14:09] [config] no-reload: false
[2023-07-22 09:14:09] [config] no-restore-corpus: false
[2023-07-22 09:14:09] [config] normalize: 0
[2023-07-22 09:14:09] [config] normalize-gradient: false
[2023-07-22 09:14:09] [config] num-devices: 0
[2023-07-22 09:14:09] [config] optimizer: adam
[2023-07-22 09:14:09] [config] optimizer-delay: 1
[2023-07-22 09:14:09] [config] optimizer-params:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] output-omit-bias: false
[2023-07-22 09:14:09] [config] overwrite: true
[2023-07-22 09:14:09] [config] precision:
[2023-07-22 09:14:09] [config]   - float16
[2023-07-22 09:14:09] [config]   - float32
[2023-07-22 09:14:09] [config] pretrained-model: ""
[2023-07-22 09:14:09] [config] quantize-biases: false
[2023-07-22 09:14:09] [config] quantize-bits: 0
[2023-07-22 09:14:09] [config] quantize-log-based: false
[2023-07-22 09:14:09] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:09] [config] quiet: false
[2023-07-22 09:14:09] [config] quiet-translation: true
[2023-07-22 09:14:09] [config] relative-paths: false
[2023-07-22 09:14:09] [config] right-left: false
[2023-07-22 09:14:09] [config] save-freq: 10000u
[2023-07-22 09:14:09] [config] seed: 1234
[2023-07-22 09:14:09] [config] sentencepiece-alphas:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:09] [config] sentencepiece-options: ""
[2023-07-22 09:14:09] [config] sharding: global
[2023-07-22 09:14:09] [config] shuffle: data
[2023-07-22 09:14:09] [config] shuffle-in-ram: false
[2023-07-22 09:14:09] [config] sigterm: save-and-exit
[2023-07-22 09:14:09] [config] skip: false
[2023-07-22 09:14:09] [config] sqlite: ""
[2023-07-22 09:14:09] [config] sqlite-drop: false
[2023-07-22 09:14:09] [config] sync-freq: 200u
[2023-07-22 09:14:09] [config] sync-sgd: false
[2023-07-22 09:14:09] [config] tempdir: /tmp
[2023-07-22 09:14:09] [config] tied-embeddings: false
[2023-07-22 09:14:09] [config] tied-embeddings-all: true
[2023-07-22 09:14:09] [config] tied-embeddings-src: false
[2023-07-22 09:14:09] [config] train-embedder-rank:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] train-sets:
[2023-07-22 09:14:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:09] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:09] [config] transformer-aan-activation: swish
[2023-07-22 09:14:09] [config] transformer-aan-depth: 2
[2023-07-22 09:14:09] [config] transformer-aan-nogate: false
[2023-07-22 09:14:09] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:09] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:09] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:09] [config] transformer-depth-scaling: false
[2023-07-22 09:14:09] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:09] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:09] [config] transformer-dropout: 0
[2023-07-22 09:14:09] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:09] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:09] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:09] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:09] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:09] [config] transformer-heads: 8
[2023-07-22 09:14:09] [config] transformer-no-projection: false
[2023-07-22 09:14:09] [config] transformer-pool: false
[2023-07-22 09:14:09] [config] transformer-postprocess: dan
[2023-07-22 09:14:09] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:09] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:09] [config] transformer-preprocess: ""
[2023-07-22 09:14:09] [config] transformer-tied-layers:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:09] [config] tsv: false
[2023-07-22 09:14:09] [config] tsv-fields: 0
[2023-07-22 09:14:09] [config] type: amun
[2023-07-22 09:14:09] [config] ulr: false
[2023-07-22 09:14:09] [config] ulr-dim-emb: 0
[2023-07-22 09:14:09] [config] ulr-dropout: 0
[2023-07-22 09:14:09] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:09] [config] ulr-query-vectors: ""
[2023-07-22 09:14:09] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:09] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:09] [config] unlikelihood-loss: false
[2023-07-22 09:14:09] [config] valid-freq: 50000000
[2023-07-22 09:14:09] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:09] [config] valid-max-length: 1000
[2023-07-22 09:14:09] [config] valid-metrics:
[2023-07-22 09:14:09] [config]   - cross-entropy
[2023-07-22 09:14:09] [config]   - translation
[2023-07-22 09:14:09] [config] valid-mini-batch: 32
[2023-07-22 09:14:09] [config] valid-reset-stalled: false
[2023-07-22 09:14:09] [config] valid-script-args:
[2023-07-22 09:14:09] [config]   []
[2023-07-22 09:14:09] [config] valid-script-path: ""
[2023-07-22 09:14:09] [config] valid-sets:
[2023-07-22 09:14:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:09] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:09] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:09] [config] vocabs:
[2023-07-22 09:14:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:09] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:09] [config] word-penalty: 0
[2023-07-22 09:14:09] [config] word-scores: false
[2023-07-22 09:14:09] [config] workspace: 5500
[2023-07-22 09:14:09] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:09] [training] Using single-device training
[2023-07-22 09:14:10] Synced seed 1234
[2023-07-22 09:14:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:11] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:11] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55bfff07d141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55bffefbfda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55bffefc41a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55bffefcb2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55bfff177a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55bfff178a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55bfff151bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55bffec53108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55bffeb752c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55bffeb2cb9c]    main                                               + 0x3c
[0x7effd124c0b3]    __libc_start_main                                  + 0xf3
[0x55bffeb73cbe]    _start                                             + 0x2e

[2023-07-22 09:14:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:14] [marian] Running on node23.datos.cluster.uy as process 27155 with command line:
[2023-07-22 09:14:14] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:14] [config] after: 0e
[2023-07-22 09:14:14] [config] after-batches: 0
[2023-07-22 09:14:14] [config] after-epochs: 80
[2023-07-22 09:14:14] [config] all-caps-every: 0
[2023-07-22 09:14:14] [config] allow-unk: false
[2023-07-22 09:14:14] [config] authors: false
[2023-07-22 09:14:14] [config] beam-size: 12
[2023-07-22 09:14:14] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:14] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:14] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:14] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:14] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:14] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:14] [config] build-info: ""
[2023-07-22 09:14:14] [config] check-gradient-nan: false
[2023-07-22 09:14:14] [config] check-nan: false
[2023-07-22 09:14:14] [config] cite: false
[2023-07-22 09:14:14] [config] clip-norm: 1
[2023-07-22 09:14:14] [config] cost-scaling:
[2023-07-22 09:14:14] [config]   - 256.f
[2023-07-22 09:14:14] [config]   - 1000
[2023-07-22 09:14:14] [config]   - 2.f
[2023-07-22 09:14:14] [config]   - 256.f
[2023-07-22 09:14:14] [config] cost-type: ce-sum
[2023-07-22 09:14:14] [config] cpu-threads: 0
[2023-07-22 09:14:14] [config] data-threads: 8
[2023-07-22 09:14:14] [config] data-weighting: ""
[2023-07-22 09:14:14] [config] data-weighting-type: sentence
[2023-07-22 09:14:14] [config] dec-cell: gru
[2023-07-22 09:14:14] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:14] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:14] [config] dec-depth: 2
[2023-07-22 09:14:14] [config] devices:
[2023-07-22 09:14:14] [config]   - 0
[2023-07-22 09:14:14] [config] dim-emb: 512
[2023-07-22 09:14:14] [config] dim-rnn: 1024
[2023-07-22 09:14:14] [config] dim-vocabs:
[2023-07-22 09:14:14] [config]   - 16384
[2023-07-22 09:14:14] [config]   - 16384
[2023-07-22 09:14:14] [config] disp-first: 0
[2023-07-22 09:14:14] [config] disp-freq: 1000u
[2023-07-22 09:14:14] [config] disp-label-counts: true
[2023-07-22 09:14:14] [config] dropout-rnn: 0
[2023-07-22 09:14:14] [config] dropout-src: 0
[2023-07-22 09:14:14] [config] dropout-trg: 0
[2023-07-22 09:14:14] [config] dump-config: ""
[2023-07-22 09:14:14] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] early-stopping: 200
[2023-07-22 09:14:14] [config] early-stopping-on: first
[2023-07-22 09:14:14] [config] embedding-fix-src: false
[2023-07-22 09:14:14] [config] embedding-fix-trg: false
[2023-07-22 09:14:14] [config] embedding-normalization: false
[2023-07-22 09:14:14] [config] embedding-vectors:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] enc-cell: gru
[2023-07-22 09:14:14] [config] enc-cell-depth: 1
[2023-07-22 09:14:14] [config] enc-depth: 2
[2023-07-22 09:14:14] [config] enc-type: bidirectional
[2023-07-22 09:14:14] [config] english-title-case-every: 0
[2023-07-22 09:14:14] [config] exponential-smoothing: 0
[2023-07-22 09:14:14] [config] factor-weight: 1
[2023-07-22 09:14:14] [config] factors-combine: sum
[2023-07-22 09:14:14] [config] factors-dim-emb: 0
[2023-07-22 09:14:14] [config] gradient-checkpointing: false
[2023-07-22 09:14:14] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:14] [config] guided-alignment: none
[2023-07-22 09:14:14] [config] guided-alignment-cost: mse
[2023-07-22 09:14:14] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:14] [config] ignore-model-config: false
[2023-07-22 09:14:14] [config] input-types:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] interpolate-env-vars: false
[2023-07-22 09:14:14] [config] keep-best: false
[2023-07-22 09:14:14] [config] label-smoothing: 0
[2023-07-22 09:14:14] [config] layer-normalization: false
[2023-07-22 09:14:14] [config] learn-rate: 0.0001
[2023-07-22 09:14:14] [config] lemma-dependency: ""
[2023-07-22 09:14:14] [config] lemma-dim-emb: 0
[2023-07-22 09:14:14] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:14] [config] log-level: info
[2023-07-22 09:14:14] [config] log-time-zone: ""
[2023-07-22 09:14:14] [config] logical-epoch:
[2023-07-22 09:14:14] [config]   - 1e
[2023-07-22 09:14:14] [config]   - 0
[2023-07-22 09:14:14] [config] lr-decay: 0
[2023-07-22 09:14:14] [config] lr-decay-freq: 50000
[2023-07-22 09:14:14] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:14] [config]   - 0
[2023-07-22 09:14:14] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:14] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:14] [config] lr-decay-start:
[2023-07-22 09:14:14] [config]   - 10
[2023-07-22 09:14:14] [config]   - 1
[2023-07-22 09:14:14] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:14] [config] lr-report: false
[2023-07-22 09:14:14] [config] lr-warmup: 0
[2023-07-22 09:14:14] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:14] [config] lr-warmup-cycle: false
[2023-07-22 09:14:14] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:14] [config] max-length: 50
[2023-07-22 09:14:14] [config] max-length-crop: true
[2023-07-22 09:14:14] [config] max-length-factor: 3
[2023-07-22 09:14:14] [config] maxi-batch: 100
[2023-07-22 09:14:14] [config] maxi-batch-sort: trg
[2023-07-22 09:14:14] [config] mini-batch: 64
[2023-07-22 09:14:14] [config] mini-batch-fit: true
[2023-07-22 09:14:14] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:14] [config] mini-batch-round-up: true
[2023-07-22 09:14:14] [config] mini-batch-track-lr: false
[2023-07-22 09:14:14] [config] mini-batch-warmup: 0
[2023-07-22 09:14:14] [config] mini-batch-words: 0
[2023-07-22 09:14:14] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:14] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:14] [config] multi-loss-type: sum
[2023-07-22 09:14:14] [config] n-best: false
[2023-07-22 09:14:14] [config] no-nccl: false
[2023-07-22 09:14:14] [config] no-reload: false
[2023-07-22 09:14:14] [config] no-restore-corpus: false
[2023-07-22 09:14:14] [config] normalize: 0
[2023-07-22 09:14:14] [config] normalize-gradient: false
[2023-07-22 09:14:14] [config] num-devices: 0
[2023-07-22 09:14:14] [config] optimizer: adam
[2023-07-22 09:14:14] [config] optimizer-delay: 1
[2023-07-22 09:14:14] [config] optimizer-params:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] output-omit-bias: false
[2023-07-22 09:14:14] [config] overwrite: true
[2023-07-22 09:14:14] [config] precision:
[2023-07-22 09:14:14] [config]   - float16
[2023-07-22 09:14:14] [config]   - float32
[2023-07-22 09:14:14] [config] pretrained-model: ""
[2023-07-22 09:14:14] [config] quantize-biases: false
[2023-07-22 09:14:14] [config] quantize-bits: 0
[2023-07-22 09:14:14] [config] quantize-log-based: false
[2023-07-22 09:14:14] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:14] [config] quiet: false
[2023-07-22 09:14:14] [config] quiet-translation: true
[2023-07-22 09:14:14] [config] relative-paths: false
[2023-07-22 09:14:14] [config] right-left: false
[2023-07-22 09:14:14] [config] save-freq: 10000u
[2023-07-22 09:14:14] [config] seed: 1234
[2023-07-22 09:14:14] [config] sentencepiece-alphas:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:14] [config] sentencepiece-options: ""
[2023-07-22 09:14:14] [config] sharding: global
[2023-07-22 09:14:14] [config] shuffle: data
[2023-07-22 09:14:14] [config] shuffle-in-ram: false
[2023-07-22 09:14:14] [config] sigterm: save-and-exit
[2023-07-22 09:14:14] [config] skip: false
[2023-07-22 09:14:14] [config] sqlite: ""
[2023-07-22 09:14:14] [config] sqlite-drop: false
[2023-07-22 09:14:14] [config] sync-freq: 200u
[2023-07-22 09:14:14] [config] sync-sgd: false
[2023-07-22 09:14:14] [config] tempdir: /tmp
[2023-07-22 09:14:14] [config] tied-embeddings: false
[2023-07-22 09:14:14] [config] tied-embeddings-all: true
[2023-07-22 09:14:14] [config] tied-embeddings-src: false
[2023-07-22 09:14:14] [config] train-embedder-rank:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] train-sets:
[2023-07-22 09:14:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:14] [config] transformer-aan-activation: swish
[2023-07-22 09:14:14] [config] transformer-aan-depth: 2
[2023-07-22 09:14:14] [config] transformer-aan-nogate: false
[2023-07-22 09:14:14] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:14] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:14] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:14] [config] transformer-depth-scaling: false
[2023-07-22 09:14:14] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:14] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:14] [config] transformer-dropout: 0
[2023-07-22 09:14:14] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:14] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:14] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:14] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:14] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:14] [config] transformer-heads: 8
[2023-07-22 09:14:14] [config] transformer-no-projection: false
[2023-07-22 09:14:14] [config] transformer-pool: false
[2023-07-22 09:14:14] [config] transformer-postprocess: dan
[2023-07-22 09:14:14] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:14] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:14] [config] transformer-preprocess: ""
[2023-07-22 09:14:14] [config] transformer-tied-layers:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:14] [config] tsv: false
[2023-07-22 09:14:14] [config] tsv-fields: 0
[2023-07-22 09:14:14] [config] type: amun
[2023-07-22 09:14:14] [config] ulr: false
[2023-07-22 09:14:14] [config] ulr-dim-emb: 0
[2023-07-22 09:14:14] [config] ulr-dropout: 0
[2023-07-22 09:14:14] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:14] [config] ulr-query-vectors: ""
[2023-07-22 09:14:14] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:14] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:14] [config] unlikelihood-loss: false
[2023-07-22 09:14:14] [config] valid-freq: 50000000
[2023-07-22 09:14:14] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:14] [config] valid-max-length: 1000
[2023-07-22 09:14:14] [config] valid-metrics:
[2023-07-22 09:14:14] [config]   - cross-entropy
[2023-07-22 09:14:14] [config]   - translation
[2023-07-22 09:14:14] [config] valid-mini-batch: 32
[2023-07-22 09:14:14] [config] valid-reset-stalled: false
[2023-07-22 09:14:14] [config] valid-script-args:
[2023-07-22 09:14:14] [config]   []
[2023-07-22 09:14:14] [config] valid-script-path: ""
[2023-07-22 09:14:14] [config] valid-sets:
[2023-07-22 09:14:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:14] [config] vocabs:
[2023-07-22 09:14:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:14] [config] word-penalty: 0
[2023-07-22 09:14:14] [config] word-scores: false
[2023-07-22 09:14:14] [config] workspace: 5500
[2023-07-22 09:14:14] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:14] [training] Using single-device training
[2023-07-22 09:14:15] Synced seed 1234
[2023-07-22 09:14:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:15] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:15] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:15] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:15] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:16] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:16] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:16] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55822353e141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x558223480da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5582234851a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55822348c2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x558223638a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x558223639a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x558223612bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x558223114108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5582230362c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x558222fedb9c]    main                                               + 0x3c
[0x7fec64efc0b3]    __libc_start_main                                  + 0xf3
[0x558223034cbe]    _start                                             + 0x2e

[2023-07-22 09:14:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:19] [marian] Running on node23.datos.cluster.uy as process 27183 with command line:
[2023-07-22 09:14:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:19] [config] after: 0e
[2023-07-22 09:14:19] [config] after-batches: 0
[2023-07-22 09:14:19] [config] after-epochs: 90
[2023-07-22 09:14:19] [config] all-caps-every: 0
[2023-07-22 09:14:19] [config] allow-unk: false
[2023-07-22 09:14:19] [config] authors: false
[2023-07-22 09:14:19] [config] beam-size: 12
[2023-07-22 09:14:19] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:19] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:19] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:19] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:19] [config] build-info: ""
[2023-07-22 09:14:19] [config] check-gradient-nan: false
[2023-07-22 09:14:19] [config] check-nan: false
[2023-07-22 09:14:19] [config] cite: false
[2023-07-22 09:14:19] [config] clip-norm: 1
[2023-07-22 09:14:19] [config] cost-scaling:
[2023-07-22 09:14:19] [config]   - 256.f
[2023-07-22 09:14:19] [config]   - 1000
[2023-07-22 09:14:19] [config]   - 2.f
[2023-07-22 09:14:19] [config]   - 256.f
[2023-07-22 09:14:19] [config] cost-type: ce-sum
[2023-07-22 09:14:19] [config] cpu-threads: 0
[2023-07-22 09:14:19] [config] data-threads: 8
[2023-07-22 09:14:19] [config] data-weighting: ""
[2023-07-22 09:14:19] [config] data-weighting-type: sentence
[2023-07-22 09:14:19] [config] dec-cell: gru
[2023-07-22 09:14:19] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:19] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:19] [config] dec-depth: 2
[2023-07-22 09:14:19] [config] devices:
[2023-07-22 09:14:19] [config]   - 0
[2023-07-22 09:14:19] [config] dim-emb: 512
[2023-07-22 09:14:19] [config] dim-rnn: 1024
[2023-07-22 09:14:19] [config] dim-vocabs:
[2023-07-22 09:14:19] [config]   - 16384
[2023-07-22 09:14:19] [config]   - 16384
[2023-07-22 09:14:19] [config] disp-first: 0
[2023-07-22 09:14:19] [config] disp-freq: 1000u
[2023-07-22 09:14:19] [config] disp-label-counts: true
[2023-07-22 09:14:19] [config] dropout-rnn: 0
[2023-07-22 09:14:19] [config] dropout-src: 0
[2023-07-22 09:14:19] [config] dropout-trg: 0
[2023-07-22 09:14:19] [config] dump-config: ""
[2023-07-22 09:14:19] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] early-stopping: 200
[2023-07-22 09:14:19] [config] early-stopping-on: first
[2023-07-22 09:14:19] [config] embedding-fix-src: false
[2023-07-22 09:14:19] [config] embedding-fix-trg: false
[2023-07-22 09:14:19] [config] embedding-normalization: false
[2023-07-22 09:14:19] [config] embedding-vectors:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] enc-cell: gru
[2023-07-22 09:14:19] [config] enc-cell-depth: 1
[2023-07-22 09:14:19] [config] enc-depth: 2
[2023-07-22 09:14:19] [config] enc-type: bidirectional
[2023-07-22 09:14:19] [config] english-title-case-every: 0
[2023-07-22 09:14:19] [config] exponential-smoothing: 0
[2023-07-22 09:14:19] [config] factor-weight: 1
[2023-07-22 09:14:19] [config] factors-combine: sum
[2023-07-22 09:14:19] [config] factors-dim-emb: 0
[2023-07-22 09:14:19] [config] gradient-checkpointing: false
[2023-07-22 09:14:19] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:19] [config] guided-alignment: none
[2023-07-22 09:14:19] [config] guided-alignment-cost: mse
[2023-07-22 09:14:19] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:19] [config] ignore-model-config: false
[2023-07-22 09:14:19] [config] input-types:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] interpolate-env-vars: false
[2023-07-22 09:14:19] [config] keep-best: false
[2023-07-22 09:14:19] [config] label-smoothing: 0
[2023-07-22 09:14:19] [config] layer-normalization: false
[2023-07-22 09:14:19] [config] learn-rate: 0.0001
[2023-07-22 09:14:19] [config] lemma-dependency: ""
[2023-07-22 09:14:19] [config] lemma-dim-emb: 0
[2023-07-22 09:14:19] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:19] [config] log-level: info
[2023-07-22 09:14:19] [config] log-time-zone: ""
[2023-07-22 09:14:19] [config] logical-epoch:
[2023-07-22 09:14:19] [config]   - 1e
[2023-07-22 09:14:19] [config]   - 0
[2023-07-22 09:14:19] [config] lr-decay: 0
[2023-07-22 09:14:19] [config] lr-decay-freq: 50000
[2023-07-22 09:14:19] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:19] [config]   - 0
[2023-07-22 09:14:19] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:19] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:19] [config] lr-decay-start:
[2023-07-22 09:14:19] [config]   - 10
[2023-07-22 09:14:19] [config]   - 1
[2023-07-22 09:14:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:19] [config] lr-report: false
[2023-07-22 09:14:19] [config] lr-warmup: 0
[2023-07-22 09:14:19] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:19] [config] lr-warmup-cycle: false
[2023-07-22 09:14:19] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:19] [config] max-length: 50
[2023-07-22 09:14:19] [config] max-length-crop: true
[2023-07-22 09:14:19] [config] max-length-factor: 3
[2023-07-22 09:14:19] [config] maxi-batch: 100
[2023-07-22 09:14:19] [config] maxi-batch-sort: trg
[2023-07-22 09:14:19] [config] mini-batch: 64
[2023-07-22 09:14:19] [config] mini-batch-fit: true
[2023-07-22 09:14:19] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:19] [config] mini-batch-round-up: true
[2023-07-22 09:14:19] [config] mini-batch-track-lr: false
[2023-07-22 09:14:19] [config] mini-batch-warmup: 0
[2023-07-22 09:14:19] [config] mini-batch-words: 0
[2023-07-22 09:14:19] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:19] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:19] [config] multi-loss-type: sum
[2023-07-22 09:14:19] [config] n-best: false
[2023-07-22 09:14:19] [config] no-nccl: false
[2023-07-22 09:14:19] [config] no-reload: false
[2023-07-22 09:14:19] [config] no-restore-corpus: false
[2023-07-22 09:14:19] [config] normalize: 0
[2023-07-22 09:14:19] [config] normalize-gradient: false
[2023-07-22 09:14:19] [config] num-devices: 0
[2023-07-22 09:14:19] [config] optimizer: adam
[2023-07-22 09:14:19] [config] optimizer-delay: 1
[2023-07-22 09:14:19] [config] optimizer-params:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] output-omit-bias: false
[2023-07-22 09:14:19] [config] overwrite: true
[2023-07-22 09:14:19] [config] precision:
[2023-07-22 09:14:19] [config]   - float16
[2023-07-22 09:14:19] [config]   - float32
[2023-07-22 09:14:19] [config] pretrained-model: ""
[2023-07-22 09:14:19] [config] quantize-biases: false
[2023-07-22 09:14:19] [config] quantize-bits: 0
[2023-07-22 09:14:19] [config] quantize-log-based: false
[2023-07-22 09:14:19] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:19] [config] quiet: false
[2023-07-22 09:14:19] [config] quiet-translation: true
[2023-07-22 09:14:19] [config] relative-paths: false
[2023-07-22 09:14:19] [config] right-left: false
[2023-07-22 09:14:19] [config] save-freq: 10000u
[2023-07-22 09:14:19] [config] seed: 1234
[2023-07-22 09:14:19] [config] sentencepiece-alphas:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:19] [config] sentencepiece-options: ""
[2023-07-22 09:14:19] [config] sharding: global
[2023-07-22 09:14:19] [config] shuffle: data
[2023-07-22 09:14:19] [config] shuffle-in-ram: false
[2023-07-22 09:14:19] [config] sigterm: save-and-exit
[2023-07-22 09:14:19] [config] skip: false
[2023-07-22 09:14:19] [config] sqlite: ""
[2023-07-22 09:14:19] [config] sqlite-drop: false
[2023-07-22 09:14:19] [config] sync-freq: 200u
[2023-07-22 09:14:19] [config] sync-sgd: false
[2023-07-22 09:14:19] [config] tempdir: /tmp
[2023-07-22 09:14:19] [config] tied-embeddings: false
[2023-07-22 09:14:19] [config] tied-embeddings-all: true
[2023-07-22 09:14:19] [config] tied-embeddings-src: false
[2023-07-22 09:14:19] [config] train-embedder-rank:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] train-sets:
[2023-07-22 09:14:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:19] [config] transformer-aan-activation: swish
[2023-07-22 09:14:19] [config] transformer-aan-depth: 2
[2023-07-22 09:14:19] [config] transformer-aan-nogate: false
[2023-07-22 09:14:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:19] [config] transformer-depth-scaling: false
[2023-07-22 09:14:19] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:19] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:19] [config] transformer-dropout: 0
[2023-07-22 09:14:19] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:19] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:19] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:19] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:19] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:19] [config] transformer-heads: 8
[2023-07-22 09:14:19] [config] transformer-no-projection: false
[2023-07-22 09:14:19] [config] transformer-pool: false
[2023-07-22 09:14:19] [config] transformer-postprocess: dan
[2023-07-22 09:14:19] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:19] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:19] [config] transformer-preprocess: ""
[2023-07-22 09:14:19] [config] transformer-tied-layers:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:19] [config] tsv: false
[2023-07-22 09:14:19] [config] tsv-fields: 0
[2023-07-22 09:14:19] [config] type: amun
[2023-07-22 09:14:19] [config] ulr: false
[2023-07-22 09:14:19] [config] ulr-dim-emb: 0
[2023-07-22 09:14:19] [config] ulr-dropout: 0
[2023-07-22 09:14:19] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:19] [config] ulr-query-vectors: ""
[2023-07-22 09:14:19] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:19] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:19] [config] unlikelihood-loss: false
[2023-07-22 09:14:19] [config] valid-freq: 50000000
[2023-07-22 09:14:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:19] [config] valid-max-length: 1000
[2023-07-22 09:14:19] [config] valid-metrics:
[2023-07-22 09:14:19] [config]   - cross-entropy
[2023-07-22 09:14:19] [config]   - translation
[2023-07-22 09:14:19] [config] valid-mini-batch: 32
[2023-07-22 09:14:19] [config] valid-reset-stalled: false
[2023-07-22 09:14:19] [config] valid-script-args:
[2023-07-22 09:14:19] [config]   []
[2023-07-22 09:14:19] [config] valid-script-path: ""
[2023-07-22 09:14:19] [config] valid-sets:
[2023-07-22 09:14:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:19] [config] vocabs:
[2023-07-22 09:14:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:19] [config] word-penalty: 0
[2023-07-22 09:14:19] [config] word-scores: false
[2023-07-22 09:14:19] [config] workspace: 5500
[2023-07-22 09:14:19] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:19] [training] Using single-device training
[2023-07-22 09:14:19] Synced seed 1234
[2023-07-22 09:14:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:21] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:21] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55c2dce76141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55c2dcdb8da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55c2dcdbd1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55c2dcdc42ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55c2dcf70a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55c2dcf71a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55c2dcf4abee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55c2dca4c108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55c2dc96e2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55c2dc925b9c]    main                                               + 0x3c
[0x7f065cf210b3]    __libc_start_main                                  + 0xf3
[0x55c2dc96ccbe]    _start                                             + 0x2e

[2023-07-22 09:14:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:24] [marian] Running on node23.datos.cluster.uy as process 27209 with command line:
[2023-07-22 09:14:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:24] [config] after: 0e
[2023-07-22 09:14:24] [config] after-batches: 0
[2023-07-22 09:14:24] [config] after-epochs: 100
[2023-07-22 09:14:24] [config] all-caps-every: 0
[2023-07-22 09:14:24] [config] allow-unk: false
[2023-07-22 09:14:24] [config] authors: false
[2023-07-22 09:14:24] [config] beam-size: 12
[2023-07-22 09:14:24] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:24] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:24] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:24] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:24] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:24] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:24] [config] build-info: ""
[2023-07-22 09:14:24] [config] check-gradient-nan: false
[2023-07-22 09:14:24] [config] check-nan: false
[2023-07-22 09:14:24] [config] cite: false
[2023-07-22 09:14:24] [config] clip-norm: 1
[2023-07-22 09:14:24] [config] cost-scaling:
[2023-07-22 09:14:24] [config]   - 256.f
[2023-07-22 09:14:24] [config]   - 1000
[2023-07-22 09:14:24] [config]   - 2.f
[2023-07-22 09:14:24] [config]   - 256.f
[2023-07-22 09:14:24] [config] cost-type: ce-sum
[2023-07-22 09:14:24] [config] cpu-threads: 0
[2023-07-22 09:14:24] [config] data-threads: 8
[2023-07-22 09:14:24] [config] data-weighting: ""
[2023-07-22 09:14:24] [config] data-weighting-type: sentence
[2023-07-22 09:14:24] [config] dec-cell: gru
[2023-07-22 09:14:24] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:24] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:24] [config] dec-depth: 2
[2023-07-22 09:14:24] [config] devices:
[2023-07-22 09:14:24] [config]   - 0
[2023-07-22 09:14:24] [config] dim-emb: 512
[2023-07-22 09:14:24] [config] dim-rnn: 1024
[2023-07-22 09:14:24] [config] dim-vocabs:
[2023-07-22 09:14:24] [config]   - 16384
[2023-07-22 09:14:24] [config]   - 16384
[2023-07-22 09:14:24] [config] disp-first: 0
[2023-07-22 09:14:24] [config] disp-freq: 1000u
[2023-07-22 09:14:24] [config] disp-label-counts: true
[2023-07-22 09:14:24] [config] dropout-rnn: 0
[2023-07-22 09:14:24] [config] dropout-src: 0
[2023-07-22 09:14:24] [config] dropout-trg: 0
[2023-07-22 09:14:24] [config] dump-config: ""
[2023-07-22 09:14:24] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] early-stopping: 200
[2023-07-22 09:14:24] [config] early-stopping-on: first
[2023-07-22 09:14:24] [config] embedding-fix-src: false
[2023-07-22 09:14:24] [config] embedding-fix-trg: false
[2023-07-22 09:14:24] [config] embedding-normalization: false
[2023-07-22 09:14:24] [config] embedding-vectors:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] enc-cell: gru
[2023-07-22 09:14:24] [config] enc-cell-depth: 1
[2023-07-22 09:14:24] [config] enc-depth: 2
[2023-07-22 09:14:24] [config] enc-type: bidirectional
[2023-07-22 09:14:24] [config] english-title-case-every: 0
[2023-07-22 09:14:24] [config] exponential-smoothing: 0
[2023-07-22 09:14:24] [config] factor-weight: 1
[2023-07-22 09:14:24] [config] factors-combine: sum
[2023-07-22 09:14:24] [config] factors-dim-emb: 0
[2023-07-22 09:14:24] [config] gradient-checkpointing: false
[2023-07-22 09:14:24] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:24] [config] guided-alignment: none
[2023-07-22 09:14:24] [config] guided-alignment-cost: mse
[2023-07-22 09:14:24] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:24] [config] ignore-model-config: false
[2023-07-22 09:14:24] [config] input-types:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] interpolate-env-vars: false
[2023-07-22 09:14:24] [config] keep-best: false
[2023-07-22 09:14:24] [config] label-smoothing: 0
[2023-07-22 09:14:24] [config] layer-normalization: false
[2023-07-22 09:14:24] [config] learn-rate: 0.0001
[2023-07-22 09:14:24] [config] lemma-dependency: ""
[2023-07-22 09:14:24] [config] lemma-dim-emb: 0
[2023-07-22 09:14:24] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:24] [config] log-level: info
[2023-07-22 09:14:24] [config] log-time-zone: ""
[2023-07-22 09:14:24] [config] logical-epoch:
[2023-07-22 09:14:24] [config]   - 1e
[2023-07-22 09:14:24] [config]   - 0
[2023-07-22 09:14:24] [config] lr-decay: 0
[2023-07-22 09:14:24] [config] lr-decay-freq: 50000
[2023-07-22 09:14:24] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:24] [config]   - 0
[2023-07-22 09:14:24] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:24] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:24] [config] lr-decay-start:
[2023-07-22 09:14:24] [config]   - 10
[2023-07-22 09:14:24] [config]   - 1
[2023-07-22 09:14:24] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:24] [config] lr-report: false
[2023-07-22 09:14:24] [config] lr-warmup: 0
[2023-07-22 09:14:24] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:24] [config] lr-warmup-cycle: false
[2023-07-22 09:14:24] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:24] [config] max-length: 50
[2023-07-22 09:14:24] [config] max-length-crop: true
[2023-07-22 09:14:24] [config] max-length-factor: 3
[2023-07-22 09:14:24] [config] maxi-batch: 100
[2023-07-22 09:14:24] [config] maxi-batch-sort: trg
[2023-07-22 09:14:24] [config] mini-batch: 64
[2023-07-22 09:14:24] [config] mini-batch-fit: true
[2023-07-22 09:14:24] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:24] [config] mini-batch-round-up: true
[2023-07-22 09:14:24] [config] mini-batch-track-lr: false
[2023-07-22 09:14:24] [config] mini-batch-warmup: 0
[2023-07-22 09:14:24] [config] mini-batch-words: 0
[2023-07-22 09:14:24] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:24] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:24] [config] multi-loss-type: sum
[2023-07-22 09:14:24] [config] n-best: false
[2023-07-22 09:14:24] [config] no-nccl: false
[2023-07-22 09:14:24] [config] no-reload: false
[2023-07-22 09:14:24] [config] no-restore-corpus: false
[2023-07-22 09:14:24] [config] normalize: 0
[2023-07-22 09:14:24] [config] normalize-gradient: false
[2023-07-22 09:14:24] [config] num-devices: 0
[2023-07-22 09:14:24] [config] optimizer: adam
[2023-07-22 09:14:24] [config] optimizer-delay: 1
[2023-07-22 09:14:24] [config] optimizer-params:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] output-omit-bias: false
[2023-07-22 09:14:24] [config] overwrite: true
[2023-07-22 09:14:24] [config] precision:
[2023-07-22 09:14:24] [config]   - float16
[2023-07-22 09:14:24] [config]   - float32
[2023-07-22 09:14:24] [config] pretrained-model: ""
[2023-07-22 09:14:24] [config] quantize-biases: false
[2023-07-22 09:14:24] [config] quantize-bits: 0
[2023-07-22 09:14:24] [config] quantize-log-based: false
[2023-07-22 09:14:24] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:24] [config] quiet: false
[2023-07-22 09:14:24] [config] quiet-translation: true
[2023-07-22 09:14:24] [config] relative-paths: false
[2023-07-22 09:14:24] [config] right-left: false
[2023-07-22 09:14:24] [config] save-freq: 10000u
[2023-07-22 09:14:24] [config] seed: 1234
[2023-07-22 09:14:24] [config] sentencepiece-alphas:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:24] [config] sentencepiece-options: ""
[2023-07-22 09:14:24] [config] sharding: global
[2023-07-22 09:14:24] [config] shuffle: data
[2023-07-22 09:14:24] [config] shuffle-in-ram: false
[2023-07-22 09:14:24] [config] sigterm: save-and-exit
[2023-07-22 09:14:24] [config] skip: false
[2023-07-22 09:14:24] [config] sqlite: ""
[2023-07-22 09:14:24] [config] sqlite-drop: false
[2023-07-22 09:14:24] [config] sync-freq: 200u
[2023-07-22 09:14:24] [config] sync-sgd: false
[2023-07-22 09:14:24] [config] tempdir: /tmp
[2023-07-22 09:14:24] [config] tied-embeddings: false
[2023-07-22 09:14:24] [config] tied-embeddings-all: true
[2023-07-22 09:14:24] [config] tied-embeddings-src: false
[2023-07-22 09:14:24] [config] train-embedder-rank:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] train-sets:
[2023-07-22 09:14:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:24] [config] transformer-aan-activation: swish
[2023-07-22 09:14:24] [config] transformer-aan-depth: 2
[2023-07-22 09:14:24] [config] transformer-aan-nogate: false
[2023-07-22 09:14:24] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:24] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:24] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:24] [config] transformer-depth-scaling: false
[2023-07-22 09:14:24] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:24] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:24] [config] transformer-dropout: 0
[2023-07-22 09:14:24] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:24] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:24] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:24] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:24] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:24] [config] transformer-heads: 8
[2023-07-22 09:14:24] [config] transformer-no-projection: false
[2023-07-22 09:14:24] [config] transformer-pool: false
[2023-07-22 09:14:24] [config] transformer-postprocess: dan
[2023-07-22 09:14:24] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:24] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:24] [config] transformer-preprocess: ""
[2023-07-22 09:14:24] [config] transformer-tied-layers:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:24] [config] tsv: false
[2023-07-22 09:14:24] [config] tsv-fields: 0
[2023-07-22 09:14:24] [config] type: amun
[2023-07-22 09:14:24] [config] ulr: false
[2023-07-22 09:14:24] [config] ulr-dim-emb: 0
[2023-07-22 09:14:24] [config] ulr-dropout: 0
[2023-07-22 09:14:24] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:24] [config] ulr-query-vectors: ""
[2023-07-22 09:14:24] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:24] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:24] [config] unlikelihood-loss: false
[2023-07-22 09:14:24] [config] valid-freq: 50000000
[2023-07-22 09:14:24] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:24] [config] valid-max-length: 1000
[2023-07-22 09:14:24] [config] valid-metrics:
[2023-07-22 09:14:24] [config]   - cross-entropy
[2023-07-22 09:14:24] [config]   - translation
[2023-07-22 09:14:24] [config] valid-mini-batch: 32
[2023-07-22 09:14:24] [config] valid-reset-stalled: false
[2023-07-22 09:14:24] [config] valid-script-args:
[2023-07-22 09:14:24] [config]   []
[2023-07-22 09:14:24] [config] valid-script-path: ""
[2023-07-22 09:14:24] [config] valid-sets:
[2023-07-22 09:14:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:24] [config] vocabs:
[2023-07-22 09:14:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:24] [config] word-penalty: 0
[2023-07-22 09:14:24] [config] word-scores: false
[2023-07-22 09:14:24] [config] workspace: 5500
[2023-07-22 09:14:24] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:24] [training] Using single-device training
[2023-07-22 09:14:24] Synced seed 1234
[2023-07-22 09:14:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:26] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:26] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:26] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55d2f4fa0141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55d2f4ee2da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55d2f4ee71a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55d2f4eee2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55d2f509aa0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55d2f509ba53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55d2f5074bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55d2f4b76108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55d2f4a982c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55d2f4a4fb9c]    main                                               + 0x3c
[0x7ff10e1a90b3]    __libc_start_main                                  + 0xf3
[0x55d2f4a96cbe]    _start                                             + 0x2e

[2023-07-22 09:14:29] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:29] [marian] Running on node23.datos.cluster.uy as process 27237 with command line:
[2023-07-22 09:14:29] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:29] [config] after: 0e
[2023-07-22 09:14:29] [config] after-batches: 0
[2023-07-22 09:14:29] [config] after-epochs: 110
[2023-07-22 09:14:29] [config] all-caps-every: 0
[2023-07-22 09:14:29] [config] allow-unk: false
[2023-07-22 09:14:29] [config] authors: false
[2023-07-22 09:14:29] [config] beam-size: 12
[2023-07-22 09:14:29] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:29] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:29] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:29] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:29] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:29] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:29] [config] build-info: ""
[2023-07-22 09:14:29] [config] check-gradient-nan: false
[2023-07-22 09:14:29] [config] check-nan: false
[2023-07-22 09:14:29] [config] cite: false
[2023-07-22 09:14:29] [config] clip-norm: 1
[2023-07-22 09:14:29] [config] cost-scaling:
[2023-07-22 09:14:29] [config]   - 256.f
[2023-07-22 09:14:29] [config]   - 1000
[2023-07-22 09:14:29] [config]   - 2.f
[2023-07-22 09:14:29] [config]   - 256.f
[2023-07-22 09:14:29] [config] cost-type: ce-sum
[2023-07-22 09:14:29] [config] cpu-threads: 0
[2023-07-22 09:14:29] [config] data-threads: 8
[2023-07-22 09:14:29] [config] data-weighting: ""
[2023-07-22 09:14:29] [config] data-weighting-type: sentence
[2023-07-22 09:14:29] [config] dec-cell: gru
[2023-07-22 09:14:29] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:29] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:29] [config] dec-depth: 2
[2023-07-22 09:14:29] [config] devices:
[2023-07-22 09:14:29] [config]   - 0
[2023-07-22 09:14:29] [config] dim-emb: 512
[2023-07-22 09:14:29] [config] dim-rnn: 1024
[2023-07-22 09:14:29] [config] dim-vocabs:
[2023-07-22 09:14:29] [config]   - 16384
[2023-07-22 09:14:29] [config]   - 16384
[2023-07-22 09:14:29] [config] disp-first: 0
[2023-07-22 09:14:29] [config] disp-freq: 1000u
[2023-07-22 09:14:29] [config] disp-label-counts: true
[2023-07-22 09:14:29] [config] dropout-rnn: 0
[2023-07-22 09:14:29] [config] dropout-src: 0
[2023-07-22 09:14:29] [config] dropout-trg: 0
[2023-07-22 09:14:29] [config] dump-config: ""
[2023-07-22 09:14:29] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] early-stopping: 200
[2023-07-22 09:14:29] [config] early-stopping-on: first
[2023-07-22 09:14:29] [config] embedding-fix-src: false
[2023-07-22 09:14:29] [config] embedding-fix-trg: false
[2023-07-22 09:14:29] [config] embedding-normalization: false
[2023-07-22 09:14:29] [config] embedding-vectors:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] enc-cell: gru
[2023-07-22 09:14:29] [config] enc-cell-depth: 1
[2023-07-22 09:14:29] [config] enc-depth: 2
[2023-07-22 09:14:29] [config] enc-type: bidirectional
[2023-07-22 09:14:29] [config] english-title-case-every: 0
[2023-07-22 09:14:29] [config] exponential-smoothing: 0
[2023-07-22 09:14:29] [config] factor-weight: 1
[2023-07-22 09:14:29] [config] factors-combine: sum
[2023-07-22 09:14:29] [config] factors-dim-emb: 0
[2023-07-22 09:14:29] [config] gradient-checkpointing: false
[2023-07-22 09:14:29] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:29] [config] guided-alignment: none
[2023-07-22 09:14:29] [config] guided-alignment-cost: mse
[2023-07-22 09:14:29] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:29] [config] ignore-model-config: false
[2023-07-22 09:14:29] [config] input-types:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] interpolate-env-vars: false
[2023-07-22 09:14:29] [config] keep-best: false
[2023-07-22 09:14:29] [config] label-smoothing: 0
[2023-07-22 09:14:29] [config] layer-normalization: false
[2023-07-22 09:14:29] [config] learn-rate: 0.0001
[2023-07-22 09:14:29] [config] lemma-dependency: ""
[2023-07-22 09:14:29] [config] lemma-dim-emb: 0
[2023-07-22 09:14:29] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:29] [config] log-level: info
[2023-07-22 09:14:29] [config] log-time-zone: ""
[2023-07-22 09:14:29] [config] logical-epoch:
[2023-07-22 09:14:29] [config]   - 1e
[2023-07-22 09:14:29] [config]   - 0
[2023-07-22 09:14:29] [config] lr-decay: 0
[2023-07-22 09:14:29] [config] lr-decay-freq: 50000
[2023-07-22 09:14:29] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:29] [config]   - 0
[2023-07-22 09:14:29] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:29] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:29] [config] lr-decay-start:
[2023-07-22 09:14:29] [config]   - 10
[2023-07-22 09:14:29] [config]   - 1
[2023-07-22 09:14:29] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:29] [config] lr-report: false
[2023-07-22 09:14:29] [config] lr-warmup: 0
[2023-07-22 09:14:29] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:29] [config] lr-warmup-cycle: false
[2023-07-22 09:14:29] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:29] [config] max-length: 50
[2023-07-22 09:14:29] [config] max-length-crop: true
[2023-07-22 09:14:29] [config] max-length-factor: 3
[2023-07-22 09:14:29] [config] maxi-batch: 100
[2023-07-22 09:14:29] [config] maxi-batch-sort: trg
[2023-07-22 09:14:29] [config] mini-batch: 64
[2023-07-22 09:14:29] [config] mini-batch-fit: true
[2023-07-22 09:14:29] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:29] [config] mini-batch-round-up: true
[2023-07-22 09:14:29] [config] mini-batch-track-lr: false
[2023-07-22 09:14:29] [config] mini-batch-warmup: 0
[2023-07-22 09:14:29] [config] mini-batch-words: 0
[2023-07-22 09:14:29] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:29] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:29] [config] multi-loss-type: sum
[2023-07-22 09:14:29] [config] n-best: false
[2023-07-22 09:14:29] [config] no-nccl: false
[2023-07-22 09:14:29] [config] no-reload: false
[2023-07-22 09:14:29] [config] no-restore-corpus: false
[2023-07-22 09:14:29] [config] normalize: 0
[2023-07-22 09:14:29] [config] normalize-gradient: false
[2023-07-22 09:14:29] [config] num-devices: 0
[2023-07-22 09:14:29] [config] optimizer: adam
[2023-07-22 09:14:29] [config] optimizer-delay: 1
[2023-07-22 09:14:29] [config] optimizer-params:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] output-omit-bias: false
[2023-07-22 09:14:29] [config] overwrite: true
[2023-07-22 09:14:29] [config] precision:
[2023-07-22 09:14:29] [config]   - float16
[2023-07-22 09:14:29] [config]   - float32
[2023-07-22 09:14:29] [config] pretrained-model: ""
[2023-07-22 09:14:29] [config] quantize-biases: false
[2023-07-22 09:14:29] [config] quantize-bits: 0
[2023-07-22 09:14:29] [config] quantize-log-based: false
[2023-07-22 09:14:29] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:29] [config] quiet: false
[2023-07-22 09:14:29] [config] quiet-translation: true
[2023-07-22 09:14:29] [config] relative-paths: false
[2023-07-22 09:14:29] [config] right-left: false
[2023-07-22 09:14:29] [config] save-freq: 10000u
[2023-07-22 09:14:29] [config] seed: 1234
[2023-07-22 09:14:29] [config] sentencepiece-alphas:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:29] [config] sentencepiece-options: ""
[2023-07-22 09:14:29] [config] sharding: global
[2023-07-22 09:14:29] [config] shuffle: data
[2023-07-22 09:14:29] [config] shuffle-in-ram: false
[2023-07-22 09:14:29] [config] sigterm: save-and-exit
[2023-07-22 09:14:29] [config] skip: false
[2023-07-22 09:14:29] [config] sqlite: ""
[2023-07-22 09:14:29] [config] sqlite-drop: false
[2023-07-22 09:14:29] [config] sync-freq: 200u
[2023-07-22 09:14:29] [config] sync-sgd: false
[2023-07-22 09:14:29] [config] tempdir: /tmp
[2023-07-22 09:14:29] [config] tied-embeddings: false
[2023-07-22 09:14:29] [config] tied-embeddings-all: true
[2023-07-22 09:14:29] [config] tied-embeddings-src: false
[2023-07-22 09:14:29] [config] train-embedder-rank:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] train-sets:
[2023-07-22 09:14:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:29] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:29] [config] transformer-aan-activation: swish
[2023-07-22 09:14:29] [config] transformer-aan-depth: 2
[2023-07-22 09:14:29] [config] transformer-aan-nogate: false
[2023-07-22 09:14:29] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:29] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:29] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:29] [config] transformer-depth-scaling: false
[2023-07-22 09:14:29] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:29] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:29] [config] transformer-dropout: 0
[2023-07-22 09:14:29] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:29] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:29] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:29] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:29] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:29] [config] transformer-heads: 8
[2023-07-22 09:14:29] [config] transformer-no-projection: false
[2023-07-22 09:14:29] [config] transformer-pool: false
[2023-07-22 09:14:29] [config] transformer-postprocess: dan
[2023-07-22 09:14:29] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:29] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:29] [config] transformer-preprocess: ""
[2023-07-22 09:14:29] [config] transformer-tied-layers:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:29] [config] tsv: false
[2023-07-22 09:14:29] [config] tsv-fields: 0
[2023-07-22 09:14:29] [config] type: amun
[2023-07-22 09:14:29] [config] ulr: false
[2023-07-22 09:14:29] [config] ulr-dim-emb: 0
[2023-07-22 09:14:29] [config] ulr-dropout: 0
[2023-07-22 09:14:29] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:29] [config] ulr-query-vectors: ""
[2023-07-22 09:14:29] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:29] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:29] [config] unlikelihood-loss: false
[2023-07-22 09:14:29] [config] valid-freq: 50000000
[2023-07-22 09:14:29] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:29] [config] valid-max-length: 1000
[2023-07-22 09:14:29] [config] valid-metrics:
[2023-07-22 09:14:29] [config]   - cross-entropy
[2023-07-22 09:14:29] [config]   - translation
[2023-07-22 09:14:29] [config] valid-mini-batch: 32
[2023-07-22 09:14:29] [config] valid-reset-stalled: false
[2023-07-22 09:14:29] [config] valid-script-args:
[2023-07-22 09:14:29] [config]   []
[2023-07-22 09:14:29] [config] valid-script-path: ""
[2023-07-22 09:14:29] [config] valid-sets:
[2023-07-22 09:14:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:29] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:29] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:29] [config] vocabs:
[2023-07-22 09:14:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:29] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:29] [config] word-penalty: 0
[2023-07-22 09:14:29] [config] word-scores: false
[2023-07-22 09:14:29] [config] workspace: 5500
[2023-07-22 09:14:29] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:29] [training] Using single-device training
[2023-07-22 09:14:29] Synced seed 1234
[2023-07-22 09:14:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:31] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:31] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x5594b16d8141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x5594b161ada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5594b161f1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5594b16262ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5594b17d2a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5594b17d3a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5594b17acbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5594b12ae108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5594b11d02c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5594b1187b9c]    main                                               + 0x3c
[0x7fc2e50c40b3]    __libc_start_main                                  + 0xf3
[0x5594b11cecbe]    _start                                             + 0x2e

[2023-07-22 09:14:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:34] [marian] Running on node23.datos.cluster.uy as process 27264 with command line:
[2023-07-22 09:14:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:34] [config] after: 0e
[2023-07-22 09:14:34] [config] after-batches: 0
[2023-07-22 09:14:34] [config] after-epochs: 120
[2023-07-22 09:14:34] [config] all-caps-every: 0
[2023-07-22 09:14:34] [config] allow-unk: false
[2023-07-22 09:14:34] [config] authors: false
[2023-07-22 09:14:34] [config] beam-size: 12
[2023-07-22 09:14:34] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:34] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:34] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:34] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:34] [config] build-info: ""
[2023-07-22 09:14:34] [config] check-gradient-nan: false
[2023-07-22 09:14:34] [config] check-nan: false
[2023-07-22 09:14:34] [config] cite: false
[2023-07-22 09:14:34] [config] clip-norm: 1
[2023-07-22 09:14:34] [config] cost-scaling:
[2023-07-22 09:14:34] [config]   - 256.f
[2023-07-22 09:14:34] [config]   - 1000
[2023-07-22 09:14:34] [config]   - 2.f
[2023-07-22 09:14:34] [config]   - 256.f
[2023-07-22 09:14:34] [config] cost-type: ce-sum
[2023-07-22 09:14:34] [config] cpu-threads: 0
[2023-07-22 09:14:34] [config] data-threads: 8
[2023-07-22 09:14:34] [config] data-weighting: ""
[2023-07-22 09:14:34] [config] data-weighting-type: sentence
[2023-07-22 09:14:34] [config] dec-cell: gru
[2023-07-22 09:14:34] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:34] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:34] [config] dec-depth: 2
[2023-07-22 09:14:34] [config] devices:
[2023-07-22 09:14:34] [config]   - 0
[2023-07-22 09:14:34] [config] dim-emb: 512
[2023-07-22 09:14:34] [config] dim-rnn: 1024
[2023-07-22 09:14:34] [config] dim-vocabs:
[2023-07-22 09:14:34] [config]   - 16384
[2023-07-22 09:14:34] [config]   - 16384
[2023-07-22 09:14:34] [config] disp-first: 0
[2023-07-22 09:14:34] [config] disp-freq: 1000u
[2023-07-22 09:14:34] [config] disp-label-counts: true
[2023-07-22 09:14:34] [config] dropout-rnn: 0
[2023-07-22 09:14:34] [config] dropout-src: 0
[2023-07-22 09:14:34] [config] dropout-trg: 0
[2023-07-22 09:14:34] [config] dump-config: ""
[2023-07-22 09:14:34] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] early-stopping: 200
[2023-07-22 09:14:34] [config] early-stopping-on: first
[2023-07-22 09:14:34] [config] embedding-fix-src: false
[2023-07-22 09:14:34] [config] embedding-fix-trg: false
[2023-07-22 09:14:34] [config] embedding-normalization: false
[2023-07-22 09:14:34] [config] embedding-vectors:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] enc-cell: gru
[2023-07-22 09:14:34] [config] enc-cell-depth: 1
[2023-07-22 09:14:34] [config] enc-depth: 2
[2023-07-22 09:14:34] [config] enc-type: bidirectional
[2023-07-22 09:14:34] [config] english-title-case-every: 0
[2023-07-22 09:14:34] [config] exponential-smoothing: 0
[2023-07-22 09:14:34] [config] factor-weight: 1
[2023-07-22 09:14:34] [config] factors-combine: sum
[2023-07-22 09:14:34] [config] factors-dim-emb: 0
[2023-07-22 09:14:34] [config] gradient-checkpointing: false
[2023-07-22 09:14:34] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:34] [config] guided-alignment: none
[2023-07-22 09:14:34] [config] guided-alignment-cost: mse
[2023-07-22 09:14:34] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:34] [config] ignore-model-config: false
[2023-07-22 09:14:34] [config] input-types:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] interpolate-env-vars: false
[2023-07-22 09:14:34] [config] keep-best: false
[2023-07-22 09:14:34] [config] label-smoothing: 0
[2023-07-22 09:14:34] [config] layer-normalization: false
[2023-07-22 09:14:34] [config] learn-rate: 0.0001
[2023-07-22 09:14:34] [config] lemma-dependency: ""
[2023-07-22 09:14:34] [config] lemma-dim-emb: 0
[2023-07-22 09:14:34] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:34] [config] log-level: info
[2023-07-22 09:14:34] [config] log-time-zone: ""
[2023-07-22 09:14:34] [config] logical-epoch:
[2023-07-22 09:14:34] [config]   - 1e
[2023-07-22 09:14:34] [config]   - 0
[2023-07-22 09:14:34] [config] lr-decay: 0
[2023-07-22 09:14:34] [config] lr-decay-freq: 50000
[2023-07-22 09:14:34] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:34] [config]   - 0
[2023-07-22 09:14:34] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:34] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:34] [config] lr-decay-start:
[2023-07-22 09:14:34] [config]   - 10
[2023-07-22 09:14:34] [config]   - 1
[2023-07-22 09:14:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:34] [config] lr-report: false
[2023-07-22 09:14:34] [config] lr-warmup: 0
[2023-07-22 09:14:34] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:34] [config] lr-warmup-cycle: false
[2023-07-22 09:14:34] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:34] [config] max-length: 50
[2023-07-22 09:14:34] [config] max-length-crop: true
[2023-07-22 09:14:34] [config] max-length-factor: 3
[2023-07-22 09:14:34] [config] maxi-batch: 100
[2023-07-22 09:14:34] [config] maxi-batch-sort: trg
[2023-07-22 09:14:34] [config] mini-batch: 64
[2023-07-22 09:14:34] [config] mini-batch-fit: true
[2023-07-22 09:14:34] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:34] [config] mini-batch-round-up: true
[2023-07-22 09:14:34] [config] mini-batch-track-lr: false
[2023-07-22 09:14:34] [config] mini-batch-warmup: 0
[2023-07-22 09:14:34] [config] mini-batch-words: 0
[2023-07-22 09:14:34] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:34] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:34] [config] multi-loss-type: sum
[2023-07-22 09:14:34] [config] n-best: false
[2023-07-22 09:14:34] [config] no-nccl: false
[2023-07-22 09:14:34] [config] no-reload: false
[2023-07-22 09:14:34] [config] no-restore-corpus: false
[2023-07-22 09:14:34] [config] normalize: 0
[2023-07-22 09:14:34] [config] normalize-gradient: false
[2023-07-22 09:14:34] [config] num-devices: 0
[2023-07-22 09:14:34] [config] optimizer: adam
[2023-07-22 09:14:34] [config] optimizer-delay: 1
[2023-07-22 09:14:34] [config] optimizer-params:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] output-omit-bias: false
[2023-07-22 09:14:34] [config] overwrite: true
[2023-07-22 09:14:34] [config] precision:
[2023-07-22 09:14:34] [config]   - float16
[2023-07-22 09:14:34] [config]   - float32
[2023-07-22 09:14:34] [config] pretrained-model: ""
[2023-07-22 09:14:34] [config] quantize-biases: false
[2023-07-22 09:14:34] [config] quantize-bits: 0
[2023-07-22 09:14:34] [config] quantize-log-based: false
[2023-07-22 09:14:34] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:34] [config] quiet: false
[2023-07-22 09:14:34] [config] quiet-translation: true
[2023-07-22 09:14:34] [config] relative-paths: false
[2023-07-22 09:14:34] [config] right-left: false
[2023-07-22 09:14:34] [config] save-freq: 10000u
[2023-07-22 09:14:34] [config] seed: 1234
[2023-07-22 09:14:34] [config] sentencepiece-alphas:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:34] [config] sentencepiece-options: ""
[2023-07-22 09:14:34] [config] sharding: global
[2023-07-22 09:14:34] [config] shuffle: data
[2023-07-22 09:14:34] [config] shuffle-in-ram: false
[2023-07-22 09:14:34] [config] sigterm: save-and-exit
[2023-07-22 09:14:34] [config] skip: false
[2023-07-22 09:14:34] [config] sqlite: ""
[2023-07-22 09:14:34] [config] sqlite-drop: false
[2023-07-22 09:14:34] [config] sync-freq: 200u
[2023-07-22 09:14:34] [config] sync-sgd: false
[2023-07-22 09:14:34] [config] tempdir: /tmp
[2023-07-22 09:14:34] [config] tied-embeddings: false
[2023-07-22 09:14:34] [config] tied-embeddings-all: true
[2023-07-22 09:14:34] [config] tied-embeddings-src: false
[2023-07-22 09:14:34] [config] train-embedder-rank:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] train-sets:
[2023-07-22 09:14:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:34] [config] transformer-aan-activation: swish
[2023-07-22 09:14:34] [config] transformer-aan-depth: 2
[2023-07-22 09:14:34] [config] transformer-aan-nogate: false
[2023-07-22 09:14:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:34] [config] transformer-depth-scaling: false
[2023-07-22 09:14:34] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:34] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:34] [config] transformer-dropout: 0
[2023-07-22 09:14:34] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:34] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:34] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:34] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:34] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:34] [config] transformer-heads: 8
[2023-07-22 09:14:34] [config] transformer-no-projection: false
[2023-07-22 09:14:34] [config] transformer-pool: false
[2023-07-22 09:14:34] [config] transformer-postprocess: dan
[2023-07-22 09:14:34] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:34] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:34] [config] transformer-preprocess: ""
[2023-07-22 09:14:34] [config] transformer-tied-layers:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:34] [config] tsv: false
[2023-07-22 09:14:34] [config] tsv-fields: 0
[2023-07-22 09:14:34] [config] type: amun
[2023-07-22 09:14:34] [config] ulr: false
[2023-07-22 09:14:34] [config] ulr-dim-emb: 0
[2023-07-22 09:14:34] [config] ulr-dropout: 0
[2023-07-22 09:14:34] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:34] [config] ulr-query-vectors: ""
[2023-07-22 09:14:34] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:34] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:34] [config] unlikelihood-loss: false
[2023-07-22 09:14:34] [config] valid-freq: 50000000
[2023-07-22 09:14:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:34] [config] valid-max-length: 1000
[2023-07-22 09:14:34] [config] valid-metrics:
[2023-07-22 09:14:34] [config]   - cross-entropy
[2023-07-22 09:14:34] [config]   - translation
[2023-07-22 09:14:34] [config] valid-mini-batch: 32
[2023-07-22 09:14:34] [config] valid-reset-stalled: false
[2023-07-22 09:14:34] [config] valid-script-args:
[2023-07-22 09:14:34] [config]   []
[2023-07-22 09:14:34] [config] valid-script-path: ""
[2023-07-22 09:14:34] [config] valid-sets:
[2023-07-22 09:14:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:34] [config] vocabs:
[2023-07-22 09:14:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:34] [config] word-penalty: 0
[2023-07-22 09:14:34] [config] word-scores: false
[2023-07-22 09:14:34] [config] workspace: 5500
[2023-07-22 09:14:34] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:34] [training] Using single-device training
[2023-07-22 09:14:34] Synced seed 1234
[2023-07-22 09:14:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:34] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:35] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:35] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55bd7591c141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55bd7585eda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55bd758631a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55bd7586a2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55bd75a16a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55bd75a17a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55bd759f0bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55bd754f2108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55bd754142c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55bd753cbb9c]    main                                               + 0x3c
[0x7f43b09cf0b3]    __libc_start_main                                  + 0xf3
[0x55bd75412cbe]    _start                                             + 0x2e

[2023-07-22 09:14:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:38] [marian] Running on node23.datos.cluster.uy as process 27291 with command line:
[2023-07-22 09:14:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:38] [config] after: 0e
[2023-07-22 09:14:38] [config] after-batches: 0
[2023-07-22 09:14:38] [config] after-epochs: 130
[2023-07-22 09:14:38] [config] all-caps-every: 0
[2023-07-22 09:14:38] [config] allow-unk: false
[2023-07-22 09:14:38] [config] authors: false
[2023-07-22 09:14:38] [config] beam-size: 12
[2023-07-22 09:14:38] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:38] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:38] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:38] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:38] [config] build-info: ""
[2023-07-22 09:14:38] [config] check-gradient-nan: false
[2023-07-22 09:14:38] [config] check-nan: false
[2023-07-22 09:14:38] [config] cite: false
[2023-07-22 09:14:38] [config] clip-norm: 1
[2023-07-22 09:14:38] [config] cost-scaling:
[2023-07-22 09:14:38] [config]   - 256.f
[2023-07-22 09:14:38] [config]   - 1000
[2023-07-22 09:14:38] [config]   - 2.f
[2023-07-22 09:14:38] [config]   - 256.f
[2023-07-22 09:14:38] [config] cost-type: ce-sum
[2023-07-22 09:14:38] [config] cpu-threads: 0
[2023-07-22 09:14:38] [config] data-threads: 8
[2023-07-22 09:14:38] [config] data-weighting: ""
[2023-07-22 09:14:38] [config] data-weighting-type: sentence
[2023-07-22 09:14:38] [config] dec-cell: gru
[2023-07-22 09:14:38] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:38] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:38] [config] dec-depth: 2
[2023-07-22 09:14:38] [config] devices:
[2023-07-22 09:14:38] [config]   - 0
[2023-07-22 09:14:38] [config] dim-emb: 512
[2023-07-22 09:14:38] [config] dim-rnn: 1024
[2023-07-22 09:14:38] [config] dim-vocabs:
[2023-07-22 09:14:38] [config]   - 16384
[2023-07-22 09:14:38] [config]   - 16384
[2023-07-22 09:14:38] [config] disp-first: 0
[2023-07-22 09:14:38] [config] disp-freq: 1000u
[2023-07-22 09:14:38] [config] disp-label-counts: true
[2023-07-22 09:14:38] [config] dropout-rnn: 0
[2023-07-22 09:14:38] [config] dropout-src: 0
[2023-07-22 09:14:38] [config] dropout-trg: 0
[2023-07-22 09:14:38] [config] dump-config: ""
[2023-07-22 09:14:38] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] early-stopping: 200
[2023-07-22 09:14:38] [config] early-stopping-on: first
[2023-07-22 09:14:38] [config] embedding-fix-src: false
[2023-07-22 09:14:38] [config] embedding-fix-trg: false
[2023-07-22 09:14:38] [config] embedding-normalization: false
[2023-07-22 09:14:38] [config] embedding-vectors:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] enc-cell: gru
[2023-07-22 09:14:38] [config] enc-cell-depth: 1
[2023-07-22 09:14:38] [config] enc-depth: 2
[2023-07-22 09:14:38] [config] enc-type: bidirectional
[2023-07-22 09:14:38] [config] english-title-case-every: 0
[2023-07-22 09:14:38] [config] exponential-smoothing: 0
[2023-07-22 09:14:38] [config] factor-weight: 1
[2023-07-22 09:14:38] [config] factors-combine: sum
[2023-07-22 09:14:38] [config] factors-dim-emb: 0
[2023-07-22 09:14:38] [config] gradient-checkpointing: false
[2023-07-22 09:14:38] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:38] [config] guided-alignment: none
[2023-07-22 09:14:38] [config] guided-alignment-cost: mse
[2023-07-22 09:14:38] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:38] [config] ignore-model-config: false
[2023-07-22 09:14:38] [config] input-types:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] interpolate-env-vars: false
[2023-07-22 09:14:38] [config] keep-best: false
[2023-07-22 09:14:38] [config] label-smoothing: 0
[2023-07-22 09:14:38] [config] layer-normalization: false
[2023-07-22 09:14:38] [config] learn-rate: 0.0001
[2023-07-22 09:14:38] [config] lemma-dependency: ""
[2023-07-22 09:14:38] [config] lemma-dim-emb: 0
[2023-07-22 09:14:38] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:38] [config] log-level: info
[2023-07-22 09:14:38] [config] log-time-zone: ""
[2023-07-22 09:14:38] [config] logical-epoch:
[2023-07-22 09:14:38] [config]   - 1e
[2023-07-22 09:14:38] [config]   - 0
[2023-07-22 09:14:38] [config] lr-decay: 0
[2023-07-22 09:14:38] [config] lr-decay-freq: 50000
[2023-07-22 09:14:38] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:38] [config]   - 0
[2023-07-22 09:14:38] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:38] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:38] [config] lr-decay-start:
[2023-07-22 09:14:38] [config]   - 10
[2023-07-22 09:14:38] [config]   - 1
[2023-07-22 09:14:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:38] [config] lr-report: false
[2023-07-22 09:14:38] [config] lr-warmup: 0
[2023-07-22 09:14:38] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:38] [config] lr-warmup-cycle: false
[2023-07-22 09:14:38] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:38] [config] max-length: 50
[2023-07-22 09:14:38] [config] max-length-crop: true
[2023-07-22 09:14:38] [config] max-length-factor: 3
[2023-07-22 09:14:38] [config] maxi-batch: 100
[2023-07-22 09:14:38] [config] maxi-batch-sort: trg
[2023-07-22 09:14:38] [config] mini-batch: 64
[2023-07-22 09:14:38] [config] mini-batch-fit: true
[2023-07-22 09:14:38] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:38] [config] mini-batch-round-up: true
[2023-07-22 09:14:38] [config] mini-batch-track-lr: false
[2023-07-22 09:14:38] [config] mini-batch-warmup: 0
[2023-07-22 09:14:38] [config] mini-batch-words: 0
[2023-07-22 09:14:38] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:38] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:38] [config] multi-loss-type: sum
[2023-07-22 09:14:38] [config] n-best: false
[2023-07-22 09:14:38] [config] no-nccl: false
[2023-07-22 09:14:38] [config] no-reload: false
[2023-07-22 09:14:38] [config] no-restore-corpus: false
[2023-07-22 09:14:38] [config] normalize: 0
[2023-07-22 09:14:38] [config] normalize-gradient: false
[2023-07-22 09:14:38] [config] num-devices: 0
[2023-07-22 09:14:38] [config] optimizer: adam
[2023-07-22 09:14:38] [config] optimizer-delay: 1
[2023-07-22 09:14:38] [config] optimizer-params:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] output-omit-bias: false
[2023-07-22 09:14:38] [config] overwrite: true
[2023-07-22 09:14:38] [config] precision:
[2023-07-22 09:14:38] [config]   - float16
[2023-07-22 09:14:38] [config]   - float32
[2023-07-22 09:14:38] [config] pretrained-model: ""
[2023-07-22 09:14:38] [config] quantize-biases: false
[2023-07-22 09:14:38] [config] quantize-bits: 0
[2023-07-22 09:14:38] [config] quantize-log-based: false
[2023-07-22 09:14:38] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:38] [config] quiet: false
[2023-07-22 09:14:38] [config] quiet-translation: true
[2023-07-22 09:14:38] [config] relative-paths: false
[2023-07-22 09:14:38] [config] right-left: false
[2023-07-22 09:14:38] [config] save-freq: 10000u
[2023-07-22 09:14:38] [config] seed: 1234
[2023-07-22 09:14:38] [config] sentencepiece-alphas:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:38] [config] sentencepiece-options: ""
[2023-07-22 09:14:38] [config] sharding: global
[2023-07-22 09:14:38] [config] shuffle: data
[2023-07-22 09:14:38] [config] shuffle-in-ram: false
[2023-07-22 09:14:38] [config] sigterm: save-and-exit
[2023-07-22 09:14:38] [config] skip: false
[2023-07-22 09:14:38] [config] sqlite: ""
[2023-07-22 09:14:38] [config] sqlite-drop: false
[2023-07-22 09:14:38] [config] sync-freq: 200u
[2023-07-22 09:14:38] [config] sync-sgd: false
[2023-07-22 09:14:38] [config] tempdir: /tmp
[2023-07-22 09:14:38] [config] tied-embeddings: false
[2023-07-22 09:14:38] [config] tied-embeddings-all: true
[2023-07-22 09:14:38] [config] tied-embeddings-src: false
[2023-07-22 09:14:38] [config] train-embedder-rank:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] train-sets:
[2023-07-22 09:14:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:38] [config] transformer-aan-activation: swish
[2023-07-22 09:14:38] [config] transformer-aan-depth: 2
[2023-07-22 09:14:38] [config] transformer-aan-nogate: false
[2023-07-22 09:14:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:38] [config] transformer-depth-scaling: false
[2023-07-22 09:14:38] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:38] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:38] [config] transformer-dropout: 0
[2023-07-22 09:14:38] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:38] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:38] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:38] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:38] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:38] [config] transformer-heads: 8
[2023-07-22 09:14:38] [config] transformer-no-projection: false
[2023-07-22 09:14:38] [config] transformer-pool: false
[2023-07-22 09:14:38] [config] transformer-postprocess: dan
[2023-07-22 09:14:38] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:38] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:38] [config] transformer-preprocess: ""
[2023-07-22 09:14:38] [config] transformer-tied-layers:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:38] [config] tsv: false
[2023-07-22 09:14:38] [config] tsv-fields: 0
[2023-07-22 09:14:38] [config] type: amun
[2023-07-22 09:14:38] [config] ulr: false
[2023-07-22 09:14:38] [config] ulr-dim-emb: 0
[2023-07-22 09:14:38] [config] ulr-dropout: 0
[2023-07-22 09:14:38] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:38] [config] ulr-query-vectors: ""
[2023-07-22 09:14:38] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:38] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:38] [config] unlikelihood-loss: false
[2023-07-22 09:14:38] [config] valid-freq: 50000000
[2023-07-22 09:14:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:38] [config] valid-max-length: 1000
[2023-07-22 09:14:38] [config] valid-metrics:
[2023-07-22 09:14:38] [config]   - cross-entropy
[2023-07-22 09:14:38] [config]   - translation
[2023-07-22 09:14:38] [config] valid-mini-batch: 32
[2023-07-22 09:14:38] [config] valid-reset-stalled: false
[2023-07-22 09:14:38] [config] valid-script-args:
[2023-07-22 09:14:38] [config]   []
[2023-07-22 09:14:38] [config] valid-script-path: ""
[2023-07-22 09:14:38] [config] valid-sets:
[2023-07-22 09:14:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:38] [config] vocabs:
[2023-07-22 09:14:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:38] [config] word-penalty: 0
[2023-07-22 09:14:38] [config] word-scores: false
[2023-07-22 09:14:38] [config] workspace: 5500
[2023-07-22 09:14:38] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:38] [training] Using single-device training
[2023-07-22 09:14:39] Synced seed 1234
[2023-07-22 09:14:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:40] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:40] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x5628eab5c141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x5628eaa9eda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5628eaaa31a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5628eaaaa2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5628eac56a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5628eac57a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5628eac30bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5628ea732108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5628ea6542c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5628ea60bb9c]    main                                               + 0x3c
[0x7f8b0c67c0b3]    __libc_start_main                                  + 0xf3
[0x5628ea652cbe]    _start                                             + 0x2e

[2023-07-22 09:14:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:43] [marian] Running on node23.datos.cluster.uy as process 27318 with command line:
[2023-07-22 09:14:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:43] [config] after: 0e
[2023-07-22 09:14:43] [config] after-batches: 0
[2023-07-22 09:14:43] [config] after-epochs: 140
[2023-07-22 09:14:43] [config] all-caps-every: 0
[2023-07-22 09:14:43] [config] allow-unk: false
[2023-07-22 09:14:43] [config] authors: false
[2023-07-22 09:14:43] [config] beam-size: 12
[2023-07-22 09:14:43] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:43] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:43] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:43] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:43] [config] build-info: ""
[2023-07-22 09:14:43] [config] check-gradient-nan: false
[2023-07-22 09:14:43] [config] check-nan: false
[2023-07-22 09:14:43] [config] cite: false
[2023-07-22 09:14:43] [config] clip-norm: 1
[2023-07-22 09:14:43] [config] cost-scaling:
[2023-07-22 09:14:43] [config]   - 256.f
[2023-07-22 09:14:43] [config]   - 1000
[2023-07-22 09:14:43] [config]   - 2.f
[2023-07-22 09:14:43] [config]   - 256.f
[2023-07-22 09:14:43] [config] cost-type: ce-sum
[2023-07-22 09:14:43] [config] cpu-threads: 0
[2023-07-22 09:14:43] [config] data-threads: 8
[2023-07-22 09:14:43] [config] data-weighting: ""
[2023-07-22 09:14:43] [config] data-weighting-type: sentence
[2023-07-22 09:14:43] [config] dec-cell: gru
[2023-07-22 09:14:43] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:43] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:43] [config] dec-depth: 2
[2023-07-22 09:14:43] [config] devices:
[2023-07-22 09:14:43] [config]   - 0
[2023-07-22 09:14:43] [config] dim-emb: 512
[2023-07-22 09:14:43] [config] dim-rnn: 1024
[2023-07-22 09:14:43] [config] dim-vocabs:
[2023-07-22 09:14:43] [config]   - 16384
[2023-07-22 09:14:43] [config]   - 16384
[2023-07-22 09:14:43] [config] disp-first: 0
[2023-07-22 09:14:43] [config] disp-freq: 1000u
[2023-07-22 09:14:43] [config] disp-label-counts: true
[2023-07-22 09:14:43] [config] dropout-rnn: 0
[2023-07-22 09:14:43] [config] dropout-src: 0
[2023-07-22 09:14:43] [config] dropout-trg: 0
[2023-07-22 09:14:43] [config] dump-config: ""
[2023-07-22 09:14:43] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] early-stopping: 200
[2023-07-22 09:14:43] [config] early-stopping-on: first
[2023-07-22 09:14:43] [config] embedding-fix-src: false
[2023-07-22 09:14:43] [config] embedding-fix-trg: false
[2023-07-22 09:14:43] [config] embedding-normalization: false
[2023-07-22 09:14:43] [config] embedding-vectors:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] enc-cell: gru
[2023-07-22 09:14:43] [config] enc-cell-depth: 1
[2023-07-22 09:14:43] [config] enc-depth: 2
[2023-07-22 09:14:43] [config] enc-type: bidirectional
[2023-07-22 09:14:43] [config] english-title-case-every: 0
[2023-07-22 09:14:43] [config] exponential-smoothing: 0
[2023-07-22 09:14:43] [config] factor-weight: 1
[2023-07-22 09:14:43] [config] factors-combine: sum
[2023-07-22 09:14:43] [config] factors-dim-emb: 0
[2023-07-22 09:14:43] [config] gradient-checkpointing: false
[2023-07-22 09:14:43] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:43] [config] guided-alignment: none
[2023-07-22 09:14:43] [config] guided-alignment-cost: mse
[2023-07-22 09:14:43] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:43] [config] ignore-model-config: false
[2023-07-22 09:14:43] [config] input-types:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] interpolate-env-vars: false
[2023-07-22 09:14:43] [config] keep-best: false
[2023-07-22 09:14:43] [config] label-smoothing: 0
[2023-07-22 09:14:43] [config] layer-normalization: false
[2023-07-22 09:14:43] [config] learn-rate: 0.0001
[2023-07-22 09:14:43] [config] lemma-dependency: ""
[2023-07-22 09:14:43] [config] lemma-dim-emb: 0
[2023-07-22 09:14:43] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:43] [config] log-level: info
[2023-07-22 09:14:43] [config] log-time-zone: ""
[2023-07-22 09:14:43] [config] logical-epoch:
[2023-07-22 09:14:43] [config]   - 1e
[2023-07-22 09:14:43] [config]   - 0
[2023-07-22 09:14:43] [config] lr-decay: 0
[2023-07-22 09:14:43] [config] lr-decay-freq: 50000
[2023-07-22 09:14:43] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:43] [config]   - 0
[2023-07-22 09:14:43] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:43] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:43] [config] lr-decay-start:
[2023-07-22 09:14:43] [config]   - 10
[2023-07-22 09:14:43] [config]   - 1
[2023-07-22 09:14:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:43] [config] lr-report: false
[2023-07-22 09:14:43] [config] lr-warmup: 0
[2023-07-22 09:14:43] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:43] [config] lr-warmup-cycle: false
[2023-07-22 09:14:43] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:43] [config] max-length: 50
[2023-07-22 09:14:43] [config] max-length-crop: true
[2023-07-22 09:14:43] [config] max-length-factor: 3
[2023-07-22 09:14:43] [config] maxi-batch: 100
[2023-07-22 09:14:43] [config] maxi-batch-sort: trg
[2023-07-22 09:14:43] [config] mini-batch: 64
[2023-07-22 09:14:43] [config] mini-batch-fit: true
[2023-07-22 09:14:43] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:43] [config] mini-batch-round-up: true
[2023-07-22 09:14:43] [config] mini-batch-track-lr: false
[2023-07-22 09:14:43] [config] mini-batch-warmup: 0
[2023-07-22 09:14:43] [config] mini-batch-words: 0
[2023-07-22 09:14:43] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:43] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:43] [config] multi-loss-type: sum
[2023-07-22 09:14:43] [config] n-best: false
[2023-07-22 09:14:43] [config] no-nccl: false
[2023-07-22 09:14:43] [config] no-reload: false
[2023-07-22 09:14:43] [config] no-restore-corpus: false
[2023-07-22 09:14:43] [config] normalize: 0
[2023-07-22 09:14:43] [config] normalize-gradient: false
[2023-07-22 09:14:43] [config] num-devices: 0
[2023-07-22 09:14:43] [config] optimizer: adam
[2023-07-22 09:14:43] [config] optimizer-delay: 1
[2023-07-22 09:14:43] [config] optimizer-params:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] output-omit-bias: false
[2023-07-22 09:14:43] [config] overwrite: true
[2023-07-22 09:14:43] [config] precision:
[2023-07-22 09:14:43] [config]   - float16
[2023-07-22 09:14:43] [config]   - float32
[2023-07-22 09:14:43] [config] pretrained-model: ""
[2023-07-22 09:14:43] [config] quantize-biases: false
[2023-07-22 09:14:43] [config] quantize-bits: 0
[2023-07-22 09:14:43] [config] quantize-log-based: false
[2023-07-22 09:14:43] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:43] [config] quiet: false
[2023-07-22 09:14:43] [config] quiet-translation: true
[2023-07-22 09:14:43] [config] relative-paths: false
[2023-07-22 09:14:43] [config] right-left: false
[2023-07-22 09:14:43] [config] save-freq: 10000u
[2023-07-22 09:14:43] [config] seed: 1234
[2023-07-22 09:14:43] [config] sentencepiece-alphas:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:43] [config] sentencepiece-options: ""
[2023-07-22 09:14:43] [config] sharding: global
[2023-07-22 09:14:43] [config] shuffle: data
[2023-07-22 09:14:43] [config] shuffle-in-ram: false
[2023-07-22 09:14:43] [config] sigterm: save-and-exit
[2023-07-22 09:14:43] [config] skip: false
[2023-07-22 09:14:43] [config] sqlite: ""
[2023-07-22 09:14:43] [config] sqlite-drop: false
[2023-07-22 09:14:43] [config] sync-freq: 200u
[2023-07-22 09:14:43] [config] sync-sgd: false
[2023-07-22 09:14:43] [config] tempdir: /tmp
[2023-07-22 09:14:43] [config] tied-embeddings: false
[2023-07-22 09:14:43] [config] tied-embeddings-all: true
[2023-07-22 09:14:43] [config] tied-embeddings-src: false
[2023-07-22 09:14:43] [config] train-embedder-rank:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] train-sets:
[2023-07-22 09:14:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:43] [config] transformer-aan-activation: swish
[2023-07-22 09:14:43] [config] transformer-aan-depth: 2
[2023-07-22 09:14:43] [config] transformer-aan-nogate: false
[2023-07-22 09:14:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:43] [config] transformer-depth-scaling: false
[2023-07-22 09:14:43] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:43] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:43] [config] transformer-dropout: 0
[2023-07-22 09:14:43] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:43] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:43] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:43] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:43] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:43] [config] transformer-heads: 8
[2023-07-22 09:14:43] [config] transformer-no-projection: false
[2023-07-22 09:14:43] [config] transformer-pool: false
[2023-07-22 09:14:43] [config] transformer-postprocess: dan
[2023-07-22 09:14:43] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:43] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:43] [config] transformer-preprocess: ""
[2023-07-22 09:14:43] [config] transformer-tied-layers:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:43] [config] tsv: false
[2023-07-22 09:14:43] [config] tsv-fields: 0
[2023-07-22 09:14:43] [config] type: amun
[2023-07-22 09:14:43] [config] ulr: false
[2023-07-22 09:14:43] [config] ulr-dim-emb: 0
[2023-07-22 09:14:43] [config] ulr-dropout: 0
[2023-07-22 09:14:43] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:43] [config] ulr-query-vectors: ""
[2023-07-22 09:14:43] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:43] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:43] [config] unlikelihood-loss: false
[2023-07-22 09:14:43] [config] valid-freq: 50000000
[2023-07-22 09:14:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:43] [config] valid-max-length: 1000
[2023-07-22 09:14:43] [config] valid-metrics:
[2023-07-22 09:14:43] [config]   - cross-entropy
[2023-07-22 09:14:43] [config]   - translation
[2023-07-22 09:14:43] [config] valid-mini-batch: 32
[2023-07-22 09:14:43] [config] valid-reset-stalled: false
[2023-07-22 09:14:43] [config] valid-script-args:
[2023-07-22 09:14:43] [config]   []
[2023-07-22 09:14:43] [config] valid-script-path: ""
[2023-07-22 09:14:43] [config] valid-sets:
[2023-07-22 09:14:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:43] [config] vocabs:
[2023-07-22 09:14:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:43] [config] word-penalty: 0
[2023-07-22 09:14:43] [config] word-scores: false
[2023-07-22 09:14:43] [config] workspace: 5500
[2023-07-22 09:14:43] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:43] [training] Using single-device training
[2023-07-22 09:14:43] Synced seed 1234
[2023-07-22 09:14:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:45] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:45] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x556998579141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x5569984bbda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5569984c01a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5569984c72ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x556998673a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x556998674a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55699864dbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55699814f108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5569980712c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556998028b9c]    main                                               + 0x3c
[0x7fd7eb78f0b3]    __libc_start_main                                  + 0xf3
[0x55699806fcbe]    _start                                             + 0x2e

[2023-07-22 09:14:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:48] [marian] Running on node23.datos.cluster.uy as process 27345 with command line:
[2023-07-22 09:14:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:48] [config] after: 0e
[2023-07-22 09:14:48] [config] after-batches: 0
[2023-07-22 09:14:48] [config] after-epochs: 150
[2023-07-22 09:14:48] [config] all-caps-every: 0
[2023-07-22 09:14:48] [config] allow-unk: false
[2023-07-22 09:14:48] [config] authors: false
[2023-07-22 09:14:48] [config] beam-size: 12
[2023-07-22 09:14:48] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:48] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:48] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:48] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:48] [config] build-info: ""
[2023-07-22 09:14:48] [config] check-gradient-nan: false
[2023-07-22 09:14:48] [config] check-nan: false
[2023-07-22 09:14:48] [config] cite: false
[2023-07-22 09:14:48] [config] clip-norm: 1
[2023-07-22 09:14:48] [config] cost-scaling:
[2023-07-22 09:14:48] [config]   - 256.f
[2023-07-22 09:14:48] [config]   - 1000
[2023-07-22 09:14:48] [config]   - 2.f
[2023-07-22 09:14:48] [config]   - 256.f
[2023-07-22 09:14:48] [config] cost-type: ce-sum
[2023-07-22 09:14:48] [config] cpu-threads: 0
[2023-07-22 09:14:48] [config] data-threads: 8
[2023-07-22 09:14:48] [config] data-weighting: ""
[2023-07-22 09:14:48] [config] data-weighting-type: sentence
[2023-07-22 09:14:48] [config] dec-cell: gru
[2023-07-22 09:14:48] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:48] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:48] [config] dec-depth: 2
[2023-07-22 09:14:48] [config] devices:
[2023-07-22 09:14:48] [config]   - 0
[2023-07-22 09:14:48] [config] dim-emb: 512
[2023-07-22 09:14:48] [config] dim-rnn: 1024
[2023-07-22 09:14:48] [config] dim-vocabs:
[2023-07-22 09:14:48] [config]   - 16384
[2023-07-22 09:14:48] [config]   - 16384
[2023-07-22 09:14:48] [config] disp-first: 0
[2023-07-22 09:14:48] [config] disp-freq: 1000u
[2023-07-22 09:14:48] [config] disp-label-counts: true
[2023-07-22 09:14:48] [config] dropout-rnn: 0
[2023-07-22 09:14:48] [config] dropout-src: 0
[2023-07-22 09:14:48] [config] dropout-trg: 0
[2023-07-22 09:14:48] [config] dump-config: ""
[2023-07-22 09:14:48] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] early-stopping: 200
[2023-07-22 09:14:48] [config] early-stopping-on: first
[2023-07-22 09:14:48] [config] embedding-fix-src: false
[2023-07-22 09:14:48] [config] embedding-fix-trg: false
[2023-07-22 09:14:48] [config] embedding-normalization: false
[2023-07-22 09:14:48] [config] embedding-vectors:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] enc-cell: gru
[2023-07-22 09:14:48] [config] enc-cell-depth: 1
[2023-07-22 09:14:48] [config] enc-depth: 2
[2023-07-22 09:14:48] [config] enc-type: bidirectional
[2023-07-22 09:14:48] [config] english-title-case-every: 0
[2023-07-22 09:14:48] [config] exponential-smoothing: 0
[2023-07-22 09:14:48] [config] factor-weight: 1
[2023-07-22 09:14:48] [config] factors-combine: sum
[2023-07-22 09:14:48] [config] factors-dim-emb: 0
[2023-07-22 09:14:48] [config] gradient-checkpointing: false
[2023-07-22 09:14:48] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:48] [config] guided-alignment: none
[2023-07-22 09:14:48] [config] guided-alignment-cost: mse
[2023-07-22 09:14:48] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:48] [config] ignore-model-config: false
[2023-07-22 09:14:48] [config] input-types:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] interpolate-env-vars: false
[2023-07-22 09:14:48] [config] keep-best: false
[2023-07-22 09:14:48] [config] label-smoothing: 0
[2023-07-22 09:14:48] [config] layer-normalization: false
[2023-07-22 09:14:48] [config] learn-rate: 0.0001
[2023-07-22 09:14:48] [config] lemma-dependency: ""
[2023-07-22 09:14:48] [config] lemma-dim-emb: 0
[2023-07-22 09:14:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:48] [config] log-level: info
[2023-07-22 09:14:48] [config] log-time-zone: ""
[2023-07-22 09:14:48] [config] logical-epoch:
[2023-07-22 09:14:48] [config]   - 1e
[2023-07-22 09:14:48] [config]   - 0
[2023-07-22 09:14:48] [config] lr-decay: 0
[2023-07-22 09:14:48] [config] lr-decay-freq: 50000
[2023-07-22 09:14:48] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:48] [config]   - 0
[2023-07-22 09:14:48] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:48] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:48] [config] lr-decay-start:
[2023-07-22 09:14:48] [config]   - 10
[2023-07-22 09:14:48] [config]   - 1
[2023-07-22 09:14:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:48] [config] lr-report: false
[2023-07-22 09:14:48] [config] lr-warmup: 0
[2023-07-22 09:14:48] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:48] [config] lr-warmup-cycle: false
[2023-07-22 09:14:48] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:48] [config] max-length: 50
[2023-07-22 09:14:48] [config] max-length-crop: true
[2023-07-22 09:14:48] [config] max-length-factor: 3
[2023-07-22 09:14:48] [config] maxi-batch: 100
[2023-07-22 09:14:48] [config] maxi-batch-sort: trg
[2023-07-22 09:14:48] [config] mini-batch: 64
[2023-07-22 09:14:48] [config] mini-batch-fit: true
[2023-07-22 09:14:48] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:48] [config] mini-batch-round-up: true
[2023-07-22 09:14:48] [config] mini-batch-track-lr: false
[2023-07-22 09:14:48] [config] mini-batch-warmup: 0
[2023-07-22 09:14:48] [config] mini-batch-words: 0
[2023-07-22 09:14:48] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:48] [config] multi-loss-type: sum
[2023-07-22 09:14:48] [config] n-best: false
[2023-07-22 09:14:48] [config] no-nccl: false
[2023-07-22 09:14:48] [config] no-reload: false
[2023-07-22 09:14:48] [config] no-restore-corpus: false
[2023-07-22 09:14:48] [config] normalize: 0
[2023-07-22 09:14:48] [config] normalize-gradient: false
[2023-07-22 09:14:48] [config] num-devices: 0
[2023-07-22 09:14:48] [config] optimizer: adam
[2023-07-22 09:14:48] [config] optimizer-delay: 1
[2023-07-22 09:14:48] [config] optimizer-params:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] output-omit-bias: false
[2023-07-22 09:14:48] [config] overwrite: true
[2023-07-22 09:14:48] [config] precision:
[2023-07-22 09:14:48] [config]   - float16
[2023-07-22 09:14:48] [config]   - float32
[2023-07-22 09:14:48] [config] pretrained-model: ""
[2023-07-22 09:14:48] [config] quantize-biases: false
[2023-07-22 09:14:48] [config] quantize-bits: 0
[2023-07-22 09:14:48] [config] quantize-log-based: false
[2023-07-22 09:14:48] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:48] [config] quiet: false
[2023-07-22 09:14:48] [config] quiet-translation: true
[2023-07-22 09:14:48] [config] relative-paths: false
[2023-07-22 09:14:48] [config] right-left: false
[2023-07-22 09:14:48] [config] save-freq: 10000u
[2023-07-22 09:14:48] [config] seed: 1234
[2023-07-22 09:14:48] [config] sentencepiece-alphas:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:48] [config] sentencepiece-options: ""
[2023-07-22 09:14:48] [config] sharding: global
[2023-07-22 09:14:48] [config] shuffle: data
[2023-07-22 09:14:48] [config] shuffle-in-ram: false
[2023-07-22 09:14:48] [config] sigterm: save-and-exit
[2023-07-22 09:14:48] [config] skip: false
[2023-07-22 09:14:48] [config] sqlite: ""
[2023-07-22 09:14:48] [config] sqlite-drop: false
[2023-07-22 09:14:48] [config] sync-freq: 200u
[2023-07-22 09:14:48] [config] sync-sgd: false
[2023-07-22 09:14:48] [config] tempdir: /tmp
[2023-07-22 09:14:48] [config] tied-embeddings: false
[2023-07-22 09:14:48] [config] tied-embeddings-all: true
[2023-07-22 09:14:48] [config] tied-embeddings-src: false
[2023-07-22 09:14:48] [config] train-embedder-rank:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] train-sets:
[2023-07-22 09:14:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:48] [config] transformer-aan-activation: swish
[2023-07-22 09:14:48] [config] transformer-aan-depth: 2
[2023-07-22 09:14:48] [config] transformer-aan-nogate: false
[2023-07-22 09:14:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:48] [config] transformer-depth-scaling: false
[2023-07-22 09:14:48] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:48] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:48] [config] transformer-dropout: 0
[2023-07-22 09:14:48] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:48] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:48] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:48] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:48] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:48] [config] transformer-heads: 8
[2023-07-22 09:14:48] [config] transformer-no-projection: false
[2023-07-22 09:14:48] [config] transformer-pool: false
[2023-07-22 09:14:48] [config] transformer-postprocess: dan
[2023-07-22 09:14:48] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:48] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:48] [config] transformer-preprocess: ""
[2023-07-22 09:14:48] [config] transformer-tied-layers:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:48] [config] tsv: false
[2023-07-22 09:14:48] [config] tsv-fields: 0
[2023-07-22 09:14:48] [config] type: amun
[2023-07-22 09:14:48] [config] ulr: false
[2023-07-22 09:14:48] [config] ulr-dim-emb: 0
[2023-07-22 09:14:48] [config] ulr-dropout: 0
[2023-07-22 09:14:48] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:48] [config] ulr-query-vectors: ""
[2023-07-22 09:14:48] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:48] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:48] [config] unlikelihood-loss: false
[2023-07-22 09:14:48] [config] valid-freq: 50000000
[2023-07-22 09:14:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:48] [config] valid-max-length: 1000
[2023-07-22 09:14:48] [config] valid-metrics:
[2023-07-22 09:14:48] [config]   - cross-entropy
[2023-07-22 09:14:48] [config]   - translation
[2023-07-22 09:14:48] [config] valid-mini-batch: 32
[2023-07-22 09:14:48] [config] valid-reset-stalled: false
[2023-07-22 09:14:48] [config] valid-script-args:
[2023-07-22 09:14:48] [config]   []
[2023-07-22 09:14:48] [config] valid-script-path: ""
[2023-07-22 09:14:48] [config] valid-sets:
[2023-07-22 09:14:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:48] [config] vocabs:
[2023-07-22 09:14:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:48] [config] word-penalty: 0
[2023-07-22 09:14:48] [config] word-scores: false
[2023-07-22 09:14:48] [config] workspace: 5500
[2023-07-22 09:14:48] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:48] [training] Using single-device training
[2023-07-22 09:14:48] Synced seed 1234
[2023-07-22 09:14:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:50] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:50] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x5576cf706141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x5576cf648da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5576cf64d1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5576cf6542ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5576cf800a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5576cf801a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5576cf7dabee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5576cf2dc108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5576cf1fe2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5576cf1b5b9c]    main                                               + 0x3c
[0x7f03bb9670b3]    __libc_start_main                                  + 0xf3
[0x5576cf1fccbe]    _start                                             + 0x2e

[2023-07-22 09:14:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:53] [marian] Running on node23.datos.cluster.uy as process 27372 with command line:
[2023-07-22 09:14:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:53] [config] after: 0e
[2023-07-22 09:14:53] [config] after-batches: 0
[2023-07-22 09:14:53] [config] after-epochs: 160
[2023-07-22 09:14:53] [config] all-caps-every: 0
[2023-07-22 09:14:53] [config] allow-unk: false
[2023-07-22 09:14:53] [config] authors: false
[2023-07-22 09:14:53] [config] beam-size: 12
[2023-07-22 09:14:53] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:53] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:53] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:53] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:53] [config] build-info: ""
[2023-07-22 09:14:53] [config] check-gradient-nan: false
[2023-07-22 09:14:53] [config] check-nan: false
[2023-07-22 09:14:53] [config] cite: false
[2023-07-22 09:14:53] [config] clip-norm: 1
[2023-07-22 09:14:53] [config] cost-scaling:
[2023-07-22 09:14:53] [config]   - 256.f
[2023-07-22 09:14:53] [config]   - 1000
[2023-07-22 09:14:53] [config]   - 2.f
[2023-07-22 09:14:53] [config]   - 256.f
[2023-07-22 09:14:53] [config] cost-type: ce-sum
[2023-07-22 09:14:53] [config] cpu-threads: 0
[2023-07-22 09:14:53] [config] data-threads: 8
[2023-07-22 09:14:53] [config] data-weighting: ""
[2023-07-22 09:14:53] [config] data-weighting-type: sentence
[2023-07-22 09:14:53] [config] dec-cell: gru
[2023-07-22 09:14:53] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:53] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:53] [config] dec-depth: 2
[2023-07-22 09:14:53] [config] devices:
[2023-07-22 09:14:53] [config]   - 0
[2023-07-22 09:14:53] [config] dim-emb: 512
[2023-07-22 09:14:53] [config] dim-rnn: 1024
[2023-07-22 09:14:53] [config] dim-vocabs:
[2023-07-22 09:14:53] [config]   - 16384
[2023-07-22 09:14:53] [config]   - 16384
[2023-07-22 09:14:53] [config] disp-first: 0
[2023-07-22 09:14:53] [config] disp-freq: 1000u
[2023-07-22 09:14:53] [config] disp-label-counts: true
[2023-07-22 09:14:53] [config] dropout-rnn: 0
[2023-07-22 09:14:53] [config] dropout-src: 0
[2023-07-22 09:14:53] [config] dropout-trg: 0
[2023-07-22 09:14:53] [config] dump-config: ""
[2023-07-22 09:14:53] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] early-stopping: 200
[2023-07-22 09:14:53] [config] early-stopping-on: first
[2023-07-22 09:14:53] [config] embedding-fix-src: false
[2023-07-22 09:14:53] [config] embedding-fix-trg: false
[2023-07-22 09:14:53] [config] embedding-normalization: false
[2023-07-22 09:14:53] [config] embedding-vectors:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] enc-cell: gru
[2023-07-22 09:14:53] [config] enc-cell-depth: 1
[2023-07-22 09:14:53] [config] enc-depth: 2
[2023-07-22 09:14:53] [config] enc-type: bidirectional
[2023-07-22 09:14:53] [config] english-title-case-every: 0
[2023-07-22 09:14:53] [config] exponential-smoothing: 0
[2023-07-22 09:14:53] [config] factor-weight: 1
[2023-07-22 09:14:53] [config] factors-combine: sum
[2023-07-22 09:14:53] [config] factors-dim-emb: 0
[2023-07-22 09:14:53] [config] gradient-checkpointing: false
[2023-07-22 09:14:53] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:53] [config] guided-alignment: none
[2023-07-22 09:14:53] [config] guided-alignment-cost: mse
[2023-07-22 09:14:53] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:53] [config] ignore-model-config: false
[2023-07-22 09:14:53] [config] input-types:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] interpolate-env-vars: false
[2023-07-22 09:14:53] [config] keep-best: false
[2023-07-22 09:14:53] [config] label-smoothing: 0
[2023-07-22 09:14:53] [config] layer-normalization: false
[2023-07-22 09:14:53] [config] learn-rate: 0.0001
[2023-07-22 09:14:53] [config] lemma-dependency: ""
[2023-07-22 09:14:53] [config] lemma-dim-emb: 0
[2023-07-22 09:14:53] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:53] [config] log-level: info
[2023-07-22 09:14:53] [config] log-time-zone: ""
[2023-07-22 09:14:53] [config] logical-epoch:
[2023-07-22 09:14:53] [config]   - 1e
[2023-07-22 09:14:53] [config]   - 0
[2023-07-22 09:14:53] [config] lr-decay: 0
[2023-07-22 09:14:53] [config] lr-decay-freq: 50000
[2023-07-22 09:14:53] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:53] [config]   - 0
[2023-07-22 09:14:53] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:53] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:53] [config] lr-decay-start:
[2023-07-22 09:14:53] [config]   - 10
[2023-07-22 09:14:53] [config]   - 1
[2023-07-22 09:14:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:53] [config] lr-report: false
[2023-07-22 09:14:53] [config] lr-warmup: 0
[2023-07-22 09:14:53] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:53] [config] lr-warmup-cycle: false
[2023-07-22 09:14:53] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:53] [config] max-length: 50
[2023-07-22 09:14:53] [config] max-length-crop: true
[2023-07-22 09:14:53] [config] max-length-factor: 3
[2023-07-22 09:14:53] [config] maxi-batch: 100
[2023-07-22 09:14:53] [config] maxi-batch-sort: trg
[2023-07-22 09:14:53] [config] mini-batch: 64
[2023-07-22 09:14:53] [config] mini-batch-fit: true
[2023-07-22 09:14:53] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:53] [config] mini-batch-round-up: true
[2023-07-22 09:14:53] [config] mini-batch-track-lr: false
[2023-07-22 09:14:53] [config] mini-batch-warmup: 0
[2023-07-22 09:14:53] [config] mini-batch-words: 0
[2023-07-22 09:14:53] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:53] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:53] [config] multi-loss-type: sum
[2023-07-22 09:14:53] [config] n-best: false
[2023-07-22 09:14:53] [config] no-nccl: false
[2023-07-22 09:14:53] [config] no-reload: false
[2023-07-22 09:14:53] [config] no-restore-corpus: false
[2023-07-22 09:14:53] [config] normalize: 0
[2023-07-22 09:14:53] [config] normalize-gradient: false
[2023-07-22 09:14:53] [config] num-devices: 0
[2023-07-22 09:14:53] [config] optimizer: adam
[2023-07-22 09:14:53] [config] optimizer-delay: 1
[2023-07-22 09:14:53] [config] optimizer-params:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] output-omit-bias: false
[2023-07-22 09:14:53] [config] overwrite: true
[2023-07-22 09:14:53] [config] precision:
[2023-07-22 09:14:53] [config]   - float16
[2023-07-22 09:14:53] [config]   - float32
[2023-07-22 09:14:53] [config] pretrained-model: ""
[2023-07-22 09:14:53] [config] quantize-biases: false
[2023-07-22 09:14:53] [config] quantize-bits: 0
[2023-07-22 09:14:53] [config] quantize-log-based: false
[2023-07-22 09:14:53] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:53] [config] quiet: false
[2023-07-22 09:14:53] [config] quiet-translation: true
[2023-07-22 09:14:53] [config] relative-paths: false
[2023-07-22 09:14:53] [config] right-left: false
[2023-07-22 09:14:53] [config] save-freq: 10000u
[2023-07-22 09:14:53] [config] seed: 1234
[2023-07-22 09:14:53] [config] sentencepiece-alphas:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:53] [config] sentencepiece-options: ""
[2023-07-22 09:14:53] [config] sharding: global
[2023-07-22 09:14:53] [config] shuffle: data
[2023-07-22 09:14:53] [config] shuffle-in-ram: false
[2023-07-22 09:14:53] [config] sigterm: save-and-exit
[2023-07-22 09:14:53] [config] skip: false
[2023-07-22 09:14:53] [config] sqlite: ""
[2023-07-22 09:14:53] [config] sqlite-drop: false
[2023-07-22 09:14:53] [config] sync-freq: 200u
[2023-07-22 09:14:53] [config] sync-sgd: false
[2023-07-22 09:14:53] [config] tempdir: /tmp
[2023-07-22 09:14:53] [config] tied-embeddings: false
[2023-07-22 09:14:53] [config] tied-embeddings-all: true
[2023-07-22 09:14:53] [config] tied-embeddings-src: false
[2023-07-22 09:14:53] [config] train-embedder-rank:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] train-sets:
[2023-07-22 09:14:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:53] [config] transformer-aan-activation: swish
[2023-07-22 09:14:53] [config] transformer-aan-depth: 2
[2023-07-22 09:14:53] [config] transformer-aan-nogate: false
[2023-07-22 09:14:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:53] [config] transformer-depth-scaling: false
[2023-07-22 09:14:53] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:53] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:53] [config] transformer-dropout: 0
[2023-07-22 09:14:53] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:53] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:53] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:53] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:53] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:53] [config] transformer-heads: 8
[2023-07-22 09:14:53] [config] transformer-no-projection: false
[2023-07-22 09:14:53] [config] transformer-pool: false
[2023-07-22 09:14:53] [config] transformer-postprocess: dan
[2023-07-22 09:14:53] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:53] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:53] [config] transformer-preprocess: ""
[2023-07-22 09:14:53] [config] transformer-tied-layers:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:53] [config] tsv: false
[2023-07-22 09:14:53] [config] tsv-fields: 0
[2023-07-22 09:14:53] [config] type: amun
[2023-07-22 09:14:53] [config] ulr: false
[2023-07-22 09:14:53] [config] ulr-dim-emb: 0
[2023-07-22 09:14:53] [config] ulr-dropout: 0
[2023-07-22 09:14:53] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:53] [config] ulr-query-vectors: ""
[2023-07-22 09:14:53] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:53] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:53] [config] unlikelihood-loss: false
[2023-07-22 09:14:53] [config] valid-freq: 50000000
[2023-07-22 09:14:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:53] [config] valid-max-length: 1000
[2023-07-22 09:14:53] [config] valid-metrics:
[2023-07-22 09:14:53] [config]   - cross-entropy
[2023-07-22 09:14:53] [config]   - translation
[2023-07-22 09:14:53] [config] valid-mini-batch: 32
[2023-07-22 09:14:53] [config] valid-reset-stalled: false
[2023-07-22 09:14:53] [config] valid-script-args:
[2023-07-22 09:14:53] [config]   []
[2023-07-22 09:14:53] [config] valid-script-path: ""
[2023-07-22 09:14:53] [config] valid-sets:
[2023-07-22 09:14:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:53] [config] vocabs:
[2023-07-22 09:14:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:53] [config] word-penalty: 0
[2023-07-22 09:14:53] [config] word-scores: false
[2023-07-22 09:14:53] [config] workspace: 5500
[2023-07-22 09:14:53] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:53] [training] Using single-device training
[2023-07-22 09:14:53] Synced seed 1234
[2023-07-22 09:14:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:53] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:53] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:53] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:55] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:55] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55e9c9b7e141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55e9c9ac0da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55e9c9ac51a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55e9c9acc2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55e9c9c78a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55e9c9c79a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55e9c9c52bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55e9c9754108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55e9c96762c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55e9c962db9c]    main                                               + 0x3c
[0x7f6c52a2d0b3]    __libc_start_main                                  + 0xf3
[0x55e9c9674cbe]    _start                                             + 0x2e

[2023-07-22 09:14:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:57] [marian] Running on node23.datos.cluster.uy as process 27398 with command line:
[2023-07-22 09:14:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:14:57] [config] after: 0e
[2023-07-22 09:14:57] [config] after-batches: 0
[2023-07-22 09:14:57] [config] after-epochs: 170
[2023-07-22 09:14:57] [config] all-caps-every: 0
[2023-07-22 09:14:57] [config] allow-unk: false
[2023-07-22 09:14:57] [config] authors: false
[2023-07-22 09:14:57] [config] beam-size: 12
[2023-07-22 09:14:57] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:14:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:14:57] [config] bert-masking-fraction: 0.15
[2023-07-22 09:14:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:14:57] [config] bert-train-type-embeddings: true
[2023-07-22 09:14:57] [config] bert-type-vocab-size: 2
[2023-07-22 09:14:57] [config] build-info: ""
[2023-07-22 09:14:57] [config] check-gradient-nan: false
[2023-07-22 09:14:57] [config] check-nan: false
[2023-07-22 09:14:57] [config] cite: false
[2023-07-22 09:14:57] [config] clip-norm: 1
[2023-07-22 09:14:57] [config] cost-scaling:
[2023-07-22 09:14:57] [config]   - 256.f
[2023-07-22 09:14:57] [config]   - 1000
[2023-07-22 09:14:57] [config]   - 2.f
[2023-07-22 09:14:57] [config]   - 256.f
[2023-07-22 09:14:57] [config] cost-type: ce-sum
[2023-07-22 09:14:57] [config] cpu-threads: 0
[2023-07-22 09:14:57] [config] data-threads: 8
[2023-07-22 09:14:57] [config] data-weighting: ""
[2023-07-22 09:14:57] [config] data-weighting-type: sentence
[2023-07-22 09:14:57] [config] dec-cell: gru
[2023-07-22 09:14:57] [config] dec-cell-base-depth: 2
[2023-07-22 09:14:57] [config] dec-cell-high-depth: 1
[2023-07-22 09:14:57] [config] dec-depth: 2
[2023-07-22 09:14:57] [config] devices:
[2023-07-22 09:14:57] [config]   - 0
[2023-07-22 09:14:57] [config] dim-emb: 512
[2023-07-22 09:14:57] [config] dim-rnn: 1024
[2023-07-22 09:14:57] [config] dim-vocabs:
[2023-07-22 09:14:57] [config]   - 16384
[2023-07-22 09:14:57] [config]   - 16384
[2023-07-22 09:14:57] [config] disp-first: 0
[2023-07-22 09:14:57] [config] disp-freq: 1000u
[2023-07-22 09:14:57] [config] disp-label-counts: true
[2023-07-22 09:14:57] [config] dropout-rnn: 0
[2023-07-22 09:14:57] [config] dropout-src: 0
[2023-07-22 09:14:57] [config] dropout-trg: 0
[2023-07-22 09:14:57] [config] dump-config: ""
[2023-07-22 09:14:57] [config] dynamic-gradient-scaling:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] early-stopping: 200
[2023-07-22 09:14:57] [config] early-stopping-on: first
[2023-07-22 09:14:57] [config] embedding-fix-src: false
[2023-07-22 09:14:57] [config] embedding-fix-trg: false
[2023-07-22 09:14:57] [config] embedding-normalization: false
[2023-07-22 09:14:57] [config] embedding-vectors:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] enc-cell: gru
[2023-07-22 09:14:57] [config] enc-cell-depth: 1
[2023-07-22 09:14:57] [config] enc-depth: 2
[2023-07-22 09:14:57] [config] enc-type: bidirectional
[2023-07-22 09:14:57] [config] english-title-case-every: 0
[2023-07-22 09:14:57] [config] exponential-smoothing: 0
[2023-07-22 09:14:57] [config] factor-weight: 1
[2023-07-22 09:14:57] [config] factors-combine: sum
[2023-07-22 09:14:57] [config] factors-dim-emb: 0
[2023-07-22 09:14:57] [config] gradient-checkpointing: false
[2023-07-22 09:14:57] [config] gradient-norm-average-window: 100
[2023-07-22 09:14:57] [config] guided-alignment: none
[2023-07-22 09:14:57] [config] guided-alignment-cost: mse
[2023-07-22 09:14:57] [config] guided-alignment-weight: 0.1
[2023-07-22 09:14:57] [config] ignore-model-config: false
[2023-07-22 09:14:57] [config] input-types:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] interpolate-env-vars: false
[2023-07-22 09:14:57] [config] keep-best: false
[2023-07-22 09:14:57] [config] label-smoothing: 0
[2023-07-22 09:14:57] [config] layer-normalization: false
[2023-07-22 09:14:57] [config] learn-rate: 0.0001
[2023-07-22 09:14:57] [config] lemma-dependency: ""
[2023-07-22 09:14:57] [config] lemma-dim-emb: 0
[2023-07-22 09:14:57] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:57] [config] log-level: info
[2023-07-22 09:14:57] [config] log-time-zone: ""
[2023-07-22 09:14:57] [config] logical-epoch:
[2023-07-22 09:14:57] [config]   - 1e
[2023-07-22 09:14:57] [config]   - 0
[2023-07-22 09:14:57] [config] lr-decay: 0
[2023-07-22 09:14:57] [config] lr-decay-freq: 50000
[2023-07-22 09:14:57] [config] lr-decay-inv-sqrt:
[2023-07-22 09:14:57] [config]   - 0
[2023-07-22 09:14:57] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:14:57] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:14:57] [config] lr-decay-start:
[2023-07-22 09:14:57] [config]   - 10
[2023-07-22 09:14:57] [config]   - 1
[2023-07-22 09:14:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:14:57] [config] lr-report: false
[2023-07-22 09:14:57] [config] lr-warmup: 0
[2023-07-22 09:14:57] [config] lr-warmup-at-reload: false
[2023-07-22 09:14:57] [config] lr-warmup-cycle: false
[2023-07-22 09:14:57] [config] lr-warmup-start-rate: 0
[2023-07-22 09:14:57] [config] max-length: 50
[2023-07-22 09:14:57] [config] max-length-crop: true
[2023-07-22 09:14:57] [config] max-length-factor: 3
[2023-07-22 09:14:57] [config] maxi-batch: 100
[2023-07-22 09:14:57] [config] maxi-batch-sort: trg
[2023-07-22 09:14:57] [config] mini-batch: 64
[2023-07-22 09:14:57] [config] mini-batch-fit: true
[2023-07-22 09:14:57] [config] mini-batch-fit-step: 10
[2023-07-22 09:14:57] [config] mini-batch-round-up: true
[2023-07-22 09:14:57] [config] mini-batch-track-lr: false
[2023-07-22 09:14:57] [config] mini-batch-warmup: 0
[2023-07-22 09:14:57] [config] mini-batch-words: 0
[2023-07-22 09:14:57] [config] mini-batch-words-ref: 0
[2023-07-22 09:14:57] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:14:57] [config] multi-loss-type: sum
[2023-07-22 09:14:57] [config] n-best: false
[2023-07-22 09:14:57] [config] no-nccl: false
[2023-07-22 09:14:57] [config] no-reload: false
[2023-07-22 09:14:57] [config] no-restore-corpus: false
[2023-07-22 09:14:57] [config] normalize: 0
[2023-07-22 09:14:57] [config] normalize-gradient: false
[2023-07-22 09:14:57] [config] num-devices: 0
[2023-07-22 09:14:57] [config] optimizer: adam
[2023-07-22 09:14:57] [config] optimizer-delay: 1
[2023-07-22 09:14:57] [config] optimizer-params:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] output-omit-bias: false
[2023-07-22 09:14:57] [config] overwrite: true
[2023-07-22 09:14:57] [config] precision:
[2023-07-22 09:14:57] [config]   - float16
[2023-07-22 09:14:57] [config]   - float32
[2023-07-22 09:14:57] [config] pretrained-model: ""
[2023-07-22 09:14:57] [config] quantize-biases: false
[2023-07-22 09:14:57] [config] quantize-bits: 0
[2023-07-22 09:14:57] [config] quantize-log-based: false
[2023-07-22 09:14:57] [config] quantize-optimization-steps: 0
[2023-07-22 09:14:57] [config] quiet: false
[2023-07-22 09:14:57] [config] quiet-translation: true
[2023-07-22 09:14:57] [config] relative-paths: false
[2023-07-22 09:14:57] [config] right-left: false
[2023-07-22 09:14:57] [config] save-freq: 10000u
[2023-07-22 09:14:57] [config] seed: 1234
[2023-07-22 09:14:57] [config] sentencepiece-alphas:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:14:57] [config] sentencepiece-options: ""
[2023-07-22 09:14:57] [config] sharding: global
[2023-07-22 09:14:57] [config] shuffle: data
[2023-07-22 09:14:57] [config] shuffle-in-ram: false
[2023-07-22 09:14:57] [config] sigterm: save-and-exit
[2023-07-22 09:14:57] [config] skip: false
[2023-07-22 09:14:57] [config] sqlite: ""
[2023-07-22 09:14:57] [config] sqlite-drop: false
[2023-07-22 09:14:57] [config] sync-freq: 200u
[2023-07-22 09:14:57] [config] sync-sgd: false
[2023-07-22 09:14:57] [config] tempdir: /tmp
[2023-07-22 09:14:57] [config] tied-embeddings: false
[2023-07-22 09:14:57] [config] tied-embeddings-all: true
[2023-07-22 09:14:57] [config] tied-embeddings-src: false
[2023-07-22 09:14:57] [config] train-embedder-rank:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] train-sets:
[2023-07-22 09:14:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:14:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:14:57] [config] transformer-aan-activation: swish
[2023-07-22 09:14:57] [config] transformer-aan-depth: 2
[2023-07-22 09:14:57] [config] transformer-aan-nogate: false
[2023-07-22 09:14:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:14:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:14:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:14:57] [config] transformer-depth-scaling: false
[2023-07-22 09:14:57] [config] transformer-dim-aan: 2048
[2023-07-22 09:14:57] [config] transformer-dim-ffn: 2048
[2023-07-22 09:14:57] [config] transformer-dropout: 0
[2023-07-22 09:14:57] [config] transformer-dropout-attention: 0
[2023-07-22 09:14:57] [config] transformer-dropout-ffn: 0
[2023-07-22 09:14:57] [config] transformer-ffn-activation: swish
[2023-07-22 09:14:57] [config] transformer-ffn-depth: 2
[2023-07-22 09:14:57] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:14:57] [config] transformer-heads: 8
[2023-07-22 09:14:57] [config] transformer-no-projection: false
[2023-07-22 09:14:57] [config] transformer-pool: false
[2023-07-22 09:14:57] [config] transformer-postprocess: dan
[2023-07-22 09:14:57] [config] transformer-postprocess-emb: d
[2023-07-22 09:14:57] [config] transformer-postprocess-top: ""
[2023-07-22 09:14:57] [config] transformer-preprocess: ""
[2023-07-22 09:14:57] [config] transformer-tied-layers:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] transformer-train-position-embeddings: false
[2023-07-22 09:14:57] [config] tsv: false
[2023-07-22 09:14:57] [config] tsv-fields: 0
[2023-07-22 09:14:57] [config] type: amun
[2023-07-22 09:14:57] [config] ulr: false
[2023-07-22 09:14:57] [config] ulr-dim-emb: 0
[2023-07-22 09:14:57] [config] ulr-dropout: 0
[2023-07-22 09:14:57] [config] ulr-keys-vectors: ""
[2023-07-22 09:14:57] [config] ulr-query-vectors: ""
[2023-07-22 09:14:57] [config] ulr-softmax-temperature: 1
[2023-07-22 09:14:57] [config] ulr-trainable-transformation: false
[2023-07-22 09:14:57] [config] unlikelihood-loss: false
[2023-07-22 09:14:57] [config] valid-freq: 50000000
[2023-07-22 09:14:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:14:57] [config] valid-max-length: 1000
[2023-07-22 09:14:57] [config] valid-metrics:
[2023-07-22 09:14:57] [config]   - cross-entropy
[2023-07-22 09:14:57] [config]   - translation
[2023-07-22 09:14:57] [config] valid-mini-batch: 32
[2023-07-22 09:14:57] [config] valid-reset-stalled: false
[2023-07-22 09:14:57] [config] valid-script-args:
[2023-07-22 09:14:57] [config]   []
[2023-07-22 09:14:57] [config] valid-script-path: ""
[2023-07-22 09:14:57] [config] valid-sets:
[2023-07-22 09:14:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:14:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:14:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:14:57] [config] vocabs:
[2023-07-22 09:14:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:57] [config] word-penalty: 0
[2023-07-22 09:14:57] [config] word-scores: false
[2023-07-22 09:14:57] [config] workspace: 5500
[2023-07-22 09:14:57] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:14:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:57] [training] Using single-device training
[2023-07-22 09:14:58] Synced seed 1234
[2023-07-22 09:14:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:14:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:14:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:14:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:14:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:14:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:14:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:14:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:14:59] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:14:59] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55db5c320141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55db5c262da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55db5c2671a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55db5c26e2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55db5c41aa0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55db5c41ba53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55db5c3f4bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55db5bef6108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55db5be182c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55db5bdcfb9c]    main                                               + 0x3c
[0x7f35cc7a80b3]    __libc_start_main                                  + 0xf3
[0x55db5be16cbe]    _start                                             + 0x2e

[2023-07-22 09:15:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:02] [marian] Running on node23.datos.cluster.uy as process 27426 with command line:
[2023-07-22 09:15:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:15:02] [config] after: 0e
[2023-07-22 09:15:02] [config] after-batches: 0
[2023-07-22 09:15:02] [config] after-epochs: 180
[2023-07-22 09:15:02] [config] all-caps-every: 0
[2023-07-22 09:15:02] [config] allow-unk: false
[2023-07-22 09:15:02] [config] authors: false
[2023-07-22 09:15:02] [config] beam-size: 12
[2023-07-22 09:15:02] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:15:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:15:02] [config] bert-masking-fraction: 0.15
[2023-07-22 09:15:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:15:02] [config] bert-train-type-embeddings: true
[2023-07-22 09:15:02] [config] bert-type-vocab-size: 2
[2023-07-22 09:15:02] [config] build-info: ""
[2023-07-22 09:15:02] [config] check-gradient-nan: false
[2023-07-22 09:15:02] [config] check-nan: false
[2023-07-22 09:15:02] [config] cite: false
[2023-07-22 09:15:02] [config] clip-norm: 1
[2023-07-22 09:15:02] [config] cost-scaling:
[2023-07-22 09:15:02] [config]   - 256.f
[2023-07-22 09:15:02] [config]   - 1000
[2023-07-22 09:15:02] [config]   - 2.f
[2023-07-22 09:15:02] [config]   - 256.f
[2023-07-22 09:15:02] [config] cost-type: ce-sum
[2023-07-22 09:15:02] [config] cpu-threads: 0
[2023-07-22 09:15:02] [config] data-threads: 8
[2023-07-22 09:15:02] [config] data-weighting: ""
[2023-07-22 09:15:02] [config] data-weighting-type: sentence
[2023-07-22 09:15:02] [config] dec-cell: gru
[2023-07-22 09:15:02] [config] dec-cell-base-depth: 2
[2023-07-22 09:15:02] [config] dec-cell-high-depth: 1
[2023-07-22 09:15:02] [config] dec-depth: 2
[2023-07-22 09:15:02] [config] devices:
[2023-07-22 09:15:02] [config]   - 0
[2023-07-22 09:15:02] [config] dim-emb: 512
[2023-07-22 09:15:02] [config] dim-rnn: 1024
[2023-07-22 09:15:02] [config] dim-vocabs:
[2023-07-22 09:15:02] [config]   - 16384
[2023-07-22 09:15:02] [config]   - 16384
[2023-07-22 09:15:02] [config] disp-first: 0
[2023-07-22 09:15:02] [config] disp-freq: 1000u
[2023-07-22 09:15:02] [config] disp-label-counts: true
[2023-07-22 09:15:02] [config] dropout-rnn: 0
[2023-07-22 09:15:02] [config] dropout-src: 0
[2023-07-22 09:15:02] [config] dropout-trg: 0
[2023-07-22 09:15:02] [config] dump-config: ""
[2023-07-22 09:15:02] [config] dynamic-gradient-scaling:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] early-stopping: 200
[2023-07-22 09:15:02] [config] early-stopping-on: first
[2023-07-22 09:15:02] [config] embedding-fix-src: false
[2023-07-22 09:15:02] [config] embedding-fix-trg: false
[2023-07-22 09:15:02] [config] embedding-normalization: false
[2023-07-22 09:15:02] [config] embedding-vectors:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] enc-cell: gru
[2023-07-22 09:15:02] [config] enc-cell-depth: 1
[2023-07-22 09:15:02] [config] enc-depth: 2
[2023-07-22 09:15:02] [config] enc-type: bidirectional
[2023-07-22 09:15:02] [config] english-title-case-every: 0
[2023-07-22 09:15:02] [config] exponential-smoothing: 0
[2023-07-22 09:15:02] [config] factor-weight: 1
[2023-07-22 09:15:02] [config] factors-combine: sum
[2023-07-22 09:15:02] [config] factors-dim-emb: 0
[2023-07-22 09:15:02] [config] gradient-checkpointing: false
[2023-07-22 09:15:02] [config] gradient-norm-average-window: 100
[2023-07-22 09:15:02] [config] guided-alignment: none
[2023-07-22 09:15:02] [config] guided-alignment-cost: mse
[2023-07-22 09:15:02] [config] guided-alignment-weight: 0.1
[2023-07-22 09:15:02] [config] ignore-model-config: false
[2023-07-22 09:15:02] [config] input-types:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] interpolate-env-vars: false
[2023-07-22 09:15:02] [config] keep-best: false
[2023-07-22 09:15:02] [config] label-smoothing: 0
[2023-07-22 09:15:02] [config] layer-normalization: false
[2023-07-22 09:15:02] [config] learn-rate: 0.0001
[2023-07-22 09:15:02] [config] lemma-dependency: ""
[2023-07-22 09:15:02] [config] lemma-dim-emb: 0
[2023-07-22 09:15:02] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:02] [config] log-level: info
[2023-07-22 09:15:02] [config] log-time-zone: ""
[2023-07-22 09:15:02] [config] logical-epoch:
[2023-07-22 09:15:02] [config]   - 1e
[2023-07-22 09:15:02] [config]   - 0
[2023-07-22 09:15:02] [config] lr-decay: 0
[2023-07-22 09:15:02] [config] lr-decay-freq: 50000
[2023-07-22 09:15:02] [config] lr-decay-inv-sqrt:
[2023-07-22 09:15:02] [config]   - 0
[2023-07-22 09:15:02] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:15:02] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:15:02] [config] lr-decay-start:
[2023-07-22 09:15:02] [config]   - 10
[2023-07-22 09:15:02] [config]   - 1
[2023-07-22 09:15:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:15:02] [config] lr-report: false
[2023-07-22 09:15:02] [config] lr-warmup: 0
[2023-07-22 09:15:02] [config] lr-warmup-at-reload: false
[2023-07-22 09:15:02] [config] lr-warmup-cycle: false
[2023-07-22 09:15:02] [config] lr-warmup-start-rate: 0
[2023-07-22 09:15:02] [config] max-length: 50
[2023-07-22 09:15:02] [config] max-length-crop: true
[2023-07-22 09:15:02] [config] max-length-factor: 3
[2023-07-22 09:15:02] [config] maxi-batch: 100
[2023-07-22 09:15:02] [config] maxi-batch-sort: trg
[2023-07-22 09:15:02] [config] mini-batch: 64
[2023-07-22 09:15:02] [config] mini-batch-fit: true
[2023-07-22 09:15:02] [config] mini-batch-fit-step: 10
[2023-07-22 09:15:02] [config] mini-batch-round-up: true
[2023-07-22 09:15:02] [config] mini-batch-track-lr: false
[2023-07-22 09:15:02] [config] mini-batch-warmup: 0
[2023-07-22 09:15:02] [config] mini-batch-words: 0
[2023-07-22 09:15:02] [config] mini-batch-words-ref: 0
[2023-07-22 09:15:02] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:15:02] [config] multi-loss-type: sum
[2023-07-22 09:15:02] [config] n-best: false
[2023-07-22 09:15:02] [config] no-nccl: false
[2023-07-22 09:15:02] [config] no-reload: false
[2023-07-22 09:15:02] [config] no-restore-corpus: false
[2023-07-22 09:15:02] [config] normalize: 0
[2023-07-22 09:15:02] [config] normalize-gradient: false
[2023-07-22 09:15:02] [config] num-devices: 0
[2023-07-22 09:15:02] [config] optimizer: adam
[2023-07-22 09:15:02] [config] optimizer-delay: 1
[2023-07-22 09:15:02] [config] optimizer-params:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] output-omit-bias: false
[2023-07-22 09:15:02] [config] overwrite: true
[2023-07-22 09:15:02] [config] precision:
[2023-07-22 09:15:02] [config]   - float16
[2023-07-22 09:15:02] [config]   - float32
[2023-07-22 09:15:02] [config] pretrained-model: ""
[2023-07-22 09:15:02] [config] quantize-biases: false
[2023-07-22 09:15:02] [config] quantize-bits: 0
[2023-07-22 09:15:02] [config] quantize-log-based: false
[2023-07-22 09:15:02] [config] quantize-optimization-steps: 0
[2023-07-22 09:15:02] [config] quiet: false
[2023-07-22 09:15:02] [config] quiet-translation: true
[2023-07-22 09:15:02] [config] relative-paths: false
[2023-07-22 09:15:02] [config] right-left: false
[2023-07-22 09:15:02] [config] save-freq: 10000u
[2023-07-22 09:15:02] [config] seed: 1234
[2023-07-22 09:15:02] [config] sentencepiece-alphas:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:15:02] [config] sentencepiece-options: ""
[2023-07-22 09:15:02] [config] sharding: global
[2023-07-22 09:15:02] [config] shuffle: data
[2023-07-22 09:15:02] [config] shuffle-in-ram: false
[2023-07-22 09:15:02] [config] sigterm: save-and-exit
[2023-07-22 09:15:02] [config] skip: false
[2023-07-22 09:15:02] [config] sqlite: ""
[2023-07-22 09:15:02] [config] sqlite-drop: false
[2023-07-22 09:15:02] [config] sync-freq: 200u
[2023-07-22 09:15:02] [config] sync-sgd: false
[2023-07-22 09:15:02] [config] tempdir: /tmp
[2023-07-22 09:15:02] [config] tied-embeddings: false
[2023-07-22 09:15:02] [config] tied-embeddings-all: true
[2023-07-22 09:15:02] [config] tied-embeddings-src: false
[2023-07-22 09:15:02] [config] train-embedder-rank:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] train-sets:
[2023-07-22 09:15:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:15:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:15:02] [config] transformer-aan-activation: swish
[2023-07-22 09:15:02] [config] transformer-aan-depth: 2
[2023-07-22 09:15:02] [config] transformer-aan-nogate: false
[2023-07-22 09:15:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:15:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:15:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:15:02] [config] transformer-depth-scaling: false
[2023-07-22 09:15:02] [config] transformer-dim-aan: 2048
[2023-07-22 09:15:02] [config] transformer-dim-ffn: 2048
[2023-07-22 09:15:02] [config] transformer-dropout: 0
[2023-07-22 09:15:02] [config] transformer-dropout-attention: 0
[2023-07-22 09:15:02] [config] transformer-dropout-ffn: 0
[2023-07-22 09:15:02] [config] transformer-ffn-activation: swish
[2023-07-22 09:15:02] [config] transformer-ffn-depth: 2
[2023-07-22 09:15:02] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:15:02] [config] transformer-heads: 8
[2023-07-22 09:15:02] [config] transformer-no-projection: false
[2023-07-22 09:15:02] [config] transformer-pool: false
[2023-07-22 09:15:02] [config] transformer-postprocess: dan
[2023-07-22 09:15:02] [config] transformer-postprocess-emb: d
[2023-07-22 09:15:02] [config] transformer-postprocess-top: ""
[2023-07-22 09:15:02] [config] transformer-preprocess: ""
[2023-07-22 09:15:02] [config] transformer-tied-layers:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] transformer-train-position-embeddings: false
[2023-07-22 09:15:02] [config] tsv: false
[2023-07-22 09:15:02] [config] tsv-fields: 0
[2023-07-22 09:15:02] [config] type: amun
[2023-07-22 09:15:02] [config] ulr: false
[2023-07-22 09:15:02] [config] ulr-dim-emb: 0
[2023-07-22 09:15:02] [config] ulr-dropout: 0
[2023-07-22 09:15:02] [config] ulr-keys-vectors: ""
[2023-07-22 09:15:02] [config] ulr-query-vectors: ""
[2023-07-22 09:15:02] [config] ulr-softmax-temperature: 1
[2023-07-22 09:15:02] [config] ulr-trainable-transformation: false
[2023-07-22 09:15:02] [config] unlikelihood-loss: false
[2023-07-22 09:15:02] [config] valid-freq: 50000000
[2023-07-22 09:15:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:02] [config] valid-max-length: 1000
[2023-07-22 09:15:02] [config] valid-metrics:
[2023-07-22 09:15:02] [config]   - cross-entropy
[2023-07-22 09:15:02] [config]   - translation
[2023-07-22 09:15:02] [config] valid-mini-batch: 32
[2023-07-22 09:15:02] [config] valid-reset-stalled: false
[2023-07-22 09:15:02] [config] valid-script-args:
[2023-07-22 09:15:02] [config]   []
[2023-07-22 09:15:02] [config] valid-script-path: ""
[2023-07-22 09:15:02] [config] valid-sets:
[2023-07-22 09:15:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:15:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:15:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:15:02] [config] vocabs:
[2023-07-22 09:15:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:02] [config] word-penalty: 0
[2023-07-22 09:15:02] [config] word-scores: false
[2023-07-22 09:15:02] [config] workspace: 5500
[2023-07-22 09:15:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:02] [training] Using single-device training
[2023-07-22 09:15:02] Synced seed 1234
[2023-07-22 09:15:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:02] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:15:02] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:15:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:15:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:15:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:15:04] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:15:04] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x55a07cb7b141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x55a07cabdda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55a07cac21a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55a07cac92ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55a07cc75a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55a07cc76a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55a07cc4fbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55a07c751108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55a07c6732c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a07c62ab9c]    main                                               + 0x3c
[0x7efcff2350b3]    __libc_start_main                                  + 0xf3
[0x55a07c671cbe]    _start                                             + 0x2e

[2023-07-22 09:15:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:07] [marian] Running on node23.datos.cluster.uy as process 27453 with command line:
[2023-07-22 09:15:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:15:07] [config] after: 0e
[2023-07-22 09:15:07] [config] after-batches: 0
[2023-07-22 09:15:07] [config] after-epochs: 190
[2023-07-22 09:15:07] [config] all-caps-every: 0
[2023-07-22 09:15:07] [config] allow-unk: false
[2023-07-22 09:15:07] [config] authors: false
[2023-07-22 09:15:07] [config] beam-size: 12
[2023-07-22 09:15:07] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:15:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:15:07] [config] bert-masking-fraction: 0.15
[2023-07-22 09:15:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:15:07] [config] bert-train-type-embeddings: true
[2023-07-22 09:15:07] [config] bert-type-vocab-size: 2
[2023-07-22 09:15:07] [config] build-info: ""
[2023-07-22 09:15:07] [config] check-gradient-nan: false
[2023-07-22 09:15:07] [config] check-nan: false
[2023-07-22 09:15:07] [config] cite: false
[2023-07-22 09:15:07] [config] clip-norm: 1
[2023-07-22 09:15:07] [config] cost-scaling:
[2023-07-22 09:15:07] [config]   - 256.f
[2023-07-22 09:15:07] [config]   - 1000
[2023-07-22 09:15:07] [config]   - 2.f
[2023-07-22 09:15:07] [config]   - 256.f
[2023-07-22 09:15:07] [config] cost-type: ce-sum
[2023-07-22 09:15:07] [config] cpu-threads: 0
[2023-07-22 09:15:07] [config] data-threads: 8
[2023-07-22 09:15:07] [config] data-weighting: ""
[2023-07-22 09:15:07] [config] data-weighting-type: sentence
[2023-07-22 09:15:07] [config] dec-cell: gru
[2023-07-22 09:15:07] [config] dec-cell-base-depth: 2
[2023-07-22 09:15:07] [config] dec-cell-high-depth: 1
[2023-07-22 09:15:07] [config] dec-depth: 2
[2023-07-22 09:15:07] [config] devices:
[2023-07-22 09:15:07] [config]   - 0
[2023-07-22 09:15:07] [config] dim-emb: 512
[2023-07-22 09:15:07] [config] dim-rnn: 1024
[2023-07-22 09:15:07] [config] dim-vocabs:
[2023-07-22 09:15:07] [config]   - 16384
[2023-07-22 09:15:07] [config]   - 16384
[2023-07-22 09:15:07] [config] disp-first: 0
[2023-07-22 09:15:07] [config] disp-freq: 1000u
[2023-07-22 09:15:07] [config] disp-label-counts: true
[2023-07-22 09:15:07] [config] dropout-rnn: 0
[2023-07-22 09:15:07] [config] dropout-src: 0
[2023-07-22 09:15:07] [config] dropout-trg: 0
[2023-07-22 09:15:07] [config] dump-config: ""
[2023-07-22 09:15:07] [config] dynamic-gradient-scaling:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] early-stopping: 200
[2023-07-22 09:15:07] [config] early-stopping-on: first
[2023-07-22 09:15:07] [config] embedding-fix-src: false
[2023-07-22 09:15:07] [config] embedding-fix-trg: false
[2023-07-22 09:15:07] [config] embedding-normalization: false
[2023-07-22 09:15:07] [config] embedding-vectors:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] enc-cell: gru
[2023-07-22 09:15:07] [config] enc-cell-depth: 1
[2023-07-22 09:15:07] [config] enc-depth: 2
[2023-07-22 09:15:07] [config] enc-type: bidirectional
[2023-07-22 09:15:07] [config] english-title-case-every: 0
[2023-07-22 09:15:07] [config] exponential-smoothing: 0
[2023-07-22 09:15:07] [config] factor-weight: 1
[2023-07-22 09:15:07] [config] factors-combine: sum
[2023-07-22 09:15:07] [config] factors-dim-emb: 0
[2023-07-22 09:15:07] [config] gradient-checkpointing: false
[2023-07-22 09:15:07] [config] gradient-norm-average-window: 100
[2023-07-22 09:15:07] [config] guided-alignment: none
[2023-07-22 09:15:07] [config] guided-alignment-cost: mse
[2023-07-22 09:15:07] [config] guided-alignment-weight: 0.1
[2023-07-22 09:15:07] [config] ignore-model-config: false
[2023-07-22 09:15:07] [config] input-types:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] interpolate-env-vars: false
[2023-07-22 09:15:07] [config] keep-best: false
[2023-07-22 09:15:07] [config] label-smoothing: 0
[2023-07-22 09:15:07] [config] layer-normalization: false
[2023-07-22 09:15:07] [config] learn-rate: 0.0001
[2023-07-22 09:15:07] [config] lemma-dependency: ""
[2023-07-22 09:15:07] [config] lemma-dim-emb: 0
[2023-07-22 09:15:07] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:07] [config] log-level: info
[2023-07-22 09:15:07] [config] log-time-zone: ""
[2023-07-22 09:15:07] [config] logical-epoch:
[2023-07-22 09:15:07] [config]   - 1e
[2023-07-22 09:15:07] [config]   - 0
[2023-07-22 09:15:07] [config] lr-decay: 0
[2023-07-22 09:15:07] [config] lr-decay-freq: 50000
[2023-07-22 09:15:07] [config] lr-decay-inv-sqrt:
[2023-07-22 09:15:07] [config]   - 0
[2023-07-22 09:15:07] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:15:07] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:15:07] [config] lr-decay-start:
[2023-07-22 09:15:07] [config]   - 10
[2023-07-22 09:15:07] [config]   - 1
[2023-07-22 09:15:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:15:07] [config] lr-report: false
[2023-07-22 09:15:07] [config] lr-warmup: 0
[2023-07-22 09:15:07] [config] lr-warmup-at-reload: false
[2023-07-22 09:15:07] [config] lr-warmup-cycle: false
[2023-07-22 09:15:07] [config] lr-warmup-start-rate: 0
[2023-07-22 09:15:07] [config] max-length: 50
[2023-07-22 09:15:07] [config] max-length-crop: true
[2023-07-22 09:15:07] [config] max-length-factor: 3
[2023-07-22 09:15:07] [config] maxi-batch: 100
[2023-07-22 09:15:07] [config] maxi-batch-sort: trg
[2023-07-22 09:15:07] [config] mini-batch: 64
[2023-07-22 09:15:07] [config] mini-batch-fit: true
[2023-07-22 09:15:07] [config] mini-batch-fit-step: 10
[2023-07-22 09:15:07] [config] mini-batch-round-up: true
[2023-07-22 09:15:07] [config] mini-batch-track-lr: false
[2023-07-22 09:15:07] [config] mini-batch-warmup: 0
[2023-07-22 09:15:07] [config] mini-batch-words: 0
[2023-07-22 09:15:07] [config] mini-batch-words-ref: 0
[2023-07-22 09:15:07] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:15:07] [config] multi-loss-type: sum
[2023-07-22 09:15:07] [config] n-best: false
[2023-07-22 09:15:07] [config] no-nccl: false
[2023-07-22 09:15:07] [config] no-reload: false
[2023-07-22 09:15:07] [config] no-restore-corpus: false
[2023-07-22 09:15:07] [config] normalize: 0
[2023-07-22 09:15:07] [config] normalize-gradient: false
[2023-07-22 09:15:07] [config] num-devices: 0
[2023-07-22 09:15:07] [config] optimizer: adam
[2023-07-22 09:15:07] [config] optimizer-delay: 1
[2023-07-22 09:15:07] [config] optimizer-params:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] output-omit-bias: false
[2023-07-22 09:15:07] [config] overwrite: true
[2023-07-22 09:15:07] [config] precision:
[2023-07-22 09:15:07] [config]   - float16
[2023-07-22 09:15:07] [config]   - float32
[2023-07-22 09:15:07] [config] pretrained-model: ""
[2023-07-22 09:15:07] [config] quantize-biases: false
[2023-07-22 09:15:07] [config] quantize-bits: 0
[2023-07-22 09:15:07] [config] quantize-log-based: false
[2023-07-22 09:15:07] [config] quantize-optimization-steps: 0
[2023-07-22 09:15:07] [config] quiet: false
[2023-07-22 09:15:07] [config] quiet-translation: true
[2023-07-22 09:15:07] [config] relative-paths: false
[2023-07-22 09:15:07] [config] right-left: false
[2023-07-22 09:15:07] [config] save-freq: 10000u
[2023-07-22 09:15:07] [config] seed: 1234
[2023-07-22 09:15:07] [config] sentencepiece-alphas:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:15:07] [config] sentencepiece-options: ""
[2023-07-22 09:15:07] [config] sharding: global
[2023-07-22 09:15:07] [config] shuffle: data
[2023-07-22 09:15:07] [config] shuffle-in-ram: false
[2023-07-22 09:15:07] [config] sigterm: save-and-exit
[2023-07-22 09:15:07] [config] skip: false
[2023-07-22 09:15:07] [config] sqlite: ""
[2023-07-22 09:15:07] [config] sqlite-drop: false
[2023-07-22 09:15:07] [config] sync-freq: 200u
[2023-07-22 09:15:07] [config] sync-sgd: false
[2023-07-22 09:15:07] [config] tempdir: /tmp
[2023-07-22 09:15:07] [config] tied-embeddings: false
[2023-07-22 09:15:07] [config] tied-embeddings-all: true
[2023-07-22 09:15:07] [config] tied-embeddings-src: false
[2023-07-22 09:15:07] [config] train-embedder-rank:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] train-sets:
[2023-07-22 09:15:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:15:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:15:07] [config] transformer-aan-activation: swish
[2023-07-22 09:15:07] [config] transformer-aan-depth: 2
[2023-07-22 09:15:07] [config] transformer-aan-nogate: false
[2023-07-22 09:15:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:15:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:15:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:15:07] [config] transformer-depth-scaling: false
[2023-07-22 09:15:07] [config] transformer-dim-aan: 2048
[2023-07-22 09:15:07] [config] transformer-dim-ffn: 2048
[2023-07-22 09:15:07] [config] transformer-dropout: 0
[2023-07-22 09:15:07] [config] transformer-dropout-attention: 0
[2023-07-22 09:15:07] [config] transformer-dropout-ffn: 0
[2023-07-22 09:15:07] [config] transformer-ffn-activation: swish
[2023-07-22 09:15:07] [config] transformer-ffn-depth: 2
[2023-07-22 09:15:07] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:15:07] [config] transformer-heads: 8
[2023-07-22 09:15:07] [config] transformer-no-projection: false
[2023-07-22 09:15:07] [config] transformer-pool: false
[2023-07-22 09:15:07] [config] transformer-postprocess: dan
[2023-07-22 09:15:07] [config] transformer-postprocess-emb: d
[2023-07-22 09:15:07] [config] transformer-postprocess-top: ""
[2023-07-22 09:15:07] [config] transformer-preprocess: ""
[2023-07-22 09:15:07] [config] transformer-tied-layers:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] transformer-train-position-embeddings: false
[2023-07-22 09:15:07] [config] tsv: false
[2023-07-22 09:15:07] [config] tsv-fields: 0
[2023-07-22 09:15:07] [config] type: amun
[2023-07-22 09:15:07] [config] ulr: false
[2023-07-22 09:15:07] [config] ulr-dim-emb: 0
[2023-07-22 09:15:07] [config] ulr-dropout: 0
[2023-07-22 09:15:07] [config] ulr-keys-vectors: ""
[2023-07-22 09:15:07] [config] ulr-query-vectors: ""
[2023-07-22 09:15:07] [config] ulr-softmax-temperature: 1
[2023-07-22 09:15:07] [config] ulr-trainable-transformation: false
[2023-07-22 09:15:07] [config] unlikelihood-loss: false
[2023-07-22 09:15:07] [config] valid-freq: 50000000
[2023-07-22 09:15:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:07] [config] valid-max-length: 1000
[2023-07-22 09:15:07] [config] valid-metrics:
[2023-07-22 09:15:07] [config]   - cross-entropy
[2023-07-22 09:15:07] [config]   - translation
[2023-07-22 09:15:07] [config] valid-mini-batch: 32
[2023-07-22 09:15:07] [config] valid-reset-stalled: false
[2023-07-22 09:15:07] [config] valid-script-args:
[2023-07-22 09:15:07] [config]   []
[2023-07-22 09:15:07] [config] valid-script-path: ""
[2023-07-22 09:15:07] [config] valid-sets:
[2023-07-22 09:15:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:15:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:15:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:15:07] [config] vocabs:
[2023-07-22 09:15:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:07] [config] word-penalty: 0
[2023-07-22 09:15:07] [config] word-scores: false
[2023-07-22 09:15:07] [config] workspace: 5500
[2023-07-22 09:15:07] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:07] [training] Using single-device training
[2023-07-22 09:15:08] Synced seed 1234
[2023-07-22 09:15:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:15:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:15:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:15:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:08] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:15:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:15:09] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:15:09] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x56543a7f9141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x56543a73bda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x56543a7401a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x56543a7472ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x56543a8f3a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x56543a8f4a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x56543a8cdbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x56543a3cf108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x56543a2f12c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56543a2a8b9c]    main                                               + 0x3c
[0x7f0292c560b3]    __libc_start_main                                  + 0xf3
[0x56543a2efcbe]    _start                                             + 0x2e

[2023-07-22 09:15:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:12] [marian] Running on node23.datos.cluster.uy as process 27480 with command line:
[2023-07-22 09:15:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-depth 2 --dec-depth 2
[2023-07-22 09:15:12] [config] after: 0e
[2023-07-22 09:15:12] [config] after-batches: 0
[2023-07-22 09:15:12] [config] after-epochs: 200
[2023-07-22 09:15:12] [config] all-caps-every: 0
[2023-07-22 09:15:12] [config] allow-unk: false
[2023-07-22 09:15:12] [config] authors: false
[2023-07-22 09:15:12] [config] beam-size: 12
[2023-07-22 09:15:12] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:15:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:15:12] [config] bert-masking-fraction: 0.15
[2023-07-22 09:15:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:15:12] [config] bert-train-type-embeddings: true
[2023-07-22 09:15:12] [config] bert-type-vocab-size: 2
[2023-07-22 09:15:12] [config] build-info: ""
[2023-07-22 09:15:12] [config] check-gradient-nan: false
[2023-07-22 09:15:12] [config] check-nan: false
[2023-07-22 09:15:12] [config] cite: false
[2023-07-22 09:15:12] [config] clip-norm: 1
[2023-07-22 09:15:12] [config] cost-scaling:
[2023-07-22 09:15:12] [config]   - 256.f
[2023-07-22 09:15:12] [config]   - 1000
[2023-07-22 09:15:12] [config]   - 2.f
[2023-07-22 09:15:12] [config]   - 256.f
[2023-07-22 09:15:12] [config] cost-type: ce-sum
[2023-07-22 09:15:12] [config] cpu-threads: 0
[2023-07-22 09:15:12] [config] data-threads: 8
[2023-07-22 09:15:12] [config] data-weighting: ""
[2023-07-22 09:15:12] [config] data-weighting-type: sentence
[2023-07-22 09:15:12] [config] dec-cell: gru
[2023-07-22 09:15:12] [config] dec-cell-base-depth: 2
[2023-07-22 09:15:12] [config] dec-cell-high-depth: 1
[2023-07-22 09:15:12] [config] dec-depth: 2
[2023-07-22 09:15:12] [config] devices:
[2023-07-22 09:15:12] [config]   - 0
[2023-07-22 09:15:12] [config] dim-emb: 512
[2023-07-22 09:15:12] [config] dim-rnn: 1024
[2023-07-22 09:15:12] [config] dim-vocabs:
[2023-07-22 09:15:12] [config]   - 16384
[2023-07-22 09:15:12] [config]   - 16384
[2023-07-22 09:15:12] [config] disp-first: 0
[2023-07-22 09:15:12] [config] disp-freq: 1000u
[2023-07-22 09:15:12] [config] disp-label-counts: true
[2023-07-22 09:15:12] [config] dropout-rnn: 0
[2023-07-22 09:15:12] [config] dropout-src: 0
[2023-07-22 09:15:12] [config] dropout-trg: 0
[2023-07-22 09:15:12] [config] dump-config: ""
[2023-07-22 09:15:12] [config] dynamic-gradient-scaling:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] early-stopping: 200
[2023-07-22 09:15:12] [config] early-stopping-on: first
[2023-07-22 09:15:12] [config] embedding-fix-src: false
[2023-07-22 09:15:12] [config] embedding-fix-trg: false
[2023-07-22 09:15:12] [config] embedding-normalization: false
[2023-07-22 09:15:12] [config] embedding-vectors:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] enc-cell: gru
[2023-07-22 09:15:12] [config] enc-cell-depth: 1
[2023-07-22 09:15:12] [config] enc-depth: 2
[2023-07-22 09:15:12] [config] enc-type: bidirectional
[2023-07-22 09:15:12] [config] english-title-case-every: 0
[2023-07-22 09:15:12] [config] exponential-smoothing: 0
[2023-07-22 09:15:12] [config] factor-weight: 1
[2023-07-22 09:15:12] [config] factors-combine: sum
[2023-07-22 09:15:12] [config] factors-dim-emb: 0
[2023-07-22 09:15:12] [config] gradient-checkpointing: false
[2023-07-22 09:15:12] [config] gradient-norm-average-window: 100
[2023-07-22 09:15:12] [config] guided-alignment: none
[2023-07-22 09:15:12] [config] guided-alignment-cost: mse
[2023-07-22 09:15:12] [config] guided-alignment-weight: 0.1
[2023-07-22 09:15:12] [config] ignore-model-config: false
[2023-07-22 09:15:12] [config] input-types:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] interpolate-env-vars: false
[2023-07-22 09:15:12] [config] keep-best: false
[2023-07-22 09:15:12] [config] label-smoothing: 0
[2023-07-22 09:15:12] [config] layer-normalization: false
[2023-07-22 09:15:12] [config] learn-rate: 0.0001
[2023-07-22 09:15:12] [config] lemma-dependency: ""
[2023-07-22 09:15:12] [config] lemma-dim-emb: 0
[2023-07-22 09:15:12] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:12] [config] log-level: info
[2023-07-22 09:15:12] [config] log-time-zone: ""
[2023-07-22 09:15:12] [config] logical-epoch:
[2023-07-22 09:15:12] [config]   - 1e
[2023-07-22 09:15:12] [config]   - 0
[2023-07-22 09:15:12] [config] lr-decay: 0
[2023-07-22 09:15:12] [config] lr-decay-freq: 50000
[2023-07-22 09:15:12] [config] lr-decay-inv-sqrt:
[2023-07-22 09:15:12] [config]   - 0
[2023-07-22 09:15:12] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:15:12] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:15:12] [config] lr-decay-start:
[2023-07-22 09:15:12] [config]   - 10
[2023-07-22 09:15:12] [config]   - 1
[2023-07-22 09:15:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:15:12] [config] lr-report: false
[2023-07-22 09:15:12] [config] lr-warmup: 0
[2023-07-22 09:15:12] [config] lr-warmup-at-reload: false
[2023-07-22 09:15:12] [config] lr-warmup-cycle: false
[2023-07-22 09:15:12] [config] lr-warmup-start-rate: 0
[2023-07-22 09:15:12] [config] max-length: 50
[2023-07-22 09:15:12] [config] max-length-crop: true
[2023-07-22 09:15:12] [config] max-length-factor: 3
[2023-07-22 09:15:12] [config] maxi-batch: 100
[2023-07-22 09:15:12] [config] maxi-batch-sort: trg
[2023-07-22 09:15:12] [config] mini-batch: 64
[2023-07-22 09:15:12] [config] mini-batch-fit: true
[2023-07-22 09:15:12] [config] mini-batch-fit-step: 10
[2023-07-22 09:15:12] [config] mini-batch-round-up: true
[2023-07-22 09:15:12] [config] mini-batch-track-lr: false
[2023-07-22 09:15:12] [config] mini-batch-warmup: 0
[2023-07-22 09:15:12] [config] mini-batch-words: 0
[2023-07-22 09:15:12] [config] mini-batch-words-ref: 0
[2023-07-22 09:15:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-depth_2_dec-depth_2.npz
[2023-07-22 09:15:12] [config] multi-loss-type: sum
[2023-07-22 09:15:12] [config] n-best: false
[2023-07-22 09:15:12] [config] no-nccl: false
[2023-07-22 09:15:12] [config] no-reload: false
[2023-07-22 09:15:12] [config] no-restore-corpus: false
[2023-07-22 09:15:12] [config] normalize: 0
[2023-07-22 09:15:12] [config] normalize-gradient: false
[2023-07-22 09:15:12] [config] num-devices: 0
[2023-07-22 09:15:12] [config] optimizer: adam
[2023-07-22 09:15:12] [config] optimizer-delay: 1
[2023-07-22 09:15:12] [config] optimizer-params:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] output-omit-bias: false
[2023-07-22 09:15:12] [config] overwrite: true
[2023-07-22 09:15:12] [config] precision:
[2023-07-22 09:15:12] [config]   - float16
[2023-07-22 09:15:12] [config]   - float32
[2023-07-22 09:15:12] [config] pretrained-model: ""
[2023-07-22 09:15:12] [config] quantize-biases: false
[2023-07-22 09:15:12] [config] quantize-bits: 0
[2023-07-22 09:15:12] [config] quantize-log-based: false
[2023-07-22 09:15:12] [config] quantize-optimization-steps: 0
[2023-07-22 09:15:12] [config] quiet: false
[2023-07-22 09:15:12] [config] quiet-translation: true
[2023-07-22 09:15:12] [config] relative-paths: false
[2023-07-22 09:15:12] [config] right-left: false
[2023-07-22 09:15:12] [config] save-freq: 10000u
[2023-07-22 09:15:12] [config] seed: 1234
[2023-07-22 09:15:12] [config] sentencepiece-alphas:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:15:12] [config] sentencepiece-options: ""
[2023-07-22 09:15:12] [config] sharding: global
[2023-07-22 09:15:12] [config] shuffle: data
[2023-07-22 09:15:12] [config] shuffle-in-ram: false
[2023-07-22 09:15:12] [config] sigterm: save-and-exit
[2023-07-22 09:15:12] [config] skip: false
[2023-07-22 09:15:12] [config] sqlite: ""
[2023-07-22 09:15:12] [config] sqlite-drop: false
[2023-07-22 09:15:12] [config] sync-freq: 200u
[2023-07-22 09:15:12] [config] sync-sgd: false
[2023-07-22 09:15:12] [config] tempdir: /tmp
[2023-07-22 09:15:12] [config] tied-embeddings: false
[2023-07-22 09:15:12] [config] tied-embeddings-all: true
[2023-07-22 09:15:12] [config] tied-embeddings-src: false
[2023-07-22 09:15:12] [config] train-embedder-rank:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] train-sets:
[2023-07-22 09:15:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:15:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:15:12] [config] transformer-aan-activation: swish
[2023-07-22 09:15:12] [config] transformer-aan-depth: 2
[2023-07-22 09:15:12] [config] transformer-aan-nogate: false
[2023-07-22 09:15:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:15:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:15:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:15:12] [config] transformer-depth-scaling: false
[2023-07-22 09:15:12] [config] transformer-dim-aan: 2048
[2023-07-22 09:15:12] [config] transformer-dim-ffn: 2048
[2023-07-22 09:15:12] [config] transformer-dropout: 0
[2023-07-22 09:15:12] [config] transformer-dropout-attention: 0
[2023-07-22 09:15:12] [config] transformer-dropout-ffn: 0
[2023-07-22 09:15:12] [config] transformer-ffn-activation: swish
[2023-07-22 09:15:12] [config] transformer-ffn-depth: 2
[2023-07-22 09:15:12] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:15:12] [config] transformer-heads: 8
[2023-07-22 09:15:12] [config] transformer-no-projection: false
[2023-07-22 09:15:12] [config] transformer-pool: false
[2023-07-22 09:15:12] [config] transformer-postprocess: dan
[2023-07-22 09:15:12] [config] transformer-postprocess-emb: d
[2023-07-22 09:15:12] [config] transformer-postprocess-top: ""
[2023-07-22 09:15:12] [config] transformer-preprocess: ""
[2023-07-22 09:15:12] [config] transformer-tied-layers:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] transformer-train-position-embeddings: false
[2023-07-22 09:15:12] [config] tsv: false
[2023-07-22 09:15:12] [config] tsv-fields: 0
[2023-07-22 09:15:12] [config] type: amun
[2023-07-22 09:15:12] [config] ulr: false
[2023-07-22 09:15:12] [config] ulr-dim-emb: 0
[2023-07-22 09:15:12] [config] ulr-dropout: 0
[2023-07-22 09:15:12] [config] ulr-keys-vectors: ""
[2023-07-22 09:15:12] [config] ulr-query-vectors: ""
[2023-07-22 09:15:12] [config] ulr-softmax-temperature: 1
[2023-07-22 09:15:12] [config] ulr-trainable-transformation: false
[2023-07-22 09:15:12] [config] unlikelihood-loss: false
[2023-07-22 09:15:12] [config] valid-freq: 50000000
[2023-07-22 09:15:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:12] [config] valid-max-length: 1000
[2023-07-22 09:15:12] [config] valid-metrics:
[2023-07-22 09:15:12] [config]   - cross-entropy
[2023-07-22 09:15:12] [config]   - translation
[2023-07-22 09:15:12] [config] valid-mini-batch: 32
[2023-07-22 09:15:12] [config] valid-reset-stalled: false
[2023-07-22 09:15:12] [config] valid-script-args:
[2023-07-22 09:15:12] [config]   []
[2023-07-22 09:15:12] [config] valid-script-path: ""
[2023-07-22 09:15:12] [config] valid-sets:
[2023-07-22 09:15:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:15:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:15:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:15:12] [config] vocabs:
[2023-07-22 09:15:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:12] [config] word-penalty: 0
[2023-07-22 09:15:12] [config] word-scores: false
[2023-07-22 09:15:12] [config] workspace: 5500
[2023-07-22 09:15:12] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:12] [training] Using single-device training
[2023-07-22 09:15:12] Synced seed 1234
[2023-07-22 09:15:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:15:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:15:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:15:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:12] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:15:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:15:14] Error: --type amun does not support multiple encoder layers, use --type s2s
[2023-07-22 09:15:14] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:12

[CALL STACK]
[0x5572f05d8141]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x261
[0x5572f051ada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5572f051f1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5572f05262ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5572f06d2a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5572f06d3a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5572f06acbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5572f01ae108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5572f00d02c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5572f0087b9c]    main                                               + 0x3c
[0x7fa5227970b3]    __libc_start_main                                  + 0xf3
[0x5572f00cecbe]    _start                                             + 0x2e

[2023-07-22 09:15:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:56] [marian] Running on node23.datos.cluster.uy as process 27582 with command line:
[2023-07-22 09:15:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 09:15:56] [config] after: 0e
[2023-07-22 09:15:56] [config] after-batches: 0
[2023-07-22 09:15:56] [config] after-epochs: 10
[2023-07-22 09:15:56] [config] all-caps-every: 0
[2023-07-22 09:15:56] [config] allow-unk: false
[2023-07-22 09:15:56] [config] authors: false
[2023-07-22 09:15:56] [config] beam-size: 12
[2023-07-22 09:15:56] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:15:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:15:56] [config] bert-masking-fraction: 0.15
[2023-07-22 09:15:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:15:56] [config] bert-train-type-embeddings: true
[2023-07-22 09:15:56] [config] bert-type-vocab-size: 2
[2023-07-22 09:15:56] [config] build-info: ""
[2023-07-22 09:15:56] [config] check-gradient-nan: false
[2023-07-22 09:15:56] [config] check-nan: false
[2023-07-22 09:15:56] [config] cite: false
[2023-07-22 09:15:56] [config] clip-norm: 1
[2023-07-22 09:15:56] [config] cost-scaling:
[2023-07-22 09:15:56] [config]   - 256.f
[2023-07-22 09:15:56] [config]   - 1000
[2023-07-22 09:15:56] [config]   - 2.f
[2023-07-22 09:15:56] [config]   - 256.f
[2023-07-22 09:15:56] [config] cost-type: ce-sum
[2023-07-22 09:15:56] [config] cpu-threads: 0
[2023-07-22 09:15:56] [config] data-threads: 8
[2023-07-22 09:15:56] [config] data-weighting: ""
[2023-07-22 09:15:56] [config] data-weighting-type: sentence
[2023-07-22 09:15:56] [config] dec-cell: gru
[2023-07-22 09:15:56] [config] dec-cell-base-depth: 2
[2023-07-22 09:15:56] [config] dec-cell-high-depth: 1
[2023-07-22 09:15:56] [config] dec-depth: 1
[2023-07-22 09:15:56] [config] devices:
[2023-07-22 09:15:56] [config]   - 0
[2023-07-22 09:15:56] [config] dim-emb: 512
[2023-07-22 09:15:56] [config] dim-rnn: 1024
[2023-07-22 09:15:56] [config] dim-vocabs:
[2023-07-22 09:15:56] [config]   - 16384
[2023-07-22 09:15:56] [config]   - 16384
[2023-07-22 09:15:56] [config] disp-first: 0
[2023-07-22 09:15:56] [config] disp-freq: 1000u
[2023-07-22 09:15:56] [config] disp-label-counts: true
[2023-07-22 09:15:56] [config] dropout-rnn: 0
[2023-07-22 09:15:56] [config] dropout-src: 0
[2023-07-22 09:15:56] [config] dropout-trg: 0
[2023-07-22 09:15:56] [config] dump-config: ""
[2023-07-22 09:15:56] [config] dynamic-gradient-scaling:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] early-stopping: 200
[2023-07-22 09:15:56] [config] early-stopping-on: first
[2023-07-22 09:15:56] [config] embedding-fix-src: false
[2023-07-22 09:15:56] [config] embedding-fix-trg: false
[2023-07-22 09:15:56] [config] embedding-normalization: false
[2023-07-22 09:15:56] [config] embedding-vectors:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] enc-cell: gru
[2023-07-22 09:15:56] [config] enc-cell-depth: 1
[2023-07-22 09:15:56] [config] enc-depth: 1
[2023-07-22 09:15:56] [config] enc-type: bidirectional
[2023-07-22 09:15:56] [config] english-title-case-every: 0
[2023-07-22 09:15:56] [config] exponential-smoothing: 0
[2023-07-22 09:15:56] [config] factor-weight: 1
[2023-07-22 09:15:56] [config] factors-combine: sum
[2023-07-22 09:15:56] [config] factors-dim-emb: 0
[2023-07-22 09:15:56] [config] gradient-checkpointing: false
[2023-07-22 09:15:56] [config] gradient-norm-average-window: 100
[2023-07-22 09:15:56] [config] guided-alignment: none
[2023-07-22 09:15:56] [config] guided-alignment-cost: mse
[2023-07-22 09:15:56] [config] guided-alignment-weight: 0.1
[2023-07-22 09:15:56] [config] ignore-model-config: false
[2023-07-22 09:15:56] [config] input-types:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] interpolate-env-vars: false
[2023-07-22 09:15:56] [config] keep-best: false
[2023-07-22 09:15:56] [config] label-smoothing: 0
[2023-07-22 09:15:56] [config] layer-normalization: false
[2023-07-22 09:15:56] [config] learn-rate: 0.0001
[2023-07-22 09:15:56] [config] lemma-dependency: ""
[2023-07-22 09:15:56] [config] lemma-dim-emb: 0
[2023-07-22 09:15:56] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:56] [config] log-level: info
[2023-07-22 09:15:56] [config] log-time-zone: ""
[2023-07-22 09:15:56] [config] logical-epoch:
[2023-07-22 09:15:56] [config]   - 1e
[2023-07-22 09:15:56] [config]   - 0
[2023-07-22 09:15:56] [config] lr-decay: 0
[2023-07-22 09:15:56] [config] lr-decay-freq: 50000
[2023-07-22 09:15:56] [config] lr-decay-inv-sqrt:
[2023-07-22 09:15:56] [config]   - 0
[2023-07-22 09:15:56] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:15:56] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:15:56] [config] lr-decay-start:
[2023-07-22 09:15:56] [config]   - 10
[2023-07-22 09:15:56] [config]   - 1
[2023-07-22 09:15:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:15:56] [config] lr-report: false
[2023-07-22 09:15:56] [config] lr-warmup: 0
[2023-07-22 09:15:56] [config] lr-warmup-at-reload: false
[2023-07-22 09:15:56] [config] lr-warmup-cycle: false
[2023-07-22 09:15:56] [config] lr-warmup-start-rate: 0
[2023-07-22 09:15:56] [config] max-length: 50
[2023-07-22 09:15:56] [config] max-length-crop: true
[2023-07-22 09:15:56] [config] max-length-factor: 3
[2023-07-22 09:15:56] [config] maxi-batch: 100
[2023-07-22 09:15:56] [config] maxi-batch-sort: trg
[2023-07-22 09:15:56] [config] mini-batch: 64
[2023-07-22 09:15:56] [config] mini-batch-fit: true
[2023-07-22 09:15:56] [config] mini-batch-fit-step: 10
[2023-07-22 09:15:56] [config] mini-batch-round-up: true
[2023-07-22 09:15:56] [config] mini-batch-track-lr: false
[2023-07-22 09:15:56] [config] mini-batch-warmup: 0
[2023-07-22 09:15:56] [config] mini-batch-words: 0
[2023-07-22 09:15:56] [config] mini-batch-words-ref: 0
[2023-07-22 09:15:56] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 09:15:56] [config] multi-loss-type: sum
[2023-07-22 09:15:56] [config] n-best: false
[2023-07-22 09:15:56] [config] no-nccl: false
[2023-07-22 09:15:56] [config] no-reload: false
[2023-07-22 09:15:56] [config] no-restore-corpus: false
[2023-07-22 09:15:56] [config] normalize: 0
[2023-07-22 09:15:56] [config] normalize-gradient: false
[2023-07-22 09:15:56] [config] num-devices: 0
[2023-07-22 09:15:56] [config] optimizer: adam
[2023-07-22 09:15:56] [config] optimizer-delay: 1
[2023-07-22 09:15:56] [config] optimizer-params:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] output-omit-bias: false
[2023-07-22 09:15:56] [config] overwrite: true
[2023-07-22 09:15:56] [config] precision:
[2023-07-22 09:15:56] [config]   - float16
[2023-07-22 09:15:56] [config]   - float32
[2023-07-22 09:15:56] [config] pretrained-model: ""
[2023-07-22 09:15:56] [config] quantize-biases: false
[2023-07-22 09:15:56] [config] quantize-bits: 0
[2023-07-22 09:15:56] [config] quantize-log-based: false
[2023-07-22 09:15:56] [config] quantize-optimization-steps: 0
[2023-07-22 09:15:56] [config] quiet: false
[2023-07-22 09:15:56] [config] quiet-translation: true
[2023-07-22 09:15:56] [config] relative-paths: false
[2023-07-22 09:15:56] [config] right-left: false
[2023-07-22 09:15:56] [config] save-freq: 10000u
[2023-07-22 09:15:56] [config] seed: 1234
[2023-07-22 09:15:56] [config] sentencepiece-alphas:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:15:56] [config] sentencepiece-options: ""
[2023-07-22 09:15:56] [config] sharding: global
[2023-07-22 09:15:56] [config] shuffle: data
[2023-07-22 09:15:56] [config] shuffle-in-ram: false
[2023-07-22 09:15:56] [config] sigterm: save-and-exit
[2023-07-22 09:15:56] [config] skip: false
[2023-07-22 09:15:56] [config] sqlite: ""
[2023-07-22 09:15:56] [config] sqlite-drop: false
[2023-07-22 09:15:56] [config] sync-freq: 200u
[2023-07-22 09:15:56] [config] sync-sgd: false
[2023-07-22 09:15:56] [config] tempdir: /tmp
[2023-07-22 09:15:56] [config] tied-embeddings: false
[2023-07-22 09:15:56] [config] tied-embeddings-all: true
[2023-07-22 09:15:56] [config] tied-embeddings-src: false
[2023-07-22 09:15:56] [config] train-embedder-rank:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] train-sets:
[2023-07-22 09:15:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:15:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:15:56] [config] transformer-aan-activation: swish
[2023-07-22 09:15:56] [config] transformer-aan-depth: 2
[2023-07-22 09:15:56] [config] transformer-aan-nogate: false
[2023-07-22 09:15:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:15:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:15:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:15:56] [config] transformer-depth-scaling: false
[2023-07-22 09:15:56] [config] transformer-dim-aan: 2048
[2023-07-22 09:15:56] [config] transformer-dim-ffn: 2048
[2023-07-22 09:15:56] [config] transformer-dropout: 0
[2023-07-22 09:15:56] [config] transformer-dropout-attention: 0
[2023-07-22 09:15:56] [config] transformer-dropout-ffn: 0
[2023-07-22 09:15:56] [config] transformer-ffn-activation: swish
[2023-07-22 09:15:56] [config] transformer-ffn-depth: 2
[2023-07-22 09:15:56] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:15:56] [config] transformer-heads: 8
[2023-07-22 09:15:56] [config] transformer-no-projection: false
[2023-07-22 09:15:56] [config] transformer-pool: false
[2023-07-22 09:15:56] [config] transformer-postprocess: dan
[2023-07-22 09:15:56] [config] transformer-postprocess-emb: d
[2023-07-22 09:15:56] [config] transformer-postprocess-top: ""
[2023-07-22 09:15:56] [config] transformer-preprocess: ""
[2023-07-22 09:15:56] [config] transformer-tied-layers:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] transformer-train-position-embeddings: false
[2023-07-22 09:15:56] [config] tsv: false
[2023-07-22 09:15:56] [config] tsv-fields: 0
[2023-07-22 09:15:56] [config] type: amun
[2023-07-22 09:15:56] [config] ulr: false
[2023-07-22 09:15:56] [config] ulr-dim-emb: 0
[2023-07-22 09:15:56] [config] ulr-dropout: 0
[2023-07-22 09:15:56] [config] ulr-keys-vectors: ""
[2023-07-22 09:15:56] [config] ulr-query-vectors: ""
[2023-07-22 09:15:56] [config] ulr-softmax-temperature: 1
[2023-07-22 09:15:56] [config] ulr-trainable-transformation: false
[2023-07-22 09:15:56] [config] unlikelihood-loss: false
[2023-07-22 09:15:56] [config] valid-freq: 50000000
[2023-07-22 09:15:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:15:56] [config] valid-max-length: 1000
[2023-07-22 09:15:56] [config] valid-metrics:
[2023-07-22 09:15:56] [config]   - cross-entropy
[2023-07-22 09:15:56] [config]   - translation
[2023-07-22 09:15:56] [config] valid-mini-batch: 32
[2023-07-22 09:15:56] [config] valid-reset-stalled: false
[2023-07-22 09:15:56] [config] valid-script-args:
[2023-07-22 09:15:56] [config]   []
[2023-07-22 09:15:56] [config] valid-script-path: ""
[2023-07-22 09:15:56] [config] valid-sets:
[2023-07-22 09:15:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:15:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:15:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:15:56] [config] vocabs:
[2023-07-22 09:15:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:56] [config] word-penalty: 0
[2023-07-22 09:15:56] [config] word-scores: false
[2023-07-22 09:15:56] [config] workspace: 5500
[2023-07-22 09:15:56] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:15:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:56] [training] Using single-device training
[2023-07-22 09:15:56] Synced seed 1234
[2023-07-22 09:15:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:15:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:15:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:15:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:15:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:15:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:15:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:15:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:15:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 09:15:57] [comm] Using global sharding
[2023-07-22 09:15:58] [comm] NCCLCommunicators constructed successfully
[2023-07-22 09:15:58] [training] Using 1 GPUs
[2023-07-22 09:15:58] [logits] Applying loss function for 1 factor(s)
[2023-07-22 09:15:58] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:15:58] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 09:15:58] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:20:37] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 09:20:37] [valid] No post-processing script given for validating translator
[2023-07-22 09:20:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:20:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:20:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 09:20:37] [comm] Using global sharding
[2023-07-22 09:20:38] [comm] NCCLCommunicators constructed successfully
[2023-07-22 09:20:38] [training] Using 1 GPUs
[2023-07-22 09:20:38] Training started
[2023-07-22 09:20:38] [data] Shuffling data
[2023-07-22 09:20:38] [data] Done reading 20,192 sentences
[2023-07-22 09:20:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:20:38] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 09:20:38] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:20:38] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:20:47] Parameter type float16, optimization type float32, casting types true
[2023-07-22 09:20:47] Allocating memory for general optimizer shards
[2023-07-22 09:20:47] [memory] Reserving 322 MB, device gpu0
[2023-07-22 09:20:47] Allocating memory for Adam-specific shards
[2023-07-22 09:20:47] [memory] Reserving 322 MB, device gpu0
[2023-07-22 09:23:04] Seen 20,192 samples
[2023-07-22 09:23:04] Starting data epoch 2 in logical epoch 2
[2023-07-22 09:23:04] [data] Shuffling data
[2023-07-22 09:23:04] [data] Done reading 20,192 sentences
[2023-07-22 09:23:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:26:02] Seen 20,192 samples
[2023-07-22 09:26:02] Starting data epoch 3 in logical epoch 3
[2023-07-22 09:26:02] [data] Shuffling data
[2023-07-22 09:26:02] [data] Done reading 20,192 sentences
[2023-07-22 09:26:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:29:46] Seen 20,192 samples
[2023-07-22 09:29:46] Starting data epoch 4 in logical epoch 4
[2023-07-22 09:29:46] [data] Shuffling data
[2023-07-22 09:29:46] [data] Done reading 20,192 sentences
[2023-07-22 09:29:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:33:11] Seen 20,192 samples
[2023-07-22 09:33:11] Starting data epoch 5 in logical epoch 5
[2023-07-22 09:33:11] [data] Shuffling data
[2023-07-22 09:33:11] [data] Done reading 20,192 sentences
[2023-07-22 09:33:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:36:30] Seen 20,192 samples
[2023-07-22 09:36:30] Starting data epoch 6 in logical epoch 6
[2023-07-22 09:36:30] [data] Shuffling data
[2023-07-22 09:36:30] [data] Done reading 20,192 sentences
[2023-07-22 09:36:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:40:01] Seen 20,192 samples
[2023-07-22 09:40:01] Starting data epoch 7 in logical epoch 7
[2023-07-22 09:40:01] [data] Shuffling data
[2023-07-22 09:40:01] [data] Done reading 20,192 sentences
[2023-07-22 09:40:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:43:23] Seen 20,192 samples
[2023-07-22 09:43:23] Starting data epoch 8 in logical epoch 8
[2023-07-22 09:43:23] [data] Shuffling data
[2023-07-22 09:43:23] [data] Done reading 20,192 sentences
[2023-07-22 09:43:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:47:00] Seen 20,192 samples
[2023-07-22 09:47:00] Starting data epoch 9 in logical epoch 9
[2023-07-22 09:47:00] [data] Shuffling data
[2023-07-22 09:47:00] [data] Done reading 20,192 sentences
[2023-07-22 09:47:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:50:35] Seen 20,192 samples
[2023-07-22 09:50:35] Starting data epoch 10 in logical epoch 10
[2023-07-22 09:50:35] [data] Shuffling data
[2023-07-22 09:50:35] [data] Done reading 20,192 sentences
[2023-07-22 09:50:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 09:53:43] Seen 20,192 samples
[2023-07-22 09:53:43] Starting data epoch 11 in logical epoch 11
[2023-07-22 09:53:43] Training finished
[2023-07-22 09:53:57] [valid] Ep. 11 : Up. 290 : cross-entropy : 181.514 : new best
[2023-07-22 09:55:18] [valid] Ep. 11 : Up. 290 : translation : 0 : new best
[2023-07-22 09:55:18] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 09:55:19] Saving Adam parameters
[2023-07-22 09:55:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 09:55:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:55:26] [marian] Running on node23.datos.cluster.uy as process 30389 with command line:
[2023-07-22 09:55:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 09:55:26] [config] after: 0e
[2023-07-22 09:55:26] [config] after-batches: 0
[2023-07-22 09:55:26] [config] after-epochs: 20
[2023-07-22 09:55:26] [config] all-caps-every: 0
[2023-07-22 09:55:26] [config] allow-unk: false
[2023-07-22 09:55:26] [config] authors: false
[2023-07-22 09:55:26] [config] beam-size: 12
[2023-07-22 09:55:26] [config] bert-class-symbol: "[CLS]"
[2023-07-22 09:55:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 09:55:26] [config] bert-masking-fraction: 0.15
[2023-07-22 09:55:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 09:55:26] [config] bert-train-type-embeddings: true
[2023-07-22 09:55:26] [config] bert-type-vocab-size: 2
[2023-07-22 09:55:26] [config] build-info: ""
[2023-07-22 09:55:26] [config] check-gradient-nan: false
[2023-07-22 09:55:26] [config] check-nan: false
[2023-07-22 09:55:26] [config] cite: false
[2023-07-22 09:55:26] [config] clip-norm: 1
[2023-07-22 09:55:26] [config] cost-scaling:
[2023-07-22 09:55:26] [config]   - 256.f
[2023-07-22 09:55:26] [config]   - 1000
[2023-07-22 09:55:26] [config]   - 2.f
[2023-07-22 09:55:26] [config]   - 256.f
[2023-07-22 09:55:26] [config] cost-type: ce-sum
[2023-07-22 09:55:26] [config] cpu-threads: 0
[2023-07-22 09:55:26] [config] data-threads: 8
[2023-07-22 09:55:26] [config] data-weighting: ""
[2023-07-22 09:55:26] [config] data-weighting-type: sentence
[2023-07-22 09:55:26] [config] dec-cell: gru
[2023-07-22 09:55:26] [config] dec-cell-base-depth: 2
[2023-07-22 09:55:26] [config] dec-cell-high-depth: 1
[2023-07-22 09:55:26] [config] dec-depth: 1
[2023-07-22 09:55:26] [config] devices:
[2023-07-22 09:55:26] [config]   - 0
[2023-07-22 09:55:26] [config] dim-emb: 512
[2023-07-22 09:55:26] [config] dim-rnn: 1024
[2023-07-22 09:55:26] [config] dim-vocabs:
[2023-07-22 09:55:26] [config]   - 16384
[2023-07-22 09:55:26] [config]   - 16384
[2023-07-22 09:55:26] [config] disp-first: 0
[2023-07-22 09:55:26] [config] disp-freq: 1000u
[2023-07-22 09:55:26] [config] disp-label-counts: true
[2023-07-22 09:55:26] [config] dropout-rnn: 0
[2023-07-22 09:55:26] [config] dropout-src: 0
[2023-07-22 09:55:26] [config] dropout-trg: 0
[2023-07-22 09:55:26] [config] dump-config: ""
[2023-07-22 09:55:26] [config] dynamic-gradient-scaling:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] early-stopping: 200
[2023-07-22 09:55:26] [config] early-stopping-on: first
[2023-07-22 09:55:26] [config] embedding-fix-src: false
[2023-07-22 09:55:26] [config] embedding-fix-trg: false
[2023-07-22 09:55:26] [config] embedding-normalization: false
[2023-07-22 09:55:26] [config] embedding-vectors:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] enc-cell: gru
[2023-07-22 09:55:26] [config] enc-cell-depth: 1
[2023-07-22 09:55:26] [config] enc-depth: 1
[2023-07-22 09:55:26] [config] enc-type: bidirectional
[2023-07-22 09:55:26] [config] english-title-case-every: 0
[2023-07-22 09:55:26] [config] exponential-smoothing: 0
[2023-07-22 09:55:26] [config] factor-weight: 1
[2023-07-22 09:55:26] [config] factors-combine: sum
[2023-07-22 09:55:26] [config] factors-dim-emb: 0
[2023-07-22 09:55:26] [config] gradient-checkpointing: false
[2023-07-22 09:55:26] [config] gradient-norm-average-window: 100
[2023-07-22 09:55:26] [config] guided-alignment: none
[2023-07-22 09:55:26] [config] guided-alignment-cost: mse
[2023-07-22 09:55:26] [config] guided-alignment-weight: 0.1
[2023-07-22 09:55:26] [config] ignore-model-config: false
[2023-07-22 09:55:26] [config] input-types:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] interpolate-env-vars: false
[2023-07-22 09:55:26] [config] keep-best: false
[2023-07-22 09:55:26] [config] label-smoothing: 0
[2023-07-22 09:55:26] [config] layer-normalization: false
[2023-07-22 09:55:26] [config] learn-rate: 0.0001
[2023-07-22 09:55:26] [config] lemma-dependency: ""
[2023-07-22 09:55:26] [config] lemma-dim-emb: 0
[2023-07-22 09:55:26] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:55:26] [config] log-level: info
[2023-07-22 09:55:26] [config] log-time-zone: ""
[2023-07-22 09:55:26] [config] logical-epoch:
[2023-07-22 09:55:26] [config]   - 1e
[2023-07-22 09:55:26] [config]   - 0
[2023-07-22 09:55:26] [config] lr-decay: 0
[2023-07-22 09:55:26] [config] lr-decay-freq: 50000
[2023-07-22 09:55:26] [config] lr-decay-inv-sqrt:
[2023-07-22 09:55:26] [config]   - 0
[2023-07-22 09:55:26] [config] lr-decay-repeat-warmup: false
[2023-07-22 09:55:26] [config] lr-decay-reset-optimizer: false
[2023-07-22 09:55:26] [config] lr-decay-start:
[2023-07-22 09:55:26] [config]   - 10
[2023-07-22 09:55:26] [config]   - 1
[2023-07-22 09:55:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 09:55:26] [config] lr-report: false
[2023-07-22 09:55:26] [config] lr-warmup: 0
[2023-07-22 09:55:26] [config] lr-warmup-at-reload: false
[2023-07-22 09:55:26] [config] lr-warmup-cycle: false
[2023-07-22 09:55:26] [config] lr-warmup-start-rate: 0
[2023-07-22 09:55:26] [config] max-length: 50
[2023-07-22 09:55:26] [config] max-length-crop: true
[2023-07-22 09:55:26] [config] max-length-factor: 3
[2023-07-22 09:55:26] [config] maxi-batch: 100
[2023-07-22 09:55:26] [config] maxi-batch-sort: trg
[2023-07-22 09:55:26] [config] mini-batch: 64
[2023-07-22 09:55:26] [config] mini-batch-fit: true
[2023-07-22 09:55:26] [config] mini-batch-fit-step: 10
[2023-07-22 09:55:26] [config] mini-batch-round-up: true
[2023-07-22 09:55:26] [config] mini-batch-track-lr: false
[2023-07-22 09:55:26] [config] mini-batch-warmup: 0
[2023-07-22 09:55:26] [config] mini-batch-words: 0
[2023-07-22 09:55:26] [config] mini-batch-words-ref: 0
[2023-07-22 09:55:26] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 09:55:26] [config] multi-loss-type: sum
[2023-07-22 09:55:26] [config] n-best: false
[2023-07-22 09:55:26] [config] no-nccl: false
[2023-07-22 09:55:26] [config] no-reload: false
[2023-07-22 09:55:26] [config] no-restore-corpus: false
[2023-07-22 09:55:26] [config] normalize: 0
[2023-07-22 09:55:26] [config] normalize-gradient: false
[2023-07-22 09:55:26] [config] num-devices: 0
[2023-07-22 09:55:26] [config] optimizer: adam
[2023-07-22 09:55:26] [config] optimizer-delay: 1
[2023-07-22 09:55:26] [config] optimizer-params:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] output-omit-bias: false
[2023-07-22 09:55:26] [config] overwrite: true
[2023-07-22 09:55:26] [config] precision:
[2023-07-22 09:55:26] [config]   - float16
[2023-07-22 09:55:26] [config]   - float32
[2023-07-22 09:55:26] [config] pretrained-model: ""
[2023-07-22 09:55:26] [config] quantize-biases: false
[2023-07-22 09:55:26] [config] quantize-bits: 0
[2023-07-22 09:55:26] [config] quantize-log-based: false
[2023-07-22 09:55:26] [config] quantize-optimization-steps: 0
[2023-07-22 09:55:26] [config] quiet: false
[2023-07-22 09:55:26] [config] quiet-translation: true
[2023-07-22 09:55:26] [config] relative-paths: false
[2023-07-22 09:55:26] [config] right-left: false
[2023-07-22 09:55:26] [config] save-freq: 10000u
[2023-07-22 09:55:26] [config] seed: 1234
[2023-07-22 09:55:26] [config] sentencepiece-alphas:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] sentencepiece-max-lines: 2000000
[2023-07-22 09:55:26] [config] sentencepiece-options: ""
[2023-07-22 09:55:26] [config] sharding: global
[2023-07-22 09:55:26] [config] shuffle: data
[2023-07-22 09:55:26] [config] shuffle-in-ram: false
[2023-07-22 09:55:26] [config] sigterm: save-and-exit
[2023-07-22 09:55:26] [config] skip: false
[2023-07-22 09:55:26] [config] sqlite: ""
[2023-07-22 09:55:26] [config] sqlite-drop: false
[2023-07-22 09:55:26] [config] sync-freq: 200u
[2023-07-22 09:55:26] [config] sync-sgd: false
[2023-07-22 09:55:26] [config] tempdir: /tmp
[2023-07-22 09:55:26] [config] tied-embeddings: false
[2023-07-22 09:55:26] [config] tied-embeddings-all: true
[2023-07-22 09:55:26] [config] tied-embeddings-src: false
[2023-07-22 09:55:26] [config] train-embedder-rank:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] train-sets:
[2023-07-22 09:55:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 09:55:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 09:55:26] [config] transformer-aan-activation: swish
[2023-07-22 09:55:26] [config] transformer-aan-depth: 2
[2023-07-22 09:55:26] [config] transformer-aan-nogate: false
[2023-07-22 09:55:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 09:55:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 09:55:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 09:55:26] [config] transformer-depth-scaling: false
[2023-07-22 09:55:26] [config] transformer-dim-aan: 2048
[2023-07-22 09:55:26] [config] transformer-dim-ffn: 2048
[2023-07-22 09:55:26] [config] transformer-dropout: 0
[2023-07-22 09:55:26] [config] transformer-dropout-attention: 0
[2023-07-22 09:55:26] [config] transformer-dropout-ffn: 0
[2023-07-22 09:55:26] [config] transformer-ffn-activation: swish
[2023-07-22 09:55:26] [config] transformer-ffn-depth: 2
[2023-07-22 09:55:26] [config] transformer-guided-alignment-layer: last
[2023-07-22 09:55:26] [config] transformer-heads: 8
[2023-07-22 09:55:26] [config] transformer-no-projection: false
[2023-07-22 09:55:26] [config] transformer-pool: false
[2023-07-22 09:55:26] [config] transformer-postprocess: dan
[2023-07-22 09:55:26] [config] transformer-postprocess-emb: d
[2023-07-22 09:55:26] [config] transformer-postprocess-top: ""
[2023-07-22 09:55:26] [config] transformer-preprocess: ""
[2023-07-22 09:55:26] [config] transformer-tied-layers:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] transformer-train-position-embeddings: false
[2023-07-22 09:55:26] [config] tsv: false
[2023-07-22 09:55:26] [config] tsv-fields: 0
[2023-07-22 09:55:26] [config] type: amun
[2023-07-22 09:55:26] [config] ulr: false
[2023-07-22 09:55:26] [config] ulr-dim-emb: 0
[2023-07-22 09:55:26] [config] ulr-dropout: 0
[2023-07-22 09:55:26] [config] ulr-keys-vectors: ""
[2023-07-22 09:55:26] [config] ulr-query-vectors: ""
[2023-07-22 09:55:26] [config] ulr-softmax-temperature: 1
[2023-07-22 09:55:26] [config] ulr-trainable-transformation: false
[2023-07-22 09:55:26] [config] unlikelihood-loss: false
[2023-07-22 09:55:26] [config] valid-freq: 50000000
[2023-07-22 09:55:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 09:55:26] [config] valid-max-length: 1000
[2023-07-22 09:55:26] [config] valid-metrics:
[2023-07-22 09:55:26] [config]   - cross-entropy
[2023-07-22 09:55:26] [config]   - translation
[2023-07-22 09:55:26] [config] valid-mini-batch: 32
[2023-07-22 09:55:26] [config] valid-reset-stalled: false
[2023-07-22 09:55:26] [config] valid-script-args:
[2023-07-22 09:55:26] [config]   []
[2023-07-22 09:55:26] [config] valid-script-path: ""
[2023-07-22 09:55:26] [config] valid-sets:
[2023-07-22 09:55:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 09:55:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 09:55:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 09:55:26] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:55:26] [config] vocabs:
[2023-07-22 09:55:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:55:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:55:26] [config] word-penalty: 0
[2023-07-22 09:55:26] [config] word-scores: false
[2023-07-22 09:55:26] [config] workspace: 5500
[2023-07-22 09:55:26] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 09:55:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:55:26] [training] Using single-device training
[2023-07-22 09:55:26] Synced seed 1234
[2023-07-22 09:55:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 09:55:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 09:55:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 09:55:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 09:55:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 09:55:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 09:55:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 09:55:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 09:55:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 09:55:28] [comm] Using global sharding
[2023-07-22 09:55:28] [comm] NCCLCommunicators constructed successfully
[2023-07-22 09:55:28] [training] Using 1 GPUs
[2023-07-22 09:55:28] [logits] Applying loss function for 1 factor(s)
[2023-07-22 09:55:28] [memory] Reserving 80 MB, device gpu0
[2023-07-22 09:55:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 09:55:28] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:02:24] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 10:02:24] [valid] No post-processing script given for validating translator
[2023-07-22 10:02:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 10:02:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 10:02:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 10:02:24] [comm] Using global sharding
[2023-07-22 10:02:24] [comm] NCCLCommunicators constructed successfully
[2023-07-22 10:02:24] [training] Using 1 GPUs
[2023-07-22 10:02:24] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 10:02:25] Allocating memory for general optimizer shards
[2023-07-22 10:02:25] [memory] Reserving 322 MB, device gpu0
[2023-07-22 10:02:25] Loading Adam parameters
[2023-07-22 10:02:25] [memory] Reserving 322 MB, device gpu0
[2023-07-22 10:02:25] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:02:26] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 10:02:26] [data] Restoring the corpus state to epoch 11, batch 290
[2023-07-22 10:02:26] [data] Shuffling data
[2023-07-22 10:02:26] [data] Done reading 20,192 sentences
[2023-07-22 10:02:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:02:26] Training started
[2023-07-22 10:02:26] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 10:02:27] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:02:37] Parameter type float16, optimization type float32, casting types true
[2023-07-22 10:05:44] Seen 20,192 samples
[2023-07-22 10:05:44] Starting data epoch 12 in logical epoch 12
[2023-07-22 10:05:44] [data] Shuffling data
[2023-07-22 10:05:44] [data] Done reading 20,192 sentences
[2023-07-22 10:05:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:08:56] Seen 20,192 samples
[2023-07-22 10:08:56] Starting data epoch 13 in logical epoch 13
[2023-07-22 10:08:56] [data] Shuffling data
[2023-07-22 10:08:56] [data] Done reading 20,192 sentences
[2023-07-22 10:08:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:12:08] Seen 20,192 samples
[2023-07-22 10:12:08] Starting data epoch 14 in logical epoch 14
[2023-07-22 10:12:08] [data] Shuffling data
[2023-07-22 10:12:08] [data] Done reading 20,192 sentences
[2023-07-22 10:12:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:15:23] Seen 20,192 samples
[2023-07-22 10:15:23] Starting data epoch 15 in logical epoch 15
[2023-07-22 10:15:23] [data] Shuffling data
[2023-07-22 10:15:23] [data] Done reading 20,192 sentences
[2023-07-22 10:15:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:18:36] Seen 20,192 samples
[2023-07-22 10:18:36] Starting data epoch 16 in logical epoch 16
[2023-07-22 10:18:36] [data] Shuffling data
[2023-07-22 10:18:36] [data] Done reading 20,192 sentences
[2023-07-22 10:18:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:21:45] Seen 20,192 samples
[2023-07-22 10:21:45] Starting data epoch 17 in logical epoch 17
[2023-07-22 10:21:45] [data] Shuffling data
[2023-07-22 10:21:45] [data] Done reading 20,192 sentences
[2023-07-22 10:21:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:24:58] Seen 20,192 samples
[2023-07-22 10:24:58] Starting data epoch 18 in logical epoch 18
[2023-07-22 10:24:58] [data] Shuffling data
[2023-07-22 10:24:58] [data] Done reading 20,192 sentences
[2023-07-22 10:24:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:28:12] Seen 20,192 samples
[2023-07-22 10:28:12] Starting data epoch 19 in logical epoch 19
[2023-07-22 10:28:12] [data] Shuffling data
[2023-07-22 10:28:12] [data] Done reading 20,192 sentences
[2023-07-22 10:28:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:31:24] Seen 20,192 samples
[2023-07-22 10:31:24] Starting data epoch 20 in logical epoch 20
[2023-07-22 10:31:24] [data] Shuffling data
[2023-07-22 10:31:24] [data] Done reading 20,192 sentences
[2023-07-22 10:31:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:34:44] Seen 20,192 samples
[2023-07-22 10:34:44] Starting data epoch 21 in logical epoch 21
[2023-07-22 10:34:44] Training finished
[2023-07-22 10:34:55] [valid] Ep. 21 : Up. 580 : cross-entropy : 170.689 : new best
[2023-07-22 10:37:28] [valid] Ep. 21 : Up. 580 : translation : 0 : new best
[2023-07-22 10:37:28] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 10:37:30] Saving Adam parameters
[2023-07-22 10:37:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 10:37:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 10:37:37] [marian] Running on node23.datos.cluster.uy as process 33021 with command line:
[2023-07-22 10:37:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 10:37:37] [config] after: 0e
[2023-07-22 10:37:37] [config] after-batches: 0
[2023-07-22 10:37:37] [config] after-epochs: 30
[2023-07-22 10:37:37] [config] all-caps-every: 0
[2023-07-22 10:37:37] [config] allow-unk: false
[2023-07-22 10:37:37] [config] authors: false
[2023-07-22 10:37:37] [config] beam-size: 12
[2023-07-22 10:37:37] [config] bert-class-symbol: "[CLS]"
[2023-07-22 10:37:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 10:37:37] [config] bert-masking-fraction: 0.15
[2023-07-22 10:37:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 10:37:37] [config] bert-train-type-embeddings: true
[2023-07-22 10:37:37] [config] bert-type-vocab-size: 2
[2023-07-22 10:37:37] [config] build-info: ""
[2023-07-22 10:37:37] [config] check-gradient-nan: false
[2023-07-22 10:37:37] [config] check-nan: false
[2023-07-22 10:37:37] [config] cite: false
[2023-07-22 10:37:37] [config] clip-norm: 1
[2023-07-22 10:37:37] [config] cost-scaling:
[2023-07-22 10:37:37] [config]   - 256.f
[2023-07-22 10:37:37] [config]   - 1000
[2023-07-22 10:37:37] [config]   - 2.f
[2023-07-22 10:37:37] [config]   - 256.f
[2023-07-22 10:37:37] [config] cost-type: ce-sum
[2023-07-22 10:37:37] [config] cpu-threads: 0
[2023-07-22 10:37:37] [config] data-threads: 8
[2023-07-22 10:37:37] [config] data-weighting: ""
[2023-07-22 10:37:37] [config] data-weighting-type: sentence
[2023-07-22 10:37:37] [config] dec-cell: gru
[2023-07-22 10:37:37] [config] dec-cell-base-depth: 2
[2023-07-22 10:37:37] [config] dec-cell-high-depth: 1
[2023-07-22 10:37:37] [config] dec-depth: 1
[2023-07-22 10:37:37] [config] devices:
[2023-07-22 10:37:37] [config]   - 0
[2023-07-22 10:37:37] [config] dim-emb: 512
[2023-07-22 10:37:37] [config] dim-rnn: 1024
[2023-07-22 10:37:37] [config] dim-vocabs:
[2023-07-22 10:37:37] [config]   - 16384
[2023-07-22 10:37:37] [config]   - 16384
[2023-07-22 10:37:37] [config] disp-first: 0
[2023-07-22 10:37:37] [config] disp-freq: 1000u
[2023-07-22 10:37:37] [config] disp-label-counts: true
[2023-07-22 10:37:37] [config] dropout-rnn: 0
[2023-07-22 10:37:37] [config] dropout-src: 0
[2023-07-22 10:37:37] [config] dropout-trg: 0
[2023-07-22 10:37:37] [config] dump-config: ""
[2023-07-22 10:37:37] [config] dynamic-gradient-scaling:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] early-stopping: 200
[2023-07-22 10:37:37] [config] early-stopping-on: first
[2023-07-22 10:37:37] [config] embedding-fix-src: false
[2023-07-22 10:37:37] [config] embedding-fix-trg: false
[2023-07-22 10:37:37] [config] embedding-normalization: false
[2023-07-22 10:37:37] [config] embedding-vectors:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] enc-cell: gru
[2023-07-22 10:37:37] [config] enc-cell-depth: 1
[2023-07-22 10:37:37] [config] enc-depth: 1
[2023-07-22 10:37:37] [config] enc-type: bidirectional
[2023-07-22 10:37:37] [config] english-title-case-every: 0
[2023-07-22 10:37:37] [config] exponential-smoothing: 0
[2023-07-22 10:37:37] [config] factor-weight: 1
[2023-07-22 10:37:37] [config] factors-combine: sum
[2023-07-22 10:37:37] [config] factors-dim-emb: 0
[2023-07-22 10:37:37] [config] gradient-checkpointing: false
[2023-07-22 10:37:37] [config] gradient-norm-average-window: 100
[2023-07-22 10:37:37] [config] guided-alignment: none
[2023-07-22 10:37:37] [config] guided-alignment-cost: mse
[2023-07-22 10:37:37] [config] guided-alignment-weight: 0.1
[2023-07-22 10:37:37] [config] ignore-model-config: false
[2023-07-22 10:37:37] [config] input-types:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] interpolate-env-vars: false
[2023-07-22 10:37:37] [config] keep-best: false
[2023-07-22 10:37:37] [config] label-smoothing: 0
[2023-07-22 10:37:37] [config] layer-normalization: false
[2023-07-22 10:37:37] [config] learn-rate: 0.0001
[2023-07-22 10:37:37] [config] lemma-dependency: ""
[2023-07-22 10:37:37] [config] lemma-dim-emb: 0
[2023-07-22 10:37:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 10:37:37] [config] log-level: info
[2023-07-22 10:37:37] [config] log-time-zone: ""
[2023-07-22 10:37:37] [config] logical-epoch:
[2023-07-22 10:37:37] [config]   - 1e
[2023-07-22 10:37:37] [config]   - 0
[2023-07-22 10:37:37] [config] lr-decay: 0
[2023-07-22 10:37:37] [config] lr-decay-freq: 50000
[2023-07-22 10:37:37] [config] lr-decay-inv-sqrt:
[2023-07-22 10:37:37] [config]   - 0
[2023-07-22 10:37:37] [config] lr-decay-repeat-warmup: false
[2023-07-22 10:37:37] [config] lr-decay-reset-optimizer: false
[2023-07-22 10:37:37] [config] lr-decay-start:
[2023-07-22 10:37:37] [config]   - 10
[2023-07-22 10:37:37] [config]   - 1
[2023-07-22 10:37:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 10:37:37] [config] lr-report: false
[2023-07-22 10:37:37] [config] lr-warmup: 0
[2023-07-22 10:37:37] [config] lr-warmup-at-reload: false
[2023-07-22 10:37:37] [config] lr-warmup-cycle: false
[2023-07-22 10:37:37] [config] lr-warmup-start-rate: 0
[2023-07-22 10:37:37] [config] max-length: 50
[2023-07-22 10:37:37] [config] max-length-crop: true
[2023-07-22 10:37:37] [config] max-length-factor: 3
[2023-07-22 10:37:37] [config] maxi-batch: 100
[2023-07-22 10:37:37] [config] maxi-batch-sort: trg
[2023-07-22 10:37:37] [config] mini-batch: 64
[2023-07-22 10:37:37] [config] mini-batch-fit: true
[2023-07-22 10:37:37] [config] mini-batch-fit-step: 10
[2023-07-22 10:37:37] [config] mini-batch-round-up: true
[2023-07-22 10:37:37] [config] mini-batch-track-lr: false
[2023-07-22 10:37:37] [config] mini-batch-warmup: 0
[2023-07-22 10:37:37] [config] mini-batch-words: 0
[2023-07-22 10:37:37] [config] mini-batch-words-ref: 0
[2023-07-22 10:37:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 10:37:37] [config] multi-loss-type: sum
[2023-07-22 10:37:37] [config] n-best: false
[2023-07-22 10:37:37] [config] no-nccl: false
[2023-07-22 10:37:37] [config] no-reload: false
[2023-07-22 10:37:37] [config] no-restore-corpus: false
[2023-07-22 10:37:37] [config] normalize: 0
[2023-07-22 10:37:37] [config] normalize-gradient: false
[2023-07-22 10:37:37] [config] num-devices: 0
[2023-07-22 10:37:37] [config] optimizer: adam
[2023-07-22 10:37:37] [config] optimizer-delay: 1
[2023-07-22 10:37:37] [config] optimizer-params:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] output-omit-bias: false
[2023-07-22 10:37:37] [config] overwrite: true
[2023-07-22 10:37:37] [config] precision:
[2023-07-22 10:37:37] [config]   - float16
[2023-07-22 10:37:37] [config]   - float32
[2023-07-22 10:37:37] [config] pretrained-model: ""
[2023-07-22 10:37:37] [config] quantize-biases: false
[2023-07-22 10:37:37] [config] quantize-bits: 0
[2023-07-22 10:37:37] [config] quantize-log-based: false
[2023-07-22 10:37:37] [config] quantize-optimization-steps: 0
[2023-07-22 10:37:37] [config] quiet: false
[2023-07-22 10:37:37] [config] quiet-translation: true
[2023-07-22 10:37:37] [config] relative-paths: false
[2023-07-22 10:37:37] [config] right-left: false
[2023-07-22 10:37:37] [config] save-freq: 10000u
[2023-07-22 10:37:37] [config] seed: 1234
[2023-07-22 10:37:37] [config] sentencepiece-alphas:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] sentencepiece-max-lines: 2000000
[2023-07-22 10:37:37] [config] sentencepiece-options: ""
[2023-07-22 10:37:37] [config] sharding: global
[2023-07-22 10:37:37] [config] shuffle: data
[2023-07-22 10:37:37] [config] shuffle-in-ram: false
[2023-07-22 10:37:37] [config] sigterm: save-and-exit
[2023-07-22 10:37:37] [config] skip: false
[2023-07-22 10:37:37] [config] sqlite: ""
[2023-07-22 10:37:37] [config] sqlite-drop: false
[2023-07-22 10:37:37] [config] sync-freq: 200u
[2023-07-22 10:37:37] [config] sync-sgd: false
[2023-07-22 10:37:37] [config] tempdir: /tmp
[2023-07-22 10:37:37] [config] tied-embeddings: false
[2023-07-22 10:37:37] [config] tied-embeddings-all: true
[2023-07-22 10:37:37] [config] tied-embeddings-src: false
[2023-07-22 10:37:37] [config] train-embedder-rank:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] train-sets:
[2023-07-22 10:37:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 10:37:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 10:37:37] [config] transformer-aan-activation: swish
[2023-07-22 10:37:37] [config] transformer-aan-depth: 2
[2023-07-22 10:37:37] [config] transformer-aan-nogate: false
[2023-07-22 10:37:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 10:37:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 10:37:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 10:37:37] [config] transformer-depth-scaling: false
[2023-07-22 10:37:37] [config] transformer-dim-aan: 2048
[2023-07-22 10:37:37] [config] transformer-dim-ffn: 2048
[2023-07-22 10:37:37] [config] transformer-dropout: 0
[2023-07-22 10:37:37] [config] transformer-dropout-attention: 0
[2023-07-22 10:37:37] [config] transformer-dropout-ffn: 0
[2023-07-22 10:37:37] [config] transformer-ffn-activation: swish
[2023-07-22 10:37:37] [config] transformer-ffn-depth: 2
[2023-07-22 10:37:37] [config] transformer-guided-alignment-layer: last
[2023-07-22 10:37:37] [config] transformer-heads: 8
[2023-07-22 10:37:37] [config] transformer-no-projection: false
[2023-07-22 10:37:37] [config] transformer-pool: false
[2023-07-22 10:37:37] [config] transformer-postprocess: dan
[2023-07-22 10:37:37] [config] transformer-postprocess-emb: d
[2023-07-22 10:37:37] [config] transformer-postprocess-top: ""
[2023-07-22 10:37:37] [config] transformer-preprocess: ""
[2023-07-22 10:37:37] [config] transformer-tied-layers:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] transformer-train-position-embeddings: false
[2023-07-22 10:37:37] [config] tsv: false
[2023-07-22 10:37:37] [config] tsv-fields: 0
[2023-07-22 10:37:37] [config] type: amun
[2023-07-22 10:37:37] [config] ulr: false
[2023-07-22 10:37:37] [config] ulr-dim-emb: 0
[2023-07-22 10:37:37] [config] ulr-dropout: 0
[2023-07-22 10:37:37] [config] ulr-keys-vectors: ""
[2023-07-22 10:37:37] [config] ulr-query-vectors: ""
[2023-07-22 10:37:37] [config] ulr-softmax-temperature: 1
[2023-07-22 10:37:37] [config] ulr-trainable-transformation: false
[2023-07-22 10:37:37] [config] unlikelihood-loss: false
[2023-07-22 10:37:37] [config] valid-freq: 50000000
[2023-07-22 10:37:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 10:37:37] [config] valid-max-length: 1000
[2023-07-22 10:37:37] [config] valid-metrics:
[2023-07-22 10:37:37] [config]   - cross-entropy
[2023-07-22 10:37:37] [config]   - translation
[2023-07-22 10:37:37] [config] valid-mini-batch: 32
[2023-07-22 10:37:37] [config] valid-reset-stalled: false
[2023-07-22 10:37:37] [config] valid-script-args:
[2023-07-22 10:37:37] [config]   []
[2023-07-22 10:37:37] [config] valid-script-path: ""
[2023-07-22 10:37:37] [config] valid-sets:
[2023-07-22 10:37:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 10:37:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 10:37:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 10:37:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 10:37:37] [config] vocabs:
[2023-07-22 10:37:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 10:37:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 10:37:37] [config] word-penalty: 0
[2023-07-22 10:37:37] [config] word-scores: false
[2023-07-22 10:37:37] [config] workspace: 5500
[2023-07-22 10:37:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 10:37:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 10:37:37] [training] Using single-device training
[2023-07-22 10:37:37] Synced seed 1234
[2023-07-22 10:37:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 10:37:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 10:37:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 10:37:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 10:37:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 10:37:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 10:37:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 10:37:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 10:37:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 10:37:39] [comm] Using global sharding
[2023-07-22 10:37:39] [comm] NCCLCommunicators constructed successfully
[2023-07-22 10:37:39] [training] Using 1 GPUs
[2023-07-22 10:37:39] [logits] Applying loss function for 1 factor(s)
[2023-07-22 10:37:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:37:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 10:37:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:44:33] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 10:44:33] [valid] No post-processing script given for validating translator
[2023-07-22 10:44:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 10:44:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 10:44:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 10:44:33] [comm] Using global sharding
[2023-07-22 10:44:33] [comm] NCCLCommunicators constructed successfully
[2023-07-22 10:44:33] [training] Using 1 GPUs
[2023-07-22 10:44:33] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 10:44:34] Allocating memory for general optimizer shards
[2023-07-22 10:44:34] [memory] Reserving 322 MB, device gpu0
[2023-07-22 10:44:34] Loading Adam parameters
[2023-07-22 10:44:34] [memory] Reserving 322 MB, device gpu0
[2023-07-22 10:44:35] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:44:35] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 10:44:35] [data] Restoring the corpus state to epoch 21, batch 580
[2023-07-22 10:44:35] [data] Shuffling data
[2023-07-22 10:44:35] [data] Done reading 20,192 sentences
[2023-07-22 10:44:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:44:35] Training started
[2023-07-22 10:44:35] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 10:44:36] [memory] Reserving 80 MB, device gpu0
[2023-07-22 10:44:48] Parameter type float16, optimization type float32, casting types true
[2023-07-22 10:47:51] Seen 20,192 samples
[2023-07-22 10:47:51] Starting data epoch 22 in logical epoch 22
[2023-07-22 10:47:51] [data] Shuffling data
[2023-07-22 10:47:51] [data] Done reading 20,192 sentences
[2023-07-22 10:47:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:51:03] Seen 20,192 samples
[2023-07-22 10:51:03] Starting data epoch 23 in logical epoch 23
[2023-07-22 10:51:03] [data] Shuffling data
[2023-07-22 10:51:03] [data] Done reading 20,192 sentences
[2023-07-22 10:51:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:54:24] Seen 20,192 samples
[2023-07-22 10:54:24] Starting data epoch 24 in logical epoch 24
[2023-07-22 10:54:24] [data] Shuffling data
[2023-07-22 10:54:24] [data] Done reading 20,192 sentences
[2023-07-22 10:54:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 10:57:52] Seen 20,192 samples
[2023-07-22 10:57:52] Starting data epoch 25 in logical epoch 25
[2023-07-22 10:57:52] [data] Shuffling data
[2023-07-22 10:57:52] [data] Done reading 20,192 sentences
[2023-07-22 10:57:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:01:23] Seen 20,192 samples
[2023-07-22 11:01:23] Starting data epoch 26 in logical epoch 26
[2023-07-22 11:01:23] [data] Shuffling data
[2023-07-22 11:01:23] [data] Done reading 20,192 sentences
[2023-07-22 11:01:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:04:53] Seen 20,192 samples
[2023-07-22 11:04:53] Starting data epoch 27 in logical epoch 27
[2023-07-22 11:04:53] [data] Shuffling data
[2023-07-22 11:04:53] [data] Done reading 20,192 sentences
[2023-07-22 11:04:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:08:27] Seen 20,192 samples
[2023-07-22 11:08:27] Starting data epoch 28 in logical epoch 28
[2023-07-22 11:08:27] [data] Shuffling data
[2023-07-22 11:08:27] [data] Done reading 20,192 sentences
[2023-07-22 11:08:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:12:06] Seen 20,192 samples
[2023-07-22 11:12:06] Starting data epoch 29 in logical epoch 29
[2023-07-22 11:12:06] [data] Shuffling data
[2023-07-22 11:12:06] [data] Done reading 20,192 sentences
[2023-07-22 11:12:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:15:44] Seen 20,192 samples
[2023-07-22 11:15:44] Starting data epoch 30 in logical epoch 30
[2023-07-22 11:15:44] [data] Shuffling data
[2023-07-22 11:15:44] [data] Done reading 20,192 sentences
[2023-07-22 11:15:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:19:26] Seen 20,192 samples
[2023-07-22 11:19:26] Starting data epoch 31 in logical epoch 31
[2023-07-22 11:19:26] Training finished
[2023-07-22 11:19:40] [valid] Ep. 31 : Up. 870 : cross-entropy : 162.588 : new best
[2023-07-22 11:21:27] [valid] Ep. 31 : Up. 870 : translation : 0 : new best
[2023-07-22 11:21:27] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 11:21:29] Saving Adam parameters
[2023-07-22 11:21:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 11:21:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 11:21:38] [marian] Running on node23.datos.cluster.uy as process 36053 with command line:
[2023-07-22 11:21:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 11:21:38] [config] after: 0e
[2023-07-22 11:21:38] [config] after-batches: 0
[2023-07-22 11:21:38] [config] after-epochs: 40
[2023-07-22 11:21:38] [config] all-caps-every: 0
[2023-07-22 11:21:38] [config] allow-unk: false
[2023-07-22 11:21:38] [config] authors: false
[2023-07-22 11:21:38] [config] beam-size: 12
[2023-07-22 11:21:38] [config] bert-class-symbol: "[CLS]"
[2023-07-22 11:21:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 11:21:38] [config] bert-masking-fraction: 0.15
[2023-07-22 11:21:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 11:21:38] [config] bert-train-type-embeddings: true
[2023-07-22 11:21:38] [config] bert-type-vocab-size: 2
[2023-07-22 11:21:38] [config] build-info: ""
[2023-07-22 11:21:38] [config] check-gradient-nan: false
[2023-07-22 11:21:38] [config] check-nan: false
[2023-07-22 11:21:38] [config] cite: false
[2023-07-22 11:21:38] [config] clip-norm: 1
[2023-07-22 11:21:38] [config] cost-scaling:
[2023-07-22 11:21:38] [config]   - 256.f
[2023-07-22 11:21:38] [config]   - 1000
[2023-07-22 11:21:38] [config]   - 2.f
[2023-07-22 11:21:38] [config]   - 256.f
[2023-07-22 11:21:38] [config] cost-type: ce-sum
[2023-07-22 11:21:38] [config] cpu-threads: 0
[2023-07-22 11:21:38] [config] data-threads: 8
[2023-07-22 11:21:38] [config] data-weighting: ""
[2023-07-22 11:21:38] [config] data-weighting-type: sentence
[2023-07-22 11:21:38] [config] dec-cell: gru
[2023-07-22 11:21:38] [config] dec-cell-base-depth: 2
[2023-07-22 11:21:38] [config] dec-cell-high-depth: 1
[2023-07-22 11:21:38] [config] dec-depth: 1
[2023-07-22 11:21:38] [config] devices:
[2023-07-22 11:21:38] [config]   - 0
[2023-07-22 11:21:38] [config] dim-emb: 512
[2023-07-22 11:21:38] [config] dim-rnn: 1024
[2023-07-22 11:21:38] [config] dim-vocabs:
[2023-07-22 11:21:38] [config]   - 16384
[2023-07-22 11:21:38] [config]   - 16384
[2023-07-22 11:21:38] [config] disp-first: 0
[2023-07-22 11:21:38] [config] disp-freq: 1000u
[2023-07-22 11:21:38] [config] disp-label-counts: true
[2023-07-22 11:21:38] [config] dropout-rnn: 0
[2023-07-22 11:21:38] [config] dropout-src: 0
[2023-07-22 11:21:38] [config] dropout-trg: 0
[2023-07-22 11:21:38] [config] dump-config: ""
[2023-07-22 11:21:38] [config] dynamic-gradient-scaling:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] early-stopping: 200
[2023-07-22 11:21:38] [config] early-stopping-on: first
[2023-07-22 11:21:38] [config] embedding-fix-src: false
[2023-07-22 11:21:38] [config] embedding-fix-trg: false
[2023-07-22 11:21:38] [config] embedding-normalization: false
[2023-07-22 11:21:38] [config] embedding-vectors:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] enc-cell: gru
[2023-07-22 11:21:38] [config] enc-cell-depth: 1
[2023-07-22 11:21:38] [config] enc-depth: 1
[2023-07-22 11:21:38] [config] enc-type: bidirectional
[2023-07-22 11:21:38] [config] english-title-case-every: 0
[2023-07-22 11:21:38] [config] exponential-smoothing: 0
[2023-07-22 11:21:38] [config] factor-weight: 1
[2023-07-22 11:21:38] [config] factors-combine: sum
[2023-07-22 11:21:38] [config] factors-dim-emb: 0
[2023-07-22 11:21:38] [config] gradient-checkpointing: false
[2023-07-22 11:21:38] [config] gradient-norm-average-window: 100
[2023-07-22 11:21:38] [config] guided-alignment: none
[2023-07-22 11:21:38] [config] guided-alignment-cost: mse
[2023-07-22 11:21:38] [config] guided-alignment-weight: 0.1
[2023-07-22 11:21:38] [config] ignore-model-config: false
[2023-07-22 11:21:38] [config] input-types:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] interpolate-env-vars: false
[2023-07-22 11:21:38] [config] keep-best: false
[2023-07-22 11:21:38] [config] label-smoothing: 0
[2023-07-22 11:21:38] [config] layer-normalization: false
[2023-07-22 11:21:38] [config] learn-rate: 0.0001
[2023-07-22 11:21:38] [config] lemma-dependency: ""
[2023-07-22 11:21:38] [config] lemma-dim-emb: 0
[2023-07-22 11:21:38] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 11:21:38] [config] log-level: info
[2023-07-22 11:21:38] [config] log-time-zone: ""
[2023-07-22 11:21:38] [config] logical-epoch:
[2023-07-22 11:21:38] [config]   - 1e
[2023-07-22 11:21:38] [config]   - 0
[2023-07-22 11:21:38] [config] lr-decay: 0
[2023-07-22 11:21:38] [config] lr-decay-freq: 50000
[2023-07-22 11:21:38] [config] lr-decay-inv-sqrt:
[2023-07-22 11:21:38] [config]   - 0
[2023-07-22 11:21:38] [config] lr-decay-repeat-warmup: false
[2023-07-22 11:21:38] [config] lr-decay-reset-optimizer: false
[2023-07-22 11:21:38] [config] lr-decay-start:
[2023-07-22 11:21:38] [config]   - 10
[2023-07-22 11:21:38] [config]   - 1
[2023-07-22 11:21:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 11:21:38] [config] lr-report: false
[2023-07-22 11:21:38] [config] lr-warmup: 0
[2023-07-22 11:21:38] [config] lr-warmup-at-reload: false
[2023-07-22 11:21:38] [config] lr-warmup-cycle: false
[2023-07-22 11:21:38] [config] lr-warmup-start-rate: 0
[2023-07-22 11:21:38] [config] max-length: 50
[2023-07-22 11:21:38] [config] max-length-crop: true
[2023-07-22 11:21:38] [config] max-length-factor: 3
[2023-07-22 11:21:38] [config] maxi-batch: 100
[2023-07-22 11:21:38] [config] maxi-batch-sort: trg
[2023-07-22 11:21:38] [config] mini-batch: 64
[2023-07-22 11:21:38] [config] mini-batch-fit: true
[2023-07-22 11:21:38] [config] mini-batch-fit-step: 10
[2023-07-22 11:21:38] [config] mini-batch-round-up: true
[2023-07-22 11:21:38] [config] mini-batch-track-lr: false
[2023-07-22 11:21:38] [config] mini-batch-warmup: 0
[2023-07-22 11:21:38] [config] mini-batch-words: 0
[2023-07-22 11:21:38] [config] mini-batch-words-ref: 0
[2023-07-22 11:21:38] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 11:21:38] [config] multi-loss-type: sum
[2023-07-22 11:21:38] [config] n-best: false
[2023-07-22 11:21:38] [config] no-nccl: false
[2023-07-22 11:21:38] [config] no-reload: false
[2023-07-22 11:21:38] [config] no-restore-corpus: false
[2023-07-22 11:21:38] [config] normalize: 0
[2023-07-22 11:21:38] [config] normalize-gradient: false
[2023-07-22 11:21:38] [config] num-devices: 0
[2023-07-22 11:21:38] [config] optimizer: adam
[2023-07-22 11:21:38] [config] optimizer-delay: 1
[2023-07-22 11:21:38] [config] optimizer-params:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] output-omit-bias: false
[2023-07-22 11:21:38] [config] overwrite: true
[2023-07-22 11:21:38] [config] precision:
[2023-07-22 11:21:38] [config]   - float16
[2023-07-22 11:21:38] [config]   - float32
[2023-07-22 11:21:38] [config] pretrained-model: ""
[2023-07-22 11:21:38] [config] quantize-biases: false
[2023-07-22 11:21:38] [config] quantize-bits: 0
[2023-07-22 11:21:38] [config] quantize-log-based: false
[2023-07-22 11:21:38] [config] quantize-optimization-steps: 0
[2023-07-22 11:21:38] [config] quiet: false
[2023-07-22 11:21:38] [config] quiet-translation: true
[2023-07-22 11:21:38] [config] relative-paths: false
[2023-07-22 11:21:38] [config] right-left: false
[2023-07-22 11:21:38] [config] save-freq: 10000u
[2023-07-22 11:21:38] [config] seed: 1234
[2023-07-22 11:21:38] [config] sentencepiece-alphas:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] sentencepiece-max-lines: 2000000
[2023-07-22 11:21:38] [config] sentencepiece-options: ""
[2023-07-22 11:21:38] [config] sharding: global
[2023-07-22 11:21:38] [config] shuffle: data
[2023-07-22 11:21:38] [config] shuffle-in-ram: false
[2023-07-22 11:21:38] [config] sigterm: save-and-exit
[2023-07-22 11:21:38] [config] skip: false
[2023-07-22 11:21:38] [config] sqlite: ""
[2023-07-22 11:21:38] [config] sqlite-drop: false
[2023-07-22 11:21:38] [config] sync-freq: 200u
[2023-07-22 11:21:38] [config] sync-sgd: false
[2023-07-22 11:21:38] [config] tempdir: /tmp
[2023-07-22 11:21:38] [config] tied-embeddings: false
[2023-07-22 11:21:38] [config] tied-embeddings-all: true
[2023-07-22 11:21:38] [config] tied-embeddings-src: false
[2023-07-22 11:21:38] [config] train-embedder-rank:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] train-sets:
[2023-07-22 11:21:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 11:21:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 11:21:38] [config] transformer-aan-activation: swish
[2023-07-22 11:21:38] [config] transformer-aan-depth: 2
[2023-07-22 11:21:38] [config] transformer-aan-nogate: false
[2023-07-22 11:21:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 11:21:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 11:21:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 11:21:38] [config] transformer-depth-scaling: false
[2023-07-22 11:21:38] [config] transformer-dim-aan: 2048
[2023-07-22 11:21:38] [config] transformer-dim-ffn: 2048
[2023-07-22 11:21:38] [config] transformer-dropout: 0
[2023-07-22 11:21:38] [config] transformer-dropout-attention: 0
[2023-07-22 11:21:38] [config] transformer-dropout-ffn: 0
[2023-07-22 11:21:38] [config] transformer-ffn-activation: swish
[2023-07-22 11:21:38] [config] transformer-ffn-depth: 2
[2023-07-22 11:21:38] [config] transformer-guided-alignment-layer: last
[2023-07-22 11:21:38] [config] transformer-heads: 8
[2023-07-22 11:21:38] [config] transformer-no-projection: false
[2023-07-22 11:21:38] [config] transformer-pool: false
[2023-07-22 11:21:38] [config] transformer-postprocess: dan
[2023-07-22 11:21:38] [config] transformer-postprocess-emb: d
[2023-07-22 11:21:38] [config] transformer-postprocess-top: ""
[2023-07-22 11:21:38] [config] transformer-preprocess: ""
[2023-07-22 11:21:38] [config] transformer-tied-layers:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] transformer-train-position-embeddings: false
[2023-07-22 11:21:38] [config] tsv: false
[2023-07-22 11:21:38] [config] tsv-fields: 0
[2023-07-22 11:21:38] [config] type: amun
[2023-07-22 11:21:38] [config] ulr: false
[2023-07-22 11:21:38] [config] ulr-dim-emb: 0
[2023-07-22 11:21:38] [config] ulr-dropout: 0
[2023-07-22 11:21:38] [config] ulr-keys-vectors: ""
[2023-07-22 11:21:38] [config] ulr-query-vectors: ""
[2023-07-22 11:21:38] [config] ulr-softmax-temperature: 1
[2023-07-22 11:21:38] [config] ulr-trainable-transformation: false
[2023-07-22 11:21:38] [config] unlikelihood-loss: false
[2023-07-22 11:21:38] [config] valid-freq: 50000000
[2023-07-22 11:21:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 11:21:38] [config] valid-max-length: 1000
[2023-07-22 11:21:38] [config] valid-metrics:
[2023-07-22 11:21:38] [config]   - cross-entropy
[2023-07-22 11:21:38] [config]   - translation
[2023-07-22 11:21:38] [config] valid-mini-batch: 32
[2023-07-22 11:21:38] [config] valid-reset-stalled: false
[2023-07-22 11:21:38] [config] valid-script-args:
[2023-07-22 11:21:38] [config]   []
[2023-07-22 11:21:38] [config] valid-script-path: ""
[2023-07-22 11:21:38] [config] valid-sets:
[2023-07-22 11:21:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 11:21:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 11:21:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 11:21:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 11:21:38] [config] vocabs:
[2023-07-22 11:21:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 11:21:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 11:21:38] [config] word-penalty: 0
[2023-07-22 11:21:38] [config] word-scores: false
[2023-07-22 11:21:38] [config] workspace: 5500
[2023-07-22 11:21:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 11:21:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 11:21:38] [training] Using single-device training
[2023-07-22 11:21:39] Synced seed 1234
[2023-07-22 11:21:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 11:21:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 11:21:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 11:21:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 11:21:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 11:21:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 11:21:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 11:21:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 11:21:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 11:21:40] [comm] Using global sharding
[2023-07-22 11:21:40] [comm] NCCLCommunicators constructed successfully
[2023-07-22 11:21:40] [training] Using 1 GPUs
[2023-07-22 11:21:40] [logits] Applying loss function for 1 factor(s)
[2023-07-22 11:21:40] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:21:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 11:21:41] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:28:37] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 11:28:37] [valid] No post-processing script given for validating translator
[2023-07-22 11:28:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 11:28:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 11:28:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 11:28:37] [comm] Using global sharding
[2023-07-22 11:28:37] [comm] NCCLCommunicators constructed successfully
[2023-07-22 11:28:37] [training] Using 1 GPUs
[2023-07-22 11:28:37] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 11:28:38] Allocating memory for general optimizer shards
[2023-07-22 11:28:38] [memory] Reserving 322 MB, device gpu0
[2023-07-22 11:28:38] Loading Adam parameters
[2023-07-22 11:28:39] [memory] Reserving 322 MB, device gpu0
[2023-07-22 11:28:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:28:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 11:28:39] [data] Restoring the corpus state to epoch 31, batch 870
[2023-07-22 11:28:39] [data] Shuffling data
[2023-07-22 11:28:39] [data] Done reading 20,192 sentences
[2023-07-22 11:28:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:28:39] Training started
[2023-07-22 11:28:39] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 11:28:40] [memory] Reserving 80 MB, device gpu0
[2023-07-22 11:28:43] Parameter type float16, optimization type float32, casting types true
[2023-07-22 11:32:09] Seen 20,192 samples
[2023-07-22 11:32:09] Starting data epoch 32 in logical epoch 32
[2023-07-22 11:32:09] [data] Shuffling data
[2023-07-22 11:32:09] [data] Done reading 20,192 sentences
[2023-07-22 11:32:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:35:52] Seen 20,192 samples
[2023-07-22 11:35:52] Starting data epoch 33 in logical epoch 33
[2023-07-22 11:35:52] [data] Shuffling data
[2023-07-22 11:35:52] [data] Done reading 20,192 sentences
[2023-07-22 11:35:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:39:41] Seen 20,192 samples
[2023-07-22 11:39:41] Starting data epoch 34 in logical epoch 34
[2023-07-22 11:39:41] [data] Shuffling data
[2023-07-22 11:39:41] [data] Done reading 20,192 sentences
[2023-07-22 11:39:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:43:29] Seen 20,192 samples
[2023-07-22 11:43:29] Starting data epoch 35 in logical epoch 35
[2023-07-22 11:43:29] [data] Shuffling data
[2023-07-22 11:43:29] [data] Done reading 20,192 sentences
[2023-07-22 11:43:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:45:24] Ep. 35 : Up. 1000 : Sen. 10,005 : Cost 6.71900892 * 17,704,888 @ 31,071 after 17,704,884 : Time 1007.21s : 17578.13 words/s : gNorm 1.0216
[2023-07-22 11:47:10] Seen 20,192 samples
[2023-07-22 11:47:10] Starting data epoch 36 in logical epoch 36
[2023-07-22 11:47:10] [data] Shuffling data
[2023-07-22 11:47:10] [data] Done reading 20,192 sentences
[2023-07-22 11:47:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:50:54] Seen 20,192 samples
[2023-07-22 11:50:54] Starting data epoch 37 in logical epoch 37
[2023-07-22 11:50:54] [data] Shuffling data
[2023-07-22 11:50:54] [data] Done reading 20,192 sentences
[2023-07-22 11:50:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:54:30] Seen 20,192 samples
[2023-07-22 11:54:30] Starting data epoch 38 in logical epoch 38
[2023-07-22 11:54:30] [data] Shuffling data
[2023-07-22 11:54:30] [data] Done reading 20,192 sentences
[2023-07-22 11:54:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 11:58:12] Seen 20,192 samples
[2023-07-22 11:58:12] Starting data epoch 39 in logical epoch 39
[2023-07-22 11:58:12] [data] Shuffling data
[2023-07-22 11:58:12] [data] Done reading 20,192 sentences
[2023-07-22 11:58:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:02:10] Seen 20,192 samples
[2023-07-22 12:02:10] Starting data epoch 40 in logical epoch 40
[2023-07-22 12:02:10] [data] Shuffling data
[2023-07-22 12:02:10] [data] Done reading 20,192 sentences
[2023-07-22 12:02:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:06:01] Seen 20,192 samples
[2023-07-22 12:06:01] Starting data epoch 41 in logical epoch 41
[2023-07-22 12:06:01] Training finished
[2023-07-22 12:06:17] [valid] Ep. 41 : Up. 1160 : cross-entropy : 156.883 : new best
[2023-07-22 12:10:00] [valid] Ep. 41 : Up. 1160 : translation : 0 : new best
[2023-07-22 12:10:00] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 12:10:02] Saving Adam parameters
[2023-07-22 12:10:03] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 12:10:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:10:10] [marian] Running on node23.datos.cluster.uy as process 39037 with command line:
[2023-07-22 12:10:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 12:10:10] [config] after: 0e
[2023-07-22 12:10:10] [config] after-batches: 0
[2023-07-22 12:10:10] [config] after-epochs: 50
[2023-07-22 12:10:10] [config] all-caps-every: 0
[2023-07-22 12:10:10] [config] allow-unk: false
[2023-07-22 12:10:10] [config] authors: false
[2023-07-22 12:10:10] [config] beam-size: 12
[2023-07-22 12:10:10] [config] bert-class-symbol: "[CLS]"
[2023-07-22 12:10:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 12:10:10] [config] bert-masking-fraction: 0.15
[2023-07-22 12:10:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 12:10:10] [config] bert-train-type-embeddings: true
[2023-07-22 12:10:10] [config] bert-type-vocab-size: 2
[2023-07-22 12:10:10] [config] build-info: ""
[2023-07-22 12:10:10] [config] check-gradient-nan: false
[2023-07-22 12:10:10] [config] check-nan: false
[2023-07-22 12:10:10] [config] cite: false
[2023-07-22 12:10:10] [config] clip-norm: 1
[2023-07-22 12:10:10] [config] cost-scaling:
[2023-07-22 12:10:10] [config]   - 256.f
[2023-07-22 12:10:10] [config]   - 1000
[2023-07-22 12:10:10] [config]   - 2.f
[2023-07-22 12:10:10] [config]   - 256.f
[2023-07-22 12:10:10] [config] cost-type: ce-sum
[2023-07-22 12:10:10] [config] cpu-threads: 0
[2023-07-22 12:10:10] [config] data-threads: 8
[2023-07-22 12:10:10] [config] data-weighting: ""
[2023-07-22 12:10:10] [config] data-weighting-type: sentence
[2023-07-22 12:10:10] [config] dec-cell: gru
[2023-07-22 12:10:10] [config] dec-cell-base-depth: 2
[2023-07-22 12:10:10] [config] dec-cell-high-depth: 1
[2023-07-22 12:10:10] [config] dec-depth: 1
[2023-07-22 12:10:10] [config] devices:
[2023-07-22 12:10:10] [config]   - 0
[2023-07-22 12:10:10] [config] dim-emb: 512
[2023-07-22 12:10:10] [config] dim-rnn: 1024
[2023-07-22 12:10:10] [config] dim-vocabs:
[2023-07-22 12:10:10] [config]   - 16384
[2023-07-22 12:10:10] [config]   - 16384
[2023-07-22 12:10:10] [config] disp-first: 0
[2023-07-22 12:10:10] [config] disp-freq: 1000u
[2023-07-22 12:10:10] [config] disp-label-counts: true
[2023-07-22 12:10:10] [config] dropout-rnn: 0
[2023-07-22 12:10:10] [config] dropout-src: 0
[2023-07-22 12:10:10] [config] dropout-trg: 0
[2023-07-22 12:10:10] [config] dump-config: ""
[2023-07-22 12:10:10] [config] dynamic-gradient-scaling:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] early-stopping: 200
[2023-07-22 12:10:10] [config] early-stopping-on: first
[2023-07-22 12:10:10] [config] embedding-fix-src: false
[2023-07-22 12:10:10] [config] embedding-fix-trg: false
[2023-07-22 12:10:10] [config] embedding-normalization: false
[2023-07-22 12:10:10] [config] embedding-vectors:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] enc-cell: gru
[2023-07-22 12:10:10] [config] enc-cell-depth: 1
[2023-07-22 12:10:10] [config] enc-depth: 1
[2023-07-22 12:10:10] [config] enc-type: bidirectional
[2023-07-22 12:10:10] [config] english-title-case-every: 0
[2023-07-22 12:10:10] [config] exponential-smoothing: 0
[2023-07-22 12:10:10] [config] factor-weight: 1
[2023-07-22 12:10:10] [config] factors-combine: sum
[2023-07-22 12:10:10] [config] factors-dim-emb: 0
[2023-07-22 12:10:10] [config] gradient-checkpointing: false
[2023-07-22 12:10:10] [config] gradient-norm-average-window: 100
[2023-07-22 12:10:10] [config] guided-alignment: none
[2023-07-22 12:10:10] [config] guided-alignment-cost: mse
[2023-07-22 12:10:10] [config] guided-alignment-weight: 0.1
[2023-07-22 12:10:10] [config] ignore-model-config: false
[2023-07-22 12:10:10] [config] input-types:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] interpolate-env-vars: false
[2023-07-22 12:10:10] [config] keep-best: false
[2023-07-22 12:10:10] [config] label-smoothing: 0
[2023-07-22 12:10:10] [config] layer-normalization: false
[2023-07-22 12:10:10] [config] learn-rate: 0.0001
[2023-07-22 12:10:10] [config] lemma-dependency: ""
[2023-07-22 12:10:10] [config] lemma-dim-emb: 0
[2023-07-22 12:10:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 12:10:10] [config] log-level: info
[2023-07-22 12:10:10] [config] log-time-zone: ""
[2023-07-22 12:10:10] [config] logical-epoch:
[2023-07-22 12:10:10] [config]   - 1e
[2023-07-22 12:10:10] [config]   - 0
[2023-07-22 12:10:10] [config] lr-decay: 0
[2023-07-22 12:10:10] [config] lr-decay-freq: 50000
[2023-07-22 12:10:10] [config] lr-decay-inv-sqrt:
[2023-07-22 12:10:10] [config]   - 0
[2023-07-22 12:10:10] [config] lr-decay-repeat-warmup: false
[2023-07-22 12:10:10] [config] lr-decay-reset-optimizer: false
[2023-07-22 12:10:10] [config] lr-decay-start:
[2023-07-22 12:10:10] [config]   - 10
[2023-07-22 12:10:10] [config]   - 1
[2023-07-22 12:10:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 12:10:10] [config] lr-report: false
[2023-07-22 12:10:10] [config] lr-warmup: 0
[2023-07-22 12:10:10] [config] lr-warmup-at-reload: false
[2023-07-22 12:10:10] [config] lr-warmup-cycle: false
[2023-07-22 12:10:10] [config] lr-warmup-start-rate: 0
[2023-07-22 12:10:10] [config] max-length: 50
[2023-07-22 12:10:10] [config] max-length-crop: true
[2023-07-22 12:10:10] [config] max-length-factor: 3
[2023-07-22 12:10:10] [config] maxi-batch: 100
[2023-07-22 12:10:10] [config] maxi-batch-sort: trg
[2023-07-22 12:10:10] [config] mini-batch: 64
[2023-07-22 12:10:10] [config] mini-batch-fit: true
[2023-07-22 12:10:10] [config] mini-batch-fit-step: 10
[2023-07-22 12:10:10] [config] mini-batch-round-up: true
[2023-07-22 12:10:10] [config] mini-batch-track-lr: false
[2023-07-22 12:10:10] [config] mini-batch-warmup: 0
[2023-07-22 12:10:10] [config] mini-batch-words: 0
[2023-07-22 12:10:10] [config] mini-batch-words-ref: 0
[2023-07-22 12:10:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 12:10:10] [config] multi-loss-type: sum
[2023-07-22 12:10:10] [config] n-best: false
[2023-07-22 12:10:10] [config] no-nccl: false
[2023-07-22 12:10:10] [config] no-reload: false
[2023-07-22 12:10:10] [config] no-restore-corpus: false
[2023-07-22 12:10:10] [config] normalize: 0
[2023-07-22 12:10:10] [config] normalize-gradient: false
[2023-07-22 12:10:10] [config] num-devices: 0
[2023-07-22 12:10:10] [config] optimizer: adam
[2023-07-22 12:10:10] [config] optimizer-delay: 1
[2023-07-22 12:10:10] [config] optimizer-params:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] output-omit-bias: false
[2023-07-22 12:10:10] [config] overwrite: true
[2023-07-22 12:10:10] [config] precision:
[2023-07-22 12:10:10] [config]   - float16
[2023-07-22 12:10:10] [config]   - float32
[2023-07-22 12:10:10] [config] pretrained-model: ""
[2023-07-22 12:10:10] [config] quantize-biases: false
[2023-07-22 12:10:10] [config] quantize-bits: 0
[2023-07-22 12:10:10] [config] quantize-log-based: false
[2023-07-22 12:10:10] [config] quantize-optimization-steps: 0
[2023-07-22 12:10:10] [config] quiet: false
[2023-07-22 12:10:10] [config] quiet-translation: true
[2023-07-22 12:10:10] [config] relative-paths: false
[2023-07-22 12:10:10] [config] right-left: false
[2023-07-22 12:10:10] [config] save-freq: 10000u
[2023-07-22 12:10:10] [config] seed: 1234
[2023-07-22 12:10:10] [config] sentencepiece-alphas:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] sentencepiece-max-lines: 2000000
[2023-07-22 12:10:10] [config] sentencepiece-options: ""
[2023-07-22 12:10:10] [config] sharding: global
[2023-07-22 12:10:10] [config] shuffle: data
[2023-07-22 12:10:10] [config] shuffle-in-ram: false
[2023-07-22 12:10:10] [config] sigterm: save-and-exit
[2023-07-22 12:10:10] [config] skip: false
[2023-07-22 12:10:10] [config] sqlite: ""
[2023-07-22 12:10:10] [config] sqlite-drop: false
[2023-07-22 12:10:10] [config] sync-freq: 200u
[2023-07-22 12:10:10] [config] sync-sgd: false
[2023-07-22 12:10:10] [config] tempdir: /tmp
[2023-07-22 12:10:10] [config] tied-embeddings: false
[2023-07-22 12:10:10] [config] tied-embeddings-all: true
[2023-07-22 12:10:10] [config] tied-embeddings-src: false
[2023-07-22 12:10:10] [config] train-embedder-rank:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] train-sets:
[2023-07-22 12:10:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 12:10:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 12:10:10] [config] transformer-aan-activation: swish
[2023-07-22 12:10:10] [config] transformer-aan-depth: 2
[2023-07-22 12:10:10] [config] transformer-aan-nogate: false
[2023-07-22 12:10:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 12:10:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 12:10:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 12:10:10] [config] transformer-depth-scaling: false
[2023-07-22 12:10:10] [config] transformer-dim-aan: 2048
[2023-07-22 12:10:10] [config] transformer-dim-ffn: 2048
[2023-07-22 12:10:10] [config] transformer-dropout: 0
[2023-07-22 12:10:10] [config] transformer-dropout-attention: 0
[2023-07-22 12:10:10] [config] transformer-dropout-ffn: 0
[2023-07-22 12:10:10] [config] transformer-ffn-activation: swish
[2023-07-22 12:10:10] [config] transformer-ffn-depth: 2
[2023-07-22 12:10:10] [config] transformer-guided-alignment-layer: last
[2023-07-22 12:10:10] [config] transformer-heads: 8
[2023-07-22 12:10:10] [config] transformer-no-projection: false
[2023-07-22 12:10:10] [config] transformer-pool: false
[2023-07-22 12:10:10] [config] transformer-postprocess: dan
[2023-07-22 12:10:10] [config] transformer-postprocess-emb: d
[2023-07-22 12:10:10] [config] transformer-postprocess-top: ""
[2023-07-22 12:10:10] [config] transformer-preprocess: ""
[2023-07-22 12:10:10] [config] transformer-tied-layers:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] transformer-train-position-embeddings: false
[2023-07-22 12:10:10] [config] tsv: false
[2023-07-22 12:10:10] [config] tsv-fields: 0
[2023-07-22 12:10:10] [config] type: amun
[2023-07-22 12:10:10] [config] ulr: false
[2023-07-22 12:10:10] [config] ulr-dim-emb: 0
[2023-07-22 12:10:10] [config] ulr-dropout: 0
[2023-07-22 12:10:10] [config] ulr-keys-vectors: ""
[2023-07-22 12:10:10] [config] ulr-query-vectors: ""
[2023-07-22 12:10:10] [config] ulr-softmax-temperature: 1
[2023-07-22 12:10:10] [config] ulr-trainable-transformation: false
[2023-07-22 12:10:10] [config] unlikelihood-loss: false
[2023-07-22 12:10:10] [config] valid-freq: 50000000
[2023-07-22 12:10:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 12:10:10] [config] valid-max-length: 1000
[2023-07-22 12:10:10] [config] valid-metrics:
[2023-07-22 12:10:10] [config]   - cross-entropy
[2023-07-22 12:10:10] [config]   - translation
[2023-07-22 12:10:10] [config] valid-mini-batch: 32
[2023-07-22 12:10:10] [config] valid-reset-stalled: false
[2023-07-22 12:10:10] [config] valid-script-args:
[2023-07-22 12:10:10] [config]   []
[2023-07-22 12:10:10] [config] valid-script-path: ""
[2023-07-22 12:10:10] [config] valid-sets:
[2023-07-22 12:10:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 12:10:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 12:10:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 12:10:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:10:10] [config] vocabs:
[2023-07-22 12:10:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 12:10:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 12:10:10] [config] word-penalty: 0
[2023-07-22 12:10:10] [config] word-scores: false
[2023-07-22 12:10:10] [config] workspace: 5500
[2023-07-22 12:10:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:10:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:10:10] [training] Using single-device training
[2023-07-22 12:10:11] Synced seed 1234
[2023-07-22 12:10:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 12:10:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 12:10:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 12:10:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 12:10:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 12:10:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:10:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 12:10:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 12:10:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 12:10:13] [comm] Using global sharding
[2023-07-22 12:10:13] [comm] NCCLCommunicators constructed successfully
[2023-07-22 12:10:13] [training] Using 1 GPUs
[2023-07-22 12:10:13] [logits] Applying loss function for 1 factor(s)
[2023-07-22 12:10:13] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:10:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 12:10:13] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:17:08] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 12:17:08] [valid] No post-processing script given for validating translator
[2023-07-22 12:17:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:17:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 12:17:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 12:17:08] [comm] Using global sharding
[2023-07-22 12:17:08] [comm] NCCLCommunicators constructed successfully
[2023-07-22 12:17:08] [training] Using 1 GPUs
[2023-07-22 12:17:08] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 12:17:09] Allocating memory for general optimizer shards
[2023-07-22 12:17:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 12:17:09] Loading Adam parameters
[2023-07-22 12:17:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 12:17:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:17:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 12:17:10] [data] Restoring the corpus state to epoch 41, batch 1160
[2023-07-22 12:17:10] [data] Shuffling data
[2023-07-22 12:17:10] [data] Done reading 20,192 sentences
[2023-07-22 12:17:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:17:10] Training started
[2023-07-22 12:17:10] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 12:17:11] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:17:16] Parameter type float16, optimization type float32, casting types true
[2023-07-22 12:20:53] Seen 20,192 samples
[2023-07-22 12:20:53] Starting data epoch 42 in logical epoch 42
[2023-07-22 12:20:53] [data] Shuffling data
[2023-07-22 12:20:53] [data] Done reading 20,192 sentences
[2023-07-22 12:20:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:24:49] Seen 20,192 samples
[2023-07-22 12:24:49] Starting data epoch 43 in logical epoch 43
[2023-07-22 12:24:49] [data] Shuffling data
[2023-07-22 12:24:49] [data] Done reading 20,192 sentences
[2023-07-22 12:24:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:28:36] Seen 20,192 samples
[2023-07-22 12:28:36] Starting data epoch 44 in logical epoch 44
[2023-07-22 12:28:36] [data] Shuffling data
[2023-07-22 12:28:36] [data] Done reading 20,192 sentences
[2023-07-22 12:28:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:32:22] Seen 20,192 samples
[2023-07-22 12:32:22] Starting data epoch 45 in logical epoch 45
[2023-07-22 12:32:22] [data] Shuffling data
[2023-07-22 12:32:22] [data] Done reading 20,192 sentences
[2023-07-22 12:32:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:36:10] Seen 20,192 samples
[2023-07-22 12:36:10] Starting data epoch 46 in logical epoch 46
[2023-07-22 12:36:10] [data] Shuffling data
[2023-07-22 12:36:10] [data] Done reading 20,192 sentences
[2023-07-22 12:36:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:39:51] Seen 20,192 samples
[2023-07-22 12:39:51] Starting data epoch 47 in logical epoch 47
[2023-07-22 12:39:51] [data] Shuffling data
[2023-07-22 12:39:51] [data] Done reading 20,192 sentences
[2023-07-22 12:39:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:43:37] Seen 20,192 samples
[2023-07-22 12:43:37] Starting data epoch 48 in logical epoch 48
[2023-07-22 12:43:37] [data] Shuffling data
[2023-07-22 12:43:37] [data] Done reading 20,192 sentences
[2023-07-22 12:43:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:47:27] Seen 20,192 samples
[2023-07-22 12:47:27] Starting data epoch 49 in logical epoch 49
[2023-07-22 12:47:27] [data] Shuffling data
[2023-07-22 12:47:27] [data] Done reading 20,192 sentences
[2023-07-22 12:47:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:51:08] Seen 20,192 samples
[2023-07-22 12:51:08] Starting data epoch 50 in logical epoch 50
[2023-07-22 12:51:08] [data] Shuffling data
[2023-07-22 12:51:08] [data] Done reading 20,192 sentences
[2023-07-22 12:51:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 12:54:45] Seen 20,192 samples
[2023-07-22 12:54:45] Starting data epoch 51 in logical epoch 51
[2023-07-22 12:54:45] Training finished
[2023-07-22 12:54:59] [valid] Ep. 51 : Up. 1450 : cross-entropy : 150.925 : new best
[2023-07-22 12:57:38] [valid] Ep. 51 : Up. 1450 : translation : 0 : new best
[2023-07-22 12:57:38] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 12:57:40] Saving Adam parameters
[2023-07-22 12:57:41] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 12:57:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:57:46] [marian] Running on node23.datos.cluster.uy as process 1679 with command line:
[2023-07-22 12:57:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 12:57:46] [config] after: 0e
[2023-07-22 12:57:46] [config] after-batches: 0
[2023-07-22 12:57:46] [config] after-epochs: 60
[2023-07-22 12:57:46] [config] all-caps-every: 0
[2023-07-22 12:57:46] [config] allow-unk: false
[2023-07-22 12:57:46] [config] authors: false
[2023-07-22 12:57:46] [config] beam-size: 12
[2023-07-22 12:57:46] [config] bert-class-symbol: "[CLS]"
[2023-07-22 12:57:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 12:57:46] [config] bert-masking-fraction: 0.15
[2023-07-22 12:57:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 12:57:46] [config] bert-train-type-embeddings: true
[2023-07-22 12:57:46] [config] bert-type-vocab-size: 2
[2023-07-22 12:57:46] [config] build-info: ""
[2023-07-22 12:57:46] [config] check-gradient-nan: false
[2023-07-22 12:57:46] [config] check-nan: false
[2023-07-22 12:57:46] [config] cite: false
[2023-07-22 12:57:46] [config] clip-norm: 1
[2023-07-22 12:57:46] [config] cost-scaling:
[2023-07-22 12:57:46] [config]   - 256.f
[2023-07-22 12:57:46] [config]   - 1000
[2023-07-22 12:57:46] [config]   - 2.f
[2023-07-22 12:57:46] [config]   - 256.f
[2023-07-22 12:57:46] [config] cost-type: ce-sum
[2023-07-22 12:57:46] [config] cpu-threads: 0
[2023-07-22 12:57:46] [config] data-threads: 8
[2023-07-22 12:57:46] [config] data-weighting: ""
[2023-07-22 12:57:46] [config] data-weighting-type: sentence
[2023-07-22 12:57:46] [config] dec-cell: gru
[2023-07-22 12:57:46] [config] dec-cell-base-depth: 2
[2023-07-22 12:57:46] [config] dec-cell-high-depth: 1
[2023-07-22 12:57:46] [config] dec-depth: 1
[2023-07-22 12:57:46] [config] devices:
[2023-07-22 12:57:46] [config]   - 0
[2023-07-22 12:57:46] [config] dim-emb: 512
[2023-07-22 12:57:46] [config] dim-rnn: 1024
[2023-07-22 12:57:46] [config] dim-vocabs:
[2023-07-22 12:57:46] [config]   - 16384
[2023-07-22 12:57:46] [config]   - 16384
[2023-07-22 12:57:46] [config] disp-first: 0
[2023-07-22 12:57:46] [config] disp-freq: 1000u
[2023-07-22 12:57:46] [config] disp-label-counts: true
[2023-07-22 12:57:46] [config] dropout-rnn: 0
[2023-07-22 12:57:46] [config] dropout-src: 0
[2023-07-22 12:57:46] [config] dropout-trg: 0
[2023-07-22 12:57:46] [config] dump-config: ""
[2023-07-22 12:57:46] [config] dynamic-gradient-scaling:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] early-stopping: 200
[2023-07-22 12:57:46] [config] early-stopping-on: first
[2023-07-22 12:57:46] [config] embedding-fix-src: false
[2023-07-22 12:57:46] [config] embedding-fix-trg: false
[2023-07-22 12:57:46] [config] embedding-normalization: false
[2023-07-22 12:57:46] [config] embedding-vectors:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] enc-cell: gru
[2023-07-22 12:57:46] [config] enc-cell-depth: 1
[2023-07-22 12:57:46] [config] enc-depth: 1
[2023-07-22 12:57:46] [config] enc-type: bidirectional
[2023-07-22 12:57:46] [config] english-title-case-every: 0
[2023-07-22 12:57:46] [config] exponential-smoothing: 0
[2023-07-22 12:57:46] [config] factor-weight: 1
[2023-07-22 12:57:46] [config] factors-combine: sum
[2023-07-22 12:57:46] [config] factors-dim-emb: 0
[2023-07-22 12:57:46] [config] gradient-checkpointing: false
[2023-07-22 12:57:46] [config] gradient-norm-average-window: 100
[2023-07-22 12:57:46] [config] guided-alignment: none
[2023-07-22 12:57:46] [config] guided-alignment-cost: mse
[2023-07-22 12:57:46] [config] guided-alignment-weight: 0.1
[2023-07-22 12:57:46] [config] ignore-model-config: false
[2023-07-22 12:57:46] [config] input-types:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] interpolate-env-vars: false
[2023-07-22 12:57:46] [config] keep-best: false
[2023-07-22 12:57:46] [config] label-smoothing: 0
[2023-07-22 12:57:46] [config] layer-normalization: false
[2023-07-22 12:57:46] [config] learn-rate: 0.0001
[2023-07-22 12:57:46] [config] lemma-dependency: ""
[2023-07-22 12:57:46] [config] lemma-dim-emb: 0
[2023-07-22 12:57:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 12:57:46] [config] log-level: info
[2023-07-22 12:57:46] [config] log-time-zone: ""
[2023-07-22 12:57:46] [config] logical-epoch:
[2023-07-22 12:57:46] [config]   - 1e
[2023-07-22 12:57:46] [config]   - 0
[2023-07-22 12:57:46] [config] lr-decay: 0
[2023-07-22 12:57:46] [config] lr-decay-freq: 50000
[2023-07-22 12:57:46] [config] lr-decay-inv-sqrt:
[2023-07-22 12:57:46] [config]   - 0
[2023-07-22 12:57:46] [config] lr-decay-repeat-warmup: false
[2023-07-22 12:57:46] [config] lr-decay-reset-optimizer: false
[2023-07-22 12:57:46] [config] lr-decay-start:
[2023-07-22 12:57:46] [config]   - 10
[2023-07-22 12:57:46] [config]   - 1
[2023-07-22 12:57:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 12:57:46] [config] lr-report: false
[2023-07-22 12:57:46] [config] lr-warmup: 0
[2023-07-22 12:57:46] [config] lr-warmup-at-reload: false
[2023-07-22 12:57:46] [config] lr-warmup-cycle: false
[2023-07-22 12:57:46] [config] lr-warmup-start-rate: 0
[2023-07-22 12:57:46] [config] max-length: 50
[2023-07-22 12:57:46] [config] max-length-crop: true
[2023-07-22 12:57:46] [config] max-length-factor: 3
[2023-07-22 12:57:46] [config] maxi-batch: 100
[2023-07-22 12:57:46] [config] maxi-batch-sort: trg
[2023-07-22 12:57:46] [config] mini-batch: 64
[2023-07-22 12:57:46] [config] mini-batch-fit: true
[2023-07-22 12:57:46] [config] mini-batch-fit-step: 10
[2023-07-22 12:57:46] [config] mini-batch-round-up: true
[2023-07-22 12:57:46] [config] mini-batch-track-lr: false
[2023-07-22 12:57:46] [config] mini-batch-warmup: 0
[2023-07-22 12:57:46] [config] mini-batch-words: 0
[2023-07-22 12:57:46] [config] mini-batch-words-ref: 0
[2023-07-22 12:57:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 12:57:46] [config] multi-loss-type: sum
[2023-07-22 12:57:46] [config] n-best: false
[2023-07-22 12:57:46] [config] no-nccl: false
[2023-07-22 12:57:46] [config] no-reload: false
[2023-07-22 12:57:46] [config] no-restore-corpus: false
[2023-07-22 12:57:46] [config] normalize: 0
[2023-07-22 12:57:46] [config] normalize-gradient: false
[2023-07-22 12:57:46] [config] num-devices: 0
[2023-07-22 12:57:46] [config] optimizer: adam
[2023-07-22 12:57:46] [config] optimizer-delay: 1
[2023-07-22 12:57:46] [config] optimizer-params:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] output-omit-bias: false
[2023-07-22 12:57:46] [config] overwrite: true
[2023-07-22 12:57:46] [config] precision:
[2023-07-22 12:57:46] [config]   - float16
[2023-07-22 12:57:46] [config]   - float32
[2023-07-22 12:57:46] [config] pretrained-model: ""
[2023-07-22 12:57:46] [config] quantize-biases: false
[2023-07-22 12:57:46] [config] quantize-bits: 0
[2023-07-22 12:57:46] [config] quantize-log-based: false
[2023-07-22 12:57:46] [config] quantize-optimization-steps: 0
[2023-07-22 12:57:46] [config] quiet: false
[2023-07-22 12:57:46] [config] quiet-translation: true
[2023-07-22 12:57:46] [config] relative-paths: false
[2023-07-22 12:57:46] [config] right-left: false
[2023-07-22 12:57:46] [config] save-freq: 10000u
[2023-07-22 12:57:46] [config] seed: 1234
[2023-07-22 12:57:46] [config] sentencepiece-alphas:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] sentencepiece-max-lines: 2000000
[2023-07-22 12:57:46] [config] sentencepiece-options: ""
[2023-07-22 12:57:46] [config] sharding: global
[2023-07-22 12:57:46] [config] shuffle: data
[2023-07-22 12:57:46] [config] shuffle-in-ram: false
[2023-07-22 12:57:46] [config] sigterm: save-and-exit
[2023-07-22 12:57:46] [config] skip: false
[2023-07-22 12:57:46] [config] sqlite: ""
[2023-07-22 12:57:46] [config] sqlite-drop: false
[2023-07-22 12:57:46] [config] sync-freq: 200u
[2023-07-22 12:57:46] [config] sync-sgd: false
[2023-07-22 12:57:46] [config] tempdir: /tmp
[2023-07-22 12:57:46] [config] tied-embeddings: false
[2023-07-22 12:57:46] [config] tied-embeddings-all: true
[2023-07-22 12:57:46] [config] tied-embeddings-src: false
[2023-07-22 12:57:46] [config] train-embedder-rank:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] train-sets:
[2023-07-22 12:57:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 12:57:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 12:57:46] [config] transformer-aan-activation: swish
[2023-07-22 12:57:46] [config] transformer-aan-depth: 2
[2023-07-22 12:57:46] [config] transformer-aan-nogate: false
[2023-07-22 12:57:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 12:57:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 12:57:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 12:57:46] [config] transformer-depth-scaling: false
[2023-07-22 12:57:46] [config] transformer-dim-aan: 2048
[2023-07-22 12:57:46] [config] transformer-dim-ffn: 2048
[2023-07-22 12:57:46] [config] transformer-dropout: 0
[2023-07-22 12:57:46] [config] transformer-dropout-attention: 0
[2023-07-22 12:57:46] [config] transformer-dropout-ffn: 0
[2023-07-22 12:57:46] [config] transformer-ffn-activation: swish
[2023-07-22 12:57:46] [config] transformer-ffn-depth: 2
[2023-07-22 12:57:46] [config] transformer-guided-alignment-layer: last
[2023-07-22 12:57:46] [config] transformer-heads: 8
[2023-07-22 12:57:46] [config] transformer-no-projection: false
[2023-07-22 12:57:46] [config] transformer-pool: false
[2023-07-22 12:57:46] [config] transformer-postprocess: dan
[2023-07-22 12:57:46] [config] transformer-postprocess-emb: d
[2023-07-22 12:57:46] [config] transformer-postprocess-top: ""
[2023-07-22 12:57:46] [config] transformer-preprocess: ""
[2023-07-22 12:57:46] [config] transformer-tied-layers:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] transformer-train-position-embeddings: false
[2023-07-22 12:57:46] [config] tsv: false
[2023-07-22 12:57:46] [config] tsv-fields: 0
[2023-07-22 12:57:46] [config] type: amun
[2023-07-22 12:57:46] [config] ulr: false
[2023-07-22 12:57:46] [config] ulr-dim-emb: 0
[2023-07-22 12:57:46] [config] ulr-dropout: 0
[2023-07-22 12:57:46] [config] ulr-keys-vectors: ""
[2023-07-22 12:57:46] [config] ulr-query-vectors: ""
[2023-07-22 12:57:46] [config] ulr-softmax-temperature: 1
[2023-07-22 12:57:46] [config] ulr-trainable-transformation: false
[2023-07-22 12:57:46] [config] unlikelihood-loss: false
[2023-07-22 12:57:46] [config] valid-freq: 50000000
[2023-07-22 12:57:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 12:57:46] [config] valid-max-length: 1000
[2023-07-22 12:57:46] [config] valid-metrics:
[2023-07-22 12:57:46] [config]   - cross-entropy
[2023-07-22 12:57:46] [config]   - translation
[2023-07-22 12:57:46] [config] valid-mini-batch: 32
[2023-07-22 12:57:46] [config] valid-reset-stalled: false
[2023-07-22 12:57:46] [config] valid-script-args:
[2023-07-22 12:57:46] [config]   []
[2023-07-22 12:57:46] [config] valid-script-path: ""
[2023-07-22 12:57:46] [config] valid-sets:
[2023-07-22 12:57:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 12:57:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 12:57:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 12:57:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:57:46] [config] vocabs:
[2023-07-22 12:57:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 12:57:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 12:57:46] [config] word-penalty: 0
[2023-07-22 12:57:46] [config] word-scores: false
[2023-07-22 12:57:46] [config] workspace: 5500
[2023-07-22 12:57:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 12:57:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:57:46] [training] Using single-device training
[2023-07-22 12:57:47] Synced seed 1234
[2023-07-22 12:57:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 12:57:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 12:57:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 12:57:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 12:57:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 12:57:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 12:57:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 12:57:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 12:57:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 12:57:48] [comm] Using global sharding
[2023-07-22 12:57:48] [comm] NCCLCommunicators constructed successfully
[2023-07-22 12:57:48] [training] Using 1 GPUs
[2023-07-22 12:57:48] [logits] Applying loss function for 1 factor(s)
[2023-07-22 12:57:48] [memory] Reserving 80 MB, device gpu0
[2023-07-22 12:57:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 12:57:49] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:04:37] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 13:04:37] [valid] No post-processing script given for validating translator
[2023-07-22 13:04:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 13:04:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 13:04:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 13:04:38] [comm] Using global sharding
[2023-07-22 13:04:38] [comm] NCCLCommunicators constructed successfully
[2023-07-22 13:04:38] [training] Using 1 GPUs
[2023-07-22 13:04:38] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 13:04:39] Allocating memory for general optimizer shards
[2023-07-22 13:04:39] [memory] Reserving 322 MB, device gpu0
[2023-07-22 13:04:39] Loading Adam parameters
[2023-07-22 13:04:39] [memory] Reserving 322 MB, device gpu0
[2023-07-22 13:04:39] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:04:39] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 13:04:39] [data] Restoring the corpus state to epoch 51, batch 1450
[2023-07-22 13:04:39] [data] Shuffling data
[2023-07-22 13:04:39] [data] Done reading 20,192 sentences
[2023-07-22 13:04:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:04:40] Training started
[2023-07-22 13:04:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 13:04:41] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:04:52] Parameter type float16, optimization type float32, casting types true
[2023-07-22 13:08:15] Seen 20,192 samples
[2023-07-22 13:08:15] Starting data epoch 52 in logical epoch 52
[2023-07-22 13:08:15] [data] Shuffling data
[2023-07-22 13:08:15] [data] Done reading 20,192 sentences
[2023-07-22 13:08:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:11:51] Seen 20,192 samples
[2023-07-22 13:11:51] Starting data epoch 53 in logical epoch 53
[2023-07-22 13:11:51] [data] Shuffling data
[2023-07-22 13:11:51] [data] Done reading 20,192 sentences
[2023-07-22 13:11:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:15:40] Seen 20,192 samples
[2023-07-22 13:15:40] Starting data epoch 54 in logical epoch 54
[2023-07-22 13:15:40] [data] Shuffling data
[2023-07-22 13:15:40] [data] Done reading 20,192 sentences
[2023-07-22 13:15:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:19:24] Seen 20,192 samples
[2023-07-22 13:19:24] Starting data epoch 55 in logical epoch 55
[2023-07-22 13:19:24] [data] Shuffling data
[2023-07-22 13:19:24] [data] Done reading 20,192 sentences
[2023-07-22 13:19:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:23:13] Seen 20,192 samples
[2023-07-22 13:23:13] Starting data epoch 56 in logical epoch 56
[2023-07-22 13:23:13] [data] Shuffling data
[2023-07-22 13:23:13] [data] Done reading 20,192 sentences
[2023-07-22 13:23:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:27:06] Seen 20,192 samples
[2023-07-22 13:27:06] Starting data epoch 57 in logical epoch 57
[2023-07-22 13:27:06] [data] Shuffling data
[2023-07-22 13:27:06] [data] Done reading 20,192 sentences
[2023-07-22 13:27:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:30:59] Seen 20,192 samples
[2023-07-22 13:30:59] Starting data epoch 58 in logical epoch 58
[2023-07-22 13:30:59] [data] Shuffling data
[2023-07-22 13:30:59] [data] Done reading 20,192 sentences
[2023-07-22 13:30:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:34:50] Seen 20,192 samples
[2023-07-22 13:34:50] Starting data epoch 59 in logical epoch 59
[2023-07-22 13:34:50] [data] Shuffling data
[2023-07-22 13:34:50] [data] Done reading 20,192 sentences
[2023-07-22 13:34:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:38:45] Seen 20,192 samples
[2023-07-22 13:38:45] Starting data epoch 60 in logical epoch 60
[2023-07-22 13:38:45] [data] Shuffling data
[2023-07-22 13:38:45] [data] Done reading 20,192 sentences
[2023-07-22 13:38:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:42:36] Seen 20,192 samples
[2023-07-22 13:42:36] Starting data epoch 61 in logical epoch 61
[2023-07-22 13:42:36] Training finished
[2023-07-22 13:42:50] [valid] Ep. 61 : Up. 1740 : cross-entropy : 146.729 : new best
[2023-07-22 13:45:14] [valid] Ep. 61 : Up. 1740 : translation : 0 : new best
[2023-07-22 13:45:14] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 13:45:16] Saving Adam parameters
[2023-07-22 13:45:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 13:45:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 13:45:23] [marian] Running on node23.datos.cluster.uy as process 4654 with command line:
[2023-07-22 13:45:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 13:45:23] [config] after: 0e
[2023-07-22 13:45:23] [config] after-batches: 0
[2023-07-22 13:45:23] [config] after-epochs: 70
[2023-07-22 13:45:23] [config] all-caps-every: 0
[2023-07-22 13:45:23] [config] allow-unk: false
[2023-07-22 13:45:23] [config] authors: false
[2023-07-22 13:45:23] [config] beam-size: 12
[2023-07-22 13:45:23] [config] bert-class-symbol: "[CLS]"
[2023-07-22 13:45:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 13:45:23] [config] bert-masking-fraction: 0.15
[2023-07-22 13:45:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 13:45:23] [config] bert-train-type-embeddings: true
[2023-07-22 13:45:23] [config] bert-type-vocab-size: 2
[2023-07-22 13:45:23] [config] build-info: ""
[2023-07-22 13:45:23] [config] check-gradient-nan: false
[2023-07-22 13:45:23] [config] check-nan: false
[2023-07-22 13:45:23] [config] cite: false
[2023-07-22 13:45:23] [config] clip-norm: 1
[2023-07-22 13:45:23] [config] cost-scaling:
[2023-07-22 13:45:23] [config]   - 256.f
[2023-07-22 13:45:23] [config]   - 1000
[2023-07-22 13:45:23] [config]   - 2.f
[2023-07-22 13:45:23] [config]   - 256.f
[2023-07-22 13:45:23] [config] cost-type: ce-sum
[2023-07-22 13:45:23] [config] cpu-threads: 0
[2023-07-22 13:45:23] [config] data-threads: 8
[2023-07-22 13:45:23] [config] data-weighting: ""
[2023-07-22 13:45:23] [config] data-weighting-type: sentence
[2023-07-22 13:45:23] [config] dec-cell: gru
[2023-07-22 13:45:23] [config] dec-cell-base-depth: 2
[2023-07-22 13:45:23] [config] dec-cell-high-depth: 1
[2023-07-22 13:45:23] [config] dec-depth: 1
[2023-07-22 13:45:23] [config] devices:
[2023-07-22 13:45:23] [config]   - 0
[2023-07-22 13:45:23] [config] dim-emb: 512
[2023-07-22 13:45:23] [config] dim-rnn: 1024
[2023-07-22 13:45:23] [config] dim-vocabs:
[2023-07-22 13:45:23] [config]   - 16384
[2023-07-22 13:45:23] [config]   - 16384
[2023-07-22 13:45:23] [config] disp-first: 0
[2023-07-22 13:45:23] [config] disp-freq: 1000u
[2023-07-22 13:45:23] [config] disp-label-counts: true
[2023-07-22 13:45:23] [config] dropout-rnn: 0
[2023-07-22 13:45:23] [config] dropout-src: 0
[2023-07-22 13:45:23] [config] dropout-trg: 0
[2023-07-22 13:45:23] [config] dump-config: ""
[2023-07-22 13:45:23] [config] dynamic-gradient-scaling:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] early-stopping: 200
[2023-07-22 13:45:23] [config] early-stopping-on: first
[2023-07-22 13:45:23] [config] embedding-fix-src: false
[2023-07-22 13:45:23] [config] embedding-fix-trg: false
[2023-07-22 13:45:23] [config] embedding-normalization: false
[2023-07-22 13:45:23] [config] embedding-vectors:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] enc-cell: gru
[2023-07-22 13:45:23] [config] enc-cell-depth: 1
[2023-07-22 13:45:23] [config] enc-depth: 1
[2023-07-22 13:45:23] [config] enc-type: bidirectional
[2023-07-22 13:45:23] [config] english-title-case-every: 0
[2023-07-22 13:45:23] [config] exponential-smoothing: 0
[2023-07-22 13:45:23] [config] factor-weight: 1
[2023-07-22 13:45:23] [config] factors-combine: sum
[2023-07-22 13:45:23] [config] factors-dim-emb: 0
[2023-07-22 13:45:23] [config] gradient-checkpointing: false
[2023-07-22 13:45:23] [config] gradient-norm-average-window: 100
[2023-07-22 13:45:23] [config] guided-alignment: none
[2023-07-22 13:45:23] [config] guided-alignment-cost: mse
[2023-07-22 13:45:23] [config] guided-alignment-weight: 0.1
[2023-07-22 13:45:23] [config] ignore-model-config: false
[2023-07-22 13:45:23] [config] input-types:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] interpolate-env-vars: false
[2023-07-22 13:45:23] [config] keep-best: false
[2023-07-22 13:45:23] [config] label-smoothing: 0
[2023-07-22 13:45:23] [config] layer-normalization: false
[2023-07-22 13:45:23] [config] learn-rate: 0.0001
[2023-07-22 13:45:23] [config] lemma-dependency: ""
[2023-07-22 13:45:23] [config] lemma-dim-emb: 0
[2023-07-22 13:45:23] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 13:45:23] [config] log-level: info
[2023-07-22 13:45:23] [config] log-time-zone: ""
[2023-07-22 13:45:23] [config] logical-epoch:
[2023-07-22 13:45:23] [config]   - 1e
[2023-07-22 13:45:23] [config]   - 0
[2023-07-22 13:45:23] [config] lr-decay: 0
[2023-07-22 13:45:23] [config] lr-decay-freq: 50000
[2023-07-22 13:45:23] [config] lr-decay-inv-sqrt:
[2023-07-22 13:45:23] [config]   - 0
[2023-07-22 13:45:23] [config] lr-decay-repeat-warmup: false
[2023-07-22 13:45:23] [config] lr-decay-reset-optimizer: false
[2023-07-22 13:45:23] [config] lr-decay-start:
[2023-07-22 13:45:23] [config]   - 10
[2023-07-22 13:45:23] [config]   - 1
[2023-07-22 13:45:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 13:45:23] [config] lr-report: false
[2023-07-22 13:45:23] [config] lr-warmup: 0
[2023-07-22 13:45:23] [config] lr-warmup-at-reload: false
[2023-07-22 13:45:23] [config] lr-warmup-cycle: false
[2023-07-22 13:45:23] [config] lr-warmup-start-rate: 0
[2023-07-22 13:45:23] [config] max-length: 50
[2023-07-22 13:45:23] [config] max-length-crop: true
[2023-07-22 13:45:23] [config] max-length-factor: 3
[2023-07-22 13:45:23] [config] maxi-batch: 100
[2023-07-22 13:45:23] [config] maxi-batch-sort: trg
[2023-07-22 13:45:23] [config] mini-batch: 64
[2023-07-22 13:45:23] [config] mini-batch-fit: true
[2023-07-22 13:45:23] [config] mini-batch-fit-step: 10
[2023-07-22 13:45:23] [config] mini-batch-round-up: true
[2023-07-22 13:45:23] [config] mini-batch-track-lr: false
[2023-07-22 13:45:23] [config] mini-batch-warmup: 0
[2023-07-22 13:45:23] [config] mini-batch-words: 0
[2023-07-22 13:45:23] [config] mini-batch-words-ref: 0
[2023-07-22 13:45:23] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 13:45:23] [config] multi-loss-type: sum
[2023-07-22 13:45:23] [config] n-best: false
[2023-07-22 13:45:23] [config] no-nccl: false
[2023-07-22 13:45:23] [config] no-reload: false
[2023-07-22 13:45:23] [config] no-restore-corpus: false
[2023-07-22 13:45:23] [config] normalize: 0
[2023-07-22 13:45:23] [config] normalize-gradient: false
[2023-07-22 13:45:23] [config] num-devices: 0
[2023-07-22 13:45:23] [config] optimizer: adam
[2023-07-22 13:45:23] [config] optimizer-delay: 1
[2023-07-22 13:45:23] [config] optimizer-params:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] output-omit-bias: false
[2023-07-22 13:45:23] [config] overwrite: true
[2023-07-22 13:45:23] [config] precision:
[2023-07-22 13:45:23] [config]   - float16
[2023-07-22 13:45:23] [config]   - float32
[2023-07-22 13:45:23] [config] pretrained-model: ""
[2023-07-22 13:45:23] [config] quantize-biases: false
[2023-07-22 13:45:23] [config] quantize-bits: 0
[2023-07-22 13:45:23] [config] quantize-log-based: false
[2023-07-22 13:45:23] [config] quantize-optimization-steps: 0
[2023-07-22 13:45:23] [config] quiet: false
[2023-07-22 13:45:23] [config] quiet-translation: true
[2023-07-22 13:45:23] [config] relative-paths: false
[2023-07-22 13:45:23] [config] right-left: false
[2023-07-22 13:45:23] [config] save-freq: 10000u
[2023-07-22 13:45:23] [config] seed: 1234
[2023-07-22 13:45:23] [config] sentencepiece-alphas:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] sentencepiece-max-lines: 2000000
[2023-07-22 13:45:23] [config] sentencepiece-options: ""
[2023-07-22 13:45:23] [config] sharding: global
[2023-07-22 13:45:23] [config] shuffle: data
[2023-07-22 13:45:23] [config] shuffle-in-ram: false
[2023-07-22 13:45:23] [config] sigterm: save-and-exit
[2023-07-22 13:45:23] [config] skip: false
[2023-07-22 13:45:23] [config] sqlite: ""
[2023-07-22 13:45:23] [config] sqlite-drop: false
[2023-07-22 13:45:23] [config] sync-freq: 200u
[2023-07-22 13:45:23] [config] sync-sgd: false
[2023-07-22 13:45:23] [config] tempdir: /tmp
[2023-07-22 13:45:23] [config] tied-embeddings: false
[2023-07-22 13:45:23] [config] tied-embeddings-all: true
[2023-07-22 13:45:23] [config] tied-embeddings-src: false
[2023-07-22 13:45:23] [config] train-embedder-rank:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] train-sets:
[2023-07-22 13:45:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 13:45:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 13:45:23] [config] transformer-aan-activation: swish
[2023-07-22 13:45:23] [config] transformer-aan-depth: 2
[2023-07-22 13:45:23] [config] transformer-aan-nogate: false
[2023-07-22 13:45:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 13:45:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 13:45:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 13:45:23] [config] transformer-depth-scaling: false
[2023-07-22 13:45:23] [config] transformer-dim-aan: 2048
[2023-07-22 13:45:23] [config] transformer-dim-ffn: 2048
[2023-07-22 13:45:23] [config] transformer-dropout: 0
[2023-07-22 13:45:23] [config] transformer-dropout-attention: 0
[2023-07-22 13:45:23] [config] transformer-dropout-ffn: 0
[2023-07-22 13:45:23] [config] transformer-ffn-activation: swish
[2023-07-22 13:45:23] [config] transformer-ffn-depth: 2
[2023-07-22 13:45:23] [config] transformer-guided-alignment-layer: last
[2023-07-22 13:45:23] [config] transformer-heads: 8
[2023-07-22 13:45:23] [config] transformer-no-projection: false
[2023-07-22 13:45:23] [config] transformer-pool: false
[2023-07-22 13:45:23] [config] transformer-postprocess: dan
[2023-07-22 13:45:23] [config] transformer-postprocess-emb: d
[2023-07-22 13:45:23] [config] transformer-postprocess-top: ""
[2023-07-22 13:45:23] [config] transformer-preprocess: ""
[2023-07-22 13:45:23] [config] transformer-tied-layers:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] transformer-train-position-embeddings: false
[2023-07-22 13:45:23] [config] tsv: false
[2023-07-22 13:45:23] [config] tsv-fields: 0
[2023-07-22 13:45:23] [config] type: amun
[2023-07-22 13:45:23] [config] ulr: false
[2023-07-22 13:45:23] [config] ulr-dim-emb: 0
[2023-07-22 13:45:23] [config] ulr-dropout: 0
[2023-07-22 13:45:23] [config] ulr-keys-vectors: ""
[2023-07-22 13:45:23] [config] ulr-query-vectors: ""
[2023-07-22 13:45:23] [config] ulr-softmax-temperature: 1
[2023-07-22 13:45:23] [config] ulr-trainable-transformation: false
[2023-07-22 13:45:23] [config] unlikelihood-loss: false
[2023-07-22 13:45:23] [config] valid-freq: 50000000
[2023-07-22 13:45:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 13:45:23] [config] valid-max-length: 1000
[2023-07-22 13:45:23] [config] valid-metrics:
[2023-07-22 13:45:23] [config]   - cross-entropy
[2023-07-22 13:45:23] [config]   - translation
[2023-07-22 13:45:23] [config] valid-mini-batch: 32
[2023-07-22 13:45:23] [config] valid-reset-stalled: false
[2023-07-22 13:45:23] [config] valid-script-args:
[2023-07-22 13:45:23] [config]   []
[2023-07-22 13:45:23] [config] valid-script-path: ""
[2023-07-22 13:45:23] [config] valid-sets:
[2023-07-22 13:45:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 13:45:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 13:45:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 13:45:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 13:45:23] [config] vocabs:
[2023-07-22 13:45:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 13:45:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 13:45:23] [config] word-penalty: 0
[2023-07-22 13:45:23] [config] word-scores: false
[2023-07-22 13:45:23] [config] workspace: 5500
[2023-07-22 13:45:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 13:45:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 13:45:23] [training] Using single-device training
[2023-07-22 13:45:24] Synced seed 1234
[2023-07-22 13:45:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 13:45:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 13:45:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 13:45:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 13:45:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 13:45:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 13:45:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 13:45:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 13:45:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 13:45:25] [comm] Using global sharding
[2023-07-22 13:45:25] [comm] NCCLCommunicators constructed successfully
[2023-07-22 13:45:25] [training] Using 1 GPUs
[2023-07-22 13:45:25] [logits] Applying loss function for 1 factor(s)
[2023-07-22 13:45:25] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:45:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 13:45:26] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:52:12] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 13:52:12] [valid] No post-processing script given for validating translator
[2023-07-22 13:52:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 13:52:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 13:52:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 13:52:12] [comm] Using global sharding
[2023-07-22 13:52:12] [comm] NCCLCommunicators constructed successfully
[2023-07-22 13:52:12] [training] Using 1 GPUs
[2023-07-22 13:52:12] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 13:52:13] Allocating memory for general optimizer shards
[2023-07-22 13:52:13] [memory] Reserving 322 MB, device gpu0
[2023-07-22 13:52:13] Loading Adam parameters
[2023-07-22 13:52:14] [memory] Reserving 322 MB, device gpu0
[2023-07-22 13:52:14] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:52:14] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 13:52:14] [data] Restoring the corpus state to epoch 61, batch 1740
[2023-07-22 13:52:14] [data] Shuffling data
[2023-07-22 13:52:14] [data] Done reading 20,192 sentences
[2023-07-22 13:52:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:52:14] Training started
[2023-07-22 13:52:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 13:52:15] [memory] Reserving 80 MB, device gpu0
[2023-07-22 13:52:18] Parameter type float16, optimization type float32, casting types true
[2023-07-22 13:55:51] Seen 20,192 samples
[2023-07-22 13:55:51] Starting data epoch 62 in logical epoch 62
[2023-07-22 13:55:51] [data] Shuffling data
[2023-07-22 13:55:51] [data] Done reading 20,192 sentences
[2023-07-22 13:55:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 13:59:45] Seen 20,192 samples
[2023-07-22 13:59:45] Starting data epoch 63 in logical epoch 63
[2023-07-22 13:59:45] [data] Shuffling data
[2023-07-22 13:59:45] [data] Done reading 20,192 sentences
[2023-07-22 13:59:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:03:41] Seen 20,192 samples
[2023-07-22 14:03:41] Starting data epoch 64 in logical epoch 64
[2023-07-22 14:03:41] [data] Shuffling data
[2023-07-22 14:03:41] [data] Done reading 20,192 sentences
[2023-07-22 14:03:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:07:34] Seen 20,192 samples
[2023-07-22 14:07:34] Starting data epoch 65 in logical epoch 65
[2023-07-22 14:07:34] [data] Shuffling data
[2023-07-22 14:07:34] [data] Done reading 20,192 sentences
[2023-07-22 14:07:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:11:32] Seen 20,192 samples
[2023-07-22 14:11:32] Starting data epoch 66 in logical epoch 66
[2023-07-22 14:11:32] [data] Shuffling data
[2023-07-22 14:11:32] [data] Done reading 20,192 sentences
[2023-07-22 14:11:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:15:22] Seen 20,192 samples
[2023-07-22 14:15:22] Starting data epoch 67 in logical epoch 67
[2023-07-22 14:15:22] [data] Shuffling data
[2023-07-22 14:15:22] [data] Done reading 20,192 sentences
[2023-07-22 14:15:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:19:09] Seen 20,192 samples
[2023-07-22 14:19:09] Starting data epoch 68 in logical epoch 68
[2023-07-22 14:19:09] [data] Shuffling data
[2023-07-22 14:19:09] [data] Done reading 20,192 sentences
[2023-07-22 14:19:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:23:04] Seen 20,192 samples
[2023-07-22 14:23:04] Starting data epoch 69 in logical epoch 69
[2023-07-22 14:23:04] [data] Shuffling data
[2023-07-22 14:23:04] [data] Done reading 20,192 sentences
[2023-07-22 14:23:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:26:55] Ep. 69 : Up. 2000 : Sen. 19,921 : Cost 5.53409767 * 17,697,530 @ 23,598 after 35,402,406 : Time 2082.97s : 8496.30 words/s : gNorm 1.1521
[2023-07-22 14:26:57] Seen 20,192 samples
[2023-07-22 14:26:57] Starting data epoch 70 in logical epoch 70
[2023-07-22 14:26:57] [data] Shuffling data
[2023-07-22 14:26:57] [data] Done reading 20,192 sentences
[2023-07-22 14:26:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:30:49] Seen 20,192 samples
[2023-07-22 14:30:49] Starting data epoch 71 in logical epoch 71
[2023-07-22 14:30:49] Training finished
[2023-07-22 14:31:03] [valid] Ep. 71 : Up. 2030 : cross-entropy : 143.586 : new best
[2023-07-22 14:33:41] [valid] Ep. 71 : Up. 2030 : translation : 0 : new best
[2023-07-22 14:33:41] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 14:33:43] Saving Adam parameters
[2023-07-22 14:33:44] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 14:33:50] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 14:33:50] [marian] Running on node23.datos.cluster.uy as process 7951 with command line:
[2023-07-22 14:33:50] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 14:33:50] [config] after: 0e
[2023-07-22 14:33:50] [config] after-batches: 0
[2023-07-22 14:33:50] [config] after-epochs: 80
[2023-07-22 14:33:50] [config] all-caps-every: 0
[2023-07-22 14:33:50] [config] allow-unk: false
[2023-07-22 14:33:50] [config] authors: false
[2023-07-22 14:33:50] [config] beam-size: 12
[2023-07-22 14:33:50] [config] bert-class-symbol: "[CLS]"
[2023-07-22 14:33:50] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 14:33:50] [config] bert-masking-fraction: 0.15
[2023-07-22 14:33:50] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 14:33:50] [config] bert-train-type-embeddings: true
[2023-07-22 14:33:50] [config] bert-type-vocab-size: 2
[2023-07-22 14:33:50] [config] build-info: ""
[2023-07-22 14:33:50] [config] check-gradient-nan: false
[2023-07-22 14:33:50] [config] check-nan: false
[2023-07-22 14:33:50] [config] cite: false
[2023-07-22 14:33:50] [config] clip-norm: 1
[2023-07-22 14:33:50] [config] cost-scaling:
[2023-07-22 14:33:50] [config]   - 256.f
[2023-07-22 14:33:50] [config]   - 1000
[2023-07-22 14:33:50] [config]   - 2.f
[2023-07-22 14:33:50] [config]   - 256.f
[2023-07-22 14:33:50] [config] cost-type: ce-sum
[2023-07-22 14:33:50] [config] cpu-threads: 0
[2023-07-22 14:33:50] [config] data-threads: 8
[2023-07-22 14:33:50] [config] data-weighting: ""
[2023-07-22 14:33:50] [config] data-weighting-type: sentence
[2023-07-22 14:33:50] [config] dec-cell: gru
[2023-07-22 14:33:50] [config] dec-cell-base-depth: 2
[2023-07-22 14:33:50] [config] dec-cell-high-depth: 1
[2023-07-22 14:33:50] [config] dec-depth: 1
[2023-07-22 14:33:50] [config] devices:
[2023-07-22 14:33:50] [config]   - 0
[2023-07-22 14:33:50] [config] dim-emb: 512
[2023-07-22 14:33:50] [config] dim-rnn: 1024
[2023-07-22 14:33:50] [config] dim-vocabs:
[2023-07-22 14:33:50] [config]   - 16384
[2023-07-22 14:33:50] [config]   - 16384
[2023-07-22 14:33:50] [config] disp-first: 0
[2023-07-22 14:33:50] [config] disp-freq: 1000u
[2023-07-22 14:33:50] [config] disp-label-counts: true
[2023-07-22 14:33:50] [config] dropout-rnn: 0
[2023-07-22 14:33:50] [config] dropout-src: 0
[2023-07-22 14:33:50] [config] dropout-trg: 0
[2023-07-22 14:33:50] [config] dump-config: ""
[2023-07-22 14:33:50] [config] dynamic-gradient-scaling:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] early-stopping: 200
[2023-07-22 14:33:50] [config] early-stopping-on: first
[2023-07-22 14:33:50] [config] embedding-fix-src: false
[2023-07-22 14:33:50] [config] embedding-fix-trg: false
[2023-07-22 14:33:50] [config] embedding-normalization: false
[2023-07-22 14:33:50] [config] embedding-vectors:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] enc-cell: gru
[2023-07-22 14:33:50] [config] enc-cell-depth: 1
[2023-07-22 14:33:50] [config] enc-depth: 1
[2023-07-22 14:33:50] [config] enc-type: bidirectional
[2023-07-22 14:33:50] [config] english-title-case-every: 0
[2023-07-22 14:33:50] [config] exponential-smoothing: 0
[2023-07-22 14:33:50] [config] factor-weight: 1
[2023-07-22 14:33:50] [config] factors-combine: sum
[2023-07-22 14:33:50] [config] factors-dim-emb: 0
[2023-07-22 14:33:50] [config] gradient-checkpointing: false
[2023-07-22 14:33:50] [config] gradient-norm-average-window: 100
[2023-07-22 14:33:50] [config] guided-alignment: none
[2023-07-22 14:33:50] [config] guided-alignment-cost: mse
[2023-07-22 14:33:50] [config] guided-alignment-weight: 0.1
[2023-07-22 14:33:50] [config] ignore-model-config: false
[2023-07-22 14:33:50] [config] input-types:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] interpolate-env-vars: false
[2023-07-22 14:33:50] [config] keep-best: false
[2023-07-22 14:33:50] [config] label-smoothing: 0
[2023-07-22 14:33:50] [config] layer-normalization: false
[2023-07-22 14:33:50] [config] learn-rate: 0.0001
[2023-07-22 14:33:50] [config] lemma-dependency: ""
[2023-07-22 14:33:50] [config] lemma-dim-emb: 0
[2023-07-22 14:33:50] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 14:33:50] [config] log-level: info
[2023-07-22 14:33:50] [config] log-time-zone: ""
[2023-07-22 14:33:50] [config] logical-epoch:
[2023-07-22 14:33:50] [config]   - 1e
[2023-07-22 14:33:50] [config]   - 0
[2023-07-22 14:33:50] [config] lr-decay: 0
[2023-07-22 14:33:50] [config] lr-decay-freq: 50000
[2023-07-22 14:33:50] [config] lr-decay-inv-sqrt:
[2023-07-22 14:33:50] [config]   - 0
[2023-07-22 14:33:50] [config] lr-decay-repeat-warmup: false
[2023-07-22 14:33:50] [config] lr-decay-reset-optimizer: false
[2023-07-22 14:33:50] [config] lr-decay-start:
[2023-07-22 14:33:50] [config]   - 10
[2023-07-22 14:33:50] [config]   - 1
[2023-07-22 14:33:50] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 14:33:50] [config] lr-report: false
[2023-07-22 14:33:50] [config] lr-warmup: 0
[2023-07-22 14:33:50] [config] lr-warmup-at-reload: false
[2023-07-22 14:33:50] [config] lr-warmup-cycle: false
[2023-07-22 14:33:50] [config] lr-warmup-start-rate: 0
[2023-07-22 14:33:50] [config] max-length: 50
[2023-07-22 14:33:50] [config] max-length-crop: true
[2023-07-22 14:33:50] [config] max-length-factor: 3
[2023-07-22 14:33:50] [config] maxi-batch: 100
[2023-07-22 14:33:50] [config] maxi-batch-sort: trg
[2023-07-22 14:33:50] [config] mini-batch: 64
[2023-07-22 14:33:50] [config] mini-batch-fit: true
[2023-07-22 14:33:50] [config] mini-batch-fit-step: 10
[2023-07-22 14:33:50] [config] mini-batch-round-up: true
[2023-07-22 14:33:50] [config] mini-batch-track-lr: false
[2023-07-22 14:33:50] [config] mini-batch-warmup: 0
[2023-07-22 14:33:50] [config] mini-batch-words: 0
[2023-07-22 14:33:50] [config] mini-batch-words-ref: 0
[2023-07-22 14:33:50] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 14:33:50] [config] multi-loss-type: sum
[2023-07-22 14:33:50] [config] n-best: false
[2023-07-22 14:33:50] [config] no-nccl: false
[2023-07-22 14:33:50] [config] no-reload: false
[2023-07-22 14:33:50] [config] no-restore-corpus: false
[2023-07-22 14:33:50] [config] normalize: 0
[2023-07-22 14:33:50] [config] normalize-gradient: false
[2023-07-22 14:33:50] [config] num-devices: 0
[2023-07-22 14:33:50] [config] optimizer: adam
[2023-07-22 14:33:50] [config] optimizer-delay: 1
[2023-07-22 14:33:50] [config] optimizer-params:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] output-omit-bias: false
[2023-07-22 14:33:50] [config] overwrite: true
[2023-07-22 14:33:50] [config] precision:
[2023-07-22 14:33:50] [config]   - float16
[2023-07-22 14:33:50] [config]   - float32
[2023-07-22 14:33:50] [config] pretrained-model: ""
[2023-07-22 14:33:50] [config] quantize-biases: false
[2023-07-22 14:33:50] [config] quantize-bits: 0
[2023-07-22 14:33:50] [config] quantize-log-based: false
[2023-07-22 14:33:50] [config] quantize-optimization-steps: 0
[2023-07-22 14:33:50] [config] quiet: false
[2023-07-22 14:33:50] [config] quiet-translation: true
[2023-07-22 14:33:50] [config] relative-paths: false
[2023-07-22 14:33:50] [config] right-left: false
[2023-07-22 14:33:50] [config] save-freq: 10000u
[2023-07-22 14:33:50] [config] seed: 1234
[2023-07-22 14:33:50] [config] sentencepiece-alphas:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] sentencepiece-max-lines: 2000000
[2023-07-22 14:33:50] [config] sentencepiece-options: ""
[2023-07-22 14:33:50] [config] sharding: global
[2023-07-22 14:33:50] [config] shuffle: data
[2023-07-22 14:33:50] [config] shuffle-in-ram: false
[2023-07-22 14:33:50] [config] sigterm: save-and-exit
[2023-07-22 14:33:50] [config] skip: false
[2023-07-22 14:33:50] [config] sqlite: ""
[2023-07-22 14:33:50] [config] sqlite-drop: false
[2023-07-22 14:33:50] [config] sync-freq: 200u
[2023-07-22 14:33:50] [config] sync-sgd: false
[2023-07-22 14:33:50] [config] tempdir: /tmp
[2023-07-22 14:33:50] [config] tied-embeddings: false
[2023-07-22 14:33:50] [config] tied-embeddings-all: true
[2023-07-22 14:33:50] [config] tied-embeddings-src: false
[2023-07-22 14:33:50] [config] train-embedder-rank:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] train-sets:
[2023-07-22 14:33:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 14:33:50] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 14:33:50] [config] transformer-aan-activation: swish
[2023-07-22 14:33:50] [config] transformer-aan-depth: 2
[2023-07-22 14:33:50] [config] transformer-aan-nogate: false
[2023-07-22 14:33:50] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 14:33:50] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 14:33:50] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 14:33:50] [config] transformer-depth-scaling: false
[2023-07-22 14:33:50] [config] transformer-dim-aan: 2048
[2023-07-22 14:33:50] [config] transformer-dim-ffn: 2048
[2023-07-22 14:33:50] [config] transformer-dropout: 0
[2023-07-22 14:33:50] [config] transformer-dropout-attention: 0
[2023-07-22 14:33:50] [config] transformer-dropout-ffn: 0
[2023-07-22 14:33:50] [config] transformer-ffn-activation: swish
[2023-07-22 14:33:50] [config] transformer-ffn-depth: 2
[2023-07-22 14:33:50] [config] transformer-guided-alignment-layer: last
[2023-07-22 14:33:50] [config] transformer-heads: 8
[2023-07-22 14:33:50] [config] transformer-no-projection: false
[2023-07-22 14:33:50] [config] transformer-pool: false
[2023-07-22 14:33:50] [config] transformer-postprocess: dan
[2023-07-22 14:33:50] [config] transformer-postprocess-emb: d
[2023-07-22 14:33:50] [config] transformer-postprocess-top: ""
[2023-07-22 14:33:50] [config] transformer-preprocess: ""
[2023-07-22 14:33:50] [config] transformer-tied-layers:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] transformer-train-position-embeddings: false
[2023-07-22 14:33:50] [config] tsv: false
[2023-07-22 14:33:50] [config] tsv-fields: 0
[2023-07-22 14:33:50] [config] type: amun
[2023-07-22 14:33:50] [config] ulr: false
[2023-07-22 14:33:50] [config] ulr-dim-emb: 0
[2023-07-22 14:33:50] [config] ulr-dropout: 0
[2023-07-22 14:33:50] [config] ulr-keys-vectors: ""
[2023-07-22 14:33:50] [config] ulr-query-vectors: ""
[2023-07-22 14:33:50] [config] ulr-softmax-temperature: 1
[2023-07-22 14:33:50] [config] ulr-trainable-transformation: false
[2023-07-22 14:33:50] [config] unlikelihood-loss: false
[2023-07-22 14:33:50] [config] valid-freq: 50000000
[2023-07-22 14:33:50] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 14:33:50] [config] valid-max-length: 1000
[2023-07-22 14:33:50] [config] valid-metrics:
[2023-07-22 14:33:50] [config]   - cross-entropy
[2023-07-22 14:33:50] [config]   - translation
[2023-07-22 14:33:50] [config] valid-mini-batch: 32
[2023-07-22 14:33:50] [config] valid-reset-stalled: false
[2023-07-22 14:33:50] [config] valid-script-args:
[2023-07-22 14:33:50] [config]   []
[2023-07-22 14:33:50] [config] valid-script-path: ""
[2023-07-22 14:33:50] [config] valid-sets:
[2023-07-22 14:33:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 14:33:50] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 14:33:50] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 14:33:50] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 14:33:50] [config] vocabs:
[2023-07-22 14:33:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 14:33:50] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 14:33:50] [config] word-penalty: 0
[2023-07-22 14:33:50] [config] word-scores: false
[2023-07-22 14:33:50] [config] workspace: 5500
[2023-07-22 14:33:50] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 14:33:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 14:33:50] [training] Using single-device training
[2023-07-22 14:33:51] Synced seed 1234
[2023-07-22 14:33:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 14:33:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 14:33:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 14:33:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 14:33:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 14:33:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 14:33:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 14:33:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 14:33:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 14:33:53] [comm] Using global sharding
[2023-07-22 14:33:53] [comm] NCCLCommunicators constructed successfully
[2023-07-22 14:33:53] [training] Using 1 GPUs
[2023-07-22 14:33:53] [logits] Applying loss function for 1 factor(s)
[2023-07-22 14:33:53] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:33:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 14:33:53] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:40:46] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 14:40:46] [valid] No post-processing script given for validating translator
[2023-07-22 14:40:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 14:40:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 14:40:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 14:40:46] [comm] Using global sharding
[2023-07-22 14:40:46] [comm] NCCLCommunicators constructed successfully
[2023-07-22 14:40:46] [training] Using 1 GPUs
[2023-07-22 14:40:46] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 14:40:47] Allocating memory for general optimizer shards
[2023-07-22 14:40:47] [memory] Reserving 322 MB, device gpu0
[2023-07-22 14:40:47] Loading Adam parameters
[2023-07-22 14:40:48] [memory] Reserving 322 MB, device gpu0
[2023-07-22 14:40:48] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:40:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 14:40:48] [data] Restoring the corpus state to epoch 71, batch 2030
[2023-07-22 14:40:48] [data] Shuffling data
[2023-07-22 14:40:48] [data] Done reading 20,192 sentences
[2023-07-22 14:40:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:40:48] Training started
[2023-07-22 14:40:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 14:40:50] [memory] Reserving 80 MB, device gpu0
[2023-07-22 14:41:04] Parameter type float16, optimization type float32, casting types true
[2023-07-22 14:44:43] Seen 20,192 samples
[2023-07-22 14:44:43] Starting data epoch 72 in logical epoch 72
[2023-07-22 14:44:43] [data] Shuffling data
[2023-07-22 14:44:43] [data] Done reading 20,192 sentences
[2023-07-22 14:44:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:48:35] Seen 20,192 samples
[2023-07-22 14:48:35] Starting data epoch 73 in logical epoch 73
[2023-07-22 14:48:35] [data] Shuffling data
[2023-07-22 14:48:35] [data] Done reading 20,192 sentences
[2023-07-22 14:48:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:52:27] Seen 20,192 samples
[2023-07-22 14:52:27] Starting data epoch 74 in logical epoch 74
[2023-07-22 14:52:27] [data] Shuffling data
[2023-07-22 14:52:27] [data] Done reading 20,192 sentences
[2023-07-22 14:52:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 14:56:12] Seen 20,192 samples
[2023-07-22 14:56:12] Starting data epoch 75 in logical epoch 75
[2023-07-22 14:56:12] [data] Shuffling data
[2023-07-22 14:56:12] [data] Done reading 20,192 sentences
[2023-07-22 14:56:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:00:06] Seen 20,192 samples
[2023-07-22 15:00:06] Starting data epoch 76 in logical epoch 76
[2023-07-22 15:00:06] [data] Shuffling data
[2023-07-22 15:00:06] [data] Done reading 20,192 sentences
[2023-07-22 15:00:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:04:07] Seen 20,192 samples
[2023-07-22 15:04:07] Starting data epoch 77 in logical epoch 77
[2023-07-22 15:04:07] [data] Shuffling data
[2023-07-22 15:04:07] [data] Done reading 20,192 sentences
[2023-07-22 15:04:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:07:57] Seen 20,192 samples
[2023-07-22 15:07:57] Starting data epoch 78 in logical epoch 78
[2023-07-22 15:07:57] [data] Shuffling data
[2023-07-22 15:07:57] [data] Done reading 20,192 sentences
[2023-07-22 15:07:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:11:52] Seen 20,192 samples
[2023-07-22 15:11:52] Starting data epoch 79 in logical epoch 79
[2023-07-22 15:11:52] [data] Shuffling data
[2023-07-22 15:11:52] [data] Done reading 20,192 sentences
[2023-07-22 15:11:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:15:37] Seen 20,192 samples
[2023-07-22 15:15:37] Starting data epoch 80 in logical epoch 80
[2023-07-22 15:15:37] [data] Shuffling data
[2023-07-22 15:15:37] [data] Done reading 20,192 sentences
[2023-07-22 15:15:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:19:28] Seen 20,192 samples
[2023-07-22 15:19:28] Starting data epoch 81 in logical epoch 81
[2023-07-22 15:19:28] Training finished
[2023-07-22 15:19:48] [valid] Ep. 81 : Up. 2319 : cross-entropy : 141.047 : new best
[2023-07-22 15:23:03] [valid] Ep. 81 : Up. 2319 : translation : 0 : new best
[2023-07-22 15:23:03] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 15:23:05] Saving Adam parameters
[2023-07-22 15:23:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 15:23:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 15:23:11] [marian] Running on node23.datos.cluster.uy as process 11268 with command line:
[2023-07-22 15:23:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 15:23:12] [config] after: 0e
[2023-07-22 15:23:12] [config] after-batches: 0
[2023-07-22 15:23:12] [config] after-epochs: 90
[2023-07-22 15:23:12] [config] all-caps-every: 0
[2023-07-22 15:23:12] [config] allow-unk: false
[2023-07-22 15:23:12] [config] authors: false
[2023-07-22 15:23:12] [config] beam-size: 12
[2023-07-22 15:23:12] [config] bert-class-symbol: "[CLS]"
[2023-07-22 15:23:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 15:23:12] [config] bert-masking-fraction: 0.15
[2023-07-22 15:23:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 15:23:12] [config] bert-train-type-embeddings: true
[2023-07-22 15:23:12] [config] bert-type-vocab-size: 2
[2023-07-22 15:23:12] [config] build-info: ""
[2023-07-22 15:23:12] [config] check-gradient-nan: false
[2023-07-22 15:23:12] [config] check-nan: false
[2023-07-22 15:23:12] [config] cite: false
[2023-07-22 15:23:12] [config] clip-norm: 1
[2023-07-22 15:23:12] [config] cost-scaling:
[2023-07-22 15:23:12] [config]   - 256.f
[2023-07-22 15:23:12] [config]   - 1000
[2023-07-22 15:23:12] [config]   - 2.f
[2023-07-22 15:23:12] [config]   - 256.f
[2023-07-22 15:23:12] [config] cost-type: ce-sum
[2023-07-22 15:23:12] [config] cpu-threads: 0
[2023-07-22 15:23:12] [config] data-threads: 8
[2023-07-22 15:23:12] [config] data-weighting: ""
[2023-07-22 15:23:12] [config] data-weighting-type: sentence
[2023-07-22 15:23:12] [config] dec-cell: gru
[2023-07-22 15:23:12] [config] dec-cell-base-depth: 2
[2023-07-22 15:23:12] [config] dec-cell-high-depth: 1
[2023-07-22 15:23:12] [config] dec-depth: 1
[2023-07-22 15:23:12] [config] devices:
[2023-07-22 15:23:12] [config]   - 0
[2023-07-22 15:23:12] [config] dim-emb: 512
[2023-07-22 15:23:12] [config] dim-rnn: 1024
[2023-07-22 15:23:12] [config] dim-vocabs:
[2023-07-22 15:23:12] [config]   - 16384
[2023-07-22 15:23:12] [config]   - 16384
[2023-07-22 15:23:12] [config] disp-first: 0
[2023-07-22 15:23:12] [config] disp-freq: 1000u
[2023-07-22 15:23:12] [config] disp-label-counts: true
[2023-07-22 15:23:12] [config] dropout-rnn: 0
[2023-07-22 15:23:12] [config] dropout-src: 0
[2023-07-22 15:23:12] [config] dropout-trg: 0
[2023-07-22 15:23:12] [config] dump-config: ""
[2023-07-22 15:23:12] [config] dynamic-gradient-scaling:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] early-stopping: 200
[2023-07-22 15:23:12] [config] early-stopping-on: first
[2023-07-22 15:23:12] [config] embedding-fix-src: false
[2023-07-22 15:23:12] [config] embedding-fix-trg: false
[2023-07-22 15:23:12] [config] embedding-normalization: false
[2023-07-22 15:23:12] [config] embedding-vectors:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] enc-cell: gru
[2023-07-22 15:23:12] [config] enc-cell-depth: 1
[2023-07-22 15:23:12] [config] enc-depth: 1
[2023-07-22 15:23:12] [config] enc-type: bidirectional
[2023-07-22 15:23:12] [config] english-title-case-every: 0
[2023-07-22 15:23:12] [config] exponential-smoothing: 0
[2023-07-22 15:23:12] [config] factor-weight: 1
[2023-07-22 15:23:12] [config] factors-combine: sum
[2023-07-22 15:23:12] [config] factors-dim-emb: 0
[2023-07-22 15:23:12] [config] gradient-checkpointing: false
[2023-07-22 15:23:12] [config] gradient-norm-average-window: 100
[2023-07-22 15:23:12] [config] guided-alignment: none
[2023-07-22 15:23:12] [config] guided-alignment-cost: mse
[2023-07-22 15:23:12] [config] guided-alignment-weight: 0.1
[2023-07-22 15:23:12] [config] ignore-model-config: false
[2023-07-22 15:23:12] [config] input-types:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] interpolate-env-vars: false
[2023-07-22 15:23:12] [config] keep-best: false
[2023-07-22 15:23:12] [config] label-smoothing: 0
[2023-07-22 15:23:12] [config] layer-normalization: false
[2023-07-22 15:23:12] [config] learn-rate: 0.0001
[2023-07-22 15:23:12] [config] lemma-dependency: ""
[2023-07-22 15:23:12] [config] lemma-dim-emb: 0
[2023-07-22 15:23:12] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 15:23:12] [config] log-level: info
[2023-07-22 15:23:12] [config] log-time-zone: ""
[2023-07-22 15:23:12] [config] logical-epoch:
[2023-07-22 15:23:12] [config]   - 1e
[2023-07-22 15:23:12] [config]   - 0
[2023-07-22 15:23:12] [config] lr-decay: 0
[2023-07-22 15:23:12] [config] lr-decay-freq: 50000
[2023-07-22 15:23:12] [config] lr-decay-inv-sqrt:
[2023-07-22 15:23:12] [config]   - 0
[2023-07-22 15:23:12] [config] lr-decay-repeat-warmup: false
[2023-07-22 15:23:12] [config] lr-decay-reset-optimizer: false
[2023-07-22 15:23:12] [config] lr-decay-start:
[2023-07-22 15:23:12] [config]   - 10
[2023-07-22 15:23:12] [config]   - 1
[2023-07-22 15:23:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 15:23:12] [config] lr-report: false
[2023-07-22 15:23:12] [config] lr-warmup: 0
[2023-07-22 15:23:12] [config] lr-warmup-at-reload: false
[2023-07-22 15:23:12] [config] lr-warmup-cycle: false
[2023-07-22 15:23:12] [config] lr-warmup-start-rate: 0
[2023-07-22 15:23:12] [config] max-length: 50
[2023-07-22 15:23:12] [config] max-length-crop: true
[2023-07-22 15:23:12] [config] max-length-factor: 3
[2023-07-22 15:23:12] [config] maxi-batch: 100
[2023-07-22 15:23:12] [config] maxi-batch-sort: trg
[2023-07-22 15:23:12] [config] mini-batch: 64
[2023-07-22 15:23:12] [config] mini-batch-fit: true
[2023-07-22 15:23:12] [config] mini-batch-fit-step: 10
[2023-07-22 15:23:12] [config] mini-batch-round-up: true
[2023-07-22 15:23:12] [config] mini-batch-track-lr: false
[2023-07-22 15:23:12] [config] mini-batch-warmup: 0
[2023-07-22 15:23:12] [config] mini-batch-words: 0
[2023-07-22 15:23:12] [config] mini-batch-words-ref: 0
[2023-07-22 15:23:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 15:23:12] [config] multi-loss-type: sum
[2023-07-22 15:23:12] [config] n-best: false
[2023-07-22 15:23:12] [config] no-nccl: false
[2023-07-22 15:23:12] [config] no-reload: false
[2023-07-22 15:23:12] [config] no-restore-corpus: false
[2023-07-22 15:23:12] [config] normalize: 0
[2023-07-22 15:23:12] [config] normalize-gradient: false
[2023-07-22 15:23:12] [config] num-devices: 0
[2023-07-22 15:23:12] [config] optimizer: adam
[2023-07-22 15:23:12] [config] optimizer-delay: 1
[2023-07-22 15:23:12] [config] optimizer-params:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] output-omit-bias: false
[2023-07-22 15:23:12] [config] overwrite: true
[2023-07-22 15:23:12] [config] precision:
[2023-07-22 15:23:12] [config]   - float16
[2023-07-22 15:23:12] [config]   - float32
[2023-07-22 15:23:12] [config] pretrained-model: ""
[2023-07-22 15:23:12] [config] quantize-biases: false
[2023-07-22 15:23:12] [config] quantize-bits: 0
[2023-07-22 15:23:12] [config] quantize-log-based: false
[2023-07-22 15:23:12] [config] quantize-optimization-steps: 0
[2023-07-22 15:23:12] [config] quiet: false
[2023-07-22 15:23:12] [config] quiet-translation: true
[2023-07-22 15:23:12] [config] relative-paths: false
[2023-07-22 15:23:12] [config] right-left: false
[2023-07-22 15:23:12] [config] save-freq: 10000u
[2023-07-22 15:23:12] [config] seed: 1234
[2023-07-22 15:23:12] [config] sentencepiece-alphas:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] sentencepiece-max-lines: 2000000
[2023-07-22 15:23:12] [config] sentencepiece-options: ""
[2023-07-22 15:23:12] [config] sharding: global
[2023-07-22 15:23:12] [config] shuffle: data
[2023-07-22 15:23:12] [config] shuffle-in-ram: false
[2023-07-22 15:23:12] [config] sigterm: save-and-exit
[2023-07-22 15:23:12] [config] skip: false
[2023-07-22 15:23:12] [config] sqlite: ""
[2023-07-22 15:23:12] [config] sqlite-drop: false
[2023-07-22 15:23:12] [config] sync-freq: 200u
[2023-07-22 15:23:12] [config] sync-sgd: false
[2023-07-22 15:23:12] [config] tempdir: /tmp
[2023-07-22 15:23:12] [config] tied-embeddings: false
[2023-07-22 15:23:12] [config] tied-embeddings-all: true
[2023-07-22 15:23:12] [config] tied-embeddings-src: false
[2023-07-22 15:23:12] [config] train-embedder-rank:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] train-sets:
[2023-07-22 15:23:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 15:23:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 15:23:12] [config] transformer-aan-activation: swish
[2023-07-22 15:23:12] [config] transformer-aan-depth: 2
[2023-07-22 15:23:12] [config] transformer-aan-nogate: false
[2023-07-22 15:23:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 15:23:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 15:23:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 15:23:12] [config] transformer-depth-scaling: false
[2023-07-22 15:23:12] [config] transformer-dim-aan: 2048
[2023-07-22 15:23:12] [config] transformer-dim-ffn: 2048
[2023-07-22 15:23:12] [config] transformer-dropout: 0
[2023-07-22 15:23:12] [config] transformer-dropout-attention: 0
[2023-07-22 15:23:12] [config] transformer-dropout-ffn: 0
[2023-07-22 15:23:12] [config] transformer-ffn-activation: swish
[2023-07-22 15:23:12] [config] transformer-ffn-depth: 2
[2023-07-22 15:23:12] [config] transformer-guided-alignment-layer: last
[2023-07-22 15:23:12] [config] transformer-heads: 8
[2023-07-22 15:23:12] [config] transformer-no-projection: false
[2023-07-22 15:23:12] [config] transformer-pool: false
[2023-07-22 15:23:12] [config] transformer-postprocess: dan
[2023-07-22 15:23:12] [config] transformer-postprocess-emb: d
[2023-07-22 15:23:12] [config] transformer-postprocess-top: ""
[2023-07-22 15:23:12] [config] transformer-preprocess: ""
[2023-07-22 15:23:12] [config] transformer-tied-layers:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] transformer-train-position-embeddings: false
[2023-07-22 15:23:12] [config] tsv: false
[2023-07-22 15:23:12] [config] tsv-fields: 0
[2023-07-22 15:23:12] [config] type: amun
[2023-07-22 15:23:12] [config] ulr: false
[2023-07-22 15:23:12] [config] ulr-dim-emb: 0
[2023-07-22 15:23:12] [config] ulr-dropout: 0
[2023-07-22 15:23:12] [config] ulr-keys-vectors: ""
[2023-07-22 15:23:12] [config] ulr-query-vectors: ""
[2023-07-22 15:23:12] [config] ulr-softmax-temperature: 1
[2023-07-22 15:23:12] [config] ulr-trainable-transformation: false
[2023-07-22 15:23:12] [config] unlikelihood-loss: false
[2023-07-22 15:23:12] [config] valid-freq: 50000000
[2023-07-22 15:23:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 15:23:12] [config] valid-max-length: 1000
[2023-07-22 15:23:12] [config] valid-metrics:
[2023-07-22 15:23:12] [config]   - cross-entropy
[2023-07-22 15:23:12] [config]   - translation
[2023-07-22 15:23:12] [config] valid-mini-batch: 32
[2023-07-22 15:23:12] [config] valid-reset-stalled: false
[2023-07-22 15:23:12] [config] valid-script-args:
[2023-07-22 15:23:12] [config]   []
[2023-07-22 15:23:12] [config] valid-script-path: ""
[2023-07-22 15:23:12] [config] valid-sets:
[2023-07-22 15:23:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 15:23:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 15:23:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 15:23:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 15:23:12] [config] vocabs:
[2023-07-22 15:23:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 15:23:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 15:23:12] [config] word-penalty: 0
[2023-07-22 15:23:12] [config] word-scores: false
[2023-07-22 15:23:12] [config] workspace: 5500
[2023-07-22 15:23:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 15:23:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 15:23:12] [training] Using single-device training
[2023-07-22 15:23:12] Synced seed 1234
[2023-07-22 15:23:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 15:23:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 15:23:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 15:23:13] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 15:23:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 15:23:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 15:23:13] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 15:23:14] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 15:23:14] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 15:23:14] [comm] Using global sharding
[2023-07-22 15:23:14] [comm] NCCLCommunicators constructed successfully
[2023-07-22 15:23:14] [training] Using 1 GPUs
[2023-07-22 15:23:14] [logits] Applying loss function for 1 factor(s)
[2023-07-22 15:23:14] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:23:14] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 15:23:14] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:30:03] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 15:30:03] [valid] No post-processing script given for validating translator
[2023-07-22 15:30:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 15:30:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 15:30:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 15:30:03] [comm] Using global sharding
[2023-07-22 15:30:03] [comm] NCCLCommunicators constructed successfully
[2023-07-22 15:30:03] [training] Using 1 GPUs
[2023-07-22 15:30:03] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 15:30:06] Allocating memory for general optimizer shards
[2023-07-22 15:30:06] [memory] Reserving 322 MB, device gpu0
[2023-07-22 15:30:06] Loading Adam parameters
[2023-07-22 15:30:06] [memory] Reserving 322 MB, device gpu0
[2023-07-22 15:30:06] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:30:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 15:30:06] [data] Restoring the corpus state to epoch 81, batch 2319
[2023-07-22 15:30:06] [data] Shuffling data
[2023-07-22 15:30:06] [data] Done reading 20,192 sentences
[2023-07-22 15:30:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:30:06] Training started
[2023-07-22 15:30:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 15:30:08] [memory] Reserving 80 MB, device gpu0
[2023-07-22 15:30:19] Parameter type float16, optimization type float32, casting types true
[2023-07-22 15:33:43] Seen 20,192 samples
[2023-07-22 15:33:43] Starting data epoch 82 in logical epoch 82
[2023-07-22 15:33:43] [data] Shuffling data
[2023-07-22 15:33:43] [data] Done reading 20,192 sentences
[2023-07-22 15:33:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:37:25] Seen 20,192 samples
[2023-07-22 15:37:25] Starting data epoch 83 in logical epoch 83
[2023-07-22 15:37:25] [data] Shuffling data
[2023-07-22 15:37:25] [data] Done reading 20,192 sentences
[2023-07-22 15:37:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:41:22] Seen 20,192 samples
[2023-07-22 15:41:22] Starting data epoch 84 in logical epoch 84
[2023-07-22 15:41:22] [data] Shuffling data
[2023-07-22 15:41:22] [data] Done reading 20,192 sentences
[2023-07-22 15:41:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:45:07] Seen 20,192 samples
[2023-07-22 15:45:07] Starting data epoch 85 in logical epoch 85
[2023-07-22 15:45:07] [data] Shuffling data
[2023-07-22 15:45:07] [data] Done reading 20,192 sentences
[2023-07-22 15:45:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:49:01] Seen 20,192 samples
[2023-07-22 15:49:01] Starting data epoch 86 in logical epoch 86
[2023-07-22 15:49:01] [data] Shuffling data
[2023-07-22 15:49:01] [data] Done reading 20,192 sentences
[2023-07-22 15:49:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:52:35] Seen 20,192 samples
[2023-07-22 15:52:35] Starting data epoch 87 in logical epoch 87
[2023-07-22 15:52:35] [data] Shuffling data
[2023-07-22 15:52:35] [data] Done reading 20,192 sentences
[2023-07-22 15:52:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 15:56:21] Seen 20,192 samples
[2023-07-22 15:56:21] Starting data epoch 88 in logical epoch 88
[2023-07-22 15:56:21] [data] Shuffling data
[2023-07-22 15:56:21] [data] Done reading 20,192 sentences
[2023-07-22 15:56:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:00:02] Seen 20,192 samples
[2023-07-22 16:00:02] Starting data epoch 89 in logical epoch 89
[2023-07-22 16:00:02] [data] Shuffling data
[2023-07-22 16:00:02] [data] Done reading 20,192 sentences
[2023-07-22 16:00:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:03:53] Seen 20,192 samples
[2023-07-22 16:03:53] Starting data epoch 90 in logical epoch 90
[2023-07-22 16:03:53] [data] Shuffling data
[2023-07-22 16:03:53] [data] Done reading 20,192 sentences
[2023-07-22 16:03:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:07:31] Seen 20,192 samples
[2023-07-22 16:07:31] Starting data epoch 91 in logical epoch 91
[2023-07-22 16:07:31] Training finished
[2023-07-22 16:07:46] [valid] Ep. 91 : Up. 2609 : cross-entropy : 138.393 : new best
[2023-07-22 16:10:46] [valid] Ep. 91 : Up. 2609 : translation : 0 : new best
[2023-07-22 16:10:46] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 16:10:48] Saving Adam parameters
[2023-07-22 16:10:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 16:10:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:10:55] [marian] Running on node23.datos.cluster.uy as process 14187 with command line:
[2023-07-22 16:10:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 16:10:55] [config] after: 0e
[2023-07-22 16:10:55] [config] after-batches: 0
[2023-07-22 16:10:55] [config] after-epochs: 100
[2023-07-22 16:10:55] [config] all-caps-every: 0
[2023-07-22 16:10:55] [config] allow-unk: false
[2023-07-22 16:10:55] [config] authors: false
[2023-07-22 16:10:55] [config] beam-size: 12
[2023-07-22 16:10:55] [config] bert-class-symbol: "[CLS]"
[2023-07-22 16:10:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 16:10:55] [config] bert-masking-fraction: 0.15
[2023-07-22 16:10:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 16:10:55] [config] bert-train-type-embeddings: true
[2023-07-22 16:10:55] [config] bert-type-vocab-size: 2
[2023-07-22 16:10:55] [config] build-info: ""
[2023-07-22 16:10:55] [config] check-gradient-nan: false
[2023-07-22 16:10:55] [config] check-nan: false
[2023-07-22 16:10:55] [config] cite: false
[2023-07-22 16:10:55] [config] clip-norm: 1
[2023-07-22 16:10:55] [config] cost-scaling:
[2023-07-22 16:10:55] [config]   - 256.f
[2023-07-22 16:10:55] [config]   - 1000
[2023-07-22 16:10:55] [config]   - 2.f
[2023-07-22 16:10:55] [config]   - 256.f
[2023-07-22 16:10:55] [config] cost-type: ce-sum
[2023-07-22 16:10:55] [config] cpu-threads: 0
[2023-07-22 16:10:55] [config] data-threads: 8
[2023-07-22 16:10:55] [config] data-weighting: ""
[2023-07-22 16:10:55] [config] data-weighting-type: sentence
[2023-07-22 16:10:55] [config] dec-cell: gru
[2023-07-22 16:10:55] [config] dec-cell-base-depth: 2
[2023-07-22 16:10:55] [config] dec-cell-high-depth: 1
[2023-07-22 16:10:55] [config] dec-depth: 1
[2023-07-22 16:10:55] [config] devices:
[2023-07-22 16:10:55] [config]   - 0
[2023-07-22 16:10:55] [config] dim-emb: 512
[2023-07-22 16:10:55] [config] dim-rnn: 1024
[2023-07-22 16:10:55] [config] dim-vocabs:
[2023-07-22 16:10:55] [config]   - 16384
[2023-07-22 16:10:55] [config]   - 16384
[2023-07-22 16:10:55] [config] disp-first: 0
[2023-07-22 16:10:55] [config] disp-freq: 1000u
[2023-07-22 16:10:55] [config] disp-label-counts: true
[2023-07-22 16:10:55] [config] dropout-rnn: 0
[2023-07-22 16:10:55] [config] dropout-src: 0
[2023-07-22 16:10:55] [config] dropout-trg: 0
[2023-07-22 16:10:55] [config] dump-config: ""
[2023-07-22 16:10:55] [config] dynamic-gradient-scaling:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] early-stopping: 200
[2023-07-22 16:10:55] [config] early-stopping-on: first
[2023-07-22 16:10:55] [config] embedding-fix-src: false
[2023-07-22 16:10:55] [config] embedding-fix-trg: false
[2023-07-22 16:10:55] [config] embedding-normalization: false
[2023-07-22 16:10:55] [config] embedding-vectors:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] enc-cell: gru
[2023-07-22 16:10:55] [config] enc-cell-depth: 1
[2023-07-22 16:10:55] [config] enc-depth: 1
[2023-07-22 16:10:55] [config] enc-type: bidirectional
[2023-07-22 16:10:55] [config] english-title-case-every: 0
[2023-07-22 16:10:55] [config] exponential-smoothing: 0
[2023-07-22 16:10:55] [config] factor-weight: 1
[2023-07-22 16:10:55] [config] factors-combine: sum
[2023-07-22 16:10:55] [config] factors-dim-emb: 0
[2023-07-22 16:10:55] [config] gradient-checkpointing: false
[2023-07-22 16:10:55] [config] gradient-norm-average-window: 100
[2023-07-22 16:10:55] [config] guided-alignment: none
[2023-07-22 16:10:55] [config] guided-alignment-cost: mse
[2023-07-22 16:10:55] [config] guided-alignment-weight: 0.1
[2023-07-22 16:10:55] [config] ignore-model-config: false
[2023-07-22 16:10:55] [config] input-types:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] interpolate-env-vars: false
[2023-07-22 16:10:55] [config] keep-best: false
[2023-07-22 16:10:55] [config] label-smoothing: 0
[2023-07-22 16:10:55] [config] layer-normalization: false
[2023-07-22 16:10:55] [config] learn-rate: 0.0001
[2023-07-22 16:10:55] [config] lemma-dependency: ""
[2023-07-22 16:10:55] [config] lemma-dim-emb: 0
[2023-07-22 16:10:55] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 16:10:55] [config] log-level: info
[2023-07-22 16:10:55] [config] log-time-zone: ""
[2023-07-22 16:10:55] [config] logical-epoch:
[2023-07-22 16:10:55] [config]   - 1e
[2023-07-22 16:10:55] [config]   - 0
[2023-07-22 16:10:55] [config] lr-decay: 0
[2023-07-22 16:10:55] [config] lr-decay-freq: 50000
[2023-07-22 16:10:55] [config] lr-decay-inv-sqrt:
[2023-07-22 16:10:55] [config]   - 0
[2023-07-22 16:10:55] [config] lr-decay-repeat-warmup: false
[2023-07-22 16:10:55] [config] lr-decay-reset-optimizer: false
[2023-07-22 16:10:55] [config] lr-decay-start:
[2023-07-22 16:10:55] [config]   - 10
[2023-07-22 16:10:55] [config]   - 1
[2023-07-22 16:10:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 16:10:55] [config] lr-report: false
[2023-07-22 16:10:55] [config] lr-warmup: 0
[2023-07-22 16:10:55] [config] lr-warmup-at-reload: false
[2023-07-22 16:10:55] [config] lr-warmup-cycle: false
[2023-07-22 16:10:55] [config] lr-warmup-start-rate: 0
[2023-07-22 16:10:55] [config] max-length: 50
[2023-07-22 16:10:55] [config] max-length-crop: true
[2023-07-22 16:10:55] [config] max-length-factor: 3
[2023-07-22 16:10:55] [config] maxi-batch: 100
[2023-07-22 16:10:55] [config] maxi-batch-sort: trg
[2023-07-22 16:10:55] [config] mini-batch: 64
[2023-07-22 16:10:55] [config] mini-batch-fit: true
[2023-07-22 16:10:55] [config] mini-batch-fit-step: 10
[2023-07-22 16:10:55] [config] mini-batch-round-up: true
[2023-07-22 16:10:55] [config] mini-batch-track-lr: false
[2023-07-22 16:10:55] [config] mini-batch-warmup: 0
[2023-07-22 16:10:55] [config] mini-batch-words: 0
[2023-07-22 16:10:55] [config] mini-batch-words-ref: 0
[2023-07-22 16:10:55] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 16:10:55] [config] multi-loss-type: sum
[2023-07-22 16:10:55] [config] n-best: false
[2023-07-22 16:10:55] [config] no-nccl: false
[2023-07-22 16:10:55] [config] no-reload: false
[2023-07-22 16:10:55] [config] no-restore-corpus: false
[2023-07-22 16:10:55] [config] normalize: 0
[2023-07-22 16:10:55] [config] normalize-gradient: false
[2023-07-22 16:10:55] [config] num-devices: 0
[2023-07-22 16:10:55] [config] optimizer: adam
[2023-07-22 16:10:55] [config] optimizer-delay: 1
[2023-07-22 16:10:55] [config] optimizer-params:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] output-omit-bias: false
[2023-07-22 16:10:55] [config] overwrite: true
[2023-07-22 16:10:55] [config] precision:
[2023-07-22 16:10:55] [config]   - float16
[2023-07-22 16:10:55] [config]   - float32
[2023-07-22 16:10:55] [config] pretrained-model: ""
[2023-07-22 16:10:55] [config] quantize-biases: false
[2023-07-22 16:10:55] [config] quantize-bits: 0
[2023-07-22 16:10:55] [config] quantize-log-based: false
[2023-07-22 16:10:55] [config] quantize-optimization-steps: 0
[2023-07-22 16:10:55] [config] quiet: false
[2023-07-22 16:10:55] [config] quiet-translation: true
[2023-07-22 16:10:55] [config] relative-paths: false
[2023-07-22 16:10:55] [config] right-left: false
[2023-07-22 16:10:55] [config] save-freq: 10000u
[2023-07-22 16:10:55] [config] seed: 1234
[2023-07-22 16:10:55] [config] sentencepiece-alphas:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] sentencepiece-max-lines: 2000000
[2023-07-22 16:10:55] [config] sentencepiece-options: ""
[2023-07-22 16:10:55] [config] sharding: global
[2023-07-22 16:10:55] [config] shuffle: data
[2023-07-22 16:10:55] [config] shuffle-in-ram: false
[2023-07-22 16:10:55] [config] sigterm: save-and-exit
[2023-07-22 16:10:55] [config] skip: false
[2023-07-22 16:10:55] [config] sqlite: ""
[2023-07-22 16:10:55] [config] sqlite-drop: false
[2023-07-22 16:10:55] [config] sync-freq: 200u
[2023-07-22 16:10:55] [config] sync-sgd: false
[2023-07-22 16:10:55] [config] tempdir: /tmp
[2023-07-22 16:10:55] [config] tied-embeddings: false
[2023-07-22 16:10:55] [config] tied-embeddings-all: true
[2023-07-22 16:10:55] [config] tied-embeddings-src: false
[2023-07-22 16:10:55] [config] train-embedder-rank:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] train-sets:
[2023-07-22 16:10:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 16:10:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 16:10:55] [config] transformer-aan-activation: swish
[2023-07-22 16:10:55] [config] transformer-aan-depth: 2
[2023-07-22 16:10:55] [config] transformer-aan-nogate: false
[2023-07-22 16:10:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 16:10:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 16:10:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 16:10:55] [config] transformer-depth-scaling: false
[2023-07-22 16:10:55] [config] transformer-dim-aan: 2048
[2023-07-22 16:10:55] [config] transformer-dim-ffn: 2048
[2023-07-22 16:10:55] [config] transformer-dropout: 0
[2023-07-22 16:10:55] [config] transformer-dropout-attention: 0
[2023-07-22 16:10:55] [config] transformer-dropout-ffn: 0
[2023-07-22 16:10:55] [config] transformer-ffn-activation: swish
[2023-07-22 16:10:55] [config] transformer-ffn-depth: 2
[2023-07-22 16:10:55] [config] transformer-guided-alignment-layer: last
[2023-07-22 16:10:55] [config] transformer-heads: 8
[2023-07-22 16:10:55] [config] transformer-no-projection: false
[2023-07-22 16:10:55] [config] transformer-pool: false
[2023-07-22 16:10:55] [config] transformer-postprocess: dan
[2023-07-22 16:10:55] [config] transformer-postprocess-emb: d
[2023-07-22 16:10:55] [config] transformer-postprocess-top: ""
[2023-07-22 16:10:55] [config] transformer-preprocess: ""
[2023-07-22 16:10:55] [config] transformer-tied-layers:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] transformer-train-position-embeddings: false
[2023-07-22 16:10:55] [config] tsv: false
[2023-07-22 16:10:55] [config] tsv-fields: 0
[2023-07-22 16:10:55] [config] type: amun
[2023-07-22 16:10:55] [config] ulr: false
[2023-07-22 16:10:55] [config] ulr-dim-emb: 0
[2023-07-22 16:10:55] [config] ulr-dropout: 0
[2023-07-22 16:10:55] [config] ulr-keys-vectors: ""
[2023-07-22 16:10:55] [config] ulr-query-vectors: ""
[2023-07-22 16:10:55] [config] ulr-softmax-temperature: 1
[2023-07-22 16:10:55] [config] ulr-trainable-transformation: false
[2023-07-22 16:10:55] [config] unlikelihood-loss: false
[2023-07-22 16:10:55] [config] valid-freq: 50000000
[2023-07-22 16:10:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 16:10:55] [config] valid-max-length: 1000
[2023-07-22 16:10:55] [config] valid-metrics:
[2023-07-22 16:10:55] [config]   - cross-entropy
[2023-07-22 16:10:55] [config]   - translation
[2023-07-22 16:10:55] [config] valid-mini-batch: 32
[2023-07-22 16:10:55] [config] valid-reset-stalled: false
[2023-07-22 16:10:55] [config] valid-script-args:
[2023-07-22 16:10:55] [config]   []
[2023-07-22 16:10:55] [config] valid-script-path: ""
[2023-07-22 16:10:55] [config] valid-sets:
[2023-07-22 16:10:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 16:10:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 16:10:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 16:10:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:10:55] [config] vocabs:
[2023-07-22 16:10:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 16:10:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 16:10:55] [config] word-penalty: 0
[2023-07-22 16:10:55] [config] word-scores: false
[2023-07-22 16:10:55] [config] workspace: 5500
[2023-07-22 16:10:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:10:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:10:55] [training] Using single-device training
[2023-07-22 16:10:55] Synced seed 1234
[2023-07-22 16:10:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 16:10:55] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 16:10:55] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 16:10:55] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 16:10:55] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 16:10:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:10:55] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 16:10:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 16:10:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 16:10:57] [comm] Using global sharding
[2023-07-22 16:10:57] [comm] NCCLCommunicators constructed successfully
[2023-07-22 16:10:57] [training] Using 1 GPUs
[2023-07-22 16:10:57] [logits] Applying loss function for 1 factor(s)
[2023-07-22 16:10:57] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:10:57] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 16:10:57] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:17:52] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 16:17:52] [valid] No post-processing script given for validating translator
[2023-07-22 16:17:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:17:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 16:17:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 16:17:53] [comm] Using global sharding
[2023-07-22 16:17:53] [comm] NCCLCommunicators constructed successfully
[2023-07-22 16:17:53] [training] Using 1 GPUs
[2023-07-22 16:17:53] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 16:17:54] Allocating memory for general optimizer shards
[2023-07-22 16:17:54] [memory] Reserving 322 MB, device gpu0
[2023-07-22 16:17:54] Loading Adam parameters
[2023-07-22 16:17:54] [memory] Reserving 322 MB, device gpu0
[2023-07-22 16:17:54] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:17:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 16:17:54] [data] Restoring the corpus state to epoch 91, batch 2609
[2023-07-22 16:17:54] [data] Shuffling data
[2023-07-22 16:17:54] [data] Done reading 20,192 sentences
[2023-07-22 16:17:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:17:55] Training started
[2023-07-22 16:17:55] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 16:17:56] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:18:02] Parameter type float16, optimization type float32, casting types true
[2023-07-22 16:21:25] Seen 20,192 samples
[2023-07-22 16:21:25] Starting data epoch 92 in logical epoch 92
[2023-07-22 16:21:25] [data] Shuffling data
[2023-07-22 16:21:25] [data] Done reading 20,192 sentences
[2023-07-22 16:21:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:25:11] Seen 20,192 samples
[2023-07-22 16:25:11] Starting data epoch 93 in logical epoch 93
[2023-07-22 16:25:11] [data] Shuffling data
[2023-07-22 16:25:11] [data] Done reading 20,192 sentences
[2023-07-22 16:25:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:28:56] Seen 20,192 samples
[2023-07-22 16:28:56] Starting data epoch 94 in logical epoch 94
[2023-07-22 16:28:56] [data] Shuffling data
[2023-07-22 16:28:56] [data] Done reading 20,192 sentences
[2023-07-22 16:28:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:32:44] Seen 20,192 samples
[2023-07-22 16:32:44] Starting data epoch 95 in logical epoch 95
[2023-07-22 16:32:44] [data] Shuffling data
[2023-07-22 16:32:44] [data] Done reading 20,192 sentences
[2023-07-22 16:32:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:36:22] Seen 20,192 samples
[2023-07-22 16:36:22] Starting data epoch 96 in logical epoch 96
[2023-07-22 16:36:22] [data] Shuffling data
[2023-07-22 16:36:22] [data] Done reading 20,192 sentences
[2023-07-22 16:36:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:40:09] Seen 20,192 samples
[2023-07-22 16:40:09] Starting data epoch 97 in logical epoch 97
[2023-07-22 16:40:09] [data] Shuffling data
[2023-07-22 16:40:09] [data] Done reading 20,192 sentences
[2023-07-22 16:40:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:43:55] Seen 20,192 samples
[2023-07-22 16:43:55] Starting data epoch 98 in logical epoch 98
[2023-07-22 16:43:55] [data] Shuffling data
[2023-07-22 16:43:55] [data] Done reading 20,192 sentences
[2023-07-22 16:43:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:47:49] Seen 20,192 samples
[2023-07-22 16:47:49] Starting data epoch 99 in logical epoch 99
[2023-07-22 16:47:49] [data] Shuffling data
[2023-07-22 16:47:49] [data] Done reading 20,192 sentences
[2023-07-22 16:47:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:51:30] Seen 20,192 samples
[2023-07-22 16:51:30] Starting data epoch 100 in logical epoch 100
[2023-07-22 16:51:30] [data] Shuffling data
[2023-07-22 16:51:30] [data] Done reading 20,192 sentences
[2023-07-22 16:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 16:55:17] Seen 20,192 samples
[2023-07-22 16:55:17] Starting data epoch 101 in logical epoch 101
[2023-07-22 16:55:17] Training finished
[2023-07-22 16:55:32] [valid] Ep. 101 : Up. 2899 : cross-entropy : 137.289 : new best
[2023-07-22 16:58:47] [valid] Ep. 101 : Up. 2899 : translation : 0 : new best
[2023-07-22 16:58:47] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 16:58:49] Saving Adam parameters
[2023-07-22 16:58:50] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 16:58:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:58:56] [marian] Running on node23.datos.cluster.uy as process 17448 with command line:
[2023-07-22 16:58:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 16:58:57] [config] after: 0e
[2023-07-22 16:58:57] [config] after-batches: 0
[2023-07-22 16:58:57] [config] after-epochs: 110
[2023-07-22 16:58:57] [config] all-caps-every: 0
[2023-07-22 16:58:57] [config] allow-unk: false
[2023-07-22 16:58:57] [config] authors: false
[2023-07-22 16:58:57] [config] beam-size: 12
[2023-07-22 16:58:57] [config] bert-class-symbol: "[CLS]"
[2023-07-22 16:58:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 16:58:57] [config] bert-masking-fraction: 0.15
[2023-07-22 16:58:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 16:58:57] [config] bert-train-type-embeddings: true
[2023-07-22 16:58:57] [config] bert-type-vocab-size: 2
[2023-07-22 16:58:57] [config] build-info: ""
[2023-07-22 16:58:57] [config] check-gradient-nan: false
[2023-07-22 16:58:57] [config] check-nan: false
[2023-07-22 16:58:57] [config] cite: false
[2023-07-22 16:58:57] [config] clip-norm: 1
[2023-07-22 16:58:57] [config] cost-scaling:
[2023-07-22 16:58:57] [config]   - 256.f
[2023-07-22 16:58:57] [config]   - 1000
[2023-07-22 16:58:57] [config]   - 2.f
[2023-07-22 16:58:57] [config]   - 256.f
[2023-07-22 16:58:57] [config] cost-type: ce-sum
[2023-07-22 16:58:57] [config] cpu-threads: 0
[2023-07-22 16:58:57] [config] data-threads: 8
[2023-07-22 16:58:57] [config] data-weighting: ""
[2023-07-22 16:58:57] [config] data-weighting-type: sentence
[2023-07-22 16:58:57] [config] dec-cell: gru
[2023-07-22 16:58:57] [config] dec-cell-base-depth: 2
[2023-07-22 16:58:57] [config] dec-cell-high-depth: 1
[2023-07-22 16:58:57] [config] dec-depth: 1
[2023-07-22 16:58:57] [config] devices:
[2023-07-22 16:58:57] [config]   - 0
[2023-07-22 16:58:57] [config] dim-emb: 512
[2023-07-22 16:58:57] [config] dim-rnn: 1024
[2023-07-22 16:58:57] [config] dim-vocabs:
[2023-07-22 16:58:57] [config]   - 16384
[2023-07-22 16:58:57] [config]   - 16384
[2023-07-22 16:58:57] [config] disp-first: 0
[2023-07-22 16:58:57] [config] disp-freq: 1000u
[2023-07-22 16:58:57] [config] disp-label-counts: true
[2023-07-22 16:58:57] [config] dropout-rnn: 0
[2023-07-22 16:58:57] [config] dropout-src: 0
[2023-07-22 16:58:57] [config] dropout-trg: 0
[2023-07-22 16:58:57] [config] dump-config: ""
[2023-07-22 16:58:57] [config] dynamic-gradient-scaling:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] early-stopping: 200
[2023-07-22 16:58:57] [config] early-stopping-on: first
[2023-07-22 16:58:57] [config] embedding-fix-src: false
[2023-07-22 16:58:57] [config] embedding-fix-trg: false
[2023-07-22 16:58:57] [config] embedding-normalization: false
[2023-07-22 16:58:57] [config] embedding-vectors:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] enc-cell: gru
[2023-07-22 16:58:57] [config] enc-cell-depth: 1
[2023-07-22 16:58:57] [config] enc-depth: 1
[2023-07-22 16:58:57] [config] enc-type: bidirectional
[2023-07-22 16:58:57] [config] english-title-case-every: 0
[2023-07-22 16:58:57] [config] exponential-smoothing: 0
[2023-07-22 16:58:57] [config] factor-weight: 1
[2023-07-22 16:58:57] [config] factors-combine: sum
[2023-07-22 16:58:57] [config] factors-dim-emb: 0
[2023-07-22 16:58:57] [config] gradient-checkpointing: false
[2023-07-22 16:58:57] [config] gradient-norm-average-window: 100
[2023-07-22 16:58:57] [config] guided-alignment: none
[2023-07-22 16:58:57] [config] guided-alignment-cost: mse
[2023-07-22 16:58:57] [config] guided-alignment-weight: 0.1
[2023-07-22 16:58:57] [config] ignore-model-config: false
[2023-07-22 16:58:57] [config] input-types:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] interpolate-env-vars: false
[2023-07-22 16:58:57] [config] keep-best: false
[2023-07-22 16:58:57] [config] label-smoothing: 0
[2023-07-22 16:58:57] [config] layer-normalization: false
[2023-07-22 16:58:57] [config] learn-rate: 0.0001
[2023-07-22 16:58:57] [config] lemma-dependency: ""
[2023-07-22 16:58:57] [config] lemma-dim-emb: 0
[2023-07-22 16:58:57] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 16:58:57] [config] log-level: info
[2023-07-22 16:58:57] [config] log-time-zone: ""
[2023-07-22 16:58:57] [config] logical-epoch:
[2023-07-22 16:58:57] [config]   - 1e
[2023-07-22 16:58:57] [config]   - 0
[2023-07-22 16:58:57] [config] lr-decay: 0
[2023-07-22 16:58:57] [config] lr-decay-freq: 50000
[2023-07-22 16:58:57] [config] lr-decay-inv-sqrt:
[2023-07-22 16:58:57] [config]   - 0
[2023-07-22 16:58:57] [config] lr-decay-repeat-warmup: false
[2023-07-22 16:58:57] [config] lr-decay-reset-optimizer: false
[2023-07-22 16:58:57] [config] lr-decay-start:
[2023-07-22 16:58:57] [config]   - 10
[2023-07-22 16:58:57] [config]   - 1
[2023-07-22 16:58:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 16:58:57] [config] lr-report: false
[2023-07-22 16:58:57] [config] lr-warmup: 0
[2023-07-22 16:58:57] [config] lr-warmup-at-reload: false
[2023-07-22 16:58:57] [config] lr-warmup-cycle: false
[2023-07-22 16:58:57] [config] lr-warmup-start-rate: 0
[2023-07-22 16:58:57] [config] max-length: 50
[2023-07-22 16:58:57] [config] max-length-crop: true
[2023-07-22 16:58:57] [config] max-length-factor: 3
[2023-07-22 16:58:57] [config] maxi-batch: 100
[2023-07-22 16:58:57] [config] maxi-batch-sort: trg
[2023-07-22 16:58:57] [config] mini-batch: 64
[2023-07-22 16:58:57] [config] mini-batch-fit: true
[2023-07-22 16:58:57] [config] mini-batch-fit-step: 10
[2023-07-22 16:58:57] [config] mini-batch-round-up: true
[2023-07-22 16:58:57] [config] mini-batch-track-lr: false
[2023-07-22 16:58:57] [config] mini-batch-warmup: 0
[2023-07-22 16:58:57] [config] mini-batch-words: 0
[2023-07-22 16:58:57] [config] mini-batch-words-ref: 0
[2023-07-22 16:58:57] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 16:58:57] [config] multi-loss-type: sum
[2023-07-22 16:58:57] [config] n-best: false
[2023-07-22 16:58:57] [config] no-nccl: false
[2023-07-22 16:58:57] [config] no-reload: false
[2023-07-22 16:58:57] [config] no-restore-corpus: false
[2023-07-22 16:58:57] [config] normalize: 0
[2023-07-22 16:58:57] [config] normalize-gradient: false
[2023-07-22 16:58:57] [config] num-devices: 0
[2023-07-22 16:58:57] [config] optimizer: adam
[2023-07-22 16:58:57] [config] optimizer-delay: 1
[2023-07-22 16:58:57] [config] optimizer-params:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] output-omit-bias: false
[2023-07-22 16:58:57] [config] overwrite: true
[2023-07-22 16:58:57] [config] precision:
[2023-07-22 16:58:57] [config]   - float16
[2023-07-22 16:58:57] [config]   - float32
[2023-07-22 16:58:57] [config] pretrained-model: ""
[2023-07-22 16:58:57] [config] quantize-biases: false
[2023-07-22 16:58:57] [config] quantize-bits: 0
[2023-07-22 16:58:57] [config] quantize-log-based: false
[2023-07-22 16:58:57] [config] quantize-optimization-steps: 0
[2023-07-22 16:58:57] [config] quiet: false
[2023-07-22 16:58:57] [config] quiet-translation: true
[2023-07-22 16:58:57] [config] relative-paths: false
[2023-07-22 16:58:57] [config] right-left: false
[2023-07-22 16:58:57] [config] save-freq: 10000u
[2023-07-22 16:58:57] [config] seed: 1234
[2023-07-22 16:58:57] [config] sentencepiece-alphas:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] sentencepiece-max-lines: 2000000
[2023-07-22 16:58:57] [config] sentencepiece-options: ""
[2023-07-22 16:58:57] [config] sharding: global
[2023-07-22 16:58:57] [config] shuffle: data
[2023-07-22 16:58:57] [config] shuffle-in-ram: false
[2023-07-22 16:58:57] [config] sigterm: save-and-exit
[2023-07-22 16:58:57] [config] skip: false
[2023-07-22 16:58:57] [config] sqlite: ""
[2023-07-22 16:58:57] [config] sqlite-drop: false
[2023-07-22 16:58:57] [config] sync-freq: 200u
[2023-07-22 16:58:57] [config] sync-sgd: false
[2023-07-22 16:58:57] [config] tempdir: /tmp
[2023-07-22 16:58:57] [config] tied-embeddings: false
[2023-07-22 16:58:57] [config] tied-embeddings-all: true
[2023-07-22 16:58:57] [config] tied-embeddings-src: false
[2023-07-22 16:58:57] [config] train-embedder-rank:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] train-sets:
[2023-07-22 16:58:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 16:58:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 16:58:57] [config] transformer-aan-activation: swish
[2023-07-22 16:58:57] [config] transformer-aan-depth: 2
[2023-07-22 16:58:57] [config] transformer-aan-nogate: false
[2023-07-22 16:58:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 16:58:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 16:58:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 16:58:57] [config] transformer-depth-scaling: false
[2023-07-22 16:58:57] [config] transformer-dim-aan: 2048
[2023-07-22 16:58:57] [config] transformer-dim-ffn: 2048
[2023-07-22 16:58:57] [config] transformer-dropout: 0
[2023-07-22 16:58:57] [config] transformer-dropout-attention: 0
[2023-07-22 16:58:57] [config] transformer-dropout-ffn: 0
[2023-07-22 16:58:57] [config] transformer-ffn-activation: swish
[2023-07-22 16:58:57] [config] transformer-ffn-depth: 2
[2023-07-22 16:58:57] [config] transformer-guided-alignment-layer: last
[2023-07-22 16:58:57] [config] transformer-heads: 8
[2023-07-22 16:58:57] [config] transformer-no-projection: false
[2023-07-22 16:58:57] [config] transformer-pool: false
[2023-07-22 16:58:57] [config] transformer-postprocess: dan
[2023-07-22 16:58:57] [config] transformer-postprocess-emb: d
[2023-07-22 16:58:57] [config] transformer-postprocess-top: ""
[2023-07-22 16:58:57] [config] transformer-preprocess: ""
[2023-07-22 16:58:57] [config] transformer-tied-layers:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] transformer-train-position-embeddings: false
[2023-07-22 16:58:57] [config] tsv: false
[2023-07-22 16:58:57] [config] tsv-fields: 0
[2023-07-22 16:58:57] [config] type: amun
[2023-07-22 16:58:57] [config] ulr: false
[2023-07-22 16:58:57] [config] ulr-dim-emb: 0
[2023-07-22 16:58:57] [config] ulr-dropout: 0
[2023-07-22 16:58:57] [config] ulr-keys-vectors: ""
[2023-07-22 16:58:57] [config] ulr-query-vectors: ""
[2023-07-22 16:58:57] [config] ulr-softmax-temperature: 1
[2023-07-22 16:58:57] [config] ulr-trainable-transformation: false
[2023-07-22 16:58:57] [config] unlikelihood-loss: false
[2023-07-22 16:58:57] [config] valid-freq: 50000000
[2023-07-22 16:58:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 16:58:57] [config] valid-max-length: 1000
[2023-07-22 16:58:57] [config] valid-metrics:
[2023-07-22 16:58:57] [config]   - cross-entropy
[2023-07-22 16:58:57] [config]   - translation
[2023-07-22 16:58:57] [config] valid-mini-batch: 32
[2023-07-22 16:58:57] [config] valid-reset-stalled: false
[2023-07-22 16:58:57] [config] valid-script-args:
[2023-07-22 16:58:57] [config]   []
[2023-07-22 16:58:57] [config] valid-script-path: ""
[2023-07-22 16:58:57] [config] valid-sets:
[2023-07-22 16:58:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 16:58:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 16:58:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 16:58:57] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:58:57] [config] vocabs:
[2023-07-22 16:58:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 16:58:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 16:58:57] [config] word-penalty: 0
[2023-07-22 16:58:57] [config] word-scores: false
[2023-07-22 16:58:57] [config] workspace: 5500
[2023-07-22 16:58:57] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 16:58:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:58:57] [training] Using single-device training
[2023-07-22 16:58:57] Synced seed 1234
[2023-07-22 16:58:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 16:58:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 16:58:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 16:58:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 16:58:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 16:58:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 16:58:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 16:58:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 16:58:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 16:58:59] [comm] Using global sharding
[2023-07-22 16:58:59] [comm] NCCLCommunicators constructed successfully
[2023-07-22 16:58:59] [training] Using 1 GPUs
[2023-07-22 16:58:59] [logits] Applying loss function for 1 factor(s)
[2023-07-22 16:58:59] [memory] Reserving 80 MB, device gpu0
[2023-07-22 16:58:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 16:58:59] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:05:54] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 17:05:55] [valid] No post-processing script given for validating translator
[2023-07-22 17:05:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:05:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 17:05:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 17:05:55] [comm] Using global sharding
[2023-07-22 17:05:55] [comm] NCCLCommunicators constructed successfully
[2023-07-22 17:05:55] [training] Using 1 GPUs
[2023-07-22 17:05:55] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 17:05:56] Allocating memory for general optimizer shards
[2023-07-22 17:05:56] [memory] Reserving 322 MB, device gpu0
[2023-07-22 17:05:56] Loading Adam parameters
[2023-07-22 17:05:56] [memory] Reserving 322 MB, device gpu0
[2023-07-22 17:05:56] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:05:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 17:05:57] [data] Restoring the corpus state to epoch 101, batch 2899
[2023-07-22 17:05:57] [data] Shuffling data
[2023-07-22 17:05:57] [data] Done reading 20,192 sentences
[2023-07-22 17:05:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:05:57] Training started
[2023-07-22 17:05:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 17:05:58] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:06:06] Parameter type float16, optimization type float32, casting types true
[2023-07-22 17:09:32] Seen 20,192 samples
[2023-07-22 17:09:32] Starting data epoch 102 in logical epoch 102
[2023-07-22 17:09:32] [data] Shuffling data
[2023-07-22 17:09:32] [data] Done reading 20,192 sentences
[2023-07-22 17:09:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:13:18] Seen 20,192 samples
[2023-07-22 17:13:18] Starting data epoch 103 in logical epoch 103
[2023-07-22 17:13:18] [data] Shuffling data
[2023-07-22 17:13:18] [data] Done reading 20,192 sentences
[2023-07-22 17:13:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:17:04] Seen 20,192 samples
[2023-07-22 17:17:04] Starting data epoch 104 in logical epoch 104
[2023-07-22 17:17:04] [data] Shuffling data
[2023-07-22 17:17:04] [data] Done reading 20,192 sentences
[2023-07-22 17:17:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:18:56] Ep. 104 : Up. 3000 : Sen. 10,005 : Cost 4.85897350 * 17,703,214 @ 13,050 after 53,105,627 : Time 781.69s : 22647.44 words/s : gNorm 1.3455
[2023-07-22 17:20:49] Seen 20,192 samples
[2023-07-22 17:20:49] Starting data epoch 105 in logical epoch 105
[2023-07-22 17:20:49] [data] Shuffling data
[2023-07-22 17:20:49] [data] Done reading 20,192 sentences
[2023-07-22 17:20:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:24:21] Seen 20,192 samples
[2023-07-22 17:24:21] Starting data epoch 106 in logical epoch 106
[2023-07-22 17:24:21] [data] Shuffling data
[2023-07-22 17:24:21] [data] Done reading 20,192 sentences
[2023-07-22 17:24:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:27:59] Seen 20,192 samples
[2023-07-22 17:27:59] Starting data epoch 107 in logical epoch 107
[2023-07-22 17:27:59] [data] Shuffling data
[2023-07-22 17:27:59] [data] Done reading 20,192 sentences
[2023-07-22 17:27:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:31:46] Seen 20,192 samples
[2023-07-22 17:31:46] Starting data epoch 108 in logical epoch 108
[2023-07-22 17:31:46] [data] Shuffling data
[2023-07-22 17:31:46] [data] Done reading 20,192 sentences
[2023-07-22 17:31:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:35:33] Seen 20,192 samples
[2023-07-22 17:35:33] Starting data epoch 109 in logical epoch 109
[2023-07-22 17:35:33] [data] Shuffling data
[2023-07-22 17:35:33] [data] Done reading 20,192 sentences
[2023-07-22 17:35:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:39:15] Seen 20,192 samples
[2023-07-22 17:39:15] Starting data epoch 110 in logical epoch 110
[2023-07-22 17:39:15] [data] Shuffling data
[2023-07-22 17:39:15] [data] Done reading 20,192 sentences
[2023-07-22 17:39:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:42:57] Seen 20,192 samples
[2023-07-22 17:42:57] Starting data epoch 111 in logical epoch 111
[2023-07-22 17:42:57] Training finished
[2023-07-22 17:43:14] [valid] Ep. 111 : Up. 3189 : cross-entropy : 135.913 : new best
[2023-07-22 17:47:11] [valid] Ep. 111 : Up. 3189 : translation : 0 : new best
[2023-07-22 17:47:11] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 17:47:13] Saving Adam parameters
[2023-07-22 17:47:13] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 17:47:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 17:47:20] [marian] Running on node23.datos.cluster.uy as process 20396 with command line:
[2023-07-22 17:47:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 17:47:20] [config] after: 0e
[2023-07-22 17:47:20] [config] after-batches: 0
[2023-07-22 17:47:20] [config] after-epochs: 120
[2023-07-22 17:47:20] [config] all-caps-every: 0
[2023-07-22 17:47:20] [config] allow-unk: false
[2023-07-22 17:47:20] [config] authors: false
[2023-07-22 17:47:20] [config] beam-size: 12
[2023-07-22 17:47:20] [config] bert-class-symbol: "[CLS]"
[2023-07-22 17:47:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 17:47:20] [config] bert-masking-fraction: 0.15
[2023-07-22 17:47:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 17:47:20] [config] bert-train-type-embeddings: true
[2023-07-22 17:47:20] [config] bert-type-vocab-size: 2
[2023-07-22 17:47:20] [config] build-info: ""
[2023-07-22 17:47:20] [config] check-gradient-nan: false
[2023-07-22 17:47:20] [config] check-nan: false
[2023-07-22 17:47:20] [config] cite: false
[2023-07-22 17:47:20] [config] clip-norm: 1
[2023-07-22 17:47:20] [config] cost-scaling:
[2023-07-22 17:47:20] [config]   - 256.f
[2023-07-22 17:47:20] [config]   - 1000
[2023-07-22 17:47:20] [config]   - 2.f
[2023-07-22 17:47:20] [config]   - 256.f
[2023-07-22 17:47:20] [config] cost-type: ce-sum
[2023-07-22 17:47:20] [config] cpu-threads: 0
[2023-07-22 17:47:20] [config] data-threads: 8
[2023-07-22 17:47:20] [config] data-weighting: ""
[2023-07-22 17:47:20] [config] data-weighting-type: sentence
[2023-07-22 17:47:20] [config] dec-cell: gru
[2023-07-22 17:47:20] [config] dec-cell-base-depth: 2
[2023-07-22 17:47:20] [config] dec-cell-high-depth: 1
[2023-07-22 17:47:20] [config] dec-depth: 1
[2023-07-22 17:47:20] [config] devices:
[2023-07-22 17:47:20] [config]   - 0
[2023-07-22 17:47:20] [config] dim-emb: 512
[2023-07-22 17:47:20] [config] dim-rnn: 1024
[2023-07-22 17:47:20] [config] dim-vocabs:
[2023-07-22 17:47:20] [config]   - 16384
[2023-07-22 17:47:20] [config]   - 16384
[2023-07-22 17:47:20] [config] disp-first: 0
[2023-07-22 17:47:20] [config] disp-freq: 1000u
[2023-07-22 17:47:20] [config] disp-label-counts: true
[2023-07-22 17:47:20] [config] dropout-rnn: 0
[2023-07-22 17:47:20] [config] dropout-src: 0
[2023-07-22 17:47:20] [config] dropout-trg: 0
[2023-07-22 17:47:20] [config] dump-config: ""
[2023-07-22 17:47:20] [config] dynamic-gradient-scaling:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] early-stopping: 200
[2023-07-22 17:47:20] [config] early-stopping-on: first
[2023-07-22 17:47:20] [config] embedding-fix-src: false
[2023-07-22 17:47:20] [config] embedding-fix-trg: false
[2023-07-22 17:47:20] [config] embedding-normalization: false
[2023-07-22 17:47:20] [config] embedding-vectors:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] enc-cell: gru
[2023-07-22 17:47:20] [config] enc-cell-depth: 1
[2023-07-22 17:47:20] [config] enc-depth: 1
[2023-07-22 17:47:20] [config] enc-type: bidirectional
[2023-07-22 17:47:20] [config] english-title-case-every: 0
[2023-07-22 17:47:20] [config] exponential-smoothing: 0
[2023-07-22 17:47:20] [config] factor-weight: 1
[2023-07-22 17:47:20] [config] factors-combine: sum
[2023-07-22 17:47:20] [config] factors-dim-emb: 0
[2023-07-22 17:47:20] [config] gradient-checkpointing: false
[2023-07-22 17:47:20] [config] gradient-norm-average-window: 100
[2023-07-22 17:47:20] [config] guided-alignment: none
[2023-07-22 17:47:20] [config] guided-alignment-cost: mse
[2023-07-22 17:47:20] [config] guided-alignment-weight: 0.1
[2023-07-22 17:47:20] [config] ignore-model-config: false
[2023-07-22 17:47:20] [config] input-types:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] interpolate-env-vars: false
[2023-07-22 17:47:20] [config] keep-best: false
[2023-07-22 17:47:20] [config] label-smoothing: 0
[2023-07-22 17:47:20] [config] layer-normalization: false
[2023-07-22 17:47:20] [config] learn-rate: 0.0001
[2023-07-22 17:47:20] [config] lemma-dependency: ""
[2023-07-22 17:47:20] [config] lemma-dim-emb: 0
[2023-07-22 17:47:20] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 17:47:20] [config] log-level: info
[2023-07-22 17:47:20] [config] log-time-zone: ""
[2023-07-22 17:47:20] [config] logical-epoch:
[2023-07-22 17:47:20] [config]   - 1e
[2023-07-22 17:47:20] [config]   - 0
[2023-07-22 17:47:20] [config] lr-decay: 0
[2023-07-22 17:47:20] [config] lr-decay-freq: 50000
[2023-07-22 17:47:20] [config] lr-decay-inv-sqrt:
[2023-07-22 17:47:20] [config]   - 0
[2023-07-22 17:47:20] [config] lr-decay-repeat-warmup: false
[2023-07-22 17:47:20] [config] lr-decay-reset-optimizer: false
[2023-07-22 17:47:20] [config] lr-decay-start:
[2023-07-22 17:47:20] [config]   - 10
[2023-07-22 17:47:20] [config]   - 1
[2023-07-22 17:47:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 17:47:20] [config] lr-report: false
[2023-07-22 17:47:20] [config] lr-warmup: 0
[2023-07-22 17:47:20] [config] lr-warmup-at-reload: false
[2023-07-22 17:47:20] [config] lr-warmup-cycle: false
[2023-07-22 17:47:20] [config] lr-warmup-start-rate: 0
[2023-07-22 17:47:20] [config] max-length: 50
[2023-07-22 17:47:20] [config] max-length-crop: true
[2023-07-22 17:47:20] [config] max-length-factor: 3
[2023-07-22 17:47:20] [config] maxi-batch: 100
[2023-07-22 17:47:20] [config] maxi-batch-sort: trg
[2023-07-22 17:47:20] [config] mini-batch: 64
[2023-07-22 17:47:20] [config] mini-batch-fit: true
[2023-07-22 17:47:20] [config] mini-batch-fit-step: 10
[2023-07-22 17:47:20] [config] mini-batch-round-up: true
[2023-07-22 17:47:20] [config] mini-batch-track-lr: false
[2023-07-22 17:47:20] [config] mini-batch-warmup: 0
[2023-07-22 17:47:20] [config] mini-batch-words: 0
[2023-07-22 17:47:20] [config] mini-batch-words-ref: 0
[2023-07-22 17:47:20] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 17:47:20] [config] multi-loss-type: sum
[2023-07-22 17:47:20] [config] n-best: false
[2023-07-22 17:47:20] [config] no-nccl: false
[2023-07-22 17:47:20] [config] no-reload: false
[2023-07-22 17:47:20] [config] no-restore-corpus: false
[2023-07-22 17:47:20] [config] normalize: 0
[2023-07-22 17:47:20] [config] normalize-gradient: false
[2023-07-22 17:47:20] [config] num-devices: 0
[2023-07-22 17:47:20] [config] optimizer: adam
[2023-07-22 17:47:20] [config] optimizer-delay: 1
[2023-07-22 17:47:20] [config] optimizer-params:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] output-omit-bias: false
[2023-07-22 17:47:20] [config] overwrite: true
[2023-07-22 17:47:20] [config] precision:
[2023-07-22 17:47:20] [config]   - float16
[2023-07-22 17:47:20] [config]   - float32
[2023-07-22 17:47:20] [config] pretrained-model: ""
[2023-07-22 17:47:20] [config] quantize-biases: false
[2023-07-22 17:47:20] [config] quantize-bits: 0
[2023-07-22 17:47:20] [config] quantize-log-based: false
[2023-07-22 17:47:20] [config] quantize-optimization-steps: 0
[2023-07-22 17:47:20] [config] quiet: false
[2023-07-22 17:47:20] [config] quiet-translation: true
[2023-07-22 17:47:20] [config] relative-paths: false
[2023-07-22 17:47:20] [config] right-left: false
[2023-07-22 17:47:20] [config] save-freq: 10000u
[2023-07-22 17:47:20] [config] seed: 1234
[2023-07-22 17:47:20] [config] sentencepiece-alphas:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] sentencepiece-max-lines: 2000000
[2023-07-22 17:47:20] [config] sentencepiece-options: ""
[2023-07-22 17:47:20] [config] sharding: global
[2023-07-22 17:47:20] [config] shuffle: data
[2023-07-22 17:47:20] [config] shuffle-in-ram: false
[2023-07-22 17:47:20] [config] sigterm: save-and-exit
[2023-07-22 17:47:20] [config] skip: false
[2023-07-22 17:47:20] [config] sqlite: ""
[2023-07-22 17:47:20] [config] sqlite-drop: false
[2023-07-22 17:47:20] [config] sync-freq: 200u
[2023-07-22 17:47:20] [config] sync-sgd: false
[2023-07-22 17:47:20] [config] tempdir: /tmp
[2023-07-22 17:47:20] [config] tied-embeddings: false
[2023-07-22 17:47:20] [config] tied-embeddings-all: true
[2023-07-22 17:47:20] [config] tied-embeddings-src: false
[2023-07-22 17:47:20] [config] train-embedder-rank:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] train-sets:
[2023-07-22 17:47:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 17:47:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 17:47:20] [config] transformer-aan-activation: swish
[2023-07-22 17:47:20] [config] transformer-aan-depth: 2
[2023-07-22 17:47:20] [config] transformer-aan-nogate: false
[2023-07-22 17:47:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 17:47:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 17:47:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 17:47:20] [config] transformer-depth-scaling: false
[2023-07-22 17:47:20] [config] transformer-dim-aan: 2048
[2023-07-22 17:47:20] [config] transformer-dim-ffn: 2048
[2023-07-22 17:47:20] [config] transformer-dropout: 0
[2023-07-22 17:47:20] [config] transformer-dropout-attention: 0
[2023-07-22 17:47:20] [config] transformer-dropout-ffn: 0
[2023-07-22 17:47:20] [config] transformer-ffn-activation: swish
[2023-07-22 17:47:20] [config] transformer-ffn-depth: 2
[2023-07-22 17:47:20] [config] transformer-guided-alignment-layer: last
[2023-07-22 17:47:20] [config] transformer-heads: 8
[2023-07-22 17:47:20] [config] transformer-no-projection: false
[2023-07-22 17:47:20] [config] transformer-pool: false
[2023-07-22 17:47:20] [config] transformer-postprocess: dan
[2023-07-22 17:47:20] [config] transformer-postprocess-emb: d
[2023-07-22 17:47:20] [config] transformer-postprocess-top: ""
[2023-07-22 17:47:20] [config] transformer-preprocess: ""
[2023-07-22 17:47:20] [config] transformer-tied-layers:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] transformer-train-position-embeddings: false
[2023-07-22 17:47:20] [config] tsv: false
[2023-07-22 17:47:20] [config] tsv-fields: 0
[2023-07-22 17:47:20] [config] type: amun
[2023-07-22 17:47:20] [config] ulr: false
[2023-07-22 17:47:20] [config] ulr-dim-emb: 0
[2023-07-22 17:47:20] [config] ulr-dropout: 0
[2023-07-22 17:47:20] [config] ulr-keys-vectors: ""
[2023-07-22 17:47:20] [config] ulr-query-vectors: ""
[2023-07-22 17:47:20] [config] ulr-softmax-temperature: 1
[2023-07-22 17:47:20] [config] ulr-trainable-transformation: false
[2023-07-22 17:47:20] [config] unlikelihood-loss: false
[2023-07-22 17:47:20] [config] valid-freq: 50000000
[2023-07-22 17:47:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 17:47:20] [config] valid-max-length: 1000
[2023-07-22 17:47:20] [config] valid-metrics:
[2023-07-22 17:47:20] [config]   - cross-entropy
[2023-07-22 17:47:20] [config]   - translation
[2023-07-22 17:47:20] [config] valid-mini-batch: 32
[2023-07-22 17:47:20] [config] valid-reset-stalled: false
[2023-07-22 17:47:20] [config] valid-script-args:
[2023-07-22 17:47:20] [config]   []
[2023-07-22 17:47:20] [config] valid-script-path: ""
[2023-07-22 17:47:20] [config] valid-sets:
[2023-07-22 17:47:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 17:47:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 17:47:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 17:47:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 17:47:20] [config] vocabs:
[2023-07-22 17:47:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 17:47:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 17:47:20] [config] word-penalty: 0
[2023-07-22 17:47:20] [config] word-scores: false
[2023-07-22 17:47:20] [config] workspace: 5500
[2023-07-22 17:47:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 17:47:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:47:20] [training] Using single-device training
[2023-07-22 17:47:21] Synced seed 1234
[2023-07-22 17:47:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 17:47:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 17:47:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 17:47:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 17:47:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 17:47:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:47:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 17:47:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 17:47:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 17:47:23] [comm] Using global sharding
[2023-07-22 17:47:23] [comm] NCCLCommunicators constructed successfully
[2023-07-22 17:47:23] [training] Using 1 GPUs
[2023-07-22 17:47:23] [logits] Applying loss function for 1 factor(s)
[2023-07-22 17:47:23] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:47:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 17:47:23] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:54:03] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 17:54:04] [valid] No post-processing script given for validating translator
[2023-07-22 17:54:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 17:54:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 17:54:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 17:54:04] [comm] Using global sharding
[2023-07-22 17:54:04] [comm] NCCLCommunicators constructed successfully
[2023-07-22 17:54:04] [training] Using 1 GPUs
[2023-07-22 17:54:04] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 17:54:08] Allocating memory for general optimizer shards
[2023-07-22 17:54:08] [memory] Reserving 322 MB, device gpu0
[2023-07-22 17:54:08] Loading Adam parameters
[2023-07-22 17:54:08] [memory] Reserving 322 MB, device gpu0
[2023-07-22 17:54:08] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:54:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 17:54:08] [data] Restoring the corpus state to epoch 111, batch 3189
[2023-07-22 17:54:08] [data] Shuffling data
[2023-07-22 17:54:08] [data] Done reading 20,192 sentences
[2023-07-22 17:54:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 17:54:08] Training started
[2023-07-22 17:54:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 17:54:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 17:54:11] Parameter type float16, optimization type float32, casting types true
[2023-07-22 17:57:37] Seen 20,192 samples
[2023-07-22 17:57:37] Starting data epoch 112 in logical epoch 112
[2023-07-22 17:57:37] [data] Shuffling data
[2023-07-22 17:57:37] [data] Done reading 20,192 sentences
[2023-07-22 17:57:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:01:19] Seen 20,192 samples
[2023-07-22 18:01:19] Starting data epoch 113 in logical epoch 113
[2023-07-22 18:01:19] [data] Shuffling data
[2023-07-22 18:01:19] [data] Done reading 20,192 sentences
[2023-07-22 18:01:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:04:55] Seen 20,192 samples
[2023-07-22 18:04:55] Starting data epoch 114 in logical epoch 114
[2023-07-22 18:04:55] [data] Shuffling data
[2023-07-22 18:04:55] [data] Done reading 20,192 sentences
[2023-07-22 18:04:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:08:36] Seen 20,192 samples
[2023-07-22 18:08:36] Starting data epoch 115 in logical epoch 115
[2023-07-22 18:08:36] [data] Shuffling data
[2023-07-22 18:08:36] [data] Done reading 20,192 sentences
[2023-07-22 18:08:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:12:23] Seen 20,192 samples
[2023-07-22 18:12:23] Starting data epoch 116 in logical epoch 116
[2023-07-22 18:12:23] [data] Shuffling data
[2023-07-22 18:12:23] [data] Done reading 20,192 sentences
[2023-07-22 18:12:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:16:04] Seen 20,192 samples
[2023-07-22 18:16:04] Starting data epoch 117 in logical epoch 117
[2023-07-22 18:16:04] [data] Shuffling data
[2023-07-22 18:16:04] [data] Done reading 20,192 sentences
[2023-07-22 18:16:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:19:39] Seen 20,192 samples
[2023-07-22 18:19:39] Starting data epoch 118 in logical epoch 118
[2023-07-22 18:19:39] [data] Shuffling data
[2023-07-22 18:19:39] [data] Done reading 20,192 sentences
[2023-07-22 18:19:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:23:24] Seen 20,192 samples
[2023-07-22 18:23:24] Starting data epoch 119 in logical epoch 119
[2023-07-22 18:23:24] [data] Shuffling data
[2023-07-22 18:23:24] [data] Done reading 20,192 sentences
[2023-07-22 18:23:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:27:11] Seen 20,192 samples
[2023-07-22 18:27:11] Starting data epoch 120 in logical epoch 120
[2023-07-22 18:27:11] [data] Shuffling data
[2023-07-22 18:27:11] [data] Done reading 20,192 sentences
[2023-07-22 18:27:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:30:48] Seen 20,192 samples
[2023-07-22 18:30:48] Starting data epoch 121 in logical epoch 121
[2023-07-22 18:30:48] Training finished
[2023-07-22 18:31:02] [valid] Ep. 121 : Up. 3479 : cross-entropy : 135.254 : new best
[2023-07-22 18:34:08] [valid] Ep. 121 : Up. 3479 : translation : 0 : new best
[2023-07-22 18:34:08] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 18:34:10] Saving Adam parameters
[2023-07-22 18:34:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 18:34:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 18:34:16] [marian] Running on node23.datos.cluster.uy as process 23769 with command line:
[2023-07-22 18:34:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 18:34:16] [config] after: 0e
[2023-07-22 18:34:16] [config] after-batches: 0
[2023-07-22 18:34:16] [config] after-epochs: 130
[2023-07-22 18:34:16] [config] all-caps-every: 0
[2023-07-22 18:34:16] [config] allow-unk: false
[2023-07-22 18:34:16] [config] authors: false
[2023-07-22 18:34:16] [config] beam-size: 12
[2023-07-22 18:34:16] [config] bert-class-symbol: "[CLS]"
[2023-07-22 18:34:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 18:34:16] [config] bert-masking-fraction: 0.15
[2023-07-22 18:34:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 18:34:16] [config] bert-train-type-embeddings: true
[2023-07-22 18:34:16] [config] bert-type-vocab-size: 2
[2023-07-22 18:34:16] [config] build-info: ""
[2023-07-22 18:34:16] [config] check-gradient-nan: false
[2023-07-22 18:34:16] [config] check-nan: false
[2023-07-22 18:34:16] [config] cite: false
[2023-07-22 18:34:16] [config] clip-norm: 1
[2023-07-22 18:34:16] [config] cost-scaling:
[2023-07-22 18:34:16] [config]   - 256.f
[2023-07-22 18:34:16] [config]   - 1000
[2023-07-22 18:34:16] [config]   - 2.f
[2023-07-22 18:34:16] [config]   - 256.f
[2023-07-22 18:34:16] [config] cost-type: ce-sum
[2023-07-22 18:34:16] [config] cpu-threads: 0
[2023-07-22 18:34:16] [config] data-threads: 8
[2023-07-22 18:34:16] [config] data-weighting: ""
[2023-07-22 18:34:16] [config] data-weighting-type: sentence
[2023-07-22 18:34:16] [config] dec-cell: gru
[2023-07-22 18:34:16] [config] dec-cell-base-depth: 2
[2023-07-22 18:34:16] [config] dec-cell-high-depth: 1
[2023-07-22 18:34:16] [config] dec-depth: 1
[2023-07-22 18:34:16] [config] devices:
[2023-07-22 18:34:16] [config]   - 0
[2023-07-22 18:34:16] [config] dim-emb: 512
[2023-07-22 18:34:16] [config] dim-rnn: 1024
[2023-07-22 18:34:16] [config] dim-vocabs:
[2023-07-22 18:34:16] [config]   - 16384
[2023-07-22 18:34:16] [config]   - 16384
[2023-07-22 18:34:16] [config] disp-first: 0
[2023-07-22 18:34:16] [config] disp-freq: 1000u
[2023-07-22 18:34:16] [config] disp-label-counts: true
[2023-07-22 18:34:16] [config] dropout-rnn: 0
[2023-07-22 18:34:16] [config] dropout-src: 0
[2023-07-22 18:34:16] [config] dropout-trg: 0
[2023-07-22 18:34:16] [config] dump-config: ""
[2023-07-22 18:34:16] [config] dynamic-gradient-scaling:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] early-stopping: 200
[2023-07-22 18:34:16] [config] early-stopping-on: first
[2023-07-22 18:34:16] [config] embedding-fix-src: false
[2023-07-22 18:34:16] [config] embedding-fix-trg: false
[2023-07-22 18:34:16] [config] embedding-normalization: false
[2023-07-22 18:34:16] [config] embedding-vectors:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] enc-cell: gru
[2023-07-22 18:34:16] [config] enc-cell-depth: 1
[2023-07-22 18:34:16] [config] enc-depth: 1
[2023-07-22 18:34:16] [config] enc-type: bidirectional
[2023-07-22 18:34:16] [config] english-title-case-every: 0
[2023-07-22 18:34:16] [config] exponential-smoothing: 0
[2023-07-22 18:34:16] [config] factor-weight: 1
[2023-07-22 18:34:16] [config] factors-combine: sum
[2023-07-22 18:34:16] [config] factors-dim-emb: 0
[2023-07-22 18:34:16] [config] gradient-checkpointing: false
[2023-07-22 18:34:16] [config] gradient-norm-average-window: 100
[2023-07-22 18:34:16] [config] guided-alignment: none
[2023-07-22 18:34:16] [config] guided-alignment-cost: mse
[2023-07-22 18:34:16] [config] guided-alignment-weight: 0.1
[2023-07-22 18:34:16] [config] ignore-model-config: false
[2023-07-22 18:34:16] [config] input-types:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] interpolate-env-vars: false
[2023-07-22 18:34:16] [config] keep-best: false
[2023-07-22 18:34:16] [config] label-smoothing: 0
[2023-07-22 18:34:16] [config] layer-normalization: false
[2023-07-22 18:34:16] [config] learn-rate: 0.0001
[2023-07-22 18:34:16] [config] lemma-dependency: ""
[2023-07-22 18:34:16] [config] lemma-dim-emb: 0
[2023-07-22 18:34:16] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 18:34:16] [config] log-level: info
[2023-07-22 18:34:16] [config] log-time-zone: ""
[2023-07-22 18:34:16] [config] logical-epoch:
[2023-07-22 18:34:16] [config]   - 1e
[2023-07-22 18:34:16] [config]   - 0
[2023-07-22 18:34:16] [config] lr-decay: 0
[2023-07-22 18:34:16] [config] lr-decay-freq: 50000
[2023-07-22 18:34:16] [config] lr-decay-inv-sqrt:
[2023-07-22 18:34:16] [config]   - 0
[2023-07-22 18:34:16] [config] lr-decay-repeat-warmup: false
[2023-07-22 18:34:16] [config] lr-decay-reset-optimizer: false
[2023-07-22 18:34:16] [config] lr-decay-start:
[2023-07-22 18:34:16] [config]   - 10
[2023-07-22 18:34:16] [config]   - 1
[2023-07-22 18:34:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 18:34:16] [config] lr-report: false
[2023-07-22 18:34:16] [config] lr-warmup: 0
[2023-07-22 18:34:16] [config] lr-warmup-at-reload: false
[2023-07-22 18:34:16] [config] lr-warmup-cycle: false
[2023-07-22 18:34:16] [config] lr-warmup-start-rate: 0
[2023-07-22 18:34:16] [config] max-length: 50
[2023-07-22 18:34:16] [config] max-length-crop: true
[2023-07-22 18:34:16] [config] max-length-factor: 3
[2023-07-22 18:34:16] [config] maxi-batch: 100
[2023-07-22 18:34:16] [config] maxi-batch-sort: trg
[2023-07-22 18:34:16] [config] mini-batch: 64
[2023-07-22 18:34:16] [config] mini-batch-fit: true
[2023-07-22 18:34:16] [config] mini-batch-fit-step: 10
[2023-07-22 18:34:16] [config] mini-batch-round-up: true
[2023-07-22 18:34:16] [config] mini-batch-track-lr: false
[2023-07-22 18:34:16] [config] mini-batch-warmup: 0
[2023-07-22 18:34:16] [config] mini-batch-words: 0
[2023-07-22 18:34:16] [config] mini-batch-words-ref: 0
[2023-07-22 18:34:16] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 18:34:16] [config] multi-loss-type: sum
[2023-07-22 18:34:16] [config] n-best: false
[2023-07-22 18:34:16] [config] no-nccl: false
[2023-07-22 18:34:16] [config] no-reload: false
[2023-07-22 18:34:16] [config] no-restore-corpus: false
[2023-07-22 18:34:16] [config] normalize: 0
[2023-07-22 18:34:16] [config] normalize-gradient: false
[2023-07-22 18:34:16] [config] num-devices: 0
[2023-07-22 18:34:16] [config] optimizer: adam
[2023-07-22 18:34:16] [config] optimizer-delay: 1
[2023-07-22 18:34:16] [config] optimizer-params:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] output-omit-bias: false
[2023-07-22 18:34:16] [config] overwrite: true
[2023-07-22 18:34:16] [config] precision:
[2023-07-22 18:34:16] [config]   - float16
[2023-07-22 18:34:16] [config]   - float32
[2023-07-22 18:34:16] [config] pretrained-model: ""
[2023-07-22 18:34:16] [config] quantize-biases: false
[2023-07-22 18:34:16] [config] quantize-bits: 0
[2023-07-22 18:34:16] [config] quantize-log-based: false
[2023-07-22 18:34:16] [config] quantize-optimization-steps: 0
[2023-07-22 18:34:16] [config] quiet: false
[2023-07-22 18:34:16] [config] quiet-translation: true
[2023-07-22 18:34:16] [config] relative-paths: false
[2023-07-22 18:34:16] [config] right-left: false
[2023-07-22 18:34:16] [config] save-freq: 10000u
[2023-07-22 18:34:16] [config] seed: 1234
[2023-07-22 18:34:16] [config] sentencepiece-alphas:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] sentencepiece-max-lines: 2000000
[2023-07-22 18:34:16] [config] sentencepiece-options: ""
[2023-07-22 18:34:16] [config] sharding: global
[2023-07-22 18:34:16] [config] shuffle: data
[2023-07-22 18:34:16] [config] shuffle-in-ram: false
[2023-07-22 18:34:16] [config] sigterm: save-and-exit
[2023-07-22 18:34:16] [config] skip: false
[2023-07-22 18:34:16] [config] sqlite: ""
[2023-07-22 18:34:16] [config] sqlite-drop: false
[2023-07-22 18:34:16] [config] sync-freq: 200u
[2023-07-22 18:34:16] [config] sync-sgd: false
[2023-07-22 18:34:16] [config] tempdir: /tmp
[2023-07-22 18:34:16] [config] tied-embeddings: false
[2023-07-22 18:34:16] [config] tied-embeddings-all: true
[2023-07-22 18:34:16] [config] tied-embeddings-src: false
[2023-07-22 18:34:16] [config] train-embedder-rank:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] train-sets:
[2023-07-22 18:34:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 18:34:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 18:34:16] [config] transformer-aan-activation: swish
[2023-07-22 18:34:16] [config] transformer-aan-depth: 2
[2023-07-22 18:34:16] [config] transformer-aan-nogate: false
[2023-07-22 18:34:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 18:34:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 18:34:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 18:34:16] [config] transformer-depth-scaling: false
[2023-07-22 18:34:16] [config] transformer-dim-aan: 2048
[2023-07-22 18:34:16] [config] transformer-dim-ffn: 2048
[2023-07-22 18:34:16] [config] transformer-dropout: 0
[2023-07-22 18:34:16] [config] transformer-dropout-attention: 0
[2023-07-22 18:34:16] [config] transformer-dropout-ffn: 0
[2023-07-22 18:34:16] [config] transformer-ffn-activation: swish
[2023-07-22 18:34:16] [config] transformer-ffn-depth: 2
[2023-07-22 18:34:16] [config] transformer-guided-alignment-layer: last
[2023-07-22 18:34:16] [config] transformer-heads: 8
[2023-07-22 18:34:16] [config] transformer-no-projection: false
[2023-07-22 18:34:16] [config] transformer-pool: false
[2023-07-22 18:34:16] [config] transformer-postprocess: dan
[2023-07-22 18:34:16] [config] transformer-postprocess-emb: d
[2023-07-22 18:34:16] [config] transformer-postprocess-top: ""
[2023-07-22 18:34:16] [config] transformer-preprocess: ""
[2023-07-22 18:34:16] [config] transformer-tied-layers:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] transformer-train-position-embeddings: false
[2023-07-22 18:34:16] [config] tsv: false
[2023-07-22 18:34:16] [config] tsv-fields: 0
[2023-07-22 18:34:16] [config] type: amun
[2023-07-22 18:34:16] [config] ulr: false
[2023-07-22 18:34:16] [config] ulr-dim-emb: 0
[2023-07-22 18:34:16] [config] ulr-dropout: 0
[2023-07-22 18:34:16] [config] ulr-keys-vectors: ""
[2023-07-22 18:34:16] [config] ulr-query-vectors: ""
[2023-07-22 18:34:16] [config] ulr-softmax-temperature: 1
[2023-07-22 18:34:16] [config] ulr-trainable-transformation: false
[2023-07-22 18:34:16] [config] unlikelihood-loss: false
[2023-07-22 18:34:16] [config] valid-freq: 50000000
[2023-07-22 18:34:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 18:34:16] [config] valid-max-length: 1000
[2023-07-22 18:34:16] [config] valid-metrics:
[2023-07-22 18:34:16] [config]   - cross-entropy
[2023-07-22 18:34:16] [config]   - translation
[2023-07-22 18:34:16] [config] valid-mini-batch: 32
[2023-07-22 18:34:16] [config] valid-reset-stalled: false
[2023-07-22 18:34:16] [config] valid-script-args:
[2023-07-22 18:34:16] [config]   []
[2023-07-22 18:34:16] [config] valid-script-path: ""
[2023-07-22 18:34:16] [config] valid-sets:
[2023-07-22 18:34:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 18:34:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 18:34:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 18:34:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 18:34:16] [config] vocabs:
[2023-07-22 18:34:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 18:34:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 18:34:16] [config] word-penalty: 0
[2023-07-22 18:34:16] [config] word-scores: false
[2023-07-22 18:34:16] [config] workspace: 5500
[2023-07-22 18:34:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 18:34:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 18:34:16] [training] Using single-device training
[2023-07-22 18:34:17] Synced seed 1234
[2023-07-22 18:34:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 18:34:17] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 18:34:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 18:34:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 18:34:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 18:34:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 18:34:17] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 18:34:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 18:34:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 18:34:18] [comm] Using global sharding
[2023-07-22 18:34:18] [comm] NCCLCommunicators constructed successfully
[2023-07-22 18:34:18] [training] Using 1 GPUs
[2023-07-22 18:34:18] [logits] Applying loss function for 1 factor(s)
[2023-07-22 18:34:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 18:34:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 18:34:18] [memory] Reserving 80 MB, device gpu0
[2023-07-22 18:40:43] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 18:40:43] [valid] No post-processing script given for validating translator
[2023-07-22 18:40:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 18:40:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 18:40:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 18:40:43] [comm] Using global sharding
[2023-07-22 18:40:44] [comm] NCCLCommunicators constructed successfully
[2023-07-22 18:40:44] [training] Using 1 GPUs
[2023-07-22 18:40:44] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 18:40:45] Allocating memory for general optimizer shards
[2023-07-22 18:40:45] [memory] Reserving 322 MB, device gpu0
[2023-07-22 18:40:45] Loading Adam parameters
[2023-07-22 18:40:45] [memory] Reserving 322 MB, device gpu0
[2023-07-22 18:40:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 18:40:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 18:40:46] [data] Restoring the corpus state to epoch 121, batch 3479
[2023-07-22 18:40:46] [data] Shuffling data
[2023-07-22 18:40:46] [data] Done reading 20,192 sentences
[2023-07-22 18:40:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:40:46] Training started
[2023-07-22 18:40:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 18:40:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 18:40:47] Parameter type float16, optimization type float32, casting types true
[2023-07-22 18:44:14] Seen 20,192 samples
[2023-07-22 18:44:14] Starting data epoch 122 in logical epoch 122
[2023-07-22 18:44:14] [data] Shuffling data
[2023-07-22 18:44:14] [data] Done reading 20,192 sentences
[2023-07-22 18:44:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:47:28] Seen 20,192 samples
[2023-07-22 18:47:28] Starting data epoch 123 in logical epoch 123
[2023-07-22 18:47:28] [data] Shuffling data
[2023-07-22 18:47:28] [data] Done reading 20,192 sentences
[2023-07-22 18:47:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:50:52] Seen 20,192 samples
[2023-07-22 18:50:52] Starting data epoch 124 in logical epoch 124
[2023-07-22 18:50:52] [data] Shuffling data
[2023-07-22 18:50:52] [data] Done reading 20,192 sentences
[2023-07-22 18:50:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:54:25] Seen 20,192 samples
[2023-07-22 18:54:25] Starting data epoch 125 in logical epoch 125
[2023-07-22 18:54:25] [data] Shuffling data
[2023-07-22 18:54:25] [data] Done reading 20,192 sentences
[2023-07-22 18:54:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 18:58:09] Seen 20,192 samples
[2023-07-22 18:58:09] Starting data epoch 126 in logical epoch 126
[2023-07-22 18:58:09] [data] Shuffling data
[2023-07-22 18:58:09] [data] Done reading 20,192 sentences
[2023-07-22 18:58:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:01:44] Seen 20,192 samples
[2023-07-22 19:01:44] Starting data epoch 127 in logical epoch 127
[2023-07-22 19:01:44] [data] Shuffling data
[2023-07-22 19:01:44] [data] Done reading 20,192 sentences
[2023-07-22 19:01:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:05:20] Seen 20,192 samples
[2023-07-22 19:05:20] Starting data epoch 128 in logical epoch 128
[2023-07-22 19:05:20] [data] Shuffling data
[2023-07-22 19:05:20] [data] Done reading 20,192 sentences
[2023-07-22 19:05:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:08:59] Seen 20,192 samples
[2023-07-22 19:08:59] Starting data epoch 129 in logical epoch 129
[2023-07-22 19:08:59] [data] Shuffling data
[2023-07-22 19:08:59] [data] Done reading 20,192 sentences
[2023-07-22 19:08:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:12:41] Seen 20,192 samples
[2023-07-22 19:12:41] Starting data epoch 130 in logical epoch 130
[2023-07-22 19:12:41] [data] Shuffling data
[2023-07-22 19:12:41] [data] Done reading 20,192 sentences
[2023-07-22 19:12:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:16:25] Seen 20,192 samples
[2023-07-22 19:16:25] Starting data epoch 131 in logical epoch 131
[2023-07-22 19:16:25] Training finished
[2023-07-22 19:16:40] [valid] Ep. 131 : Up. 3769 : cross-entropy : 134.202 : new best
[2023-07-22 19:19:30] [valid] Ep. 131 : Up. 3769 : translation : 0 : new best
[2023-07-22 19:19:30] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 19:19:32] Saving Adam parameters
[2023-07-22 19:19:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 19:19:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 19:19:40] [marian] Running on node23.datos.cluster.uy as process 26539 with command line:
[2023-07-22 19:19:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 19:19:40] [config] after: 0e
[2023-07-22 19:19:40] [config] after-batches: 0
[2023-07-22 19:19:40] [config] after-epochs: 140
[2023-07-22 19:19:40] [config] all-caps-every: 0
[2023-07-22 19:19:40] [config] allow-unk: false
[2023-07-22 19:19:40] [config] authors: false
[2023-07-22 19:19:40] [config] beam-size: 12
[2023-07-22 19:19:40] [config] bert-class-symbol: "[CLS]"
[2023-07-22 19:19:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 19:19:40] [config] bert-masking-fraction: 0.15
[2023-07-22 19:19:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 19:19:40] [config] bert-train-type-embeddings: true
[2023-07-22 19:19:40] [config] bert-type-vocab-size: 2
[2023-07-22 19:19:40] [config] build-info: ""
[2023-07-22 19:19:40] [config] check-gradient-nan: false
[2023-07-22 19:19:40] [config] check-nan: false
[2023-07-22 19:19:40] [config] cite: false
[2023-07-22 19:19:40] [config] clip-norm: 1
[2023-07-22 19:19:40] [config] cost-scaling:
[2023-07-22 19:19:40] [config]   - 256.f
[2023-07-22 19:19:40] [config]   - 1000
[2023-07-22 19:19:40] [config]   - 2.f
[2023-07-22 19:19:40] [config]   - 256.f
[2023-07-22 19:19:40] [config] cost-type: ce-sum
[2023-07-22 19:19:40] [config] cpu-threads: 0
[2023-07-22 19:19:40] [config] data-threads: 8
[2023-07-22 19:19:40] [config] data-weighting: ""
[2023-07-22 19:19:40] [config] data-weighting-type: sentence
[2023-07-22 19:19:40] [config] dec-cell: gru
[2023-07-22 19:19:40] [config] dec-cell-base-depth: 2
[2023-07-22 19:19:40] [config] dec-cell-high-depth: 1
[2023-07-22 19:19:40] [config] dec-depth: 1
[2023-07-22 19:19:40] [config] devices:
[2023-07-22 19:19:40] [config]   - 0
[2023-07-22 19:19:40] [config] dim-emb: 512
[2023-07-22 19:19:40] [config] dim-rnn: 1024
[2023-07-22 19:19:40] [config] dim-vocabs:
[2023-07-22 19:19:40] [config]   - 16384
[2023-07-22 19:19:40] [config]   - 16384
[2023-07-22 19:19:40] [config] disp-first: 0
[2023-07-22 19:19:40] [config] disp-freq: 1000u
[2023-07-22 19:19:40] [config] disp-label-counts: true
[2023-07-22 19:19:40] [config] dropout-rnn: 0
[2023-07-22 19:19:40] [config] dropout-src: 0
[2023-07-22 19:19:40] [config] dropout-trg: 0
[2023-07-22 19:19:40] [config] dump-config: ""
[2023-07-22 19:19:40] [config] dynamic-gradient-scaling:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] early-stopping: 200
[2023-07-22 19:19:40] [config] early-stopping-on: first
[2023-07-22 19:19:40] [config] embedding-fix-src: false
[2023-07-22 19:19:40] [config] embedding-fix-trg: false
[2023-07-22 19:19:40] [config] embedding-normalization: false
[2023-07-22 19:19:40] [config] embedding-vectors:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] enc-cell: gru
[2023-07-22 19:19:40] [config] enc-cell-depth: 1
[2023-07-22 19:19:40] [config] enc-depth: 1
[2023-07-22 19:19:40] [config] enc-type: bidirectional
[2023-07-22 19:19:40] [config] english-title-case-every: 0
[2023-07-22 19:19:40] [config] exponential-smoothing: 0
[2023-07-22 19:19:40] [config] factor-weight: 1
[2023-07-22 19:19:40] [config] factors-combine: sum
[2023-07-22 19:19:40] [config] factors-dim-emb: 0
[2023-07-22 19:19:40] [config] gradient-checkpointing: false
[2023-07-22 19:19:40] [config] gradient-norm-average-window: 100
[2023-07-22 19:19:40] [config] guided-alignment: none
[2023-07-22 19:19:40] [config] guided-alignment-cost: mse
[2023-07-22 19:19:40] [config] guided-alignment-weight: 0.1
[2023-07-22 19:19:40] [config] ignore-model-config: false
[2023-07-22 19:19:40] [config] input-types:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] interpolate-env-vars: false
[2023-07-22 19:19:40] [config] keep-best: false
[2023-07-22 19:19:40] [config] label-smoothing: 0
[2023-07-22 19:19:40] [config] layer-normalization: false
[2023-07-22 19:19:40] [config] learn-rate: 0.0001
[2023-07-22 19:19:40] [config] lemma-dependency: ""
[2023-07-22 19:19:40] [config] lemma-dim-emb: 0
[2023-07-22 19:19:40] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 19:19:40] [config] log-level: info
[2023-07-22 19:19:40] [config] log-time-zone: ""
[2023-07-22 19:19:40] [config] logical-epoch:
[2023-07-22 19:19:40] [config]   - 1e
[2023-07-22 19:19:40] [config]   - 0
[2023-07-22 19:19:40] [config] lr-decay: 0
[2023-07-22 19:19:40] [config] lr-decay-freq: 50000
[2023-07-22 19:19:40] [config] lr-decay-inv-sqrt:
[2023-07-22 19:19:40] [config]   - 0
[2023-07-22 19:19:40] [config] lr-decay-repeat-warmup: false
[2023-07-22 19:19:40] [config] lr-decay-reset-optimizer: false
[2023-07-22 19:19:40] [config] lr-decay-start:
[2023-07-22 19:19:40] [config]   - 10
[2023-07-22 19:19:40] [config]   - 1
[2023-07-22 19:19:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 19:19:40] [config] lr-report: false
[2023-07-22 19:19:40] [config] lr-warmup: 0
[2023-07-22 19:19:40] [config] lr-warmup-at-reload: false
[2023-07-22 19:19:40] [config] lr-warmup-cycle: false
[2023-07-22 19:19:40] [config] lr-warmup-start-rate: 0
[2023-07-22 19:19:40] [config] max-length: 50
[2023-07-22 19:19:40] [config] max-length-crop: true
[2023-07-22 19:19:40] [config] max-length-factor: 3
[2023-07-22 19:19:40] [config] maxi-batch: 100
[2023-07-22 19:19:40] [config] maxi-batch-sort: trg
[2023-07-22 19:19:40] [config] mini-batch: 64
[2023-07-22 19:19:40] [config] mini-batch-fit: true
[2023-07-22 19:19:40] [config] mini-batch-fit-step: 10
[2023-07-22 19:19:40] [config] mini-batch-round-up: true
[2023-07-22 19:19:40] [config] mini-batch-track-lr: false
[2023-07-22 19:19:40] [config] mini-batch-warmup: 0
[2023-07-22 19:19:40] [config] mini-batch-words: 0
[2023-07-22 19:19:40] [config] mini-batch-words-ref: 0
[2023-07-22 19:19:40] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 19:19:40] [config] multi-loss-type: sum
[2023-07-22 19:19:40] [config] n-best: false
[2023-07-22 19:19:40] [config] no-nccl: false
[2023-07-22 19:19:40] [config] no-reload: false
[2023-07-22 19:19:40] [config] no-restore-corpus: false
[2023-07-22 19:19:40] [config] normalize: 0
[2023-07-22 19:19:40] [config] normalize-gradient: false
[2023-07-22 19:19:40] [config] num-devices: 0
[2023-07-22 19:19:40] [config] optimizer: adam
[2023-07-22 19:19:40] [config] optimizer-delay: 1
[2023-07-22 19:19:40] [config] optimizer-params:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] output-omit-bias: false
[2023-07-22 19:19:40] [config] overwrite: true
[2023-07-22 19:19:40] [config] precision:
[2023-07-22 19:19:40] [config]   - float16
[2023-07-22 19:19:40] [config]   - float32
[2023-07-22 19:19:40] [config] pretrained-model: ""
[2023-07-22 19:19:40] [config] quantize-biases: false
[2023-07-22 19:19:40] [config] quantize-bits: 0
[2023-07-22 19:19:40] [config] quantize-log-based: false
[2023-07-22 19:19:40] [config] quantize-optimization-steps: 0
[2023-07-22 19:19:40] [config] quiet: false
[2023-07-22 19:19:40] [config] quiet-translation: true
[2023-07-22 19:19:40] [config] relative-paths: false
[2023-07-22 19:19:40] [config] right-left: false
[2023-07-22 19:19:40] [config] save-freq: 10000u
[2023-07-22 19:19:40] [config] seed: 1234
[2023-07-22 19:19:40] [config] sentencepiece-alphas:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] sentencepiece-max-lines: 2000000
[2023-07-22 19:19:40] [config] sentencepiece-options: ""
[2023-07-22 19:19:40] [config] sharding: global
[2023-07-22 19:19:40] [config] shuffle: data
[2023-07-22 19:19:40] [config] shuffle-in-ram: false
[2023-07-22 19:19:40] [config] sigterm: save-and-exit
[2023-07-22 19:19:40] [config] skip: false
[2023-07-22 19:19:40] [config] sqlite: ""
[2023-07-22 19:19:40] [config] sqlite-drop: false
[2023-07-22 19:19:40] [config] sync-freq: 200u
[2023-07-22 19:19:40] [config] sync-sgd: false
[2023-07-22 19:19:40] [config] tempdir: /tmp
[2023-07-22 19:19:40] [config] tied-embeddings: false
[2023-07-22 19:19:40] [config] tied-embeddings-all: true
[2023-07-22 19:19:40] [config] tied-embeddings-src: false
[2023-07-22 19:19:40] [config] train-embedder-rank:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] train-sets:
[2023-07-22 19:19:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 19:19:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 19:19:40] [config] transformer-aan-activation: swish
[2023-07-22 19:19:40] [config] transformer-aan-depth: 2
[2023-07-22 19:19:40] [config] transformer-aan-nogate: false
[2023-07-22 19:19:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 19:19:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 19:19:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 19:19:40] [config] transformer-depth-scaling: false
[2023-07-22 19:19:40] [config] transformer-dim-aan: 2048
[2023-07-22 19:19:40] [config] transformer-dim-ffn: 2048
[2023-07-22 19:19:40] [config] transformer-dropout: 0
[2023-07-22 19:19:40] [config] transformer-dropout-attention: 0
[2023-07-22 19:19:40] [config] transformer-dropout-ffn: 0
[2023-07-22 19:19:40] [config] transformer-ffn-activation: swish
[2023-07-22 19:19:40] [config] transformer-ffn-depth: 2
[2023-07-22 19:19:40] [config] transformer-guided-alignment-layer: last
[2023-07-22 19:19:40] [config] transformer-heads: 8
[2023-07-22 19:19:40] [config] transformer-no-projection: false
[2023-07-22 19:19:40] [config] transformer-pool: false
[2023-07-22 19:19:40] [config] transformer-postprocess: dan
[2023-07-22 19:19:40] [config] transformer-postprocess-emb: d
[2023-07-22 19:19:40] [config] transformer-postprocess-top: ""
[2023-07-22 19:19:40] [config] transformer-preprocess: ""
[2023-07-22 19:19:40] [config] transformer-tied-layers:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] transformer-train-position-embeddings: false
[2023-07-22 19:19:40] [config] tsv: false
[2023-07-22 19:19:40] [config] tsv-fields: 0
[2023-07-22 19:19:40] [config] type: amun
[2023-07-22 19:19:40] [config] ulr: false
[2023-07-22 19:19:40] [config] ulr-dim-emb: 0
[2023-07-22 19:19:40] [config] ulr-dropout: 0
[2023-07-22 19:19:40] [config] ulr-keys-vectors: ""
[2023-07-22 19:19:40] [config] ulr-query-vectors: ""
[2023-07-22 19:19:40] [config] ulr-softmax-temperature: 1
[2023-07-22 19:19:40] [config] ulr-trainable-transformation: false
[2023-07-22 19:19:40] [config] unlikelihood-loss: false
[2023-07-22 19:19:40] [config] valid-freq: 50000000
[2023-07-22 19:19:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 19:19:40] [config] valid-max-length: 1000
[2023-07-22 19:19:40] [config] valid-metrics:
[2023-07-22 19:19:40] [config]   - cross-entropy
[2023-07-22 19:19:40] [config]   - translation
[2023-07-22 19:19:40] [config] valid-mini-batch: 32
[2023-07-22 19:19:40] [config] valid-reset-stalled: false
[2023-07-22 19:19:40] [config] valid-script-args:
[2023-07-22 19:19:40] [config]   []
[2023-07-22 19:19:40] [config] valid-script-path: ""
[2023-07-22 19:19:40] [config] valid-sets:
[2023-07-22 19:19:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 19:19:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 19:19:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 19:19:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 19:19:40] [config] vocabs:
[2023-07-22 19:19:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 19:19:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 19:19:40] [config] word-penalty: 0
[2023-07-22 19:19:40] [config] word-scores: false
[2023-07-22 19:19:40] [config] workspace: 5500
[2023-07-22 19:19:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 19:19:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 19:19:40] [training] Using single-device training
[2023-07-22 19:19:40] Synced seed 1234
[2023-07-22 19:19:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 19:19:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 19:19:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 19:19:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 19:19:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 19:19:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 19:19:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 19:19:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 19:19:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 19:19:41] [comm] Using global sharding
[2023-07-22 19:19:42] [comm] NCCLCommunicators constructed successfully
[2023-07-22 19:19:42] [training] Using 1 GPUs
[2023-07-22 19:19:42] [logits] Applying loss function for 1 factor(s)
[2023-07-22 19:19:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:19:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 19:19:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:26:41] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 19:26:41] [valid] No post-processing script given for validating translator
[2023-07-22 19:26:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 19:26:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 19:26:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 19:26:41] [comm] Using global sharding
[2023-07-22 19:26:41] [comm] NCCLCommunicators constructed successfully
[2023-07-22 19:26:41] [training] Using 1 GPUs
[2023-07-22 19:26:41] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 19:26:47] Allocating memory for general optimizer shards
[2023-07-22 19:26:47] [memory] Reserving 322 MB, device gpu0
[2023-07-22 19:26:48] Loading Adam parameters
[2023-07-22 19:26:48] [memory] Reserving 322 MB, device gpu0
[2023-07-22 19:26:48] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:26:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 19:26:48] [data] Restoring the corpus state to epoch 131, batch 3769
[2023-07-22 19:26:48] [data] Shuffling data
[2023-07-22 19:26:48] [data] Done reading 20,192 sentences
[2023-07-22 19:26:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:26:48] Training started
[2023-07-22 19:26:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 19:26:49] [memory] Reserving 80 MB, device gpu0
[2023-07-22 19:26:56] Parameter type float16, optimization type float32, casting types true
[2023-07-22 19:29:46] Seen 20,192 samples
[2023-07-22 19:29:46] Starting data epoch 132 in logical epoch 132
[2023-07-22 19:29:46] [data] Shuffling data
[2023-07-22 19:29:46] [data] Done reading 20,192 sentences
[2023-07-22 19:29:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:33:13] Seen 20,192 samples
[2023-07-22 19:33:13] Starting data epoch 133 in logical epoch 133
[2023-07-22 19:33:13] [data] Shuffling data
[2023-07-22 19:33:13] [data] Done reading 20,192 sentences
[2023-07-22 19:33:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:36:48] Seen 20,192 samples
[2023-07-22 19:36:48] Starting data epoch 134 in logical epoch 134
[2023-07-22 19:36:48] [data] Shuffling data
[2023-07-22 19:36:48] [data] Done reading 20,192 sentences
[2023-07-22 19:36:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:40:23] Seen 20,192 samples
[2023-07-22 19:40:23] Starting data epoch 135 in logical epoch 135
[2023-07-22 19:40:23] [data] Shuffling data
[2023-07-22 19:40:23] [data] Done reading 20,192 sentences
[2023-07-22 19:40:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:43:55] Seen 20,192 samples
[2023-07-22 19:43:55] Starting data epoch 136 in logical epoch 136
[2023-07-22 19:43:55] [data] Shuffling data
[2023-07-22 19:43:55] [data] Done reading 20,192 sentences
[2023-07-22 19:43:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:47:37] Seen 20,192 samples
[2023-07-22 19:47:37] Starting data epoch 137 in logical epoch 137
[2023-07-22 19:47:37] [data] Shuffling data
[2023-07-22 19:47:37] [data] Done reading 20,192 sentences
[2023-07-22 19:47:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:51:17] Seen 20,192 samples
[2023-07-22 19:51:17] Starting data epoch 138 in logical epoch 138
[2023-07-22 19:51:17] [data] Shuffling data
[2023-07-22 19:51:17] [data] Done reading 20,192 sentences
[2023-07-22 19:51:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:54:42] Ep. 138 : Up. 4000 : Sen. 19,471 : Cost 4.38896751 * 17,680,236 @ 2,209 after 70,785,868 : Time 1681.03s : 10517.49 words/s : gNorm 1.2846
[2023-07-22 19:54:55] Seen 20,192 samples
[2023-07-22 19:54:55] Starting data epoch 139 in logical epoch 139
[2023-07-22 19:54:55] [data] Shuffling data
[2023-07-22 19:54:55] [data] Done reading 20,192 sentences
[2023-07-22 19:54:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 19:58:38] Seen 20,192 samples
[2023-07-22 19:58:38] Starting data epoch 140 in logical epoch 140
[2023-07-22 19:58:38] [data] Shuffling data
[2023-07-22 19:58:38] [data] Done reading 20,192 sentences
[2023-07-22 19:58:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:02:18] Seen 20,192 samples
[2023-07-22 20:02:18] Starting data epoch 141 in logical epoch 141
[2023-07-22 20:02:18] Training finished
[2023-07-22 20:02:32] [valid] Ep. 141 : Up. 4059 : cross-entropy : 133.765 : new best
[2023-07-22 20:04:17] [valid] Ep. 141 : Up. 4059 : translation : 0 : new best
[2023-07-22 20:04:17] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 20:04:20] Saving Adam parameters
[2023-07-22 20:04:20] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 20:04:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 20:04:26] [marian] Running on node23.datos.cluster.uy as process 29605 with command line:
[2023-07-22 20:04:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 20:04:27] [config] after: 0e
[2023-07-22 20:04:27] [config] after-batches: 0
[2023-07-22 20:04:27] [config] after-epochs: 150
[2023-07-22 20:04:27] [config] all-caps-every: 0
[2023-07-22 20:04:27] [config] allow-unk: false
[2023-07-22 20:04:27] [config] authors: false
[2023-07-22 20:04:27] [config] beam-size: 12
[2023-07-22 20:04:27] [config] bert-class-symbol: "[CLS]"
[2023-07-22 20:04:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 20:04:27] [config] bert-masking-fraction: 0.15
[2023-07-22 20:04:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 20:04:27] [config] bert-train-type-embeddings: true
[2023-07-22 20:04:27] [config] bert-type-vocab-size: 2
[2023-07-22 20:04:27] [config] build-info: ""
[2023-07-22 20:04:27] [config] check-gradient-nan: false
[2023-07-22 20:04:27] [config] check-nan: false
[2023-07-22 20:04:27] [config] cite: false
[2023-07-22 20:04:27] [config] clip-norm: 1
[2023-07-22 20:04:27] [config] cost-scaling:
[2023-07-22 20:04:27] [config]   - 256.f
[2023-07-22 20:04:27] [config]   - 1000
[2023-07-22 20:04:27] [config]   - 2.f
[2023-07-22 20:04:27] [config]   - 256.f
[2023-07-22 20:04:27] [config] cost-type: ce-sum
[2023-07-22 20:04:27] [config] cpu-threads: 0
[2023-07-22 20:04:27] [config] data-threads: 8
[2023-07-22 20:04:27] [config] data-weighting: ""
[2023-07-22 20:04:27] [config] data-weighting-type: sentence
[2023-07-22 20:04:27] [config] dec-cell: gru
[2023-07-22 20:04:27] [config] dec-cell-base-depth: 2
[2023-07-22 20:04:27] [config] dec-cell-high-depth: 1
[2023-07-22 20:04:27] [config] dec-depth: 1
[2023-07-22 20:04:27] [config] devices:
[2023-07-22 20:04:27] [config]   - 0
[2023-07-22 20:04:27] [config] dim-emb: 512
[2023-07-22 20:04:27] [config] dim-rnn: 1024
[2023-07-22 20:04:27] [config] dim-vocabs:
[2023-07-22 20:04:27] [config]   - 16384
[2023-07-22 20:04:27] [config]   - 16384
[2023-07-22 20:04:27] [config] disp-first: 0
[2023-07-22 20:04:27] [config] disp-freq: 1000u
[2023-07-22 20:04:27] [config] disp-label-counts: true
[2023-07-22 20:04:27] [config] dropout-rnn: 0
[2023-07-22 20:04:27] [config] dropout-src: 0
[2023-07-22 20:04:27] [config] dropout-trg: 0
[2023-07-22 20:04:27] [config] dump-config: ""
[2023-07-22 20:04:27] [config] dynamic-gradient-scaling:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] early-stopping: 200
[2023-07-22 20:04:27] [config] early-stopping-on: first
[2023-07-22 20:04:27] [config] embedding-fix-src: false
[2023-07-22 20:04:27] [config] embedding-fix-trg: false
[2023-07-22 20:04:27] [config] embedding-normalization: false
[2023-07-22 20:04:27] [config] embedding-vectors:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] enc-cell: gru
[2023-07-22 20:04:27] [config] enc-cell-depth: 1
[2023-07-22 20:04:27] [config] enc-depth: 1
[2023-07-22 20:04:27] [config] enc-type: bidirectional
[2023-07-22 20:04:27] [config] english-title-case-every: 0
[2023-07-22 20:04:27] [config] exponential-smoothing: 0
[2023-07-22 20:04:27] [config] factor-weight: 1
[2023-07-22 20:04:27] [config] factors-combine: sum
[2023-07-22 20:04:27] [config] factors-dim-emb: 0
[2023-07-22 20:04:27] [config] gradient-checkpointing: false
[2023-07-22 20:04:27] [config] gradient-norm-average-window: 100
[2023-07-22 20:04:27] [config] guided-alignment: none
[2023-07-22 20:04:27] [config] guided-alignment-cost: mse
[2023-07-22 20:04:27] [config] guided-alignment-weight: 0.1
[2023-07-22 20:04:27] [config] ignore-model-config: false
[2023-07-22 20:04:27] [config] input-types:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] interpolate-env-vars: false
[2023-07-22 20:04:27] [config] keep-best: false
[2023-07-22 20:04:27] [config] label-smoothing: 0
[2023-07-22 20:04:27] [config] layer-normalization: false
[2023-07-22 20:04:27] [config] learn-rate: 0.0001
[2023-07-22 20:04:27] [config] lemma-dependency: ""
[2023-07-22 20:04:27] [config] lemma-dim-emb: 0
[2023-07-22 20:04:27] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 20:04:27] [config] log-level: info
[2023-07-22 20:04:27] [config] log-time-zone: ""
[2023-07-22 20:04:27] [config] logical-epoch:
[2023-07-22 20:04:27] [config]   - 1e
[2023-07-22 20:04:27] [config]   - 0
[2023-07-22 20:04:27] [config] lr-decay: 0
[2023-07-22 20:04:27] [config] lr-decay-freq: 50000
[2023-07-22 20:04:27] [config] lr-decay-inv-sqrt:
[2023-07-22 20:04:27] [config]   - 0
[2023-07-22 20:04:27] [config] lr-decay-repeat-warmup: false
[2023-07-22 20:04:27] [config] lr-decay-reset-optimizer: false
[2023-07-22 20:04:27] [config] lr-decay-start:
[2023-07-22 20:04:27] [config]   - 10
[2023-07-22 20:04:27] [config]   - 1
[2023-07-22 20:04:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 20:04:27] [config] lr-report: false
[2023-07-22 20:04:27] [config] lr-warmup: 0
[2023-07-22 20:04:27] [config] lr-warmup-at-reload: false
[2023-07-22 20:04:27] [config] lr-warmup-cycle: false
[2023-07-22 20:04:27] [config] lr-warmup-start-rate: 0
[2023-07-22 20:04:27] [config] max-length: 50
[2023-07-22 20:04:27] [config] max-length-crop: true
[2023-07-22 20:04:27] [config] max-length-factor: 3
[2023-07-22 20:04:27] [config] maxi-batch: 100
[2023-07-22 20:04:27] [config] maxi-batch-sort: trg
[2023-07-22 20:04:27] [config] mini-batch: 64
[2023-07-22 20:04:27] [config] mini-batch-fit: true
[2023-07-22 20:04:27] [config] mini-batch-fit-step: 10
[2023-07-22 20:04:27] [config] mini-batch-round-up: true
[2023-07-22 20:04:27] [config] mini-batch-track-lr: false
[2023-07-22 20:04:27] [config] mini-batch-warmup: 0
[2023-07-22 20:04:27] [config] mini-batch-words: 0
[2023-07-22 20:04:27] [config] mini-batch-words-ref: 0
[2023-07-22 20:04:27] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 20:04:27] [config] multi-loss-type: sum
[2023-07-22 20:04:27] [config] n-best: false
[2023-07-22 20:04:27] [config] no-nccl: false
[2023-07-22 20:04:27] [config] no-reload: false
[2023-07-22 20:04:27] [config] no-restore-corpus: false
[2023-07-22 20:04:27] [config] normalize: 0
[2023-07-22 20:04:27] [config] normalize-gradient: false
[2023-07-22 20:04:27] [config] num-devices: 0
[2023-07-22 20:04:27] [config] optimizer: adam
[2023-07-22 20:04:27] [config] optimizer-delay: 1
[2023-07-22 20:04:27] [config] optimizer-params:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] output-omit-bias: false
[2023-07-22 20:04:27] [config] overwrite: true
[2023-07-22 20:04:27] [config] precision:
[2023-07-22 20:04:27] [config]   - float16
[2023-07-22 20:04:27] [config]   - float32
[2023-07-22 20:04:27] [config] pretrained-model: ""
[2023-07-22 20:04:27] [config] quantize-biases: false
[2023-07-22 20:04:27] [config] quantize-bits: 0
[2023-07-22 20:04:27] [config] quantize-log-based: false
[2023-07-22 20:04:27] [config] quantize-optimization-steps: 0
[2023-07-22 20:04:27] [config] quiet: false
[2023-07-22 20:04:27] [config] quiet-translation: true
[2023-07-22 20:04:27] [config] relative-paths: false
[2023-07-22 20:04:27] [config] right-left: false
[2023-07-22 20:04:27] [config] save-freq: 10000u
[2023-07-22 20:04:27] [config] seed: 1234
[2023-07-22 20:04:27] [config] sentencepiece-alphas:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] sentencepiece-max-lines: 2000000
[2023-07-22 20:04:27] [config] sentencepiece-options: ""
[2023-07-22 20:04:27] [config] sharding: global
[2023-07-22 20:04:27] [config] shuffle: data
[2023-07-22 20:04:27] [config] shuffle-in-ram: false
[2023-07-22 20:04:27] [config] sigterm: save-and-exit
[2023-07-22 20:04:27] [config] skip: false
[2023-07-22 20:04:27] [config] sqlite: ""
[2023-07-22 20:04:27] [config] sqlite-drop: false
[2023-07-22 20:04:27] [config] sync-freq: 200u
[2023-07-22 20:04:27] [config] sync-sgd: false
[2023-07-22 20:04:27] [config] tempdir: /tmp
[2023-07-22 20:04:27] [config] tied-embeddings: false
[2023-07-22 20:04:27] [config] tied-embeddings-all: true
[2023-07-22 20:04:27] [config] tied-embeddings-src: false
[2023-07-22 20:04:27] [config] train-embedder-rank:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] train-sets:
[2023-07-22 20:04:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 20:04:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 20:04:27] [config] transformer-aan-activation: swish
[2023-07-22 20:04:27] [config] transformer-aan-depth: 2
[2023-07-22 20:04:27] [config] transformer-aan-nogate: false
[2023-07-22 20:04:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 20:04:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 20:04:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 20:04:27] [config] transformer-depth-scaling: false
[2023-07-22 20:04:27] [config] transformer-dim-aan: 2048
[2023-07-22 20:04:27] [config] transformer-dim-ffn: 2048
[2023-07-22 20:04:27] [config] transformer-dropout: 0
[2023-07-22 20:04:27] [config] transformer-dropout-attention: 0
[2023-07-22 20:04:27] [config] transformer-dropout-ffn: 0
[2023-07-22 20:04:27] [config] transformer-ffn-activation: swish
[2023-07-22 20:04:27] [config] transformer-ffn-depth: 2
[2023-07-22 20:04:27] [config] transformer-guided-alignment-layer: last
[2023-07-22 20:04:27] [config] transformer-heads: 8
[2023-07-22 20:04:27] [config] transformer-no-projection: false
[2023-07-22 20:04:27] [config] transformer-pool: false
[2023-07-22 20:04:27] [config] transformer-postprocess: dan
[2023-07-22 20:04:27] [config] transformer-postprocess-emb: d
[2023-07-22 20:04:27] [config] transformer-postprocess-top: ""
[2023-07-22 20:04:27] [config] transformer-preprocess: ""
[2023-07-22 20:04:27] [config] transformer-tied-layers:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] transformer-train-position-embeddings: false
[2023-07-22 20:04:27] [config] tsv: false
[2023-07-22 20:04:27] [config] tsv-fields: 0
[2023-07-22 20:04:27] [config] type: amun
[2023-07-22 20:04:27] [config] ulr: false
[2023-07-22 20:04:27] [config] ulr-dim-emb: 0
[2023-07-22 20:04:27] [config] ulr-dropout: 0
[2023-07-22 20:04:27] [config] ulr-keys-vectors: ""
[2023-07-22 20:04:27] [config] ulr-query-vectors: ""
[2023-07-22 20:04:27] [config] ulr-softmax-temperature: 1
[2023-07-22 20:04:27] [config] ulr-trainable-transformation: false
[2023-07-22 20:04:27] [config] unlikelihood-loss: false
[2023-07-22 20:04:27] [config] valid-freq: 50000000
[2023-07-22 20:04:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 20:04:27] [config] valid-max-length: 1000
[2023-07-22 20:04:27] [config] valid-metrics:
[2023-07-22 20:04:27] [config]   - cross-entropy
[2023-07-22 20:04:27] [config]   - translation
[2023-07-22 20:04:27] [config] valid-mini-batch: 32
[2023-07-22 20:04:27] [config] valid-reset-stalled: false
[2023-07-22 20:04:27] [config] valid-script-args:
[2023-07-22 20:04:27] [config]   []
[2023-07-22 20:04:27] [config] valid-script-path: ""
[2023-07-22 20:04:27] [config] valid-sets:
[2023-07-22 20:04:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 20:04:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 20:04:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 20:04:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 20:04:27] [config] vocabs:
[2023-07-22 20:04:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 20:04:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 20:04:27] [config] word-penalty: 0
[2023-07-22 20:04:27] [config] word-scores: false
[2023-07-22 20:04:27] [config] workspace: 5500
[2023-07-22 20:04:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 20:04:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:04:27] [training] Using single-device training
[2023-07-22 20:04:27] Synced seed 1234
[2023-07-22 20:04:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 20:04:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 20:04:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 20:04:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 20:04:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 20:04:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:04:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 20:04:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 20:04:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 20:04:28] [comm] Using global sharding
[2023-07-22 20:04:28] [comm] NCCLCommunicators constructed successfully
[2023-07-22 20:04:28] [training] Using 1 GPUs
[2023-07-22 20:04:28] [logits] Applying loss function for 1 factor(s)
[2023-07-22 20:04:28] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:04:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 20:04:29] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:10:44] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 20:10:45] [valid] No post-processing script given for validating translator
[2023-07-22 20:10:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:10:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 20:10:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 20:10:45] [comm] Using global sharding
[2023-07-22 20:10:45] [comm] NCCLCommunicators constructed successfully
[2023-07-22 20:10:45] [training] Using 1 GPUs
[2023-07-22 20:10:45] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 20:10:46] Allocating memory for general optimizer shards
[2023-07-22 20:10:46] [memory] Reserving 322 MB, device gpu0
[2023-07-22 20:10:46] Loading Adam parameters
[2023-07-22 20:10:46] [memory] Reserving 322 MB, device gpu0
[2023-07-22 20:10:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:10:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 20:10:47] [data] Restoring the corpus state to epoch 141, batch 4059
[2023-07-22 20:10:47] [data] Shuffling data
[2023-07-22 20:10:47] [data] Done reading 20,192 sentences
[2023-07-22 20:10:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:10:47] Training started
[2023-07-22 20:10:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 20:10:47] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:10:51] Parameter type float16, optimization type float32, casting types true
[2023-07-22 20:14:13] Seen 20,192 samples
[2023-07-22 20:14:13] Starting data epoch 142 in logical epoch 142
[2023-07-22 20:14:13] [data] Shuffling data
[2023-07-22 20:14:13] [data] Done reading 20,192 sentences
[2023-07-22 20:14:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:17:46] Seen 20,192 samples
[2023-07-22 20:17:46] Starting data epoch 143 in logical epoch 143
[2023-07-22 20:17:46] [data] Shuffling data
[2023-07-22 20:17:46] [data] Done reading 20,192 sentences
[2023-07-22 20:17:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:21:15] Seen 20,192 samples
[2023-07-22 20:21:15] Starting data epoch 144 in logical epoch 144
[2023-07-22 20:21:15] [data] Shuffling data
[2023-07-22 20:21:15] [data] Done reading 20,192 sentences
[2023-07-22 20:21:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:24:54] Seen 20,192 samples
[2023-07-22 20:24:54] Starting data epoch 145 in logical epoch 145
[2023-07-22 20:24:54] [data] Shuffling data
[2023-07-22 20:24:54] [data] Done reading 20,192 sentences
[2023-07-22 20:24:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:28:32] Seen 20,192 samples
[2023-07-22 20:28:32] Starting data epoch 146 in logical epoch 146
[2023-07-22 20:28:32] [data] Shuffling data
[2023-07-22 20:28:33] [data] Done reading 20,192 sentences
[2023-07-22 20:28:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:31:59] Seen 20,192 samples
[2023-07-22 20:31:59] Starting data epoch 147 in logical epoch 147
[2023-07-22 20:31:59] [data] Shuffling data
[2023-07-22 20:31:59] [data] Done reading 20,192 sentences
[2023-07-22 20:31:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:35:30] Seen 20,192 samples
[2023-07-22 20:35:30] Starting data epoch 148 in logical epoch 148
[2023-07-22 20:35:30] [data] Shuffling data
[2023-07-22 20:35:30] [data] Done reading 20,192 sentences
[2023-07-22 20:35:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:39:07] Seen 20,192 samples
[2023-07-22 20:39:07] Starting data epoch 149 in logical epoch 149
[2023-07-22 20:39:07] [data] Shuffling data
[2023-07-22 20:39:07] [data] Done reading 20,192 sentences
[2023-07-22 20:39:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:42:43] Seen 20,192 samples
[2023-07-22 20:42:43] Starting data epoch 150 in logical epoch 150
[2023-07-22 20:42:43] [data] Shuffling data
[2023-07-22 20:42:43] [data] Done reading 20,192 sentences
[2023-07-22 20:42:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:46:16] Seen 20,192 samples
[2023-07-22 20:46:16] Starting data epoch 151 in logical epoch 151
[2023-07-22 20:46:16] Training finished
[2023-07-22 20:46:31] [valid] Ep. 151 : Up. 4349 : cross-entropy : 132.754 : new best
[2023-07-22 20:49:19] [valid] Ep. 151 : Up. 4349 : translation : 0 : new best
[2023-07-22 20:49:19] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 20:49:21] Saving Adam parameters
[2023-07-22 20:49:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 20:49:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 20:49:30] [marian] Running on node23.datos.cluster.uy as process 32368 with command line:
[2023-07-22 20:49:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 20:49:30] [config] after: 0e
[2023-07-22 20:49:30] [config] after-batches: 0
[2023-07-22 20:49:30] [config] after-epochs: 160
[2023-07-22 20:49:30] [config] all-caps-every: 0
[2023-07-22 20:49:30] [config] allow-unk: false
[2023-07-22 20:49:30] [config] authors: false
[2023-07-22 20:49:30] [config] beam-size: 12
[2023-07-22 20:49:30] [config] bert-class-symbol: "[CLS]"
[2023-07-22 20:49:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 20:49:30] [config] bert-masking-fraction: 0.15
[2023-07-22 20:49:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 20:49:30] [config] bert-train-type-embeddings: true
[2023-07-22 20:49:30] [config] bert-type-vocab-size: 2
[2023-07-22 20:49:30] [config] build-info: ""
[2023-07-22 20:49:30] [config] check-gradient-nan: false
[2023-07-22 20:49:30] [config] check-nan: false
[2023-07-22 20:49:30] [config] cite: false
[2023-07-22 20:49:30] [config] clip-norm: 1
[2023-07-22 20:49:30] [config] cost-scaling:
[2023-07-22 20:49:30] [config]   - 256.f
[2023-07-22 20:49:30] [config]   - 1000
[2023-07-22 20:49:30] [config]   - 2.f
[2023-07-22 20:49:30] [config]   - 256.f
[2023-07-22 20:49:30] [config] cost-type: ce-sum
[2023-07-22 20:49:30] [config] cpu-threads: 0
[2023-07-22 20:49:30] [config] data-threads: 8
[2023-07-22 20:49:30] [config] data-weighting: ""
[2023-07-22 20:49:30] [config] data-weighting-type: sentence
[2023-07-22 20:49:30] [config] dec-cell: gru
[2023-07-22 20:49:30] [config] dec-cell-base-depth: 2
[2023-07-22 20:49:30] [config] dec-cell-high-depth: 1
[2023-07-22 20:49:30] [config] dec-depth: 1
[2023-07-22 20:49:30] [config] devices:
[2023-07-22 20:49:30] [config]   - 0
[2023-07-22 20:49:30] [config] dim-emb: 512
[2023-07-22 20:49:30] [config] dim-rnn: 1024
[2023-07-22 20:49:30] [config] dim-vocabs:
[2023-07-22 20:49:30] [config]   - 16384
[2023-07-22 20:49:30] [config]   - 16384
[2023-07-22 20:49:30] [config] disp-first: 0
[2023-07-22 20:49:30] [config] disp-freq: 1000u
[2023-07-22 20:49:30] [config] disp-label-counts: true
[2023-07-22 20:49:30] [config] dropout-rnn: 0
[2023-07-22 20:49:30] [config] dropout-src: 0
[2023-07-22 20:49:30] [config] dropout-trg: 0
[2023-07-22 20:49:30] [config] dump-config: ""
[2023-07-22 20:49:30] [config] dynamic-gradient-scaling:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] early-stopping: 200
[2023-07-22 20:49:30] [config] early-stopping-on: first
[2023-07-22 20:49:30] [config] embedding-fix-src: false
[2023-07-22 20:49:30] [config] embedding-fix-trg: false
[2023-07-22 20:49:30] [config] embedding-normalization: false
[2023-07-22 20:49:30] [config] embedding-vectors:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] enc-cell: gru
[2023-07-22 20:49:30] [config] enc-cell-depth: 1
[2023-07-22 20:49:30] [config] enc-depth: 1
[2023-07-22 20:49:30] [config] enc-type: bidirectional
[2023-07-22 20:49:30] [config] english-title-case-every: 0
[2023-07-22 20:49:30] [config] exponential-smoothing: 0
[2023-07-22 20:49:30] [config] factor-weight: 1
[2023-07-22 20:49:30] [config] factors-combine: sum
[2023-07-22 20:49:30] [config] factors-dim-emb: 0
[2023-07-22 20:49:30] [config] gradient-checkpointing: false
[2023-07-22 20:49:30] [config] gradient-norm-average-window: 100
[2023-07-22 20:49:30] [config] guided-alignment: none
[2023-07-22 20:49:30] [config] guided-alignment-cost: mse
[2023-07-22 20:49:30] [config] guided-alignment-weight: 0.1
[2023-07-22 20:49:30] [config] ignore-model-config: false
[2023-07-22 20:49:30] [config] input-types:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] interpolate-env-vars: false
[2023-07-22 20:49:30] [config] keep-best: false
[2023-07-22 20:49:30] [config] label-smoothing: 0
[2023-07-22 20:49:30] [config] layer-normalization: false
[2023-07-22 20:49:30] [config] learn-rate: 0.0001
[2023-07-22 20:49:30] [config] lemma-dependency: ""
[2023-07-22 20:49:30] [config] lemma-dim-emb: 0
[2023-07-22 20:49:30] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 20:49:30] [config] log-level: info
[2023-07-22 20:49:30] [config] log-time-zone: ""
[2023-07-22 20:49:30] [config] logical-epoch:
[2023-07-22 20:49:30] [config]   - 1e
[2023-07-22 20:49:30] [config]   - 0
[2023-07-22 20:49:30] [config] lr-decay: 0
[2023-07-22 20:49:30] [config] lr-decay-freq: 50000
[2023-07-22 20:49:30] [config] lr-decay-inv-sqrt:
[2023-07-22 20:49:30] [config]   - 0
[2023-07-22 20:49:30] [config] lr-decay-repeat-warmup: false
[2023-07-22 20:49:30] [config] lr-decay-reset-optimizer: false
[2023-07-22 20:49:30] [config] lr-decay-start:
[2023-07-22 20:49:30] [config]   - 10
[2023-07-22 20:49:30] [config]   - 1
[2023-07-22 20:49:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 20:49:30] [config] lr-report: false
[2023-07-22 20:49:30] [config] lr-warmup: 0
[2023-07-22 20:49:30] [config] lr-warmup-at-reload: false
[2023-07-22 20:49:30] [config] lr-warmup-cycle: false
[2023-07-22 20:49:30] [config] lr-warmup-start-rate: 0
[2023-07-22 20:49:30] [config] max-length: 50
[2023-07-22 20:49:30] [config] max-length-crop: true
[2023-07-22 20:49:30] [config] max-length-factor: 3
[2023-07-22 20:49:30] [config] maxi-batch: 100
[2023-07-22 20:49:30] [config] maxi-batch-sort: trg
[2023-07-22 20:49:30] [config] mini-batch: 64
[2023-07-22 20:49:30] [config] mini-batch-fit: true
[2023-07-22 20:49:30] [config] mini-batch-fit-step: 10
[2023-07-22 20:49:30] [config] mini-batch-round-up: true
[2023-07-22 20:49:30] [config] mini-batch-track-lr: false
[2023-07-22 20:49:30] [config] mini-batch-warmup: 0
[2023-07-22 20:49:30] [config] mini-batch-words: 0
[2023-07-22 20:49:30] [config] mini-batch-words-ref: 0
[2023-07-22 20:49:30] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 20:49:30] [config] multi-loss-type: sum
[2023-07-22 20:49:30] [config] n-best: false
[2023-07-22 20:49:30] [config] no-nccl: false
[2023-07-22 20:49:30] [config] no-reload: false
[2023-07-22 20:49:30] [config] no-restore-corpus: false
[2023-07-22 20:49:30] [config] normalize: 0
[2023-07-22 20:49:30] [config] normalize-gradient: false
[2023-07-22 20:49:30] [config] num-devices: 0
[2023-07-22 20:49:30] [config] optimizer: adam
[2023-07-22 20:49:30] [config] optimizer-delay: 1
[2023-07-22 20:49:30] [config] optimizer-params:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] output-omit-bias: false
[2023-07-22 20:49:30] [config] overwrite: true
[2023-07-22 20:49:30] [config] precision:
[2023-07-22 20:49:30] [config]   - float16
[2023-07-22 20:49:30] [config]   - float32
[2023-07-22 20:49:30] [config] pretrained-model: ""
[2023-07-22 20:49:30] [config] quantize-biases: false
[2023-07-22 20:49:30] [config] quantize-bits: 0
[2023-07-22 20:49:30] [config] quantize-log-based: false
[2023-07-22 20:49:30] [config] quantize-optimization-steps: 0
[2023-07-22 20:49:30] [config] quiet: false
[2023-07-22 20:49:30] [config] quiet-translation: true
[2023-07-22 20:49:30] [config] relative-paths: false
[2023-07-22 20:49:30] [config] right-left: false
[2023-07-22 20:49:30] [config] save-freq: 10000u
[2023-07-22 20:49:30] [config] seed: 1234
[2023-07-22 20:49:30] [config] sentencepiece-alphas:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] sentencepiece-max-lines: 2000000
[2023-07-22 20:49:30] [config] sentencepiece-options: ""
[2023-07-22 20:49:30] [config] sharding: global
[2023-07-22 20:49:30] [config] shuffle: data
[2023-07-22 20:49:30] [config] shuffle-in-ram: false
[2023-07-22 20:49:30] [config] sigterm: save-and-exit
[2023-07-22 20:49:30] [config] skip: false
[2023-07-22 20:49:30] [config] sqlite: ""
[2023-07-22 20:49:30] [config] sqlite-drop: false
[2023-07-22 20:49:30] [config] sync-freq: 200u
[2023-07-22 20:49:30] [config] sync-sgd: false
[2023-07-22 20:49:30] [config] tempdir: /tmp
[2023-07-22 20:49:30] [config] tied-embeddings: false
[2023-07-22 20:49:30] [config] tied-embeddings-all: true
[2023-07-22 20:49:30] [config] tied-embeddings-src: false
[2023-07-22 20:49:30] [config] train-embedder-rank:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] train-sets:
[2023-07-22 20:49:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 20:49:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 20:49:30] [config] transformer-aan-activation: swish
[2023-07-22 20:49:30] [config] transformer-aan-depth: 2
[2023-07-22 20:49:30] [config] transformer-aan-nogate: false
[2023-07-22 20:49:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 20:49:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 20:49:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 20:49:30] [config] transformer-depth-scaling: false
[2023-07-22 20:49:30] [config] transformer-dim-aan: 2048
[2023-07-22 20:49:30] [config] transformer-dim-ffn: 2048
[2023-07-22 20:49:30] [config] transformer-dropout: 0
[2023-07-22 20:49:30] [config] transformer-dropout-attention: 0
[2023-07-22 20:49:30] [config] transformer-dropout-ffn: 0
[2023-07-22 20:49:30] [config] transformer-ffn-activation: swish
[2023-07-22 20:49:30] [config] transformer-ffn-depth: 2
[2023-07-22 20:49:30] [config] transformer-guided-alignment-layer: last
[2023-07-22 20:49:30] [config] transformer-heads: 8
[2023-07-22 20:49:30] [config] transformer-no-projection: false
[2023-07-22 20:49:30] [config] transformer-pool: false
[2023-07-22 20:49:30] [config] transformer-postprocess: dan
[2023-07-22 20:49:30] [config] transformer-postprocess-emb: d
[2023-07-22 20:49:30] [config] transformer-postprocess-top: ""
[2023-07-22 20:49:30] [config] transformer-preprocess: ""
[2023-07-22 20:49:30] [config] transformer-tied-layers:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] transformer-train-position-embeddings: false
[2023-07-22 20:49:30] [config] tsv: false
[2023-07-22 20:49:30] [config] tsv-fields: 0
[2023-07-22 20:49:30] [config] type: amun
[2023-07-22 20:49:30] [config] ulr: false
[2023-07-22 20:49:30] [config] ulr-dim-emb: 0
[2023-07-22 20:49:30] [config] ulr-dropout: 0
[2023-07-22 20:49:30] [config] ulr-keys-vectors: ""
[2023-07-22 20:49:30] [config] ulr-query-vectors: ""
[2023-07-22 20:49:30] [config] ulr-softmax-temperature: 1
[2023-07-22 20:49:30] [config] ulr-trainable-transformation: false
[2023-07-22 20:49:30] [config] unlikelihood-loss: false
[2023-07-22 20:49:30] [config] valid-freq: 50000000
[2023-07-22 20:49:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 20:49:30] [config] valid-max-length: 1000
[2023-07-22 20:49:30] [config] valid-metrics:
[2023-07-22 20:49:30] [config]   - cross-entropy
[2023-07-22 20:49:30] [config]   - translation
[2023-07-22 20:49:30] [config] valid-mini-batch: 32
[2023-07-22 20:49:30] [config] valid-reset-stalled: false
[2023-07-22 20:49:30] [config] valid-script-args:
[2023-07-22 20:49:30] [config]   []
[2023-07-22 20:49:30] [config] valid-script-path: ""
[2023-07-22 20:49:30] [config] valid-sets:
[2023-07-22 20:49:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 20:49:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 20:49:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 20:49:30] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 20:49:30] [config] vocabs:
[2023-07-22 20:49:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 20:49:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 20:49:30] [config] word-penalty: 0
[2023-07-22 20:49:30] [config] word-scores: false
[2023-07-22 20:49:30] [config] workspace: 5500
[2023-07-22 20:49:30] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 20:49:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:49:30] [training] Using single-device training
[2023-07-22 20:49:31] Synced seed 1234
[2023-07-22 20:49:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 20:49:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 20:49:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 20:49:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 20:49:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 20:49:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:49:31] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 20:49:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 20:49:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 20:49:33] [comm] Using global sharding
[2023-07-22 20:49:33] [comm] NCCLCommunicators constructed successfully
[2023-07-22 20:49:33] [training] Using 1 GPUs
[2023-07-22 20:49:33] [logits] Applying loss function for 1 factor(s)
[2023-07-22 20:49:33] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:49:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 20:49:33] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:56:16] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 20:56:17] [valid] No post-processing script given for validating translator
[2023-07-22 20:56:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 20:56:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 20:56:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 20:56:17] [comm] Using global sharding
[2023-07-22 20:56:17] [comm] NCCLCommunicators constructed successfully
[2023-07-22 20:56:17] [training] Using 1 GPUs
[2023-07-22 20:56:17] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 20:56:26] Allocating memory for general optimizer shards
[2023-07-22 20:56:26] [memory] Reserving 322 MB, device gpu0
[2023-07-22 20:56:26] Loading Adam parameters
[2023-07-22 20:56:26] [memory] Reserving 322 MB, device gpu0
[2023-07-22 20:56:26] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:56:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 20:56:27] [data] Restoring the corpus state to epoch 151, batch 4349
[2023-07-22 20:56:27] [data] Shuffling data
[2023-07-22 20:56:27] [data] Done reading 20,192 sentences
[2023-07-22 20:56:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 20:56:27] Training started
[2023-07-22 20:56:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 20:56:27] [memory] Reserving 80 MB, device gpu0
[2023-07-22 20:56:38] Parameter type float16, optimization type float32, casting types true
[2023-07-22 20:59:44] Seen 20,192 samples
[2023-07-22 20:59:44] Starting data epoch 152 in logical epoch 152
[2023-07-22 20:59:44] [data] Shuffling data
[2023-07-22 20:59:44] [data] Done reading 20,192 sentences
[2023-07-22 20:59:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:03:16] Seen 20,192 samples
[2023-07-22 21:03:16] Starting data epoch 153 in logical epoch 153
[2023-07-22 21:03:16] [data] Shuffling data
[2023-07-22 21:03:16] [data] Done reading 20,192 sentences
[2023-07-22 21:03:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:06:47] Seen 20,192 samples
[2023-07-22 21:06:47] Starting data epoch 154 in logical epoch 154
[2023-07-22 21:06:47] [data] Shuffling data
[2023-07-22 21:06:47] [data] Done reading 20,192 sentences
[2023-07-22 21:06:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:10:19] Seen 20,192 samples
[2023-07-22 21:10:19] Starting data epoch 155 in logical epoch 155
[2023-07-22 21:10:19] [data] Shuffling data
[2023-07-22 21:10:19] [data] Done reading 20,192 sentences
[2023-07-22 21:10:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:13:58] Seen 20,192 samples
[2023-07-22 21:13:58] Starting data epoch 156 in logical epoch 156
[2023-07-22 21:13:58] [data] Shuffling data
[2023-07-22 21:13:58] [data] Done reading 20,192 sentences
[2023-07-22 21:13:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:17:37] Seen 20,192 samples
[2023-07-22 21:17:37] Starting data epoch 157 in logical epoch 157
[2023-07-22 21:17:37] [data] Shuffling data
[2023-07-22 21:17:37] [data] Done reading 20,192 sentences
[2023-07-22 21:17:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:21:15] Seen 20,192 samples
[2023-07-22 21:21:15] Starting data epoch 158 in logical epoch 158
[2023-07-22 21:21:15] [data] Shuffling data
[2023-07-22 21:21:15] [data] Done reading 20,192 sentences
[2023-07-22 21:21:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:24:52] Seen 20,192 samples
[2023-07-22 21:24:52] Starting data epoch 159 in logical epoch 159
[2023-07-22 21:24:52] [data] Shuffling data
[2023-07-22 21:24:52] [data] Done reading 20,192 sentences
[2023-07-22 21:24:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:28:30] Seen 20,192 samples
[2023-07-22 21:28:30] Starting data epoch 160 in logical epoch 160
[2023-07-22 21:28:30] [data] Shuffling data
[2023-07-22 21:28:30] [data] Done reading 20,192 sentences
[2023-07-22 21:28:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:31:59] Seen 20,192 samples
[2023-07-22 21:31:59] Starting data epoch 161 in logical epoch 161
[2023-07-22 21:31:59] Training finished
[2023-07-22 21:32:14] [valid] Ep. 161 : Up. 4639 : cross-entropy : 132.367 : new best
[2023-07-22 21:35:00] [valid] Ep. 161 : Up. 4639 : translation : 0 : new best
[2023-07-22 21:35:00] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 21:35:02] Saving Adam parameters
[2023-07-22 21:35:02] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 21:35:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 21:35:10] [marian] Running on node23.datos.cluster.uy as process 35489 with command line:
[2023-07-22 21:35:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 21:35:10] [config] after: 0e
[2023-07-22 21:35:10] [config] after-batches: 0
[2023-07-22 21:35:10] [config] after-epochs: 170
[2023-07-22 21:35:10] [config] all-caps-every: 0
[2023-07-22 21:35:10] [config] allow-unk: false
[2023-07-22 21:35:10] [config] authors: false
[2023-07-22 21:35:10] [config] beam-size: 12
[2023-07-22 21:35:10] [config] bert-class-symbol: "[CLS]"
[2023-07-22 21:35:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 21:35:10] [config] bert-masking-fraction: 0.15
[2023-07-22 21:35:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 21:35:10] [config] bert-train-type-embeddings: true
[2023-07-22 21:35:10] [config] bert-type-vocab-size: 2
[2023-07-22 21:35:10] [config] build-info: ""
[2023-07-22 21:35:10] [config] check-gradient-nan: false
[2023-07-22 21:35:10] [config] check-nan: false
[2023-07-22 21:35:10] [config] cite: false
[2023-07-22 21:35:10] [config] clip-norm: 1
[2023-07-22 21:35:10] [config] cost-scaling:
[2023-07-22 21:35:10] [config]   - 256.f
[2023-07-22 21:35:10] [config]   - 1000
[2023-07-22 21:35:10] [config]   - 2.f
[2023-07-22 21:35:10] [config]   - 256.f
[2023-07-22 21:35:10] [config] cost-type: ce-sum
[2023-07-22 21:35:10] [config] cpu-threads: 0
[2023-07-22 21:35:10] [config] data-threads: 8
[2023-07-22 21:35:10] [config] data-weighting: ""
[2023-07-22 21:35:10] [config] data-weighting-type: sentence
[2023-07-22 21:35:10] [config] dec-cell: gru
[2023-07-22 21:35:10] [config] dec-cell-base-depth: 2
[2023-07-22 21:35:10] [config] dec-cell-high-depth: 1
[2023-07-22 21:35:10] [config] dec-depth: 1
[2023-07-22 21:35:10] [config] devices:
[2023-07-22 21:35:10] [config]   - 0
[2023-07-22 21:35:10] [config] dim-emb: 512
[2023-07-22 21:35:10] [config] dim-rnn: 1024
[2023-07-22 21:35:10] [config] dim-vocabs:
[2023-07-22 21:35:10] [config]   - 16384
[2023-07-22 21:35:10] [config]   - 16384
[2023-07-22 21:35:10] [config] disp-first: 0
[2023-07-22 21:35:10] [config] disp-freq: 1000u
[2023-07-22 21:35:10] [config] disp-label-counts: true
[2023-07-22 21:35:10] [config] dropout-rnn: 0
[2023-07-22 21:35:10] [config] dropout-src: 0
[2023-07-22 21:35:10] [config] dropout-trg: 0
[2023-07-22 21:35:10] [config] dump-config: ""
[2023-07-22 21:35:10] [config] dynamic-gradient-scaling:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] early-stopping: 200
[2023-07-22 21:35:10] [config] early-stopping-on: first
[2023-07-22 21:35:10] [config] embedding-fix-src: false
[2023-07-22 21:35:10] [config] embedding-fix-trg: false
[2023-07-22 21:35:10] [config] embedding-normalization: false
[2023-07-22 21:35:10] [config] embedding-vectors:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] enc-cell: gru
[2023-07-22 21:35:10] [config] enc-cell-depth: 1
[2023-07-22 21:35:10] [config] enc-depth: 1
[2023-07-22 21:35:10] [config] enc-type: bidirectional
[2023-07-22 21:35:10] [config] english-title-case-every: 0
[2023-07-22 21:35:10] [config] exponential-smoothing: 0
[2023-07-22 21:35:10] [config] factor-weight: 1
[2023-07-22 21:35:10] [config] factors-combine: sum
[2023-07-22 21:35:10] [config] factors-dim-emb: 0
[2023-07-22 21:35:10] [config] gradient-checkpointing: false
[2023-07-22 21:35:10] [config] gradient-norm-average-window: 100
[2023-07-22 21:35:10] [config] guided-alignment: none
[2023-07-22 21:35:10] [config] guided-alignment-cost: mse
[2023-07-22 21:35:10] [config] guided-alignment-weight: 0.1
[2023-07-22 21:35:10] [config] ignore-model-config: false
[2023-07-22 21:35:10] [config] input-types:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] interpolate-env-vars: false
[2023-07-22 21:35:10] [config] keep-best: false
[2023-07-22 21:35:10] [config] label-smoothing: 0
[2023-07-22 21:35:10] [config] layer-normalization: false
[2023-07-22 21:35:10] [config] learn-rate: 0.0001
[2023-07-22 21:35:10] [config] lemma-dependency: ""
[2023-07-22 21:35:10] [config] lemma-dim-emb: 0
[2023-07-22 21:35:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 21:35:10] [config] log-level: info
[2023-07-22 21:35:10] [config] log-time-zone: ""
[2023-07-22 21:35:10] [config] logical-epoch:
[2023-07-22 21:35:10] [config]   - 1e
[2023-07-22 21:35:10] [config]   - 0
[2023-07-22 21:35:10] [config] lr-decay: 0
[2023-07-22 21:35:10] [config] lr-decay-freq: 50000
[2023-07-22 21:35:10] [config] lr-decay-inv-sqrt:
[2023-07-22 21:35:10] [config]   - 0
[2023-07-22 21:35:10] [config] lr-decay-repeat-warmup: false
[2023-07-22 21:35:10] [config] lr-decay-reset-optimizer: false
[2023-07-22 21:35:10] [config] lr-decay-start:
[2023-07-22 21:35:10] [config]   - 10
[2023-07-22 21:35:10] [config]   - 1
[2023-07-22 21:35:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 21:35:10] [config] lr-report: false
[2023-07-22 21:35:10] [config] lr-warmup: 0
[2023-07-22 21:35:10] [config] lr-warmup-at-reload: false
[2023-07-22 21:35:10] [config] lr-warmup-cycle: false
[2023-07-22 21:35:10] [config] lr-warmup-start-rate: 0
[2023-07-22 21:35:10] [config] max-length: 50
[2023-07-22 21:35:10] [config] max-length-crop: true
[2023-07-22 21:35:10] [config] max-length-factor: 3
[2023-07-22 21:35:10] [config] maxi-batch: 100
[2023-07-22 21:35:10] [config] maxi-batch-sort: trg
[2023-07-22 21:35:10] [config] mini-batch: 64
[2023-07-22 21:35:10] [config] mini-batch-fit: true
[2023-07-22 21:35:10] [config] mini-batch-fit-step: 10
[2023-07-22 21:35:10] [config] mini-batch-round-up: true
[2023-07-22 21:35:10] [config] mini-batch-track-lr: false
[2023-07-22 21:35:10] [config] mini-batch-warmup: 0
[2023-07-22 21:35:10] [config] mini-batch-words: 0
[2023-07-22 21:35:10] [config] mini-batch-words-ref: 0
[2023-07-22 21:35:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 21:35:10] [config] multi-loss-type: sum
[2023-07-22 21:35:10] [config] n-best: false
[2023-07-22 21:35:10] [config] no-nccl: false
[2023-07-22 21:35:10] [config] no-reload: false
[2023-07-22 21:35:10] [config] no-restore-corpus: false
[2023-07-22 21:35:10] [config] normalize: 0
[2023-07-22 21:35:10] [config] normalize-gradient: false
[2023-07-22 21:35:10] [config] num-devices: 0
[2023-07-22 21:35:10] [config] optimizer: adam
[2023-07-22 21:35:10] [config] optimizer-delay: 1
[2023-07-22 21:35:10] [config] optimizer-params:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] output-omit-bias: false
[2023-07-22 21:35:10] [config] overwrite: true
[2023-07-22 21:35:10] [config] precision:
[2023-07-22 21:35:10] [config]   - float16
[2023-07-22 21:35:10] [config]   - float32
[2023-07-22 21:35:10] [config] pretrained-model: ""
[2023-07-22 21:35:10] [config] quantize-biases: false
[2023-07-22 21:35:10] [config] quantize-bits: 0
[2023-07-22 21:35:10] [config] quantize-log-based: false
[2023-07-22 21:35:10] [config] quantize-optimization-steps: 0
[2023-07-22 21:35:10] [config] quiet: false
[2023-07-22 21:35:10] [config] quiet-translation: true
[2023-07-22 21:35:10] [config] relative-paths: false
[2023-07-22 21:35:10] [config] right-left: false
[2023-07-22 21:35:10] [config] save-freq: 10000u
[2023-07-22 21:35:10] [config] seed: 1234
[2023-07-22 21:35:10] [config] sentencepiece-alphas:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] sentencepiece-max-lines: 2000000
[2023-07-22 21:35:10] [config] sentencepiece-options: ""
[2023-07-22 21:35:10] [config] sharding: global
[2023-07-22 21:35:10] [config] shuffle: data
[2023-07-22 21:35:10] [config] shuffle-in-ram: false
[2023-07-22 21:35:10] [config] sigterm: save-and-exit
[2023-07-22 21:35:10] [config] skip: false
[2023-07-22 21:35:10] [config] sqlite: ""
[2023-07-22 21:35:10] [config] sqlite-drop: false
[2023-07-22 21:35:10] [config] sync-freq: 200u
[2023-07-22 21:35:10] [config] sync-sgd: false
[2023-07-22 21:35:10] [config] tempdir: /tmp
[2023-07-22 21:35:10] [config] tied-embeddings: false
[2023-07-22 21:35:10] [config] tied-embeddings-all: true
[2023-07-22 21:35:10] [config] tied-embeddings-src: false
[2023-07-22 21:35:10] [config] train-embedder-rank:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] train-sets:
[2023-07-22 21:35:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 21:35:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 21:35:10] [config] transformer-aan-activation: swish
[2023-07-22 21:35:10] [config] transformer-aan-depth: 2
[2023-07-22 21:35:10] [config] transformer-aan-nogate: false
[2023-07-22 21:35:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 21:35:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 21:35:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 21:35:10] [config] transformer-depth-scaling: false
[2023-07-22 21:35:10] [config] transformer-dim-aan: 2048
[2023-07-22 21:35:10] [config] transformer-dim-ffn: 2048
[2023-07-22 21:35:10] [config] transformer-dropout: 0
[2023-07-22 21:35:10] [config] transformer-dropout-attention: 0
[2023-07-22 21:35:10] [config] transformer-dropout-ffn: 0
[2023-07-22 21:35:10] [config] transformer-ffn-activation: swish
[2023-07-22 21:35:10] [config] transformer-ffn-depth: 2
[2023-07-22 21:35:10] [config] transformer-guided-alignment-layer: last
[2023-07-22 21:35:10] [config] transformer-heads: 8
[2023-07-22 21:35:10] [config] transformer-no-projection: false
[2023-07-22 21:35:10] [config] transformer-pool: false
[2023-07-22 21:35:10] [config] transformer-postprocess: dan
[2023-07-22 21:35:10] [config] transformer-postprocess-emb: d
[2023-07-22 21:35:10] [config] transformer-postprocess-top: ""
[2023-07-22 21:35:10] [config] transformer-preprocess: ""
[2023-07-22 21:35:10] [config] transformer-tied-layers:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] transformer-train-position-embeddings: false
[2023-07-22 21:35:10] [config] tsv: false
[2023-07-22 21:35:10] [config] tsv-fields: 0
[2023-07-22 21:35:10] [config] type: amun
[2023-07-22 21:35:10] [config] ulr: false
[2023-07-22 21:35:10] [config] ulr-dim-emb: 0
[2023-07-22 21:35:10] [config] ulr-dropout: 0
[2023-07-22 21:35:10] [config] ulr-keys-vectors: ""
[2023-07-22 21:35:10] [config] ulr-query-vectors: ""
[2023-07-22 21:35:10] [config] ulr-softmax-temperature: 1
[2023-07-22 21:35:10] [config] ulr-trainable-transformation: false
[2023-07-22 21:35:10] [config] unlikelihood-loss: false
[2023-07-22 21:35:10] [config] valid-freq: 50000000
[2023-07-22 21:35:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 21:35:10] [config] valid-max-length: 1000
[2023-07-22 21:35:10] [config] valid-metrics:
[2023-07-22 21:35:10] [config]   - cross-entropy
[2023-07-22 21:35:10] [config]   - translation
[2023-07-22 21:35:10] [config] valid-mini-batch: 32
[2023-07-22 21:35:10] [config] valid-reset-stalled: false
[2023-07-22 21:35:10] [config] valid-script-args:
[2023-07-22 21:35:10] [config]   []
[2023-07-22 21:35:10] [config] valid-script-path: ""
[2023-07-22 21:35:10] [config] valid-sets:
[2023-07-22 21:35:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 21:35:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 21:35:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 21:35:10] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 21:35:10] [config] vocabs:
[2023-07-22 21:35:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 21:35:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 21:35:10] [config] word-penalty: 0
[2023-07-22 21:35:10] [config] word-scores: false
[2023-07-22 21:35:10] [config] workspace: 5500
[2023-07-22 21:35:10] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 21:35:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 21:35:10] [training] Using single-device training
[2023-07-22 21:35:10] Synced seed 1234
[2023-07-22 21:35:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 21:35:10] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 21:35:10] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 21:35:10] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 21:35:10] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 21:35:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 21:35:10] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 21:35:11] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 21:35:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 21:35:12] [comm] Using global sharding
[2023-07-22 21:35:12] [comm] NCCLCommunicators constructed successfully
[2023-07-22 21:35:12] [training] Using 1 GPUs
[2023-07-22 21:35:12] [logits] Applying loss function for 1 factor(s)
[2023-07-22 21:35:12] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:35:12] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 21:35:12] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:41:58] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 21:41:59] [valid] No post-processing script given for validating translator
[2023-07-22 21:41:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 21:41:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 21:41:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 21:41:59] [comm] Using global sharding
[2023-07-22 21:41:59] [comm] NCCLCommunicators constructed successfully
[2023-07-22 21:41:59] [training] Using 1 GPUs
[2023-07-22 21:41:59] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 21:42:00] Allocating memory for general optimizer shards
[2023-07-22 21:42:00] [memory] Reserving 322 MB, device gpu0
[2023-07-22 21:42:00] Loading Adam parameters
[2023-07-22 21:42:00] [memory] Reserving 322 MB, device gpu0
[2023-07-22 21:42:00] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:42:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 21:42:01] [data] Restoring the corpus state to epoch 161, batch 4639
[2023-07-22 21:42:01] [data] Shuffling data
[2023-07-22 21:42:01] [data] Done reading 20,192 sentences
[2023-07-22 21:42:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:42:01] Training started
[2023-07-22 21:42:01] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 21:42:01] [memory] Reserving 80 MB, device gpu0
[2023-07-22 21:42:05] Parameter type float16, optimization type float32, casting types true
[2023-07-22 21:45:29] Seen 20,192 samples
[2023-07-22 21:45:29] Starting data epoch 162 in logical epoch 162
[2023-07-22 21:45:29] [data] Shuffling data
[2023-07-22 21:45:29] [data] Done reading 20,192 sentences
[2023-07-22 21:45:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:48:56] Seen 20,192 samples
[2023-07-22 21:48:56] Starting data epoch 163 in logical epoch 163
[2023-07-22 21:48:56] [data] Shuffling data
[2023-07-22 21:48:56] [data] Done reading 20,192 sentences
[2023-07-22 21:48:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:52:27] Seen 20,192 samples
[2023-07-22 21:52:27] Starting data epoch 164 in logical epoch 164
[2023-07-22 21:52:27] [data] Shuffling data
[2023-07-22 21:52:27] [data] Done reading 20,192 sentences
[2023-07-22 21:52:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:56:01] Seen 20,192 samples
[2023-07-22 21:56:01] Starting data epoch 165 in logical epoch 165
[2023-07-22 21:56:01] [data] Shuffling data
[2023-07-22 21:56:01] [data] Done reading 20,192 sentences
[2023-07-22 21:56:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 21:59:28] Seen 20,192 samples
[2023-07-22 21:59:28] Starting data epoch 166 in logical epoch 166
[2023-07-22 21:59:28] [data] Shuffling data
[2023-07-22 21:59:28] [data] Done reading 20,192 sentences
[2023-07-22 21:59:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:03:07] Seen 20,192 samples
[2023-07-22 22:03:07] Starting data epoch 167 in logical epoch 167
[2023-07-22 22:03:07] [data] Shuffling data
[2023-07-22 22:03:07] [data] Done reading 20,192 sentences
[2023-07-22 22:03:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:06:43] Seen 20,192 samples
[2023-07-22 22:06:43] Starting data epoch 168 in logical epoch 168
[2023-07-22 22:06:43] [data] Shuffling data
[2023-07-22 22:06:43] [data] Done reading 20,192 sentences
[2023-07-22 22:06:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:10:19] Seen 20,192 samples
[2023-07-22 22:10:19] Starting data epoch 169 in logical epoch 169
[2023-07-22 22:10:19] [data] Shuffling data
[2023-07-22 22:10:19] [data] Done reading 20,192 sentences
[2023-07-22 22:10:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:13:53] Seen 20,192 samples
[2023-07-22 22:13:53] Starting data epoch 170 in logical epoch 170
[2023-07-22 22:13:53] [data] Shuffling data
[2023-07-22 22:13:53] [data] Done reading 20,192 sentences
[2023-07-22 22:13:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:17:26] Seen 20,192 samples
[2023-07-22 22:17:26] Starting data epoch 171 in logical epoch 171
[2023-07-22 22:17:26] Training finished
[2023-07-22 22:17:39] [valid] Ep. 171 : Up. 4928 : cross-entropy : 132.389 : stalled 1 times (last best: 132.367)
[2023-07-22 22:20:14] [valid] Ep. 171 : Up. 4928 : translation : 0 : new best
[2023-07-22 22:20:14] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 22:20:17] Saving Adam parameters
[2023-07-22 22:20:18] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 22:20:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 22:20:27] [marian] Running on node23.datos.cluster.uy as process 38377 with command line:
[2023-07-22 22:20:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 22:20:27] [config] after: 0e
[2023-07-22 22:20:27] [config] after-batches: 0
[2023-07-22 22:20:27] [config] after-epochs: 180
[2023-07-22 22:20:27] [config] all-caps-every: 0
[2023-07-22 22:20:27] [config] allow-unk: false
[2023-07-22 22:20:27] [config] authors: false
[2023-07-22 22:20:27] [config] beam-size: 12
[2023-07-22 22:20:27] [config] bert-class-symbol: "[CLS]"
[2023-07-22 22:20:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 22:20:27] [config] bert-masking-fraction: 0.15
[2023-07-22 22:20:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 22:20:27] [config] bert-train-type-embeddings: true
[2023-07-22 22:20:27] [config] bert-type-vocab-size: 2
[2023-07-22 22:20:27] [config] build-info: ""
[2023-07-22 22:20:27] [config] check-gradient-nan: false
[2023-07-22 22:20:27] [config] check-nan: false
[2023-07-22 22:20:27] [config] cite: false
[2023-07-22 22:20:27] [config] clip-norm: 1
[2023-07-22 22:20:27] [config] cost-scaling:
[2023-07-22 22:20:27] [config]   - 256.f
[2023-07-22 22:20:27] [config]   - 1000
[2023-07-22 22:20:27] [config]   - 2.f
[2023-07-22 22:20:27] [config]   - 256.f
[2023-07-22 22:20:27] [config] cost-type: ce-sum
[2023-07-22 22:20:27] [config] cpu-threads: 0
[2023-07-22 22:20:27] [config] data-threads: 8
[2023-07-22 22:20:27] [config] data-weighting: ""
[2023-07-22 22:20:27] [config] data-weighting-type: sentence
[2023-07-22 22:20:27] [config] dec-cell: gru
[2023-07-22 22:20:27] [config] dec-cell-base-depth: 2
[2023-07-22 22:20:27] [config] dec-cell-high-depth: 1
[2023-07-22 22:20:27] [config] dec-depth: 1
[2023-07-22 22:20:27] [config] devices:
[2023-07-22 22:20:27] [config]   - 0
[2023-07-22 22:20:27] [config] dim-emb: 512
[2023-07-22 22:20:27] [config] dim-rnn: 1024
[2023-07-22 22:20:27] [config] dim-vocabs:
[2023-07-22 22:20:27] [config]   - 16384
[2023-07-22 22:20:27] [config]   - 16384
[2023-07-22 22:20:27] [config] disp-first: 0
[2023-07-22 22:20:27] [config] disp-freq: 1000u
[2023-07-22 22:20:27] [config] disp-label-counts: true
[2023-07-22 22:20:27] [config] dropout-rnn: 0
[2023-07-22 22:20:27] [config] dropout-src: 0
[2023-07-22 22:20:27] [config] dropout-trg: 0
[2023-07-22 22:20:27] [config] dump-config: ""
[2023-07-22 22:20:27] [config] dynamic-gradient-scaling:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] early-stopping: 200
[2023-07-22 22:20:27] [config] early-stopping-on: first
[2023-07-22 22:20:27] [config] embedding-fix-src: false
[2023-07-22 22:20:27] [config] embedding-fix-trg: false
[2023-07-22 22:20:27] [config] embedding-normalization: false
[2023-07-22 22:20:27] [config] embedding-vectors:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] enc-cell: gru
[2023-07-22 22:20:27] [config] enc-cell-depth: 1
[2023-07-22 22:20:27] [config] enc-depth: 1
[2023-07-22 22:20:27] [config] enc-type: bidirectional
[2023-07-22 22:20:27] [config] english-title-case-every: 0
[2023-07-22 22:20:27] [config] exponential-smoothing: 0
[2023-07-22 22:20:27] [config] factor-weight: 1
[2023-07-22 22:20:27] [config] factors-combine: sum
[2023-07-22 22:20:27] [config] factors-dim-emb: 0
[2023-07-22 22:20:27] [config] gradient-checkpointing: false
[2023-07-22 22:20:27] [config] gradient-norm-average-window: 100
[2023-07-22 22:20:27] [config] guided-alignment: none
[2023-07-22 22:20:27] [config] guided-alignment-cost: mse
[2023-07-22 22:20:27] [config] guided-alignment-weight: 0.1
[2023-07-22 22:20:27] [config] ignore-model-config: false
[2023-07-22 22:20:27] [config] input-types:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] interpolate-env-vars: false
[2023-07-22 22:20:27] [config] keep-best: false
[2023-07-22 22:20:27] [config] label-smoothing: 0
[2023-07-22 22:20:27] [config] layer-normalization: false
[2023-07-22 22:20:27] [config] learn-rate: 0.0001
[2023-07-22 22:20:27] [config] lemma-dependency: ""
[2023-07-22 22:20:27] [config] lemma-dim-emb: 0
[2023-07-22 22:20:27] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 22:20:27] [config] log-level: info
[2023-07-22 22:20:27] [config] log-time-zone: ""
[2023-07-22 22:20:27] [config] logical-epoch:
[2023-07-22 22:20:27] [config]   - 1e
[2023-07-22 22:20:27] [config]   - 0
[2023-07-22 22:20:27] [config] lr-decay: 0
[2023-07-22 22:20:27] [config] lr-decay-freq: 50000
[2023-07-22 22:20:27] [config] lr-decay-inv-sqrt:
[2023-07-22 22:20:27] [config]   - 0
[2023-07-22 22:20:27] [config] lr-decay-repeat-warmup: false
[2023-07-22 22:20:27] [config] lr-decay-reset-optimizer: false
[2023-07-22 22:20:27] [config] lr-decay-start:
[2023-07-22 22:20:27] [config]   - 10
[2023-07-22 22:20:27] [config]   - 1
[2023-07-22 22:20:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 22:20:27] [config] lr-report: false
[2023-07-22 22:20:27] [config] lr-warmup: 0
[2023-07-22 22:20:27] [config] lr-warmup-at-reload: false
[2023-07-22 22:20:27] [config] lr-warmup-cycle: false
[2023-07-22 22:20:27] [config] lr-warmup-start-rate: 0
[2023-07-22 22:20:27] [config] max-length: 50
[2023-07-22 22:20:27] [config] max-length-crop: true
[2023-07-22 22:20:27] [config] max-length-factor: 3
[2023-07-22 22:20:27] [config] maxi-batch: 100
[2023-07-22 22:20:27] [config] maxi-batch-sort: trg
[2023-07-22 22:20:27] [config] mini-batch: 64
[2023-07-22 22:20:27] [config] mini-batch-fit: true
[2023-07-22 22:20:27] [config] mini-batch-fit-step: 10
[2023-07-22 22:20:27] [config] mini-batch-round-up: true
[2023-07-22 22:20:27] [config] mini-batch-track-lr: false
[2023-07-22 22:20:27] [config] mini-batch-warmup: 0
[2023-07-22 22:20:27] [config] mini-batch-words: 0
[2023-07-22 22:20:27] [config] mini-batch-words-ref: 0
[2023-07-22 22:20:27] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 22:20:27] [config] multi-loss-type: sum
[2023-07-22 22:20:27] [config] n-best: false
[2023-07-22 22:20:27] [config] no-nccl: false
[2023-07-22 22:20:27] [config] no-reload: false
[2023-07-22 22:20:27] [config] no-restore-corpus: false
[2023-07-22 22:20:27] [config] normalize: 0
[2023-07-22 22:20:27] [config] normalize-gradient: false
[2023-07-22 22:20:27] [config] num-devices: 0
[2023-07-22 22:20:27] [config] optimizer: adam
[2023-07-22 22:20:27] [config] optimizer-delay: 1
[2023-07-22 22:20:27] [config] optimizer-params:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] output-omit-bias: false
[2023-07-22 22:20:27] [config] overwrite: true
[2023-07-22 22:20:27] [config] precision:
[2023-07-22 22:20:27] [config]   - float16
[2023-07-22 22:20:27] [config]   - float32
[2023-07-22 22:20:27] [config] pretrained-model: ""
[2023-07-22 22:20:27] [config] quantize-biases: false
[2023-07-22 22:20:27] [config] quantize-bits: 0
[2023-07-22 22:20:27] [config] quantize-log-based: false
[2023-07-22 22:20:27] [config] quantize-optimization-steps: 0
[2023-07-22 22:20:27] [config] quiet: false
[2023-07-22 22:20:27] [config] quiet-translation: true
[2023-07-22 22:20:27] [config] relative-paths: false
[2023-07-22 22:20:27] [config] right-left: false
[2023-07-22 22:20:27] [config] save-freq: 10000u
[2023-07-22 22:20:27] [config] seed: 1234
[2023-07-22 22:20:27] [config] sentencepiece-alphas:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] sentencepiece-max-lines: 2000000
[2023-07-22 22:20:27] [config] sentencepiece-options: ""
[2023-07-22 22:20:27] [config] sharding: global
[2023-07-22 22:20:27] [config] shuffle: data
[2023-07-22 22:20:27] [config] shuffle-in-ram: false
[2023-07-22 22:20:27] [config] sigterm: save-and-exit
[2023-07-22 22:20:27] [config] skip: false
[2023-07-22 22:20:27] [config] sqlite: ""
[2023-07-22 22:20:27] [config] sqlite-drop: false
[2023-07-22 22:20:27] [config] sync-freq: 200u
[2023-07-22 22:20:27] [config] sync-sgd: false
[2023-07-22 22:20:27] [config] tempdir: /tmp
[2023-07-22 22:20:27] [config] tied-embeddings: false
[2023-07-22 22:20:27] [config] tied-embeddings-all: true
[2023-07-22 22:20:27] [config] tied-embeddings-src: false
[2023-07-22 22:20:27] [config] train-embedder-rank:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] train-sets:
[2023-07-22 22:20:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 22:20:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 22:20:27] [config] transformer-aan-activation: swish
[2023-07-22 22:20:27] [config] transformer-aan-depth: 2
[2023-07-22 22:20:27] [config] transformer-aan-nogate: false
[2023-07-22 22:20:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 22:20:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 22:20:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 22:20:27] [config] transformer-depth-scaling: false
[2023-07-22 22:20:27] [config] transformer-dim-aan: 2048
[2023-07-22 22:20:27] [config] transformer-dim-ffn: 2048
[2023-07-22 22:20:27] [config] transformer-dropout: 0
[2023-07-22 22:20:27] [config] transformer-dropout-attention: 0
[2023-07-22 22:20:27] [config] transformer-dropout-ffn: 0
[2023-07-22 22:20:27] [config] transformer-ffn-activation: swish
[2023-07-22 22:20:27] [config] transformer-ffn-depth: 2
[2023-07-22 22:20:27] [config] transformer-guided-alignment-layer: last
[2023-07-22 22:20:27] [config] transformer-heads: 8
[2023-07-22 22:20:27] [config] transformer-no-projection: false
[2023-07-22 22:20:27] [config] transformer-pool: false
[2023-07-22 22:20:27] [config] transformer-postprocess: dan
[2023-07-22 22:20:27] [config] transformer-postprocess-emb: d
[2023-07-22 22:20:27] [config] transformer-postprocess-top: ""
[2023-07-22 22:20:27] [config] transformer-preprocess: ""
[2023-07-22 22:20:27] [config] transformer-tied-layers:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] transformer-train-position-embeddings: false
[2023-07-22 22:20:27] [config] tsv: false
[2023-07-22 22:20:27] [config] tsv-fields: 0
[2023-07-22 22:20:27] [config] type: amun
[2023-07-22 22:20:27] [config] ulr: false
[2023-07-22 22:20:27] [config] ulr-dim-emb: 0
[2023-07-22 22:20:27] [config] ulr-dropout: 0
[2023-07-22 22:20:27] [config] ulr-keys-vectors: ""
[2023-07-22 22:20:27] [config] ulr-query-vectors: ""
[2023-07-22 22:20:27] [config] ulr-softmax-temperature: 1
[2023-07-22 22:20:27] [config] ulr-trainable-transformation: false
[2023-07-22 22:20:27] [config] unlikelihood-loss: false
[2023-07-22 22:20:27] [config] valid-freq: 50000000
[2023-07-22 22:20:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 22:20:27] [config] valid-max-length: 1000
[2023-07-22 22:20:27] [config] valid-metrics:
[2023-07-22 22:20:27] [config]   - cross-entropy
[2023-07-22 22:20:27] [config]   - translation
[2023-07-22 22:20:27] [config] valid-mini-batch: 32
[2023-07-22 22:20:27] [config] valid-reset-stalled: false
[2023-07-22 22:20:27] [config] valid-script-args:
[2023-07-22 22:20:27] [config]   []
[2023-07-22 22:20:27] [config] valid-script-path: ""
[2023-07-22 22:20:27] [config] valid-sets:
[2023-07-22 22:20:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 22:20:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 22:20:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 22:20:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 22:20:27] [config] vocabs:
[2023-07-22 22:20:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 22:20:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 22:20:27] [config] word-penalty: 0
[2023-07-22 22:20:27] [config] word-scores: false
[2023-07-22 22:20:27] [config] workspace: 5500
[2023-07-22 22:20:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 22:20:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 22:20:27] [training] Using single-device training
[2023-07-22 22:20:27] Synced seed 1234
[2023-07-22 22:20:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 22:20:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 22:20:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 22:20:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 22:20:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 22:20:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 22:20:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 22:20:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 22:20:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 22:20:28] [comm] Using global sharding
[2023-07-22 22:20:29] [comm] NCCLCommunicators constructed successfully
[2023-07-22 22:20:29] [training] Using 1 GPUs
[2023-07-22 22:20:29] [logits] Applying loss function for 1 factor(s)
[2023-07-22 22:20:29] [memory] Reserving 80 MB, device gpu0
[2023-07-22 22:20:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 22:20:29] [memory] Reserving 80 MB, device gpu0
[2023-07-22 22:27:25] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 22:27:25] [valid] No post-processing script given for validating translator
[2023-07-22 22:27:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 22:27:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 22:27:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 22:27:25] [comm] Using global sharding
[2023-07-22 22:27:25] [comm] NCCLCommunicators constructed successfully
[2023-07-22 22:27:25] [training] Using 1 GPUs
[2023-07-22 22:27:25] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 22:27:29] Allocating memory for general optimizer shards
[2023-07-22 22:27:29] [memory] Reserving 322 MB, device gpu0
[2023-07-22 22:27:29] Loading Adam parameters
[2023-07-22 22:27:30] [memory] Reserving 322 MB, device gpu0
[2023-07-22 22:27:30] [memory] Reserving 80 MB, device gpu0
[2023-07-22 22:27:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 22:27:30] [data] Restoring the corpus state to epoch 171, batch 4928
[2023-07-22 22:27:30] [data] Shuffling data
[2023-07-22 22:27:30] [data] Done reading 20,192 sentences
[2023-07-22 22:27:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:27:30] Training started
[2023-07-22 22:27:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 22:27:30] [memory] Reserving 80 MB, device gpu0
[2023-07-22 22:27:34] Parameter type float16, optimization type float32, casting types true
[2023-07-22 22:30:48] Seen 20,192 samples
[2023-07-22 22:30:48] Starting data epoch 172 in logical epoch 172
[2023-07-22 22:30:48] [data] Shuffling data
[2023-07-22 22:30:48] [data] Done reading 20,192 sentences
[2023-07-22 22:30:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:34:15] Seen 20,192 samples
[2023-07-22 22:34:15] Starting data epoch 173 in logical epoch 173
[2023-07-22 22:34:15] [data] Shuffling data
[2023-07-22 22:34:15] [data] Done reading 20,192 sentences
[2023-07-22 22:34:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:36:06] Ep. 173 : Up. 5000 : Sen. 10,005 : Cost 3.99345732 * 17,746,600 @ 12,920 after 88,532,469 : Time 521.18s : 34051.02 words/s : gNorm 1.4952
[2023-07-22 22:37:50] Seen 20,192 samples
[2023-07-22 22:37:50] Starting data epoch 174 in logical epoch 174
[2023-07-22 22:37:50] [data] Shuffling data
[2023-07-22 22:37:50] [data] Done reading 20,192 sentences
[2023-07-22 22:37:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:41:19] Seen 20,192 samples
[2023-07-22 22:41:19] Starting data epoch 175 in logical epoch 175
[2023-07-22 22:41:19] [data] Shuffling data
[2023-07-22 22:41:19] [data] Done reading 20,192 sentences
[2023-07-22 22:41:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:44:50] Seen 20,192 samples
[2023-07-22 22:44:50] Starting data epoch 176 in logical epoch 176
[2023-07-22 22:44:50] [data] Shuffling data
[2023-07-22 22:44:50] [data] Done reading 20,192 sentences
[2023-07-22 22:44:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:48:22] Seen 20,192 samples
[2023-07-22 22:48:22] Starting data epoch 177 in logical epoch 177
[2023-07-22 22:48:22] [data] Shuffling data
[2023-07-22 22:48:22] [data] Done reading 20,192 sentences
[2023-07-22 22:48:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:51:56] Seen 20,192 samples
[2023-07-22 22:51:56] Starting data epoch 178 in logical epoch 178
[2023-07-22 22:51:56] [data] Shuffling data
[2023-07-22 22:51:56] [data] Done reading 20,192 sentences
[2023-07-22 22:51:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:55:28] Seen 20,192 samples
[2023-07-22 22:55:28] Starting data epoch 179 in logical epoch 179
[2023-07-22 22:55:28] [data] Shuffling data
[2023-07-22 22:55:28] [data] Done reading 20,192 sentences
[2023-07-22 22:55:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 22:59:03] Seen 20,192 samples
[2023-07-22 22:59:03] Starting data epoch 180 in logical epoch 180
[2023-07-22 22:59:03] [data] Shuffling data
[2023-07-22 22:59:03] [data] Done reading 20,192 sentences
[2023-07-22 22:59:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:02:38] Seen 20,192 samples
[2023-07-22 23:02:38] Starting data epoch 181 in logical epoch 181
[2023-07-22 23:02:38] Training finished
[2023-07-22 23:02:51] [valid] Ep. 181 : Up. 5218 : cross-entropy : 132.096 : new best
[2023-07-22 23:05:22] [valid] Ep. 181 : Up. 5218 : translation : 0 : new best
[2023-07-22 23:05:22] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 23:05:27] Saving Adam parameters
[2023-07-22 23:05:28] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 23:05:35] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 23:05:35] [marian] Running on node23.datos.cluster.uy as process 700 with command line:
[2023-07-22 23:05:35] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 23:05:35] [config] after: 0e
[2023-07-22 23:05:35] [config] after-batches: 0
[2023-07-22 23:05:35] [config] after-epochs: 190
[2023-07-22 23:05:35] [config] all-caps-every: 0
[2023-07-22 23:05:35] [config] allow-unk: false
[2023-07-22 23:05:35] [config] authors: false
[2023-07-22 23:05:35] [config] beam-size: 12
[2023-07-22 23:05:35] [config] bert-class-symbol: "[CLS]"
[2023-07-22 23:05:35] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 23:05:35] [config] bert-masking-fraction: 0.15
[2023-07-22 23:05:35] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 23:05:35] [config] bert-train-type-embeddings: true
[2023-07-22 23:05:35] [config] bert-type-vocab-size: 2
[2023-07-22 23:05:35] [config] build-info: ""
[2023-07-22 23:05:35] [config] check-gradient-nan: false
[2023-07-22 23:05:35] [config] check-nan: false
[2023-07-22 23:05:35] [config] cite: false
[2023-07-22 23:05:35] [config] clip-norm: 1
[2023-07-22 23:05:35] [config] cost-scaling:
[2023-07-22 23:05:35] [config]   - 256.f
[2023-07-22 23:05:35] [config]   - 1000
[2023-07-22 23:05:35] [config]   - 2.f
[2023-07-22 23:05:35] [config]   - 256.f
[2023-07-22 23:05:35] [config] cost-type: ce-sum
[2023-07-22 23:05:35] [config] cpu-threads: 0
[2023-07-22 23:05:35] [config] data-threads: 8
[2023-07-22 23:05:35] [config] data-weighting: ""
[2023-07-22 23:05:35] [config] data-weighting-type: sentence
[2023-07-22 23:05:35] [config] dec-cell: gru
[2023-07-22 23:05:35] [config] dec-cell-base-depth: 2
[2023-07-22 23:05:35] [config] dec-cell-high-depth: 1
[2023-07-22 23:05:35] [config] dec-depth: 1
[2023-07-22 23:05:35] [config] devices:
[2023-07-22 23:05:35] [config]   - 0
[2023-07-22 23:05:35] [config] dim-emb: 512
[2023-07-22 23:05:35] [config] dim-rnn: 1024
[2023-07-22 23:05:35] [config] dim-vocabs:
[2023-07-22 23:05:35] [config]   - 16384
[2023-07-22 23:05:35] [config]   - 16384
[2023-07-22 23:05:35] [config] disp-first: 0
[2023-07-22 23:05:35] [config] disp-freq: 1000u
[2023-07-22 23:05:35] [config] disp-label-counts: true
[2023-07-22 23:05:35] [config] dropout-rnn: 0
[2023-07-22 23:05:35] [config] dropout-src: 0
[2023-07-22 23:05:35] [config] dropout-trg: 0
[2023-07-22 23:05:35] [config] dump-config: ""
[2023-07-22 23:05:35] [config] dynamic-gradient-scaling:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] early-stopping: 200
[2023-07-22 23:05:35] [config] early-stopping-on: first
[2023-07-22 23:05:35] [config] embedding-fix-src: false
[2023-07-22 23:05:35] [config] embedding-fix-trg: false
[2023-07-22 23:05:35] [config] embedding-normalization: false
[2023-07-22 23:05:35] [config] embedding-vectors:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] enc-cell: gru
[2023-07-22 23:05:35] [config] enc-cell-depth: 1
[2023-07-22 23:05:35] [config] enc-depth: 1
[2023-07-22 23:05:35] [config] enc-type: bidirectional
[2023-07-22 23:05:35] [config] english-title-case-every: 0
[2023-07-22 23:05:35] [config] exponential-smoothing: 0
[2023-07-22 23:05:35] [config] factor-weight: 1
[2023-07-22 23:05:35] [config] factors-combine: sum
[2023-07-22 23:05:35] [config] factors-dim-emb: 0
[2023-07-22 23:05:35] [config] gradient-checkpointing: false
[2023-07-22 23:05:35] [config] gradient-norm-average-window: 100
[2023-07-22 23:05:35] [config] guided-alignment: none
[2023-07-22 23:05:35] [config] guided-alignment-cost: mse
[2023-07-22 23:05:35] [config] guided-alignment-weight: 0.1
[2023-07-22 23:05:35] [config] ignore-model-config: false
[2023-07-22 23:05:35] [config] input-types:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] interpolate-env-vars: false
[2023-07-22 23:05:35] [config] keep-best: false
[2023-07-22 23:05:35] [config] label-smoothing: 0
[2023-07-22 23:05:35] [config] layer-normalization: false
[2023-07-22 23:05:35] [config] learn-rate: 0.0001
[2023-07-22 23:05:35] [config] lemma-dependency: ""
[2023-07-22 23:05:35] [config] lemma-dim-emb: 0
[2023-07-22 23:05:35] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 23:05:35] [config] log-level: info
[2023-07-22 23:05:35] [config] log-time-zone: ""
[2023-07-22 23:05:35] [config] logical-epoch:
[2023-07-22 23:05:35] [config]   - 1e
[2023-07-22 23:05:35] [config]   - 0
[2023-07-22 23:05:35] [config] lr-decay: 0
[2023-07-22 23:05:35] [config] lr-decay-freq: 50000
[2023-07-22 23:05:35] [config] lr-decay-inv-sqrt:
[2023-07-22 23:05:35] [config]   - 0
[2023-07-22 23:05:35] [config] lr-decay-repeat-warmup: false
[2023-07-22 23:05:35] [config] lr-decay-reset-optimizer: false
[2023-07-22 23:05:35] [config] lr-decay-start:
[2023-07-22 23:05:35] [config]   - 10
[2023-07-22 23:05:35] [config]   - 1
[2023-07-22 23:05:35] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 23:05:35] [config] lr-report: false
[2023-07-22 23:05:35] [config] lr-warmup: 0
[2023-07-22 23:05:35] [config] lr-warmup-at-reload: false
[2023-07-22 23:05:35] [config] lr-warmup-cycle: false
[2023-07-22 23:05:35] [config] lr-warmup-start-rate: 0
[2023-07-22 23:05:35] [config] max-length: 50
[2023-07-22 23:05:35] [config] max-length-crop: true
[2023-07-22 23:05:35] [config] max-length-factor: 3
[2023-07-22 23:05:35] [config] maxi-batch: 100
[2023-07-22 23:05:35] [config] maxi-batch-sort: trg
[2023-07-22 23:05:35] [config] mini-batch: 64
[2023-07-22 23:05:35] [config] mini-batch-fit: true
[2023-07-22 23:05:35] [config] mini-batch-fit-step: 10
[2023-07-22 23:05:35] [config] mini-batch-round-up: true
[2023-07-22 23:05:35] [config] mini-batch-track-lr: false
[2023-07-22 23:05:35] [config] mini-batch-warmup: 0
[2023-07-22 23:05:35] [config] mini-batch-words: 0
[2023-07-22 23:05:35] [config] mini-batch-words-ref: 0
[2023-07-22 23:05:35] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 23:05:35] [config] multi-loss-type: sum
[2023-07-22 23:05:35] [config] n-best: false
[2023-07-22 23:05:35] [config] no-nccl: false
[2023-07-22 23:05:35] [config] no-reload: false
[2023-07-22 23:05:35] [config] no-restore-corpus: false
[2023-07-22 23:05:35] [config] normalize: 0
[2023-07-22 23:05:35] [config] normalize-gradient: false
[2023-07-22 23:05:35] [config] num-devices: 0
[2023-07-22 23:05:35] [config] optimizer: adam
[2023-07-22 23:05:35] [config] optimizer-delay: 1
[2023-07-22 23:05:35] [config] optimizer-params:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] output-omit-bias: false
[2023-07-22 23:05:35] [config] overwrite: true
[2023-07-22 23:05:35] [config] precision:
[2023-07-22 23:05:35] [config]   - float16
[2023-07-22 23:05:35] [config]   - float32
[2023-07-22 23:05:35] [config] pretrained-model: ""
[2023-07-22 23:05:35] [config] quantize-biases: false
[2023-07-22 23:05:35] [config] quantize-bits: 0
[2023-07-22 23:05:35] [config] quantize-log-based: false
[2023-07-22 23:05:35] [config] quantize-optimization-steps: 0
[2023-07-22 23:05:35] [config] quiet: false
[2023-07-22 23:05:35] [config] quiet-translation: true
[2023-07-22 23:05:35] [config] relative-paths: false
[2023-07-22 23:05:35] [config] right-left: false
[2023-07-22 23:05:35] [config] save-freq: 10000u
[2023-07-22 23:05:35] [config] seed: 1234
[2023-07-22 23:05:35] [config] sentencepiece-alphas:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] sentencepiece-max-lines: 2000000
[2023-07-22 23:05:35] [config] sentencepiece-options: ""
[2023-07-22 23:05:35] [config] sharding: global
[2023-07-22 23:05:35] [config] shuffle: data
[2023-07-22 23:05:35] [config] shuffle-in-ram: false
[2023-07-22 23:05:35] [config] sigterm: save-and-exit
[2023-07-22 23:05:35] [config] skip: false
[2023-07-22 23:05:35] [config] sqlite: ""
[2023-07-22 23:05:35] [config] sqlite-drop: false
[2023-07-22 23:05:35] [config] sync-freq: 200u
[2023-07-22 23:05:35] [config] sync-sgd: false
[2023-07-22 23:05:35] [config] tempdir: /tmp
[2023-07-22 23:05:35] [config] tied-embeddings: false
[2023-07-22 23:05:35] [config] tied-embeddings-all: true
[2023-07-22 23:05:35] [config] tied-embeddings-src: false
[2023-07-22 23:05:35] [config] train-embedder-rank:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] train-sets:
[2023-07-22 23:05:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 23:05:35] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 23:05:35] [config] transformer-aan-activation: swish
[2023-07-22 23:05:35] [config] transformer-aan-depth: 2
[2023-07-22 23:05:35] [config] transformer-aan-nogate: false
[2023-07-22 23:05:35] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 23:05:35] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 23:05:35] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 23:05:35] [config] transformer-depth-scaling: false
[2023-07-22 23:05:35] [config] transformer-dim-aan: 2048
[2023-07-22 23:05:35] [config] transformer-dim-ffn: 2048
[2023-07-22 23:05:35] [config] transformer-dropout: 0
[2023-07-22 23:05:35] [config] transformer-dropout-attention: 0
[2023-07-22 23:05:35] [config] transformer-dropout-ffn: 0
[2023-07-22 23:05:35] [config] transformer-ffn-activation: swish
[2023-07-22 23:05:35] [config] transformer-ffn-depth: 2
[2023-07-22 23:05:35] [config] transformer-guided-alignment-layer: last
[2023-07-22 23:05:35] [config] transformer-heads: 8
[2023-07-22 23:05:35] [config] transformer-no-projection: false
[2023-07-22 23:05:35] [config] transformer-pool: false
[2023-07-22 23:05:35] [config] transformer-postprocess: dan
[2023-07-22 23:05:35] [config] transformer-postprocess-emb: d
[2023-07-22 23:05:35] [config] transformer-postprocess-top: ""
[2023-07-22 23:05:35] [config] transformer-preprocess: ""
[2023-07-22 23:05:35] [config] transformer-tied-layers:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] transformer-train-position-embeddings: false
[2023-07-22 23:05:35] [config] tsv: false
[2023-07-22 23:05:35] [config] tsv-fields: 0
[2023-07-22 23:05:35] [config] type: amun
[2023-07-22 23:05:35] [config] ulr: false
[2023-07-22 23:05:35] [config] ulr-dim-emb: 0
[2023-07-22 23:05:35] [config] ulr-dropout: 0
[2023-07-22 23:05:35] [config] ulr-keys-vectors: ""
[2023-07-22 23:05:35] [config] ulr-query-vectors: ""
[2023-07-22 23:05:35] [config] ulr-softmax-temperature: 1
[2023-07-22 23:05:35] [config] ulr-trainable-transformation: false
[2023-07-22 23:05:35] [config] unlikelihood-loss: false
[2023-07-22 23:05:35] [config] valid-freq: 50000000
[2023-07-22 23:05:35] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 23:05:35] [config] valid-max-length: 1000
[2023-07-22 23:05:35] [config] valid-metrics:
[2023-07-22 23:05:35] [config]   - cross-entropy
[2023-07-22 23:05:35] [config]   - translation
[2023-07-22 23:05:35] [config] valid-mini-batch: 32
[2023-07-22 23:05:35] [config] valid-reset-stalled: false
[2023-07-22 23:05:35] [config] valid-script-args:
[2023-07-22 23:05:35] [config]   []
[2023-07-22 23:05:35] [config] valid-script-path: ""
[2023-07-22 23:05:35] [config] valid-sets:
[2023-07-22 23:05:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 23:05:35] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 23:05:35] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 23:05:35] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 23:05:35] [config] vocabs:
[2023-07-22 23:05:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 23:05:35] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 23:05:35] [config] word-penalty: 0
[2023-07-22 23:05:35] [config] word-scores: false
[2023-07-22 23:05:35] [config] workspace: 5500
[2023-07-22 23:05:35] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 23:05:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:05:35] [training] Using single-device training
[2023-07-22 23:05:35] Synced seed 1234
[2023-07-22 23:05:35] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 23:05:35] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 23:05:35] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 23:05:35] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 23:05:35] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 23:05:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:05:35] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 23:05:36] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 23:05:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 23:05:37] [comm] Using global sharding
[2023-07-22 23:05:37] [comm] NCCLCommunicators constructed successfully
[2023-07-22 23:05:37] [training] Using 1 GPUs
[2023-07-22 23:05:37] [logits] Applying loss function for 1 factor(s)
[2023-07-22 23:05:37] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:05:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 23:05:37] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:12:24] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 23:12:24] [valid] No post-processing script given for validating translator
[2023-07-22 23:12:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:12:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 23:12:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 23:12:24] [comm] Using global sharding
[2023-07-22 23:12:24] [comm] NCCLCommunicators constructed successfully
[2023-07-22 23:12:24] [training] Using 1 GPUs
[2023-07-22 23:12:24] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 23:12:29] Allocating memory for general optimizer shards
[2023-07-22 23:12:29] [memory] Reserving 322 MB, device gpu0
[2023-07-22 23:12:29] Loading Adam parameters
[2023-07-22 23:12:29] [memory] Reserving 322 MB, device gpu0
[2023-07-22 23:12:29] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:12:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 23:12:30] [data] Restoring the corpus state to epoch 181, batch 5218
[2023-07-22 23:12:30] [data] Shuffling data
[2023-07-22 23:12:30] [data] Done reading 20,192 sentences
[2023-07-22 23:12:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:12:30] Training started
[2023-07-22 23:12:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 23:12:30] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:12:30] Parameter type float16, optimization type float32, casting types true
[2023-07-22 23:15:36] Seen 20,192 samples
[2023-07-22 23:15:36] Starting data epoch 182 in logical epoch 182
[2023-07-22 23:15:36] [data] Shuffling data
[2023-07-22 23:15:36] [data] Done reading 20,192 sentences
[2023-07-22 23:15:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:18:59] Seen 20,192 samples
[2023-07-22 23:18:59] Starting data epoch 183 in logical epoch 183
[2023-07-22 23:18:59] [data] Shuffling data
[2023-07-22 23:18:59] [data] Done reading 20,192 sentences
[2023-07-22 23:18:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:22:24] Seen 20,192 samples
[2023-07-22 23:22:24] Starting data epoch 184 in logical epoch 184
[2023-07-22 23:22:24] [data] Shuffling data
[2023-07-22 23:22:24] [data] Done reading 20,192 sentences
[2023-07-22 23:22:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:25:51] Seen 20,192 samples
[2023-07-22 23:25:51] Starting data epoch 185 in logical epoch 185
[2023-07-22 23:25:51] [data] Shuffling data
[2023-07-22 23:25:51] [data] Done reading 20,192 sentences
[2023-07-22 23:25:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:29:19] Seen 20,192 samples
[2023-07-22 23:29:19] Starting data epoch 186 in logical epoch 186
[2023-07-22 23:29:19] [data] Shuffling data
[2023-07-22 23:29:19] [data] Done reading 20,192 sentences
[2023-07-22 23:29:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:32:51] Seen 20,192 samples
[2023-07-22 23:32:51] Starting data epoch 187 in logical epoch 187
[2023-07-22 23:32:51] [data] Shuffling data
[2023-07-22 23:32:51] [data] Done reading 20,192 sentences
[2023-07-22 23:32:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:36:22] Seen 20,192 samples
[2023-07-22 23:36:22] Starting data epoch 188 in logical epoch 188
[2023-07-22 23:36:22] [data] Shuffling data
[2023-07-22 23:36:22] [data] Done reading 20,192 sentences
[2023-07-22 23:36:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:39:57] Seen 20,192 samples
[2023-07-22 23:39:57] Starting data epoch 189 in logical epoch 189
[2023-07-22 23:39:57] [data] Shuffling data
[2023-07-22 23:39:57] [data] Done reading 20,192 sentences
[2023-07-22 23:39:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:43:29] Seen 20,192 samples
[2023-07-22 23:43:29] Starting data epoch 190 in logical epoch 190
[2023-07-22 23:43:29] [data] Shuffling data
[2023-07-22 23:43:29] [data] Done reading 20,192 sentences
[2023-07-22 23:43:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:47:03] Seen 20,192 samples
[2023-07-22 23:47:03] Starting data epoch 191 in logical epoch 191
[2023-07-22 23:47:03] Training finished
[2023-07-22 23:47:19] [valid] Ep. 191 : Up. 5508 : cross-entropy : 133.405 : stalled 1 times (last best: 132.096)
[2023-07-22 23:49:43] [valid] Ep. 191 : Up. 5508 : translation : 0 : new best
[2023-07-22 23:49:43] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 23:49:46] Saving Adam parameters
[2023-07-22 23:49:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 23:49:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 23:49:53] [marian] Running on node23.datos.cluster.uy as process 3544 with command line:
[2023-07-22 23:49:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell gru
[2023-07-22 23:49:53] [config] after: 0e
[2023-07-22 23:49:53] [config] after-batches: 0
[2023-07-22 23:49:53] [config] after-epochs: 200
[2023-07-22 23:49:53] [config] all-caps-every: 0
[2023-07-22 23:49:53] [config] allow-unk: false
[2023-07-22 23:49:53] [config] authors: false
[2023-07-22 23:49:53] [config] beam-size: 12
[2023-07-22 23:49:53] [config] bert-class-symbol: "[CLS]"
[2023-07-22 23:49:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 23:49:53] [config] bert-masking-fraction: 0.15
[2023-07-22 23:49:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 23:49:53] [config] bert-train-type-embeddings: true
[2023-07-22 23:49:53] [config] bert-type-vocab-size: 2
[2023-07-22 23:49:53] [config] build-info: ""
[2023-07-22 23:49:53] [config] check-gradient-nan: false
[2023-07-22 23:49:53] [config] check-nan: false
[2023-07-22 23:49:53] [config] cite: false
[2023-07-22 23:49:53] [config] clip-norm: 1
[2023-07-22 23:49:53] [config] cost-scaling:
[2023-07-22 23:49:53] [config]   - 256.f
[2023-07-22 23:49:53] [config]   - 1000
[2023-07-22 23:49:53] [config]   - 2.f
[2023-07-22 23:49:53] [config]   - 256.f
[2023-07-22 23:49:53] [config] cost-type: ce-sum
[2023-07-22 23:49:53] [config] cpu-threads: 0
[2023-07-22 23:49:53] [config] data-threads: 8
[2023-07-22 23:49:53] [config] data-weighting: ""
[2023-07-22 23:49:53] [config] data-weighting-type: sentence
[2023-07-22 23:49:53] [config] dec-cell: gru
[2023-07-22 23:49:53] [config] dec-cell-base-depth: 2
[2023-07-22 23:49:53] [config] dec-cell-high-depth: 1
[2023-07-22 23:49:53] [config] dec-depth: 1
[2023-07-22 23:49:53] [config] devices:
[2023-07-22 23:49:53] [config]   - 0
[2023-07-22 23:49:53] [config] dim-emb: 512
[2023-07-22 23:49:53] [config] dim-rnn: 1024
[2023-07-22 23:49:53] [config] dim-vocabs:
[2023-07-22 23:49:53] [config]   - 16384
[2023-07-22 23:49:53] [config]   - 16384
[2023-07-22 23:49:53] [config] disp-first: 0
[2023-07-22 23:49:53] [config] disp-freq: 1000u
[2023-07-22 23:49:53] [config] disp-label-counts: true
[2023-07-22 23:49:53] [config] dropout-rnn: 0
[2023-07-22 23:49:53] [config] dropout-src: 0
[2023-07-22 23:49:53] [config] dropout-trg: 0
[2023-07-22 23:49:53] [config] dump-config: ""
[2023-07-22 23:49:53] [config] dynamic-gradient-scaling:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] early-stopping: 200
[2023-07-22 23:49:53] [config] early-stopping-on: first
[2023-07-22 23:49:53] [config] embedding-fix-src: false
[2023-07-22 23:49:53] [config] embedding-fix-trg: false
[2023-07-22 23:49:53] [config] embedding-normalization: false
[2023-07-22 23:49:53] [config] embedding-vectors:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] enc-cell: gru
[2023-07-22 23:49:53] [config] enc-cell-depth: 1
[2023-07-22 23:49:53] [config] enc-depth: 1
[2023-07-22 23:49:53] [config] enc-type: bidirectional
[2023-07-22 23:49:53] [config] english-title-case-every: 0
[2023-07-22 23:49:53] [config] exponential-smoothing: 0
[2023-07-22 23:49:53] [config] factor-weight: 1
[2023-07-22 23:49:53] [config] factors-combine: sum
[2023-07-22 23:49:53] [config] factors-dim-emb: 0
[2023-07-22 23:49:53] [config] gradient-checkpointing: false
[2023-07-22 23:49:53] [config] gradient-norm-average-window: 100
[2023-07-22 23:49:53] [config] guided-alignment: none
[2023-07-22 23:49:53] [config] guided-alignment-cost: mse
[2023-07-22 23:49:53] [config] guided-alignment-weight: 0.1
[2023-07-22 23:49:53] [config] ignore-model-config: false
[2023-07-22 23:49:53] [config] input-types:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] interpolate-env-vars: false
[2023-07-22 23:49:53] [config] keep-best: false
[2023-07-22 23:49:53] [config] label-smoothing: 0
[2023-07-22 23:49:53] [config] layer-normalization: false
[2023-07-22 23:49:53] [config] learn-rate: 0.0001
[2023-07-22 23:49:53] [config] lemma-dependency: ""
[2023-07-22 23:49:53] [config] lemma-dim-emb: 0
[2023-07-22 23:49:53] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 23:49:53] [config] log-level: info
[2023-07-22 23:49:53] [config] log-time-zone: ""
[2023-07-22 23:49:53] [config] logical-epoch:
[2023-07-22 23:49:53] [config]   - 1e
[2023-07-22 23:49:53] [config]   - 0
[2023-07-22 23:49:53] [config] lr-decay: 0
[2023-07-22 23:49:53] [config] lr-decay-freq: 50000
[2023-07-22 23:49:53] [config] lr-decay-inv-sqrt:
[2023-07-22 23:49:53] [config]   - 0
[2023-07-22 23:49:53] [config] lr-decay-repeat-warmup: false
[2023-07-22 23:49:53] [config] lr-decay-reset-optimizer: false
[2023-07-22 23:49:53] [config] lr-decay-start:
[2023-07-22 23:49:53] [config]   - 10
[2023-07-22 23:49:53] [config]   - 1
[2023-07-22 23:49:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 23:49:53] [config] lr-report: false
[2023-07-22 23:49:53] [config] lr-warmup: 0
[2023-07-22 23:49:53] [config] lr-warmup-at-reload: false
[2023-07-22 23:49:53] [config] lr-warmup-cycle: false
[2023-07-22 23:49:53] [config] lr-warmup-start-rate: 0
[2023-07-22 23:49:53] [config] max-length: 50
[2023-07-22 23:49:53] [config] max-length-crop: true
[2023-07-22 23:49:53] [config] max-length-factor: 3
[2023-07-22 23:49:53] [config] maxi-batch: 100
[2023-07-22 23:49:53] [config] maxi-batch-sort: trg
[2023-07-22 23:49:53] [config] mini-batch: 64
[2023-07-22 23:49:53] [config] mini-batch-fit: true
[2023-07-22 23:49:53] [config] mini-batch-fit-step: 10
[2023-07-22 23:49:53] [config] mini-batch-round-up: true
[2023-07-22 23:49:53] [config] mini-batch-track-lr: false
[2023-07-22 23:49:53] [config] mini-batch-warmup: 0
[2023-07-22 23:49:53] [config] mini-batch-words: 0
[2023-07-22 23:49:53] [config] mini-batch-words-ref: 0
[2023-07-22 23:49:53] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 23:49:53] [config] multi-loss-type: sum
[2023-07-22 23:49:53] [config] n-best: false
[2023-07-22 23:49:53] [config] no-nccl: false
[2023-07-22 23:49:53] [config] no-reload: false
[2023-07-22 23:49:53] [config] no-restore-corpus: false
[2023-07-22 23:49:53] [config] normalize: 0
[2023-07-22 23:49:53] [config] normalize-gradient: false
[2023-07-22 23:49:53] [config] num-devices: 0
[2023-07-22 23:49:53] [config] optimizer: adam
[2023-07-22 23:49:53] [config] optimizer-delay: 1
[2023-07-22 23:49:53] [config] optimizer-params:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] output-omit-bias: false
[2023-07-22 23:49:53] [config] overwrite: true
[2023-07-22 23:49:53] [config] precision:
[2023-07-22 23:49:53] [config]   - float16
[2023-07-22 23:49:53] [config]   - float32
[2023-07-22 23:49:53] [config] pretrained-model: ""
[2023-07-22 23:49:53] [config] quantize-biases: false
[2023-07-22 23:49:53] [config] quantize-bits: 0
[2023-07-22 23:49:53] [config] quantize-log-based: false
[2023-07-22 23:49:53] [config] quantize-optimization-steps: 0
[2023-07-22 23:49:53] [config] quiet: false
[2023-07-22 23:49:53] [config] quiet-translation: true
[2023-07-22 23:49:53] [config] relative-paths: false
[2023-07-22 23:49:53] [config] right-left: false
[2023-07-22 23:49:53] [config] save-freq: 10000u
[2023-07-22 23:49:53] [config] seed: 1234
[2023-07-22 23:49:53] [config] sentencepiece-alphas:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] sentencepiece-max-lines: 2000000
[2023-07-22 23:49:53] [config] sentencepiece-options: ""
[2023-07-22 23:49:53] [config] sharding: global
[2023-07-22 23:49:53] [config] shuffle: data
[2023-07-22 23:49:53] [config] shuffle-in-ram: false
[2023-07-22 23:49:53] [config] sigterm: save-and-exit
[2023-07-22 23:49:53] [config] skip: false
[2023-07-22 23:49:53] [config] sqlite: ""
[2023-07-22 23:49:53] [config] sqlite-drop: false
[2023-07-22 23:49:53] [config] sync-freq: 200u
[2023-07-22 23:49:53] [config] sync-sgd: false
[2023-07-22 23:49:53] [config] tempdir: /tmp
[2023-07-22 23:49:53] [config] tied-embeddings: false
[2023-07-22 23:49:53] [config] tied-embeddings-all: true
[2023-07-22 23:49:53] [config] tied-embeddings-src: false
[2023-07-22 23:49:53] [config] train-embedder-rank:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] train-sets:
[2023-07-22 23:49:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 23:49:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 23:49:53] [config] transformer-aan-activation: swish
[2023-07-22 23:49:53] [config] transformer-aan-depth: 2
[2023-07-22 23:49:53] [config] transformer-aan-nogate: false
[2023-07-22 23:49:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 23:49:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 23:49:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 23:49:53] [config] transformer-depth-scaling: false
[2023-07-22 23:49:53] [config] transformer-dim-aan: 2048
[2023-07-22 23:49:53] [config] transformer-dim-ffn: 2048
[2023-07-22 23:49:53] [config] transformer-dropout: 0
[2023-07-22 23:49:53] [config] transformer-dropout-attention: 0
[2023-07-22 23:49:53] [config] transformer-dropout-ffn: 0
[2023-07-22 23:49:53] [config] transformer-ffn-activation: swish
[2023-07-22 23:49:53] [config] transformer-ffn-depth: 2
[2023-07-22 23:49:53] [config] transformer-guided-alignment-layer: last
[2023-07-22 23:49:53] [config] transformer-heads: 8
[2023-07-22 23:49:53] [config] transformer-no-projection: false
[2023-07-22 23:49:53] [config] transformer-pool: false
[2023-07-22 23:49:53] [config] transformer-postprocess: dan
[2023-07-22 23:49:53] [config] transformer-postprocess-emb: d
[2023-07-22 23:49:53] [config] transformer-postprocess-top: ""
[2023-07-22 23:49:53] [config] transformer-preprocess: ""
[2023-07-22 23:49:53] [config] transformer-tied-layers:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] transformer-train-position-embeddings: false
[2023-07-22 23:49:53] [config] tsv: false
[2023-07-22 23:49:53] [config] tsv-fields: 0
[2023-07-22 23:49:53] [config] type: amun
[2023-07-22 23:49:53] [config] ulr: false
[2023-07-22 23:49:53] [config] ulr-dim-emb: 0
[2023-07-22 23:49:53] [config] ulr-dropout: 0
[2023-07-22 23:49:53] [config] ulr-keys-vectors: ""
[2023-07-22 23:49:53] [config] ulr-query-vectors: ""
[2023-07-22 23:49:53] [config] ulr-softmax-temperature: 1
[2023-07-22 23:49:53] [config] ulr-trainable-transformation: false
[2023-07-22 23:49:53] [config] unlikelihood-loss: false
[2023-07-22 23:49:53] [config] valid-freq: 50000000
[2023-07-22 23:49:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-22 23:49:53] [config] valid-max-length: 1000
[2023-07-22 23:49:53] [config] valid-metrics:
[2023-07-22 23:49:53] [config]   - cross-entropy
[2023-07-22 23:49:53] [config]   - translation
[2023-07-22 23:49:53] [config] valid-mini-batch: 32
[2023-07-22 23:49:53] [config] valid-reset-stalled: false
[2023-07-22 23:49:53] [config] valid-script-args:
[2023-07-22 23:49:53] [config]   []
[2023-07-22 23:49:53] [config] valid-script-path: ""
[2023-07-22 23:49:53] [config] valid-sets:
[2023-07-22 23:49:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 23:49:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 23:49:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-22 23:49:53] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 23:49:53] [config] vocabs:
[2023-07-22 23:49:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 23:49:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 23:49:53] [config] word-penalty: 0
[2023-07-22 23:49:53] [config] word-scores: false
[2023-07-22 23:49:53] [config] workspace: 5500
[2023-07-22 23:49:53] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 23:49:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:49:53] [training] Using single-device training
[2023-07-22 23:49:53] Synced seed 1234
[2023-07-22 23:49:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 23:49:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 23:49:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 23:49:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 23:49:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 23:49:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:49:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 23:49:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 23:49:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 23:49:55] [comm] Using global sharding
[2023-07-22 23:49:55] [comm] NCCLCommunicators constructed successfully
[2023-07-22 23:49:55] [training] Using 1 GPUs
[2023-07-22 23:49:55] [logits] Applying loss function for 1 factor(s)
[2023-07-22 23:49:55] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:49:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 23:49:55] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:56:52] [batching] Done. Typical MB size is 36,030 target words
[2023-07-22 23:56:52] [valid] No post-processing script given for validating translator
[2023-07-22 23:56:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 23:56:52] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 23:56:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 23:56:52] [comm] Using global sharding
[2023-07-22 23:56:52] [comm] NCCLCommunicators constructed successfully
[2023-07-22 23:56:52] [training] Using 1 GPUs
[2023-07-22 23:56:52] Loading model from /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-22 23:56:54] Allocating memory for general optimizer shards
[2023-07-22 23:56:54] [memory] Reserving 322 MB, device gpu0
[2023-07-22 23:56:54] Loading Adam parameters
[2023-07-22 23:56:54] [memory] Reserving 322 MB, device gpu0
[2023-07-22 23:56:54] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:56:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-22 23:56:54] [data] Restoring the corpus state to epoch 191, batch 5508
[2023-07-22 23:56:54] [data] Shuffling data
[2023-07-22 23:56:54] [data] Done reading 20,192 sentences
[2023-07-22 23:56:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 23:56:54] Training started
[2023-07-22 23:56:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 23:56:55] [memory] Reserving 80 MB, device gpu0
[2023-07-22 23:57:01] Parameter type float16, optimization type float32, casting types true
[2023-07-23 00:00:10] Seen 20,192 samples
[2023-07-23 00:00:10] Starting data epoch 192 in logical epoch 192
[2023-07-23 00:00:10] [data] Shuffling data
[2023-07-23 00:00:10] [data] Done reading 20,192 sentences
[2023-07-23 00:00:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:03:34] Seen 20,192 samples
[2023-07-23 00:03:34] Starting data epoch 193 in logical epoch 193
[2023-07-23 00:03:34] [data] Shuffling data
[2023-07-23 00:03:34] [data] Done reading 20,192 sentences
[2023-07-23 00:03:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:06:59] Seen 20,192 samples
[2023-07-23 00:06:59] Starting data epoch 194 in logical epoch 194
[2023-07-23 00:06:59] [data] Shuffling data
[2023-07-23 00:06:59] [data] Done reading 20,192 sentences
[2023-07-23 00:06:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:10:24] Seen 20,192 samples
[2023-07-23 00:10:24] Starting data epoch 195 in logical epoch 195
[2023-07-23 00:10:24] [data] Shuffling data
[2023-07-23 00:10:24] [data] Done reading 20,192 sentences
[2023-07-23 00:10:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:13:51] Seen 20,192 samples
[2023-07-23 00:13:51] Starting data epoch 196 in logical epoch 196
[2023-07-23 00:13:51] [data] Shuffling data
[2023-07-23 00:13:51] [data] Done reading 20,192 sentences
[2023-07-23 00:13:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:17:20] Seen 20,192 samples
[2023-07-23 00:17:20] Starting data epoch 197 in logical epoch 197
[2023-07-23 00:17:20] [data] Shuffling data
[2023-07-23 00:17:20] [data] Done reading 20,192 sentences
[2023-07-23 00:17:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:20:45] Seen 20,192 samples
[2023-07-23 00:20:45] Starting data epoch 198 in logical epoch 198
[2023-07-23 00:20:45] [data] Shuffling data
[2023-07-23 00:20:45] [data] Done reading 20,192 sentences
[2023-07-23 00:20:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:24:15] Seen 20,192 samples
[2023-07-23 00:24:15] Starting data epoch 199 in logical epoch 199
[2023-07-23 00:24:15] [data] Shuffling data
[2023-07-23 00:24:15] [data] Done reading 20,192 sentences
[2023-07-23 00:24:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:27:41] Seen 20,192 samples
[2023-07-23 00:27:41] Starting data epoch 200 in logical epoch 200
[2023-07-23 00:27:41] [data] Shuffling data
[2023-07-23 00:27:41] [data] Done reading 20,192 sentences
[2023-07-23 00:27:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-23 00:31:12] Seen 20,192 samples
[2023-07-23 00:31:12] Starting data epoch 201 in logical epoch 201
[2023-07-23 00:31:12] Training finished
[2023-07-23 00:31:29] [valid] Ep. 201 : Up. 5798 : cross-entropy : 133.276 : stalled 2 times (last best: 132.096)
[2023-07-23 00:33:58] [valid] Ep. 201 : Up. 5798 : translation : 0 : new best
[2023-07-23 00:33:58] Saving model to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz
[2023-07-23 00:34:01] Saving Adam parameters
[2023-07-23 00:34:02] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz and /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_gru.npz.optimizer.npz
[2023-07-23 00:34:11] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:11] [marian] Running on node23.datos.cluster.uy as process 6595 with command line:
[2023-07-23 00:34:11] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:11] [config] after: 0e
[2023-07-23 00:34:11] [config] after-batches: 0
[2023-07-23 00:34:11] [config] after-epochs: 10
[2023-07-23 00:34:11] [config] all-caps-every: 0
[2023-07-23 00:34:11] [config] allow-unk: false
[2023-07-23 00:34:11] [config] authors: false
[2023-07-23 00:34:11] [config] beam-size: 12
[2023-07-23 00:34:11] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:11] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:11] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:11] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:11] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:11] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:11] [config] build-info: ""
[2023-07-23 00:34:11] [config] check-gradient-nan: false
[2023-07-23 00:34:11] [config] check-nan: false
[2023-07-23 00:34:11] [config] cite: false
[2023-07-23 00:34:11] [config] clip-norm: 1
[2023-07-23 00:34:11] [config] cost-scaling:
[2023-07-23 00:34:11] [config]   - 256.f
[2023-07-23 00:34:11] [config]   - 1000
[2023-07-23 00:34:11] [config]   - 2.f
[2023-07-23 00:34:11] [config]   - 256.f
[2023-07-23 00:34:11] [config] cost-type: ce-sum
[2023-07-23 00:34:11] [config] cpu-threads: 0
[2023-07-23 00:34:11] [config] data-threads: 8
[2023-07-23 00:34:11] [config] data-weighting: ""
[2023-07-23 00:34:11] [config] data-weighting-type: sentence
[2023-07-23 00:34:11] [config] dec-cell: gru
[2023-07-23 00:34:11] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:11] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:11] [config] dec-depth: 1
[2023-07-23 00:34:11] [config] devices:
[2023-07-23 00:34:11] [config]   - 0
[2023-07-23 00:34:11] [config] dim-emb: 512
[2023-07-23 00:34:11] [config] dim-rnn: 1024
[2023-07-23 00:34:11] [config] dim-vocabs:
[2023-07-23 00:34:11] [config]   - 16384
[2023-07-23 00:34:11] [config]   - 16384
[2023-07-23 00:34:11] [config] disp-first: 0
[2023-07-23 00:34:11] [config] disp-freq: 1000u
[2023-07-23 00:34:11] [config] disp-label-counts: true
[2023-07-23 00:34:11] [config] dropout-rnn: 0
[2023-07-23 00:34:11] [config] dropout-src: 0
[2023-07-23 00:34:11] [config] dropout-trg: 0
[2023-07-23 00:34:11] [config] dump-config: ""
[2023-07-23 00:34:11] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] early-stopping: 200
[2023-07-23 00:34:11] [config] early-stopping-on: first
[2023-07-23 00:34:11] [config] embedding-fix-src: false
[2023-07-23 00:34:11] [config] embedding-fix-trg: false
[2023-07-23 00:34:11] [config] embedding-normalization: false
[2023-07-23 00:34:11] [config] embedding-vectors:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] enc-cell: lstm
[2023-07-23 00:34:11] [config] enc-cell-depth: 1
[2023-07-23 00:34:11] [config] enc-depth: 1
[2023-07-23 00:34:11] [config] enc-type: bidirectional
[2023-07-23 00:34:11] [config] english-title-case-every: 0
[2023-07-23 00:34:11] [config] exponential-smoothing: 0
[2023-07-23 00:34:11] [config] factor-weight: 1
[2023-07-23 00:34:11] [config] factors-combine: sum
[2023-07-23 00:34:11] [config] factors-dim-emb: 0
[2023-07-23 00:34:11] [config] gradient-checkpointing: false
[2023-07-23 00:34:11] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:11] [config] guided-alignment: none
[2023-07-23 00:34:11] [config] guided-alignment-cost: mse
[2023-07-23 00:34:11] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:11] [config] ignore-model-config: false
[2023-07-23 00:34:11] [config] input-types:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] interpolate-env-vars: false
[2023-07-23 00:34:11] [config] keep-best: false
[2023-07-23 00:34:11] [config] label-smoothing: 0
[2023-07-23 00:34:11] [config] layer-normalization: false
[2023-07-23 00:34:11] [config] learn-rate: 0.0001
[2023-07-23 00:34:11] [config] lemma-dependency: ""
[2023-07-23 00:34:11] [config] lemma-dim-emb: 0
[2023-07-23 00:34:11] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:11] [config] log-level: info
[2023-07-23 00:34:11] [config] log-time-zone: ""
[2023-07-23 00:34:11] [config] logical-epoch:
[2023-07-23 00:34:11] [config]   - 1e
[2023-07-23 00:34:11] [config]   - 0
[2023-07-23 00:34:11] [config] lr-decay: 0
[2023-07-23 00:34:11] [config] lr-decay-freq: 50000
[2023-07-23 00:34:11] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:11] [config]   - 0
[2023-07-23 00:34:11] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:11] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:11] [config] lr-decay-start:
[2023-07-23 00:34:11] [config]   - 10
[2023-07-23 00:34:11] [config]   - 1
[2023-07-23 00:34:11] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:11] [config] lr-report: false
[2023-07-23 00:34:11] [config] lr-warmup: 0
[2023-07-23 00:34:11] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:11] [config] lr-warmup-cycle: false
[2023-07-23 00:34:11] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:11] [config] max-length: 50
[2023-07-23 00:34:11] [config] max-length-crop: true
[2023-07-23 00:34:11] [config] max-length-factor: 3
[2023-07-23 00:34:11] [config] maxi-batch: 100
[2023-07-23 00:34:11] [config] maxi-batch-sort: trg
[2023-07-23 00:34:11] [config] mini-batch: 64
[2023-07-23 00:34:11] [config] mini-batch-fit: true
[2023-07-23 00:34:11] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:11] [config] mini-batch-round-up: true
[2023-07-23 00:34:11] [config] mini-batch-track-lr: false
[2023-07-23 00:34:11] [config] mini-batch-warmup: 0
[2023-07-23 00:34:11] [config] mini-batch-words: 0
[2023-07-23 00:34:11] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:11] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:11] [config] multi-loss-type: sum
[2023-07-23 00:34:11] [config] n-best: false
[2023-07-23 00:34:11] [config] no-nccl: false
[2023-07-23 00:34:11] [config] no-reload: false
[2023-07-23 00:34:11] [config] no-restore-corpus: false
[2023-07-23 00:34:11] [config] normalize: 0
[2023-07-23 00:34:11] [config] normalize-gradient: false
[2023-07-23 00:34:11] [config] num-devices: 0
[2023-07-23 00:34:11] [config] optimizer: adam
[2023-07-23 00:34:11] [config] optimizer-delay: 1
[2023-07-23 00:34:11] [config] optimizer-params:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] output-omit-bias: false
[2023-07-23 00:34:11] [config] overwrite: true
[2023-07-23 00:34:11] [config] precision:
[2023-07-23 00:34:11] [config]   - float16
[2023-07-23 00:34:11] [config]   - float32
[2023-07-23 00:34:11] [config] pretrained-model: ""
[2023-07-23 00:34:11] [config] quantize-biases: false
[2023-07-23 00:34:11] [config] quantize-bits: 0
[2023-07-23 00:34:11] [config] quantize-log-based: false
[2023-07-23 00:34:11] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:11] [config] quiet: false
[2023-07-23 00:34:11] [config] quiet-translation: true
[2023-07-23 00:34:11] [config] relative-paths: false
[2023-07-23 00:34:11] [config] right-left: false
[2023-07-23 00:34:11] [config] save-freq: 10000u
[2023-07-23 00:34:11] [config] seed: 1234
[2023-07-23 00:34:11] [config] sentencepiece-alphas:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:11] [config] sentencepiece-options: ""
[2023-07-23 00:34:11] [config] sharding: global
[2023-07-23 00:34:11] [config] shuffle: data
[2023-07-23 00:34:11] [config] shuffle-in-ram: false
[2023-07-23 00:34:11] [config] sigterm: save-and-exit
[2023-07-23 00:34:11] [config] skip: false
[2023-07-23 00:34:11] [config] sqlite: ""
[2023-07-23 00:34:11] [config] sqlite-drop: false
[2023-07-23 00:34:11] [config] sync-freq: 200u
[2023-07-23 00:34:11] [config] sync-sgd: false
[2023-07-23 00:34:11] [config] tempdir: /tmp
[2023-07-23 00:34:11] [config] tied-embeddings: false
[2023-07-23 00:34:11] [config] tied-embeddings-all: true
[2023-07-23 00:34:11] [config] tied-embeddings-src: false
[2023-07-23 00:34:11] [config] train-embedder-rank:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] train-sets:
[2023-07-23 00:34:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:11] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:11] [config] transformer-aan-activation: swish
[2023-07-23 00:34:11] [config] transformer-aan-depth: 2
[2023-07-23 00:34:11] [config] transformer-aan-nogate: false
[2023-07-23 00:34:11] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:11] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:11] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:11] [config] transformer-depth-scaling: false
[2023-07-23 00:34:11] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:11] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:11] [config] transformer-dropout: 0
[2023-07-23 00:34:11] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:11] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:11] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:11] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:11] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:11] [config] transformer-heads: 8
[2023-07-23 00:34:11] [config] transformer-no-projection: false
[2023-07-23 00:34:11] [config] transformer-pool: false
[2023-07-23 00:34:11] [config] transformer-postprocess: dan
[2023-07-23 00:34:11] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:11] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:11] [config] transformer-preprocess: ""
[2023-07-23 00:34:11] [config] transformer-tied-layers:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:11] [config] tsv: false
[2023-07-23 00:34:11] [config] tsv-fields: 0
[2023-07-23 00:34:11] [config] type: amun
[2023-07-23 00:34:11] [config] ulr: false
[2023-07-23 00:34:11] [config] ulr-dim-emb: 0
[2023-07-23 00:34:11] [config] ulr-dropout: 0
[2023-07-23 00:34:11] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:11] [config] ulr-query-vectors: ""
[2023-07-23 00:34:11] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:11] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:11] [config] unlikelihood-loss: false
[2023-07-23 00:34:11] [config] valid-freq: 50000000
[2023-07-23 00:34:11] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:11] [config] valid-max-length: 1000
[2023-07-23 00:34:11] [config] valid-metrics:
[2023-07-23 00:34:11] [config]   - cross-entropy
[2023-07-23 00:34:11] [config]   - translation
[2023-07-23 00:34:11] [config] valid-mini-batch: 32
[2023-07-23 00:34:11] [config] valid-reset-stalled: false
[2023-07-23 00:34:11] [config] valid-script-args:
[2023-07-23 00:34:11] [config]   []
[2023-07-23 00:34:11] [config] valid-script-path: ""
[2023-07-23 00:34:11] [config] valid-sets:
[2023-07-23 00:34:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:11] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:11] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:11] [config] vocabs:
[2023-07-23 00:34:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:11] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:11] [config] word-penalty: 0
[2023-07-23 00:34:11] [config] word-scores: false
[2023-07-23 00:34:11] [config] workspace: 5500
[2023-07-23 00:34:11] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:11] [training] Using single-device training
[2023-07-23 00:34:11] Synced seed 1234
[2023-07-23 00:34:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:13] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:13] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55952e319692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55952e25ada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55952e25f1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55952e2662ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55952e412a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55952e413a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55952e3ecbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55952deee108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55952de102c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55952ddc7b9c]    main                                               + 0x3c
[0x7f153d4380b3]    __libc_start_main                                  + 0xf3
[0x55952de0ecbe]    _start                                             + 0x2e

[2023-07-23 00:34:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:16] [marian] Running on node23.datos.cluster.uy as process 6622 with command line:
[2023-07-23 00:34:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:16] [config] after: 0e
[2023-07-23 00:34:16] [config] after-batches: 0
[2023-07-23 00:34:16] [config] after-epochs: 20
[2023-07-23 00:34:16] [config] all-caps-every: 0
[2023-07-23 00:34:16] [config] allow-unk: false
[2023-07-23 00:34:16] [config] authors: false
[2023-07-23 00:34:16] [config] beam-size: 12
[2023-07-23 00:34:16] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:16] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:16] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:16] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:16] [config] build-info: ""
[2023-07-23 00:34:16] [config] check-gradient-nan: false
[2023-07-23 00:34:16] [config] check-nan: false
[2023-07-23 00:34:16] [config] cite: false
[2023-07-23 00:34:16] [config] clip-norm: 1
[2023-07-23 00:34:16] [config] cost-scaling:
[2023-07-23 00:34:16] [config]   - 256.f
[2023-07-23 00:34:16] [config]   - 1000
[2023-07-23 00:34:16] [config]   - 2.f
[2023-07-23 00:34:16] [config]   - 256.f
[2023-07-23 00:34:16] [config] cost-type: ce-sum
[2023-07-23 00:34:16] [config] cpu-threads: 0
[2023-07-23 00:34:16] [config] data-threads: 8
[2023-07-23 00:34:16] [config] data-weighting: ""
[2023-07-23 00:34:16] [config] data-weighting-type: sentence
[2023-07-23 00:34:16] [config] dec-cell: gru
[2023-07-23 00:34:16] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:16] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:16] [config] dec-depth: 1
[2023-07-23 00:34:16] [config] devices:
[2023-07-23 00:34:16] [config]   - 0
[2023-07-23 00:34:16] [config] dim-emb: 512
[2023-07-23 00:34:16] [config] dim-rnn: 1024
[2023-07-23 00:34:16] [config] dim-vocabs:
[2023-07-23 00:34:16] [config]   - 16384
[2023-07-23 00:34:16] [config]   - 16384
[2023-07-23 00:34:16] [config] disp-first: 0
[2023-07-23 00:34:16] [config] disp-freq: 1000u
[2023-07-23 00:34:16] [config] disp-label-counts: true
[2023-07-23 00:34:16] [config] dropout-rnn: 0
[2023-07-23 00:34:16] [config] dropout-src: 0
[2023-07-23 00:34:16] [config] dropout-trg: 0
[2023-07-23 00:34:16] [config] dump-config: ""
[2023-07-23 00:34:16] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] early-stopping: 200
[2023-07-23 00:34:16] [config] early-stopping-on: first
[2023-07-23 00:34:16] [config] embedding-fix-src: false
[2023-07-23 00:34:16] [config] embedding-fix-trg: false
[2023-07-23 00:34:16] [config] embedding-normalization: false
[2023-07-23 00:34:16] [config] embedding-vectors:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] enc-cell: lstm
[2023-07-23 00:34:16] [config] enc-cell-depth: 1
[2023-07-23 00:34:16] [config] enc-depth: 1
[2023-07-23 00:34:16] [config] enc-type: bidirectional
[2023-07-23 00:34:16] [config] english-title-case-every: 0
[2023-07-23 00:34:16] [config] exponential-smoothing: 0
[2023-07-23 00:34:16] [config] factor-weight: 1
[2023-07-23 00:34:16] [config] factors-combine: sum
[2023-07-23 00:34:16] [config] factors-dim-emb: 0
[2023-07-23 00:34:16] [config] gradient-checkpointing: false
[2023-07-23 00:34:16] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:16] [config] guided-alignment: none
[2023-07-23 00:34:16] [config] guided-alignment-cost: mse
[2023-07-23 00:34:16] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:16] [config] ignore-model-config: false
[2023-07-23 00:34:16] [config] input-types:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] interpolate-env-vars: false
[2023-07-23 00:34:16] [config] keep-best: false
[2023-07-23 00:34:16] [config] label-smoothing: 0
[2023-07-23 00:34:16] [config] layer-normalization: false
[2023-07-23 00:34:16] [config] learn-rate: 0.0001
[2023-07-23 00:34:16] [config] lemma-dependency: ""
[2023-07-23 00:34:16] [config] lemma-dim-emb: 0
[2023-07-23 00:34:16] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:16] [config] log-level: info
[2023-07-23 00:34:16] [config] log-time-zone: ""
[2023-07-23 00:34:16] [config] logical-epoch:
[2023-07-23 00:34:16] [config]   - 1e
[2023-07-23 00:34:16] [config]   - 0
[2023-07-23 00:34:16] [config] lr-decay: 0
[2023-07-23 00:34:16] [config] lr-decay-freq: 50000
[2023-07-23 00:34:16] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:16] [config]   - 0
[2023-07-23 00:34:16] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:16] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:16] [config] lr-decay-start:
[2023-07-23 00:34:16] [config]   - 10
[2023-07-23 00:34:16] [config]   - 1
[2023-07-23 00:34:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:16] [config] lr-report: false
[2023-07-23 00:34:16] [config] lr-warmup: 0
[2023-07-23 00:34:16] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:16] [config] lr-warmup-cycle: false
[2023-07-23 00:34:16] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:16] [config] max-length: 50
[2023-07-23 00:34:16] [config] max-length-crop: true
[2023-07-23 00:34:16] [config] max-length-factor: 3
[2023-07-23 00:34:16] [config] maxi-batch: 100
[2023-07-23 00:34:16] [config] maxi-batch-sort: trg
[2023-07-23 00:34:16] [config] mini-batch: 64
[2023-07-23 00:34:16] [config] mini-batch-fit: true
[2023-07-23 00:34:16] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:16] [config] mini-batch-round-up: true
[2023-07-23 00:34:16] [config] mini-batch-track-lr: false
[2023-07-23 00:34:16] [config] mini-batch-warmup: 0
[2023-07-23 00:34:16] [config] mini-batch-words: 0
[2023-07-23 00:34:16] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:16] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:16] [config] multi-loss-type: sum
[2023-07-23 00:34:16] [config] n-best: false
[2023-07-23 00:34:16] [config] no-nccl: false
[2023-07-23 00:34:16] [config] no-reload: false
[2023-07-23 00:34:16] [config] no-restore-corpus: false
[2023-07-23 00:34:16] [config] normalize: 0
[2023-07-23 00:34:16] [config] normalize-gradient: false
[2023-07-23 00:34:16] [config] num-devices: 0
[2023-07-23 00:34:16] [config] optimizer: adam
[2023-07-23 00:34:16] [config] optimizer-delay: 1
[2023-07-23 00:34:16] [config] optimizer-params:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] output-omit-bias: false
[2023-07-23 00:34:16] [config] overwrite: true
[2023-07-23 00:34:16] [config] precision:
[2023-07-23 00:34:16] [config]   - float16
[2023-07-23 00:34:16] [config]   - float32
[2023-07-23 00:34:16] [config] pretrained-model: ""
[2023-07-23 00:34:16] [config] quantize-biases: false
[2023-07-23 00:34:16] [config] quantize-bits: 0
[2023-07-23 00:34:16] [config] quantize-log-based: false
[2023-07-23 00:34:16] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:16] [config] quiet: false
[2023-07-23 00:34:16] [config] quiet-translation: true
[2023-07-23 00:34:16] [config] relative-paths: false
[2023-07-23 00:34:16] [config] right-left: false
[2023-07-23 00:34:16] [config] save-freq: 10000u
[2023-07-23 00:34:16] [config] seed: 1234
[2023-07-23 00:34:16] [config] sentencepiece-alphas:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:16] [config] sentencepiece-options: ""
[2023-07-23 00:34:16] [config] sharding: global
[2023-07-23 00:34:16] [config] shuffle: data
[2023-07-23 00:34:16] [config] shuffle-in-ram: false
[2023-07-23 00:34:16] [config] sigterm: save-and-exit
[2023-07-23 00:34:16] [config] skip: false
[2023-07-23 00:34:16] [config] sqlite: ""
[2023-07-23 00:34:16] [config] sqlite-drop: false
[2023-07-23 00:34:16] [config] sync-freq: 200u
[2023-07-23 00:34:16] [config] sync-sgd: false
[2023-07-23 00:34:16] [config] tempdir: /tmp
[2023-07-23 00:34:16] [config] tied-embeddings: false
[2023-07-23 00:34:16] [config] tied-embeddings-all: true
[2023-07-23 00:34:16] [config] tied-embeddings-src: false
[2023-07-23 00:34:16] [config] train-embedder-rank:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] train-sets:
[2023-07-23 00:34:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:16] [config] transformer-aan-activation: swish
[2023-07-23 00:34:16] [config] transformer-aan-depth: 2
[2023-07-23 00:34:16] [config] transformer-aan-nogate: false
[2023-07-23 00:34:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:16] [config] transformer-depth-scaling: false
[2023-07-23 00:34:16] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:16] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:16] [config] transformer-dropout: 0
[2023-07-23 00:34:16] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:16] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:16] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:16] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:16] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:16] [config] transformer-heads: 8
[2023-07-23 00:34:16] [config] transformer-no-projection: false
[2023-07-23 00:34:16] [config] transformer-pool: false
[2023-07-23 00:34:16] [config] transformer-postprocess: dan
[2023-07-23 00:34:16] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:16] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:16] [config] transformer-preprocess: ""
[2023-07-23 00:34:16] [config] transformer-tied-layers:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:16] [config] tsv: false
[2023-07-23 00:34:16] [config] tsv-fields: 0
[2023-07-23 00:34:16] [config] type: amun
[2023-07-23 00:34:16] [config] ulr: false
[2023-07-23 00:34:16] [config] ulr-dim-emb: 0
[2023-07-23 00:34:16] [config] ulr-dropout: 0
[2023-07-23 00:34:16] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:16] [config] ulr-query-vectors: ""
[2023-07-23 00:34:16] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:16] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:16] [config] unlikelihood-loss: false
[2023-07-23 00:34:16] [config] valid-freq: 50000000
[2023-07-23 00:34:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:16] [config] valid-max-length: 1000
[2023-07-23 00:34:16] [config] valid-metrics:
[2023-07-23 00:34:16] [config]   - cross-entropy
[2023-07-23 00:34:16] [config]   - translation
[2023-07-23 00:34:16] [config] valid-mini-batch: 32
[2023-07-23 00:34:16] [config] valid-reset-stalled: false
[2023-07-23 00:34:16] [config] valid-script-args:
[2023-07-23 00:34:16] [config]   []
[2023-07-23 00:34:16] [config] valid-script-path: ""
[2023-07-23 00:34:16] [config] valid-sets:
[2023-07-23 00:34:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:16] [config] vocabs:
[2023-07-23 00:34:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:16] [config] word-penalty: 0
[2023-07-23 00:34:16] [config] word-scores: false
[2023-07-23 00:34:16] [config] workspace: 5500
[2023-07-23 00:34:16] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:16] [training] Using single-device training
[2023-07-23 00:34:16] Synced seed 1234
[2023-07-23 00:34:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:18] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:18] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55e278cad692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55e278beeda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55e278bf31a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55e278bfa2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55e278da6a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55e278da7a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55e278d80bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55e278882108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55e2787a42c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55e27875bb9c]    main                                               + 0x3c
[0x7fe8b3b7e0b3]    __libc_start_main                                  + 0xf3
[0x55e2787a2cbe]    _start                                             + 0x2e

[2023-07-23 00:34:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:21] [marian] Running on node23.datos.cluster.uy as process 6649 with command line:
[2023-07-23 00:34:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:21] [config] after: 0e
[2023-07-23 00:34:21] [config] after-batches: 0
[2023-07-23 00:34:21] [config] after-epochs: 30
[2023-07-23 00:34:21] [config] all-caps-every: 0
[2023-07-23 00:34:21] [config] allow-unk: false
[2023-07-23 00:34:21] [config] authors: false
[2023-07-23 00:34:21] [config] beam-size: 12
[2023-07-23 00:34:21] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:21] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:21] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:21] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:21] [config] build-info: ""
[2023-07-23 00:34:21] [config] check-gradient-nan: false
[2023-07-23 00:34:21] [config] check-nan: false
[2023-07-23 00:34:21] [config] cite: false
[2023-07-23 00:34:21] [config] clip-norm: 1
[2023-07-23 00:34:21] [config] cost-scaling:
[2023-07-23 00:34:21] [config]   - 256.f
[2023-07-23 00:34:21] [config]   - 1000
[2023-07-23 00:34:21] [config]   - 2.f
[2023-07-23 00:34:21] [config]   - 256.f
[2023-07-23 00:34:21] [config] cost-type: ce-sum
[2023-07-23 00:34:21] [config] cpu-threads: 0
[2023-07-23 00:34:21] [config] data-threads: 8
[2023-07-23 00:34:21] [config] data-weighting: ""
[2023-07-23 00:34:21] [config] data-weighting-type: sentence
[2023-07-23 00:34:21] [config] dec-cell: gru
[2023-07-23 00:34:21] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:21] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:21] [config] dec-depth: 1
[2023-07-23 00:34:21] [config] devices:
[2023-07-23 00:34:21] [config]   - 0
[2023-07-23 00:34:21] [config] dim-emb: 512
[2023-07-23 00:34:21] [config] dim-rnn: 1024
[2023-07-23 00:34:21] [config] dim-vocabs:
[2023-07-23 00:34:21] [config]   - 16384
[2023-07-23 00:34:21] [config]   - 16384
[2023-07-23 00:34:21] [config] disp-first: 0
[2023-07-23 00:34:21] [config] disp-freq: 1000u
[2023-07-23 00:34:21] [config] disp-label-counts: true
[2023-07-23 00:34:21] [config] dropout-rnn: 0
[2023-07-23 00:34:21] [config] dropout-src: 0
[2023-07-23 00:34:21] [config] dropout-trg: 0
[2023-07-23 00:34:21] [config] dump-config: ""
[2023-07-23 00:34:21] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] early-stopping: 200
[2023-07-23 00:34:21] [config] early-stopping-on: first
[2023-07-23 00:34:21] [config] embedding-fix-src: false
[2023-07-23 00:34:21] [config] embedding-fix-trg: false
[2023-07-23 00:34:21] [config] embedding-normalization: false
[2023-07-23 00:34:21] [config] embedding-vectors:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] enc-cell: lstm
[2023-07-23 00:34:21] [config] enc-cell-depth: 1
[2023-07-23 00:34:21] [config] enc-depth: 1
[2023-07-23 00:34:21] [config] enc-type: bidirectional
[2023-07-23 00:34:21] [config] english-title-case-every: 0
[2023-07-23 00:34:21] [config] exponential-smoothing: 0
[2023-07-23 00:34:21] [config] factor-weight: 1
[2023-07-23 00:34:21] [config] factors-combine: sum
[2023-07-23 00:34:21] [config] factors-dim-emb: 0
[2023-07-23 00:34:21] [config] gradient-checkpointing: false
[2023-07-23 00:34:21] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:21] [config] guided-alignment: none
[2023-07-23 00:34:21] [config] guided-alignment-cost: mse
[2023-07-23 00:34:21] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:21] [config] ignore-model-config: false
[2023-07-23 00:34:21] [config] input-types:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] interpolate-env-vars: false
[2023-07-23 00:34:21] [config] keep-best: false
[2023-07-23 00:34:21] [config] label-smoothing: 0
[2023-07-23 00:34:21] [config] layer-normalization: false
[2023-07-23 00:34:21] [config] learn-rate: 0.0001
[2023-07-23 00:34:21] [config] lemma-dependency: ""
[2023-07-23 00:34:21] [config] lemma-dim-emb: 0
[2023-07-23 00:34:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:21] [config] log-level: info
[2023-07-23 00:34:21] [config] log-time-zone: ""
[2023-07-23 00:34:21] [config] logical-epoch:
[2023-07-23 00:34:21] [config]   - 1e
[2023-07-23 00:34:21] [config]   - 0
[2023-07-23 00:34:21] [config] lr-decay: 0
[2023-07-23 00:34:21] [config] lr-decay-freq: 50000
[2023-07-23 00:34:21] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:21] [config]   - 0
[2023-07-23 00:34:21] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:21] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:21] [config] lr-decay-start:
[2023-07-23 00:34:21] [config]   - 10
[2023-07-23 00:34:21] [config]   - 1
[2023-07-23 00:34:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:21] [config] lr-report: false
[2023-07-23 00:34:21] [config] lr-warmup: 0
[2023-07-23 00:34:21] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:21] [config] lr-warmup-cycle: false
[2023-07-23 00:34:21] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:21] [config] max-length: 50
[2023-07-23 00:34:21] [config] max-length-crop: true
[2023-07-23 00:34:21] [config] max-length-factor: 3
[2023-07-23 00:34:21] [config] maxi-batch: 100
[2023-07-23 00:34:21] [config] maxi-batch-sort: trg
[2023-07-23 00:34:21] [config] mini-batch: 64
[2023-07-23 00:34:21] [config] mini-batch-fit: true
[2023-07-23 00:34:21] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:21] [config] mini-batch-round-up: true
[2023-07-23 00:34:21] [config] mini-batch-track-lr: false
[2023-07-23 00:34:21] [config] mini-batch-warmup: 0
[2023-07-23 00:34:21] [config] mini-batch-words: 0
[2023-07-23 00:34:21] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:21] [config] multi-loss-type: sum
[2023-07-23 00:34:21] [config] n-best: false
[2023-07-23 00:34:21] [config] no-nccl: false
[2023-07-23 00:34:21] [config] no-reload: false
[2023-07-23 00:34:21] [config] no-restore-corpus: false
[2023-07-23 00:34:21] [config] normalize: 0
[2023-07-23 00:34:21] [config] normalize-gradient: false
[2023-07-23 00:34:21] [config] num-devices: 0
[2023-07-23 00:34:21] [config] optimizer: adam
[2023-07-23 00:34:21] [config] optimizer-delay: 1
[2023-07-23 00:34:21] [config] optimizer-params:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] output-omit-bias: false
[2023-07-23 00:34:21] [config] overwrite: true
[2023-07-23 00:34:21] [config] precision:
[2023-07-23 00:34:21] [config]   - float16
[2023-07-23 00:34:21] [config]   - float32
[2023-07-23 00:34:21] [config] pretrained-model: ""
[2023-07-23 00:34:21] [config] quantize-biases: false
[2023-07-23 00:34:21] [config] quantize-bits: 0
[2023-07-23 00:34:21] [config] quantize-log-based: false
[2023-07-23 00:34:21] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:21] [config] quiet: false
[2023-07-23 00:34:21] [config] quiet-translation: true
[2023-07-23 00:34:21] [config] relative-paths: false
[2023-07-23 00:34:21] [config] right-left: false
[2023-07-23 00:34:21] [config] save-freq: 10000u
[2023-07-23 00:34:21] [config] seed: 1234
[2023-07-23 00:34:21] [config] sentencepiece-alphas:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:21] [config] sentencepiece-options: ""
[2023-07-23 00:34:21] [config] sharding: global
[2023-07-23 00:34:21] [config] shuffle: data
[2023-07-23 00:34:21] [config] shuffle-in-ram: false
[2023-07-23 00:34:21] [config] sigterm: save-and-exit
[2023-07-23 00:34:21] [config] skip: false
[2023-07-23 00:34:21] [config] sqlite: ""
[2023-07-23 00:34:21] [config] sqlite-drop: false
[2023-07-23 00:34:21] [config] sync-freq: 200u
[2023-07-23 00:34:21] [config] sync-sgd: false
[2023-07-23 00:34:21] [config] tempdir: /tmp
[2023-07-23 00:34:21] [config] tied-embeddings: false
[2023-07-23 00:34:21] [config] tied-embeddings-all: true
[2023-07-23 00:34:21] [config] tied-embeddings-src: false
[2023-07-23 00:34:21] [config] train-embedder-rank:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] train-sets:
[2023-07-23 00:34:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:21] [config] transformer-aan-activation: swish
[2023-07-23 00:34:21] [config] transformer-aan-depth: 2
[2023-07-23 00:34:21] [config] transformer-aan-nogate: false
[2023-07-23 00:34:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:21] [config] transformer-depth-scaling: false
[2023-07-23 00:34:21] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:21] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:21] [config] transformer-dropout: 0
[2023-07-23 00:34:21] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:21] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:21] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:21] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:21] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:21] [config] transformer-heads: 8
[2023-07-23 00:34:21] [config] transformer-no-projection: false
[2023-07-23 00:34:21] [config] transformer-pool: false
[2023-07-23 00:34:21] [config] transformer-postprocess: dan
[2023-07-23 00:34:21] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:21] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:21] [config] transformer-preprocess: ""
[2023-07-23 00:34:21] [config] transformer-tied-layers:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:21] [config] tsv: false
[2023-07-23 00:34:21] [config] tsv-fields: 0
[2023-07-23 00:34:21] [config] type: amun
[2023-07-23 00:34:21] [config] ulr: false
[2023-07-23 00:34:21] [config] ulr-dim-emb: 0
[2023-07-23 00:34:21] [config] ulr-dropout: 0
[2023-07-23 00:34:21] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:21] [config] ulr-query-vectors: ""
[2023-07-23 00:34:21] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:21] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:21] [config] unlikelihood-loss: false
[2023-07-23 00:34:21] [config] valid-freq: 50000000
[2023-07-23 00:34:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:21] [config] valid-max-length: 1000
[2023-07-23 00:34:21] [config] valid-metrics:
[2023-07-23 00:34:21] [config]   - cross-entropy
[2023-07-23 00:34:21] [config]   - translation
[2023-07-23 00:34:21] [config] valid-mini-batch: 32
[2023-07-23 00:34:21] [config] valid-reset-stalled: false
[2023-07-23 00:34:21] [config] valid-script-args:
[2023-07-23 00:34:21] [config]   []
[2023-07-23 00:34:21] [config] valid-script-path: ""
[2023-07-23 00:34:21] [config] valid-sets:
[2023-07-23 00:34:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:21] [config] vocabs:
[2023-07-23 00:34:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:21] [config] word-penalty: 0
[2023-07-23 00:34:21] [config] word-scores: false
[2023-07-23 00:34:21] [config] workspace: 5500
[2023-07-23 00:34:21] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:21] [training] Using single-device training
[2023-07-23 00:34:21] Synced seed 1234
[2023-07-23 00:34:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:23] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:23] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x560fabe32692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x560fabd73da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x560fabd781a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x560fabd7f2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x560fabf2ba0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x560fabf2ca53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x560fabf05bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x560faba07108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x560fab9292c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x560fab8e0b9c]    main                                               + 0x3c
[0x7f47406230b3]    __libc_start_main                                  + 0xf3
[0x560fab927cbe]    _start                                             + 0x2e

[2023-07-23 00:34:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:27] [marian] Running on node23.datos.cluster.uy as process 6678 with command line:
[2023-07-23 00:34:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:27] [config] after: 0e
[2023-07-23 00:34:27] [config] after-batches: 0
[2023-07-23 00:34:27] [config] after-epochs: 40
[2023-07-23 00:34:27] [config] all-caps-every: 0
[2023-07-23 00:34:27] [config] allow-unk: false
[2023-07-23 00:34:27] [config] authors: false
[2023-07-23 00:34:27] [config] beam-size: 12
[2023-07-23 00:34:27] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:27] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:27] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:27] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:27] [config] build-info: ""
[2023-07-23 00:34:27] [config] check-gradient-nan: false
[2023-07-23 00:34:27] [config] check-nan: false
[2023-07-23 00:34:27] [config] cite: false
[2023-07-23 00:34:27] [config] clip-norm: 1
[2023-07-23 00:34:27] [config] cost-scaling:
[2023-07-23 00:34:27] [config]   - 256.f
[2023-07-23 00:34:27] [config]   - 1000
[2023-07-23 00:34:27] [config]   - 2.f
[2023-07-23 00:34:27] [config]   - 256.f
[2023-07-23 00:34:27] [config] cost-type: ce-sum
[2023-07-23 00:34:27] [config] cpu-threads: 0
[2023-07-23 00:34:27] [config] data-threads: 8
[2023-07-23 00:34:27] [config] data-weighting: ""
[2023-07-23 00:34:27] [config] data-weighting-type: sentence
[2023-07-23 00:34:27] [config] dec-cell: gru
[2023-07-23 00:34:27] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:27] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:27] [config] dec-depth: 1
[2023-07-23 00:34:27] [config] devices:
[2023-07-23 00:34:27] [config]   - 0
[2023-07-23 00:34:27] [config] dim-emb: 512
[2023-07-23 00:34:27] [config] dim-rnn: 1024
[2023-07-23 00:34:27] [config] dim-vocabs:
[2023-07-23 00:34:27] [config]   - 16384
[2023-07-23 00:34:27] [config]   - 16384
[2023-07-23 00:34:27] [config] disp-first: 0
[2023-07-23 00:34:27] [config] disp-freq: 1000u
[2023-07-23 00:34:27] [config] disp-label-counts: true
[2023-07-23 00:34:27] [config] dropout-rnn: 0
[2023-07-23 00:34:27] [config] dropout-src: 0
[2023-07-23 00:34:27] [config] dropout-trg: 0
[2023-07-23 00:34:27] [config] dump-config: ""
[2023-07-23 00:34:27] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] early-stopping: 200
[2023-07-23 00:34:27] [config] early-stopping-on: first
[2023-07-23 00:34:27] [config] embedding-fix-src: false
[2023-07-23 00:34:27] [config] embedding-fix-trg: false
[2023-07-23 00:34:27] [config] embedding-normalization: false
[2023-07-23 00:34:27] [config] embedding-vectors:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] enc-cell: lstm
[2023-07-23 00:34:27] [config] enc-cell-depth: 1
[2023-07-23 00:34:27] [config] enc-depth: 1
[2023-07-23 00:34:27] [config] enc-type: bidirectional
[2023-07-23 00:34:27] [config] english-title-case-every: 0
[2023-07-23 00:34:27] [config] exponential-smoothing: 0
[2023-07-23 00:34:27] [config] factor-weight: 1
[2023-07-23 00:34:27] [config] factors-combine: sum
[2023-07-23 00:34:27] [config] factors-dim-emb: 0
[2023-07-23 00:34:27] [config] gradient-checkpointing: false
[2023-07-23 00:34:27] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:27] [config] guided-alignment: none
[2023-07-23 00:34:27] [config] guided-alignment-cost: mse
[2023-07-23 00:34:27] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:27] [config] ignore-model-config: false
[2023-07-23 00:34:27] [config] input-types:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] interpolate-env-vars: false
[2023-07-23 00:34:27] [config] keep-best: false
[2023-07-23 00:34:27] [config] label-smoothing: 0
[2023-07-23 00:34:27] [config] layer-normalization: false
[2023-07-23 00:34:27] [config] learn-rate: 0.0001
[2023-07-23 00:34:27] [config] lemma-dependency: ""
[2023-07-23 00:34:27] [config] lemma-dim-emb: 0
[2023-07-23 00:34:27] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:27] [config] log-level: info
[2023-07-23 00:34:27] [config] log-time-zone: ""
[2023-07-23 00:34:27] [config] logical-epoch:
[2023-07-23 00:34:27] [config]   - 1e
[2023-07-23 00:34:27] [config]   - 0
[2023-07-23 00:34:27] [config] lr-decay: 0
[2023-07-23 00:34:27] [config] lr-decay-freq: 50000
[2023-07-23 00:34:27] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:27] [config]   - 0
[2023-07-23 00:34:27] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:27] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:27] [config] lr-decay-start:
[2023-07-23 00:34:27] [config]   - 10
[2023-07-23 00:34:27] [config]   - 1
[2023-07-23 00:34:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:27] [config] lr-report: false
[2023-07-23 00:34:27] [config] lr-warmup: 0
[2023-07-23 00:34:27] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:27] [config] lr-warmup-cycle: false
[2023-07-23 00:34:27] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:27] [config] max-length: 50
[2023-07-23 00:34:27] [config] max-length-crop: true
[2023-07-23 00:34:27] [config] max-length-factor: 3
[2023-07-23 00:34:27] [config] maxi-batch: 100
[2023-07-23 00:34:27] [config] maxi-batch-sort: trg
[2023-07-23 00:34:27] [config] mini-batch: 64
[2023-07-23 00:34:27] [config] mini-batch-fit: true
[2023-07-23 00:34:27] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:27] [config] mini-batch-round-up: true
[2023-07-23 00:34:27] [config] mini-batch-track-lr: false
[2023-07-23 00:34:27] [config] mini-batch-warmup: 0
[2023-07-23 00:34:27] [config] mini-batch-words: 0
[2023-07-23 00:34:27] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:27] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:27] [config] multi-loss-type: sum
[2023-07-23 00:34:27] [config] n-best: false
[2023-07-23 00:34:27] [config] no-nccl: false
[2023-07-23 00:34:27] [config] no-reload: false
[2023-07-23 00:34:27] [config] no-restore-corpus: false
[2023-07-23 00:34:27] [config] normalize: 0
[2023-07-23 00:34:27] [config] normalize-gradient: false
[2023-07-23 00:34:27] [config] num-devices: 0
[2023-07-23 00:34:27] [config] optimizer: adam
[2023-07-23 00:34:27] [config] optimizer-delay: 1
[2023-07-23 00:34:27] [config] optimizer-params:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] output-omit-bias: false
[2023-07-23 00:34:27] [config] overwrite: true
[2023-07-23 00:34:27] [config] precision:
[2023-07-23 00:34:27] [config]   - float16
[2023-07-23 00:34:27] [config]   - float32
[2023-07-23 00:34:27] [config] pretrained-model: ""
[2023-07-23 00:34:27] [config] quantize-biases: false
[2023-07-23 00:34:27] [config] quantize-bits: 0
[2023-07-23 00:34:27] [config] quantize-log-based: false
[2023-07-23 00:34:27] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:27] [config] quiet: false
[2023-07-23 00:34:27] [config] quiet-translation: true
[2023-07-23 00:34:27] [config] relative-paths: false
[2023-07-23 00:34:27] [config] right-left: false
[2023-07-23 00:34:27] [config] save-freq: 10000u
[2023-07-23 00:34:27] [config] seed: 1234
[2023-07-23 00:34:27] [config] sentencepiece-alphas:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:27] [config] sentencepiece-options: ""
[2023-07-23 00:34:27] [config] sharding: global
[2023-07-23 00:34:27] [config] shuffle: data
[2023-07-23 00:34:27] [config] shuffle-in-ram: false
[2023-07-23 00:34:27] [config] sigterm: save-and-exit
[2023-07-23 00:34:27] [config] skip: false
[2023-07-23 00:34:27] [config] sqlite: ""
[2023-07-23 00:34:27] [config] sqlite-drop: false
[2023-07-23 00:34:27] [config] sync-freq: 200u
[2023-07-23 00:34:27] [config] sync-sgd: false
[2023-07-23 00:34:27] [config] tempdir: /tmp
[2023-07-23 00:34:27] [config] tied-embeddings: false
[2023-07-23 00:34:27] [config] tied-embeddings-all: true
[2023-07-23 00:34:27] [config] tied-embeddings-src: false
[2023-07-23 00:34:27] [config] train-embedder-rank:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] train-sets:
[2023-07-23 00:34:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:27] [config] transformer-aan-activation: swish
[2023-07-23 00:34:27] [config] transformer-aan-depth: 2
[2023-07-23 00:34:27] [config] transformer-aan-nogate: false
[2023-07-23 00:34:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:27] [config] transformer-depth-scaling: false
[2023-07-23 00:34:27] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:27] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:27] [config] transformer-dropout: 0
[2023-07-23 00:34:27] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:27] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:27] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:27] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:27] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:27] [config] transformer-heads: 8
[2023-07-23 00:34:27] [config] transformer-no-projection: false
[2023-07-23 00:34:27] [config] transformer-pool: false
[2023-07-23 00:34:27] [config] transformer-postprocess: dan
[2023-07-23 00:34:27] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:27] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:27] [config] transformer-preprocess: ""
[2023-07-23 00:34:27] [config] transformer-tied-layers:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:27] [config] tsv: false
[2023-07-23 00:34:27] [config] tsv-fields: 0
[2023-07-23 00:34:27] [config] type: amun
[2023-07-23 00:34:27] [config] ulr: false
[2023-07-23 00:34:27] [config] ulr-dim-emb: 0
[2023-07-23 00:34:27] [config] ulr-dropout: 0
[2023-07-23 00:34:27] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:27] [config] ulr-query-vectors: ""
[2023-07-23 00:34:27] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:27] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:27] [config] unlikelihood-loss: false
[2023-07-23 00:34:27] [config] valid-freq: 50000000
[2023-07-23 00:34:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:27] [config] valid-max-length: 1000
[2023-07-23 00:34:27] [config] valid-metrics:
[2023-07-23 00:34:27] [config]   - cross-entropy
[2023-07-23 00:34:27] [config]   - translation
[2023-07-23 00:34:27] [config] valid-mini-batch: 32
[2023-07-23 00:34:27] [config] valid-reset-stalled: false
[2023-07-23 00:34:27] [config] valid-script-args:
[2023-07-23 00:34:27] [config]   []
[2023-07-23 00:34:27] [config] valid-script-path: ""
[2023-07-23 00:34:27] [config] valid-sets:
[2023-07-23 00:34:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:27] [config] vocabs:
[2023-07-23 00:34:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:27] [config] word-penalty: 0
[2023-07-23 00:34:27] [config] word-scores: false
[2023-07-23 00:34:27] [config] workspace: 5500
[2023-07-23 00:34:27] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:27] [training] Using single-device training
[2023-07-23 00:34:27] Synced seed 1234
[2023-07-23 00:34:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:29] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:29] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x5591a62f8692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x5591a6239da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5591a623e1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5591a62452ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5591a63f1a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5591a63f2a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5591a63cbbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5591a5ecd108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5591a5def2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5591a5da6b9c]    main                                               + 0x3c
[0x7f01a45f30b3]    __libc_start_main                                  + 0xf3
[0x5591a5dedcbe]    _start                                             + 0x2e

[2023-07-23 00:34:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:32] [marian] Running on node23.datos.cluster.uy as process 6706 with command line:
[2023-07-23 00:34:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:32] [config] after: 0e
[2023-07-23 00:34:32] [config] after-batches: 0
[2023-07-23 00:34:32] [config] after-epochs: 50
[2023-07-23 00:34:32] [config] all-caps-every: 0
[2023-07-23 00:34:32] [config] allow-unk: false
[2023-07-23 00:34:32] [config] authors: false
[2023-07-23 00:34:32] [config] beam-size: 12
[2023-07-23 00:34:32] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:32] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:32] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:32] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:32] [config] build-info: ""
[2023-07-23 00:34:32] [config] check-gradient-nan: false
[2023-07-23 00:34:32] [config] check-nan: false
[2023-07-23 00:34:32] [config] cite: false
[2023-07-23 00:34:32] [config] clip-norm: 1
[2023-07-23 00:34:32] [config] cost-scaling:
[2023-07-23 00:34:32] [config]   - 256.f
[2023-07-23 00:34:32] [config]   - 1000
[2023-07-23 00:34:32] [config]   - 2.f
[2023-07-23 00:34:32] [config]   - 256.f
[2023-07-23 00:34:32] [config] cost-type: ce-sum
[2023-07-23 00:34:32] [config] cpu-threads: 0
[2023-07-23 00:34:32] [config] data-threads: 8
[2023-07-23 00:34:32] [config] data-weighting: ""
[2023-07-23 00:34:32] [config] data-weighting-type: sentence
[2023-07-23 00:34:32] [config] dec-cell: gru
[2023-07-23 00:34:32] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:32] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:32] [config] dec-depth: 1
[2023-07-23 00:34:32] [config] devices:
[2023-07-23 00:34:32] [config]   - 0
[2023-07-23 00:34:32] [config] dim-emb: 512
[2023-07-23 00:34:32] [config] dim-rnn: 1024
[2023-07-23 00:34:32] [config] dim-vocabs:
[2023-07-23 00:34:32] [config]   - 16384
[2023-07-23 00:34:32] [config]   - 16384
[2023-07-23 00:34:32] [config] disp-first: 0
[2023-07-23 00:34:32] [config] disp-freq: 1000u
[2023-07-23 00:34:32] [config] disp-label-counts: true
[2023-07-23 00:34:32] [config] dropout-rnn: 0
[2023-07-23 00:34:32] [config] dropout-src: 0
[2023-07-23 00:34:32] [config] dropout-trg: 0
[2023-07-23 00:34:32] [config] dump-config: ""
[2023-07-23 00:34:32] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] early-stopping: 200
[2023-07-23 00:34:32] [config] early-stopping-on: first
[2023-07-23 00:34:32] [config] embedding-fix-src: false
[2023-07-23 00:34:32] [config] embedding-fix-trg: false
[2023-07-23 00:34:32] [config] embedding-normalization: false
[2023-07-23 00:34:32] [config] embedding-vectors:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] enc-cell: lstm
[2023-07-23 00:34:32] [config] enc-cell-depth: 1
[2023-07-23 00:34:32] [config] enc-depth: 1
[2023-07-23 00:34:32] [config] enc-type: bidirectional
[2023-07-23 00:34:32] [config] english-title-case-every: 0
[2023-07-23 00:34:32] [config] exponential-smoothing: 0
[2023-07-23 00:34:32] [config] factor-weight: 1
[2023-07-23 00:34:32] [config] factors-combine: sum
[2023-07-23 00:34:32] [config] factors-dim-emb: 0
[2023-07-23 00:34:32] [config] gradient-checkpointing: false
[2023-07-23 00:34:32] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:32] [config] guided-alignment: none
[2023-07-23 00:34:32] [config] guided-alignment-cost: mse
[2023-07-23 00:34:32] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:32] [config] ignore-model-config: false
[2023-07-23 00:34:32] [config] input-types:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] interpolate-env-vars: false
[2023-07-23 00:34:32] [config] keep-best: false
[2023-07-23 00:34:32] [config] label-smoothing: 0
[2023-07-23 00:34:32] [config] layer-normalization: false
[2023-07-23 00:34:32] [config] learn-rate: 0.0001
[2023-07-23 00:34:32] [config] lemma-dependency: ""
[2023-07-23 00:34:32] [config] lemma-dim-emb: 0
[2023-07-23 00:34:32] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:32] [config] log-level: info
[2023-07-23 00:34:32] [config] log-time-zone: ""
[2023-07-23 00:34:32] [config] logical-epoch:
[2023-07-23 00:34:32] [config]   - 1e
[2023-07-23 00:34:32] [config]   - 0
[2023-07-23 00:34:32] [config] lr-decay: 0
[2023-07-23 00:34:32] [config] lr-decay-freq: 50000
[2023-07-23 00:34:32] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:32] [config]   - 0
[2023-07-23 00:34:32] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:32] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:32] [config] lr-decay-start:
[2023-07-23 00:34:32] [config]   - 10
[2023-07-23 00:34:32] [config]   - 1
[2023-07-23 00:34:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:32] [config] lr-report: false
[2023-07-23 00:34:32] [config] lr-warmup: 0
[2023-07-23 00:34:32] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:32] [config] lr-warmup-cycle: false
[2023-07-23 00:34:32] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:32] [config] max-length: 50
[2023-07-23 00:34:32] [config] max-length-crop: true
[2023-07-23 00:34:32] [config] max-length-factor: 3
[2023-07-23 00:34:32] [config] maxi-batch: 100
[2023-07-23 00:34:32] [config] maxi-batch-sort: trg
[2023-07-23 00:34:32] [config] mini-batch: 64
[2023-07-23 00:34:32] [config] mini-batch-fit: true
[2023-07-23 00:34:32] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:32] [config] mini-batch-round-up: true
[2023-07-23 00:34:32] [config] mini-batch-track-lr: false
[2023-07-23 00:34:32] [config] mini-batch-warmup: 0
[2023-07-23 00:34:32] [config] mini-batch-words: 0
[2023-07-23 00:34:32] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:32] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:32] [config] multi-loss-type: sum
[2023-07-23 00:34:32] [config] n-best: false
[2023-07-23 00:34:32] [config] no-nccl: false
[2023-07-23 00:34:32] [config] no-reload: false
[2023-07-23 00:34:32] [config] no-restore-corpus: false
[2023-07-23 00:34:32] [config] normalize: 0
[2023-07-23 00:34:32] [config] normalize-gradient: false
[2023-07-23 00:34:32] [config] num-devices: 0
[2023-07-23 00:34:32] [config] optimizer: adam
[2023-07-23 00:34:32] [config] optimizer-delay: 1
[2023-07-23 00:34:32] [config] optimizer-params:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] output-omit-bias: false
[2023-07-23 00:34:32] [config] overwrite: true
[2023-07-23 00:34:32] [config] precision:
[2023-07-23 00:34:32] [config]   - float16
[2023-07-23 00:34:32] [config]   - float32
[2023-07-23 00:34:32] [config] pretrained-model: ""
[2023-07-23 00:34:32] [config] quantize-biases: false
[2023-07-23 00:34:32] [config] quantize-bits: 0
[2023-07-23 00:34:32] [config] quantize-log-based: false
[2023-07-23 00:34:32] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:32] [config] quiet: false
[2023-07-23 00:34:32] [config] quiet-translation: true
[2023-07-23 00:34:32] [config] relative-paths: false
[2023-07-23 00:34:32] [config] right-left: false
[2023-07-23 00:34:32] [config] save-freq: 10000u
[2023-07-23 00:34:32] [config] seed: 1234
[2023-07-23 00:34:32] [config] sentencepiece-alphas:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:32] [config] sentencepiece-options: ""
[2023-07-23 00:34:32] [config] sharding: global
[2023-07-23 00:34:32] [config] shuffle: data
[2023-07-23 00:34:32] [config] shuffle-in-ram: false
[2023-07-23 00:34:32] [config] sigterm: save-and-exit
[2023-07-23 00:34:32] [config] skip: false
[2023-07-23 00:34:32] [config] sqlite: ""
[2023-07-23 00:34:32] [config] sqlite-drop: false
[2023-07-23 00:34:32] [config] sync-freq: 200u
[2023-07-23 00:34:32] [config] sync-sgd: false
[2023-07-23 00:34:32] [config] tempdir: /tmp
[2023-07-23 00:34:32] [config] tied-embeddings: false
[2023-07-23 00:34:32] [config] tied-embeddings-all: true
[2023-07-23 00:34:32] [config] tied-embeddings-src: false
[2023-07-23 00:34:32] [config] train-embedder-rank:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] train-sets:
[2023-07-23 00:34:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:32] [config] transformer-aan-activation: swish
[2023-07-23 00:34:32] [config] transformer-aan-depth: 2
[2023-07-23 00:34:32] [config] transformer-aan-nogate: false
[2023-07-23 00:34:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:32] [config] transformer-depth-scaling: false
[2023-07-23 00:34:32] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:32] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:32] [config] transformer-dropout: 0
[2023-07-23 00:34:32] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:32] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:32] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:32] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:32] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:32] [config] transformer-heads: 8
[2023-07-23 00:34:32] [config] transformer-no-projection: false
[2023-07-23 00:34:32] [config] transformer-pool: false
[2023-07-23 00:34:32] [config] transformer-postprocess: dan
[2023-07-23 00:34:32] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:32] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:32] [config] transformer-preprocess: ""
[2023-07-23 00:34:32] [config] transformer-tied-layers:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:32] [config] tsv: false
[2023-07-23 00:34:32] [config] tsv-fields: 0
[2023-07-23 00:34:32] [config] type: amun
[2023-07-23 00:34:32] [config] ulr: false
[2023-07-23 00:34:32] [config] ulr-dim-emb: 0
[2023-07-23 00:34:32] [config] ulr-dropout: 0
[2023-07-23 00:34:32] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:32] [config] ulr-query-vectors: ""
[2023-07-23 00:34:32] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:32] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:32] [config] unlikelihood-loss: false
[2023-07-23 00:34:32] [config] valid-freq: 50000000
[2023-07-23 00:34:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:32] [config] valid-max-length: 1000
[2023-07-23 00:34:32] [config] valid-metrics:
[2023-07-23 00:34:32] [config]   - cross-entropy
[2023-07-23 00:34:32] [config]   - translation
[2023-07-23 00:34:32] [config] valid-mini-batch: 32
[2023-07-23 00:34:32] [config] valid-reset-stalled: false
[2023-07-23 00:34:32] [config] valid-script-args:
[2023-07-23 00:34:32] [config]   []
[2023-07-23 00:34:32] [config] valid-script-path: ""
[2023-07-23 00:34:32] [config] valid-sets:
[2023-07-23 00:34:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:32] [config] vocabs:
[2023-07-23 00:34:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:32] [config] word-penalty: 0
[2023-07-23 00:34:32] [config] word-scores: false
[2023-07-23 00:34:32] [config] workspace: 5500
[2023-07-23 00:34:32] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:32] [training] Using single-device training
[2023-07-23 00:34:33] Synced seed 1234
[2023-07-23 00:34:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:34] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:34] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x56504df59692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x56504de9ada8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x56504de9f1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x56504dea62ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x56504e052a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x56504e053a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x56504e02cbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x56504db2e108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x56504da502c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56504da07b9c]    main                                               + 0x3c
[0x7f3f1924d0b3]    __libc_start_main                                  + 0xf3
[0x56504da4ecbe]    _start                                             + 0x2e

[2023-07-23 00:34:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:37] [marian] Running on node23.datos.cluster.uy as process 6733 with command line:
[2023-07-23 00:34:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:37] [config] after: 0e
[2023-07-23 00:34:37] [config] after-batches: 0
[2023-07-23 00:34:37] [config] after-epochs: 60
[2023-07-23 00:34:37] [config] all-caps-every: 0
[2023-07-23 00:34:37] [config] allow-unk: false
[2023-07-23 00:34:37] [config] authors: false
[2023-07-23 00:34:37] [config] beam-size: 12
[2023-07-23 00:34:37] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:37] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:37] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:37] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:37] [config] build-info: ""
[2023-07-23 00:34:37] [config] check-gradient-nan: false
[2023-07-23 00:34:37] [config] check-nan: false
[2023-07-23 00:34:37] [config] cite: false
[2023-07-23 00:34:37] [config] clip-norm: 1
[2023-07-23 00:34:37] [config] cost-scaling:
[2023-07-23 00:34:37] [config]   - 256.f
[2023-07-23 00:34:37] [config]   - 1000
[2023-07-23 00:34:37] [config]   - 2.f
[2023-07-23 00:34:37] [config]   - 256.f
[2023-07-23 00:34:37] [config] cost-type: ce-sum
[2023-07-23 00:34:37] [config] cpu-threads: 0
[2023-07-23 00:34:37] [config] data-threads: 8
[2023-07-23 00:34:37] [config] data-weighting: ""
[2023-07-23 00:34:37] [config] data-weighting-type: sentence
[2023-07-23 00:34:37] [config] dec-cell: gru
[2023-07-23 00:34:37] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:37] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:37] [config] dec-depth: 1
[2023-07-23 00:34:37] [config] devices:
[2023-07-23 00:34:37] [config]   - 0
[2023-07-23 00:34:37] [config] dim-emb: 512
[2023-07-23 00:34:37] [config] dim-rnn: 1024
[2023-07-23 00:34:37] [config] dim-vocabs:
[2023-07-23 00:34:37] [config]   - 16384
[2023-07-23 00:34:37] [config]   - 16384
[2023-07-23 00:34:37] [config] disp-first: 0
[2023-07-23 00:34:37] [config] disp-freq: 1000u
[2023-07-23 00:34:37] [config] disp-label-counts: true
[2023-07-23 00:34:37] [config] dropout-rnn: 0
[2023-07-23 00:34:37] [config] dropout-src: 0
[2023-07-23 00:34:37] [config] dropout-trg: 0
[2023-07-23 00:34:37] [config] dump-config: ""
[2023-07-23 00:34:37] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] early-stopping: 200
[2023-07-23 00:34:37] [config] early-stopping-on: first
[2023-07-23 00:34:37] [config] embedding-fix-src: false
[2023-07-23 00:34:37] [config] embedding-fix-trg: false
[2023-07-23 00:34:37] [config] embedding-normalization: false
[2023-07-23 00:34:37] [config] embedding-vectors:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] enc-cell: lstm
[2023-07-23 00:34:37] [config] enc-cell-depth: 1
[2023-07-23 00:34:37] [config] enc-depth: 1
[2023-07-23 00:34:37] [config] enc-type: bidirectional
[2023-07-23 00:34:37] [config] english-title-case-every: 0
[2023-07-23 00:34:37] [config] exponential-smoothing: 0
[2023-07-23 00:34:37] [config] factor-weight: 1
[2023-07-23 00:34:37] [config] factors-combine: sum
[2023-07-23 00:34:37] [config] factors-dim-emb: 0
[2023-07-23 00:34:37] [config] gradient-checkpointing: false
[2023-07-23 00:34:37] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:37] [config] guided-alignment: none
[2023-07-23 00:34:37] [config] guided-alignment-cost: mse
[2023-07-23 00:34:37] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:37] [config] ignore-model-config: false
[2023-07-23 00:34:37] [config] input-types:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] interpolate-env-vars: false
[2023-07-23 00:34:37] [config] keep-best: false
[2023-07-23 00:34:37] [config] label-smoothing: 0
[2023-07-23 00:34:37] [config] layer-normalization: false
[2023-07-23 00:34:37] [config] learn-rate: 0.0001
[2023-07-23 00:34:37] [config] lemma-dependency: ""
[2023-07-23 00:34:37] [config] lemma-dim-emb: 0
[2023-07-23 00:34:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:37] [config] log-level: info
[2023-07-23 00:34:37] [config] log-time-zone: ""
[2023-07-23 00:34:37] [config] logical-epoch:
[2023-07-23 00:34:37] [config]   - 1e
[2023-07-23 00:34:37] [config]   - 0
[2023-07-23 00:34:37] [config] lr-decay: 0
[2023-07-23 00:34:37] [config] lr-decay-freq: 50000
[2023-07-23 00:34:37] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:37] [config]   - 0
[2023-07-23 00:34:37] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:37] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:37] [config] lr-decay-start:
[2023-07-23 00:34:37] [config]   - 10
[2023-07-23 00:34:37] [config]   - 1
[2023-07-23 00:34:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:37] [config] lr-report: false
[2023-07-23 00:34:37] [config] lr-warmup: 0
[2023-07-23 00:34:37] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:37] [config] lr-warmup-cycle: false
[2023-07-23 00:34:37] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:37] [config] max-length: 50
[2023-07-23 00:34:37] [config] max-length-crop: true
[2023-07-23 00:34:37] [config] max-length-factor: 3
[2023-07-23 00:34:37] [config] maxi-batch: 100
[2023-07-23 00:34:37] [config] maxi-batch-sort: trg
[2023-07-23 00:34:37] [config] mini-batch: 64
[2023-07-23 00:34:37] [config] mini-batch-fit: true
[2023-07-23 00:34:37] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:37] [config] mini-batch-round-up: true
[2023-07-23 00:34:37] [config] mini-batch-track-lr: false
[2023-07-23 00:34:37] [config] mini-batch-warmup: 0
[2023-07-23 00:34:37] [config] mini-batch-words: 0
[2023-07-23 00:34:37] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:37] [config] multi-loss-type: sum
[2023-07-23 00:34:37] [config] n-best: false
[2023-07-23 00:34:37] [config] no-nccl: false
[2023-07-23 00:34:37] [config] no-reload: false
[2023-07-23 00:34:37] [config] no-restore-corpus: false
[2023-07-23 00:34:37] [config] normalize: 0
[2023-07-23 00:34:37] [config] normalize-gradient: false
[2023-07-23 00:34:37] [config] num-devices: 0
[2023-07-23 00:34:37] [config] optimizer: adam
[2023-07-23 00:34:37] [config] optimizer-delay: 1
[2023-07-23 00:34:37] [config] optimizer-params:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] output-omit-bias: false
[2023-07-23 00:34:37] [config] overwrite: true
[2023-07-23 00:34:37] [config] precision:
[2023-07-23 00:34:37] [config]   - float16
[2023-07-23 00:34:37] [config]   - float32
[2023-07-23 00:34:37] [config] pretrained-model: ""
[2023-07-23 00:34:37] [config] quantize-biases: false
[2023-07-23 00:34:37] [config] quantize-bits: 0
[2023-07-23 00:34:37] [config] quantize-log-based: false
[2023-07-23 00:34:37] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:37] [config] quiet: false
[2023-07-23 00:34:37] [config] quiet-translation: true
[2023-07-23 00:34:37] [config] relative-paths: false
[2023-07-23 00:34:37] [config] right-left: false
[2023-07-23 00:34:37] [config] save-freq: 10000u
[2023-07-23 00:34:37] [config] seed: 1234
[2023-07-23 00:34:37] [config] sentencepiece-alphas:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:37] [config] sentencepiece-options: ""
[2023-07-23 00:34:37] [config] sharding: global
[2023-07-23 00:34:37] [config] shuffle: data
[2023-07-23 00:34:37] [config] shuffle-in-ram: false
[2023-07-23 00:34:37] [config] sigterm: save-and-exit
[2023-07-23 00:34:37] [config] skip: false
[2023-07-23 00:34:37] [config] sqlite: ""
[2023-07-23 00:34:37] [config] sqlite-drop: false
[2023-07-23 00:34:37] [config] sync-freq: 200u
[2023-07-23 00:34:37] [config] sync-sgd: false
[2023-07-23 00:34:37] [config] tempdir: /tmp
[2023-07-23 00:34:37] [config] tied-embeddings: false
[2023-07-23 00:34:37] [config] tied-embeddings-all: true
[2023-07-23 00:34:37] [config] tied-embeddings-src: false
[2023-07-23 00:34:37] [config] train-embedder-rank:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] train-sets:
[2023-07-23 00:34:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:37] [config] transformer-aan-activation: swish
[2023-07-23 00:34:37] [config] transformer-aan-depth: 2
[2023-07-23 00:34:37] [config] transformer-aan-nogate: false
[2023-07-23 00:34:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:37] [config] transformer-depth-scaling: false
[2023-07-23 00:34:37] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:37] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:37] [config] transformer-dropout: 0
[2023-07-23 00:34:37] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:37] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:37] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:37] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:37] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:37] [config] transformer-heads: 8
[2023-07-23 00:34:37] [config] transformer-no-projection: false
[2023-07-23 00:34:37] [config] transformer-pool: false
[2023-07-23 00:34:37] [config] transformer-postprocess: dan
[2023-07-23 00:34:37] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:37] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:37] [config] transformer-preprocess: ""
[2023-07-23 00:34:37] [config] transformer-tied-layers:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:37] [config] tsv: false
[2023-07-23 00:34:37] [config] tsv-fields: 0
[2023-07-23 00:34:37] [config] type: amun
[2023-07-23 00:34:37] [config] ulr: false
[2023-07-23 00:34:37] [config] ulr-dim-emb: 0
[2023-07-23 00:34:37] [config] ulr-dropout: 0
[2023-07-23 00:34:37] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:37] [config] ulr-query-vectors: ""
[2023-07-23 00:34:37] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:37] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:37] [config] unlikelihood-loss: false
[2023-07-23 00:34:37] [config] valid-freq: 50000000
[2023-07-23 00:34:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:37] [config] valid-max-length: 1000
[2023-07-23 00:34:37] [config] valid-metrics:
[2023-07-23 00:34:37] [config]   - cross-entropy
[2023-07-23 00:34:37] [config]   - translation
[2023-07-23 00:34:37] [config] valid-mini-batch: 32
[2023-07-23 00:34:37] [config] valid-reset-stalled: false
[2023-07-23 00:34:37] [config] valid-script-args:
[2023-07-23 00:34:37] [config]   []
[2023-07-23 00:34:37] [config] valid-script-path: ""
[2023-07-23 00:34:37] [config] valid-sets:
[2023-07-23 00:34:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:37] [config] vocabs:
[2023-07-23 00:34:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:37] [config] word-penalty: 0
[2023-07-23 00:34:37] [config] word-scores: false
[2023-07-23 00:34:37] [config] workspace: 5500
[2023-07-23 00:34:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:37] [training] Using single-device training
[2023-07-23 00:34:38] Synced seed 1234
[2023-07-23 00:34:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:39] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:39] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55c42df90692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55c42ded1da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55c42ded61a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55c42dedd2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55c42e089a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55c42e08aa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55c42e063bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55c42db65108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55c42da872c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55c42da3eb9c]    main                                               + 0x3c
[0x7f23bc84e0b3]    __libc_start_main                                  + 0xf3
[0x55c42da85cbe]    _start                                             + 0x2e

[2023-07-23 00:34:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:42] [marian] Running on node23.datos.cluster.uy as process 6760 with command line:
[2023-07-23 00:34:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:42] [config] after: 0e
[2023-07-23 00:34:42] [config] after-batches: 0
[2023-07-23 00:34:42] [config] after-epochs: 70
[2023-07-23 00:34:42] [config] all-caps-every: 0
[2023-07-23 00:34:42] [config] allow-unk: false
[2023-07-23 00:34:42] [config] authors: false
[2023-07-23 00:34:42] [config] beam-size: 12
[2023-07-23 00:34:42] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:42] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:42] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:42] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:42] [config] build-info: ""
[2023-07-23 00:34:42] [config] check-gradient-nan: false
[2023-07-23 00:34:42] [config] check-nan: false
[2023-07-23 00:34:42] [config] cite: false
[2023-07-23 00:34:42] [config] clip-norm: 1
[2023-07-23 00:34:42] [config] cost-scaling:
[2023-07-23 00:34:42] [config]   - 256.f
[2023-07-23 00:34:42] [config]   - 1000
[2023-07-23 00:34:42] [config]   - 2.f
[2023-07-23 00:34:42] [config]   - 256.f
[2023-07-23 00:34:42] [config] cost-type: ce-sum
[2023-07-23 00:34:42] [config] cpu-threads: 0
[2023-07-23 00:34:42] [config] data-threads: 8
[2023-07-23 00:34:42] [config] data-weighting: ""
[2023-07-23 00:34:42] [config] data-weighting-type: sentence
[2023-07-23 00:34:42] [config] dec-cell: gru
[2023-07-23 00:34:42] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:42] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:42] [config] dec-depth: 1
[2023-07-23 00:34:42] [config] devices:
[2023-07-23 00:34:42] [config]   - 0
[2023-07-23 00:34:42] [config] dim-emb: 512
[2023-07-23 00:34:42] [config] dim-rnn: 1024
[2023-07-23 00:34:42] [config] dim-vocabs:
[2023-07-23 00:34:42] [config]   - 16384
[2023-07-23 00:34:42] [config]   - 16384
[2023-07-23 00:34:42] [config] disp-first: 0
[2023-07-23 00:34:42] [config] disp-freq: 1000u
[2023-07-23 00:34:42] [config] disp-label-counts: true
[2023-07-23 00:34:42] [config] dropout-rnn: 0
[2023-07-23 00:34:42] [config] dropout-src: 0
[2023-07-23 00:34:42] [config] dropout-trg: 0
[2023-07-23 00:34:42] [config] dump-config: ""
[2023-07-23 00:34:42] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] early-stopping: 200
[2023-07-23 00:34:42] [config] early-stopping-on: first
[2023-07-23 00:34:42] [config] embedding-fix-src: false
[2023-07-23 00:34:42] [config] embedding-fix-trg: false
[2023-07-23 00:34:42] [config] embedding-normalization: false
[2023-07-23 00:34:42] [config] embedding-vectors:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] enc-cell: lstm
[2023-07-23 00:34:42] [config] enc-cell-depth: 1
[2023-07-23 00:34:42] [config] enc-depth: 1
[2023-07-23 00:34:42] [config] enc-type: bidirectional
[2023-07-23 00:34:42] [config] english-title-case-every: 0
[2023-07-23 00:34:42] [config] exponential-smoothing: 0
[2023-07-23 00:34:42] [config] factor-weight: 1
[2023-07-23 00:34:42] [config] factors-combine: sum
[2023-07-23 00:34:42] [config] factors-dim-emb: 0
[2023-07-23 00:34:42] [config] gradient-checkpointing: false
[2023-07-23 00:34:42] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:42] [config] guided-alignment: none
[2023-07-23 00:34:42] [config] guided-alignment-cost: mse
[2023-07-23 00:34:42] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:42] [config] ignore-model-config: false
[2023-07-23 00:34:42] [config] input-types:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] interpolate-env-vars: false
[2023-07-23 00:34:42] [config] keep-best: false
[2023-07-23 00:34:42] [config] label-smoothing: 0
[2023-07-23 00:34:42] [config] layer-normalization: false
[2023-07-23 00:34:42] [config] learn-rate: 0.0001
[2023-07-23 00:34:42] [config] lemma-dependency: ""
[2023-07-23 00:34:42] [config] lemma-dim-emb: 0
[2023-07-23 00:34:42] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:42] [config] log-level: info
[2023-07-23 00:34:42] [config] log-time-zone: ""
[2023-07-23 00:34:42] [config] logical-epoch:
[2023-07-23 00:34:42] [config]   - 1e
[2023-07-23 00:34:42] [config]   - 0
[2023-07-23 00:34:42] [config] lr-decay: 0
[2023-07-23 00:34:42] [config] lr-decay-freq: 50000
[2023-07-23 00:34:42] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:42] [config]   - 0
[2023-07-23 00:34:42] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:42] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:42] [config] lr-decay-start:
[2023-07-23 00:34:42] [config]   - 10
[2023-07-23 00:34:42] [config]   - 1
[2023-07-23 00:34:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:42] [config] lr-report: false
[2023-07-23 00:34:42] [config] lr-warmup: 0
[2023-07-23 00:34:42] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:42] [config] lr-warmup-cycle: false
[2023-07-23 00:34:42] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:42] [config] max-length: 50
[2023-07-23 00:34:42] [config] max-length-crop: true
[2023-07-23 00:34:42] [config] max-length-factor: 3
[2023-07-23 00:34:42] [config] maxi-batch: 100
[2023-07-23 00:34:42] [config] maxi-batch-sort: trg
[2023-07-23 00:34:42] [config] mini-batch: 64
[2023-07-23 00:34:42] [config] mini-batch-fit: true
[2023-07-23 00:34:42] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:42] [config] mini-batch-round-up: true
[2023-07-23 00:34:42] [config] mini-batch-track-lr: false
[2023-07-23 00:34:42] [config] mini-batch-warmup: 0
[2023-07-23 00:34:42] [config] mini-batch-words: 0
[2023-07-23 00:34:42] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:42] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:42] [config] multi-loss-type: sum
[2023-07-23 00:34:42] [config] n-best: false
[2023-07-23 00:34:42] [config] no-nccl: false
[2023-07-23 00:34:42] [config] no-reload: false
[2023-07-23 00:34:42] [config] no-restore-corpus: false
[2023-07-23 00:34:42] [config] normalize: 0
[2023-07-23 00:34:42] [config] normalize-gradient: false
[2023-07-23 00:34:42] [config] num-devices: 0
[2023-07-23 00:34:42] [config] optimizer: adam
[2023-07-23 00:34:42] [config] optimizer-delay: 1
[2023-07-23 00:34:42] [config] optimizer-params:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] output-omit-bias: false
[2023-07-23 00:34:42] [config] overwrite: true
[2023-07-23 00:34:42] [config] precision:
[2023-07-23 00:34:42] [config]   - float16
[2023-07-23 00:34:42] [config]   - float32
[2023-07-23 00:34:42] [config] pretrained-model: ""
[2023-07-23 00:34:42] [config] quantize-biases: false
[2023-07-23 00:34:42] [config] quantize-bits: 0
[2023-07-23 00:34:42] [config] quantize-log-based: false
[2023-07-23 00:34:42] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:42] [config] quiet: false
[2023-07-23 00:34:42] [config] quiet-translation: true
[2023-07-23 00:34:42] [config] relative-paths: false
[2023-07-23 00:34:42] [config] right-left: false
[2023-07-23 00:34:42] [config] save-freq: 10000u
[2023-07-23 00:34:42] [config] seed: 1234
[2023-07-23 00:34:42] [config] sentencepiece-alphas:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:42] [config] sentencepiece-options: ""
[2023-07-23 00:34:42] [config] sharding: global
[2023-07-23 00:34:42] [config] shuffle: data
[2023-07-23 00:34:42] [config] shuffle-in-ram: false
[2023-07-23 00:34:42] [config] sigterm: save-and-exit
[2023-07-23 00:34:42] [config] skip: false
[2023-07-23 00:34:42] [config] sqlite: ""
[2023-07-23 00:34:42] [config] sqlite-drop: false
[2023-07-23 00:34:42] [config] sync-freq: 200u
[2023-07-23 00:34:42] [config] sync-sgd: false
[2023-07-23 00:34:42] [config] tempdir: /tmp
[2023-07-23 00:34:42] [config] tied-embeddings: false
[2023-07-23 00:34:42] [config] tied-embeddings-all: true
[2023-07-23 00:34:42] [config] tied-embeddings-src: false
[2023-07-23 00:34:42] [config] train-embedder-rank:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] train-sets:
[2023-07-23 00:34:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:42] [config] transformer-aan-activation: swish
[2023-07-23 00:34:42] [config] transformer-aan-depth: 2
[2023-07-23 00:34:42] [config] transformer-aan-nogate: false
[2023-07-23 00:34:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:42] [config] transformer-depth-scaling: false
[2023-07-23 00:34:42] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:42] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:42] [config] transformer-dropout: 0
[2023-07-23 00:34:42] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:42] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:42] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:42] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:42] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:42] [config] transformer-heads: 8
[2023-07-23 00:34:42] [config] transformer-no-projection: false
[2023-07-23 00:34:42] [config] transformer-pool: false
[2023-07-23 00:34:42] [config] transformer-postprocess: dan
[2023-07-23 00:34:42] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:42] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:42] [config] transformer-preprocess: ""
[2023-07-23 00:34:42] [config] transformer-tied-layers:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:42] [config] tsv: false
[2023-07-23 00:34:42] [config] tsv-fields: 0
[2023-07-23 00:34:42] [config] type: amun
[2023-07-23 00:34:42] [config] ulr: false
[2023-07-23 00:34:42] [config] ulr-dim-emb: 0
[2023-07-23 00:34:42] [config] ulr-dropout: 0
[2023-07-23 00:34:42] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:42] [config] ulr-query-vectors: ""
[2023-07-23 00:34:42] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:42] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:42] [config] unlikelihood-loss: false
[2023-07-23 00:34:42] [config] valid-freq: 50000000
[2023-07-23 00:34:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:42] [config] valid-max-length: 1000
[2023-07-23 00:34:42] [config] valid-metrics:
[2023-07-23 00:34:42] [config]   - cross-entropy
[2023-07-23 00:34:42] [config]   - translation
[2023-07-23 00:34:42] [config] valid-mini-batch: 32
[2023-07-23 00:34:42] [config] valid-reset-stalled: false
[2023-07-23 00:34:42] [config] valid-script-args:
[2023-07-23 00:34:42] [config]   []
[2023-07-23 00:34:42] [config] valid-script-path: ""
[2023-07-23 00:34:42] [config] valid-sets:
[2023-07-23 00:34:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:42] [config] vocabs:
[2023-07-23 00:34:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:42] [config] word-penalty: 0
[2023-07-23 00:34:42] [config] word-scores: false
[2023-07-23 00:34:42] [config] workspace: 5500
[2023-07-23 00:34:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:42] [training] Using single-device training
[2023-07-23 00:34:43] Synced seed 1234
[2023-07-23 00:34:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:43] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:43] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:43] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:43] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:43] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:44] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:44] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:44] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x5605383f4692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x560538335da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x56053833a1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5605383412ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5605384eda0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5605384eea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5605384c7bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x560537fc9108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x560537eeb2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x560537ea2b9c]    main                                               + 0x3c
[0x7f684194b0b3]    __libc_start_main                                  + 0xf3
[0x560537ee9cbe]    _start                                             + 0x2e

[2023-07-23 00:34:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:48] [marian] Running on node23.datos.cluster.uy as process 6787 with command line:
[2023-07-23 00:34:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:48] [config] after: 0e
[2023-07-23 00:34:48] [config] after-batches: 0
[2023-07-23 00:34:48] [config] after-epochs: 80
[2023-07-23 00:34:48] [config] all-caps-every: 0
[2023-07-23 00:34:48] [config] allow-unk: false
[2023-07-23 00:34:48] [config] authors: false
[2023-07-23 00:34:48] [config] beam-size: 12
[2023-07-23 00:34:48] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:48] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:48] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:48] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:48] [config] build-info: ""
[2023-07-23 00:34:48] [config] check-gradient-nan: false
[2023-07-23 00:34:48] [config] check-nan: false
[2023-07-23 00:34:48] [config] cite: false
[2023-07-23 00:34:48] [config] clip-norm: 1
[2023-07-23 00:34:48] [config] cost-scaling:
[2023-07-23 00:34:48] [config]   - 256.f
[2023-07-23 00:34:48] [config]   - 1000
[2023-07-23 00:34:48] [config]   - 2.f
[2023-07-23 00:34:48] [config]   - 256.f
[2023-07-23 00:34:48] [config] cost-type: ce-sum
[2023-07-23 00:34:48] [config] cpu-threads: 0
[2023-07-23 00:34:48] [config] data-threads: 8
[2023-07-23 00:34:48] [config] data-weighting: ""
[2023-07-23 00:34:48] [config] data-weighting-type: sentence
[2023-07-23 00:34:48] [config] dec-cell: gru
[2023-07-23 00:34:48] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:48] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:48] [config] dec-depth: 1
[2023-07-23 00:34:48] [config] devices:
[2023-07-23 00:34:48] [config]   - 0
[2023-07-23 00:34:48] [config] dim-emb: 512
[2023-07-23 00:34:48] [config] dim-rnn: 1024
[2023-07-23 00:34:48] [config] dim-vocabs:
[2023-07-23 00:34:48] [config]   - 16384
[2023-07-23 00:34:48] [config]   - 16384
[2023-07-23 00:34:48] [config] disp-first: 0
[2023-07-23 00:34:48] [config] disp-freq: 1000u
[2023-07-23 00:34:48] [config] disp-label-counts: true
[2023-07-23 00:34:48] [config] dropout-rnn: 0
[2023-07-23 00:34:48] [config] dropout-src: 0
[2023-07-23 00:34:48] [config] dropout-trg: 0
[2023-07-23 00:34:48] [config] dump-config: ""
[2023-07-23 00:34:48] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] early-stopping: 200
[2023-07-23 00:34:48] [config] early-stopping-on: first
[2023-07-23 00:34:48] [config] embedding-fix-src: false
[2023-07-23 00:34:48] [config] embedding-fix-trg: false
[2023-07-23 00:34:48] [config] embedding-normalization: false
[2023-07-23 00:34:48] [config] embedding-vectors:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] enc-cell: lstm
[2023-07-23 00:34:48] [config] enc-cell-depth: 1
[2023-07-23 00:34:48] [config] enc-depth: 1
[2023-07-23 00:34:48] [config] enc-type: bidirectional
[2023-07-23 00:34:48] [config] english-title-case-every: 0
[2023-07-23 00:34:48] [config] exponential-smoothing: 0
[2023-07-23 00:34:48] [config] factor-weight: 1
[2023-07-23 00:34:48] [config] factors-combine: sum
[2023-07-23 00:34:48] [config] factors-dim-emb: 0
[2023-07-23 00:34:48] [config] gradient-checkpointing: false
[2023-07-23 00:34:48] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:48] [config] guided-alignment: none
[2023-07-23 00:34:48] [config] guided-alignment-cost: mse
[2023-07-23 00:34:48] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:48] [config] ignore-model-config: false
[2023-07-23 00:34:48] [config] input-types:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] interpolate-env-vars: false
[2023-07-23 00:34:48] [config] keep-best: false
[2023-07-23 00:34:48] [config] label-smoothing: 0
[2023-07-23 00:34:48] [config] layer-normalization: false
[2023-07-23 00:34:48] [config] learn-rate: 0.0001
[2023-07-23 00:34:48] [config] lemma-dependency: ""
[2023-07-23 00:34:48] [config] lemma-dim-emb: 0
[2023-07-23 00:34:48] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:48] [config] log-level: info
[2023-07-23 00:34:48] [config] log-time-zone: ""
[2023-07-23 00:34:48] [config] logical-epoch:
[2023-07-23 00:34:48] [config]   - 1e
[2023-07-23 00:34:48] [config]   - 0
[2023-07-23 00:34:48] [config] lr-decay: 0
[2023-07-23 00:34:48] [config] lr-decay-freq: 50000
[2023-07-23 00:34:48] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:48] [config]   - 0
[2023-07-23 00:34:48] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:48] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:48] [config] lr-decay-start:
[2023-07-23 00:34:48] [config]   - 10
[2023-07-23 00:34:48] [config]   - 1
[2023-07-23 00:34:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:48] [config] lr-report: false
[2023-07-23 00:34:48] [config] lr-warmup: 0
[2023-07-23 00:34:48] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:48] [config] lr-warmup-cycle: false
[2023-07-23 00:34:48] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:48] [config] max-length: 50
[2023-07-23 00:34:48] [config] max-length-crop: true
[2023-07-23 00:34:48] [config] max-length-factor: 3
[2023-07-23 00:34:48] [config] maxi-batch: 100
[2023-07-23 00:34:48] [config] maxi-batch-sort: trg
[2023-07-23 00:34:48] [config] mini-batch: 64
[2023-07-23 00:34:48] [config] mini-batch-fit: true
[2023-07-23 00:34:48] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:48] [config] mini-batch-round-up: true
[2023-07-23 00:34:48] [config] mini-batch-track-lr: false
[2023-07-23 00:34:48] [config] mini-batch-warmup: 0
[2023-07-23 00:34:48] [config] mini-batch-words: 0
[2023-07-23 00:34:48] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:48] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:48] [config] multi-loss-type: sum
[2023-07-23 00:34:48] [config] n-best: false
[2023-07-23 00:34:48] [config] no-nccl: false
[2023-07-23 00:34:48] [config] no-reload: false
[2023-07-23 00:34:48] [config] no-restore-corpus: false
[2023-07-23 00:34:48] [config] normalize: 0
[2023-07-23 00:34:48] [config] normalize-gradient: false
[2023-07-23 00:34:48] [config] num-devices: 0
[2023-07-23 00:34:48] [config] optimizer: adam
[2023-07-23 00:34:48] [config] optimizer-delay: 1
[2023-07-23 00:34:48] [config] optimizer-params:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] output-omit-bias: false
[2023-07-23 00:34:48] [config] overwrite: true
[2023-07-23 00:34:48] [config] precision:
[2023-07-23 00:34:48] [config]   - float16
[2023-07-23 00:34:48] [config]   - float32
[2023-07-23 00:34:48] [config] pretrained-model: ""
[2023-07-23 00:34:48] [config] quantize-biases: false
[2023-07-23 00:34:48] [config] quantize-bits: 0
[2023-07-23 00:34:48] [config] quantize-log-based: false
[2023-07-23 00:34:48] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:48] [config] quiet: false
[2023-07-23 00:34:48] [config] quiet-translation: true
[2023-07-23 00:34:48] [config] relative-paths: false
[2023-07-23 00:34:48] [config] right-left: false
[2023-07-23 00:34:48] [config] save-freq: 10000u
[2023-07-23 00:34:48] [config] seed: 1234
[2023-07-23 00:34:48] [config] sentencepiece-alphas:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:48] [config] sentencepiece-options: ""
[2023-07-23 00:34:48] [config] sharding: global
[2023-07-23 00:34:48] [config] shuffle: data
[2023-07-23 00:34:48] [config] shuffle-in-ram: false
[2023-07-23 00:34:48] [config] sigterm: save-and-exit
[2023-07-23 00:34:48] [config] skip: false
[2023-07-23 00:34:48] [config] sqlite: ""
[2023-07-23 00:34:48] [config] sqlite-drop: false
[2023-07-23 00:34:48] [config] sync-freq: 200u
[2023-07-23 00:34:48] [config] sync-sgd: false
[2023-07-23 00:34:48] [config] tempdir: /tmp
[2023-07-23 00:34:48] [config] tied-embeddings: false
[2023-07-23 00:34:48] [config] tied-embeddings-all: true
[2023-07-23 00:34:48] [config] tied-embeddings-src: false
[2023-07-23 00:34:48] [config] train-embedder-rank:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] train-sets:
[2023-07-23 00:34:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:48] [config] transformer-aan-activation: swish
[2023-07-23 00:34:48] [config] transformer-aan-depth: 2
[2023-07-23 00:34:48] [config] transformer-aan-nogate: false
[2023-07-23 00:34:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:48] [config] transformer-depth-scaling: false
[2023-07-23 00:34:48] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:48] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:48] [config] transformer-dropout: 0
[2023-07-23 00:34:48] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:48] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:48] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:48] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:48] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:48] [config] transformer-heads: 8
[2023-07-23 00:34:48] [config] transformer-no-projection: false
[2023-07-23 00:34:48] [config] transformer-pool: false
[2023-07-23 00:34:48] [config] transformer-postprocess: dan
[2023-07-23 00:34:48] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:48] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:48] [config] transformer-preprocess: ""
[2023-07-23 00:34:48] [config] transformer-tied-layers:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:48] [config] tsv: false
[2023-07-23 00:34:48] [config] tsv-fields: 0
[2023-07-23 00:34:48] [config] type: amun
[2023-07-23 00:34:48] [config] ulr: false
[2023-07-23 00:34:48] [config] ulr-dim-emb: 0
[2023-07-23 00:34:48] [config] ulr-dropout: 0
[2023-07-23 00:34:48] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:48] [config] ulr-query-vectors: ""
[2023-07-23 00:34:48] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:48] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:48] [config] unlikelihood-loss: false
[2023-07-23 00:34:48] [config] valid-freq: 50000000
[2023-07-23 00:34:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:48] [config] valid-max-length: 1000
[2023-07-23 00:34:48] [config] valid-metrics:
[2023-07-23 00:34:48] [config]   - cross-entropy
[2023-07-23 00:34:48] [config]   - translation
[2023-07-23 00:34:48] [config] valid-mini-batch: 32
[2023-07-23 00:34:48] [config] valid-reset-stalled: false
[2023-07-23 00:34:48] [config] valid-script-args:
[2023-07-23 00:34:48] [config]   []
[2023-07-23 00:34:48] [config] valid-script-path: ""
[2023-07-23 00:34:48] [config] valid-sets:
[2023-07-23 00:34:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:48] [config] vocabs:
[2023-07-23 00:34:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:48] [config] word-penalty: 0
[2023-07-23 00:34:48] [config] word-scores: false
[2023-07-23 00:34:48] [config] workspace: 5500
[2023-07-23 00:34:48] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:48] [training] Using single-device training
[2023-07-23 00:34:48] Synced seed 1234
[2023-07-23 00:34:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:48] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:48] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:49] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:49] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x562a20a95692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x562a209d6da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x562a209db1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x562a209e22ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x562a20b8ea0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x562a20b8fa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x562a20b68bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x562a2066a108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x562a2058c2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x562a20543b9c]    main                                               + 0x3c
[0x7fc76a9380b3]    __libc_start_main                                  + 0xf3
[0x562a2058acbe]    _start                                             + 0x2e

[2023-07-23 00:34:53] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:53] [marian] Running on node23.datos.cluster.uy as process 6814 with command line:
[2023-07-23 00:34:53] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:53] [config] after: 0e
[2023-07-23 00:34:53] [config] after-batches: 0
[2023-07-23 00:34:53] [config] after-epochs: 90
[2023-07-23 00:34:53] [config] all-caps-every: 0
[2023-07-23 00:34:53] [config] allow-unk: false
[2023-07-23 00:34:53] [config] authors: false
[2023-07-23 00:34:53] [config] beam-size: 12
[2023-07-23 00:34:53] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:53] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:53] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:53] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:53] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:53] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:53] [config] build-info: ""
[2023-07-23 00:34:53] [config] check-gradient-nan: false
[2023-07-23 00:34:53] [config] check-nan: false
[2023-07-23 00:34:53] [config] cite: false
[2023-07-23 00:34:53] [config] clip-norm: 1
[2023-07-23 00:34:53] [config] cost-scaling:
[2023-07-23 00:34:53] [config]   - 256.f
[2023-07-23 00:34:53] [config]   - 1000
[2023-07-23 00:34:53] [config]   - 2.f
[2023-07-23 00:34:53] [config]   - 256.f
[2023-07-23 00:34:53] [config] cost-type: ce-sum
[2023-07-23 00:34:53] [config] cpu-threads: 0
[2023-07-23 00:34:53] [config] data-threads: 8
[2023-07-23 00:34:53] [config] data-weighting: ""
[2023-07-23 00:34:53] [config] data-weighting-type: sentence
[2023-07-23 00:34:53] [config] dec-cell: gru
[2023-07-23 00:34:53] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:53] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:53] [config] dec-depth: 1
[2023-07-23 00:34:53] [config] devices:
[2023-07-23 00:34:53] [config]   - 0
[2023-07-23 00:34:53] [config] dim-emb: 512
[2023-07-23 00:34:53] [config] dim-rnn: 1024
[2023-07-23 00:34:53] [config] dim-vocabs:
[2023-07-23 00:34:53] [config]   - 16384
[2023-07-23 00:34:53] [config]   - 16384
[2023-07-23 00:34:53] [config] disp-first: 0
[2023-07-23 00:34:53] [config] disp-freq: 1000u
[2023-07-23 00:34:53] [config] disp-label-counts: true
[2023-07-23 00:34:53] [config] dropout-rnn: 0
[2023-07-23 00:34:53] [config] dropout-src: 0
[2023-07-23 00:34:53] [config] dropout-trg: 0
[2023-07-23 00:34:53] [config] dump-config: ""
[2023-07-23 00:34:53] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] early-stopping: 200
[2023-07-23 00:34:53] [config] early-stopping-on: first
[2023-07-23 00:34:53] [config] embedding-fix-src: false
[2023-07-23 00:34:53] [config] embedding-fix-trg: false
[2023-07-23 00:34:53] [config] embedding-normalization: false
[2023-07-23 00:34:53] [config] embedding-vectors:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] enc-cell: lstm
[2023-07-23 00:34:53] [config] enc-cell-depth: 1
[2023-07-23 00:34:53] [config] enc-depth: 1
[2023-07-23 00:34:53] [config] enc-type: bidirectional
[2023-07-23 00:34:53] [config] english-title-case-every: 0
[2023-07-23 00:34:53] [config] exponential-smoothing: 0
[2023-07-23 00:34:53] [config] factor-weight: 1
[2023-07-23 00:34:53] [config] factors-combine: sum
[2023-07-23 00:34:53] [config] factors-dim-emb: 0
[2023-07-23 00:34:53] [config] gradient-checkpointing: false
[2023-07-23 00:34:53] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:53] [config] guided-alignment: none
[2023-07-23 00:34:53] [config] guided-alignment-cost: mse
[2023-07-23 00:34:53] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:53] [config] ignore-model-config: false
[2023-07-23 00:34:53] [config] input-types:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] interpolate-env-vars: false
[2023-07-23 00:34:53] [config] keep-best: false
[2023-07-23 00:34:53] [config] label-smoothing: 0
[2023-07-23 00:34:53] [config] layer-normalization: false
[2023-07-23 00:34:53] [config] learn-rate: 0.0001
[2023-07-23 00:34:53] [config] lemma-dependency: ""
[2023-07-23 00:34:53] [config] lemma-dim-emb: 0
[2023-07-23 00:34:53] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:53] [config] log-level: info
[2023-07-23 00:34:53] [config] log-time-zone: ""
[2023-07-23 00:34:53] [config] logical-epoch:
[2023-07-23 00:34:53] [config]   - 1e
[2023-07-23 00:34:53] [config]   - 0
[2023-07-23 00:34:53] [config] lr-decay: 0
[2023-07-23 00:34:53] [config] lr-decay-freq: 50000
[2023-07-23 00:34:53] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:53] [config]   - 0
[2023-07-23 00:34:53] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:53] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:53] [config] lr-decay-start:
[2023-07-23 00:34:53] [config]   - 10
[2023-07-23 00:34:53] [config]   - 1
[2023-07-23 00:34:53] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:53] [config] lr-report: false
[2023-07-23 00:34:53] [config] lr-warmup: 0
[2023-07-23 00:34:53] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:53] [config] lr-warmup-cycle: false
[2023-07-23 00:34:53] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:53] [config] max-length: 50
[2023-07-23 00:34:53] [config] max-length-crop: true
[2023-07-23 00:34:53] [config] max-length-factor: 3
[2023-07-23 00:34:53] [config] maxi-batch: 100
[2023-07-23 00:34:53] [config] maxi-batch-sort: trg
[2023-07-23 00:34:53] [config] mini-batch: 64
[2023-07-23 00:34:53] [config] mini-batch-fit: true
[2023-07-23 00:34:53] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:53] [config] mini-batch-round-up: true
[2023-07-23 00:34:53] [config] mini-batch-track-lr: false
[2023-07-23 00:34:53] [config] mini-batch-warmup: 0
[2023-07-23 00:34:53] [config] mini-batch-words: 0
[2023-07-23 00:34:53] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:53] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:53] [config] multi-loss-type: sum
[2023-07-23 00:34:53] [config] n-best: false
[2023-07-23 00:34:53] [config] no-nccl: false
[2023-07-23 00:34:53] [config] no-reload: false
[2023-07-23 00:34:53] [config] no-restore-corpus: false
[2023-07-23 00:34:53] [config] normalize: 0
[2023-07-23 00:34:53] [config] normalize-gradient: false
[2023-07-23 00:34:53] [config] num-devices: 0
[2023-07-23 00:34:53] [config] optimizer: adam
[2023-07-23 00:34:53] [config] optimizer-delay: 1
[2023-07-23 00:34:53] [config] optimizer-params:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] output-omit-bias: false
[2023-07-23 00:34:53] [config] overwrite: true
[2023-07-23 00:34:53] [config] precision:
[2023-07-23 00:34:53] [config]   - float16
[2023-07-23 00:34:53] [config]   - float32
[2023-07-23 00:34:53] [config] pretrained-model: ""
[2023-07-23 00:34:53] [config] quantize-biases: false
[2023-07-23 00:34:53] [config] quantize-bits: 0
[2023-07-23 00:34:53] [config] quantize-log-based: false
[2023-07-23 00:34:53] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:53] [config] quiet: false
[2023-07-23 00:34:53] [config] quiet-translation: true
[2023-07-23 00:34:53] [config] relative-paths: false
[2023-07-23 00:34:53] [config] right-left: false
[2023-07-23 00:34:53] [config] save-freq: 10000u
[2023-07-23 00:34:53] [config] seed: 1234
[2023-07-23 00:34:53] [config] sentencepiece-alphas:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:53] [config] sentencepiece-options: ""
[2023-07-23 00:34:53] [config] sharding: global
[2023-07-23 00:34:53] [config] shuffle: data
[2023-07-23 00:34:53] [config] shuffle-in-ram: false
[2023-07-23 00:34:53] [config] sigterm: save-and-exit
[2023-07-23 00:34:53] [config] skip: false
[2023-07-23 00:34:53] [config] sqlite: ""
[2023-07-23 00:34:53] [config] sqlite-drop: false
[2023-07-23 00:34:53] [config] sync-freq: 200u
[2023-07-23 00:34:53] [config] sync-sgd: false
[2023-07-23 00:34:53] [config] tempdir: /tmp
[2023-07-23 00:34:53] [config] tied-embeddings: false
[2023-07-23 00:34:53] [config] tied-embeddings-all: true
[2023-07-23 00:34:53] [config] tied-embeddings-src: false
[2023-07-23 00:34:53] [config] train-embedder-rank:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] train-sets:
[2023-07-23 00:34:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:53] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:53] [config] transformer-aan-activation: swish
[2023-07-23 00:34:53] [config] transformer-aan-depth: 2
[2023-07-23 00:34:53] [config] transformer-aan-nogate: false
[2023-07-23 00:34:53] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:53] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:53] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:53] [config] transformer-depth-scaling: false
[2023-07-23 00:34:53] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:53] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:53] [config] transformer-dropout: 0
[2023-07-23 00:34:53] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:53] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:53] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:53] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:53] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:53] [config] transformer-heads: 8
[2023-07-23 00:34:53] [config] transformer-no-projection: false
[2023-07-23 00:34:53] [config] transformer-pool: false
[2023-07-23 00:34:53] [config] transformer-postprocess: dan
[2023-07-23 00:34:53] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:53] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:53] [config] transformer-preprocess: ""
[2023-07-23 00:34:53] [config] transformer-tied-layers:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:53] [config] tsv: false
[2023-07-23 00:34:53] [config] tsv-fields: 0
[2023-07-23 00:34:53] [config] type: amun
[2023-07-23 00:34:53] [config] ulr: false
[2023-07-23 00:34:53] [config] ulr-dim-emb: 0
[2023-07-23 00:34:53] [config] ulr-dropout: 0
[2023-07-23 00:34:53] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:53] [config] ulr-query-vectors: ""
[2023-07-23 00:34:53] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:53] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:53] [config] unlikelihood-loss: false
[2023-07-23 00:34:53] [config] valid-freq: 50000000
[2023-07-23 00:34:53] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:53] [config] valid-max-length: 1000
[2023-07-23 00:34:53] [config] valid-metrics:
[2023-07-23 00:34:53] [config]   - cross-entropy
[2023-07-23 00:34:53] [config]   - translation
[2023-07-23 00:34:53] [config] valid-mini-batch: 32
[2023-07-23 00:34:53] [config] valid-reset-stalled: false
[2023-07-23 00:34:53] [config] valid-script-args:
[2023-07-23 00:34:53] [config]   []
[2023-07-23 00:34:53] [config] valid-script-path: ""
[2023-07-23 00:34:53] [config] valid-sets:
[2023-07-23 00:34:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:53] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:53] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:53] [config] vocabs:
[2023-07-23 00:34:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:53] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:53] [config] word-penalty: 0
[2023-07-23 00:34:53] [config] word-scores: false
[2023-07-23 00:34:53] [config] workspace: 5500
[2023-07-23 00:34:53] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:53] [training] Using single-device training
[2023-07-23 00:34:53] Synced seed 1234
[2023-07-23 00:34:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:53] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:53] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:53] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:53] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:53] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:53] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:54] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:54] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x56456bccf692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x56456bc10da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x56456bc151a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x56456bc1c2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x56456bdc8a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x56456bdc9a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x56456bda2bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x56456b8a4108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x56456b7c62c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x56456b77db9c]    main                                               + 0x3c
[0x7f70439370b3]    __libc_start_main                                  + 0xf3
[0x56456b7c4cbe]    _start                                             + 0x2e

[2023-07-23 00:34:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:57] [marian] Running on node23.datos.cluster.uy as process 6841 with command line:
[2023-07-23 00:34:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:34:57] [config] after: 0e
[2023-07-23 00:34:57] [config] after-batches: 0
[2023-07-23 00:34:57] [config] after-epochs: 100
[2023-07-23 00:34:57] [config] all-caps-every: 0
[2023-07-23 00:34:57] [config] allow-unk: false
[2023-07-23 00:34:57] [config] authors: false
[2023-07-23 00:34:57] [config] beam-size: 12
[2023-07-23 00:34:57] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:34:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:34:57] [config] bert-masking-fraction: 0.15
[2023-07-23 00:34:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:34:57] [config] bert-train-type-embeddings: true
[2023-07-23 00:34:57] [config] bert-type-vocab-size: 2
[2023-07-23 00:34:57] [config] build-info: ""
[2023-07-23 00:34:57] [config] check-gradient-nan: false
[2023-07-23 00:34:57] [config] check-nan: false
[2023-07-23 00:34:57] [config] cite: false
[2023-07-23 00:34:57] [config] clip-norm: 1
[2023-07-23 00:34:57] [config] cost-scaling:
[2023-07-23 00:34:57] [config]   - 256.f
[2023-07-23 00:34:57] [config]   - 1000
[2023-07-23 00:34:57] [config]   - 2.f
[2023-07-23 00:34:57] [config]   - 256.f
[2023-07-23 00:34:57] [config] cost-type: ce-sum
[2023-07-23 00:34:57] [config] cpu-threads: 0
[2023-07-23 00:34:57] [config] data-threads: 8
[2023-07-23 00:34:57] [config] data-weighting: ""
[2023-07-23 00:34:57] [config] data-weighting-type: sentence
[2023-07-23 00:34:57] [config] dec-cell: gru
[2023-07-23 00:34:57] [config] dec-cell-base-depth: 2
[2023-07-23 00:34:57] [config] dec-cell-high-depth: 1
[2023-07-23 00:34:57] [config] dec-depth: 1
[2023-07-23 00:34:57] [config] devices:
[2023-07-23 00:34:57] [config]   - 0
[2023-07-23 00:34:57] [config] dim-emb: 512
[2023-07-23 00:34:57] [config] dim-rnn: 1024
[2023-07-23 00:34:57] [config] dim-vocabs:
[2023-07-23 00:34:57] [config]   - 16384
[2023-07-23 00:34:57] [config]   - 16384
[2023-07-23 00:34:57] [config] disp-first: 0
[2023-07-23 00:34:57] [config] disp-freq: 1000u
[2023-07-23 00:34:57] [config] disp-label-counts: true
[2023-07-23 00:34:57] [config] dropout-rnn: 0
[2023-07-23 00:34:57] [config] dropout-src: 0
[2023-07-23 00:34:57] [config] dropout-trg: 0
[2023-07-23 00:34:57] [config] dump-config: ""
[2023-07-23 00:34:57] [config] dynamic-gradient-scaling:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] early-stopping: 200
[2023-07-23 00:34:57] [config] early-stopping-on: first
[2023-07-23 00:34:57] [config] embedding-fix-src: false
[2023-07-23 00:34:57] [config] embedding-fix-trg: false
[2023-07-23 00:34:57] [config] embedding-normalization: false
[2023-07-23 00:34:57] [config] embedding-vectors:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] enc-cell: lstm
[2023-07-23 00:34:57] [config] enc-cell-depth: 1
[2023-07-23 00:34:57] [config] enc-depth: 1
[2023-07-23 00:34:57] [config] enc-type: bidirectional
[2023-07-23 00:34:57] [config] english-title-case-every: 0
[2023-07-23 00:34:57] [config] exponential-smoothing: 0
[2023-07-23 00:34:57] [config] factor-weight: 1
[2023-07-23 00:34:57] [config] factors-combine: sum
[2023-07-23 00:34:57] [config] factors-dim-emb: 0
[2023-07-23 00:34:57] [config] gradient-checkpointing: false
[2023-07-23 00:34:57] [config] gradient-norm-average-window: 100
[2023-07-23 00:34:57] [config] guided-alignment: none
[2023-07-23 00:34:57] [config] guided-alignment-cost: mse
[2023-07-23 00:34:57] [config] guided-alignment-weight: 0.1
[2023-07-23 00:34:57] [config] ignore-model-config: false
[2023-07-23 00:34:57] [config] input-types:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] interpolate-env-vars: false
[2023-07-23 00:34:57] [config] keep-best: false
[2023-07-23 00:34:57] [config] label-smoothing: 0
[2023-07-23 00:34:57] [config] layer-normalization: false
[2023-07-23 00:34:57] [config] learn-rate: 0.0001
[2023-07-23 00:34:57] [config] lemma-dependency: ""
[2023-07-23 00:34:57] [config] lemma-dim-emb: 0
[2023-07-23 00:34:57] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:57] [config] log-level: info
[2023-07-23 00:34:57] [config] log-time-zone: ""
[2023-07-23 00:34:57] [config] logical-epoch:
[2023-07-23 00:34:57] [config]   - 1e
[2023-07-23 00:34:57] [config]   - 0
[2023-07-23 00:34:57] [config] lr-decay: 0
[2023-07-23 00:34:57] [config] lr-decay-freq: 50000
[2023-07-23 00:34:57] [config] lr-decay-inv-sqrt:
[2023-07-23 00:34:57] [config]   - 0
[2023-07-23 00:34:57] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:34:57] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:34:57] [config] lr-decay-start:
[2023-07-23 00:34:57] [config]   - 10
[2023-07-23 00:34:57] [config]   - 1
[2023-07-23 00:34:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:34:57] [config] lr-report: false
[2023-07-23 00:34:57] [config] lr-warmup: 0
[2023-07-23 00:34:57] [config] lr-warmup-at-reload: false
[2023-07-23 00:34:57] [config] lr-warmup-cycle: false
[2023-07-23 00:34:57] [config] lr-warmup-start-rate: 0
[2023-07-23 00:34:57] [config] max-length: 50
[2023-07-23 00:34:57] [config] max-length-crop: true
[2023-07-23 00:34:57] [config] max-length-factor: 3
[2023-07-23 00:34:57] [config] maxi-batch: 100
[2023-07-23 00:34:57] [config] maxi-batch-sort: trg
[2023-07-23 00:34:57] [config] mini-batch: 64
[2023-07-23 00:34:57] [config] mini-batch-fit: true
[2023-07-23 00:34:57] [config] mini-batch-fit-step: 10
[2023-07-23 00:34:57] [config] mini-batch-round-up: true
[2023-07-23 00:34:57] [config] mini-batch-track-lr: false
[2023-07-23 00:34:57] [config] mini-batch-warmup: 0
[2023-07-23 00:34:57] [config] mini-batch-words: 0
[2023-07-23 00:34:57] [config] mini-batch-words-ref: 0
[2023-07-23 00:34:57] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:34:57] [config] multi-loss-type: sum
[2023-07-23 00:34:57] [config] n-best: false
[2023-07-23 00:34:57] [config] no-nccl: false
[2023-07-23 00:34:57] [config] no-reload: false
[2023-07-23 00:34:57] [config] no-restore-corpus: false
[2023-07-23 00:34:57] [config] normalize: 0
[2023-07-23 00:34:57] [config] normalize-gradient: false
[2023-07-23 00:34:57] [config] num-devices: 0
[2023-07-23 00:34:57] [config] optimizer: adam
[2023-07-23 00:34:57] [config] optimizer-delay: 1
[2023-07-23 00:34:57] [config] optimizer-params:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] output-omit-bias: false
[2023-07-23 00:34:57] [config] overwrite: true
[2023-07-23 00:34:57] [config] precision:
[2023-07-23 00:34:57] [config]   - float16
[2023-07-23 00:34:57] [config]   - float32
[2023-07-23 00:34:57] [config] pretrained-model: ""
[2023-07-23 00:34:57] [config] quantize-biases: false
[2023-07-23 00:34:57] [config] quantize-bits: 0
[2023-07-23 00:34:57] [config] quantize-log-based: false
[2023-07-23 00:34:57] [config] quantize-optimization-steps: 0
[2023-07-23 00:34:57] [config] quiet: false
[2023-07-23 00:34:57] [config] quiet-translation: true
[2023-07-23 00:34:57] [config] relative-paths: false
[2023-07-23 00:34:57] [config] right-left: false
[2023-07-23 00:34:57] [config] save-freq: 10000u
[2023-07-23 00:34:57] [config] seed: 1234
[2023-07-23 00:34:57] [config] sentencepiece-alphas:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:34:57] [config] sentencepiece-options: ""
[2023-07-23 00:34:57] [config] sharding: global
[2023-07-23 00:34:57] [config] shuffle: data
[2023-07-23 00:34:57] [config] shuffle-in-ram: false
[2023-07-23 00:34:57] [config] sigterm: save-and-exit
[2023-07-23 00:34:57] [config] skip: false
[2023-07-23 00:34:57] [config] sqlite: ""
[2023-07-23 00:34:57] [config] sqlite-drop: false
[2023-07-23 00:34:57] [config] sync-freq: 200u
[2023-07-23 00:34:57] [config] sync-sgd: false
[2023-07-23 00:34:57] [config] tempdir: /tmp
[2023-07-23 00:34:57] [config] tied-embeddings: false
[2023-07-23 00:34:57] [config] tied-embeddings-all: true
[2023-07-23 00:34:57] [config] tied-embeddings-src: false
[2023-07-23 00:34:57] [config] train-embedder-rank:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] train-sets:
[2023-07-23 00:34:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:34:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:34:57] [config] transformer-aan-activation: swish
[2023-07-23 00:34:57] [config] transformer-aan-depth: 2
[2023-07-23 00:34:57] [config] transformer-aan-nogate: false
[2023-07-23 00:34:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:34:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:34:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:34:57] [config] transformer-depth-scaling: false
[2023-07-23 00:34:57] [config] transformer-dim-aan: 2048
[2023-07-23 00:34:57] [config] transformer-dim-ffn: 2048
[2023-07-23 00:34:57] [config] transformer-dropout: 0
[2023-07-23 00:34:57] [config] transformer-dropout-attention: 0
[2023-07-23 00:34:57] [config] transformer-dropout-ffn: 0
[2023-07-23 00:34:57] [config] transformer-ffn-activation: swish
[2023-07-23 00:34:57] [config] transformer-ffn-depth: 2
[2023-07-23 00:34:57] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:34:57] [config] transformer-heads: 8
[2023-07-23 00:34:57] [config] transformer-no-projection: false
[2023-07-23 00:34:57] [config] transformer-pool: false
[2023-07-23 00:34:57] [config] transformer-postprocess: dan
[2023-07-23 00:34:57] [config] transformer-postprocess-emb: d
[2023-07-23 00:34:57] [config] transformer-postprocess-top: ""
[2023-07-23 00:34:57] [config] transformer-preprocess: ""
[2023-07-23 00:34:57] [config] transformer-tied-layers:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] transformer-train-position-embeddings: false
[2023-07-23 00:34:57] [config] tsv: false
[2023-07-23 00:34:57] [config] tsv-fields: 0
[2023-07-23 00:34:57] [config] type: amun
[2023-07-23 00:34:57] [config] ulr: false
[2023-07-23 00:34:57] [config] ulr-dim-emb: 0
[2023-07-23 00:34:57] [config] ulr-dropout: 0
[2023-07-23 00:34:57] [config] ulr-keys-vectors: ""
[2023-07-23 00:34:57] [config] ulr-query-vectors: ""
[2023-07-23 00:34:57] [config] ulr-softmax-temperature: 1
[2023-07-23 00:34:57] [config] ulr-trainable-transformation: false
[2023-07-23 00:34:57] [config] unlikelihood-loss: false
[2023-07-23 00:34:57] [config] valid-freq: 50000000
[2023-07-23 00:34:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:34:57] [config] valid-max-length: 1000
[2023-07-23 00:34:57] [config] valid-metrics:
[2023-07-23 00:34:57] [config]   - cross-entropy
[2023-07-23 00:34:57] [config]   - translation
[2023-07-23 00:34:57] [config] valid-mini-batch: 32
[2023-07-23 00:34:57] [config] valid-reset-stalled: false
[2023-07-23 00:34:57] [config] valid-script-args:
[2023-07-23 00:34:57] [config]   []
[2023-07-23 00:34:57] [config] valid-script-path: ""
[2023-07-23 00:34:57] [config] valid-sets:
[2023-07-23 00:34:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:34:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:34:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:34:57] [config] vocabs:
[2023-07-23 00:34:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:57] [config] word-penalty: 0
[2023-07-23 00:34:57] [config] word-scores: false
[2023-07-23 00:34:57] [config] workspace: 5500
[2023-07-23 00:34:57] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:34:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:57] [training] Using single-device training
[2023-07-23 00:34:58] Synced seed 1234
[2023-07-23 00:34:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:34:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:34:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:34:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:34:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:34:58] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:34:58] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:34:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:34:59] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:34:59] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x563d9ea4b692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x563d9e98cda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x563d9e9911a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x563d9e9982ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x563d9eb44a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x563d9eb45a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x563d9eb1ebee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x563d9e620108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x563d9e5422c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563d9e4f9b9c]    main                                               + 0x3c
[0x7f11f43e40b3]    __libc_start_main                                  + 0xf3
[0x563d9e540cbe]    _start                                             + 0x2e

[2023-07-23 00:35:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:02] [marian] Running on node23.datos.cluster.uy as process 6869 with command line:
[2023-07-23 00:35:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:02] [config] after: 0e
[2023-07-23 00:35:02] [config] after-batches: 0
[2023-07-23 00:35:02] [config] after-epochs: 110
[2023-07-23 00:35:02] [config] all-caps-every: 0
[2023-07-23 00:35:02] [config] allow-unk: false
[2023-07-23 00:35:02] [config] authors: false
[2023-07-23 00:35:02] [config] beam-size: 12
[2023-07-23 00:35:02] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:02] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:02] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:02] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:02] [config] build-info: ""
[2023-07-23 00:35:02] [config] check-gradient-nan: false
[2023-07-23 00:35:02] [config] check-nan: false
[2023-07-23 00:35:02] [config] cite: false
[2023-07-23 00:35:02] [config] clip-norm: 1
[2023-07-23 00:35:02] [config] cost-scaling:
[2023-07-23 00:35:02] [config]   - 256.f
[2023-07-23 00:35:02] [config]   - 1000
[2023-07-23 00:35:02] [config]   - 2.f
[2023-07-23 00:35:02] [config]   - 256.f
[2023-07-23 00:35:02] [config] cost-type: ce-sum
[2023-07-23 00:35:02] [config] cpu-threads: 0
[2023-07-23 00:35:02] [config] data-threads: 8
[2023-07-23 00:35:02] [config] data-weighting: ""
[2023-07-23 00:35:02] [config] data-weighting-type: sentence
[2023-07-23 00:35:02] [config] dec-cell: gru
[2023-07-23 00:35:02] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:02] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:02] [config] dec-depth: 1
[2023-07-23 00:35:02] [config] devices:
[2023-07-23 00:35:02] [config]   - 0
[2023-07-23 00:35:02] [config] dim-emb: 512
[2023-07-23 00:35:02] [config] dim-rnn: 1024
[2023-07-23 00:35:02] [config] dim-vocabs:
[2023-07-23 00:35:02] [config]   - 16384
[2023-07-23 00:35:02] [config]   - 16384
[2023-07-23 00:35:02] [config] disp-first: 0
[2023-07-23 00:35:02] [config] disp-freq: 1000u
[2023-07-23 00:35:02] [config] disp-label-counts: true
[2023-07-23 00:35:02] [config] dropout-rnn: 0
[2023-07-23 00:35:02] [config] dropout-src: 0
[2023-07-23 00:35:02] [config] dropout-trg: 0
[2023-07-23 00:35:02] [config] dump-config: ""
[2023-07-23 00:35:02] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] early-stopping: 200
[2023-07-23 00:35:02] [config] early-stopping-on: first
[2023-07-23 00:35:02] [config] embedding-fix-src: false
[2023-07-23 00:35:02] [config] embedding-fix-trg: false
[2023-07-23 00:35:02] [config] embedding-normalization: false
[2023-07-23 00:35:02] [config] embedding-vectors:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] enc-cell: lstm
[2023-07-23 00:35:02] [config] enc-cell-depth: 1
[2023-07-23 00:35:02] [config] enc-depth: 1
[2023-07-23 00:35:02] [config] enc-type: bidirectional
[2023-07-23 00:35:02] [config] english-title-case-every: 0
[2023-07-23 00:35:02] [config] exponential-smoothing: 0
[2023-07-23 00:35:02] [config] factor-weight: 1
[2023-07-23 00:35:02] [config] factors-combine: sum
[2023-07-23 00:35:02] [config] factors-dim-emb: 0
[2023-07-23 00:35:02] [config] gradient-checkpointing: false
[2023-07-23 00:35:02] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:02] [config] guided-alignment: none
[2023-07-23 00:35:02] [config] guided-alignment-cost: mse
[2023-07-23 00:35:02] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:02] [config] ignore-model-config: false
[2023-07-23 00:35:02] [config] input-types:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] interpolate-env-vars: false
[2023-07-23 00:35:02] [config] keep-best: false
[2023-07-23 00:35:02] [config] label-smoothing: 0
[2023-07-23 00:35:02] [config] layer-normalization: false
[2023-07-23 00:35:02] [config] learn-rate: 0.0001
[2023-07-23 00:35:02] [config] lemma-dependency: ""
[2023-07-23 00:35:02] [config] lemma-dim-emb: 0
[2023-07-23 00:35:02] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:02] [config] log-level: info
[2023-07-23 00:35:02] [config] log-time-zone: ""
[2023-07-23 00:35:02] [config] logical-epoch:
[2023-07-23 00:35:02] [config]   - 1e
[2023-07-23 00:35:02] [config]   - 0
[2023-07-23 00:35:02] [config] lr-decay: 0
[2023-07-23 00:35:02] [config] lr-decay-freq: 50000
[2023-07-23 00:35:02] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:02] [config]   - 0
[2023-07-23 00:35:02] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:02] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:02] [config] lr-decay-start:
[2023-07-23 00:35:02] [config]   - 10
[2023-07-23 00:35:02] [config]   - 1
[2023-07-23 00:35:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:02] [config] lr-report: false
[2023-07-23 00:35:02] [config] lr-warmup: 0
[2023-07-23 00:35:02] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:02] [config] lr-warmup-cycle: false
[2023-07-23 00:35:02] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:02] [config] max-length: 50
[2023-07-23 00:35:02] [config] max-length-crop: true
[2023-07-23 00:35:02] [config] max-length-factor: 3
[2023-07-23 00:35:02] [config] maxi-batch: 100
[2023-07-23 00:35:02] [config] maxi-batch-sort: trg
[2023-07-23 00:35:02] [config] mini-batch: 64
[2023-07-23 00:35:02] [config] mini-batch-fit: true
[2023-07-23 00:35:02] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:02] [config] mini-batch-round-up: true
[2023-07-23 00:35:02] [config] mini-batch-track-lr: false
[2023-07-23 00:35:02] [config] mini-batch-warmup: 0
[2023-07-23 00:35:02] [config] mini-batch-words: 0
[2023-07-23 00:35:02] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:02] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:02] [config] multi-loss-type: sum
[2023-07-23 00:35:02] [config] n-best: false
[2023-07-23 00:35:02] [config] no-nccl: false
[2023-07-23 00:35:02] [config] no-reload: false
[2023-07-23 00:35:02] [config] no-restore-corpus: false
[2023-07-23 00:35:02] [config] normalize: 0
[2023-07-23 00:35:02] [config] normalize-gradient: false
[2023-07-23 00:35:02] [config] num-devices: 0
[2023-07-23 00:35:02] [config] optimizer: adam
[2023-07-23 00:35:02] [config] optimizer-delay: 1
[2023-07-23 00:35:02] [config] optimizer-params:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] output-omit-bias: false
[2023-07-23 00:35:02] [config] overwrite: true
[2023-07-23 00:35:02] [config] precision:
[2023-07-23 00:35:02] [config]   - float16
[2023-07-23 00:35:02] [config]   - float32
[2023-07-23 00:35:02] [config] pretrained-model: ""
[2023-07-23 00:35:02] [config] quantize-biases: false
[2023-07-23 00:35:02] [config] quantize-bits: 0
[2023-07-23 00:35:02] [config] quantize-log-based: false
[2023-07-23 00:35:02] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:02] [config] quiet: false
[2023-07-23 00:35:02] [config] quiet-translation: true
[2023-07-23 00:35:02] [config] relative-paths: false
[2023-07-23 00:35:02] [config] right-left: false
[2023-07-23 00:35:02] [config] save-freq: 10000u
[2023-07-23 00:35:02] [config] seed: 1234
[2023-07-23 00:35:02] [config] sentencepiece-alphas:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:02] [config] sentencepiece-options: ""
[2023-07-23 00:35:02] [config] sharding: global
[2023-07-23 00:35:02] [config] shuffle: data
[2023-07-23 00:35:02] [config] shuffle-in-ram: false
[2023-07-23 00:35:02] [config] sigterm: save-and-exit
[2023-07-23 00:35:02] [config] skip: false
[2023-07-23 00:35:02] [config] sqlite: ""
[2023-07-23 00:35:02] [config] sqlite-drop: false
[2023-07-23 00:35:02] [config] sync-freq: 200u
[2023-07-23 00:35:02] [config] sync-sgd: false
[2023-07-23 00:35:02] [config] tempdir: /tmp
[2023-07-23 00:35:02] [config] tied-embeddings: false
[2023-07-23 00:35:02] [config] tied-embeddings-all: true
[2023-07-23 00:35:02] [config] tied-embeddings-src: false
[2023-07-23 00:35:02] [config] train-embedder-rank:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] train-sets:
[2023-07-23 00:35:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:02] [config] transformer-aan-activation: swish
[2023-07-23 00:35:02] [config] transformer-aan-depth: 2
[2023-07-23 00:35:02] [config] transformer-aan-nogate: false
[2023-07-23 00:35:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:02] [config] transformer-depth-scaling: false
[2023-07-23 00:35:02] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:02] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:02] [config] transformer-dropout: 0
[2023-07-23 00:35:02] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:02] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:02] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:02] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:02] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:02] [config] transformer-heads: 8
[2023-07-23 00:35:02] [config] transformer-no-projection: false
[2023-07-23 00:35:02] [config] transformer-pool: false
[2023-07-23 00:35:02] [config] transformer-postprocess: dan
[2023-07-23 00:35:02] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:02] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:02] [config] transformer-preprocess: ""
[2023-07-23 00:35:02] [config] transformer-tied-layers:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:02] [config] tsv: false
[2023-07-23 00:35:02] [config] tsv-fields: 0
[2023-07-23 00:35:02] [config] type: amun
[2023-07-23 00:35:02] [config] ulr: false
[2023-07-23 00:35:02] [config] ulr-dim-emb: 0
[2023-07-23 00:35:02] [config] ulr-dropout: 0
[2023-07-23 00:35:02] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:02] [config] ulr-query-vectors: ""
[2023-07-23 00:35:02] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:02] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:02] [config] unlikelihood-loss: false
[2023-07-23 00:35:02] [config] valid-freq: 50000000
[2023-07-23 00:35:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:02] [config] valid-max-length: 1000
[2023-07-23 00:35:02] [config] valid-metrics:
[2023-07-23 00:35:02] [config]   - cross-entropy
[2023-07-23 00:35:02] [config]   - translation
[2023-07-23 00:35:02] [config] valid-mini-batch: 32
[2023-07-23 00:35:02] [config] valid-reset-stalled: false
[2023-07-23 00:35:02] [config] valid-script-args:
[2023-07-23 00:35:02] [config]   []
[2023-07-23 00:35:02] [config] valid-script-path: ""
[2023-07-23 00:35:02] [config] valid-sets:
[2023-07-23 00:35:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:02] [config] vocabs:
[2023-07-23 00:35:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:02] [config] word-penalty: 0
[2023-07-23 00:35:02] [config] word-scores: false
[2023-07-23 00:35:02] [config] workspace: 5500
[2023-07-23 00:35:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:02] [training] Using single-device training
[2023-07-23 00:35:03] Synced seed 1234
[2023-07-23 00:35:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:04] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:04] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55bdc3b66692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55bdc3aa7da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55bdc3aac1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55bdc3ab32ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55bdc3c5fa0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55bdc3c60a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55bdc3c39bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55bdc373b108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55bdc365d2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55bdc3614b9c]    main                                               + 0x3c
[0x7f27742fa0b3]    __libc_start_main                                  + 0xf3
[0x55bdc365bcbe]    _start                                             + 0x2e

[2023-07-23 00:35:07] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:07] [marian] Running on node23.datos.cluster.uy as process 6896 with command line:
[2023-07-23 00:35:07] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:07] [config] after: 0e
[2023-07-23 00:35:07] [config] after-batches: 0
[2023-07-23 00:35:07] [config] after-epochs: 120
[2023-07-23 00:35:07] [config] all-caps-every: 0
[2023-07-23 00:35:07] [config] allow-unk: false
[2023-07-23 00:35:07] [config] authors: false
[2023-07-23 00:35:07] [config] beam-size: 12
[2023-07-23 00:35:07] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:07] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:07] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:07] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:07] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:07] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:07] [config] build-info: ""
[2023-07-23 00:35:07] [config] check-gradient-nan: false
[2023-07-23 00:35:07] [config] check-nan: false
[2023-07-23 00:35:07] [config] cite: false
[2023-07-23 00:35:07] [config] clip-norm: 1
[2023-07-23 00:35:07] [config] cost-scaling:
[2023-07-23 00:35:07] [config]   - 256.f
[2023-07-23 00:35:07] [config]   - 1000
[2023-07-23 00:35:07] [config]   - 2.f
[2023-07-23 00:35:07] [config]   - 256.f
[2023-07-23 00:35:07] [config] cost-type: ce-sum
[2023-07-23 00:35:07] [config] cpu-threads: 0
[2023-07-23 00:35:07] [config] data-threads: 8
[2023-07-23 00:35:07] [config] data-weighting: ""
[2023-07-23 00:35:07] [config] data-weighting-type: sentence
[2023-07-23 00:35:07] [config] dec-cell: gru
[2023-07-23 00:35:07] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:07] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:07] [config] dec-depth: 1
[2023-07-23 00:35:07] [config] devices:
[2023-07-23 00:35:07] [config]   - 0
[2023-07-23 00:35:07] [config] dim-emb: 512
[2023-07-23 00:35:07] [config] dim-rnn: 1024
[2023-07-23 00:35:07] [config] dim-vocabs:
[2023-07-23 00:35:07] [config]   - 16384
[2023-07-23 00:35:07] [config]   - 16384
[2023-07-23 00:35:07] [config] disp-first: 0
[2023-07-23 00:35:07] [config] disp-freq: 1000u
[2023-07-23 00:35:07] [config] disp-label-counts: true
[2023-07-23 00:35:07] [config] dropout-rnn: 0
[2023-07-23 00:35:07] [config] dropout-src: 0
[2023-07-23 00:35:07] [config] dropout-trg: 0
[2023-07-23 00:35:07] [config] dump-config: ""
[2023-07-23 00:35:07] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] early-stopping: 200
[2023-07-23 00:35:07] [config] early-stopping-on: first
[2023-07-23 00:35:07] [config] embedding-fix-src: false
[2023-07-23 00:35:07] [config] embedding-fix-trg: false
[2023-07-23 00:35:07] [config] embedding-normalization: false
[2023-07-23 00:35:07] [config] embedding-vectors:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] enc-cell: lstm
[2023-07-23 00:35:07] [config] enc-cell-depth: 1
[2023-07-23 00:35:07] [config] enc-depth: 1
[2023-07-23 00:35:07] [config] enc-type: bidirectional
[2023-07-23 00:35:07] [config] english-title-case-every: 0
[2023-07-23 00:35:07] [config] exponential-smoothing: 0
[2023-07-23 00:35:07] [config] factor-weight: 1
[2023-07-23 00:35:07] [config] factors-combine: sum
[2023-07-23 00:35:07] [config] factors-dim-emb: 0
[2023-07-23 00:35:07] [config] gradient-checkpointing: false
[2023-07-23 00:35:07] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:07] [config] guided-alignment: none
[2023-07-23 00:35:07] [config] guided-alignment-cost: mse
[2023-07-23 00:35:07] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:07] [config] ignore-model-config: false
[2023-07-23 00:35:07] [config] input-types:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] interpolate-env-vars: false
[2023-07-23 00:35:07] [config] keep-best: false
[2023-07-23 00:35:07] [config] label-smoothing: 0
[2023-07-23 00:35:07] [config] layer-normalization: false
[2023-07-23 00:35:07] [config] learn-rate: 0.0001
[2023-07-23 00:35:07] [config] lemma-dependency: ""
[2023-07-23 00:35:07] [config] lemma-dim-emb: 0
[2023-07-23 00:35:07] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:07] [config] log-level: info
[2023-07-23 00:35:07] [config] log-time-zone: ""
[2023-07-23 00:35:07] [config] logical-epoch:
[2023-07-23 00:35:07] [config]   - 1e
[2023-07-23 00:35:07] [config]   - 0
[2023-07-23 00:35:07] [config] lr-decay: 0
[2023-07-23 00:35:07] [config] lr-decay-freq: 50000
[2023-07-23 00:35:07] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:07] [config]   - 0
[2023-07-23 00:35:07] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:07] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:07] [config] lr-decay-start:
[2023-07-23 00:35:07] [config]   - 10
[2023-07-23 00:35:07] [config]   - 1
[2023-07-23 00:35:07] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:07] [config] lr-report: false
[2023-07-23 00:35:07] [config] lr-warmup: 0
[2023-07-23 00:35:07] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:07] [config] lr-warmup-cycle: false
[2023-07-23 00:35:07] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:07] [config] max-length: 50
[2023-07-23 00:35:07] [config] max-length-crop: true
[2023-07-23 00:35:07] [config] max-length-factor: 3
[2023-07-23 00:35:07] [config] maxi-batch: 100
[2023-07-23 00:35:07] [config] maxi-batch-sort: trg
[2023-07-23 00:35:07] [config] mini-batch: 64
[2023-07-23 00:35:07] [config] mini-batch-fit: true
[2023-07-23 00:35:07] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:07] [config] mini-batch-round-up: true
[2023-07-23 00:35:07] [config] mini-batch-track-lr: false
[2023-07-23 00:35:07] [config] mini-batch-warmup: 0
[2023-07-23 00:35:07] [config] mini-batch-words: 0
[2023-07-23 00:35:07] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:07] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:07] [config] multi-loss-type: sum
[2023-07-23 00:35:07] [config] n-best: false
[2023-07-23 00:35:07] [config] no-nccl: false
[2023-07-23 00:35:07] [config] no-reload: false
[2023-07-23 00:35:07] [config] no-restore-corpus: false
[2023-07-23 00:35:07] [config] normalize: 0
[2023-07-23 00:35:07] [config] normalize-gradient: false
[2023-07-23 00:35:07] [config] num-devices: 0
[2023-07-23 00:35:07] [config] optimizer: adam
[2023-07-23 00:35:07] [config] optimizer-delay: 1
[2023-07-23 00:35:07] [config] optimizer-params:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] output-omit-bias: false
[2023-07-23 00:35:07] [config] overwrite: true
[2023-07-23 00:35:07] [config] precision:
[2023-07-23 00:35:07] [config]   - float16
[2023-07-23 00:35:07] [config]   - float32
[2023-07-23 00:35:07] [config] pretrained-model: ""
[2023-07-23 00:35:07] [config] quantize-biases: false
[2023-07-23 00:35:07] [config] quantize-bits: 0
[2023-07-23 00:35:07] [config] quantize-log-based: false
[2023-07-23 00:35:07] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:07] [config] quiet: false
[2023-07-23 00:35:07] [config] quiet-translation: true
[2023-07-23 00:35:07] [config] relative-paths: false
[2023-07-23 00:35:07] [config] right-left: false
[2023-07-23 00:35:07] [config] save-freq: 10000u
[2023-07-23 00:35:07] [config] seed: 1234
[2023-07-23 00:35:07] [config] sentencepiece-alphas:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:07] [config] sentencepiece-options: ""
[2023-07-23 00:35:07] [config] sharding: global
[2023-07-23 00:35:07] [config] shuffle: data
[2023-07-23 00:35:07] [config] shuffle-in-ram: false
[2023-07-23 00:35:07] [config] sigterm: save-and-exit
[2023-07-23 00:35:07] [config] skip: false
[2023-07-23 00:35:07] [config] sqlite: ""
[2023-07-23 00:35:07] [config] sqlite-drop: false
[2023-07-23 00:35:07] [config] sync-freq: 200u
[2023-07-23 00:35:07] [config] sync-sgd: false
[2023-07-23 00:35:07] [config] tempdir: /tmp
[2023-07-23 00:35:07] [config] tied-embeddings: false
[2023-07-23 00:35:07] [config] tied-embeddings-all: true
[2023-07-23 00:35:07] [config] tied-embeddings-src: false
[2023-07-23 00:35:07] [config] train-embedder-rank:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] train-sets:
[2023-07-23 00:35:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:07] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:07] [config] transformer-aan-activation: swish
[2023-07-23 00:35:07] [config] transformer-aan-depth: 2
[2023-07-23 00:35:07] [config] transformer-aan-nogate: false
[2023-07-23 00:35:07] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:07] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:07] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:07] [config] transformer-depth-scaling: false
[2023-07-23 00:35:07] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:07] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:07] [config] transformer-dropout: 0
[2023-07-23 00:35:07] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:07] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:07] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:07] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:07] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:07] [config] transformer-heads: 8
[2023-07-23 00:35:07] [config] transformer-no-projection: false
[2023-07-23 00:35:07] [config] transformer-pool: false
[2023-07-23 00:35:07] [config] transformer-postprocess: dan
[2023-07-23 00:35:07] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:07] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:07] [config] transformer-preprocess: ""
[2023-07-23 00:35:07] [config] transformer-tied-layers:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:07] [config] tsv: false
[2023-07-23 00:35:07] [config] tsv-fields: 0
[2023-07-23 00:35:07] [config] type: amun
[2023-07-23 00:35:07] [config] ulr: false
[2023-07-23 00:35:07] [config] ulr-dim-emb: 0
[2023-07-23 00:35:07] [config] ulr-dropout: 0
[2023-07-23 00:35:07] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:07] [config] ulr-query-vectors: ""
[2023-07-23 00:35:07] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:07] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:07] [config] unlikelihood-loss: false
[2023-07-23 00:35:07] [config] valid-freq: 50000000
[2023-07-23 00:35:07] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:07] [config] valid-max-length: 1000
[2023-07-23 00:35:07] [config] valid-metrics:
[2023-07-23 00:35:07] [config]   - cross-entropy
[2023-07-23 00:35:07] [config]   - translation
[2023-07-23 00:35:07] [config] valid-mini-batch: 32
[2023-07-23 00:35:07] [config] valid-reset-stalled: false
[2023-07-23 00:35:07] [config] valid-script-args:
[2023-07-23 00:35:07] [config]   []
[2023-07-23 00:35:07] [config] valid-script-path: ""
[2023-07-23 00:35:07] [config] valid-sets:
[2023-07-23 00:35:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:07] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:07] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:07] [config] vocabs:
[2023-07-23 00:35:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:07] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:07] [config] word-penalty: 0
[2023-07-23 00:35:07] [config] word-scores: false
[2023-07-23 00:35:07] [config] workspace: 5500
[2023-07-23 00:35:07] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:07] [training] Using single-device training
[2023-07-23 00:35:07] Synced seed 1234
[2023-07-23 00:35:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:07] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:07] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:07] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:09] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:09] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55f87adcc692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55f87ad0dda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55f87ad121a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55f87ad192ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55f87aec5a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55f87aec6a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55f87ae9fbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55f87a9a1108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55f87a8c32c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55f87a87ab9c]    main                                               + 0x3c
[0x7f4f951700b3]    __libc_start_main                                  + 0xf3
[0x55f87a8c1cbe]    _start                                             + 0x2e

[2023-07-23 00:35:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:13] [marian] Running on node23.datos.cluster.uy as process 6923 with command line:
[2023-07-23 00:35:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:13] [config] after: 0e
[2023-07-23 00:35:13] [config] after-batches: 0
[2023-07-23 00:35:13] [config] after-epochs: 130
[2023-07-23 00:35:13] [config] all-caps-every: 0
[2023-07-23 00:35:13] [config] allow-unk: false
[2023-07-23 00:35:13] [config] authors: false
[2023-07-23 00:35:13] [config] beam-size: 12
[2023-07-23 00:35:13] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:13] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:13] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:13] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:13] [config] build-info: ""
[2023-07-23 00:35:13] [config] check-gradient-nan: false
[2023-07-23 00:35:13] [config] check-nan: false
[2023-07-23 00:35:13] [config] cite: false
[2023-07-23 00:35:13] [config] clip-norm: 1
[2023-07-23 00:35:13] [config] cost-scaling:
[2023-07-23 00:35:13] [config]   - 256.f
[2023-07-23 00:35:13] [config]   - 1000
[2023-07-23 00:35:13] [config]   - 2.f
[2023-07-23 00:35:13] [config]   - 256.f
[2023-07-23 00:35:13] [config] cost-type: ce-sum
[2023-07-23 00:35:13] [config] cpu-threads: 0
[2023-07-23 00:35:13] [config] data-threads: 8
[2023-07-23 00:35:13] [config] data-weighting: ""
[2023-07-23 00:35:13] [config] data-weighting-type: sentence
[2023-07-23 00:35:13] [config] dec-cell: gru
[2023-07-23 00:35:13] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:13] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:13] [config] dec-depth: 1
[2023-07-23 00:35:13] [config] devices:
[2023-07-23 00:35:13] [config]   - 0
[2023-07-23 00:35:13] [config] dim-emb: 512
[2023-07-23 00:35:13] [config] dim-rnn: 1024
[2023-07-23 00:35:13] [config] dim-vocabs:
[2023-07-23 00:35:13] [config]   - 16384
[2023-07-23 00:35:13] [config]   - 16384
[2023-07-23 00:35:13] [config] disp-first: 0
[2023-07-23 00:35:13] [config] disp-freq: 1000u
[2023-07-23 00:35:13] [config] disp-label-counts: true
[2023-07-23 00:35:13] [config] dropout-rnn: 0
[2023-07-23 00:35:13] [config] dropout-src: 0
[2023-07-23 00:35:13] [config] dropout-trg: 0
[2023-07-23 00:35:13] [config] dump-config: ""
[2023-07-23 00:35:13] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] early-stopping: 200
[2023-07-23 00:35:13] [config] early-stopping-on: first
[2023-07-23 00:35:13] [config] embedding-fix-src: false
[2023-07-23 00:35:13] [config] embedding-fix-trg: false
[2023-07-23 00:35:13] [config] embedding-normalization: false
[2023-07-23 00:35:13] [config] embedding-vectors:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] enc-cell: lstm
[2023-07-23 00:35:13] [config] enc-cell-depth: 1
[2023-07-23 00:35:13] [config] enc-depth: 1
[2023-07-23 00:35:13] [config] enc-type: bidirectional
[2023-07-23 00:35:13] [config] english-title-case-every: 0
[2023-07-23 00:35:13] [config] exponential-smoothing: 0
[2023-07-23 00:35:13] [config] factor-weight: 1
[2023-07-23 00:35:13] [config] factors-combine: sum
[2023-07-23 00:35:13] [config] factors-dim-emb: 0
[2023-07-23 00:35:13] [config] gradient-checkpointing: false
[2023-07-23 00:35:13] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:13] [config] guided-alignment: none
[2023-07-23 00:35:13] [config] guided-alignment-cost: mse
[2023-07-23 00:35:13] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:13] [config] ignore-model-config: false
[2023-07-23 00:35:13] [config] input-types:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] interpolate-env-vars: false
[2023-07-23 00:35:13] [config] keep-best: false
[2023-07-23 00:35:13] [config] label-smoothing: 0
[2023-07-23 00:35:13] [config] layer-normalization: false
[2023-07-23 00:35:13] [config] learn-rate: 0.0001
[2023-07-23 00:35:13] [config] lemma-dependency: ""
[2023-07-23 00:35:13] [config] lemma-dim-emb: 0
[2023-07-23 00:35:13] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:13] [config] log-level: info
[2023-07-23 00:35:13] [config] log-time-zone: ""
[2023-07-23 00:35:13] [config] logical-epoch:
[2023-07-23 00:35:13] [config]   - 1e
[2023-07-23 00:35:13] [config]   - 0
[2023-07-23 00:35:13] [config] lr-decay: 0
[2023-07-23 00:35:13] [config] lr-decay-freq: 50000
[2023-07-23 00:35:13] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:13] [config]   - 0
[2023-07-23 00:35:13] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:13] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:13] [config] lr-decay-start:
[2023-07-23 00:35:13] [config]   - 10
[2023-07-23 00:35:13] [config]   - 1
[2023-07-23 00:35:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:13] [config] lr-report: false
[2023-07-23 00:35:13] [config] lr-warmup: 0
[2023-07-23 00:35:13] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:13] [config] lr-warmup-cycle: false
[2023-07-23 00:35:13] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:13] [config] max-length: 50
[2023-07-23 00:35:13] [config] max-length-crop: true
[2023-07-23 00:35:13] [config] max-length-factor: 3
[2023-07-23 00:35:13] [config] maxi-batch: 100
[2023-07-23 00:35:13] [config] maxi-batch-sort: trg
[2023-07-23 00:35:13] [config] mini-batch: 64
[2023-07-23 00:35:13] [config] mini-batch-fit: true
[2023-07-23 00:35:13] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:13] [config] mini-batch-round-up: true
[2023-07-23 00:35:13] [config] mini-batch-track-lr: false
[2023-07-23 00:35:13] [config] mini-batch-warmup: 0
[2023-07-23 00:35:13] [config] mini-batch-words: 0
[2023-07-23 00:35:13] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:13] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:13] [config] multi-loss-type: sum
[2023-07-23 00:35:13] [config] n-best: false
[2023-07-23 00:35:13] [config] no-nccl: false
[2023-07-23 00:35:13] [config] no-reload: false
[2023-07-23 00:35:13] [config] no-restore-corpus: false
[2023-07-23 00:35:13] [config] normalize: 0
[2023-07-23 00:35:13] [config] normalize-gradient: false
[2023-07-23 00:35:13] [config] num-devices: 0
[2023-07-23 00:35:13] [config] optimizer: adam
[2023-07-23 00:35:13] [config] optimizer-delay: 1
[2023-07-23 00:35:13] [config] optimizer-params:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] output-omit-bias: false
[2023-07-23 00:35:13] [config] overwrite: true
[2023-07-23 00:35:13] [config] precision:
[2023-07-23 00:35:13] [config]   - float16
[2023-07-23 00:35:13] [config]   - float32
[2023-07-23 00:35:13] [config] pretrained-model: ""
[2023-07-23 00:35:13] [config] quantize-biases: false
[2023-07-23 00:35:13] [config] quantize-bits: 0
[2023-07-23 00:35:13] [config] quantize-log-based: false
[2023-07-23 00:35:13] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:13] [config] quiet: false
[2023-07-23 00:35:13] [config] quiet-translation: true
[2023-07-23 00:35:13] [config] relative-paths: false
[2023-07-23 00:35:13] [config] right-left: false
[2023-07-23 00:35:13] [config] save-freq: 10000u
[2023-07-23 00:35:13] [config] seed: 1234
[2023-07-23 00:35:13] [config] sentencepiece-alphas:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:13] [config] sentencepiece-options: ""
[2023-07-23 00:35:13] [config] sharding: global
[2023-07-23 00:35:13] [config] shuffle: data
[2023-07-23 00:35:13] [config] shuffle-in-ram: false
[2023-07-23 00:35:13] [config] sigterm: save-and-exit
[2023-07-23 00:35:13] [config] skip: false
[2023-07-23 00:35:13] [config] sqlite: ""
[2023-07-23 00:35:13] [config] sqlite-drop: false
[2023-07-23 00:35:13] [config] sync-freq: 200u
[2023-07-23 00:35:13] [config] sync-sgd: false
[2023-07-23 00:35:13] [config] tempdir: /tmp
[2023-07-23 00:35:13] [config] tied-embeddings: false
[2023-07-23 00:35:13] [config] tied-embeddings-all: true
[2023-07-23 00:35:13] [config] tied-embeddings-src: false
[2023-07-23 00:35:13] [config] train-embedder-rank:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] train-sets:
[2023-07-23 00:35:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:13] [config] transformer-aan-activation: swish
[2023-07-23 00:35:13] [config] transformer-aan-depth: 2
[2023-07-23 00:35:13] [config] transformer-aan-nogate: false
[2023-07-23 00:35:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:13] [config] transformer-depth-scaling: false
[2023-07-23 00:35:13] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:13] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:13] [config] transformer-dropout: 0
[2023-07-23 00:35:13] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:13] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:13] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:13] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:13] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:13] [config] transformer-heads: 8
[2023-07-23 00:35:13] [config] transformer-no-projection: false
[2023-07-23 00:35:13] [config] transformer-pool: false
[2023-07-23 00:35:13] [config] transformer-postprocess: dan
[2023-07-23 00:35:13] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:13] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:13] [config] transformer-preprocess: ""
[2023-07-23 00:35:13] [config] transformer-tied-layers:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:13] [config] tsv: false
[2023-07-23 00:35:13] [config] tsv-fields: 0
[2023-07-23 00:35:13] [config] type: amun
[2023-07-23 00:35:13] [config] ulr: false
[2023-07-23 00:35:13] [config] ulr-dim-emb: 0
[2023-07-23 00:35:13] [config] ulr-dropout: 0
[2023-07-23 00:35:13] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:13] [config] ulr-query-vectors: ""
[2023-07-23 00:35:13] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:13] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:13] [config] unlikelihood-loss: false
[2023-07-23 00:35:13] [config] valid-freq: 50000000
[2023-07-23 00:35:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:13] [config] valid-max-length: 1000
[2023-07-23 00:35:13] [config] valid-metrics:
[2023-07-23 00:35:13] [config]   - cross-entropy
[2023-07-23 00:35:13] [config]   - translation
[2023-07-23 00:35:13] [config] valid-mini-batch: 32
[2023-07-23 00:35:13] [config] valid-reset-stalled: false
[2023-07-23 00:35:13] [config] valid-script-args:
[2023-07-23 00:35:13] [config]   []
[2023-07-23 00:35:13] [config] valid-script-path: ""
[2023-07-23 00:35:13] [config] valid-sets:
[2023-07-23 00:35:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:13] [config] vocabs:
[2023-07-23 00:35:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:13] [config] word-penalty: 0
[2023-07-23 00:35:13] [config] word-scores: false
[2023-07-23 00:35:13] [config] workspace: 5500
[2023-07-23 00:35:13] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:13] [training] Using single-device training
[2023-07-23 00:35:13] Synced seed 1234
[2023-07-23 00:35:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:13] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:13] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:13] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:13] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:13] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:15] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:15] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x5626a8037692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x5626a7f78da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5626a7f7d1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5626a7f842ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5626a8130a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5626a8131a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5626a810abee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5626a7c0c108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5626a7b2e2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5626a7ae5b9c]    main                                               + 0x3c
[0x7f072d98d0b3]    __libc_start_main                                  + 0xf3
[0x5626a7b2ccbe]    _start                                             + 0x2e

[2023-07-23 00:35:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:18] [marian] Running on node23.datos.cluster.uy as process 6951 with command line:
[2023-07-23 00:35:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:18] [config] after: 0e
[2023-07-23 00:35:18] [config] after-batches: 0
[2023-07-23 00:35:18] [config] after-epochs: 140
[2023-07-23 00:35:18] [config] all-caps-every: 0
[2023-07-23 00:35:18] [config] allow-unk: false
[2023-07-23 00:35:18] [config] authors: false
[2023-07-23 00:35:18] [config] beam-size: 12
[2023-07-23 00:35:18] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:18] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:18] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:18] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:18] [config] build-info: ""
[2023-07-23 00:35:18] [config] check-gradient-nan: false
[2023-07-23 00:35:18] [config] check-nan: false
[2023-07-23 00:35:18] [config] cite: false
[2023-07-23 00:35:18] [config] clip-norm: 1
[2023-07-23 00:35:18] [config] cost-scaling:
[2023-07-23 00:35:18] [config]   - 256.f
[2023-07-23 00:35:18] [config]   - 1000
[2023-07-23 00:35:18] [config]   - 2.f
[2023-07-23 00:35:18] [config]   - 256.f
[2023-07-23 00:35:18] [config] cost-type: ce-sum
[2023-07-23 00:35:18] [config] cpu-threads: 0
[2023-07-23 00:35:18] [config] data-threads: 8
[2023-07-23 00:35:18] [config] data-weighting: ""
[2023-07-23 00:35:18] [config] data-weighting-type: sentence
[2023-07-23 00:35:18] [config] dec-cell: gru
[2023-07-23 00:35:18] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:18] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:18] [config] dec-depth: 1
[2023-07-23 00:35:18] [config] devices:
[2023-07-23 00:35:18] [config]   - 0
[2023-07-23 00:35:18] [config] dim-emb: 512
[2023-07-23 00:35:18] [config] dim-rnn: 1024
[2023-07-23 00:35:18] [config] dim-vocabs:
[2023-07-23 00:35:18] [config]   - 16384
[2023-07-23 00:35:18] [config]   - 16384
[2023-07-23 00:35:18] [config] disp-first: 0
[2023-07-23 00:35:18] [config] disp-freq: 1000u
[2023-07-23 00:35:18] [config] disp-label-counts: true
[2023-07-23 00:35:18] [config] dropout-rnn: 0
[2023-07-23 00:35:18] [config] dropout-src: 0
[2023-07-23 00:35:18] [config] dropout-trg: 0
[2023-07-23 00:35:18] [config] dump-config: ""
[2023-07-23 00:35:18] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] early-stopping: 200
[2023-07-23 00:35:18] [config] early-stopping-on: first
[2023-07-23 00:35:18] [config] embedding-fix-src: false
[2023-07-23 00:35:18] [config] embedding-fix-trg: false
[2023-07-23 00:35:18] [config] embedding-normalization: false
[2023-07-23 00:35:18] [config] embedding-vectors:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] enc-cell: lstm
[2023-07-23 00:35:18] [config] enc-cell-depth: 1
[2023-07-23 00:35:18] [config] enc-depth: 1
[2023-07-23 00:35:18] [config] enc-type: bidirectional
[2023-07-23 00:35:18] [config] english-title-case-every: 0
[2023-07-23 00:35:18] [config] exponential-smoothing: 0
[2023-07-23 00:35:18] [config] factor-weight: 1
[2023-07-23 00:35:18] [config] factors-combine: sum
[2023-07-23 00:35:18] [config] factors-dim-emb: 0
[2023-07-23 00:35:18] [config] gradient-checkpointing: false
[2023-07-23 00:35:18] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:18] [config] guided-alignment: none
[2023-07-23 00:35:18] [config] guided-alignment-cost: mse
[2023-07-23 00:35:18] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:18] [config] ignore-model-config: false
[2023-07-23 00:35:18] [config] input-types:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] interpolate-env-vars: false
[2023-07-23 00:35:18] [config] keep-best: false
[2023-07-23 00:35:18] [config] label-smoothing: 0
[2023-07-23 00:35:18] [config] layer-normalization: false
[2023-07-23 00:35:18] [config] learn-rate: 0.0001
[2023-07-23 00:35:18] [config] lemma-dependency: ""
[2023-07-23 00:35:18] [config] lemma-dim-emb: 0
[2023-07-23 00:35:18] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:18] [config] log-level: info
[2023-07-23 00:35:18] [config] log-time-zone: ""
[2023-07-23 00:35:18] [config] logical-epoch:
[2023-07-23 00:35:18] [config]   - 1e
[2023-07-23 00:35:18] [config]   - 0
[2023-07-23 00:35:18] [config] lr-decay: 0
[2023-07-23 00:35:18] [config] lr-decay-freq: 50000
[2023-07-23 00:35:18] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:18] [config]   - 0
[2023-07-23 00:35:18] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:18] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:18] [config] lr-decay-start:
[2023-07-23 00:35:18] [config]   - 10
[2023-07-23 00:35:18] [config]   - 1
[2023-07-23 00:35:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:18] [config] lr-report: false
[2023-07-23 00:35:18] [config] lr-warmup: 0
[2023-07-23 00:35:18] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:18] [config] lr-warmup-cycle: false
[2023-07-23 00:35:18] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:18] [config] max-length: 50
[2023-07-23 00:35:18] [config] max-length-crop: true
[2023-07-23 00:35:18] [config] max-length-factor: 3
[2023-07-23 00:35:18] [config] maxi-batch: 100
[2023-07-23 00:35:18] [config] maxi-batch-sort: trg
[2023-07-23 00:35:18] [config] mini-batch: 64
[2023-07-23 00:35:18] [config] mini-batch-fit: true
[2023-07-23 00:35:18] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:18] [config] mini-batch-round-up: true
[2023-07-23 00:35:18] [config] mini-batch-track-lr: false
[2023-07-23 00:35:18] [config] mini-batch-warmup: 0
[2023-07-23 00:35:18] [config] mini-batch-words: 0
[2023-07-23 00:35:18] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:18] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:18] [config] multi-loss-type: sum
[2023-07-23 00:35:18] [config] n-best: false
[2023-07-23 00:35:18] [config] no-nccl: false
[2023-07-23 00:35:18] [config] no-reload: false
[2023-07-23 00:35:18] [config] no-restore-corpus: false
[2023-07-23 00:35:18] [config] normalize: 0
[2023-07-23 00:35:18] [config] normalize-gradient: false
[2023-07-23 00:35:18] [config] num-devices: 0
[2023-07-23 00:35:18] [config] optimizer: adam
[2023-07-23 00:35:18] [config] optimizer-delay: 1
[2023-07-23 00:35:18] [config] optimizer-params:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] output-omit-bias: false
[2023-07-23 00:35:18] [config] overwrite: true
[2023-07-23 00:35:18] [config] precision:
[2023-07-23 00:35:18] [config]   - float16
[2023-07-23 00:35:18] [config]   - float32
[2023-07-23 00:35:18] [config] pretrained-model: ""
[2023-07-23 00:35:18] [config] quantize-biases: false
[2023-07-23 00:35:18] [config] quantize-bits: 0
[2023-07-23 00:35:18] [config] quantize-log-based: false
[2023-07-23 00:35:18] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:18] [config] quiet: false
[2023-07-23 00:35:18] [config] quiet-translation: true
[2023-07-23 00:35:18] [config] relative-paths: false
[2023-07-23 00:35:18] [config] right-left: false
[2023-07-23 00:35:18] [config] save-freq: 10000u
[2023-07-23 00:35:18] [config] seed: 1234
[2023-07-23 00:35:18] [config] sentencepiece-alphas:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:18] [config] sentencepiece-options: ""
[2023-07-23 00:35:18] [config] sharding: global
[2023-07-23 00:35:18] [config] shuffle: data
[2023-07-23 00:35:18] [config] shuffle-in-ram: false
[2023-07-23 00:35:18] [config] sigterm: save-and-exit
[2023-07-23 00:35:18] [config] skip: false
[2023-07-23 00:35:18] [config] sqlite: ""
[2023-07-23 00:35:18] [config] sqlite-drop: false
[2023-07-23 00:35:18] [config] sync-freq: 200u
[2023-07-23 00:35:18] [config] sync-sgd: false
[2023-07-23 00:35:18] [config] tempdir: /tmp
[2023-07-23 00:35:18] [config] tied-embeddings: false
[2023-07-23 00:35:18] [config] tied-embeddings-all: true
[2023-07-23 00:35:18] [config] tied-embeddings-src: false
[2023-07-23 00:35:18] [config] train-embedder-rank:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] train-sets:
[2023-07-23 00:35:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:18] [config] transformer-aan-activation: swish
[2023-07-23 00:35:18] [config] transformer-aan-depth: 2
[2023-07-23 00:35:18] [config] transformer-aan-nogate: false
[2023-07-23 00:35:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:18] [config] transformer-depth-scaling: false
[2023-07-23 00:35:18] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:18] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:18] [config] transformer-dropout: 0
[2023-07-23 00:35:18] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:18] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:18] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:18] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:18] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:18] [config] transformer-heads: 8
[2023-07-23 00:35:18] [config] transformer-no-projection: false
[2023-07-23 00:35:18] [config] transformer-pool: false
[2023-07-23 00:35:18] [config] transformer-postprocess: dan
[2023-07-23 00:35:18] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:18] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:18] [config] transformer-preprocess: ""
[2023-07-23 00:35:18] [config] transformer-tied-layers:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:18] [config] tsv: false
[2023-07-23 00:35:18] [config] tsv-fields: 0
[2023-07-23 00:35:18] [config] type: amun
[2023-07-23 00:35:18] [config] ulr: false
[2023-07-23 00:35:18] [config] ulr-dim-emb: 0
[2023-07-23 00:35:18] [config] ulr-dropout: 0
[2023-07-23 00:35:18] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:18] [config] ulr-query-vectors: ""
[2023-07-23 00:35:18] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:18] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:18] [config] unlikelihood-loss: false
[2023-07-23 00:35:18] [config] valid-freq: 50000000
[2023-07-23 00:35:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:18] [config] valid-max-length: 1000
[2023-07-23 00:35:18] [config] valid-metrics:
[2023-07-23 00:35:18] [config]   - cross-entropy
[2023-07-23 00:35:18] [config]   - translation
[2023-07-23 00:35:18] [config] valid-mini-batch: 32
[2023-07-23 00:35:18] [config] valid-reset-stalled: false
[2023-07-23 00:35:18] [config] valid-script-args:
[2023-07-23 00:35:18] [config]   []
[2023-07-23 00:35:18] [config] valid-script-path: ""
[2023-07-23 00:35:18] [config] valid-sets:
[2023-07-23 00:35:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:18] [config] vocabs:
[2023-07-23 00:35:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:18] [config] word-penalty: 0
[2023-07-23 00:35:18] [config] word-scores: false
[2023-07-23 00:35:18] [config] workspace: 5500
[2023-07-23 00:35:18] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:18] [training] Using single-device training
[2023-07-23 00:35:18] Synced seed 1234
[2023-07-23 00:35:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:20] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:20] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55d2d17c8692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55d2d1709da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55d2d170e1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55d2d17152ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55d2d18c1a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55d2d18c2a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55d2d189bbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55d2d139d108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55d2d12bf2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55d2d1276b9c]    main                                               + 0x3c
[0x7faa8d3ed0b3]    __libc_start_main                                  + 0xf3
[0x55d2d12bdcbe]    _start                                             + 0x2e

[2023-07-23 00:35:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:26] [marian] Running on node23.datos.cluster.uy as process 6982 with command line:
[2023-07-23 00:35:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:26] [config] after: 0e
[2023-07-23 00:35:26] [config] after-batches: 0
[2023-07-23 00:35:26] [config] after-epochs: 150
[2023-07-23 00:35:26] [config] all-caps-every: 0
[2023-07-23 00:35:26] [config] allow-unk: false
[2023-07-23 00:35:26] [config] authors: false
[2023-07-23 00:35:26] [config] beam-size: 12
[2023-07-23 00:35:26] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:26] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:26] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:26] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:26] [config] build-info: ""
[2023-07-23 00:35:26] [config] check-gradient-nan: false
[2023-07-23 00:35:26] [config] check-nan: false
[2023-07-23 00:35:26] [config] cite: false
[2023-07-23 00:35:26] [config] clip-norm: 1
[2023-07-23 00:35:26] [config] cost-scaling:
[2023-07-23 00:35:26] [config]   - 256.f
[2023-07-23 00:35:26] [config]   - 1000
[2023-07-23 00:35:26] [config]   - 2.f
[2023-07-23 00:35:26] [config]   - 256.f
[2023-07-23 00:35:26] [config] cost-type: ce-sum
[2023-07-23 00:35:26] [config] cpu-threads: 0
[2023-07-23 00:35:26] [config] data-threads: 8
[2023-07-23 00:35:26] [config] data-weighting: ""
[2023-07-23 00:35:26] [config] data-weighting-type: sentence
[2023-07-23 00:35:26] [config] dec-cell: gru
[2023-07-23 00:35:26] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:26] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:26] [config] dec-depth: 1
[2023-07-23 00:35:26] [config] devices:
[2023-07-23 00:35:26] [config]   - 0
[2023-07-23 00:35:26] [config] dim-emb: 512
[2023-07-23 00:35:26] [config] dim-rnn: 1024
[2023-07-23 00:35:26] [config] dim-vocabs:
[2023-07-23 00:35:26] [config]   - 16384
[2023-07-23 00:35:26] [config]   - 16384
[2023-07-23 00:35:26] [config] disp-first: 0
[2023-07-23 00:35:26] [config] disp-freq: 1000u
[2023-07-23 00:35:26] [config] disp-label-counts: true
[2023-07-23 00:35:26] [config] dropout-rnn: 0
[2023-07-23 00:35:26] [config] dropout-src: 0
[2023-07-23 00:35:26] [config] dropout-trg: 0
[2023-07-23 00:35:26] [config] dump-config: ""
[2023-07-23 00:35:26] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] early-stopping: 200
[2023-07-23 00:35:26] [config] early-stopping-on: first
[2023-07-23 00:35:26] [config] embedding-fix-src: false
[2023-07-23 00:35:26] [config] embedding-fix-trg: false
[2023-07-23 00:35:26] [config] embedding-normalization: false
[2023-07-23 00:35:26] [config] embedding-vectors:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] enc-cell: lstm
[2023-07-23 00:35:26] [config] enc-cell-depth: 1
[2023-07-23 00:35:26] [config] enc-depth: 1
[2023-07-23 00:35:26] [config] enc-type: bidirectional
[2023-07-23 00:35:26] [config] english-title-case-every: 0
[2023-07-23 00:35:26] [config] exponential-smoothing: 0
[2023-07-23 00:35:26] [config] factor-weight: 1
[2023-07-23 00:35:26] [config] factors-combine: sum
[2023-07-23 00:35:26] [config] factors-dim-emb: 0
[2023-07-23 00:35:26] [config] gradient-checkpointing: false
[2023-07-23 00:35:26] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:26] [config] guided-alignment: none
[2023-07-23 00:35:26] [config] guided-alignment-cost: mse
[2023-07-23 00:35:26] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:26] [config] ignore-model-config: false
[2023-07-23 00:35:26] [config] input-types:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] interpolate-env-vars: false
[2023-07-23 00:35:26] [config] keep-best: false
[2023-07-23 00:35:26] [config] label-smoothing: 0
[2023-07-23 00:35:26] [config] layer-normalization: false
[2023-07-23 00:35:26] [config] learn-rate: 0.0001
[2023-07-23 00:35:26] [config] lemma-dependency: ""
[2023-07-23 00:35:26] [config] lemma-dim-emb: 0
[2023-07-23 00:35:26] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:26] [config] log-level: info
[2023-07-23 00:35:26] [config] log-time-zone: ""
[2023-07-23 00:35:26] [config] logical-epoch:
[2023-07-23 00:35:26] [config]   - 1e
[2023-07-23 00:35:26] [config]   - 0
[2023-07-23 00:35:26] [config] lr-decay: 0
[2023-07-23 00:35:26] [config] lr-decay-freq: 50000
[2023-07-23 00:35:26] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:26] [config]   - 0
[2023-07-23 00:35:26] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:26] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:26] [config] lr-decay-start:
[2023-07-23 00:35:26] [config]   - 10
[2023-07-23 00:35:26] [config]   - 1
[2023-07-23 00:35:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:26] [config] lr-report: false
[2023-07-23 00:35:26] [config] lr-warmup: 0
[2023-07-23 00:35:26] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:26] [config] lr-warmup-cycle: false
[2023-07-23 00:35:26] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:26] [config] max-length: 50
[2023-07-23 00:35:26] [config] max-length-crop: true
[2023-07-23 00:35:26] [config] max-length-factor: 3
[2023-07-23 00:35:26] [config] maxi-batch: 100
[2023-07-23 00:35:26] [config] maxi-batch-sort: trg
[2023-07-23 00:35:26] [config] mini-batch: 64
[2023-07-23 00:35:26] [config] mini-batch-fit: true
[2023-07-23 00:35:26] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:26] [config] mini-batch-round-up: true
[2023-07-23 00:35:26] [config] mini-batch-track-lr: false
[2023-07-23 00:35:26] [config] mini-batch-warmup: 0
[2023-07-23 00:35:26] [config] mini-batch-words: 0
[2023-07-23 00:35:26] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:26] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:26] [config] multi-loss-type: sum
[2023-07-23 00:35:26] [config] n-best: false
[2023-07-23 00:35:26] [config] no-nccl: false
[2023-07-23 00:35:26] [config] no-reload: false
[2023-07-23 00:35:26] [config] no-restore-corpus: false
[2023-07-23 00:35:26] [config] normalize: 0
[2023-07-23 00:35:26] [config] normalize-gradient: false
[2023-07-23 00:35:26] [config] num-devices: 0
[2023-07-23 00:35:26] [config] optimizer: adam
[2023-07-23 00:35:26] [config] optimizer-delay: 1
[2023-07-23 00:35:26] [config] optimizer-params:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] output-omit-bias: false
[2023-07-23 00:35:26] [config] overwrite: true
[2023-07-23 00:35:26] [config] precision:
[2023-07-23 00:35:26] [config]   - float16
[2023-07-23 00:35:26] [config]   - float32
[2023-07-23 00:35:26] [config] pretrained-model: ""
[2023-07-23 00:35:26] [config] quantize-biases: false
[2023-07-23 00:35:26] [config] quantize-bits: 0
[2023-07-23 00:35:26] [config] quantize-log-based: false
[2023-07-23 00:35:26] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:26] [config] quiet: false
[2023-07-23 00:35:26] [config] quiet-translation: true
[2023-07-23 00:35:26] [config] relative-paths: false
[2023-07-23 00:35:26] [config] right-left: false
[2023-07-23 00:35:26] [config] save-freq: 10000u
[2023-07-23 00:35:26] [config] seed: 1234
[2023-07-23 00:35:26] [config] sentencepiece-alphas:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:26] [config] sentencepiece-options: ""
[2023-07-23 00:35:26] [config] sharding: global
[2023-07-23 00:35:26] [config] shuffle: data
[2023-07-23 00:35:26] [config] shuffle-in-ram: false
[2023-07-23 00:35:26] [config] sigterm: save-and-exit
[2023-07-23 00:35:26] [config] skip: false
[2023-07-23 00:35:26] [config] sqlite: ""
[2023-07-23 00:35:26] [config] sqlite-drop: false
[2023-07-23 00:35:26] [config] sync-freq: 200u
[2023-07-23 00:35:26] [config] sync-sgd: false
[2023-07-23 00:35:26] [config] tempdir: /tmp
[2023-07-23 00:35:26] [config] tied-embeddings: false
[2023-07-23 00:35:26] [config] tied-embeddings-all: true
[2023-07-23 00:35:26] [config] tied-embeddings-src: false
[2023-07-23 00:35:26] [config] train-embedder-rank:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] train-sets:
[2023-07-23 00:35:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:26] [config] transformer-aan-activation: swish
[2023-07-23 00:35:26] [config] transformer-aan-depth: 2
[2023-07-23 00:35:26] [config] transformer-aan-nogate: false
[2023-07-23 00:35:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:26] [config] transformer-depth-scaling: false
[2023-07-23 00:35:26] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:26] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:26] [config] transformer-dropout: 0
[2023-07-23 00:35:26] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:26] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:26] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:26] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:26] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:26] [config] transformer-heads: 8
[2023-07-23 00:35:26] [config] transformer-no-projection: false
[2023-07-23 00:35:26] [config] transformer-pool: false
[2023-07-23 00:35:26] [config] transformer-postprocess: dan
[2023-07-23 00:35:26] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:26] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:26] [config] transformer-preprocess: ""
[2023-07-23 00:35:26] [config] transformer-tied-layers:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:26] [config] tsv: false
[2023-07-23 00:35:26] [config] tsv-fields: 0
[2023-07-23 00:35:26] [config] type: amun
[2023-07-23 00:35:26] [config] ulr: false
[2023-07-23 00:35:26] [config] ulr-dim-emb: 0
[2023-07-23 00:35:26] [config] ulr-dropout: 0
[2023-07-23 00:35:26] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:26] [config] ulr-query-vectors: ""
[2023-07-23 00:35:26] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:26] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:26] [config] unlikelihood-loss: false
[2023-07-23 00:35:26] [config] valid-freq: 50000000
[2023-07-23 00:35:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:26] [config] valid-max-length: 1000
[2023-07-23 00:35:26] [config] valid-metrics:
[2023-07-23 00:35:26] [config]   - cross-entropy
[2023-07-23 00:35:26] [config]   - translation
[2023-07-23 00:35:26] [config] valid-mini-batch: 32
[2023-07-23 00:35:26] [config] valid-reset-stalled: false
[2023-07-23 00:35:26] [config] valid-script-args:
[2023-07-23 00:35:26] [config]   []
[2023-07-23 00:35:26] [config] valid-script-path: ""
[2023-07-23 00:35:26] [config] valid-sets:
[2023-07-23 00:35:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:26] [config] vocabs:
[2023-07-23 00:35:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:26] [config] word-penalty: 0
[2023-07-23 00:35:26] [config] word-scores: false
[2023-07-23 00:35:26] [config] workspace: 5500
[2023-07-23 00:35:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:26] [training] Using single-device training
[2023-07-23 00:35:26] Synced seed 1234
[2023-07-23 00:35:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:26] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:26] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:27] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:27] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55570c705692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55570c646da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55570c64b1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55570c6522ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55570c7fea0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55570c7ffa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55570c7d8bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55570c2da108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55570c1fc2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55570c1b3b9c]    main                                               + 0x3c
[0x7f7df76bb0b3]    __libc_start_main                                  + 0xf3
[0x55570c1facbe]    _start                                             + 0x2e

[2023-07-23 00:35:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:30] [marian] Running on node23.datos.cluster.uy as process 7009 with command line:
[2023-07-23 00:35:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:30] [config] after: 0e
[2023-07-23 00:35:30] [config] after-batches: 0
[2023-07-23 00:35:30] [config] after-epochs: 160
[2023-07-23 00:35:30] [config] all-caps-every: 0
[2023-07-23 00:35:30] [config] allow-unk: false
[2023-07-23 00:35:30] [config] authors: false
[2023-07-23 00:35:30] [config] beam-size: 12
[2023-07-23 00:35:30] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:30] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:30] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:30] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:30] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:30] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:30] [config] build-info: ""
[2023-07-23 00:35:30] [config] check-gradient-nan: false
[2023-07-23 00:35:30] [config] check-nan: false
[2023-07-23 00:35:30] [config] cite: false
[2023-07-23 00:35:30] [config] clip-norm: 1
[2023-07-23 00:35:30] [config] cost-scaling:
[2023-07-23 00:35:30] [config]   - 256.f
[2023-07-23 00:35:30] [config]   - 1000
[2023-07-23 00:35:30] [config]   - 2.f
[2023-07-23 00:35:30] [config]   - 256.f
[2023-07-23 00:35:30] [config] cost-type: ce-sum
[2023-07-23 00:35:30] [config] cpu-threads: 0
[2023-07-23 00:35:30] [config] data-threads: 8
[2023-07-23 00:35:30] [config] data-weighting: ""
[2023-07-23 00:35:30] [config] data-weighting-type: sentence
[2023-07-23 00:35:30] [config] dec-cell: gru
[2023-07-23 00:35:30] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:30] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:30] [config] dec-depth: 1
[2023-07-23 00:35:30] [config] devices:
[2023-07-23 00:35:30] [config]   - 0
[2023-07-23 00:35:30] [config] dim-emb: 512
[2023-07-23 00:35:30] [config] dim-rnn: 1024
[2023-07-23 00:35:30] [config] dim-vocabs:
[2023-07-23 00:35:30] [config]   - 16384
[2023-07-23 00:35:30] [config]   - 16384
[2023-07-23 00:35:30] [config] disp-first: 0
[2023-07-23 00:35:30] [config] disp-freq: 1000u
[2023-07-23 00:35:30] [config] disp-label-counts: true
[2023-07-23 00:35:30] [config] dropout-rnn: 0
[2023-07-23 00:35:30] [config] dropout-src: 0
[2023-07-23 00:35:30] [config] dropout-trg: 0
[2023-07-23 00:35:30] [config] dump-config: ""
[2023-07-23 00:35:30] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] early-stopping: 200
[2023-07-23 00:35:30] [config] early-stopping-on: first
[2023-07-23 00:35:30] [config] embedding-fix-src: false
[2023-07-23 00:35:30] [config] embedding-fix-trg: false
[2023-07-23 00:35:30] [config] embedding-normalization: false
[2023-07-23 00:35:30] [config] embedding-vectors:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] enc-cell: lstm
[2023-07-23 00:35:30] [config] enc-cell-depth: 1
[2023-07-23 00:35:30] [config] enc-depth: 1
[2023-07-23 00:35:30] [config] enc-type: bidirectional
[2023-07-23 00:35:30] [config] english-title-case-every: 0
[2023-07-23 00:35:30] [config] exponential-smoothing: 0
[2023-07-23 00:35:30] [config] factor-weight: 1
[2023-07-23 00:35:30] [config] factors-combine: sum
[2023-07-23 00:35:30] [config] factors-dim-emb: 0
[2023-07-23 00:35:30] [config] gradient-checkpointing: false
[2023-07-23 00:35:30] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:30] [config] guided-alignment: none
[2023-07-23 00:35:30] [config] guided-alignment-cost: mse
[2023-07-23 00:35:30] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:30] [config] ignore-model-config: false
[2023-07-23 00:35:30] [config] input-types:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] interpolate-env-vars: false
[2023-07-23 00:35:30] [config] keep-best: false
[2023-07-23 00:35:30] [config] label-smoothing: 0
[2023-07-23 00:35:30] [config] layer-normalization: false
[2023-07-23 00:35:30] [config] learn-rate: 0.0001
[2023-07-23 00:35:30] [config] lemma-dependency: ""
[2023-07-23 00:35:30] [config] lemma-dim-emb: 0
[2023-07-23 00:35:30] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:30] [config] log-level: info
[2023-07-23 00:35:30] [config] log-time-zone: ""
[2023-07-23 00:35:30] [config] logical-epoch:
[2023-07-23 00:35:30] [config]   - 1e
[2023-07-23 00:35:30] [config]   - 0
[2023-07-23 00:35:30] [config] lr-decay: 0
[2023-07-23 00:35:30] [config] lr-decay-freq: 50000
[2023-07-23 00:35:30] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:30] [config]   - 0
[2023-07-23 00:35:30] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:30] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:30] [config] lr-decay-start:
[2023-07-23 00:35:30] [config]   - 10
[2023-07-23 00:35:30] [config]   - 1
[2023-07-23 00:35:30] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:30] [config] lr-report: false
[2023-07-23 00:35:30] [config] lr-warmup: 0
[2023-07-23 00:35:30] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:30] [config] lr-warmup-cycle: false
[2023-07-23 00:35:30] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:30] [config] max-length: 50
[2023-07-23 00:35:30] [config] max-length-crop: true
[2023-07-23 00:35:30] [config] max-length-factor: 3
[2023-07-23 00:35:30] [config] maxi-batch: 100
[2023-07-23 00:35:30] [config] maxi-batch-sort: trg
[2023-07-23 00:35:30] [config] mini-batch: 64
[2023-07-23 00:35:30] [config] mini-batch-fit: true
[2023-07-23 00:35:30] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:30] [config] mini-batch-round-up: true
[2023-07-23 00:35:30] [config] mini-batch-track-lr: false
[2023-07-23 00:35:30] [config] mini-batch-warmup: 0
[2023-07-23 00:35:30] [config] mini-batch-words: 0
[2023-07-23 00:35:30] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:30] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:30] [config] multi-loss-type: sum
[2023-07-23 00:35:30] [config] n-best: false
[2023-07-23 00:35:30] [config] no-nccl: false
[2023-07-23 00:35:30] [config] no-reload: false
[2023-07-23 00:35:30] [config] no-restore-corpus: false
[2023-07-23 00:35:30] [config] normalize: 0
[2023-07-23 00:35:30] [config] normalize-gradient: false
[2023-07-23 00:35:30] [config] num-devices: 0
[2023-07-23 00:35:30] [config] optimizer: adam
[2023-07-23 00:35:30] [config] optimizer-delay: 1
[2023-07-23 00:35:30] [config] optimizer-params:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] output-omit-bias: false
[2023-07-23 00:35:30] [config] overwrite: true
[2023-07-23 00:35:30] [config] precision:
[2023-07-23 00:35:30] [config]   - float16
[2023-07-23 00:35:30] [config]   - float32
[2023-07-23 00:35:30] [config] pretrained-model: ""
[2023-07-23 00:35:30] [config] quantize-biases: false
[2023-07-23 00:35:30] [config] quantize-bits: 0
[2023-07-23 00:35:30] [config] quantize-log-based: false
[2023-07-23 00:35:30] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:30] [config] quiet: false
[2023-07-23 00:35:30] [config] quiet-translation: true
[2023-07-23 00:35:30] [config] relative-paths: false
[2023-07-23 00:35:30] [config] right-left: false
[2023-07-23 00:35:30] [config] save-freq: 10000u
[2023-07-23 00:35:30] [config] seed: 1234
[2023-07-23 00:35:30] [config] sentencepiece-alphas:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:30] [config] sentencepiece-options: ""
[2023-07-23 00:35:30] [config] sharding: global
[2023-07-23 00:35:30] [config] shuffle: data
[2023-07-23 00:35:30] [config] shuffle-in-ram: false
[2023-07-23 00:35:30] [config] sigterm: save-and-exit
[2023-07-23 00:35:30] [config] skip: false
[2023-07-23 00:35:30] [config] sqlite: ""
[2023-07-23 00:35:30] [config] sqlite-drop: false
[2023-07-23 00:35:30] [config] sync-freq: 200u
[2023-07-23 00:35:30] [config] sync-sgd: false
[2023-07-23 00:35:30] [config] tempdir: /tmp
[2023-07-23 00:35:30] [config] tied-embeddings: false
[2023-07-23 00:35:30] [config] tied-embeddings-all: true
[2023-07-23 00:35:30] [config] tied-embeddings-src: false
[2023-07-23 00:35:30] [config] train-embedder-rank:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] train-sets:
[2023-07-23 00:35:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:30] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:30] [config] transformer-aan-activation: swish
[2023-07-23 00:35:30] [config] transformer-aan-depth: 2
[2023-07-23 00:35:30] [config] transformer-aan-nogate: false
[2023-07-23 00:35:30] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:30] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:30] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:30] [config] transformer-depth-scaling: false
[2023-07-23 00:35:30] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:30] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:30] [config] transformer-dropout: 0
[2023-07-23 00:35:30] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:30] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:30] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:30] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:30] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:30] [config] transformer-heads: 8
[2023-07-23 00:35:30] [config] transformer-no-projection: false
[2023-07-23 00:35:30] [config] transformer-pool: false
[2023-07-23 00:35:30] [config] transformer-postprocess: dan
[2023-07-23 00:35:30] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:30] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:30] [config] transformer-preprocess: ""
[2023-07-23 00:35:30] [config] transformer-tied-layers:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:30] [config] tsv: false
[2023-07-23 00:35:30] [config] tsv-fields: 0
[2023-07-23 00:35:30] [config] type: amun
[2023-07-23 00:35:30] [config] ulr: false
[2023-07-23 00:35:30] [config] ulr-dim-emb: 0
[2023-07-23 00:35:30] [config] ulr-dropout: 0
[2023-07-23 00:35:30] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:30] [config] ulr-query-vectors: ""
[2023-07-23 00:35:30] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:30] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:30] [config] unlikelihood-loss: false
[2023-07-23 00:35:30] [config] valid-freq: 50000000
[2023-07-23 00:35:30] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:30] [config] valid-max-length: 1000
[2023-07-23 00:35:30] [config] valid-metrics:
[2023-07-23 00:35:30] [config]   - cross-entropy
[2023-07-23 00:35:30] [config]   - translation
[2023-07-23 00:35:30] [config] valid-mini-batch: 32
[2023-07-23 00:35:30] [config] valid-reset-stalled: false
[2023-07-23 00:35:30] [config] valid-script-args:
[2023-07-23 00:35:30] [config]   []
[2023-07-23 00:35:30] [config] valid-script-path: ""
[2023-07-23 00:35:30] [config] valid-sets:
[2023-07-23 00:35:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:30] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:30] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:30] [config] vocabs:
[2023-07-23 00:35:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:30] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:30] [config] word-penalty: 0
[2023-07-23 00:35:30] [config] word-scores: false
[2023-07-23 00:35:30] [config] workspace: 5500
[2023-07-23 00:35:30] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:30] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:30] [training] Using single-device training
[2023-07-23 00:35:31] Synced seed 1234
[2023-07-23 00:35:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:31] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:32] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:32] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:32] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x555de6af0692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x555de6a31da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x555de6a361a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x555de6a3d2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x555de6be9a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x555de6beaa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x555de6bc3bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x555de66c5108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x555de65e72c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x555de659eb9c]    main                                               + 0x3c
[0x7ff56ee090b3]    __libc_start_main                                  + 0xf3
[0x555de65e5cbe]    _start                                             + 0x2e

[2023-07-23 00:35:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:36] [marian] Running on node23.datos.cluster.uy as process 7037 with command line:
[2023-07-23 00:35:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:36] [config] after: 0e
[2023-07-23 00:35:36] [config] after-batches: 0
[2023-07-23 00:35:36] [config] after-epochs: 170
[2023-07-23 00:35:36] [config] all-caps-every: 0
[2023-07-23 00:35:36] [config] allow-unk: false
[2023-07-23 00:35:36] [config] authors: false
[2023-07-23 00:35:36] [config] beam-size: 12
[2023-07-23 00:35:36] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:36] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:36] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:36] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:36] [config] build-info: ""
[2023-07-23 00:35:36] [config] check-gradient-nan: false
[2023-07-23 00:35:36] [config] check-nan: false
[2023-07-23 00:35:36] [config] cite: false
[2023-07-23 00:35:36] [config] clip-norm: 1
[2023-07-23 00:35:36] [config] cost-scaling:
[2023-07-23 00:35:36] [config]   - 256.f
[2023-07-23 00:35:36] [config]   - 1000
[2023-07-23 00:35:36] [config]   - 2.f
[2023-07-23 00:35:36] [config]   - 256.f
[2023-07-23 00:35:36] [config] cost-type: ce-sum
[2023-07-23 00:35:36] [config] cpu-threads: 0
[2023-07-23 00:35:36] [config] data-threads: 8
[2023-07-23 00:35:36] [config] data-weighting: ""
[2023-07-23 00:35:36] [config] data-weighting-type: sentence
[2023-07-23 00:35:36] [config] dec-cell: gru
[2023-07-23 00:35:36] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:36] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:36] [config] dec-depth: 1
[2023-07-23 00:35:36] [config] devices:
[2023-07-23 00:35:36] [config]   - 0
[2023-07-23 00:35:36] [config] dim-emb: 512
[2023-07-23 00:35:36] [config] dim-rnn: 1024
[2023-07-23 00:35:36] [config] dim-vocabs:
[2023-07-23 00:35:36] [config]   - 16384
[2023-07-23 00:35:36] [config]   - 16384
[2023-07-23 00:35:36] [config] disp-first: 0
[2023-07-23 00:35:36] [config] disp-freq: 1000u
[2023-07-23 00:35:36] [config] disp-label-counts: true
[2023-07-23 00:35:36] [config] dropout-rnn: 0
[2023-07-23 00:35:36] [config] dropout-src: 0
[2023-07-23 00:35:36] [config] dropout-trg: 0
[2023-07-23 00:35:36] [config] dump-config: ""
[2023-07-23 00:35:36] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] early-stopping: 200
[2023-07-23 00:35:36] [config] early-stopping-on: first
[2023-07-23 00:35:36] [config] embedding-fix-src: false
[2023-07-23 00:35:36] [config] embedding-fix-trg: false
[2023-07-23 00:35:36] [config] embedding-normalization: false
[2023-07-23 00:35:36] [config] embedding-vectors:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] enc-cell: lstm
[2023-07-23 00:35:36] [config] enc-cell-depth: 1
[2023-07-23 00:35:36] [config] enc-depth: 1
[2023-07-23 00:35:36] [config] enc-type: bidirectional
[2023-07-23 00:35:36] [config] english-title-case-every: 0
[2023-07-23 00:35:36] [config] exponential-smoothing: 0
[2023-07-23 00:35:36] [config] factor-weight: 1
[2023-07-23 00:35:36] [config] factors-combine: sum
[2023-07-23 00:35:36] [config] factors-dim-emb: 0
[2023-07-23 00:35:36] [config] gradient-checkpointing: false
[2023-07-23 00:35:36] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:36] [config] guided-alignment: none
[2023-07-23 00:35:36] [config] guided-alignment-cost: mse
[2023-07-23 00:35:36] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:36] [config] ignore-model-config: false
[2023-07-23 00:35:36] [config] input-types:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] interpolate-env-vars: false
[2023-07-23 00:35:36] [config] keep-best: false
[2023-07-23 00:35:36] [config] label-smoothing: 0
[2023-07-23 00:35:36] [config] layer-normalization: false
[2023-07-23 00:35:36] [config] learn-rate: 0.0001
[2023-07-23 00:35:36] [config] lemma-dependency: ""
[2023-07-23 00:35:36] [config] lemma-dim-emb: 0
[2023-07-23 00:35:36] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:36] [config] log-level: info
[2023-07-23 00:35:36] [config] log-time-zone: ""
[2023-07-23 00:35:36] [config] logical-epoch:
[2023-07-23 00:35:36] [config]   - 1e
[2023-07-23 00:35:36] [config]   - 0
[2023-07-23 00:35:36] [config] lr-decay: 0
[2023-07-23 00:35:36] [config] lr-decay-freq: 50000
[2023-07-23 00:35:36] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:36] [config]   - 0
[2023-07-23 00:35:36] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:36] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:36] [config] lr-decay-start:
[2023-07-23 00:35:36] [config]   - 10
[2023-07-23 00:35:36] [config]   - 1
[2023-07-23 00:35:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:36] [config] lr-report: false
[2023-07-23 00:35:36] [config] lr-warmup: 0
[2023-07-23 00:35:36] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:36] [config] lr-warmup-cycle: false
[2023-07-23 00:35:36] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:36] [config] max-length: 50
[2023-07-23 00:35:36] [config] max-length-crop: true
[2023-07-23 00:35:36] [config] max-length-factor: 3
[2023-07-23 00:35:36] [config] maxi-batch: 100
[2023-07-23 00:35:36] [config] maxi-batch-sort: trg
[2023-07-23 00:35:36] [config] mini-batch: 64
[2023-07-23 00:35:36] [config] mini-batch-fit: true
[2023-07-23 00:35:36] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:36] [config] mini-batch-round-up: true
[2023-07-23 00:35:36] [config] mini-batch-track-lr: false
[2023-07-23 00:35:36] [config] mini-batch-warmup: 0
[2023-07-23 00:35:36] [config] mini-batch-words: 0
[2023-07-23 00:35:36] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:36] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:36] [config] multi-loss-type: sum
[2023-07-23 00:35:36] [config] n-best: false
[2023-07-23 00:35:36] [config] no-nccl: false
[2023-07-23 00:35:36] [config] no-reload: false
[2023-07-23 00:35:36] [config] no-restore-corpus: false
[2023-07-23 00:35:36] [config] normalize: 0
[2023-07-23 00:35:36] [config] normalize-gradient: false
[2023-07-23 00:35:36] [config] num-devices: 0
[2023-07-23 00:35:36] [config] optimizer: adam
[2023-07-23 00:35:36] [config] optimizer-delay: 1
[2023-07-23 00:35:36] [config] optimizer-params:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] output-omit-bias: false
[2023-07-23 00:35:36] [config] overwrite: true
[2023-07-23 00:35:36] [config] precision:
[2023-07-23 00:35:36] [config]   - float16
[2023-07-23 00:35:36] [config]   - float32
[2023-07-23 00:35:36] [config] pretrained-model: ""
[2023-07-23 00:35:36] [config] quantize-biases: false
[2023-07-23 00:35:36] [config] quantize-bits: 0
[2023-07-23 00:35:36] [config] quantize-log-based: false
[2023-07-23 00:35:36] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:36] [config] quiet: false
[2023-07-23 00:35:36] [config] quiet-translation: true
[2023-07-23 00:35:36] [config] relative-paths: false
[2023-07-23 00:35:36] [config] right-left: false
[2023-07-23 00:35:36] [config] save-freq: 10000u
[2023-07-23 00:35:36] [config] seed: 1234
[2023-07-23 00:35:36] [config] sentencepiece-alphas:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:36] [config] sentencepiece-options: ""
[2023-07-23 00:35:36] [config] sharding: global
[2023-07-23 00:35:36] [config] shuffle: data
[2023-07-23 00:35:36] [config] shuffle-in-ram: false
[2023-07-23 00:35:36] [config] sigterm: save-and-exit
[2023-07-23 00:35:36] [config] skip: false
[2023-07-23 00:35:36] [config] sqlite: ""
[2023-07-23 00:35:36] [config] sqlite-drop: false
[2023-07-23 00:35:36] [config] sync-freq: 200u
[2023-07-23 00:35:36] [config] sync-sgd: false
[2023-07-23 00:35:36] [config] tempdir: /tmp
[2023-07-23 00:35:36] [config] tied-embeddings: false
[2023-07-23 00:35:36] [config] tied-embeddings-all: true
[2023-07-23 00:35:36] [config] tied-embeddings-src: false
[2023-07-23 00:35:36] [config] train-embedder-rank:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] train-sets:
[2023-07-23 00:35:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:36] [config] transformer-aan-activation: swish
[2023-07-23 00:35:36] [config] transformer-aan-depth: 2
[2023-07-23 00:35:36] [config] transformer-aan-nogate: false
[2023-07-23 00:35:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:36] [config] transformer-depth-scaling: false
[2023-07-23 00:35:36] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:36] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:36] [config] transformer-dropout: 0
[2023-07-23 00:35:36] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:36] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:36] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:36] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:36] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:36] [config] transformer-heads: 8
[2023-07-23 00:35:36] [config] transformer-no-projection: false
[2023-07-23 00:35:36] [config] transformer-pool: false
[2023-07-23 00:35:36] [config] transformer-postprocess: dan
[2023-07-23 00:35:36] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:36] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:36] [config] transformer-preprocess: ""
[2023-07-23 00:35:36] [config] transformer-tied-layers:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:36] [config] tsv: false
[2023-07-23 00:35:36] [config] tsv-fields: 0
[2023-07-23 00:35:36] [config] type: amun
[2023-07-23 00:35:36] [config] ulr: false
[2023-07-23 00:35:36] [config] ulr-dim-emb: 0
[2023-07-23 00:35:36] [config] ulr-dropout: 0
[2023-07-23 00:35:36] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:36] [config] ulr-query-vectors: ""
[2023-07-23 00:35:36] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:36] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:36] [config] unlikelihood-loss: false
[2023-07-23 00:35:36] [config] valid-freq: 50000000
[2023-07-23 00:35:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:36] [config] valid-max-length: 1000
[2023-07-23 00:35:36] [config] valid-metrics:
[2023-07-23 00:35:36] [config]   - cross-entropy
[2023-07-23 00:35:36] [config]   - translation
[2023-07-23 00:35:36] [config] valid-mini-batch: 32
[2023-07-23 00:35:36] [config] valid-reset-stalled: false
[2023-07-23 00:35:36] [config] valid-script-args:
[2023-07-23 00:35:36] [config]   []
[2023-07-23 00:35:36] [config] valid-script-path: ""
[2023-07-23 00:35:36] [config] valid-sets:
[2023-07-23 00:35:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:36] [config] vocabs:
[2023-07-23 00:35:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:36] [config] word-penalty: 0
[2023-07-23 00:35:36] [config] word-scores: false
[2023-07-23 00:35:36] [config] workspace: 5500
[2023-07-23 00:35:36] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:36] [training] Using single-device training
[2023-07-23 00:35:36] Synced seed 1234
[2023-07-23 00:35:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:36] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:36] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:36] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:36] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:36] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:38] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:38] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55b6822d7692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55b682218da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55b68221d1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55b6822242ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55b6823d0a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55b6823d1a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55b6823aabee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55b681eac108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55b681dce2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b681d85b9c]    main                                               + 0x3c
[0x7fd27bab70b3]    __libc_start_main                                  + 0xf3
[0x55b681dcccbe]    _start                                             + 0x2e

[2023-07-23 00:35:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:41] [marian] Running on node23.datos.cluster.uy as process 7065 with command line:
[2023-07-23 00:35:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:41] [config] after: 0e
[2023-07-23 00:35:41] [config] after-batches: 0
[2023-07-23 00:35:41] [config] after-epochs: 180
[2023-07-23 00:35:41] [config] all-caps-every: 0
[2023-07-23 00:35:41] [config] allow-unk: false
[2023-07-23 00:35:41] [config] authors: false
[2023-07-23 00:35:41] [config] beam-size: 12
[2023-07-23 00:35:41] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:41] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:41] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:41] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:41] [config] build-info: ""
[2023-07-23 00:35:41] [config] check-gradient-nan: false
[2023-07-23 00:35:41] [config] check-nan: false
[2023-07-23 00:35:41] [config] cite: false
[2023-07-23 00:35:41] [config] clip-norm: 1
[2023-07-23 00:35:41] [config] cost-scaling:
[2023-07-23 00:35:41] [config]   - 256.f
[2023-07-23 00:35:41] [config]   - 1000
[2023-07-23 00:35:41] [config]   - 2.f
[2023-07-23 00:35:41] [config]   - 256.f
[2023-07-23 00:35:41] [config] cost-type: ce-sum
[2023-07-23 00:35:41] [config] cpu-threads: 0
[2023-07-23 00:35:41] [config] data-threads: 8
[2023-07-23 00:35:41] [config] data-weighting: ""
[2023-07-23 00:35:41] [config] data-weighting-type: sentence
[2023-07-23 00:35:41] [config] dec-cell: gru
[2023-07-23 00:35:41] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:41] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:41] [config] dec-depth: 1
[2023-07-23 00:35:41] [config] devices:
[2023-07-23 00:35:41] [config]   - 0
[2023-07-23 00:35:41] [config] dim-emb: 512
[2023-07-23 00:35:41] [config] dim-rnn: 1024
[2023-07-23 00:35:41] [config] dim-vocabs:
[2023-07-23 00:35:41] [config]   - 16384
[2023-07-23 00:35:41] [config]   - 16384
[2023-07-23 00:35:41] [config] disp-first: 0
[2023-07-23 00:35:41] [config] disp-freq: 1000u
[2023-07-23 00:35:41] [config] disp-label-counts: true
[2023-07-23 00:35:41] [config] dropout-rnn: 0
[2023-07-23 00:35:41] [config] dropout-src: 0
[2023-07-23 00:35:41] [config] dropout-trg: 0
[2023-07-23 00:35:41] [config] dump-config: ""
[2023-07-23 00:35:41] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] early-stopping: 200
[2023-07-23 00:35:41] [config] early-stopping-on: first
[2023-07-23 00:35:41] [config] embedding-fix-src: false
[2023-07-23 00:35:41] [config] embedding-fix-trg: false
[2023-07-23 00:35:41] [config] embedding-normalization: false
[2023-07-23 00:35:41] [config] embedding-vectors:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] enc-cell: lstm
[2023-07-23 00:35:41] [config] enc-cell-depth: 1
[2023-07-23 00:35:41] [config] enc-depth: 1
[2023-07-23 00:35:41] [config] enc-type: bidirectional
[2023-07-23 00:35:41] [config] english-title-case-every: 0
[2023-07-23 00:35:41] [config] exponential-smoothing: 0
[2023-07-23 00:35:41] [config] factor-weight: 1
[2023-07-23 00:35:41] [config] factors-combine: sum
[2023-07-23 00:35:41] [config] factors-dim-emb: 0
[2023-07-23 00:35:41] [config] gradient-checkpointing: false
[2023-07-23 00:35:41] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:41] [config] guided-alignment: none
[2023-07-23 00:35:41] [config] guided-alignment-cost: mse
[2023-07-23 00:35:41] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:41] [config] ignore-model-config: false
[2023-07-23 00:35:41] [config] input-types:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] interpolate-env-vars: false
[2023-07-23 00:35:41] [config] keep-best: false
[2023-07-23 00:35:41] [config] label-smoothing: 0
[2023-07-23 00:35:41] [config] layer-normalization: false
[2023-07-23 00:35:41] [config] learn-rate: 0.0001
[2023-07-23 00:35:41] [config] lemma-dependency: ""
[2023-07-23 00:35:41] [config] lemma-dim-emb: 0
[2023-07-23 00:35:41] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:41] [config] log-level: info
[2023-07-23 00:35:41] [config] log-time-zone: ""
[2023-07-23 00:35:41] [config] logical-epoch:
[2023-07-23 00:35:41] [config]   - 1e
[2023-07-23 00:35:41] [config]   - 0
[2023-07-23 00:35:41] [config] lr-decay: 0
[2023-07-23 00:35:41] [config] lr-decay-freq: 50000
[2023-07-23 00:35:41] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:41] [config]   - 0
[2023-07-23 00:35:41] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:41] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:41] [config] lr-decay-start:
[2023-07-23 00:35:41] [config]   - 10
[2023-07-23 00:35:41] [config]   - 1
[2023-07-23 00:35:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:41] [config] lr-report: false
[2023-07-23 00:35:41] [config] lr-warmup: 0
[2023-07-23 00:35:41] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:41] [config] lr-warmup-cycle: false
[2023-07-23 00:35:41] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:41] [config] max-length: 50
[2023-07-23 00:35:41] [config] max-length-crop: true
[2023-07-23 00:35:41] [config] max-length-factor: 3
[2023-07-23 00:35:41] [config] maxi-batch: 100
[2023-07-23 00:35:41] [config] maxi-batch-sort: trg
[2023-07-23 00:35:41] [config] mini-batch: 64
[2023-07-23 00:35:41] [config] mini-batch-fit: true
[2023-07-23 00:35:41] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:41] [config] mini-batch-round-up: true
[2023-07-23 00:35:41] [config] mini-batch-track-lr: false
[2023-07-23 00:35:41] [config] mini-batch-warmup: 0
[2023-07-23 00:35:41] [config] mini-batch-words: 0
[2023-07-23 00:35:41] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:41] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:41] [config] multi-loss-type: sum
[2023-07-23 00:35:41] [config] n-best: false
[2023-07-23 00:35:41] [config] no-nccl: false
[2023-07-23 00:35:41] [config] no-reload: false
[2023-07-23 00:35:41] [config] no-restore-corpus: false
[2023-07-23 00:35:41] [config] normalize: 0
[2023-07-23 00:35:41] [config] normalize-gradient: false
[2023-07-23 00:35:41] [config] num-devices: 0
[2023-07-23 00:35:41] [config] optimizer: adam
[2023-07-23 00:35:41] [config] optimizer-delay: 1
[2023-07-23 00:35:41] [config] optimizer-params:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] output-omit-bias: false
[2023-07-23 00:35:41] [config] overwrite: true
[2023-07-23 00:35:41] [config] precision:
[2023-07-23 00:35:41] [config]   - float16
[2023-07-23 00:35:41] [config]   - float32
[2023-07-23 00:35:41] [config] pretrained-model: ""
[2023-07-23 00:35:41] [config] quantize-biases: false
[2023-07-23 00:35:41] [config] quantize-bits: 0
[2023-07-23 00:35:41] [config] quantize-log-based: false
[2023-07-23 00:35:41] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:41] [config] quiet: false
[2023-07-23 00:35:41] [config] quiet-translation: true
[2023-07-23 00:35:41] [config] relative-paths: false
[2023-07-23 00:35:41] [config] right-left: false
[2023-07-23 00:35:41] [config] save-freq: 10000u
[2023-07-23 00:35:41] [config] seed: 1234
[2023-07-23 00:35:41] [config] sentencepiece-alphas:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:41] [config] sentencepiece-options: ""
[2023-07-23 00:35:41] [config] sharding: global
[2023-07-23 00:35:41] [config] shuffle: data
[2023-07-23 00:35:41] [config] shuffle-in-ram: false
[2023-07-23 00:35:41] [config] sigterm: save-and-exit
[2023-07-23 00:35:41] [config] skip: false
[2023-07-23 00:35:41] [config] sqlite: ""
[2023-07-23 00:35:41] [config] sqlite-drop: false
[2023-07-23 00:35:41] [config] sync-freq: 200u
[2023-07-23 00:35:41] [config] sync-sgd: false
[2023-07-23 00:35:41] [config] tempdir: /tmp
[2023-07-23 00:35:41] [config] tied-embeddings: false
[2023-07-23 00:35:41] [config] tied-embeddings-all: true
[2023-07-23 00:35:41] [config] tied-embeddings-src: false
[2023-07-23 00:35:41] [config] train-embedder-rank:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] train-sets:
[2023-07-23 00:35:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:41] [config] transformer-aan-activation: swish
[2023-07-23 00:35:41] [config] transformer-aan-depth: 2
[2023-07-23 00:35:41] [config] transformer-aan-nogate: false
[2023-07-23 00:35:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:41] [config] transformer-depth-scaling: false
[2023-07-23 00:35:41] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:41] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:41] [config] transformer-dropout: 0
[2023-07-23 00:35:41] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:41] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:41] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:41] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:41] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:41] [config] transformer-heads: 8
[2023-07-23 00:35:41] [config] transformer-no-projection: false
[2023-07-23 00:35:41] [config] transformer-pool: false
[2023-07-23 00:35:41] [config] transformer-postprocess: dan
[2023-07-23 00:35:41] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:41] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:41] [config] transformer-preprocess: ""
[2023-07-23 00:35:41] [config] transformer-tied-layers:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:41] [config] tsv: false
[2023-07-23 00:35:41] [config] tsv-fields: 0
[2023-07-23 00:35:41] [config] type: amun
[2023-07-23 00:35:41] [config] ulr: false
[2023-07-23 00:35:41] [config] ulr-dim-emb: 0
[2023-07-23 00:35:41] [config] ulr-dropout: 0
[2023-07-23 00:35:41] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:41] [config] ulr-query-vectors: ""
[2023-07-23 00:35:41] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:41] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:41] [config] unlikelihood-loss: false
[2023-07-23 00:35:41] [config] valid-freq: 50000000
[2023-07-23 00:35:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:41] [config] valid-max-length: 1000
[2023-07-23 00:35:41] [config] valid-metrics:
[2023-07-23 00:35:41] [config]   - cross-entropy
[2023-07-23 00:35:41] [config]   - translation
[2023-07-23 00:35:41] [config] valid-mini-batch: 32
[2023-07-23 00:35:41] [config] valid-reset-stalled: false
[2023-07-23 00:35:41] [config] valid-script-args:
[2023-07-23 00:35:41] [config]   []
[2023-07-23 00:35:41] [config] valid-script-path: ""
[2023-07-23 00:35:41] [config] valid-sets:
[2023-07-23 00:35:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:41] [config] vocabs:
[2023-07-23 00:35:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:41] [config] word-penalty: 0
[2023-07-23 00:35:41] [config] word-scores: false
[2023-07-23 00:35:41] [config] workspace: 5500
[2023-07-23 00:35:41] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:41] [training] Using single-device training
[2023-07-23 00:35:41] Synced seed 1234
[2023-07-23 00:35:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:43] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:43] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55fbb3eaf692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55fbb3df0da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55fbb3df51a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55fbb3dfc2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55fbb3fa8a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55fbb3fa9a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55fbb3f82bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55fbb3a84108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55fbb39a62c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55fbb395db9c]    main                                               + 0x3c
[0x7f7fa4f270b3]    __libc_start_main                                  + 0xf3
[0x55fbb39a4cbe]    _start                                             + 0x2e

[2023-07-23 00:35:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:46] [marian] Running on node23.datos.cluster.uy as process 7092 with command line:
[2023-07-23 00:35:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:46] [config] after: 0e
[2023-07-23 00:35:46] [config] after-batches: 0
[2023-07-23 00:35:46] [config] after-epochs: 190
[2023-07-23 00:35:46] [config] all-caps-every: 0
[2023-07-23 00:35:46] [config] allow-unk: false
[2023-07-23 00:35:46] [config] authors: false
[2023-07-23 00:35:46] [config] beam-size: 12
[2023-07-23 00:35:46] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:46] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:46] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:46] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:46] [config] build-info: ""
[2023-07-23 00:35:46] [config] check-gradient-nan: false
[2023-07-23 00:35:46] [config] check-nan: false
[2023-07-23 00:35:46] [config] cite: false
[2023-07-23 00:35:46] [config] clip-norm: 1
[2023-07-23 00:35:46] [config] cost-scaling:
[2023-07-23 00:35:46] [config]   - 256.f
[2023-07-23 00:35:46] [config]   - 1000
[2023-07-23 00:35:46] [config]   - 2.f
[2023-07-23 00:35:46] [config]   - 256.f
[2023-07-23 00:35:46] [config] cost-type: ce-sum
[2023-07-23 00:35:46] [config] cpu-threads: 0
[2023-07-23 00:35:46] [config] data-threads: 8
[2023-07-23 00:35:46] [config] data-weighting: ""
[2023-07-23 00:35:46] [config] data-weighting-type: sentence
[2023-07-23 00:35:46] [config] dec-cell: gru
[2023-07-23 00:35:46] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:46] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:46] [config] dec-depth: 1
[2023-07-23 00:35:46] [config] devices:
[2023-07-23 00:35:46] [config]   - 0
[2023-07-23 00:35:46] [config] dim-emb: 512
[2023-07-23 00:35:46] [config] dim-rnn: 1024
[2023-07-23 00:35:46] [config] dim-vocabs:
[2023-07-23 00:35:46] [config]   - 16384
[2023-07-23 00:35:46] [config]   - 16384
[2023-07-23 00:35:46] [config] disp-first: 0
[2023-07-23 00:35:46] [config] disp-freq: 1000u
[2023-07-23 00:35:46] [config] disp-label-counts: true
[2023-07-23 00:35:46] [config] dropout-rnn: 0
[2023-07-23 00:35:46] [config] dropout-src: 0
[2023-07-23 00:35:46] [config] dropout-trg: 0
[2023-07-23 00:35:46] [config] dump-config: ""
[2023-07-23 00:35:46] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] early-stopping: 200
[2023-07-23 00:35:46] [config] early-stopping-on: first
[2023-07-23 00:35:46] [config] embedding-fix-src: false
[2023-07-23 00:35:46] [config] embedding-fix-trg: false
[2023-07-23 00:35:46] [config] embedding-normalization: false
[2023-07-23 00:35:46] [config] embedding-vectors:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] enc-cell: lstm
[2023-07-23 00:35:46] [config] enc-cell-depth: 1
[2023-07-23 00:35:46] [config] enc-depth: 1
[2023-07-23 00:35:46] [config] enc-type: bidirectional
[2023-07-23 00:35:46] [config] english-title-case-every: 0
[2023-07-23 00:35:46] [config] exponential-smoothing: 0
[2023-07-23 00:35:46] [config] factor-weight: 1
[2023-07-23 00:35:46] [config] factors-combine: sum
[2023-07-23 00:35:46] [config] factors-dim-emb: 0
[2023-07-23 00:35:46] [config] gradient-checkpointing: false
[2023-07-23 00:35:46] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:46] [config] guided-alignment: none
[2023-07-23 00:35:46] [config] guided-alignment-cost: mse
[2023-07-23 00:35:46] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:46] [config] ignore-model-config: false
[2023-07-23 00:35:46] [config] input-types:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] interpolate-env-vars: false
[2023-07-23 00:35:46] [config] keep-best: false
[2023-07-23 00:35:46] [config] label-smoothing: 0
[2023-07-23 00:35:46] [config] layer-normalization: false
[2023-07-23 00:35:46] [config] learn-rate: 0.0001
[2023-07-23 00:35:46] [config] lemma-dependency: ""
[2023-07-23 00:35:46] [config] lemma-dim-emb: 0
[2023-07-23 00:35:46] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:46] [config] log-level: info
[2023-07-23 00:35:46] [config] log-time-zone: ""
[2023-07-23 00:35:46] [config] logical-epoch:
[2023-07-23 00:35:46] [config]   - 1e
[2023-07-23 00:35:46] [config]   - 0
[2023-07-23 00:35:46] [config] lr-decay: 0
[2023-07-23 00:35:46] [config] lr-decay-freq: 50000
[2023-07-23 00:35:46] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:46] [config]   - 0
[2023-07-23 00:35:46] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:46] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:46] [config] lr-decay-start:
[2023-07-23 00:35:46] [config]   - 10
[2023-07-23 00:35:46] [config]   - 1
[2023-07-23 00:35:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:46] [config] lr-report: false
[2023-07-23 00:35:46] [config] lr-warmup: 0
[2023-07-23 00:35:46] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:46] [config] lr-warmup-cycle: false
[2023-07-23 00:35:46] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:46] [config] max-length: 50
[2023-07-23 00:35:46] [config] max-length-crop: true
[2023-07-23 00:35:46] [config] max-length-factor: 3
[2023-07-23 00:35:46] [config] maxi-batch: 100
[2023-07-23 00:35:46] [config] maxi-batch-sort: trg
[2023-07-23 00:35:46] [config] mini-batch: 64
[2023-07-23 00:35:46] [config] mini-batch-fit: true
[2023-07-23 00:35:46] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:46] [config] mini-batch-round-up: true
[2023-07-23 00:35:46] [config] mini-batch-track-lr: false
[2023-07-23 00:35:46] [config] mini-batch-warmup: 0
[2023-07-23 00:35:46] [config] mini-batch-words: 0
[2023-07-23 00:35:46] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:46] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:46] [config] multi-loss-type: sum
[2023-07-23 00:35:46] [config] n-best: false
[2023-07-23 00:35:46] [config] no-nccl: false
[2023-07-23 00:35:46] [config] no-reload: false
[2023-07-23 00:35:46] [config] no-restore-corpus: false
[2023-07-23 00:35:46] [config] normalize: 0
[2023-07-23 00:35:46] [config] normalize-gradient: false
[2023-07-23 00:35:46] [config] num-devices: 0
[2023-07-23 00:35:46] [config] optimizer: adam
[2023-07-23 00:35:46] [config] optimizer-delay: 1
[2023-07-23 00:35:46] [config] optimizer-params:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] output-omit-bias: false
[2023-07-23 00:35:46] [config] overwrite: true
[2023-07-23 00:35:46] [config] precision:
[2023-07-23 00:35:46] [config]   - float16
[2023-07-23 00:35:46] [config]   - float32
[2023-07-23 00:35:46] [config] pretrained-model: ""
[2023-07-23 00:35:46] [config] quantize-biases: false
[2023-07-23 00:35:46] [config] quantize-bits: 0
[2023-07-23 00:35:46] [config] quantize-log-based: false
[2023-07-23 00:35:46] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:46] [config] quiet: false
[2023-07-23 00:35:46] [config] quiet-translation: true
[2023-07-23 00:35:46] [config] relative-paths: false
[2023-07-23 00:35:46] [config] right-left: false
[2023-07-23 00:35:46] [config] save-freq: 10000u
[2023-07-23 00:35:46] [config] seed: 1234
[2023-07-23 00:35:46] [config] sentencepiece-alphas:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:46] [config] sentencepiece-options: ""
[2023-07-23 00:35:46] [config] sharding: global
[2023-07-23 00:35:46] [config] shuffle: data
[2023-07-23 00:35:46] [config] shuffle-in-ram: false
[2023-07-23 00:35:46] [config] sigterm: save-and-exit
[2023-07-23 00:35:46] [config] skip: false
[2023-07-23 00:35:46] [config] sqlite: ""
[2023-07-23 00:35:46] [config] sqlite-drop: false
[2023-07-23 00:35:46] [config] sync-freq: 200u
[2023-07-23 00:35:46] [config] sync-sgd: false
[2023-07-23 00:35:46] [config] tempdir: /tmp
[2023-07-23 00:35:46] [config] tied-embeddings: false
[2023-07-23 00:35:46] [config] tied-embeddings-all: true
[2023-07-23 00:35:46] [config] tied-embeddings-src: false
[2023-07-23 00:35:46] [config] train-embedder-rank:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] train-sets:
[2023-07-23 00:35:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:46] [config] transformer-aan-activation: swish
[2023-07-23 00:35:46] [config] transformer-aan-depth: 2
[2023-07-23 00:35:46] [config] transformer-aan-nogate: false
[2023-07-23 00:35:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:46] [config] transformer-depth-scaling: false
[2023-07-23 00:35:46] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:46] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:46] [config] transformer-dropout: 0
[2023-07-23 00:35:46] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:46] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:46] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:46] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:46] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:46] [config] transformer-heads: 8
[2023-07-23 00:35:46] [config] transformer-no-projection: false
[2023-07-23 00:35:46] [config] transformer-pool: false
[2023-07-23 00:35:46] [config] transformer-postprocess: dan
[2023-07-23 00:35:46] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:46] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:46] [config] transformer-preprocess: ""
[2023-07-23 00:35:46] [config] transformer-tied-layers:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:46] [config] tsv: false
[2023-07-23 00:35:46] [config] tsv-fields: 0
[2023-07-23 00:35:46] [config] type: amun
[2023-07-23 00:35:46] [config] ulr: false
[2023-07-23 00:35:46] [config] ulr-dim-emb: 0
[2023-07-23 00:35:46] [config] ulr-dropout: 0
[2023-07-23 00:35:46] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:46] [config] ulr-query-vectors: ""
[2023-07-23 00:35:46] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:46] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:46] [config] unlikelihood-loss: false
[2023-07-23 00:35:46] [config] valid-freq: 50000000
[2023-07-23 00:35:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:46] [config] valid-max-length: 1000
[2023-07-23 00:35:46] [config] valid-metrics:
[2023-07-23 00:35:46] [config]   - cross-entropy
[2023-07-23 00:35:46] [config]   - translation
[2023-07-23 00:35:46] [config] valid-mini-batch: 32
[2023-07-23 00:35:46] [config] valid-reset-stalled: false
[2023-07-23 00:35:46] [config] valid-script-args:
[2023-07-23 00:35:46] [config]   []
[2023-07-23 00:35:46] [config] valid-script-path: ""
[2023-07-23 00:35:46] [config] valid-sets:
[2023-07-23 00:35:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:46] [config] vocabs:
[2023-07-23 00:35:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:46] [config] word-penalty: 0
[2023-07-23 00:35:46] [config] word-scores: false
[2023-07-23 00:35:46] [config] workspace: 5500
[2023-07-23 00:35:46] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:46] [training] Using single-device training
[2023-07-23 00:35:46] Synced seed 1234
[2023-07-23 00:35:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:48] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:48] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55a77a393692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55a77a2d4da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55a77a2d91a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55a77a2e02ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55a77a48ca0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55a77a48da53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55a77a466bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55a779f68108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55a779e8a2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a779e41b9c]    main                                               + 0x3c
[0x7ff1c25280b3]    __libc_start_main                                  + 0xf3
[0x55a779e88cbe]    _start                                             + 0x2e

[2023-07-23 00:35:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:51] [marian] Running on node23.datos.cluster.uy as process 7119 with command line:
[2023-07-23 00:35:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell lstm
[2023-07-23 00:35:51] [config] after: 0e
[2023-07-23 00:35:51] [config] after-batches: 0
[2023-07-23 00:35:51] [config] after-epochs: 200
[2023-07-23 00:35:51] [config] all-caps-every: 0
[2023-07-23 00:35:51] [config] allow-unk: false
[2023-07-23 00:35:51] [config] authors: false
[2023-07-23 00:35:51] [config] beam-size: 12
[2023-07-23 00:35:51] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:51] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:51] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:51] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:51] [config] build-info: ""
[2023-07-23 00:35:51] [config] check-gradient-nan: false
[2023-07-23 00:35:51] [config] check-nan: false
[2023-07-23 00:35:51] [config] cite: false
[2023-07-23 00:35:51] [config] clip-norm: 1
[2023-07-23 00:35:51] [config] cost-scaling:
[2023-07-23 00:35:51] [config]   - 256.f
[2023-07-23 00:35:51] [config]   - 1000
[2023-07-23 00:35:51] [config]   - 2.f
[2023-07-23 00:35:51] [config]   - 256.f
[2023-07-23 00:35:51] [config] cost-type: ce-sum
[2023-07-23 00:35:51] [config] cpu-threads: 0
[2023-07-23 00:35:51] [config] data-threads: 8
[2023-07-23 00:35:51] [config] data-weighting: ""
[2023-07-23 00:35:51] [config] data-weighting-type: sentence
[2023-07-23 00:35:51] [config] dec-cell: gru
[2023-07-23 00:35:51] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:51] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:51] [config] dec-depth: 1
[2023-07-23 00:35:51] [config] devices:
[2023-07-23 00:35:51] [config]   - 0
[2023-07-23 00:35:51] [config] dim-emb: 512
[2023-07-23 00:35:51] [config] dim-rnn: 1024
[2023-07-23 00:35:51] [config] dim-vocabs:
[2023-07-23 00:35:51] [config]   - 16384
[2023-07-23 00:35:51] [config]   - 16384
[2023-07-23 00:35:51] [config] disp-first: 0
[2023-07-23 00:35:51] [config] disp-freq: 1000u
[2023-07-23 00:35:51] [config] disp-label-counts: true
[2023-07-23 00:35:51] [config] dropout-rnn: 0
[2023-07-23 00:35:51] [config] dropout-src: 0
[2023-07-23 00:35:51] [config] dropout-trg: 0
[2023-07-23 00:35:51] [config] dump-config: ""
[2023-07-23 00:35:51] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] early-stopping: 200
[2023-07-23 00:35:51] [config] early-stopping-on: first
[2023-07-23 00:35:51] [config] embedding-fix-src: false
[2023-07-23 00:35:51] [config] embedding-fix-trg: false
[2023-07-23 00:35:51] [config] embedding-normalization: false
[2023-07-23 00:35:51] [config] embedding-vectors:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] enc-cell: lstm
[2023-07-23 00:35:51] [config] enc-cell-depth: 1
[2023-07-23 00:35:51] [config] enc-depth: 1
[2023-07-23 00:35:51] [config] enc-type: bidirectional
[2023-07-23 00:35:51] [config] english-title-case-every: 0
[2023-07-23 00:35:51] [config] exponential-smoothing: 0
[2023-07-23 00:35:51] [config] factor-weight: 1
[2023-07-23 00:35:51] [config] factors-combine: sum
[2023-07-23 00:35:51] [config] factors-dim-emb: 0
[2023-07-23 00:35:51] [config] gradient-checkpointing: false
[2023-07-23 00:35:51] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:51] [config] guided-alignment: none
[2023-07-23 00:35:51] [config] guided-alignment-cost: mse
[2023-07-23 00:35:51] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:51] [config] ignore-model-config: false
[2023-07-23 00:35:51] [config] input-types:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] interpolate-env-vars: false
[2023-07-23 00:35:51] [config] keep-best: false
[2023-07-23 00:35:51] [config] label-smoothing: 0
[2023-07-23 00:35:51] [config] layer-normalization: false
[2023-07-23 00:35:51] [config] learn-rate: 0.0001
[2023-07-23 00:35:51] [config] lemma-dependency: ""
[2023-07-23 00:35:51] [config] lemma-dim-emb: 0
[2023-07-23 00:35:51] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:51] [config] log-level: info
[2023-07-23 00:35:51] [config] log-time-zone: ""
[2023-07-23 00:35:51] [config] logical-epoch:
[2023-07-23 00:35:51] [config]   - 1e
[2023-07-23 00:35:51] [config]   - 0
[2023-07-23 00:35:51] [config] lr-decay: 0
[2023-07-23 00:35:51] [config] lr-decay-freq: 50000
[2023-07-23 00:35:51] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:51] [config]   - 0
[2023-07-23 00:35:51] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:51] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:51] [config] lr-decay-start:
[2023-07-23 00:35:51] [config]   - 10
[2023-07-23 00:35:51] [config]   - 1
[2023-07-23 00:35:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:51] [config] lr-report: false
[2023-07-23 00:35:51] [config] lr-warmup: 0
[2023-07-23 00:35:51] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:51] [config] lr-warmup-cycle: false
[2023-07-23 00:35:51] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:51] [config] max-length: 50
[2023-07-23 00:35:51] [config] max-length-crop: true
[2023-07-23 00:35:51] [config] max-length-factor: 3
[2023-07-23 00:35:51] [config] maxi-batch: 100
[2023-07-23 00:35:51] [config] maxi-batch-sort: trg
[2023-07-23 00:35:51] [config] mini-batch: 64
[2023-07-23 00:35:51] [config] mini-batch-fit: true
[2023-07-23 00:35:51] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:51] [config] mini-batch-round-up: true
[2023-07-23 00:35:51] [config] mini-batch-track-lr: false
[2023-07-23 00:35:51] [config] mini-batch-warmup: 0
[2023-07-23 00:35:51] [config] mini-batch-words: 0
[2023-07-23 00:35:51] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:51] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_lstm.npz
[2023-07-23 00:35:51] [config] multi-loss-type: sum
[2023-07-23 00:35:51] [config] n-best: false
[2023-07-23 00:35:51] [config] no-nccl: false
[2023-07-23 00:35:51] [config] no-reload: false
[2023-07-23 00:35:51] [config] no-restore-corpus: false
[2023-07-23 00:35:51] [config] normalize: 0
[2023-07-23 00:35:51] [config] normalize-gradient: false
[2023-07-23 00:35:51] [config] num-devices: 0
[2023-07-23 00:35:51] [config] optimizer: adam
[2023-07-23 00:35:51] [config] optimizer-delay: 1
[2023-07-23 00:35:51] [config] optimizer-params:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] output-omit-bias: false
[2023-07-23 00:35:51] [config] overwrite: true
[2023-07-23 00:35:51] [config] precision:
[2023-07-23 00:35:51] [config]   - float16
[2023-07-23 00:35:51] [config]   - float32
[2023-07-23 00:35:51] [config] pretrained-model: ""
[2023-07-23 00:35:51] [config] quantize-biases: false
[2023-07-23 00:35:51] [config] quantize-bits: 0
[2023-07-23 00:35:51] [config] quantize-log-based: false
[2023-07-23 00:35:51] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:51] [config] quiet: false
[2023-07-23 00:35:51] [config] quiet-translation: true
[2023-07-23 00:35:51] [config] relative-paths: false
[2023-07-23 00:35:51] [config] right-left: false
[2023-07-23 00:35:51] [config] save-freq: 10000u
[2023-07-23 00:35:51] [config] seed: 1234
[2023-07-23 00:35:51] [config] sentencepiece-alphas:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:51] [config] sentencepiece-options: ""
[2023-07-23 00:35:51] [config] sharding: global
[2023-07-23 00:35:51] [config] shuffle: data
[2023-07-23 00:35:51] [config] shuffle-in-ram: false
[2023-07-23 00:35:51] [config] sigterm: save-and-exit
[2023-07-23 00:35:51] [config] skip: false
[2023-07-23 00:35:51] [config] sqlite: ""
[2023-07-23 00:35:51] [config] sqlite-drop: false
[2023-07-23 00:35:51] [config] sync-freq: 200u
[2023-07-23 00:35:51] [config] sync-sgd: false
[2023-07-23 00:35:51] [config] tempdir: /tmp
[2023-07-23 00:35:51] [config] tied-embeddings: false
[2023-07-23 00:35:51] [config] tied-embeddings-all: true
[2023-07-23 00:35:51] [config] tied-embeddings-src: false
[2023-07-23 00:35:51] [config] train-embedder-rank:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] train-sets:
[2023-07-23 00:35:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:51] [config] transformer-aan-activation: swish
[2023-07-23 00:35:51] [config] transformer-aan-depth: 2
[2023-07-23 00:35:51] [config] transformer-aan-nogate: false
[2023-07-23 00:35:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:51] [config] transformer-depth-scaling: false
[2023-07-23 00:35:51] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:51] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:51] [config] transformer-dropout: 0
[2023-07-23 00:35:51] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:51] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:51] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:51] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:51] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:51] [config] transformer-heads: 8
[2023-07-23 00:35:51] [config] transformer-no-projection: false
[2023-07-23 00:35:51] [config] transformer-pool: false
[2023-07-23 00:35:51] [config] transformer-postprocess: dan
[2023-07-23 00:35:51] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:51] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:51] [config] transformer-preprocess: ""
[2023-07-23 00:35:51] [config] transformer-tied-layers:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:51] [config] tsv: false
[2023-07-23 00:35:51] [config] tsv-fields: 0
[2023-07-23 00:35:51] [config] type: amun
[2023-07-23 00:35:51] [config] ulr: false
[2023-07-23 00:35:51] [config] ulr-dim-emb: 0
[2023-07-23 00:35:51] [config] ulr-dropout: 0
[2023-07-23 00:35:51] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:51] [config] ulr-query-vectors: ""
[2023-07-23 00:35:51] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:51] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:51] [config] unlikelihood-loss: false
[2023-07-23 00:35:51] [config] valid-freq: 50000000
[2023-07-23 00:35:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:51] [config] valid-max-length: 1000
[2023-07-23 00:35:51] [config] valid-metrics:
[2023-07-23 00:35:51] [config]   - cross-entropy
[2023-07-23 00:35:51] [config]   - translation
[2023-07-23 00:35:51] [config] valid-mini-batch: 32
[2023-07-23 00:35:51] [config] valid-reset-stalled: false
[2023-07-23 00:35:51] [config] valid-script-args:
[2023-07-23 00:35:51] [config]   []
[2023-07-23 00:35:51] [config] valid-script-path: ""
[2023-07-23 00:35:51] [config] valid-sets:
[2023-07-23 00:35:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:51] [config] vocabs:
[2023-07-23 00:35:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:51] [config] word-penalty: 0
[2023-07-23 00:35:51] [config] word-scores: false
[2023-07-23 00:35:51] [config] workspace: 5500
[2023-07-23 00:35:51] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:51] [training] Using single-device training
[2023-07-23 00:35:51] Synced seed 1234
[2023-07-23 00:35:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:53] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:53] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x563fb508b692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x563fb4fccda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x563fb4fd11a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x563fb4fd82ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x563fb5184a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x563fb5185a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x563fb515ebee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x563fb4c60108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x563fb4b822c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563fb4b39b9c]    main                                               + 0x3c
[0x7f710088f0b3]    __libc_start_main                                  + 0xf3
[0x563fb4b80cbe]    _start                                             + 0x2e

[2023-07-23 00:35:56] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:56] [marian] Running on node23.datos.cluster.uy as process 7146 with command line:
[2023-07-23 00:35:56] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:35:56] [config] after: 0e
[2023-07-23 00:35:56] [config] after-batches: 0
[2023-07-23 00:35:56] [config] after-epochs: 10
[2023-07-23 00:35:56] [config] all-caps-every: 0
[2023-07-23 00:35:56] [config] allow-unk: false
[2023-07-23 00:35:56] [config] authors: false
[2023-07-23 00:35:56] [config] beam-size: 12
[2023-07-23 00:35:56] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:35:56] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:35:56] [config] bert-masking-fraction: 0.15
[2023-07-23 00:35:56] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:35:56] [config] bert-train-type-embeddings: true
[2023-07-23 00:35:56] [config] bert-type-vocab-size: 2
[2023-07-23 00:35:56] [config] build-info: ""
[2023-07-23 00:35:56] [config] check-gradient-nan: false
[2023-07-23 00:35:56] [config] check-nan: false
[2023-07-23 00:35:56] [config] cite: false
[2023-07-23 00:35:56] [config] clip-norm: 1
[2023-07-23 00:35:56] [config] cost-scaling:
[2023-07-23 00:35:56] [config]   - 256.f
[2023-07-23 00:35:56] [config]   - 1000
[2023-07-23 00:35:56] [config]   - 2.f
[2023-07-23 00:35:56] [config]   - 256.f
[2023-07-23 00:35:56] [config] cost-type: ce-sum
[2023-07-23 00:35:56] [config] cpu-threads: 0
[2023-07-23 00:35:56] [config] data-threads: 8
[2023-07-23 00:35:56] [config] data-weighting: ""
[2023-07-23 00:35:56] [config] data-weighting-type: sentence
[2023-07-23 00:35:56] [config] dec-cell: gru
[2023-07-23 00:35:56] [config] dec-cell-base-depth: 2
[2023-07-23 00:35:56] [config] dec-cell-high-depth: 1
[2023-07-23 00:35:56] [config] dec-depth: 1
[2023-07-23 00:35:56] [config] devices:
[2023-07-23 00:35:56] [config]   - 0
[2023-07-23 00:35:56] [config] dim-emb: 512
[2023-07-23 00:35:56] [config] dim-rnn: 1024
[2023-07-23 00:35:56] [config] dim-vocabs:
[2023-07-23 00:35:56] [config]   - 16384
[2023-07-23 00:35:56] [config]   - 16384
[2023-07-23 00:35:56] [config] disp-first: 0
[2023-07-23 00:35:56] [config] disp-freq: 1000u
[2023-07-23 00:35:56] [config] disp-label-counts: true
[2023-07-23 00:35:56] [config] dropout-rnn: 0
[2023-07-23 00:35:56] [config] dropout-src: 0
[2023-07-23 00:35:56] [config] dropout-trg: 0
[2023-07-23 00:35:56] [config] dump-config: ""
[2023-07-23 00:35:56] [config] dynamic-gradient-scaling:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] early-stopping: 200
[2023-07-23 00:35:56] [config] early-stopping-on: first
[2023-07-23 00:35:56] [config] embedding-fix-src: false
[2023-07-23 00:35:56] [config] embedding-fix-trg: false
[2023-07-23 00:35:56] [config] embedding-normalization: false
[2023-07-23 00:35:56] [config] embedding-vectors:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] enc-cell: tanh
[2023-07-23 00:35:56] [config] enc-cell-depth: 1
[2023-07-23 00:35:56] [config] enc-depth: 1
[2023-07-23 00:35:56] [config] enc-type: bidirectional
[2023-07-23 00:35:56] [config] english-title-case-every: 0
[2023-07-23 00:35:56] [config] exponential-smoothing: 0
[2023-07-23 00:35:56] [config] factor-weight: 1
[2023-07-23 00:35:56] [config] factors-combine: sum
[2023-07-23 00:35:56] [config] factors-dim-emb: 0
[2023-07-23 00:35:56] [config] gradient-checkpointing: false
[2023-07-23 00:35:56] [config] gradient-norm-average-window: 100
[2023-07-23 00:35:56] [config] guided-alignment: none
[2023-07-23 00:35:56] [config] guided-alignment-cost: mse
[2023-07-23 00:35:56] [config] guided-alignment-weight: 0.1
[2023-07-23 00:35:56] [config] ignore-model-config: false
[2023-07-23 00:35:56] [config] input-types:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] interpolate-env-vars: false
[2023-07-23 00:35:56] [config] keep-best: false
[2023-07-23 00:35:56] [config] label-smoothing: 0
[2023-07-23 00:35:56] [config] layer-normalization: false
[2023-07-23 00:35:56] [config] learn-rate: 0.0001
[2023-07-23 00:35:56] [config] lemma-dependency: ""
[2023-07-23 00:35:56] [config] lemma-dim-emb: 0
[2023-07-23 00:35:56] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:56] [config] log-level: info
[2023-07-23 00:35:56] [config] log-time-zone: ""
[2023-07-23 00:35:56] [config] logical-epoch:
[2023-07-23 00:35:56] [config]   - 1e
[2023-07-23 00:35:56] [config]   - 0
[2023-07-23 00:35:56] [config] lr-decay: 0
[2023-07-23 00:35:56] [config] lr-decay-freq: 50000
[2023-07-23 00:35:56] [config] lr-decay-inv-sqrt:
[2023-07-23 00:35:56] [config]   - 0
[2023-07-23 00:35:56] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:35:56] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:35:56] [config] lr-decay-start:
[2023-07-23 00:35:56] [config]   - 10
[2023-07-23 00:35:56] [config]   - 1
[2023-07-23 00:35:56] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:35:56] [config] lr-report: false
[2023-07-23 00:35:56] [config] lr-warmup: 0
[2023-07-23 00:35:56] [config] lr-warmup-at-reload: false
[2023-07-23 00:35:56] [config] lr-warmup-cycle: false
[2023-07-23 00:35:56] [config] lr-warmup-start-rate: 0
[2023-07-23 00:35:56] [config] max-length: 50
[2023-07-23 00:35:56] [config] max-length-crop: true
[2023-07-23 00:35:56] [config] max-length-factor: 3
[2023-07-23 00:35:56] [config] maxi-batch: 100
[2023-07-23 00:35:56] [config] maxi-batch-sort: trg
[2023-07-23 00:35:56] [config] mini-batch: 64
[2023-07-23 00:35:56] [config] mini-batch-fit: true
[2023-07-23 00:35:56] [config] mini-batch-fit-step: 10
[2023-07-23 00:35:56] [config] mini-batch-round-up: true
[2023-07-23 00:35:56] [config] mini-batch-track-lr: false
[2023-07-23 00:35:56] [config] mini-batch-warmup: 0
[2023-07-23 00:35:56] [config] mini-batch-words: 0
[2023-07-23 00:35:56] [config] mini-batch-words-ref: 0
[2023-07-23 00:35:56] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:35:56] [config] multi-loss-type: sum
[2023-07-23 00:35:56] [config] n-best: false
[2023-07-23 00:35:56] [config] no-nccl: false
[2023-07-23 00:35:56] [config] no-reload: false
[2023-07-23 00:35:56] [config] no-restore-corpus: false
[2023-07-23 00:35:56] [config] normalize: 0
[2023-07-23 00:35:56] [config] normalize-gradient: false
[2023-07-23 00:35:56] [config] num-devices: 0
[2023-07-23 00:35:56] [config] optimizer: adam
[2023-07-23 00:35:56] [config] optimizer-delay: 1
[2023-07-23 00:35:56] [config] optimizer-params:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] output-omit-bias: false
[2023-07-23 00:35:56] [config] overwrite: true
[2023-07-23 00:35:56] [config] precision:
[2023-07-23 00:35:56] [config]   - float16
[2023-07-23 00:35:56] [config]   - float32
[2023-07-23 00:35:56] [config] pretrained-model: ""
[2023-07-23 00:35:56] [config] quantize-biases: false
[2023-07-23 00:35:56] [config] quantize-bits: 0
[2023-07-23 00:35:56] [config] quantize-log-based: false
[2023-07-23 00:35:56] [config] quantize-optimization-steps: 0
[2023-07-23 00:35:56] [config] quiet: false
[2023-07-23 00:35:56] [config] quiet-translation: true
[2023-07-23 00:35:56] [config] relative-paths: false
[2023-07-23 00:35:56] [config] right-left: false
[2023-07-23 00:35:56] [config] save-freq: 10000u
[2023-07-23 00:35:56] [config] seed: 1234
[2023-07-23 00:35:56] [config] sentencepiece-alphas:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:35:56] [config] sentencepiece-options: ""
[2023-07-23 00:35:56] [config] sharding: global
[2023-07-23 00:35:56] [config] shuffle: data
[2023-07-23 00:35:56] [config] shuffle-in-ram: false
[2023-07-23 00:35:56] [config] sigterm: save-and-exit
[2023-07-23 00:35:56] [config] skip: false
[2023-07-23 00:35:56] [config] sqlite: ""
[2023-07-23 00:35:56] [config] sqlite-drop: false
[2023-07-23 00:35:56] [config] sync-freq: 200u
[2023-07-23 00:35:56] [config] sync-sgd: false
[2023-07-23 00:35:56] [config] tempdir: /tmp
[2023-07-23 00:35:56] [config] tied-embeddings: false
[2023-07-23 00:35:56] [config] tied-embeddings-all: true
[2023-07-23 00:35:56] [config] tied-embeddings-src: false
[2023-07-23 00:35:56] [config] train-embedder-rank:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] train-sets:
[2023-07-23 00:35:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:35:56] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:35:56] [config] transformer-aan-activation: swish
[2023-07-23 00:35:56] [config] transformer-aan-depth: 2
[2023-07-23 00:35:56] [config] transformer-aan-nogate: false
[2023-07-23 00:35:56] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:35:56] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:35:56] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:35:56] [config] transformer-depth-scaling: false
[2023-07-23 00:35:56] [config] transformer-dim-aan: 2048
[2023-07-23 00:35:56] [config] transformer-dim-ffn: 2048
[2023-07-23 00:35:56] [config] transformer-dropout: 0
[2023-07-23 00:35:56] [config] transformer-dropout-attention: 0
[2023-07-23 00:35:56] [config] transformer-dropout-ffn: 0
[2023-07-23 00:35:56] [config] transformer-ffn-activation: swish
[2023-07-23 00:35:56] [config] transformer-ffn-depth: 2
[2023-07-23 00:35:56] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:35:56] [config] transformer-heads: 8
[2023-07-23 00:35:56] [config] transformer-no-projection: false
[2023-07-23 00:35:56] [config] transformer-pool: false
[2023-07-23 00:35:56] [config] transformer-postprocess: dan
[2023-07-23 00:35:56] [config] transformer-postprocess-emb: d
[2023-07-23 00:35:56] [config] transformer-postprocess-top: ""
[2023-07-23 00:35:56] [config] transformer-preprocess: ""
[2023-07-23 00:35:56] [config] transformer-tied-layers:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] transformer-train-position-embeddings: false
[2023-07-23 00:35:56] [config] tsv: false
[2023-07-23 00:35:56] [config] tsv-fields: 0
[2023-07-23 00:35:56] [config] type: amun
[2023-07-23 00:35:56] [config] ulr: false
[2023-07-23 00:35:56] [config] ulr-dim-emb: 0
[2023-07-23 00:35:56] [config] ulr-dropout: 0
[2023-07-23 00:35:56] [config] ulr-keys-vectors: ""
[2023-07-23 00:35:56] [config] ulr-query-vectors: ""
[2023-07-23 00:35:56] [config] ulr-softmax-temperature: 1
[2023-07-23 00:35:56] [config] ulr-trainable-transformation: false
[2023-07-23 00:35:56] [config] unlikelihood-loss: false
[2023-07-23 00:35:56] [config] valid-freq: 50000000
[2023-07-23 00:35:56] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:35:56] [config] valid-max-length: 1000
[2023-07-23 00:35:56] [config] valid-metrics:
[2023-07-23 00:35:56] [config]   - cross-entropy
[2023-07-23 00:35:56] [config]   - translation
[2023-07-23 00:35:56] [config] valid-mini-batch: 32
[2023-07-23 00:35:56] [config] valid-reset-stalled: false
[2023-07-23 00:35:56] [config] valid-script-args:
[2023-07-23 00:35:56] [config]   []
[2023-07-23 00:35:56] [config] valid-script-path: ""
[2023-07-23 00:35:56] [config] valid-sets:
[2023-07-23 00:35:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:35:56] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:35:56] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:35:56] [config] vocabs:
[2023-07-23 00:35:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:56] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:56] [config] word-penalty: 0
[2023-07-23 00:35:56] [config] word-scores: false
[2023-07-23 00:35:56] [config] workspace: 5500
[2023-07-23 00:35:56] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:35:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:56] [training] Using single-device training
[2023-07-23 00:35:56] Synced seed 1234
[2023-07-23 00:35:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:35:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:35:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:35:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:35:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:35:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:35:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:35:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:35:58] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:35:58] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x556b4f737692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x556b4f678da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x556b4f67d1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x556b4f6842ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x556b4f830a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x556b4f831a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x556b4f80abee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x556b4f30c108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x556b4f22e2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556b4f1e5b9c]    main                                               + 0x3c
[0x7fe0fe4410b3]    __libc_start_main                                  + 0xf3
[0x556b4f22ccbe]    _start                                             + 0x2e

[2023-07-23 00:36:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:01] [marian] Running on node23.datos.cluster.uy as process 7173 with command line:
[2023-07-23 00:36:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:01] [config] after: 0e
[2023-07-23 00:36:01] [config] after-batches: 0
[2023-07-23 00:36:01] [config] after-epochs: 20
[2023-07-23 00:36:01] [config] all-caps-every: 0
[2023-07-23 00:36:01] [config] allow-unk: false
[2023-07-23 00:36:01] [config] authors: false
[2023-07-23 00:36:01] [config] beam-size: 12
[2023-07-23 00:36:01] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:01] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:01] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:01] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:01] [config] build-info: ""
[2023-07-23 00:36:01] [config] check-gradient-nan: false
[2023-07-23 00:36:01] [config] check-nan: false
[2023-07-23 00:36:01] [config] cite: false
[2023-07-23 00:36:01] [config] clip-norm: 1
[2023-07-23 00:36:01] [config] cost-scaling:
[2023-07-23 00:36:01] [config]   - 256.f
[2023-07-23 00:36:01] [config]   - 1000
[2023-07-23 00:36:01] [config]   - 2.f
[2023-07-23 00:36:01] [config]   - 256.f
[2023-07-23 00:36:01] [config] cost-type: ce-sum
[2023-07-23 00:36:01] [config] cpu-threads: 0
[2023-07-23 00:36:01] [config] data-threads: 8
[2023-07-23 00:36:01] [config] data-weighting: ""
[2023-07-23 00:36:01] [config] data-weighting-type: sentence
[2023-07-23 00:36:01] [config] dec-cell: gru
[2023-07-23 00:36:01] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:01] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:01] [config] dec-depth: 1
[2023-07-23 00:36:01] [config] devices:
[2023-07-23 00:36:01] [config]   - 0
[2023-07-23 00:36:01] [config] dim-emb: 512
[2023-07-23 00:36:01] [config] dim-rnn: 1024
[2023-07-23 00:36:01] [config] dim-vocabs:
[2023-07-23 00:36:01] [config]   - 16384
[2023-07-23 00:36:01] [config]   - 16384
[2023-07-23 00:36:01] [config] disp-first: 0
[2023-07-23 00:36:01] [config] disp-freq: 1000u
[2023-07-23 00:36:01] [config] disp-label-counts: true
[2023-07-23 00:36:01] [config] dropout-rnn: 0
[2023-07-23 00:36:01] [config] dropout-src: 0
[2023-07-23 00:36:01] [config] dropout-trg: 0
[2023-07-23 00:36:01] [config] dump-config: ""
[2023-07-23 00:36:01] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] early-stopping: 200
[2023-07-23 00:36:01] [config] early-stopping-on: first
[2023-07-23 00:36:01] [config] embedding-fix-src: false
[2023-07-23 00:36:01] [config] embedding-fix-trg: false
[2023-07-23 00:36:01] [config] embedding-normalization: false
[2023-07-23 00:36:01] [config] embedding-vectors:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] enc-cell: tanh
[2023-07-23 00:36:01] [config] enc-cell-depth: 1
[2023-07-23 00:36:01] [config] enc-depth: 1
[2023-07-23 00:36:01] [config] enc-type: bidirectional
[2023-07-23 00:36:01] [config] english-title-case-every: 0
[2023-07-23 00:36:01] [config] exponential-smoothing: 0
[2023-07-23 00:36:01] [config] factor-weight: 1
[2023-07-23 00:36:01] [config] factors-combine: sum
[2023-07-23 00:36:01] [config] factors-dim-emb: 0
[2023-07-23 00:36:01] [config] gradient-checkpointing: false
[2023-07-23 00:36:01] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:01] [config] guided-alignment: none
[2023-07-23 00:36:01] [config] guided-alignment-cost: mse
[2023-07-23 00:36:01] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:01] [config] ignore-model-config: false
[2023-07-23 00:36:01] [config] input-types:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] interpolate-env-vars: false
[2023-07-23 00:36:01] [config] keep-best: false
[2023-07-23 00:36:01] [config] label-smoothing: 0
[2023-07-23 00:36:01] [config] layer-normalization: false
[2023-07-23 00:36:01] [config] learn-rate: 0.0001
[2023-07-23 00:36:01] [config] lemma-dependency: ""
[2023-07-23 00:36:01] [config] lemma-dim-emb: 0
[2023-07-23 00:36:01] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:01] [config] log-level: info
[2023-07-23 00:36:01] [config] log-time-zone: ""
[2023-07-23 00:36:01] [config] logical-epoch:
[2023-07-23 00:36:01] [config]   - 1e
[2023-07-23 00:36:01] [config]   - 0
[2023-07-23 00:36:01] [config] lr-decay: 0
[2023-07-23 00:36:01] [config] lr-decay-freq: 50000
[2023-07-23 00:36:01] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:01] [config]   - 0
[2023-07-23 00:36:01] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:01] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:01] [config] lr-decay-start:
[2023-07-23 00:36:01] [config]   - 10
[2023-07-23 00:36:01] [config]   - 1
[2023-07-23 00:36:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:01] [config] lr-report: false
[2023-07-23 00:36:01] [config] lr-warmup: 0
[2023-07-23 00:36:01] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:01] [config] lr-warmup-cycle: false
[2023-07-23 00:36:01] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:01] [config] max-length: 50
[2023-07-23 00:36:01] [config] max-length-crop: true
[2023-07-23 00:36:01] [config] max-length-factor: 3
[2023-07-23 00:36:01] [config] maxi-batch: 100
[2023-07-23 00:36:01] [config] maxi-batch-sort: trg
[2023-07-23 00:36:01] [config] mini-batch: 64
[2023-07-23 00:36:01] [config] mini-batch-fit: true
[2023-07-23 00:36:01] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:01] [config] mini-batch-round-up: true
[2023-07-23 00:36:01] [config] mini-batch-track-lr: false
[2023-07-23 00:36:01] [config] mini-batch-warmup: 0
[2023-07-23 00:36:01] [config] mini-batch-words: 0
[2023-07-23 00:36:01] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:01] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:01] [config] multi-loss-type: sum
[2023-07-23 00:36:01] [config] n-best: false
[2023-07-23 00:36:01] [config] no-nccl: false
[2023-07-23 00:36:01] [config] no-reload: false
[2023-07-23 00:36:01] [config] no-restore-corpus: false
[2023-07-23 00:36:01] [config] normalize: 0
[2023-07-23 00:36:01] [config] normalize-gradient: false
[2023-07-23 00:36:01] [config] num-devices: 0
[2023-07-23 00:36:01] [config] optimizer: adam
[2023-07-23 00:36:01] [config] optimizer-delay: 1
[2023-07-23 00:36:01] [config] optimizer-params:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] output-omit-bias: false
[2023-07-23 00:36:01] [config] overwrite: true
[2023-07-23 00:36:01] [config] precision:
[2023-07-23 00:36:01] [config]   - float16
[2023-07-23 00:36:01] [config]   - float32
[2023-07-23 00:36:01] [config] pretrained-model: ""
[2023-07-23 00:36:01] [config] quantize-biases: false
[2023-07-23 00:36:01] [config] quantize-bits: 0
[2023-07-23 00:36:01] [config] quantize-log-based: false
[2023-07-23 00:36:01] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:01] [config] quiet: false
[2023-07-23 00:36:01] [config] quiet-translation: true
[2023-07-23 00:36:01] [config] relative-paths: false
[2023-07-23 00:36:01] [config] right-left: false
[2023-07-23 00:36:01] [config] save-freq: 10000u
[2023-07-23 00:36:01] [config] seed: 1234
[2023-07-23 00:36:01] [config] sentencepiece-alphas:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:01] [config] sentencepiece-options: ""
[2023-07-23 00:36:01] [config] sharding: global
[2023-07-23 00:36:01] [config] shuffle: data
[2023-07-23 00:36:01] [config] shuffle-in-ram: false
[2023-07-23 00:36:01] [config] sigterm: save-and-exit
[2023-07-23 00:36:01] [config] skip: false
[2023-07-23 00:36:01] [config] sqlite: ""
[2023-07-23 00:36:01] [config] sqlite-drop: false
[2023-07-23 00:36:01] [config] sync-freq: 200u
[2023-07-23 00:36:01] [config] sync-sgd: false
[2023-07-23 00:36:01] [config] tempdir: /tmp
[2023-07-23 00:36:01] [config] tied-embeddings: false
[2023-07-23 00:36:01] [config] tied-embeddings-all: true
[2023-07-23 00:36:01] [config] tied-embeddings-src: false
[2023-07-23 00:36:01] [config] train-embedder-rank:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] train-sets:
[2023-07-23 00:36:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:01] [config] transformer-aan-activation: swish
[2023-07-23 00:36:01] [config] transformer-aan-depth: 2
[2023-07-23 00:36:01] [config] transformer-aan-nogate: false
[2023-07-23 00:36:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:01] [config] transformer-depth-scaling: false
[2023-07-23 00:36:01] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:01] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:01] [config] transformer-dropout: 0
[2023-07-23 00:36:01] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:01] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:01] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:01] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:01] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:01] [config] transformer-heads: 8
[2023-07-23 00:36:01] [config] transformer-no-projection: false
[2023-07-23 00:36:01] [config] transformer-pool: false
[2023-07-23 00:36:01] [config] transformer-postprocess: dan
[2023-07-23 00:36:01] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:01] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:01] [config] transformer-preprocess: ""
[2023-07-23 00:36:01] [config] transformer-tied-layers:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:01] [config] tsv: false
[2023-07-23 00:36:01] [config] tsv-fields: 0
[2023-07-23 00:36:01] [config] type: amun
[2023-07-23 00:36:01] [config] ulr: false
[2023-07-23 00:36:01] [config] ulr-dim-emb: 0
[2023-07-23 00:36:01] [config] ulr-dropout: 0
[2023-07-23 00:36:01] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:01] [config] ulr-query-vectors: ""
[2023-07-23 00:36:01] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:01] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:01] [config] unlikelihood-loss: false
[2023-07-23 00:36:01] [config] valid-freq: 50000000
[2023-07-23 00:36:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:01] [config] valid-max-length: 1000
[2023-07-23 00:36:01] [config] valid-metrics:
[2023-07-23 00:36:01] [config]   - cross-entropy
[2023-07-23 00:36:01] [config]   - translation
[2023-07-23 00:36:01] [config] valid-mini-batch: 32
[2023-07-23 00:36:01] [config] valid-reset-stalled: false
[2023-07-23 00:36:01] [config] valid-script-args:
[2023-07-23 00:36:01] [config]   []
[2023-07-23 00:36:01] [config] valid-script-path: ""
[2023-07-23 00:36:01] [config] valid-sets:
[2023-07-23 00:36:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:01] [config] vocabs:
[2023-07-23 00:36:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:01] [config] word-penalty: 0
[2023-07-23 00:36:01] [config] word-scores: false
[2023-07-23 00:36:01] [config] workspace: 5500
[2023-07-23 00:36:01] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:01] [training] Using single-device training
[2023-07-23 00:36:01] Synced seed 1234
[2023-07-23 00:36:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:02] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:02] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x560abe9f4692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x560abe935da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x560abe93a1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x560abe9412ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x560abeaeda0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x560abeaeea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x560abeac7bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x560abe5c9108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x560abe4eb2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x560abe4a2b9c]    main                                               + 0x3c
[0x7fda079210b3]    __libc_start_main                                  + 0xf3
[0x560abe4e9cbe]    _start                                             + 0x2e

[2023-07-23 00:36:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:06] [marian] Running on node23.datos.cluster.uy as process 7201 with command line:
[2023-07-23 00:36:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:06] [config] after: 0e
[2023-07-23 00:36:06] [config] after-batches: 0
[2023-07-23 00:36:06] [config] after-epochs: 30
[2023-07-23 00:36:06] [config] all-caps-every: 0
[2023-07-23 00:36:06] [config] allow-unk: false
[2023-07-23 00:36:06] [config] authors: false
[2023-07-23 00:36:06] [config] beam-size: 12
[2023-07-23 00:36:06] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:06] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:06] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:06] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:06] [config] build-info: ""
[2023-07-23 00:36:06] [config] check-gradient-nan: false
[2023-07-23 00:36:06] [config] check-nan: false
[2023-07-23 00:36:06] [config] cite: false
[2023-07-23 00:36:06] [config] clip-norm: 1
[2023-07-23 00:36:06] [config] cost-scaling:
[2023-07-23 00:36:06] [config]   - 256.f
[2023-07-23 00:36:06] [config]   - 1000
[2023-07-23 00:36:06] [config]   - 2.f
[2023-07-23 00:36:06] [config]   - 256.f
[2023-07-23 00:36:06] [config] cost-type: ce-sum
[2023-07-23 00:36:06] [config] cpu-threads: 0
[2023-07-23 00:36:06] [config] data-threads: 8
[2023-07-23 00:36:06] [config] data-weighting: ""
[2023-07-23 00:36:06] [config] data-weighting-type: sentence
[2023-07-23 00:36:06] [config] dec-cell: gru
[2023-07-23 00:36:06] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:06] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:06] [config] dec-depth: 1
[2023-07-23 00:36:06] [config] devices:
[2023-07-23 00:36:06] [config]   - 0
[2023-07-23 00:36:06] [config] dim-emb: 512
[2023-07-23 00:36:06] [config] dim-rnn: 1024
[2023-07-23 00:36:06] [config] dim-vocabs:
[2023-07-23 00:36:06] [config]   - 16384
[2023-07-23 00:36:06] [config]   - 16384
[2023-07-23 00:36:06] [config] disp-first: 0
[2023-07-23 00:36:06] [config] disp-freq: 1000u
[2023-07-23 00:36:06] [config] disp-label-counts: true
[2023-07-23 00:36:06] [config] dropout-rnn: 0
[2023-07-23 00:36:06] [config] dropout-src: 0
[2023-07-23 00:36:06] [config] dropout-trg: 0
[2023-07-23 00:36:06] [config] dump-config: ""
[2023-07-23 00:36:06] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] early-stopping: 200
[2023-07-23 00:36:06] [config] early-stopping-on: first
[2023-07-23 00:36:06] [config] embedding-fix-src: false
[2023-07-23 00:36:06] [config] embedding-fix-trg: false
[2023-07-23 00:36:06] [config] embedding-normalization: false
[2023-07-23 00:36:06] [config] embedding-vectors:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] enc-cell: tanh
[2023-07-23 00:36:06] [config] enc-cell-depth: 1
[2023-07-23 00:36:06] [config] enc-depth: 1
[2023-07-23 00:36:06] [config] enc-type: bidirectional
[2023-07-23 00:36:06] [config] english-title-case-every: 0
[2023-07-23 00:36:06] [config] exponential-smoothing: 0
[2023-07-23 00:36:06] [config] factor-weight: 1
[2023-07-23 00:36:06] [config] factors-combine: sum
[2023-07-23 00:36:06] [config] factors-dim-emb: 0
[2023-07-23 00:36:06] [config] gradient-checkpointing: false
[2023-07-23 00:36:06] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:06] [config] guided-alignment: none
[2023-07-23 00:36:06] [config] guided-alignment-cost: mse
[2023-07-23 00:36:06] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:06] [config] ignore-model-config: false
[2023-07-23 00:36:06] [config] input-types:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] interpolate-env-vars: false
[2023-07-23 00:36:06] [config] keep-best: false
[2023-07-23 00:36:06] [config] label-smoothing: 0
[2023-07-23 00:36:06] [config] layer-normalization: false
[2023-07-23 00:36:06] [config] learn-rate: 0.0001
[2023-07-23 00:36:06] [config] lemma-dependency: ""
[2023-07-23 00:36:06] [config] lemma-dim-emb: 0
[2023-07-23 00:36:06] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:06] [config] log-level: info
[2023-07-23 00:36:06] [config] log-time-zone: ""
[2023-07-23 00:36:06] [config] logical-epoch:
[2023-07-23 00:36:06] [config]   - 1e
[2023-07-23 00:36:06] [config]   - 0
[2023-07-23 00:36:06] [config] lr-decay: 0
[2023-07-23 00:36:06] [config] lr-decay-freq: 50000
[2023-07-23 00:36:06] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:06] [config]   - 0
[2023-07-23 00:36:06] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:06] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:06] [config] lr-decay-start:
[2023-07-23 00:36:06] [config]   - 10
[2023-07-23 00:36:06] [config]   - 1
[2023-07-23 00:36:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:06] [config] lr-report: false
[2023-07-23 00:36:06] [config] lr-warmup: 0
[2023-07-23 00:36:06] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:06] [config] lr-warmup-cycle: false
[2023-07-23 00:36:06] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:06] [config] max-length: 50
[2023-07-23 00:36:06] [config] max-length-crop: true
[2023-07-23 00:36:06] [config] max-length-factor: 3
[2023-07-23 00:36:06] [config] maxi-batch: 100
[2023-07-23 00:36:06] [config] maxi-batch-sort: trg
[2023-07-23 00:36:06] [config] mini-batch: 64
[2023-07-23 00:36:06] [config] mini-batch-fit: true
[2023-07-23 00:36:06] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:06] [config] mini-batch-round-up: true
[2023-07-23 00:36:06] [config] mini-batch-track-lr: false
[2023-07-23 00:36:06] [config] mini-batch-warmup: 0
[2023-07-23 00:36:06] [config] mini-batch-words: 0
[2023-07-23 00:36:06] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:06] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:06] [config] multi-loss-type: sum
[2023-07-23 00:36:06] [config] n-best: false
[2023-07-23 00:36:06] [config] no-nccl: false
[2023-07-23 00:36:06] [config] no-reload: false
[2023-07-23 00:36:06] [config] no-restore-corpus: false
[2023-07-23 00:36:06] [config] normalize: 0
[2023-07-23 00:36:06] [config] normalize-gradient: false
[2023-07-23 00:36:06] [config] num-devices: 0
[2023-07-23 00:36:06] [config] optimizer: adam
[2023-07-23 00:36:06] [config] optimizer-delay: 1
[2023-07-23 00:36:06] [config] optimizer-params:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] output-omit-bias: false
[2023-07-23 00:36:06] [config] overwrite: true
[2023-07-23 00:36:06] [config] precision:
[2023-07-23 00:36:06] [config]   - float16
[2023-07-23 00:36:06] [config]   - float32
[2023-07-23 00:36:06] [config] pretrained-model: ""
[2023-07-23 00:36:06] [config] quantize-biases: false
[2023-07-23 00:36:06] [config] quantize-bits: 0
[2023-07-23 00:36:06] [config] quantize-log-based: false
[2023-07-23 00:36:06] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:06] [config] quiet: false
[2023-07-23 00:36:06] [config] quiet-translation: true
[2023-07-23 00:36:06] [config] relative-paths: false
[2023-07-23 00:36:06] [config] right-left: false
[2023-07-23 00:36:06] [config] save-freq: 10000u
[2023-07-23 00:36:06] [config] seed: 1234
[2023-07-23 00:36:06] [config] sentencepiece-alphas:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:06] [config] sentencepiece-options: ""
[2023-07-23 00:36:06] [config] sharding: global
[2023-07-23 00:36:06] [config] shuffle: data
[2023-07-23 00:36:06] [config] shuffle-in-ram: false
[2023-07-23 00:36:06] [config] sigterm: save-and-exit
[2023-07-23 00:36:06] [config] skip: false
[2023-07-23 00:36:06] [config] sqlite: ""
[2023-07-23 00:36:06] [config] sqlite-drop: false
[2023-07-23 00:36:06] [config] sync-freq: 200u
[2023-07-23 00:36:06] [config] sync-sgd: false
[2023-07-23 00:36:06] [config] tempdir: /tmp
[2023-07-23 00:36:06] [config] tied-embeddings: false
[2023-07-23 00:36:06] [config] tied-embeddings-all: true
[2023-07-23 00:36:06] [config] tied-embeddings-src: false
[2023-07-23 00:36:06] [config] train-embedder-rank:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] train-sets:
[2023-07-23 00:36:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:06] [config] transformer-aan-activation: swish
[2023-07-23 00:36:06] [config] transformer-aan-depth: 2
[2023-07-23 00:36:06] [config] transformer-aan-nogate: false
[2023-07-23 00:36:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:06] [config] transformer-depth-scaling: false
[2023-07-23 00:36:06] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:06] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:06] [config] transformer-dropout: 0
[2023-07-23 00:36:06] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:06] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:06] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:06] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:06] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:06] [config] transformer-heads: 8
[2023-07-23 00:36:06] [config] transformer-no-projection: false
[2023-07-23 00:36:06] [config] transformer-pool: false
[2023-07-23 00:36:06] [config] transformer-postprocess: dan
[2023-07-23 00:36:06] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:06] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:06] [config] transformer-preprocess: ""
[2023-07-23 00:36:06] [config] transformer-tied-layers:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:06] [config] tsv: false
[2023-07-23 00:36:06] [config] tsv-fields: 0
[2023-07-23 00:36:06] [config] type: amun
[2023-07-23 00:36:06] [config] ulr: false
[2023-07-23 00:36:06] [config] ulr-dim-emb: 0
[2023-07-23 00:36:06] [config] ulr-dropout: 0
[2023-07-23 00:36:06] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:06] [config] ulr-query-vectors: ""
[2023-07-23 00:36:06] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:06] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:06] [config] unlikelihood-loss: false
[2023-07-23 00:36:06] [config] valid-freq: 50000000
[2023-07-23 00:36:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:06] [config] valid-max-length: 1000
[2023-07-23 00:36:06] [config] valid-metrics:
[2023-07-23 00:36:06] [config]   - cross-entropy
[2023-07-23 00:36:06] [config]   - translation
[2023-07-23 00:36:06] [config] valid-mini-batch: 32
[2023-07-23 00:36:06] [config] valid-reset-stalled: false
[2023-07-23 00:36:06] [config] valid-script-args:
[2023-07-23 00:36:06] [config]   []
[2023-07-23 00:36:06] [config] valid-script-path: ""
[2023-07-23 00:36:06] [config] valid-sets:
[2023-07-23 00:36:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:06] [config] vocabs:
[2023-07-23 00:36:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:06] [config] word-penalty: 0
[2023-07-23 00:36:06] [config] word-scores: false
[2023-07-23 00:36:06] [config] workspace: 5500
[2023-07-23 00:36:06] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:06] [training] Using single-device training
[2023-07-23 00:36:06] Synced seed 1234
[2023-07-23 00:36:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:06] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:07] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:07] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55ae64cea692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55ae64c2bda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55ae64c301a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55ae64c372ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55ae64de3a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55ae64de4a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55ae64dbdbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55ae648bf108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55ae647e12c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55ae64798b9c]    main                                               + 0x3c
[0x7f2cb65b10b3]    __libc_start_main                                  + 0xf3
[0x55ae647dfcbe]    _start                                             + 0x2e

[2023-07-23 00:36:10] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:10] [marian] Running on node23.datos.cluster.uy as process 7227 with command line:
[2023-07-23 00:36:10] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:10] [config] after: 0e
[2023-07-23 00:36:10] [config] after-batches: 0
[2023-07-23 00:36:10] [config] after-epochs: 40
[2023-07-23 00:36:10] [config] all-caps-every: 0
[2023-07-23 00:36:10] [config] allow-unk: false
[2023-07-23 00:36:10] [config] authors: false
[2023-07-23 00:36:10] [config] beam-size: 12
[2023-07-23 00:36:10] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:10] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:10] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:10] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:10] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:10] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:10] [config] build-info: ""
[2023-07-23 00:36:10] [config] check-gradient-nan: false
[2023-07-23 00:36:10] [config] check-nan: false
[2023-07-23 00:36:10] [config] cite: false
[2023-07-23 00:36:10] [config] clip-norm: 1
[2023-07-23 00:36:10] [config] cost-scaling:
[2023-07-23 00:36:10] [config]   - 256.f
[2023-07-23 00:36:10] [config]   - 1000
[2023-07-23 00:36:10] [config]   - 2.f
[2023-07-23 00:36:10] [config]   - 256.f
[2023-07-23 00:36:10] [config] cost-type: ce-sum
[2023-07-23 00:36:10] [config] cpu-threads: 0
[2023-07-23 00:36:10] [config] data-threads: 8
[2023-07-23 00:36:10] [config] data-weighting: ""
[2023-07-23 00:36:10] [config] data-weighting-type: sentence
[2023-07-23 00:36:10] [config] dec-cell: gru
[2023-07-23 00:36:10] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:10] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:10] [config] dec-depth: 1
[2023-07-23 00:36:10] [config] devices:
[2023-07-23 00:36:10] [config]   - 0
[2023-07-23 00:36:10] [config] dim-emb: 512
[2023-07-23 00:36:10] [config] dim-rnn: 1024
[2023-07-23 00:36:10] [config] dim-vocabs:
[2023-07-23 00:36:10] [config]   - 16384
[2023-07-23 00:36:10] [config]   - 16384
[2023-07-23 00:36:10] [config] disp-first: 0
[2023-07-23 00:36:10] [config] disp-freq: 1000u
[2023-07-23 00:36:10] [config] disp-label-counts: true
[2023-07-23 00:36:10] [config] dropout-rnn: 0
[2023-07-23 00:36:10] [config] dropout-src: 0
[2023-07-23 00:36:10] [config] dropout-trg: 0
[2023-07-23 00:36:10] [config] dump-config: ""
[2023-07-23 00:36:10] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] early-stopping: 200
[2023-07-23 00:36:10] [config] early-stopping-on: first
[2023-07-23 00:36:10] [config] embedding-fix-src: false
[2023-07-23 00:36:10] [config] embedding-fix-trg: false
[2023-07-23 00:36:10] [config] embedding-normalization: false
[2023-07-23 00:36:10] [config] embedding-vectors:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] enc-cell: tanh
[2023-07-23 00:36:10] [config] enc-cell-depth: 1
[2023-07-23 00:36:10] [config] enc-depth: 1
[2023-07-23 00:36:10] [config] enc-type: bidirectional
[2023-07-23 00:36:10] [config] english-title-case-every: 0
[2023-07-23 00:36:10] [config] exponential-smoothing: 0
[2023-07-23 00:36:10] [config] factor-weight: 1
[2023-07-23 00:36:10] [config] factors-combine: sum
[2023-07-23 00:36:10] [config] factors-dim-emb: 0
[2023-07-23 00:36:10] [config] gradient-checkpointing: false
[2023-07-23 00:36:10] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:10] [config] guided-alignment: none
[2023-07-23 00:36:10] [config] guided-alignment-cost: mse
[2023-07-23 00:36:10] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:10] [config] ignore-model-config: false
[2023-07-23 00:36:10] [config] input-types:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] interpolate-env-vars: false
[2023-07-23 00:36:10] [config] keep-best: false
[2023-07-23 00:36:10] [config] label-smoothing: 0
[2023-07-23 00:36:10] [config] layer-normalization: false
[2023-07-23 00:36:10] [config] learn-rate: 0.0001
[2023-07-23 00:36:10] [config] lemma-dependency: ""
[2023-07-23 00:36:10] [config] lemma-dim-emb: 0
[2023-07-23 00:36:10] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:10] [config] log-level: info
[2023-07-23 00:36:10] [config] log-time-zone: ""
[2023-07-23 00:36:10] [config] logical-epoch:
[2023-07-23 00:36:10] [config]   - 1e
[2023-07-23 00:36:10] [config]   - 0
[2023-07-23 00:36:10] [config] lr-decay: 0
[2023-07-23 00:36:10] [config] lr-decay-freq: 50000
[2023-07-23 00:36:10] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:10] [config]   - 0
[2023-07-23 00:36:10] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:10] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:10] [config] lr-decay-start:
[2023-07-23 00:36:10] [config]   - 10
[2023-07-23 00:36:10] [config]   - 1
[2023-07-23 00:36:10] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:10] [config] lr-report: false
[2023-07-23 00:36:10] [config] lr-warmup: 0
[2023-07-23 00:36:10] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:10] [config] lr-warmup-cycle: false
[2023-07-23 00:36:10] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:10] [config] max-length: 50
[2023-07-23 00:36:10] [config] max-length-crop: true
[2023-07-23 00:36:10] [config] max-length-factor: 3
[2023-07-23 00:36:10] [config] maxi-batch: 100
[2023-07-23 00:36:10] [config] maxi-batch-sort: trg
[2023-07-23 00:36:10] [config] mini-batch: 64
[2023-07-23 00:36:10] [config] mini-batch-fit: true
[2023-07-23 00:36:10] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:10] [config] mini-batch-round-up: true
[2023-07-23 00:36:10] [config] mini-batch-track-lr: false
[2023-07-23 00:36:10] [config] mini-batch-warmup: 0
[2023-07-23 00:36:10] [config] mini-batch-words: 0
[2023-07-23 00:36:10] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:10] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:10] [config] multi-loss-type: sum
[2023-07-23 00:36:10] [config] n-best: false
[2023-07-23 00:36:10] [config] no-nccl: false
[2023-07-23 00:36:10] [config] no-reload: false
[2023-07-23 00:36:10] [config] no-restore-corpus: false
[2023-07-23 00:36:10] [config] normalize: 0
[2023-07-23 00:36:10] [config] normalize-gradient: false
[2023-07-23 00:36:10] [config] num-devices: 0
[2023-07-23 00:36:10] [config] optimizer: adam
[2023-07-23 00:36:10] [config] optimizer-delay: 1
[2023-07-23 00:36:10] [config] optimizer-params:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] output-omit-bias: false
[2023-07-23 00:36:10] [config] overwrite: true
[2023-07-23 00:36:10] [config] precision:
[2023-07-23 00:36:10] [config]   - float16
[2023-07-23 00:36:10] [config]   - float32
[2023-07-23 00:36:10] [config] pretrained-model: ""
[2023-07-23 00:36:10] [config] quantize-biases: false
[2023-07-23 00:36:10] [config] quantize-bits: 0
[2023-07-23 00:36:10] [config] quantize-log-based: false
[2023-07-23 00:36:10] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:10] [config] quiet: false
[2023-07-23 00:36:10] [config] quiet-translation: true
[2023-07-23 00:36:10] [config] relative-paths: false
[2023-07-23 00:36:10] [config] right-left: false
[2023-07-23 00:36:10] [config] save-freq: 10000u
[2023-07-23 00:36:10] [config] seed: 1234
[2023-07-23 00:36:10] [config] sentencepiece-alphas:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:10] [config] sentencepiece-options: ""
[2023-07-23 00:36:10] [config] sharding: global
[2023-07-23 00:36:10] [config] shuffle: data
[2023-07-23 00:36:10] [config] shuffle-in-ram: false
[2023-07-23 00:36:10] [config] sigterm: save-and-exit
[2023-07-23 00:36:10] [config] skip: false
[2023-07-23 00:36:10] [config] sqlite: ""
[2023-07-23 00:36:10] [config] sqlite-drop: false
[2023-07-23 00:36:10] [config] sync-freq: 200u
[2023-07-23 00:36:10] [config] sync-sgd: false
[2023-07-23 00:36:10] [config] tempdir: /tmp
[2023-07-23 00:36:10] [config] tied-embeddings: false
[2023-07-23 00:36:10] [config] tied-embeddings-all: true
[2023-07-23 00:36:10] [config] tied-embeddings-src: false
[2023-07-23 00:36:10] [config] train-embedder-rank:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] train-sets:
[2023-07-23 00:36:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:10] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:10] [config] transformer-aan-activation: swish
[2023-07-23 00:36:10] [config] transformer-aan-depth: 2
[2023-07-23 00:36:10] [config] transformer-aan-nogate: false
[2023-07-23 00:36:10] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:10] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:10] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:10] [config] transformer-depth-scaling: false
[2023-07-23 00:36:10] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:10] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:10] [config] transformer-dropout: 0
[2023-07-23 00:36:10] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:10] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:10] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:10] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:10] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:10] [config] transformer-heads: 8
[2023-07-23 00:36:10] [config] transformer-no-projection: false
[2023-07-23 00:36:10] [config] transformer-pool: false
[2023-07-23 00:36:10] [config] transformer-postprocess: dan
[2023-07-23 00:36:10] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:10] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:10] [config] transformer-preprocess: ""
[2023-07-23 00:36:10] [config] transformer-tied-layers:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:10] [config] tsv: false
[2023-07-23 00:36:10] [config] tsv-fields: 0
[2023-07-23 00:36:10] [config] type: amun
[2023-07-23 00:36:10] [config] ulr: false
[2023-07-23 00:36:10] [config] ulr-dim-emb: 0
[2023-07-23 00:36:10] [config] ulr-dropout: 0
[2023-07-23 00:36:10] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:10] [config] ulr-query-vectors: ""
[2023-07-23 00:36:10] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:10] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:10] [config] unlikelihood-loss: false
[2023-07-23 00:36:10] [config] valid-freq: 50000000
[2023-07-23 00:36:10] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:10] [config] valid-max-length: 1000
[2023-07-23 00:36:10] [config] valid-metrics:
[2023-07-23 00:36:10] [config]   - cross-entropy
[2023-07-23 00:36:10] [config]   - translation
[2023-07-23 00:36:10] [config] valid-mini-batch: 32
[2023-07-23 00:36:10] [config] valid-reset-stalled: false
[2023-07-23 00:36:10] [config] valid-script-args:
[2023-07-23 00:36:10] [config]   []
[2023-07-23 00:36:10] [config] valid-script-path: ""
[2023-07-23 00:36:10] [config] valid-sets:
[2023-07-23 00:36:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:10] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:10] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:10] [config] vocabs:
[2023-07-23 00:36:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:10] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:10] [config] word-penalty: 0
[2023-07-23 00:36:10] [config] word-scores: false
[2023-07-23 00:36:10] [config] workspace: 5500
[2023-07-23 00:36:10] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:10] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:10] [training] Using single-device training
[2023-07-23 00:36:11] Synced seed 1234
[2023-07-23 00:36:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:11] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:11] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:11] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:11] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:11] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:11] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:12] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:12] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:12] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x561e69618692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x561e69559da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x561e6955e1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x561e695652ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x561e69711a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x561e69712a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x561e696ebbee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x561e691ed108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x561e6910f2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x561e690c6b9c]    main                                               + 0x3c
[0x7f18eb1cf0b3]    __libc_start_main                                  + 0xf3
[0x561e6910dcbe]    _start                                             + 0x2e

[2023-07-23 00:36:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:16] [marian] Running on node23.datos.cluster.uy as process 7256 with command line:
[2023-07-23 00:36:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:16] [config] after: 0e
[2023-07-23 00:36:16] [config] after-batches: 0
[2023-07-23 00:36:16] [config] after-epochs: 50
[2023-07-23 00:36:16] [config] all-caps-every: 0
[2023-07-23 00:36:16] [config] allow-unk: false
[2023-07-23 00:36:16] [config] authors: false
[2023-07-23 00:36:16] [config] beam-size: 12
[2023-07-23 00:36:16] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:16] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:16] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:16] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:16] [config] build-info: ""
[2023-07-23 00:36:16] [config] check-gradient-nan: false
[2023-07-23 00:36:16] [config] check-nan: false
[2023-07-23 00:36:16] [config] cite: false
[2023-07-23 00:36:16] [config] clip-norm: 1
[2023-07-23 00:36:16] [config] cost-scaling:
[2023-07-23 00:36:16] [config]   - 256.f
[2023-07-23 00:36:16] [config]   - 1000
[2023-07-23 00:36:16] [config]   - 2.f
[2023-07-23 00:36:16] [config]   - 256.f
[2023-07-23 00:36:16] [config] cost-type: ce-sum
[2023-07-23 00:36:16] [config] cpu-threads: 0
[2023-07-23 00:36:16] [config] data-threads: 8
[2023-07-23 00:36:16] [config] data-weighting: ""
[2023-07-23 00:36:16] [config] data-weighting-type: sentence
[2023-07-23 00:36:16] [config] dec-cell: gru
[2023-07-23 00:36:16] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:16] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:16] [config] dec-depth: 1
[2023-07-23 00:36:16] [config] devices:
[2023-07-23 00:36:16] [config]   - 0
[2023-07-23 00:36:16] [config] dim-emb: 512
[2023-07-23 00:36:16] [config] dim-rnn: 1024
[2023-07-23 00:36:16] [config] dim-vocabs:
[2023-07-23 00:36:16] [config]   - 16384
[2023-07-23 00:36:16] [config]   - 16384
[2023-07-23 00:36:16] [config] disp-first: 0
[2023-07-23 00:36:16] [config] disp-freq: 1000u
[2023-07-23 00:36:16] [config] disp-label-counts: true
[2023-07-23 00:36:16] [config] dropout-rnn: 0
[2023-07-23 00:36:16] [config] dropout-src: 0
[2023-07-23 00:36:16] [config] dropout-trg: 0
[2023-07-23 00:36:16] [config] dump-config: ""
[2023-07-23 00:36:16] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] early-stopping: 200
[2023-07-23 00:36:16] [config] early-stopping-on: first
[2023-07-23 00:36:16] [config] embedding-fix-src: false
[2023-07-23 00:36:16] [config] embedding-fix-trg: false
[2023-07-23 00:36:16] [config] embedding-normalization: false
[2023-07-23 00:36:16] [config] embedding-vectors:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] enc-cell: tanh
[2023-07-23 00:36:16] [config] enc-cell-depth: 1
[2023-07-23 00:36:16] [config] enc-depth: 1
[2023-07-23 00:36:16] [config] enc-type: bidirectional
[2023-07-23 00:36:16] [config] english-title-case-every: 0
[2023-07-23 00:36:16] [config] exponential-smoothing: 0
[2023-07-23 00:36:16] [config] factor-weight: 1
[2023-07-23 00:36:16] [config] factors-combine: sum
[2023-07-23 00:36:16] [config] factors-dim-emb: 0
[2023-07-23 00:36:16] [config] gradient-checkpointing: false
[2023-07-23 00:36:16] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:16] [config] guided-alignment: none
[2023-07-23 00:36:16] [config] guided-alignment-cost: mse
[2023-07-23 00:36:16] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:16] [config] ignore-model-config: false
[2023-07-23 00:36:16] [config] input-types:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] interpolate-env-vars: false
[2023-07-23 00:36:16] [config] keep-best: false
[2023-07-23 00:36:16] [config] label-smoothing: 0
[2023-07-23 00:36:16] [config] layer-normalization: false
[2023-07-23 00:36:16] [config] learn-rate: 0.0001
[2023-07-23 00:36:16] [config] lemma-dependency: ""
[2023-07-23 00:36:16] [config] lemma-dim-emb: 0
[2023-07-23 00:36:16] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:16] [config] log-level: info
[2023-07-23 00:36:16] [config] log-time-zone: ""
[2023-07-23 00:36:16] [config] logical-epoch:
[2023-07-23 00:36:16] [config]   - 1e
[2023-07-23 00:36:16] [config]   - 0
[2023-07-23 00:36:16] [config] lr-decay: 0
[2023-07-23 00:36:16] [config] lr-decay-freq: 50000
[2023-07-23 00:36:16] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:16] [config]   - 0
[2023-07-23 00:36:16] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:16] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:16] [config] lr-decay-start:
[2023-07-23 00:36:16] [config]   - 10
[2023-07-23 00:36:16] [config]   - 1
[2023-07-23 00:36:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:16] [config] lr-report: false
[2023-07-23 00:36:16] [config] lr-warmup: 0
[2023-07-23 00:36:16] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:16] [config] lr-warmup-cycle: false
[2023-07-23 00:36:16] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:16] [config] max-length: 50
[2023-07-23 00:36:16] [config] max-length-crop: true
[2023-07-23 00:36:16] [config] max-length-factor: 3
[2023-07-23 00:36:16] [config] maxi-batch: 100
[2023-07-23 00:36:16] [config] maxi-batch-sort: trg
[2023-07-23 00:36:16] [config] mini-batch: 64
[2023-07-23 00:36:16] [config] mini-batch-fit: true
[2023-07-23 00:36:16] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:16] [config] mini-batch-round-up: true
[2023-07-23 00:36:16] [config] mini-batch-track-lr: false
[2023-07-23 00:36:16] [config] mini-batch-warmup: 0
[2023-07-23 00:36:16] [config] mini-batch-words: 0
[2023-07-23 00:36:16] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:16] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:16] [config] multi-loss-type: sum
[2023-07-23 00:36:16] [config] n-best: false
[2023-07-23 00:36:16] [config] no-nccl: false
[2023-07-23 00:36:16] [config] no-reload: false
[2023-07-23 00:36:16] [config] no-restore-corpus: false
[2023-07-23 00:36:16] [config] normalize: 0
[2023-07-23 00:36:16] [config] normalize-gradient: false
[2023-07-23 00:36:16] [config] num-devices: 0
[2023-07-23 00:36:16] [config] optimizer: adam
[2023-07-23 00:36:16] [config] optimizer-delay: 1
[2023-07-23 00:36:16] [config] optimizer-params:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] output-omit-bias: false
[2023-07-23 00:36:16] [config] overwrite: true
[2023-07-23 00:36:16] [config] precision:
[2023-07-23 00:36:16] [config]   - float16
[2023-07-23 00:36:16] [config]   - float32
[2023-07-23 00:36:16] [config] pretrained-model: ""
[2023-07-23 00:36:16] [config] quantize-biases: false
[2023-07-23 00:36:16] [config] quantize-bits: 0
[2023-07-23 00:36:16] [config] quantize-log-based: false
[2023-07-23 00:36:16] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:16] [config] quiet: false
[2023-07-23 00:36:16] [config] quiet-translation: true
[2023-07-23 00:36:16] [config] relative-paths: false
[2023-07-23 00:36:16] [config] right-left: false
[2023-07-23 00:36:16] [config] save-freq: 10000u
[2023-07-23 00:36:16] [config] seed: 1234
[2023-07-23 00:36:16] [config] sentencepiece-alphas:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:16] [config] sentencepiece-options: ""
[2023-07-23 00:36:16] [config] sharding: global
[2023-07-23 00:36:16] [config] shuffle: data
[2023-07-23 00:36:16] [config] shuffle-in-ram: false
[2023-07-23 00:36:16] [config] sigterm: save-and-exit
[2023-07-23 00:36:16] [config] skip: false
[2023-07-23 00:36:16] [config] sqlite: ""
[2023-07-23 00:36:16] [config] sqlite-drop: false
[2023-07-23 00:36:16] [config] sync-freq: 200u
[2023-07-23 00:36:16] [config] sync-sgd: false
[2023-07-23 00:36:16] [config] tempdir: /tmp
[2023-07-23 00:36:16] [config] tied-embeddings: false
[2023-07-23 00:36:16] [config] tied-embeddings-all: true
[2023-07-23 00:36:16] [config] tied-embeddings-src: false
[2023-07-23 00:36:16] [config] train-embedder-rank:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] train-sets:
[2023-07-23 00:36:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:16] [config] transformer-aan-activation: swish
[2023-07-23 00:36:16] [config] transformer-aan-depth: 2
[2023-07-23 00:36:16] [config] transformer-aan-nogate: false
[2023-07-23 00:36:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:16] [config] transformer-depth-scaling: false
[2023-07-23 00:36:16] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:16] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:16] [config] transformer-dropout: 0
[2023-07-23 00:36:16] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:16] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:16] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:16] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:16] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:16] [config] transformer-heads: 8
[2023-07-23 00:36:16] [config] transformer-no-projection: false
[2023-07-23 00:36:16] [config] transformer-pool: false
[2023-07-23 00:36:16] [config] transformer-postprocess: dan
[2023-07-23 00:36:16] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:16] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:16] [config] transformer-preprocess: ""
[2023-07-23 00:36:16] [config] transformer-tied-layers:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:16] [config] tsv: false
[2023-07-23 00:36:16] [config] tsv-fields: 0
[2023-07-23 00:36:16] [config] type: amun
[2023-07-23 00:36:16] [config] ulr: false
[2023-07-23 00:36:16] [config] ulr-dim-emb: 0
[2023-07-23 00:36:16] [config] ulr-dropout: 0
[2023-07-23 00:36:16] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:16] [config] ulr-query-vectors: ""
[2023-07-23 00:36:16] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:16] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:16] [config] unlikelihood-loss: false
[2023-07-23 00:36:16] [config] valid-freq: 50000000
[2023-07-23 00:36:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:16] [config] valid-max-length: 1000
[2023-07-23 00:36:16] [config] valid-metrics:
[2023-07-23 00:36:16] [config]   - cross-entropy
[2023-07-23 00:36:16] [config]   - translation
[2023-07-23 00:36:16] [config] valid-mini-batch: 32
[2023-07-23 00:36:16] [config] valid-reset-stalled: false
[2023-07-23 00:36:16] [config] valid-script-args:
[2023-07-23 00:36:16] [config]   []
[2023-07-23 00:36:16] [config] valid-script-path: ""
[2023-07-23 00:36:16] [config] valid-sets:
[2023-07-23 00:36:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:16] [config] vocabs:
[2023-07-23 00:36:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:16] [config] word-penalty: 0
[2023-07-23 00:36:16] [config] word-scores: false
[2023-07-23 00:36:16] [config] workspace: 5500
[2023-07-23 00:36:16] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:16] [training] Using single-device training
[2023-07-23 00:36:17] Synced seed 1234
[2023-07-23 00:36:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:17] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:17] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:18] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:18] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55e263deb692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55e263d2cda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55e263d311a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55e263d382ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55e263ee4a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55e263ee5a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55e263ebebee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55e2639c0108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55e2638e22c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55e263899b9c]    main                                               + 0x3c
[0x7fdf902640b3]    __libc_start_main                                  + 0xf3
[0x55e2638e0cbe]    _start                                             + 0x2e

[2023-07-23 00:36:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:21] [marian] Running on node23.datos.cluster.uy as process 7299 with command line:
[2023-07-23 00:36:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:21] [config] after: 0e
[2023-07-23 00:36:21] [config] after-batches: 0
[2023-07-23 00:36:21] [config] after-epochs: 60
[2023-07-23 00:36:21] [config] all-caps-every: 0
[2023-07-23 00:36:21] [config] allow-unk: false
[2023-07-23 00:36:21] [config] authors: false
[2023-07-23 00:36:21] [config] beam-size: 12
[2023-07-23 00:36:21] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:21] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:21] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:21] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:21] [config] build-info: ""
[2023-07-23 00:36:21] [config] check-gradient-nan: false
[2023-07-23 00:36:21] [config] check-nan: false
[2023-07-23 00:36:21] [config] cite: false
[2023-07-23 00:36:21] [config] clip-norm: 1
[2023-07-23 00:36:21] [config] cost-scaling:
[2023-07-23 00:36:21] [config]   - 256.f
[2023-07-23 00:36:21] [config]   - 1000
[2023-07-23 00:36:21] [config]   - 2.f
[2023-07-23 00:36:21] [config]   - 256.f
[2023-07-23 00:36:21] [config] cost-type: ce-sum
[2023-07-23 00:36:21] [config] cpu-threads: 0
[2023-07-23 00:36:21] [config] data-threads: 8
[2023-07-23 00:36:21] [config] data-weighting: ""
[2023-07-23 00:36:21] [config] data-weighting-type: sentence
[2023-07-23 00:36:21] [config] dec-cell: gru
[2023-07-23 00:36:21] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:21] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:21] [config] dec-depth: 1
[2023-07-23 00:36:21] [config] devices:
[2023-07-23 00:36:21] [config]   - 0
[2023-07-23 00:36:21] [config] dim-emb: 512
[2023-07-23 00:36:21] [config] dim-rnn: 1024
[2023-07-23 00:36:21] [config] dim-vocabs:
[2023-07-23 00:36:21] [config]   - 16384
[2023-07-23 00:36:21] [config]   - 16384
[2023-07-23 00:36:21] [config] disp-first: 0
[2023-07-23 00:36:21] [config] disp-freq: 1000u
[2023-07-23 00:36:21] [config] disp-label-counts: true
[2023-07-23 00:36:21] [config] dropout-rnn: 0
[2023-07-23 00:36:21] [config] dropout-src: 0
[2023-07-23 00:36:21] [config] dropout-trg: 0
[2023-07-23 00:36:21] [config] dump-config: ""
[2023-07-23 00:36:21] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] early-stopping: 200
[2023-07-23 00:36:21] [config] early-stopping-on: first
[2023-07-23 00:36:21] [config] embedding-fix-src: false
[2023-07-23 00:36:21] [config] embedding-fix-trg: false
[2023-07-23 00:36:21] [config] embedding-normalization: false
[2023-07-23 00:36:21] [config] embedding-vectors:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] enc-cell: tanh
[2023-07-23 00:36:21] [config] enc-cell-depth: 1
[2023-07-23 00:36:21] [config] enc-depth: 1
[2023-07-23 00:36:21] [config] enc-type: bidirectional
[2023-07-23 00:36:21] [config] english-title-case-every: 0
[2023-07-23 00:36:21] [config] exponential-smoothing: 0
[2023-07-23 00:36:21] [config] factor-weight: 1
[2023-07-23 00:36:21] [config] factors-combine: sum
[2023-07-23 00:36:21] [config] factors-dim-emb: 0
[2023-07-23 00:36:21] [config] gradient-checkpointing: false
[2023-07-23 00:36:21] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:21] [config] guided-alignment: none
[2023-07-23 00:36:21] [config] guided-alignment-cost: mse
[2023-07-23 00:36:21] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:21] [config] ignore-model-config: false
[2023-07-23 00:36:21] [config] input-types:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] interpolate-env-vars: false
[2023-07-23 00:36:21] [config] keep-best: false
[2023-07-23 00:36:21] [config] label-smoothing: 0
[2023-07-23 00:36:21] [config] layer-normalization: false
[2023-07-23 00:36:21] [config] learn-rate: 0.0001
[2023-07-23 00:36:21] [config] lemma-dependency: ""
[2023-07-23 00:36:21] [config] lemma-dim-emb: 0
[2023-07-23 00:36:21] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:21] [config] log-level: info
[2023-07-23 00:36:21] [config] log-time-zone: ""
[2023-07-23 00:36:21] [config] logical-epoch:
[2023-07-23 00:36:21] [config]   - 1e
[2023-07-23 00:36:21] [config]   - 0
[2023-07-23 00:36:21] [config] lr-decay: 0
[2023-07-23 00:36:21] [config] lr-decay-freq: 50000
[2023-07-23 00:36:21] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:21] [config]   - 0
[2023-07-23 00:36:21] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:21] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:21] [config] lr-decay-start:
[2023-07-23 00:36:21] [config]   - 10
[2023-07-23 00:36:21] [config]   - 1
[2023-07-23 00:36:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:21] [config] lr-report: false
[2023-07-23 00:36:21] [config] lr-warmup: 0
[2023-07-23 00:36:21] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:21] [config] lr-warmup-cycle: false
[2023-07-23 00:36:21] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:21] [config] max-length: 50
[2023-07-23 00:36:21] [config] max-length-crop: true
[2023-07-23 00:36:21] [config] max-length-factor: 3
[2023-07-23 00:36:21] [config] maxi-batch: 100
[2023-07-23 00:36:21] [config] maxi-batch-sort: trg
[2023-07-23 00:36:21] [config] mini-batch: 64
[2023-07-23 00:36:21] [config] mini-batch-fit: true
[2023-07-23 00:36:21] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:21] [config] mini-batch-round-up: true
[2023-07-23 00:36:21] [config] mini-batch-track-lr: false
[2023-07-23 00:36:21] [config] mini-batch-warmup: 0
[2023-07-23 00:36:21] [config] mini-batch-words: 0
[2023-07-23 00:36:21] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:21] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:21] [config] multi-loss-type: sum
[2023-07-23 00:36:21] [config] n-best: false
[2023-07-23 00:36:21] [config] no-nccl: false
[2023-07-23 00:36:21] [config] no-reload: false
[2023-07-23 00:36:21] [config] no-restore-corpus: false
[2023-07-23 00:36:21] [config] normalize: 0
[2023-07-23 00:36:21] [config] normalize-gradient: false
[2023-07-23 00:36:21] [config] num-devices: 0
[2023-07-23 00:36:21] [config] optimizer: adam
[2023-07-23 00:36:21] [config] optimizer-delay: 1
[2023-07-23 00:36:21] [config] optimizer-params:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] output-omit-bias: false
[2023-07-23 00:36:21] [config] overwrite: true
[2023-07-23 00:36:21] [config] precision:
[2023-07-23 00:36:21] [config]   - float16
[2023-07-23 00:36:21] [config]   - float32
[2023-07-23 00:36:21] [config] pretrained-model: ""
[2023-07-23 00:36:21] [config] quantize-biases: false
[2023-07-23 00:36:21] [config] quantize-bits: 0
[2023-07-23 00:36:21] [config] quantize-log-based: false
[2023-07-23 00:36:21] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:21] [config] quiet: false
[2023-07-23 00:36:21] [config] quiet-translation: true
[2023-07-23 00:36:21] [config] relative-paths: false
[2023-07-23 00:36:21] [config] right-left: false
[2023-07-23 00:36:21] [config] save-freq: 10000u
[2023-07-23 00:36:21] [config] seed: 1234
[2023-07-23 00:36:21] [config] sentencepiece-alphas:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:21] [config] sentencepiece-options: ""
[2023-07-23 00:36:21] [config] sharding: global
[2023-07-23 00:36:21] [config] shuffle: data
[2023-07-23 00:36:21] [config] shuffle-in-ram: false
[2023-07-23 00:36:21] [config] sigterm: save-and-exit
[2023-07-23 00:36:21] [config] skip: false
[2023-07-23 00:36:21] [config] sqlite: ""
[2023-07-23 00:36:21] [config] sqlite-drop: false
[2023-07-23 00:36:21] [config] sync-freq: 200u
[2023-07-23 00:36:21] [config] sync-sgd: false
[2023-07-23 00:36:21] [config] tempdir: /tmp
[2023-07-23 00:36:21] [config] tied-embeddings: false
[2023-07-23 00:36:21] [config] tied-embeddings-all: true
[2023-07-23 00:36:21] [config] tied-embeddings-src: false
[2023-07-23 00:36:21] [config] train-embedder-rank:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] train-sets:
[2023-07-23 00:36:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:21] [config] transformer-aan-activation: swish
[2023-07-23 00:36:21] [config] transformer-aan-depth: 2
[2023-07-23 00:36:21] [config] transformer-aan-nogate: false
[2023-07-23 00:36:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:21] [config] transformer-depth-scaling: false
[2023-07-23 00:36:21] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:21] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:21] [config] transformer-dropout: 0
[2023-07-23 00:36:21] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:21] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:21] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:21] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:21] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:21] [config] transformer-heads: 8
[2023-07-23 00:36:21] [config] transformer-no-projection: false
[2023-07-23 00:36:21] [config] transformer-pool: false
[2023-07-23 00:36:21] [config] transformer-postprocess: dan
[2023-07-23 00:36:21] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:21] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:21] [config] transformer-preprocess: ""
[2023-07-23 00:36:21] [config] transformer-tied-layers:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:21] [config] tsv: false
[2023-07-23 00:36:21] [config] tsv-fields: 0
[2023-07-23 00:36:21] [config] type: amun
[2023-07-23 00:36:21] [config] ulr: false
[2023-07-23 00:36:21] [config] ulr-dim-emb: 0
[2023-07-23 00:36:21] [config] ulr-dropout: 0
[2023-07-23 00:36:21] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:21] [config] ulr-query-vectors: ""
[2023-07-23 00:36:21] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:21] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:21] [config] unlikelihood-loss: false
[2023-07-23 00:36:21] [config] valid-freq: 50000000
[2023-07-23 00:36:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:21] [config] valid-max-length: 1000
[2023-07-23 00:36:21] [config] valid-metrics:
[2023-07-23 00:36:21] [config]   - cross-entropy
[2023-07-23 00:36:21] [config]   - translation
[2023-07-23 00:36:21] [config] valid-mini-batch: 32
[2023-07-23 00:36:21] [config] valid-reset-stalled: false
[2023-07-23 00:36:21] [config] valid-script-args:
[2023-07-23 00:36:21] [config]   []
[2023-07-23 00:36:21] [config] valid-script-path: ""
[2023-07-23 00:36:21] [config] valid-sets:
[2023-07-23 00:36:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:21] [config] vocabs:
[2023-07-23 00:36:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:21] [config] word-penalty: 0
[2023-07-23 00:36:21] [config] word-scores: false
[2023-07-23 00:36:21] [config] workspace: 5500
[2023-07-23 00:36:21] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:21] [training] Using single-device training
[2023-07-23 00:36:21] Synced seed 1234
[2023-07-23 00:36:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:23] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:23] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55b767c8b692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55b767bccda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55b767bd11a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55b767bd82ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55b767d84a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55b767d85a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55b767d5ebee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55b767860108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55b7677822c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b767739b9c]    main                                               + 0x3c
[0x7fab9a77a0b3]    __libc_start_main                                  + 0xf3
[0x55b767780cbe]    _start                                             + 0x2e

[2023-07-23 00:36:26] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:26] [marian] Running on node23.datos.cluster.uy as process 7334 with command line:
[2023-07-23 00:36:26] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:26] [config] after: 0e
[2023-07-23 00:36:26] [config] after-batches: 0
[2023-07-23 00:36:26] [config] after-epochs: 70
[2023-07-23 00:36:26] [config] all-caps-every: 0
[2023-07-23 00:36:26] [config] allow-unk: false
[2023-07-23 00:36:26] [config] authors: false
[2023-07-23 00:36:26] [config] beam-size: 12
[2023-07-23 00:36:26] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:26] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:26] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:26] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:26] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:26] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:26] [config] build-info: ""
[2023-07-23 00:36:26] [config] check-gradient-nan: false
[2023-07-23 00:36:26] [config] check-nan: false
[2023-07-23 00:36:26] [config] cite: false
[2023-07-23 00:36:26] [config] clip-norm: 1
[2023-07-23 00:36:26] [config] cost-scaling:
[2023-07-23 00:36:26] [config]   - 256.f
[2023-07-23 00:36:26] [config]   - 1000
[2023-07-23 00:36:26] [config]   - 2.f
[2023-07-23 00:36:26] [config]   - 256.f
[2023-07-23 00:36:26] [config] cost-type: ce-sum
[2023-07-23 00:36:26] [config] cpu-threads: 0
[2023-07-23 00:36:26] [config] data-threads: 8
[2023-07-23 00:36:26] [config] data-weighting: ""
[2023-07-23 00:36:26] [config] data-weighting-type: sentence
[2023-07-23 00:36:26] [config] dec-cell: gru
[2023-07-23 00:36:26] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:26] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:26] [config] dec-depth: 1
[2023-07-23 00:36:26] [config] devices:
[2023-07-23 00:36:26] [config]   - 0
[2023-07-23 00:36:26] [config] dim-emb: 512
[2023-07-23 00:36:26] [config] dim-rnn: 1024
[2023-07-23 00:36:26] [config] dim-vocabs:
[2023-07-23 00:36:26] [config]   - 16384
[2023-07-23 00:36:26] [config]   - 16384
[2023-07-23 00:36:26] [config] disp-first: 0
[2023-07-23 00:36:26] [config] disp-freq: 1000u
[2023-07-23 00:36:26] [config] disp-label-counts: true
[2023-07-23 00:36:26] [config] dropout-rnn: 0
[2023-07-23 00:36:26] [config] dropout-src: 0
[2023-07-23 00:36:26] [config] dropout-trg: 0
[2023-07-23 00:36:26] [config] dump-config: ""
[2023-07-23 00:36:26] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] early-stopping: 200
[2023-07-23 00:36:26] [config] early-stopping-on: first
[2023-07-23 00:36:26] [config] embedding-fix-src: false
[2023-07-23 00:36:26] [config] embedding-fix-trg: false
[2023-07-23 00:36:26] [config] embedding-normalization: false
[2023-07-23 00:36:26] [config] embedding-vectors:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] enc-cell: tanh
[2023-07-23 00:36:26] [config] enc-cell-depth: 1
[2023-07-23 00:36:26] [config] enc-depth: 1
[2023-07-23 00:36:26] [config] enc-type: bidirectional
[2023-07-23 00:36:26] [config] english-title-case-every: 0
[2023-07-23 00:36:26] [config] exponential-smoothing: 0
[2023-07-23 00:36:26] [config] factor-weight: 1
[2023-07-23 00:36:26] [config] factors-combine: sum
[2023-07-23 00:36:26] [config] factors-dim-emb: 0
[2023-07-23 00:36:26] [config] gradient-checkpointing: false
[2023-07-23 00:36:26] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:26] [config] guided-alignment: none
[2023-07-23 00:36:26] [config] guided-alignment-cost: mse
[2023-07-23 00:36:26] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:26] [config] ignore-model-config: false
[2023-07-23 00:36:26] [config] input-types:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] interpolate-env-vars: false
[2023-07-23 00:36:26] [config] keep-best: false
[2023-07-23 00:36:26] [config] label-smoothing: 0
[2023-07-23 00:36:26] [config] layer-normalization: false
[2023-07-23 00:36:26] [config] learn-rate: 0.0001
[2023-07-23 00:36:26] [config] lemma-dependency: ""
[2023-07-23 00:36:26] [config] lemma-dim-emb: 0
[2023-07-23 00:36:26] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:26] [config] log-level: info
[2023-07-23 00:36:26] [config] log-time-zone: ""
[2023-07-23 00:36:26] [config] logical-epoch:
[2023-07-23 00:36:26] [config]   - 1e
[2023-07-23 00:36:26] [config]   - 0
[2023-07-23 00:36:26] [config] lr-decay: 0
[2023-07-23 00:36:26] [config] lr-decay-freq: 50000
[2023-07-23 00:36:26] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:26] [config]   - 0
[2023-07-23 00:36:26] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:26] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:26] [config] lr-decay-start:
[2023-07-23 00:36:26] [config]   - 10
[2023-07-23 00:36:26] [config]   - 1
[2023-07-23 00:36:26] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:26] [config] lr-report: false
[2023-07-23 00:36:26] [config] lr-warmup: 0
[2023-07-23 00:36:26] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:26] [config] lr-warmup-cycle: false
[2023-07-23 00:36:26] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:26] [config] max-length: 50
[2023-07-23 00:36:26] [config] max-length-crop: true
[2023-07-23 00:36:26] [config] max-length-factor: 3
[2023-07-23 00:36:26] [config] maxi-batch: 100
[2023-07-23 00:36:26] [config] maxi-batch-sort: trg
[2023-07-23 00:36:26] [config] mini-batch: 64
[2023-07-23 00:36:26] [config] mini-batch-fit: true
[2023-07-23 00:36:26] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:26] [config] mini-batch-round-up: true
[2023-07-23 00:36:26] [config] mini-batch-track-lr: false
[2023-07-23 00:36:26] [config] mini-batch-warmup: 0
[2023-07-23 00:36:26] [config] mini-batch-words: 0
[2023-07-23 00:36:26] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:26] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:26] [config] multi-loss-type: sum
[2023-07-23 00:36:26] [config] n-best: false
[2023-07-23 00:36:26] [config] no-nccl: false
[2023-07-23 00:36:26] [config] no-reload: false
[2023-07-23 00:36:26] [config] no-restore-corpus: false
[2023-07-23 00:36:26] [config] normalize: 0
[2023-07-23 00:36:26] [config] normalize-gradient: false
[2023-07-23 00:36:26] [config] num-devices: 0
[2023-07-23 00:36:26] [config] optimizer: adam
[2023-07-23 00:36:26] [config] optimizer-delay: 1
[2023-07-23 00:36:26] [config] optimizer-params:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] output-omit-bias: false
[2023-07-23 00:36:26] [config] overwrite: true
[2023-07-23 00:36:26] [config] precision:
[2023-07-23 00:36:26] [config]   - float16
[2023-07-23 00:36:26] [config]   - float32
[2023-07-23 00:36:26] [config] pretrained-model: ""
[2023-07-23 00:36:26] [config] quantize-biases: false
[2023-07-23 00:36:26] [config] quantize-bits: 0
[2023-07-23 00:36:26] [config] quantize-log-based: false
[2023-07-23 00:36:26] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:26] [config] quiet: false
[2023-07-23 00:36:26] [config] quiet-translation: true
[2023-07-23 00:36:26] [config] relative-paths: false
[2023-07-23 00:36:26] [config] right-left: false
[2023-07-23 00:36:26] [config] save-freq: 10000u
[2023-07-23 00:36:26] [config] seed: 1234
[2023-07-23 00:36:26] [config] sentencepiece-alphas:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:26] [config] sentencepiece-options: ""
[2023-07-23 00:36:26] [config] sharding: global
[2023-07-23 00:36:26] [config] shuffle: data
[2023-07-23 00:36:26] [config] shuffle-in-ram: false
[2023-07-23 00:36:26] [config] sigterm: save-and-exit
[2023-07-23 00:36:26] [config] skip: false
[2023-07-23 00:36:26] [config] sqlite: ""
[2023-07-23 00:36:26] [config] sqlite-drop: false
[2023-07-23 00:36:26] [config] sync-freq: 200u
[2023-07-23 00:36:26] [config] sync-sgd: false
[2023-07-23 00:36:26] [config] tempdir: /tmp
[2023-07-23 00:36:26] [config] tied-embeddings: false
[2023-07-23 00:36:26] [config] tied-embeddings-all: true
[2023-07-23 00:36:26] [config] tied-embeddings-src: false
[2023-07-23 00:36:26] [config] train-embedder-rank:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] train-sets:
[2023-07-23 00:36:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:26] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:26] [config] transformer-aan-activation: swish
[2023-07-23 00:36:26] [config] transformer-aan-depth: 2
[2023-07-23 00:36:26] [config] transformer-aan-nogate: false
[2023-07-23 00:36:26] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:26] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:26] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:26] [config] transformer-depth-scaling: false
[2023-07-23 00:36:26] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:26] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:26] [config] transformer-dropout: 0
[2023-07-23 00:36:26] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:26] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:26] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:26] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:26] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:26] [config] transformer-heads: 8
[2023-07-23 00:36:26] [config] transformer-no-projection: false
[2023-07-23 00:36:26] [config] transformer-pool: false
[2023-07-23 00:36:26] [config] transformer-postprocess: dan
[2023-07-23 00:36:26] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:26] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:26] [config] transformer-preprocess: ""
[2023-07-23 00:36:26] [config] transformer-tied-layers:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:26] [config] tsv: false
[2023-07-23 00:36:26] [config] tsv-fields: 0
[2023-07-23 00:36:26] [config] type: amun
[2023-07-23 00:36:26] [config] ulr: false
[2023-07-23 00:36:26] [config] ulr-dim-emb: 0
[2023-07-23 00:36:26] [config] ulr-dropout: 0
[2023-07-23 00:36:26] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:26] [config] ulr-query-vectors: ""
[2023-07-23 00:36:26] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:26] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:26] [config] unlikelihood-loss: false
[2023-07-23 00:36:26] [config] valid-freq: 50000000
[2023-07-23 00:36:26] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:26] [config] valid-max-length: 1000
[2023-07-23 00:36:26] [config] valid-metrics:
[2023-07-23 00:36:26] [config]   - cross-entropy
[2023-07-23 00:36:26] [config]   - translation
[2023-07-23 00:36:26] [config] valid-mini-batch: 32
[2023-07-23 00:36:26] [config] valid-reset-stalled: false
[2023-07-23 00:36:26] [config] valid-script-args:
[2023-07-23 00:36:26] [config]   []
[2023-07-23 00:36:26] [config] valid-script-path: ""
[2023-07-23 00:36:26] [config] valid-sets:
[2023-07-23 00:36:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:26] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:26] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:26] [config] vocabs:
[2023-07-23 00:36:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:26] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:26] [config] word-penalty: 0
[2023-07-23 00:36:26] [config] word-scores: false
[2023-07-23 00:36:26] [config] workspace: 5500
[2023-07-23 00:36:26] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:26] [training] Using single-device training
[2023-07-23 00:36:26] Synced seed 1234
[2023-07-23 00:36:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:26] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:26] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:28] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:28] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x557401622692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x557401563da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5574015681a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55740156f2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55740171ba0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55740171ca53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5574016f5bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5574011f7108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5574011192c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5574010d0b9c]    main                                               + 0x3c
[0x7f0cab4d20b3]    __libc_start_main                                  + 0xf3
[0x557401117cbe]    _start                                             + 0x2e

[2023-07-23 00:36:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:31] [marian] Running on node23.datos.cluster.uy as process 7364 with command line:
[2023-07-23 00:36:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:31] [config] after: 0e
[2023-07-23 00:36:31] [config] after-batches: 0
[2023-07-23 00:36:31] [config] after-epochs: 80
[2023-07-23 00:36:31] [config] all-caps-every: 0
[2023-07-23 00:36:31] [config] allow-unk: false
[2023-07-23 00:36:31] [config] authors: false
[2023-07-23 00:36:31] [config] beam-size: 12
[2023-07-23 00:36:31] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:31] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:31] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:31] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:31] [config] build-info: ""
[2023-07-23 00:36:31] [config] check-gradient-nan: false
[2023-07-23 00:36:31] [config] check-nan: false
[2023-07-23 00:36:31] [config] cite: false
[2023-07-23 00:36:31] [config] clip-norm: 1
[2023-07-23 00:36:31] [config] cost-scaling:
[2023-07-23 00:36:31] [config]   - 256.f
[2023-07-23 00:36:31] [config]   - 1000
[2023-07-23 00:36:31] [config]   - 2.f
[2023-07-23 00:36:31] [config]   - 256.f
[2023-07-23 00:36:31] [config] cost-type: ce-sum
[2023-07-23 00:36:31] [config] cpu-threads: 0
[2023-07-23 00:36:31] [config] data-threads: 8
[2023-07-23 00:36:31] [config] data-weighting: ""
[2023-07-23 00:36:31] [config] data-weighting-type: sentence
[2023-07-23 00:36:31] [config] dec-cell: gru
[2023-07-23 00:36:31] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:31] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:31] [config] dec-depth: 1
[2023-07-23 00:36:31] [config] devices:
[2023-07-23 00:36:31] [config]   - 0
[2023-07-23 00:36:31] [config] dim-emb: 512
[2023-07-23 00:36:31] [config] dim-rnn: 1024
[2023-07-23 00:36:31] [config] dim-vocabs:
[2023-07-23 00:36:31] [config]   - 16384
[2023-07-23 00:36:31] [config]   - 16384
[2023-07-23 00:36:31] [config] disp-first: 0
[2023-07-23 00:36:31] [config] disp-freq: 1000u
[2023-07-23 00:36:31] [config] disp-label-counts: true
[2023-07-23 00:36:31] [config] dropout-rnn: 0
[2023-07-23 00:36:31] [config] dropout-src: 0
[2023-07-23 00:36:31] [config] dropout-trg: 0
[2023-07-23 00:36:31] [config] dump-config: ""
[2023-07-23 00:36:31] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] early-stopping: 200
[2023-07-23 00:36:31] [config] early-stopping-on: first
[2023-07-23 00:36:31] [config] embedding-fix-src: false
[2023-07-23 00:36:31] [config] embedding-fix-trg: false
[2023-07-23 00:36:31] [config] embedding-normalization: false
[2023-07-23 00:36:31] [config] embedding-vectors:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] enc-cell: tanh
[2023-07-23 00:36:31] [config] enc-cell-depth: 1
[2023-07-23 00:36:31] [config] enc-depth: 1
[2023-07-23 00:36:31] [config] enc-type: bidirectional
[2023-07-23 00:36:31] [config] english-title-case-every: 0
[2023-07-23 00:36:31] [config] exponential-smoothing: 0
[2023-07-23 00:36:31] [config] factor-weight: 1
[2023-07-23 00:36:31] [config] factors-combine: sum
[2023-07-23 00:36:31] [config] factors-dim-emb: 0
[2023-07-23 00:36:31] [config] gradient-checkpointing: false
[2023-07-23 00:36:31] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:31] [config] guided-alignment: none
[2023-07-23 00:36:31] [config] guided-alignment-cost: mse
[2023-07-23 00:36:31] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:31] [config] ignore-model-config: false
[2023-07-23 00:36:31] [config] input-types:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] interpolate-env-vars: false
[2023-07-23 00:36:31] [config] keep-best: false
[2023-07-23 00:36:31] [config] label-smoothing: 0
[2023-07-23 00:36:31] [config] layer-normalization: false
[2023-07-23 00:36:31] [config] learn-rate: 0.0001
[2023-07-23 00:36:31] [config] lemma-dependency: ""
[2023-07-23 00:36:31] [config] lemma-dim-emb: 0
[2023-07-23 00:36:31] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:31] [config] log-level: info
[2023-07-23 00:36:31] [config] log-time-zone: ""
[2023-07-23 00:36:31] [config] logical-epoch:
[2023-07-23 00:36:31] [config]   - 1e
[2023-07-23 00:36:31] [config]   - 0
[2023-07-23 00:36:31] [config] lr-decay: 0
[2023-07-23 00:36:31] [config] lr-decay-freq: 50000
[2023-07-23 00:36:31] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:31] [config]   - 0
[2023-07-23 00:36:31] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:31] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:31] [config] lr-decay-start:
[2023-07-23 00:36:31] [config]   - 10
[2023-07-23 00:36:31] [config]   - 1
[2023-07-23 00:36:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:31] [config] lr-report: false
[2023-07-23 00:36:31] [config] lr-warmup: 0
[2023-07-23 00:36:31] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:31] [config] lr-warmup-cycle: false
[2023-07-23 00:36:31] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:31] [config] max-length: 50
[2023-07-23 00:36:31] [config] max-length-crop: true
[2023-07-23 00:36:31] [config] max-length-factor: 3
[2023-07-23 00:36:31] [config] maxi-batch: 100
[2023-07-23 00:36:31] [config] maxi-batch-sort: trg
[2023-07-23 00:36:31] [config] mini-batch: 64
[2023-07-23 00:36:31] [config] mini-batch-fit: true
[2023-07-23 00:36:31] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:31] [config] mini-batch-round-up: true
[2023-07-23 00:36:31] [config] mini-batch-track-lr: false
[2023-07-23 00:36:31] [config] mini-batch-warmup: 0
[2023-07-23 00:36:31] [config] mini-batch-words: 0
[2023-07-23 00:36:31] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:31] [config] multi-loss-type: sum
[2023-07-23 00:36:31] [config] n-best: false
[2023-07-23 00:36:31] [config] no-nccl: false
[2023-07-23 00:36:31] [config] no-reload: false
[2023-07-23 00:36:31] [config] no-restore-corpus: false
[2023-07-23 00:36:31] [config] normalize: 0
[2023-07-23 00:36:31] [config] normalize-gradient: false
[2023-07-23 00:36:31] [config] num-devices: 0
[2023-07-23 00:36:31] [config] optimizer: adam
[2023-07-23 00:36:31] [config] optimizer-delay: 1
[2023-07-23 00:36:31] [config] optimizer-params:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] output-omit-bias: false
[2023-07-23 00:36:31] [config] overwrite: true
[2023-07-23 00:36:31] [config] precision:
[2023-07-23 00:36:31] [config]   - float16
[2023-07-23 00:36:31] [config]   - float32
[2023-07-23 00:36:31] [config] pretrained-model: ""
[2023-07-23 00:36:31] [config] quantize-biases: false
[2023-07-23 00:36:31] [config] quantize-bits: 0
[2023-07-23 00:36:31] [config] quantize-log-based: false
[2023-07-23 00:36:31] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:31] [config] quiet: false
[2023-07-23 00:36:31] [config] quiet-translation: true
[2023-07-23 00:36:31] [config] relative-paths: false
[2023-07-23 00:36:31] [config] right-left: false
[2023-07-23 00:36:31] [config] save-freq: 10000u
[2023-07-23 00:36:31] [config] seed: 1234
[2023-07-23 00:36:31] [config] sentencepiece-alphas:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:31] [config] sentencepiece-options: ""
[2023-07-23 00:36:31] [config] sharding: global
[2023-07-23 00:36:31] [config] shuffle: data
[2023-07-23 00:36:31] [config] shuffle-in-ram: false
[2023-07-23 00:36:31] [config] sigterm: save-and-exit
[2023-07-23 00:36:31] [config] skip: false
[2023-07-23 00:36:31] [config] sqlite: ""
[2023-07-23 00:36:31] [config] sqlite-drop: false
[2023-07-23 00:36:31] [config] sync-freq: 200u
[2023-07-23 00:36:31] [config] sync-sgd: false
[2023-07-23 00:36:31] [config] tempdir: /tmp
[2023-07-23 00:36:31] [config] tied-embeddings: false
[2023-07-23 00:36:31] [config] tied-embeddings-all: true
[2023-07-23 00:36:31] [config] tied-embeddings-src: false
[2023-07-23 00:36:31] [config] train-embedder-rank:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] train-sets:
[2023-07-23 00:36:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:31] [config] transformer-aan-activation: swish
[2023-07-23 00:36:31] [config] transformer-aan-depth: 2
[2023-07-23 00:36:31] [config] transformer-aan-nogate: false
[2023-07-23 00:36:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:31] [config] transformer-depth-scaling: false
[2023-07-23 00:36:31] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:31] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:31] [config] transformer-dropout: 0
[2023-07-23 00:36:31] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:31] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:31] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:31] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:31] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:31] [config] transformer-heads: 8
[2023-07-23 00:36:31] [config] transformer-no-projection: false
[2023-07-23 00:36:31] [config] transformer-pool: false
[2023-07-23 00:36:31] [config] transformer-postprocess: dan
[2023-07-23 00:36:31] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:31] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:31] [config] transformer-preprocess: ""
[2023-07-23 00:36:31] [config] transformer-tied-layers:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:31] [config] tsv: false
[2023-07-23 00:36:31] [config] tsv-fields: 0
[2023-07-23 00:36:31] [config] type: amun
[2023-07-23 00:36:31] [config] ulr: false
[2023-07-23 00:36:31] [config] ulr-dim-emb: 0
[2023-07-23 00:36:31] [config] ulr-dropout: 0
[2023-07-23 00:36:31] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:31] [config] ulr-query-vectors: ""
[2023-07-23 00:36:31] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:31] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:31] [config] unlikelihood-loss: false
[2023-07-23 00:36:31] [config] valid-freq: 50000000
[2023-07-23 00:36:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:31] [config] valid-max-length: 1000
[2023-07-23 00:36:31] [config] valid-metrics:
[2023-07-23 00:36:31] [config]   - cross-entropy
[2023-07-23 00:36:31] [config]   - translation
[2023-07-23 00:36:31] [config] valid-mini-batch: 32
[2023-07-23 00:36:31] [config] valid-reset-stalled: false
[2023-07-23 00:36:31] [config] valid-script-args:
[2023-07-23 00:36:31] [config]   []
[2023-07-23 00:36:31] [config] valid-script-path: ""
[2023-07-23 00:36:31] [config] valid-sets:
[2023-07-23 00:36:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:31] [config] vocabs:
[2023-07-23 00:36:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:31] [config] word-penalty: 0
[2023-07-23 00:36:31] [config] word-scores: false
[2023-07-23 00:36:31] [config] workspace: 5500
[2023-07-23 00:36:31] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:31] [training] Using single-device training
[2023-07-23 00:36:31] Synced seed 1234
[2023-07-23 00:36:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:31] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:33] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:33] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:33] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x5571a41f2692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x5571a4133da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5571a41381a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5571a413f2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5571a42eba0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5571a42eca53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5571a42c5bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5571a3dc7108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5571a3ce92c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5571a3ca0b9c]    main                                               + 0x3c
[0x7f2dcb55c0b3]    __libc_start_main                                  + 0xf3
[0x5571a3ce7cbe]    _start                                             + 0x2e

[2023-07-23 00:36:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:37] [marian] Running on node23.datos.cluster.uy as process 7392 with command line:
[2023-07-23 00:36:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:37] [config] after: 0e
[2023-07-23 00:36:37] [config] after-batches: 0
[2023-07-23 00:36:37] [config] after-epochs: 90
[2023-07-23 00:36:37] [config] all-caps-every: 0
[2023-07-23 00:36:37] [config] allow-unk: false
[2023-07-23 00:36:37] [config] authors: false
[2023-07-23 00:36:37] [config] beam-size: 12
[2023-07-23 00:36:37] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:37] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:37] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:37] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:37] [config] build-info: ""
[2023-07-23 00:36:37] [config] check-gradient-nan: false
[2023-07-23 00:36:37] [config] check-nan: false
[2023-07-23 00:36:37] [config] cite: false
[2023-07-23 00:36:37] [config] clip-norm: 1
[2023-07-23 00:36:37] [config] cost-scaling:
[2023-07-23 00:36:37] [config]   - 256.f
[2023-07-23 00:36:37] [config]   - 1000
[2023-07-23 00:36:37] [config]   - 2.f
[2023-07-23 00:36:37] [config]   - 256.f
[2023-07-23 00:36:37] [config] cost-type: ce-sum
[2023-07-23 00:36:37] [config] cpu-threads: 0
[2023-07-23 00:36:37] [config] data-threads: 8
[2023-07-23 00:36:37] [config] data-weighting: ""
[2023-07-23 00:36:37] [config] data-weighting-type: sentence
[2023-07-23 00:36:37] [config] dec-cell: gru
[2023-07-23 00:36:37] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:37] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:37] [config] dec-depth: 1
[2023-07-23 00:36:37] [config] devices:
[2023-07-23 00:36:37] [config]   - 0
[2023-07-23 00:36:37] [config] dim-emb: 512
[2023-07-23 00:36:37] [config] dim-rnn: 1024
[2023-07-23 00:36:37] [config] dim-vocabs:
[2023-07-23 00:36:37] [config]   - 16384
[2023-07-23 00:36:37] [config]   - 16384
[2023-07-23 00:36:37] [config] disp-first: 0
[2023-07-23 00:36:37] [config] disp-freq: 1000u
[2023-07-23 00:36:37] [config] disp-label-counts: true
[2023-07-23 00:36:37] [config] dropout-rnn: 0
[2023-07-23 00:36:37] [config] dropout-src: 0
[2023-07-23 00:36:37] [config] dropout-trg: 0
[2023-07-23 00:36:37] [config] dump-config: ""
[2023-07-23 00:36:37] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] early-stopping: 200
[2023-07-23 00:36:37] [config] early-stopping-on: first
[2023-07-23 00:36:37] [config] embedding-fix-src: false
[2023-07-23 00:36:37] [config] embedding-fix-trg: false
[2023-07-23 00:36:37] [config] embedding-normalization: false
[2023-07-23 00:36:37] [config] embedding-vectors:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] enc-cell: tanh
[2023-07-23 00:36:37] [config] enc-cell-depth: 1
[2023-07-23 00:36:37] [config] enc-depth: 1
[2023-07-23 00:36:37] [config] enc-type: bidirectional
[2023-07-23 00:36:37] [config] english-title-case-every: 0
[2023-07-23 00:36:37] [config] exponential-smoothing: 0
[2023-07-23 00:36:37] [config] factor-weight: 1
[2023-07-23 00:36:37] [config] factors-combine: sum
[2023-07-23 00:36:37] [config] factors-dim-emb: 0
[2023-07-23 00:36:37] [config] gradient-checkpointing: false
[2023-07-23 00:36:37] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:37] [config] guided-alignment: none
[2023-07-23 00:36:37] [config] guided-alignment-cost: mse
[2023-07-23 00:36:37] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:37] [config] ignore-model-config: false
[2023-07-23 00:36:37] [config] input-types:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] interpolate-env-vars: false
[2023-07-23 00:36:37] [config] keep-best: false
[2023-07-23 00:36:37] [config] label-smoothing: 0
[2023-07-23 00:36:37] [config] layer-normalization: false
[2023-07-23 00:36:37] [config] learn-rate: 0.0001
[2023-07-23 00:36:37] [config] lemma-dependency: ""
[2023-07-23 00:36:37] [config] lemma-dim-emb: 0
[2023-07-23 00:36:37] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:37] [config] log-level: info
[2023-07-23 00:36:37] [config] log-time-zone: ""
[2023-07-23 00:36:37] [config] logical-epoch:
[2023-07-23 00:36:37] [config]   - 1e
[2023-07-23 00:36:37] [config]   - 0
[2023-07-23 00:36:37] [config] lr-decay: 0
[2023-07-23 00:36:37] [config] lr-decay-freq: 50000
[2023-07-23 00:36:37] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:37] [config]   - 0
[2023-07-23 00:36:37] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:37] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:37] [config] lr-decay-start:
[2023-07-23 00:36:37] [config]   - 10
[2023-07-23 00:36:37] [config]   - 1
[2023-07-23 00:36:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:37] [config] lr-report: false
[2023-07-23 00:36:37] [config] lr-warmup: 0
[2023-07-23 00:36:37] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:37] [config] lr-warmup-cycle: false
[2023-07-23 00:36:37] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:37] [config] max-length: 50
[2023-07-23 00:36:37] [config] max-length-crop: true
[2023-07-23 00:36:37] [config] max-length-factor: 3
[2023-07-23 00:36:37] [config] maxi-batch: 100
[2023-07-23 00:36:37] [config] maxi-batch-sort: trg
[2023-07-23 00:36:37] [config] mini-batch: 64
[2023-07-23 00:36:37] [config] mini-batch-fit: true
[2023-07-23 00:36:37] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:37] [config] mini-batch-round-up: true
[2023-07-23 00:36:37] [config] mini-batch-track-lr: false
[2023-07-23 00:36:37] [config] mini-batch-warmup: 0
[2023-07-23 00:36:37] [config] mini-batch-words: 0
[2023-07-23 00:36:37] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:37] [config] multi-loss-type: sum
[2023-07-23 00:36:37] [config] n-best: false
[2023-07-23 00:36:37] [config] no-nccl: false
[2023-07-23 00:36:37] [config] no-reload: false
[2023-07-23 00:36:37] [config] no-restore-corpus: false
[2023-07-23 00:36:37] [config] normalize: 0
[2023-07-23 00:36:37] [config] normalize-gradient: false
[2023-07-23 00:36:37] [config] num-devices: 0
[2023-07-23 00:36:37] [config] optimizer: adam
[2023-07-23 00:36:37] [config] optimizer-delay: 1
[2023-07-23 00:36:37] [config] optimizer-params:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] output-omit-bias: false
[2023-07-23 00:36:37] [config] overwrite: true
[2023-07-23 00:36:37] [config] precision:
[2023-07-23 00:36:37] [config]   - float16
[2023-07-23 00:36:37] [config]   - float32
[2023-07-23 00:36:37] [config] pretrained-model: ""
[2023-07-23 00:36:37] [config] quantize-biases: false
[2023-07-23 00:36:37] [config] quantize-bits: 0
[2023-07-23 00:36:37] [config] quantize-log-based: false
[2023-07-23 00:36:37] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:37] [config] quiet: false
[2023-07-23 00:36:37] [config] quiet-translation: true
[2023-07-23 00:36:37] [config] relative-paths: false
[2023-07-23 00:36:37] [config] right-left: false
[2023-07-23 00:36:37] [config] save-freq: 10000u
[2023-07-23 00:36:37] [config] seed: 1234
[2023-07-23 00:36:37] [config] sentencepiece-alphas:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:37] [config] sentencepiece-options: ""
[2023-07-23 00:36:37] [config] sharding: global
[2023-07-23 00:36:37] [config] shuffle: data
[2023-07-23 00:36:37] [config] shuffle-in-ram: false
[2023-07-23 00:36:37] [config] sigterm: save-and-exit
[2023-07-23 00:36:37] [config] skip: false
[2023-07-23 00:36:37] [config] sqlite: ""
[2023-07-23 00:36:37] [config] sqlite-drop: false
[2023-07-23 00:36:37] [config] sync-freq: 200u
[2023-07-23 00:36:37] [config] sync-sgd: false
[2023-07-23 00:36:37] [config] tempdir: /tmp
[2023-07-23 00:36:37] [config] tied-embeddings: false
[2023-07-23 00:36:37] [config] tied-embeddings-all: true
[2023-07-23 00:36:37] [config] tied-embeddings-src: false
[2023-07-23 00:36:37] [config] train-embedder-rank:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] train-sets:
[2023-07-23 00:36:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:37] [config] transformer-aan-activation: swish
[2023-07-23 00:36:37] [config] transformer-aan-depth: 2
[2023-07-23 00:36:37] [config] transformer-aan-nogate: false
[2023-07-23 00:36:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:37] [config] transformer-depth-scaling: false
[2023-07-23 00:36:37] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:37] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:37] [config] transformer-dropout: 0
[2023-07-23 00:36:37] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:37] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:37] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:37] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:37] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:37] [config] transformer-heads: 8
[2023-07-23 00:36:37] [config] transformer-no-projection: false
[2023-07-23 00:36:37] [config] transformer-pool: false
[2023-07-23 00:36:37] [config] transformer-postprocess: dan
[2023-07-23 00:36:37] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:37] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:37] [config] transformer-preprocess: ""
[2023-07-23 00:36:37] [config] transformer-tied-layers:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:37] [config] tsv: false
[2023-07-23 00:36:37] [config] tsv-fields: 0
[2023-07-23 00:36:37] [config] type: amun
[2023-07-23 00:36:37] [config] ulr: false
[2023-07-23 00:36:37] [config] ulr-dim-emb: 0
[2023-07-23 00:36:37] [config] ulr-dropout: 0
[2023-07-23 00:36:37] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:37] [config] ulr-query-vectors: ""
[2023-07-23 00:36:37] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:37] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:37] [config] unlikelihood-loss: false
[2023-07-23 00:36:37] [config] valid-freq: 50000000
[2023-07-23 00:36:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:37] [config] valid-max-length: 1000
[2023-07-23 00:36:37] [config] valid-metrics:
[2023-07-23 00:36:37] [config]   - cross-entropy
[2023-07-23 00:36:37] [config]   - translation
[2023-07-23 00:36:37] [config] valid-mini-batch: 32
[2023-07-23 00:36:37] [config] valid-reset-stalled: false
[2023-07-23 00:36:37] [config] valid-script-args:
[2023-07-23 00:36:37] [config]   []
[2023-07-23 00:36:37] [config] valid-script-path: ""
[2023-07-23 00:36:37] [config] valid-sets:
[2023-07-23 00:36:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:37] [config] vocabs:
[2023-07-23 00:36:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:37] [config] word-penalty: 0
[2023-07-23 00:36:37] [config] word-scores: false
[2023-07-23 00:36:37] [config] workspace: 5500
[2023-07-23 00:36:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:37] [training] Using single-device training
[2023-07-23 00:36:37] Synced seed 1234
[2023-07-23 00:36:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:37] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:37] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:37] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:37] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:37] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:39] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:39] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55b41a272692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55b41a1b3da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55b41a1b81a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55b41a1bf2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55b41a36ba0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55b41a36ca53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55b41a345bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55b419e47108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55b419d692c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55b419d20b9c]    main                                               + 0x3c
[0x7f95adb900b3]    __libc_start_main                                  + 0xf3
[0x55b419d67cbe]    _start                                             + 0x2e

[2023-07-23 00:36:42] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:42] [marian] Running on node23.datos.cluster.uy as process 7419 with command line:
[2023-07-23 00:36:42] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:42] [config] after: 0e
[2023-07-23 00:36:42] [config] after-batches: 0
[2023-07-23 00:36:42] [config] after-epochs: 100
[2023-07-23 00:36:42] [config] all-caps-every: 0
[2023-07-23 00:36:42] [config] allow-unk: false
[2023-07-23 00:36:42] [config] authors: false
[2023-07-23 00:36:42] [config] beam-size: 12
[2023-07-23 00:36:42] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:42] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:42] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:42] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:42] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:42] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:42] [config] build-info: ""
[2023-07-23 00:36:42] [config] check-gradient-nan: false
[2023-07-23 00:36:42] [config] check-nan: false
[2023-07-23 00:36:42] [config] cite: false
[2023-07-23 00:36:42] [config] clip-norm: 1
[2023-07-23 00:36:42] [config] cost-scaling:
[2023-07-23 00:36:42] [config]   - 256.f
[2023-07-23 00:36:42] [config]   - 1000
[2023-07-23 00:36:42] [config]   - 2.f
[2023-07-23 00:36:42] [config]   - 256.f
[2023-07-23 00:36:42] [config] cost-type: ce-sum
[2023-07-23 00:36:42] [config] cpu-threads: 0
[2023-07-23 00:36:42] [config] data-threads: 8
[2023-07-23 00:36:42] [config] data-weighting: ""
[2023-07-23 00:36:42] [config] data-weighting-type: sentence
[2023-07-23 00:36:42] [config] dec-cell: gru
[2023-07-23 00:36:42] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:42] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:42] [config] dec-depth: 1
[2023-07-23 00:36:42] [config] devices:
[2023-07-23 00:36:42] [config]   - 0
[2023-07-23 00:36:42] [config] dim-emb: 512
[2023-07-23 00:36:42] [config] dim-rnn: 1024
[2023-07-23 00:36:42] [config] dim-vocabs:
[2023-07-23 00:36:42] [config]   - 16384
[2023-07-23 00:36:42] [config]   - 16384
[2023-07-23 00:36:42] [config] disp-first: 0
[2023-07-23 00:36:42] [config] disp-freq: 1000u
[2023-07-23 00:36:42] [config] disp-label-counts: true
[2023-07-23 00:36:42] [config] dropout-rnn: 0
[2023-07-23 00:36:42] [config] dropout-src: 0
[2023-07-23 00:36:42] [config] dropout-trg: 0
[2023-07-23 00:36:42] [config] dump-config: ""
[2023-07-23 00:36:42] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] early-stopping: 200
[2023-07-23 00:36:42] [config] early-stopping-on: first
[2023-07-23 00:36:42] [config] embedding-fix-src: false
[2023-07-23 00:36:42] [config] embedding-fix-trg: false
[2023-07-23 00:36:42] [config] embedding-normalization: false
[2023-07-23 00:36:42] [config] embedding-vectors:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] enc-cell: tanh
[2023-07-23 00:36:42] [config] enc-cell-depth: 1
[2023-07-23 00:36:42] [config] enc-depth: 1
[2023-07-23 00:36:42] [config] enc-type: bidirectional
[2023-07-23 00:36:42] [config] english-title-case-every: 0
[2023-07-23 00:36:42] [config] exponential-smoothing: 0
[2023-07-23 00:36:42] [config] factor-weight: 1
[2023-07-23 00:36:42] [config] factors-combine: sum
[2023-07-23 00:36:42] [config] factors-dim-emb: 0
[2023-07-23 00:36:42] [config] gradient-checkpointing: false
[2023-07-23 00:36:42] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:42] [config] guided-alignment: none
[2023-07-23 00:36:42] [config] guided-alignment-cost: mse
[2023-07-23 00:36:42] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:42] [config] ignore-model-config: false
[2023-07-23 00:36:42] [config] input-types:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] interpolate-env-vars: false
[2023-07-23 00:36:42] [config] keep-best: false
[2023-07-23 00:36:42] [config] label-smoothing: 0
[2023-07-23 00:36:42] [config] layer-normalization: false
[2023-07-23 00:36:42] [config] learn-rate: 0.0001
[2023-07-23 00:36:42] [config] lemma-dependency: ""
[2023-07-23 00:36:42] [config] lemma-dim-emb: 0
[2023-07-23 00:36:42] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:42] [config] log-level: info
[2023-07-23 00:36:42] [config] log-time-zone: ""
[2023-07-23 00:36:42] [config] logical-epoch:
[2023-07-23 00:36:42] [config]   - 1e
[2023-07-23 00:36:42] [config]   - 0
[2023-07-23 00:36:42] [config] lr-decay: 0
[2023-07-23 00:36:42] [config] lr-decay-freq: 50000
[2023-07-23 00:36:42] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:42] [config]   - 0
[2023-07-23 00:36:42] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:42] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:42] [config] lr-decay-start:
[2023-07-23 00:36:42] [config]   - 10
[2023-07-23 00:36:42] [config]   - 1
[2023-07-23 00:36:42] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:42] [config] lr-report: false
[2023-07-23 00:36:42] [config] lr-warmup: 0
[2023-07-23 00:36:42] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:42] [config] lr-warmup-cycle: false
[2023-07-23 00:36:42] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:42] [config] max-length: 50
[2023-07-23 00:36:42] [config] max-length-crop: true
[2023-07-23 00:36:42] [config] max-length-factor: 3
[2023-07-23 00:36:42] [config] maxi-batch: 100
[2023-07-23 00:36:42] [config] maxi-batch-sort: trg
[2023-07-23 00:36:42] [config] mini-batch: 64
[2023-07-23 00:36:42] [config] mini-batch-fit: true
[2023-07-23 00:36:42] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:42] [config] mini-batch-round-up: true
[2023-07-23 00:36:42] [config] mini-batch-track-lr: false
[2023-07-23 00:36:42] [config] mini-batch-warmup: 0
[2023-07-23 00:36:42] [config] mini-batch-words: 0
[2023-07-23 00:36:42] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:42] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:42] [config] multi-loss-type: sum
[2023-07-23 00:36:42] [config] n-best: false
[2023-07-23 00:36:42] [config] no-nccl: false
[2023-07-23 00:36:42] [config] no-reload: false
[2023-07-23 00:36:42] [config] no-restore-corpus: false
[2023-07-23 00:36:42] [config] normalize: 0
[2023-07-23 00:36:42] [config] normalize-gradient: false
[2023-07-23 00:36:42] [config] num-devices: 0
[2023-07-23 00:36:42] [config] optimizer: adam
[2023-07-23 00:36:42] [config] optimizer-delay: 1
[2023-07-23 00:36:42] [config] optimizer-params:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] output-omit-bias: false
[2023-07-23 00:36:42] [config] overwrite: true
[2023-07-23 00:36:42] [config] precision:
[2023-07-23 00:36:42] [config]   - float16
[2023-07-23 00:36:42] [config]   - float32
[2023-07-23 00:36:42] [config] pretrained-model: ""
[2023-07-23 00:36:42] [config] quantize-biases: false
[2023-07-23 00:36:42] [config] quantize-bits: 0
[2023-07-23 00:36:42] [config] quantize-log-based: false
[2023-07-23 00:36:42] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:42] [config] quiet: false
[2023-07-23 00:36:42] [config] quiet-translation: true
[2023-07-23 00:36:42] [config] relative-paths: false
[2023-07-23 00:36:42] [config] right-left: false
[2023-07-23 00:36:42] [config] save-freq: 10000u
[2023-07-23 00:36:42] [config] seed: 1234
[2023-07-23 00:36:42] [config] sentencepiece-alphas:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:42] [config] sentencepiece-options: ""
[2023-07-23 00:36:42] [config] sharding: global
[2023-07-23 00:36:42] [config] shuffle: data
[2023-07-23 00:36:42] [config] shuffle-in-ram: false
[2023-07-23 00:36:42] [config] sigterm: save-and-exit
[2023-07-23 00:36:42] [config] skip: false
[2023-07-23 00:36:42] [config] sqlite: ""
[2023-07-23 00:36:42] [config] sqlite-drop: false
[2023-07-23 00:36:42] [config] sync-freq: 200u
[2023-07-23 00:36:42] [config] sync-sgd: false
[2023-07-23 00:36:42] [config] tempdir: /tmp
[2023-07-23 00:36:42] [config] tied-embeddings: false
[2023-07-23 00:36:42] [config] tied-embeddings-all: true
[2023-07-23 00:36:42] [config] tied-embeddings-src: false
[2023-07-23 00:36:42] [config] train-embedder-rank:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] train-sets:
[2023-07-23 00:36:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:42] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:42] [config] transformer-aan-activation: swish
[2023-07-23 00:36:42] [config] transformer-aan-depth: 2
[2023-07-23 00:36:42] [config] transformer-aan-nogate: false
[2023-07-23 00:36:42] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:42] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:42] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:42] [config] transformer-depth-scaling: false
[2023-07-23 00:36:42] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:42] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:42] [config] transformer-dropout: 0
[2023-07-23 00:36:42] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:42] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:42] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:42] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:42] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:42] [config] transformer-heads: 8
[2023-07-23 00:36:42] [config] transformer-no-projection: false
[2023-07-23 00:36:42] [config] transformer-pool: false
[2023-07-23 00:36:42] [config] transformer-postprocess: dan
[2023-07-23 00:36:42] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:42] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:42] [config] transformer-preprocess: ""
[2023-07-23 00:36:42] [config] transformer-tied-layers:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:42] [config] tsv: false
[2023-07-23 00:36:42] [config] tsv-fields: 0
[2023-07-23 00:36:42] [config] type: amun
[2023-07-23 00:36:42] [config] ulr: false
[2023-07-23 00:36:42] [config] ulr-dim-emb: 0
[2023-07-23 00:36:42] [config] ulr-dropout: 0
[2023-07-23 00:36:42] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:42] [config] ulr-query-vectors: ""
[2023-07-23 00:36:42] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:42] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:42] [config] unlikelihood-loss: false
[2023-07-23 00:36:42] [config] valid-freq: 50000000
[2023-07-23 00:36:42] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:42] [config] valid-max-length: 1000
[2023-07-23 00:36:42] [config] valid-metrics:
[2023-07-23 00:36:42] [config]   - cross-entropy
[2023-07-23 00:36:42] [config]   - translation
[2023-07-23 00:36:42] [config] valid-mini-batch: 32
[2023-07-23 00:36:42] [config] valid-reset-stalled: false
[2023-07-23 00:36:42] [config] valid-script-args:
[2023-07-23 00:36:42] [config]   []
[2023-07-23 00:36:42] [config] valid-script-path: ""
[2023-07-23 00:36:42] [config] valid-sets:
[2023-07-23 00:36:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:42] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:42] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:42] [config] vocabs:
[2023-07-23 00:36:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:42] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:42] [config] word-penalty: 0
[2023-07-23 00:36:42] [config] word-scores: false
[2023-07-23 00:36:42] [config] workspace: 5500
[2023-07-23 00:36:42] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:42] [training] Using single-device training
[2023-07-23 00:36:42] Synced seed 1234
[2023-07-23 00:36:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:43] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:43] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55a7e38c6692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55a7e3807da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55a7e380c1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55a7e38132ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55a7e39bfa0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55a7e39c0a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55a7e3999bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55a7e349b108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55a7e33bd2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a7e3374b9c]    main                                               + 0x3c
[0x7f44b9df70b3]    __libc_start_main                                  + 0xf3
[0x55a7e33bbcbe]    _start                                             + 0x2e

[2023-07-23 00:36:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:47] [marian] Running on node23.datos.cluster.uy as process 7448 with command line:
[2023-07-23 00:36:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:47] [config] after: 0e
[2023-07-23 00:36:47] [config] after-batches: 0
[2023-07-23 00:36:47] [config] after-epochs: 110
[2023-07-23 00:36:47] [config] all-caps-every: 0
[2023-07-23 00:36:47] [config] allow-unk: false
[2023-07-23 00:36:47] [config] authors: false
[2023-07-23 00:36:47] [config] beam-size: 12
[2023-07-23 00:36:47] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:47] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:47] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:47] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:47] [config] build-info: ""
[2023-07-23 00:36:47] [config] check-gradient-nan: false
[2023-07-23 00:36:47] [config] check-nan: false
[2023-07-23 00:36:47] [config] cite: false
[2023-07-23 00:36:47] [config] clip-norm: 1
[2023-07-23 00:36:47] [config] cost-scaling:
[2023-07-23 00:36:47] [config]   - 256.f
[2023-07-23 00:36:47] [config]   - 1000
[2023-07-23 00:36:47] [config]   - 2.f
[2023-07-23 00:36:47] [config]   - 256.f
[2023-07-23 00:36:47] [config] cost-type: ce-sum
[2023-07-23 00:36:47] [config] cpu-threads: 0
[2023-07-23 00:36:47] [config] data-threads: 8
[2023-07-23 00:36:47] [config] data-weighting: ""
[2023-07-23 00:36:47] [config] data-weighting-type: sentence
[2023-07-23 00:36:47] [config] dec-cell: gru
[2023-07-23 00:36:47] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:47] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:47] [config] dec-depth: 1
[2023-07-23 00:36:47] [config] devices:
[2023-07-23 00:36:47] [config]   - 0
[2023-07-23 00:36:47] [config] dim-emb: 512
[2023-07-23 00:36:47] [config] dim-rnn: 1024
[2023-07-23 00:36:47] [config] dim-vocabs:
[2023-07-23 00:36:47] [config]   - 16384
[2023-07-23 00:36:47] [config]   - 16384
[2023-07-23 00:36:47] [config] disp-first: 0
[2023-07-23 00:36:47] [config] disp-freq: 1000u
[2023-07-23 00:36:47] [config] disp-label-counts: true
[2023-07-23 00:36:47] [config] dropout-rnn: 0
[2023-07-23 00:36:47] [config] dropout-src: 0
[2023-07-23 00:36:47] [config] dropout-trg: 0
[2023-07-23 00:36:47] [config] dump-config: ""
[2023-07-23 00:36:47] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] early-stopping: 200
[2023-07-23 00:36:47] [config] early-stopping-on: first
[2023-07-23 00:36:47] [config] embedding-fix-src: false
[2023-07-23 00:36:47] [config] embedding-fix-trg: false
[2023-07-23 00:36:47] [config] embedding-normalization: false
[2023-07-23 00:36:47] [config] embedding-vectors:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] enc-cell: tanh
[2023-07-23 00:36:47] [config] enc-cell-depth: 1
[2023-07-23 00:36:47] [config] enc-depth: 1
[2023-07-23 00:36:47] [config] enc-type: bidirectional
[2023-07-23 00:36:47] [config] english-title-case-every: 0
[2023-07-23 00:36:47] [config] exponential-smoothing: 0
[2023-07-23 00:36:47] [config] factor-weight: 1
[2023-07-23 00:36:47] [config] factors-combine: sum
[2023-07-23 00:36:47] [config] factors-dim-emb: 0
[2023-07-23 00:36:47] [config] gradient-checkpointing: false
[2023-07-23 00:36:47] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:47] [config] guided-alignment: none
[2023-07-23 00:36:47] [config] guided-alignment-cost: mse
[2023-07-23 00:36:47] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:47] [config] ignore-model-config: false
[2023-07-23 00:36:47] [config] input-types:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] interpolate-env-vars: false
[2023-07-23 00:36:47] [config] keep-best: false
[2023-07-23 00:36:47] [config] label-smoothing: 0
[2023-07-23 00:36:47] [config] layer-normalization: false
[2023-07-23 00:36:47] [config] learn-rate: 0.0001
[2023-07-23 00:36:47] [config] lemma-dependency: ""
[2023-07-23 00:36:47] [config] lemma-dim-emb: 0
[2023-07-23 00:36:47] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:47] [config] log-level: info
[2023-07-23 00:36:47] [config] log-time-zone: ""
[2023-07-23 00:36:47] [config] logical-epoch:
[2023-07-23 00:36:47] [config]   - 1e
[2023-07-23 00:36:47] [config]   - 0
[2023-07-23 00:36:47] [config] lr-decay: 0
[2023-07-23 00:36:47] [config] lr-decay-freq: 50000
[2023-07-23 00:36:47] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:47] [config]   - 0
[2023-07-23 00:36:47] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:47] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:47] [config] lr-decay-start:
[2023-07-23 00:36:47] [config]   - 10
[2023-07-23 00:36:47] [config]   - 1
[2023-07-23 00:36:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:47] [config] lr-report: false
[2023-07-23 00:36:47] [config] lr-warmup: 0
[2023-07-23 00:36:47] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:47] [config] lr-warmup-cycle: false
[2023-07-23 00:36:47] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:47] [config] max-length: 50
[2023-07-23 00:36:47] [config] max-length-crop: true
[2023-07-23 00:36:47] [config] max-length-factor: 3
[2023-07-23 00:36:47] [config] maxi-batch: 100
[2023-07-23 00:36:47] [config] maxi-batch-sort: trg
[2023-07-23 00:36:47] [config] mini-batch: 64
[2023-07-23 00:36:47] [config] mini-batch-fit: true
[2023-07-23 00:36:47] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:47] [config] mini-batch-round-up: true
[2023-07-23 00:36:47] [config] mini-batch-track-lr: false
[2023-07-23 00:36:47] [config] mini-batch-warmup: 0
[2023-07-23 00:36:47] [config] mini-batch-words: 0
[2023-07-23 00:36:47] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:47] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:47] [config] multi-loss-type: sum
[2023-07-23 00:36:47] [config] n-best: false
[2023-07-23 00:36:47] [config] no-nccl: false
[2023-07-23 00:36:47] [config] no-reload: false
[2023-07-23 00:36:47] [config] no-restore-corpus: false
[2023-07-23 00:36:47] [config] normalize: 0
[2023-07-23 00:36:47] [config] normalize-gradient: false
[2023-07-23 00:36:47] [config] num-devices: 0
[2023-07-23 00:36:47] [config] optimizer: adam
[2023-07-23 00:36:47] [config] optimizer-delay: 1
[2023-07-23 00:36:47] [config] optimizer-params:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] output-omit-bias: false
[2023-07-23 00:36:47] [config] overwrite: true
[2023-07-23 00:36:47] [config] precision:
[2023-07-23 00:36:47] [config]   - float16
[2023-07-23 00:36:47] [config]   - float32
[2023-07-23 00:36:47] [config] pretrained-model: ""
[2023-07-23 00:36:47] [config] quantize-biases: false
[2023-07-23 00:36:47] [config] quantize-bits: 0
[2023-07-23 00:36:47] [config] quantize-log-based: false
[2023-07-23 00:36:47] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:47] [config] quiet: false
[2023-07-23 00:36:47] [config] quiet-translation: true
[2023-07-23 00:36:47] [config] relative-paths: false
[2023-07-23 00:36:47] [config] right-left: false
[2023-07-23 00:36:47] [config] save-freq: 10000u
[2023-07-23 00:36:47] [config] seed: 1234
[2023-07-23 00:36:47] [config] sentencepiece-alphas:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:47] [config] sentencepiece-options: ""
[2023-07-23 00:36:47] [config] sharding: global
[2023-07-23 00:36:47] [config] shuffle: data
[2023-07-23 00:36:47] [config] shuffle-in-ram: false
[2023-07-23 00:36:47] [config] sigterm: save-and-exit
[2023-07-23 00:36:47] [config] skip: false
[2023-07-23 00:36:47] [config] sqlite: ""
[2023-07-23 00:36:47] [config] sqlite-drop: false
[2023-07-23 00:36:47] [config] sync-freq: 200u
[2023-07-23 00:36:47] [config] sync-sgd: false
[2023-07-23 00:36:47] [config] tempdir: /tmp
[2023-07-23 00:36:47] [config] tied-embeddings: false
[2023-07-23 00:36:47] [config] tied-embeddings-all: true
[2023-07-23 00:36:47] [config] tied-embeddings-src: false
[2023-07-23 00:36:47] [config] train-embedder-rank:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] train-sets:
[2023-07-23 00:36:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:47] [config] transformer-aan-activation: swish
[2023-07-23 00:36:47] [config] transformer-aan-depth: 2
[2023-07-23 00:36:47] [config] transformer-aan-nogate: false
[2023-07-23 00:36:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:47] [config] transformer-depth-scaling: false
[2023-07-23 00:36:47] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:47] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:47] [config] transformer-dropout: 0
[2023-07-23 00:36:47] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:47] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:47] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:47] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:47] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:47] [config] transformer-heads: 8
[2023-07-23 00:36:47] [config] transformer-no-projection: false
[2023-07-23 00:36:47] [config] transformer-pool: false
[2023-07-23 00:36:47] [config] transformer-postprocess: dan
[2023-07-23 00:36:47] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:47] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:47] [config] transformer-preprocess: ""
[2023-07-23 00:36:47] [config] transformer-tied-layers:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:47] [config] tsv: false
[2023-07-23 00:36:47] [config] tsv-fields: 0
[2023-07-23 00:36:47] [config] type: amun
[2023-07-23 00:36:47] [config] ulr: false
[2023-07-23 00:36:47] [config] ulr-dim-emb: 0
[2023-07-23 00:36:47] [config] ulr-dropout: 0
[2023-07-23 00:36:47] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:47] [config] ulr-query-vectors: ""
[2023-07-23 00:36:47] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:47] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:47] [config] unlikelihood-loss: false
[2023-07-23 00:36:47] [config] valid-freq: 50000000
[2023-07-23 00:36:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:47] [config] valid-max-length: 1000
[2023-07-23 00:36:47] [config] valid-metrics:
[2023-07-23 00:36:47] [config]   - cross-entropy
[2023-07-23 00:36:47] [config]   - translation
[2023-07-23 00:36:47] [config] valid-mini-batch: 32
[2023-07-23 00:36:47] [config] valid-reset-stalled: false
[2023-07-23 00:36:47] [config] valid-script-args:
[2023-07-23 00:36:47] [config]   []
[2023-07-23 00:36:47] [config] valid-script-path: ""
[2023-07-23 00:36:47] [config] valid-sets:
[2023-07-23 00:36:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:47] [config] vocabs:
[2023-07-23 00:36:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:47] [config] word-penalty: 0
[2023-07-23 00:36:47] [config] word-scores: false
[2023-07-23 00:36:47] [config] workspace: 5500
[2023-07-23 00:36:47] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:47] [training] Using single-device training
[2023-07-23 00:36:47] Synced seed 1234
[2023-07-23 00:36:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:47] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:47] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:47] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:49] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:49] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x563bc5354692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x563bc5295da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x563bc529a1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x563bc52a12ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x563bc544da0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x563bc544ea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x563bc5427bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x563bc4f29108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x563bc4e4b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x563bc4e02b9c]    main                                               + 0x3c
[0x7fbf1903e0b3]    __libc_start_main                                  + 0xf3
[0x563bc4e49cbe]    _start                                             + 0x2e

[2023-07-23 00:36:52] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:52] [marian] Running on node23.datos.cluster.uy as process 7474 with command line:
[2023-07-23 00:36:52] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:52] [config] after: 0e
[2023-07-23 00:36:52] [config] after-batches: 0
[2023-07-23 00:36:52] [config] after-epochs: 120
[2023-07-23 00:36:52] [config] all-caps-every: 0
[2023-07-23 00:36:52] [config] allow-unk: false
[2023-07-23 00:36:52] [config] authors: false
[2023-07-23 00:36:52] [config] beam-size: 12
[2023-07-23 00:36:52] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:52] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:52] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:52] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:52] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:52] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:52] [config] build-info: ""
[2023-07-23 00:36:52] [config] check-gradient-nan: false
[2023-07-23 00:36:52] [config] check-nan: false
[2023-07-23 00:36:52] [config] cite: false
[2023-07-23 00:36:52] [config] clip-norm: 1
[2023-07-23 00:36:52] [config] cost-scaling:
[2023-07-23 00:36:52] [config]   - 256.f
[2023-07-23 00:36:52] [config]   - 1000
[2023-07-23 00:36:52] [config]   - 2.f
[2023-07-23 00:36:52] [config]   - 256.f
[2023-07-23 00:36:52] [config] cost-type: ce-sum
[2023-07-23 00:36:52] [config] cpu-threads: 0
[2023-07-23 00:36:52] [config] data-threads: 8
[2023-07-23 00:36:52] [config] data-weighting: ""
[2023-07-23 00:36:52] [config] data-weighting-type: sentence
[2023-07-23 00:36:52] [config] dec-cell: gru
[2023-07-23 00:36:52] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:52] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:52] [config] dec-depth: 1
[2023-07-23 00:36:52] [config] devices:
[2023-07-23 00:36:52] [config]   - 0
[2023-07-23 00:36:52] [config] dim-emb: 512
[2023-07-23 00:36:52] [config] dim-rnn: 1024
[2023-07-23 00:36:52] [config] dim-vocabs:
[2023-07-23 00:36:52] [config]   - 16384
[2023-07-23 00:36:52] [config]   - 16384
[2023-07-23 00:36:52] [config] disp-first: 0
[2023-07-23 00:36:52] [config] disp-freq: 1000u
[2023-07-23 00:36:52] [config] disp-label-counts: true
[2023-07-23 00:36:52] [config] dropout-rnn: 0
[2023-07-23 00:36:52] [config] dropout-src: 0
[2023-07-23 00:36:52] [config] dropout-trg: 0
[2023-07-23 00:36:52] [config] dump-config: ""
[2023-07-23 00:36:52] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] early-stopping: 200
[2023-07-23 00:36:52] [config] early-stopping-on: first
[2023-07-23 00:36:52] [config] embedding-fix-src: false
[2023-07-23 00:36:52] [config] embedding-fix-trg: false
[2023-07-23 00:36:52] [config] embedding-normalization: false
[2023-07-23 00:36:52] [config] embedding-vectors:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] enc-cell: tanh
[2023-07-23 00:36:52] [config] enc-cell-depth: 1
[2023-07-23 00:36:52] [config] enc-depth: 1
[2023-07-23 00:36:52] [config] enc-type: bidirectional
[2023-07-23 00:36:52] [config] english-title-case-every: 0
[2023-07-23 00:36:52] [config] exponential-smoothing: 0
[2023-07-23 00:36:52] [config] factor-weight: 1
[2023-07-23 00:36:52] [config] factors-combine: sum
[2023-07-23 00:36:52] [config] factors-dim-emb: 0
[2023-07-23 00:36:52] [config] gradient-checkpointing: false
[2023-07-23 00:36:52] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:52] [config] guided-alignment: none
[2023-07-23 00:36:52] [config] guided-alignment-cost: mse
[2023-07-23 00:36:52] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:52] [config] ignore-model-config: false
[2023-07-23 00:36:52] [config] input-types:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] interpolate-env-vars: false
[2023-07-23 00:36:52] [config] keep-best: false
[2023-07-23 00:36:52] [config] label-smoothing: 0
[2023-07-23 00:36:52] [config] layer-normalization: false
[2023-07-23 00:36:52] [config] learn-rate: 0.0001
[2023-07-23 00:36:52] [config] lemma-dependency: ""
[2023-07-23 00:36:52] [config] lemma-dim-emb: 0
[2023-07-23 00:36:52] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:52] [config] log-level: info
[2023-07-23 00:36:52] [config] log-time-zone: ""
[2023-07-23 00:36:52] [config] logical-epoch:
[2023-07-23 00:36:52] [config]   - 1e
[2023-07-23 00:36:52] [config]   - 0
[2023-07-23 00:36:52] [config] lr-decay: 0
[2023-07-23 00:36:52] [config] lr-decay-freq: 50000
[2023-07-23 00:36:52] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:52] [config]   - 0
[2023-07-23 00:36:52] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:52] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:52] [config] lr-decay-start:
[2023-07-23 00:36:52] [config]   - 10
[2023-07-23 00:36:52] [config]   - 1
[2023-07-23 00:36:52] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:52] [config] lr-report: false
[2023-07-23 00:36:52] [config] lr-warmup: 0
[2023-07-23 00:36:52] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:52] [config] lr-warmup-cycle: false
[2023-07-23 00:36:52] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:52] [config] max-length: 50
[2023-07-23 00:36:52] [config] max-length-crop: true
[2023-07-23 00:36:52] [config] max-length-factor: 3
[2023-07-23 00:36:52] [config] maxi-batch: 100
[2023-07-23 00:36:52] [config] maxi-batch-sort: trg
[2023-07-23 00:36:52] [config] mini-batch: 64
[2023-07-23 00:36:52] [config] mini-batch-fit: true
[2023-07-23 00:36:52] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:52] [config] mini-batch-round-up: true
[2023-07-23 00:36:52] [config] mini-batch-track-lr: false
[2023-07-23 00:36:52] [config] mini-batch-warmup: 0
[2023-07-23 00:36:52] [config] mini-batch-words: 0
[2023-07-23 00:36:52] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:52] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:52] [config] multi-loss-type: sum
[2023-07-23 00:36:52] [config] n-best: false
[2023-07-23 00:36:52] [config] no-nccl: false
[2023-07-23 00:36:52] [config] no-reload: false
[2023-07-23 00:36:52] [config] no-restore-corpus: false
[2023-07-23 00:36:52] [config] normalize: 0
[2023-07-23 00:36:52] [config] normalize-gradient: false
[2023-07-23 00:36:52] [config] num-devices: 0
[2023-07-23 00:36:52] [config] optimizer: adam
[2023-07-23 00:36:52] [config] optimizer-delay: 1
[2023-07-23 00:36:52] [config] optimizer-params:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] output-omit-bias: false
[2023-07-23 00:36:52] [config] overwrite: true
[2023-07-23 00:36:52] [config] precision:
[2023-07-23 00:36:52] [config]   - float16
[2023-07-23 00:36:52] [config]   - float32
[2023-07-23 00:36:52] [config] pretrained-model: ""
[2023-07-23 00:36:52] [config] quantize-biases: false
[2023-07-23 00:36:52] [config] quantize-bits: 0
[2023-07-23 00:36:52] [config] quantize-log-based: false
[2023-07-23 00:36:52] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:52] [config] quiet: false
[2023-07-23 00:36:52] [config] quiet-translation: true
[2023-07-23 00:36:52] [config] relative-paths: false
[2023-07-23 00:36:52] [config] right-left: false
[2023-07-23 00:36:52] [config] save-freq: 10000u
[2023-07-23 00:36:52] [config] seed: 1234
[2023-07-23 00:36:52] [config] sentencepiece-alphas:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:52] [config] sentencepiece-options: ""
[2023-07-23 00:36:52] [config] sharding: global
[2023-07-23 00:36:52] [config] shuffle: data
[2023-07-23 00:36:52] [config] shuffle-in-ram: false
[2023-07-23 00:36:52] [config] sigterm: save-and-exit
[2023-07-23 00:36:52] [config] skip: false
[2023-07-23 00:36:52] [config] sqlite: ""
[2023-07-23 00:36:52] [config] sqlite-drop: false
[2023-07-23 00:36:52] [config] sync-freq: 200u
[2023-07-23 00:36:52] [config] sync-sgd: false
[2023-07-23 00:36:52] [config] tempdir: /tmp
[2023-07-23 00:36:52] [config] tied-embeddings: false
[2023-07-23 00:36:52] [config] tied-embeddings-all: true
[2023-07-23 00:36:52] [config] tied-embeddings-src: false
[2023-07-23 00:36:52] [config] train-embedder-rank:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] train-sets:
[2023-07-23 00:36:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:52] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:52] [config] transformer-aan-activation: swish
[2023-07-23 00:36:52] [config] transformer-aan-depth: 2
[2023-07-23 00:36:52] [config] transformer-aan-nogate: false
[2023-07-23 00:36:52] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:52] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:52] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:52] [config] transformer-depth-scaling: false
[2023-07-23 00:36:52] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:52] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:52] [config] transformer-dropout: 0
[2023-07-23 00:36:52] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:52] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:52] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:52] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:52] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:52] [config] transformer-heads: 8
[2023-07-23 00:36:52] [config] transformer-no-projection: false
[2023-07-23 00:36:52] [config] transformer-pool: false
[2023-07-23 00:36:52] [config] transformer-postprocess: dan
[2023-07-23 00:36:52] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:52] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:52] [config] transformer-preprocess: ""
[2023-07-23 00:36:52] [config] transformer-tied-layers:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:52] [config] tsv: false
[2023-07-23 00:36:52] [config] tsv-fields: 0
[2023-07-23 00:36:52] [config] type: amun
[2023-07-23 00:36:52] [config] ulr: false
[2023-07-23 00:36:52] [config] ulr-dim-emb: 0
[2023-07-23 00:36:52] [config] ulr-dropout: 0
[2023-07-23 00:36:52] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:52] [config] ulr-query-vectors: ""
[2023-07-23 00:36:52] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:52] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:52] [config] unlikelihood-loss: false
[2023-07-23 00:36:52] [config] valid-freq: 50000000
[2023-07-23 00:36:52] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:52] [config] valid-max-length: 1000
[2023-07-23 00:36:52] [config] valid-metrics:
[2023-07-23 00:36:52] [config]   - cross-entropy
[2023-07-23 00:36:52] [config]   - translation
[2023-07-23 00:36:52] [config] valid-mini-batch: 32
[2023-07-23 00:36:52] [config] valid-reset-stalled: false
[2023-07-23 00:36:52] [config] valid-script-args:
[2023-07-23 00:36:52] [config]   []
[2023-07-23 00:36:52] [config] valid-script-path: ""
[2023-07-23 00:36:52] [config] valid-sets:
[2023-07-23 00:36:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:52] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:52] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:52] [config] vocabs:
[2023-07-23 00:36:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:52] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:52] [config] word-penalty: 0
[2023-07-23 00:36:52] [config] word-scores: false
[2023-07-23 00:36:52] [config] workspace: 5500
[2023-07-23 00:36:52] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:52] [training] Using single-device training
[2023-07-23 00:36:52] Synced seed 1234
[2023-07-23 00:36:52] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:52] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:52] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:52] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:52] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:52] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:52] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:53] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:53] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55a1fe851692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55a1fe792da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55a1fe7971a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55a1fe79e2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55a1fe94aa0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55a1fe94ba53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55a1fe924bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55a1fe426108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55a1fe3482c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55a1fe2ffb9c]    main                                               + 0x3c
[0x7f084b8f80b3]    __libc_start_main                                  + 0xf3
[0x55a1fe346cbe]    _start                                             + 0x2e

[2023-07-23 00:36:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:57] [marian] Running on node23.datos.cluster.uy as process 7503 with command line:
[2023-07-23 00:36:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:36:57] [config] after: 0e
[2023-07-23 00:36:57] [config] after-batches: 0
[2023-07-23 00:36:57] [config] after-epochs: 130
[2023-07-23 00:36:57] [config] all-caps-every: 0
[2023-07-23 00:36:57] [config] allow-unk: false
[2023-07-23 00:36:57] [config] authors: false
[2023-07-23 00:36:57] [config] beam-size: 12
[2023-07-23 00:36:57] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:36:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:36:57] [config] bert-masking-fraction: 0.15
[2023-07-23 00:36:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:36:57] [config] bert-train-type-embeddings: true
[2023-07-23 00:36:57] [config] bert-type-vocab-size: 2
[2023-07-23 00:36:57] [config] build-info: ""
[2023-07-23 00:36:57] [config] check-gradient-nan: false
[2023-07-23 00:36:57] [config] check-nan: false
[2023-07-23 00:36:57] [config] cite: false
[2023-07-23 00:36:57] [config] clip-norm: 1
[2023-07-23 00:36:57] [config] cost-scaling:
[2023-07-23 00:36:57] [config]   - 256.f
[2023-07-23 00:36:57] [config]   - 1000
[2023-07-23 00:36:57] [config]   - 2.f
[2023-07-23 00:36:57] [config]   - 256.f
[2023-07-23 00:36:57] [config] cost-type: ce-sum
[2023-07-23 00:36:57] [config] cpu-threads: 0
[2023-07-23 00:36:57] [config] data-threads: 8
[2023-07-23 00:36:57] [config] data-weighting: ""
[2023-07-23 00:36:57] [config] data-weighting-type: sentence
[2023-07-23 00:36:57] [config] dec-cell: gru
[2023-07-23 00:36:57] [config] dec-cell-base-depth: 2
[2023-07-23 00:36:57] [config] dec-cell-high-depth: 1
[2023-07-23 00:36:57] [config] dec-depth: 1
[2023-07-23 00:36:57] [config] devices:
[2023-07-23 00:36:57] [config]   - 0
[2023-07-23 00:36:57] [config] dim-emb: 512
[2023-07-23 00:36:57] [config] dim-rnn: 1024
[2023-07-23 00:36:57] [config] dim-vocabs:
[2023-07-23 00:36:57] [config]   - 16384
[2023-07-23 00:36:57] [config]   - 16384
[2023-07-23 00:36:57] [config] disp-first: 0
[2023-07-23 00:36:57] [config] disp-freq: 1000u
[2023-07-23 00:36:57] [config] disp-label-counts: true
[2023-07-23 00:36:57] [config] dropout-rnn: 0
[2023-07-23 00:36:57] [config] dropout-src: 0
[2023-07-23 00:36:57] [config] dropout-trg: 0
[2023-07-23 00:36:57] [config] dump-config: ""
[2023-07-23 00:36:57] [config] dynamic-gradient-scaling:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] early-stopping: 200
[2023-07-23 00:36:57] [config] early-stopping-on: first
[2023-07-23 00:36:57] [config] embedding-fix-src: false
[2023-07-23 00:36:57] [config] embedding-fix-trg: false
[2023-07-23 00:36:57] [config] embedding-normalization: false
[2023-07-23 00:36:57] [config] embedding-vectors:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] enc-cell: tanh
[2023-07-23 00:36:57] [config] enc-cell-depth: 1
[2023-07-23 00:36:57] [config] enc-depth: 1
[2023-07-23 00:36:57] [config] enc-type: bidirectional
[2023-07-23 00:36:57] [config] english-title-case-every: 0
[2023-07-23 00:36:57] [config] exponential-smoothing: 0
[2023-07-23 00:36:57] [config] factor-weight: 1
[2023-07-23 00:36:57] [config] factors-combine: sum
[2023-07-23 00:36:57] [config] factors-dim-emb: 0
[2023-07-23 00:36:57] [config] gradient-checkpointing: false
[2023-07-23 00:36:57] [config] gradient-norm-average-window: 100
[2023-07-23 00:36:57] [config] guided-alignment: none
[2023-07-23 00:36:57] [config] guided-alignment-cost: mse
[2023-07-23 00:36:57] [config] guided-alignment-weight: 0.1
[2023-07-23 00:36:57] [config] ignore-model-config: false
[2023-07-23 00:36:57] [config] input-types:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] interpolate-env-vars: false
[2023-07-23 00:36:57] [config] keep-best: false
[2023-07-23 00:36:57] [config] label-smoothing: 0
[2023-07-23 00:36:57] [config] layer-normalization: false
[2023-07-23 00:36:57] [config] learn-rate: 0.0001
[2023-07-23 00:36:57] [config] lemma-dependency: ""
[2023-07-23 00:36:57] [config] lemma-dim-emb: 0
[2023-07-23 00:36:57] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:57] [config] log-level: info
[2023-07-23 00:36:57] [config] log-time-zone: ""
[2023-07-23 00:36:57] [config] logical-epoch:
[2023-07-23 00:36:57] [config]   - 1e
[2023-07-23 00:36:57] [config]   - 0
[2023-07-23 00:36:57] [config] lr-decay: 0
[2023-07-23 00:36:57] [config] lr-decay-freq: 50000
[2023-07-23 00:36:57] [config] lr-decay-inv-sqrt:
[2023-07-23 00:36:57] [config]   - 0
[2023-07-23 00:36:57] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:36:57] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:36:57] [config] lr-decay-start:
[2023-07-23 00:36:57] [config]   - 10
[2023-07-23 00:36:57] [config]   - 1
[2023-07-23 00:36:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:36:57] [config] lr-report: false
[2023-07-23 00:36:57] [config] lr-warmup: 0
[2023-07-23 00:36:57] [config] lr-warmup-at-reload: false
[2023-07-23 00:36:57] [config] lr-warmup-cycle: false
[2023-07-23 00:36:57] [config] lr-warmup-start-rate: 0
[2023-07-23 00:36:57] [config] max-length: 50
[2023-07-23 00:36:57] [config] max-length-crop: true
[2023-07-23 00:36:57] [config] max-length-factor: 3
[2023-07-23 00:36:57] [config] maxi-batch: 100
[2023-07-23 00:36:57] [config] maxi-batch-sort: trg
[2023-07-23 00:36:57] [config] mini-batch: 64
[2023-07-23 00:36:57] [config] mini-batch-fit: true
[2023-07-23 00:36:57] [config] mini-batch-fit-step: 10
[2023-07-23 00:36:57] [config] mini-batch-round-up: true
[2023-07-23 00:36:57] [config] mini-batch-track-lr: false
[2023-07-23 00:36:57] [config] mini-batch-warmup: 0
[2023-07-23 00:36:57] [config] mini-batch-words: 0
[2023-07-23 00:36:57] [config] mini-batch-words-ref: 0
[2023-07-23 00:36:57] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:36:57] [config] multi-loss-type: sum
[2023-07-23 00:36:57] [config] n-best: false
[2023-07-23 00:36:57] [config] no-nccl: false
[2023-07-23 00:36:57] [config] no-reload: false
[2023-07-23 00:36:57] [config] no-restore-corpus: false
[2023-07-23 00:36:57] [config] normalize: 0
[2023-07-23 00:36:57] [config] normalize-gradient: false
[2023-07-23 00:36:57] [config] num-devices: 0
[2023-07-23 00:36:57] [config] optimizer: adam
[2023-07-23 00:36:57] [config] optimizer-delay: 1
[2023-07-23 00:36:57] [config] optimizer-params:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] output-omit-bias: false
[2023-07-23 00:36:57] [config] overwrite: true
[2023-07-23 00:36:57] [config] precision:
[2023-07-23 00:36:57] [config]   - float16
[2023-07-23 00:36:57] [config]   - float32
[2023-07-23 00:36:57] [config] pretrained-model: ""
[2023-07-23 00:36:57] [config] quantize-biases: false
[2023-07-23 00:36:57] [config] quantize-bits: 0
[2023-07-23 00:36:57] [config] quantize-log-based: false
[2023-07-23 00:36:57] [config] quantize-optimization-steps: 0
[2023-07-23 00:36:57] [config] quiet: false
[2023-07-23 00:36:57] [config] quiet-translation: true
[2023-07-23 00:36:57] [config] relative-paths: false
[2023-07-23 00:36:57] [config] right-left: false
[2023-07-23 00:36:57] [config] save-freq: 10000u
[2023-07-23 00:36:57] [config] seed: 1234
[2023-07-23 00:36:57] [config] sentencepiece-alphas:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:36:57] [config] sentencepiece-options: ""
[2023-07-23 00:36:57] [config] sharding: global
[2023-07-23 00:36:57] [config] shuffle: data
[2023-07-23 00:36:57] [config] shuffle-in-ram: false
[2023-07-23 00:36:57] [config] sigterm: save-and-exit
[2023-07-23 00:36:57] [config] skip: false
[2023-07-23 00:36:57] [config] sqlite: ""
[2023-07-23 00:36:57] [config] sqlite-drop: false
[2023-07-23 00:36:57] [config] sync-freq: 200u
[2023-07-23 00:36:57] [config] sync-sgd: false
[2023-07-23 00:36:57] [config] tempdir: /tmp
[2023-07-23 00:36:57] [config] tied-embeddings: false
[2023-07-23 00:36:57] [config] tied-embeddings-all: true
[2023-07-23 00:36:57] [config] tied-embeddings-src: false
[2023-07-23 00:36:57] [config] train-embedder-rank:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] train-sets:
[2023-07-23 00:36:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:36:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:36:57] [config] transformer-aan-activation: swish
[2023-07-23 00:36:57] [config] transformer-aan-depth: 2
[2023-07-23 00:36:57] [config] transformer-aan-nogate: false
[2023-07-23 00:36:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:36:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:36:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:36:57] [config] transformer-depth-scaling: false
[2023-07-23 00:36:57] [config] transformer-dim-aan: 2048
[2023-07-23 00:36:57] [config] transformer-dim-ffn: 2048
[2023-07-23 00:36:57] [config] transformer-dropout: 0
[2023-07-23 00:36:57] [config] transformer-dropout-attention: 0
[2023-07-23 00:36:57] [config] transformer-dropout-ffn: 0
[2023-07-23 00:36:57] [config] transformer-ffn-activation: swish
[2023-07-23 00:36:57] [config] transformer-ffn-depth: 2
[2023-07-23 00:36:57] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:36:57] [config] transformer-heads: 8
[2023-07-23 00:36:57] [config] transformer-no-projection: false
[2023-07-23 00:36:57] [config] transformer-pool: false
[2023-07-23 00:36:57] [config] transformer-postprocess: dan
[2023-07-23 00:36:57] [config] transformer-postprocess-emb: d
[2023-07-23 00:36:57] [config] transformer-postprocess-top: ""
[2023-07-23 00:36:57] [config] transformer-preprocess: ""
[2023-07-23 00:36:57] [config] transformer-tied-layers:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] transformer-train-position-embeddings: false
[2023-07-23 00:36:57] [config] tsv: false
[2023-07-23 00:36:57] [config] tsv-fields: 0
[2023-07-23 00:36:57] [config] type: amun
[2023-07-23 00:36:57] [config] ulr: false
[2023-07-23 00:36:57] [config] ulr-dim-emb: 0
[2023-07-23 00:36:57] [config] ulr-dropout: 0
[2023-07-23 00:36:57] [config] ulr-keys-vectors: ""
[2023-07-23 00:36:57] [config] ulr-query-vectors: ""
[2023-07-23 00:36:57] [config] ulr-softmax-temperature: 1
[2023-07-23 00:36:57] [config] ulr-trainable-transformation: false
[2023-07-23 00:36:57] [config] unlikelihood-loss: false
[2023-07-23 00:36:57] [config] valid-freq: 50000000
[2023-07-23 00:36:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:36:57] [config] valid-max-length: 1000
[2023-07-23 00:36:57] [config] valid-metrics:
[2023-07-23 00:36:57] [config]   - cross-entropy
[2023-07-23 00:36:57] [config]   - translation
[2023-07-23 00:36:57] [config] valid-mini-batch: 32
[2023-07-23 00:36:57] [config] valid-reset-stalled: false
[2023-07-23 00:36:57] [config] valid-script-args:
[2023-07-23 00:36:57] [config]   []
[2023-07-23 00:36:57] [config] valid-script-path: ""
[2023-07-23 00:36:57] [config] valid-sets:
[2023-07-23 00:36:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:36:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:36:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:36:57] [config] vocabs:
[2023-07-23 00:36:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:57] [config] word-penalty: 0
[2023-07-23 00:36:57] [config] word-scores: false
[2023-07-23 00:36:57] [config] workspace: 5500
[2023-07-23 00:36:57] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:36:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:57] [training] Using single-device training
[2023-07-23 00:36:57] Synced seed 1234
[2023-07-23 00:36:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:36:57] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:36:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:36:57] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:36:57] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:36:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:36:57] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:36:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:36:58] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:36:58] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55abd398e692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55abd38cfda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55abd38d41a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55abd38db2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55abd3a87a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55abd3a88a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55abd3a61bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55abd3563108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55abd34852c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55abd343cb9c]    main                                               + 0x3c
[0x7f7fb871d0b3]    __libc_start_main                                  + 0xf3
[0x55abd3483cbe]    _start                                             + 0x2e

[2023-07-23 00:37:02] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:02] [marian] Running on node23.datos.cluster.uy as process 7531 with command line:
[2023-07-23 00:37:02] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:02] [config] after: 0e
[2023-07-23 00:37:02] [config] after-batches: 0
[2023-07-23 00:37:02] [config] after-epochs: 140
[2023-07-23 00:37:02] [config] all-caps-every: 0
[2023-07-23 00:37:02] [config] allow-unk: false
[2023-07-23 00:37:02] [config] authors: false
[2023-07-23 00:37:02] [config] beam-size: 12
[2023-07-23 00:37:02] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:02] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:02] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:02] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:02] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:02] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:02] [config] build-info: ""
[2023-07-23 00:37:02] [config] check-gradient-nan: false
[2023-07-23 00:37:02] [config] check-nan: false
[2023-07-23 00:37:02] [config] cite: false
[2023-07-23 00:37:02] [config] clip-norm: 1
[2023-07-23 00:37:02] [config] cost-scaling:
[2023-07-23 00:37:02] [config]   - 256.f
[2023-07-23 00:37:02] [config]   - 1000
[2023-07-23 00:37:02] [config]   - 2.f
[2023-07-23 00:37:02] [config]   - 256.f
[2023-07-23 00:37:02] [config] cost-type: ce-sum
[2023-07-23 00:37:02] [config] cpu-threads: 0
[2023-07-23 00:37:02] [config] data-threads: 8
[2023-07-23 00:37:02] [config] data-weighting: ""
[2023-07-23 00:37:02] [config] data-weighting-type: sentence
[2023-07-23 00:37:02] [config] dec-cell: gru
[2023-07-23 00:37:02] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:02] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:02] [config] dec-depth: 1
[2023-07-23 00:37:02] [config] devices:
[2023-07-23 00:37:02] [config]   - 0
[2023-07-23 00:37:02] [config] dim-emb: 512
[2023-07-23 00:37:02] [config] dim-rnn: 1024
[2023-07-23 00:37:02] [config] dim-vocabs:
[2023-07-23 00:37:02] [config]   - 16384
[2023-07-23 00:37:02] [config]   - 16384
[2023-07-23 00:37:02] [config] disp-first: 0
[2023-07-23 00:37:02] [config] disp-freq: 1000u
[2023-07-23 00:37:02] [config] disp-label-counts: true
[2023-07-23 00:37:02] [config] dropout-rnn: 0
[2023-07-23 00:37:02] [config] dropout-src: 0
[2023-07-23 00:37:02] [config] dropout-trg: 0
[2023-07-23 00:37:02] [config] dump-config: ""
[2023-07-23 00:37:02] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] early-stopping: 200
[2023-07-23 00:37:02] [config] early-stopping-on: first
[2023-07-23 00:37:02] [config] embedding-fix-src: false
[2023-07-23 00:37:02] [config] embedding-fix-trg: false
[2023-07-23 00:37:02] [config] embedding-normalization: false
[2023-07-23 00:37:02] [config] embedding-vectors:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] enc-cell: tanh
[2023-07-23 00:37:02] [config] enc-cell-depth: 1
[2023-07-23 00:37:02] [config] enc-depth: 1
[2023-07-23 00:37:02] [config] enc-type: bidirectional
[2023-07-23 00:37:02] [config] english-title-case-every: 0
[2023-07-23 00:37:02] [config] exponential-smoothing: 0
[2023-07-23 00:37:02] [config] factor-weight: 1
[2023-07-23 00:37:02] [config] factors-combine: sum
[2023-07-23 00:37:02] [config] factors-dim-emb: 0
[2023-07-23 00:37:02] [config] gradient-checkpointing: false
[2023-07-23 00:37:02] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:02] [config] guided-alignment: none
[2023-07-23 00:37:02] [config] guided-alignment-cost: mse
[2023-07-23 00:37:02] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:02] [config] ignore-model-config: false
[2023-07-23 00:37:02] [config] input-types:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] interpolate-env-vars: false
[2023-07-23 00:37:02] [config] keep-best: false
[2023-07-23 00:37:02] [config] label-smoothing: 0
[2023-07-23 00:37:02] [config] layer-normalization: false
[2023-07-23 00:37:02] [config] learn-rate: 0.0001
[2023-07-23 00:37:02] [config] lemma-dependency: ""
[2023-07-23 00:37:02] [config] lemma-dim-emb: 0
[2023-07-23 00:37:02] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:02] [config] log-level: info
[2023-07-23 00:37:02] [config] log-time-zone: ""
[2023-07-23 00:37:02] [config] logical-epoch:
[2023-07-23 00:37:02] [config]   - 1e
[2023-07-23 00:37:02] [config]   - 0
[2023-07-23 00:37:02] [config] lr-decay: 0
[2023-07-23 00:37:02] [config] lr-decay-freq: 50000
[2023-07-23 00:37:02] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:02] [config]   - 0
[2023-07-23 00:37:02] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:02] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:02] [config] lr-decay-start:
[2023-07-23 00:37:02] [config]   - 10
[2023-07-23 00:37:02] [config]   - 1
[2023-07-23 00:37:02] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:02] [config] lr-report: false
[2023-07-23 00:37:02] [config] lr-warmup: 0
[2023-07-23 00:37:02] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:02] [config] lr-warmup-cycle: false
[2023-07-23 00:37:02] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:02] [config] max-length: 50
[2023-07-23 00:37:02] [config] max-length-crop: true
[2023-07-23 00:37:02] [config] max-length-factor: 3
[2023-07-23 00:37:02] [config] maxi-batch: 100
[2023-07-23 00:37:02] [config] maxi-batch-sort: trg
[2023-07-23 00:37:02] [config] mini-batch: 64
[2023-07-23 00:37:02] [config] mini-batch-fit: true
[2023-07-23 00:37:02] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:02] [config] mini-batch-round-up: true
[2023-07-23 00:37:02] [config] mini-batch-track-lr: false
[2023-07-23 00:37:02] [config] mini-batch-warmup: 0
[2023-07-23 00:37:02] [config] mini-batch-words: 0
[2023-07-23 00:37:02] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:02] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:02] [config] multi-loss-type: sum
[2023-07-23 00:37:02] [config] n-best: false
[2023-07-23 00:37:02] [config] no-nccl: false
[2023-07-23 00:37:02] [config] no-reload: false
[2023-07-23 00:37:02] [config] no-restore-corpus: false
[2023-07-23 00:37:02] [config] normalize: 0
[2023-07-23 00:37:02] [config] normalize-gradient: false
[2023-07-23 00:37:02] [config] num-devices: 0
[2023-07-23 00:37:02] [config] optimizer: adam
[2023-07-23 00:37:02] [config] optimizer-delay: 1
[2023-07-23 00:37:02] [config] optimizer-params:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] output-omit-bias: false
[2023-07-23 00:37:02] [config] overwrite: true
[2023-07-23 00:37:02] [config] precision:
[2023-07-23 00:37:02] [config]   - float16
[2023-07-23 00:37:02] [config]   - float32
[2023-07-23 00:37:02] [config] pretrained-model: ""
[2023-07-23 00:37:02] [config] quantize-biases: false
[2023-07-23 00:37:02] [config] quantize-bits: 0
[2023-07-23 00:37:02] [config] quantize-log-based: false
[2023-07-23 00:37:02] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:02] [config] quiet: false
[2023-07-23 00:37:02] [config] quiet-translation: true
[2023-07-23 00:37:02] [config] relative-paths: false
[2023-07-23 00:37:02] [config] right-left: false
[2023-07-23 00:37:02] [config] save-freq: 10000u
[2023-07-23 00:37:02] [config] seed: 1234
[2023-07-23 00:37:02] [config] sentencepiece-alphas:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:02] [config] sentencepiece-options: ""
[2023-07-23 00:37:02] [config] sharding: global
[2023-07-23 00:37:02] [config] shuffle: data
[2023-07-23 00:37:02] [config] shuffle-in-ram: false
[2023-07-23 00:37:02] [config] sigterm: save-and-exit
[2023-07-23 00:37:02] [config] skip: false
[2023-07-23 00:37:02] [config] sqlite: ""
[2023-07-23 00:37:02] [config] sqlite-drop: false
[2023-07-23 00:37:02] [config] sync-freq: 200u
[2023-07-23 00:37:02] [config] sync-sgd: false
[2023-07-23 00:37:02] [config] tempdir: /tmp
[2023-07-23 00:37:02] [config] tied-embeddings: false
[2023-07-23 00:37:02] [config] tied-embeddings-all: true
[2023-07-23 00:37:02] [config] tied-embeddings-src: false
[2023-07-23 00:37:02] [config] train-embedder-rank:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] train-sets:
[2023-07-23 00:37:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:02] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:02] [config] transformer-aan-activation: swish
[2023-07-23 00:37:02] [config] transformer-aan-depth: 2
[2023-07-23 00:37:02] [config] transformer-aan-nogate: false
[2023-07-23 00:37:02] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:02] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:02] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:02] [config] transformer-depth-scaling: false
[2023-07-23 00:37:02] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:02] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:02] [config] transformer-dropout: 0
[2023-07-23 00:37:02] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:02] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:02] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:02] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:02] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:02] [config] transformer-heads: 8
[2023-07-23 00:37:02] [config] transformer-no-projection: false
[2023-07-23 00:37:02] [config] transformer-pool: false
[2023-07-23 00:37:02] [config] transformer-postprocess: dan
[2023-07-23 00:37:02] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:02] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:02] [config] transformer-preprocess: ""
[2023-07-23 00:37:02] [config] transformer-tied-layers:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:02] [config] tsv: false
[2023-07-23 00:37:02] [config] tsv-fields: 0
[2023-07-23 00:37:02] [config] type: amun
[2023-07-23 00:37:02] [config] ulr: false
[2023-07-23 00:37:02] [config] ulr-dim-emb: 0
[2023-07-23 00:37:02] [config] ulr-dropout: 0
[2023-07-23 00:37:02] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:02] [config] ulr-query-vectors: ""
[2023-07-23 00:37:02] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:02] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:02] [config] unlikelihood-loss: false
[2023-07-23 00:37:02] [config] valid-freq: 50000000
[2023-07-23 00:37:02] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:02] [config] valid-max-length: 1000
[2023-07-23 00:37:02] [config] valid-metrics:
[2023-07-23 00:37:02] [config]   - cross-entropy
[2023-07-23 00:37:02] [config]   - translation
[2023-07-23 00:37:02] [config] valid-mini-batch: 32
[2023-07-23 00:37:02] [config] valid-reset-stalled: false
[2023-07-23 00:37:02] [config] valid-script-args:
[2023-07-23 00:37:02] [config]   []
[2023-07-23 00:37:02] [config] valid-script-path: ""
[2023-07-23 00:37:02] [config] valid-sets:
[2023-07-23 00:37:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:02] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:02] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:02] [config] vocabs:
[2023-07-23 00:37:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:02] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:02] [config] word-penalty: 0
[2023-07-23 00:37:02] [config] word-scores: false
[2023-07-23 00:37:02] [config] workspace: 5500
[2023-07-23 00:37:02] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:02] [training] Using single-device training
[2023-07-23 00:37:03] Synced seed 1234
[2023-07-23 00:37:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:03] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:03] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:03] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:03] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:03] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:04] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:04] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:04] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55693888d692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x5569387ceda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5569387d31a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5569387da2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x556938986a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x556938987a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x556938960bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x556938462108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5569383842c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55693833bb9c]    main                                               + 0x3c
[0x7f3baf8350b3]    __libc_start_main                                  + 0xf3
[0x556938382cbe]    _start                                             + 0x2e

[2023-07-23 00:37:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:08] [marian] Running on node23.datos.cluster.uy as process 7559 with command line:
[2023-07-23 00:37:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:08] [config] after: 0e
[2023-07-23 00:37:08] [config] after-batches: 0
[2023-07-23 00:37:08] [config] after-epochs: 150
[2023-07-23 00:37:08] [config] all-caps-every: 0
[2023-07-23 00:37:08] [config] allow-unk: false
[2023-07-23 00:37:08] [config] authors: false
[2023-07-23 00:37:08] [config] beam-size: 12
[2023-07-23 00:37:08] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:08] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:08] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:08] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:08] [config] build-info: ""
[2023-07-23 00:37:08] [config] check-gradient-nan: false
[2023-07-23 00:37:08] [config] check-nan: false
[2023-07-23 00:37:08] [config] cite: false
[2023-07-23 00:37:08] [config] clip-norm: 1
[2023-07-23 00:37:08] [config] cost-scaling:
[2023-07-23 00:37:08] [config]   - 256.f
[2023-07-23 00:37:08] [config]   - 1000
[2023-07-23 00:37:08] [config]   - 2.f
[2023-07-23 00:37:08] [config]   - 256.f
[2023-07-23 00:37:08] [config] cost-type: ce-sum
[2023-07-23 00:37:08] [config] cpu-threads: 0
[2023-07-23 00:37:08] [config] data-threads: 8
[2023-07-23 00:37:08] [config] data-weighting: ""
[2023-07-23 00:37:08] [config] data-weighting-type: sentence
[2023-07-23 00:37:08] [config] dec-cell: gru
[2023-07-23 00:37:08] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:08] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:08] [config] dec-depth: 1
[2023-07-23 00:37:08] [config] devices:
[2023-07-23 00:37:08] [config]   - 0
[2023-07-23 00:37:08] [config] dim-emb: 512
[2023-07-23 00:37:08] [config] dim-rnn: 1024
[2023-07-23 00:37:08] [config] dim-vocabs:
[2023-07-23 00:37:08] [config]   - 16384
[2023-07-23 00:37:08] [config]   - 16384
[2023-07-23 00:37:08] [config] disp-first: 0
[2023-07-23 00:37:08] [config] disp-freq: 1000u
[2023-07-23 00:37:08] [config] disp-label-counts: true
[2023-07-23 00:37:08] [config] dropout-rnn: 0
[2023-07-23 00:37:08] [config] dropout-src: 0
[2023-07-23 00:37:08] [config] dropout-trg: 0
[2023-07-23 00:37:08] [config] dump-config: ""
[2023-07-23 00:37:08] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] early-stopping: 200
[2023-07-23 00:37:08] [config] early-stopping-on: first
[2023-07-23 00:37:08] [config] embedding-fix-src: false
[2023-07-23 00:37:08] [config] embedding-fix-trg: false
[2023-07-23 00:37:08] [config] embedding-normalization: false
[2023-07-23 00:37:08] [config] embedding-vectors:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] enc-cell: tanh
[2023-07-23 00:37:08] [config] enc-cell-depth: 1
[2023-07-23 00:37:08] [config] enc-depth: 1
[2023-07-23 00:37:08] [config] enc-type: bidirectional
[2023-07-23 00:37:08] [config] english-title-case-every: 0
[2023-07-23 00:37:08] [config] exponential-smoothing: 0
[2023-07-23 00:37:08] [config] factor-weight: 1
[2023-07-23 00:37:08] [config] factors-combine: sum
[2023-07-23 00:37:08] [config] factors-dim-emb: 0
[2023-07-23 00:37:08] [config] gradient-checkpointing: false
[2023-07-23 00:37:08] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:08] [config] guided-alignment: none
[2023-07-23 00:37:08] [config] guided-alignment-cost: mse
[2023-07-23 00:37:08] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:08] [config] ignore-model-config: false
[2023-07-23 00:37:08] [config] input-types:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] interpolate-env-vars: false
[2023-07-23 00:37:08] [config] keep-best: false
[2023-07-23 00:37:08] [config] label-smoothing: 0
[2023-07-23 00:37:08] [config] layer-normalization: false
[2023-07-23 00:37:08] [config] learn-rate: 0.0001
[2023-07-23 00:37:08] [config] lemma-dependency: ""
[2023-07-23 00:37:08] [config] lemma-dim-emb: 0
[2023-07-23 00:37:08] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:08] [config] log-level: info
[2023-07-23 00:37:08] [config] log-time-zone: ""
[2023-07-23 00:37:08] [config] logical-epoch:
[2023-07-23 00:37:08] [config]   - 1e
[2023-07-23 00:37:08] [config]   - 0
[2023-07-23 00:37:08] [config] lr-decay: 0
[2023-07-23 00:37:08] [config] lr-decay-freq: 50000
[2023-07-23 00:37:08] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:08] [config]   - 0
[2023-07-23 00:37:08] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:08] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:08] [config] lr-decay-start:
[2023-07-23 00:37:08] [config]   - 10
[2023-07-23 00:37:08] [config]   - 1
[2023-07-23 00:37:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:08] [config] lr-report: false
[2023-07-23 00:37:08] [config] lr-warmup: 0
[2023-07-23 00:37:08] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:08] [config] lr-warmup-cycle: false
[2023-07-23 00:37:08] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:08] [config] max-length: 50
[2023-07-23 00:37:08] [config] max-length-crop: true
[2023-07-23 00:37:08] [config] max-length-factor: 3
[2023-07-23 00:37:08] [config] maxi-batch: 100
[2023-07-23 00:37:08] [config] maxi-batch-sort: trg
[2023-07-23 00:37:08] [config] mini-batch: 64
[2023-07-23 00:37:08] [config] mini-batch-fit: true
[2023-07-23 00:37:08] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:08] [config] mini-batch-round-up: true
[2023-07-23 00:37:08] [config] mini-batch-track-lr: false
[2023-07-23 00:37:08] [config] mini-batch-warmup: 0
[2023-07-23 00:37:08] [config] mini-batch-words: 0
[2023-07-23 00:37:08] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:08] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:08] [config] multi-loss-type: sum
[2023-07-23 00:37:08] [config] n-best: false
[2023-07-23 00:37:08] [config] no-nccl: false
[2023-07-23 00:37:08] [config] no-reload: false
[2023-07-23 00:37:08] [config] no-restore-corpus: false
[2023-07-23 00:37:08] [config] normalize: 0
[2023-07-23 00:37:08] [config] normalize-gradient: false
[2023-07-23 00:37:08] [config] num-devices: 0
[2023-07-23 00:37:08] [config] optimizer: adam
[2023-07-23 00:37:08] [config] optimizer-delay: 1
[2023-07-23 00:37:08] [config] optimizer-params:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] output-omit-bias: false
[2023-07-23 00:37:08] [config] overwrite: true
[2023-07-23 00:37:08] [config] precision:
[2023-07-23 00:37:08] [config]   - float16
[2023-07-23 00:37:08] [config]   - float32
[2023-07-23 00:37:08] [config] pretrained-model: ""
[2023-07-23 00:37:08] [config] quantize-biases: false
[2023-07-23 00:37:08] [config] quantize-bits: 0
[2023-07-23 00:37:08] [config] quantize-log-based: false
[2023-07-23 00:37:08] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:08] [config] quiet: false
[2023-07-23 00:37:08] [config] quiet-translation: true
[2023-07-23 00:37:08] [config] relative-paths: false
[2023-07-23 00:37:08] [config] right-left: false
[2023-07-23 00:37:08] [config] save-freq: 10000u
[2023-07-23 00:37:08] [config] seed: 1234
[2023-07-23 00:37:08] [config] sentencepiece-alphas:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:08] [config] sentencepiece-options: ""
[2023-07-23 00:37:08] [config] sharding: global
[2023-07-23 00:37:08] [config] shuffle: data
[2023-07-23 00:37:08] [config] shuffle-in-ram: false
[2023-07-23 00:37:08] [config] sigterm: save-and-exit
[2023-07-23 00:37:08] [config] skip: false
[2023-07-23 00:37:08] [config] sqlite: ""
[2023-07-23 00:37:08] [config] sqlite-drop: false
[2023-07-23 00:37:08] [config] sync-freq: 200u
[2023-07-23 00:37:08] [config] sync-sgd: false
[2023-07-23 00:37:08] [config] tempdir: /tmp
[2023-07-23 00:37:08] [config] tied-embeddings: false
[2023-07-23 00:37:08] [config] tied-embeddings-all: true
[2023-07-23 00:37:08] [config] tied-embeddings-src: false
[2023-07-23 00:37:08] [config] train-embedder-rank:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] train-sets:
[2023-07-23 00:37:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:08] [config] transformer-aan-activation: swish
[2023-07-23 00:37:08] [config] transformer-aan-depth: 2
[2023-07-23 00:37:08] [config] transformer-aan-nogate: false
[2023-07-23 00:37:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:08] [config] transformer-depth-scaling: false
[2023-07-23 00:37:08] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:08] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:08] [config] transformer-dropout: 0
[2023-07-23 00:37:08] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:08] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:08] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:08] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:08] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:08] [config] transformer-heads: 8
[2023-07-23 00:37:08] [config] transformer-no-projection: false
[2023-07-23 00:37:08] [config] transformer-pool: false
[2023-07-23 00:37:08] [config] transformer-postprocess: dan
[2023-07-23 00:37:08] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:08] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:08] [config] transformer-preprocess: ""
[2023-07-23 00:37:08] [config] transformer-tied-layers:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:08] [config] tsv: false
[2023-07-23 00:37:08] [config] tsv-fields: 0
[2023-07-23 00:37:08] [config] type: amun
[2023-07-23 00:37:08] [config] ulr: false
[2023-07-23 00:37:08] [config] ulr-dim-emb: 0
[2023-07-23 00:37:08] [config] ulr-dropout: 0
[2023-07-23 00:37:08] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:08] [config] ulr-query-vectors: ""
[2023-07-23 00:37:08] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:08] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:08] [config] unlikelihood-loss: false
[2023-07-23 00:37:08] [config] valid-freq: 50000000
[2023-07-23 00:37:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:08] [config] valid-max-length: 1000
[2023-07-23 00:37:08] [config] valid-metrics:
[2023-07-23 00:37:08] [config]   - cross-entropy
[2023-07-23 00:37:08] [config]   - translation
[2023-07-23 00:37:08] [config] valid-mini-batch: 32
[2023-07-23 00:37:08] [config] valid-reset-stalled: false
[2023-07-23 00:37:08] [config] valid-script-args:
[2023-07-23 00:37:08] [config]   []
[2023-07-23 00:37:08] [config] valid-script-path: ""
[2023-07-23 00:37:08] [config] valid-sets:
[2023-07-23 00:37:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:08] [config] vocabs:
[2023-07-23 00:37:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:08] [config] word-penalty: 0
[2023-07-23 00:37:08] [config] word-scores: false
[2023-07-23 00:37:08] [config] workspace: 5500
[2023-07-23 00:37:08] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:08] [training] Using single-device training
[2023-07-23 00:37:09] Synced seed 1234
[2023-07-23 00:37:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:09] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:09] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:09] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:09] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:10] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:10] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x562b2cdf0692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x562b2cd31da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x562b2cd361a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x562b2cd3d2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x562b2cee9a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x562b2ceeaa53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x562b2cec3bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x562b2c9c5108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x562b2c8e72c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x562b2c89eb9c]    main                                               + 0x3c
[0x7f90678890b3]    __libc_start_main                                  + 0xf3
[0x562b2c8e5cbe]    _start                                             + 0x2e

[2023-07-23 00:37:13] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:13] [marian] Running on node23.datos.cluster.uy as process 7587 with command line:
[2023-07-23 00:37:13] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:13] [config] after: 0e
[2023-07-23 00:37:13] [config] after-batches: 0
[2023-07-23 00:37:13] [config] after-epochs: 160
[2023-07-23 00:37:13] [config] all-caps-every: 0
[2023-07-23 00:37:13] [config] allow-unk: false
[2023-07-23 00:37:13] [config] authors: false
[2023-07-23 00:37:13] [config] beam-size: 12
[2023-07-23 00:37:13] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:13] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:13] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:13] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:13] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:13] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:13] [config] build-info: ""
[2023-07-23 00:37:13] [config] check-gradient-nan: false
[2023-07-23 00:37:13] [config] check-nan: false
[2023-07-23 00:37:13] [config] cite: false
[2023-07-23 00:37:13] [config] clip-norm: 1
[2023-07-23 00:37:13] [config] cost-scaling:
[2023-07-23 00:37:13] [config]   - 256.f
[2023-07-23 00:37:13] [config]   - 1000
[2023-07-23 00:37:13] [config]   - 2.f
[2023-07-23 00:37:13] [config]   - 256.f
[2023-07-23 00:37:13] [config] cost-type: ce-sum
[2023-07-23 00:37:13] [config] cpu-threads: 0
[2023-07-23 00:37:13] [config] data-threads: 8
[2023-07-23 00:37:13] [config] data-weighting: ""
[2023-07-23 00:37:13] [config] data-weighting-type: sentence
[2023-07-23 00:37:13] [config] dec-cell: gru
[2023-07-23 00:37:13] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:13] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:13] [config] dec-depth: 1
[2023-07-23 00:37:13] [config] devices:
[2023-07-23 00:37:13] [config]   - 0
[2023-07-23 00:37:13] [config] dim-emb: 512
[2023-07-23 00:37:13] [config] dim-rnn: 1024
[2023-07-23 00:37:13] [config] dim-vocabs:
[2023-07-23 00:37:13] [config]   - 16384
[2023-07-23 00:37:13] [config]   - 16384
[2023-07-23 00:37:13] [config] disp-first: 0
[2023-07-23 00:37:13] [config] disp-freq: 1000u
[2023-07-23 00:37:13] [config] disp-label-counts: true
[2023-07-23 00:37:13] [config] dropout-rnn: 0
[2023-07-23 00:37:13] [config] dropout-src: 0
[2023-07-23 00:37:13] [config] dropout-trg: 0
[2023-07-23 00:37:13] [config] dump-config: ""
[2023-07-23 00:37:13] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] early-stopping: 200
[2023-07-23 00:37:13] [config] early-stopping-on: first
[2023-07-23 00:37:13] [config] embedding-fix-src: false
[2023-07-23 00:37:13] [config] embedding-fix-trg: false
[2023-07-23 00:37:13] [config] embedding-normalization: false
[2023-07-23 00:37:13] [config] embedding-vectors:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] enc-cell: tanh
[2023-07-23 00:37:13] [config] enc-cell-depth: 1
[2023-07-23 00:37:13] [config] enc-depth: 1
[2023-07-23 00:37:13] [config] enc-type: bidirectional
[2023-07-23 00:37:13] [config] english-title-case-every: 0
[2023-07-23 00:37:13] [config] exponential-smoothing: 0
[2023-07-23 00:37:13] [config] factor-weight: 1
[2023-07-23 00:37:13] [config] factors-combine: sum
[2023-07-23 00:37:13] [config] factors-dim-emb: 0
[2023-07-23 00:37:13] [config] gradient-checkpointing: false
[2023-07-23 00:37:13] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:13] [config] guided-alignment: none
[2023-07-23 00:37:13] [config] guided-alignment-cost: mse
[2023-07-23 00:37:13] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:13] [config] ignore-model-config: false
[2023-07-23 00:37:13] [config] input-types:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] interpolate-env-vars: false
[2023-07-23 00:37:13] [config] keep-best: false
[2023-07-23 00:37:13] [config] label-smoothing: 0
[2023-07-23 00:37:13] [config] layer-normalization: false
[2023-07-23 00:37:13] [config] learn-rate: 0.0001
[2023-07-23 00:37:13] [config] lemma-dependency: ""
[2023-07-23 00:37:13] [config] lemma-dim-emb: 0
[2023-07-23 00:37:13] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:13] [config] log-level: info
[2023-07-23 00:37:13] [config] log-time-zone: ""
[2023-07-23 00:37:13] [config] logical-epoch:
[2023-07-23 00:37:13] [config]   - 1e
[2023-07-23 00:37:13] [config]   - 0
[2023-07-23 00:37:13] [config] lr-decay: 0
[2023-07-23 00:37:13] [config] lr-decay-freq: 50000
[2023-07-23 00:37:13] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:13] [config]   - 0
[2023-07-23 00:37:13] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:13] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:13] [config] lr-decay-start:
[2023-07-23 00:37:13] [config]   - 10
[2023-07-23 00:37:13] [config]   - 1
[2023-07-23 00:37:13] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:13] [config] lr-report: false
[2023-07-23 00:37:13] [config] lr-warmup: 0
[2023-07-23 00:37:13] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:13] [config] lr-warmup-cycle: false
[2023-07-23 00:37:13] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:13] [config] max-length: 50
[2023-07-23 00:37:13] [config] max-length-crop: true
[2023-07-23 00:37:13] [config] max-length-factor: 3
[2023-07-23 00:37:13] [config] maxi-batch: 100
[2023-07-23 00:37:13] [config] maxi-batch-sort: trg
[2023-07-23 00:37:13] [config] mini-batch: 64
[2023-07-23 00:37:13] [config] mini-batch-fit: true
[2023-07-23 00:37:13] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:13] [config] mini-batch-round-up: true
[2023-07-23 00:37:13] [config] mini-batch-track-lr: false
[2023-07-23 00:37:13] [config] mini-batch-warmup: 0
[2023-07-23 00:37:13] [config] mini-batch-words: 0
[2023-07-23 00:37:13] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:13] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:13] [config] multi-loss-type: sum
[2023-07-23 00:37:13] [config] n-best: false
[2023-07-23 00:37:13] [config] no-nccl: false
[2023-07-23 00:37:13] [config] no-reload: false
[2023-07-23 00:37:13] [config] no-restore-corpus: false
[2023-07-23 00:37:13] [config] normalize: 0
[2023-07-23 00:37:13] [config] normalize-gradient: false
[2023-07-23 00:37:13] [config] num-devices: 0
[2023-07-23 00:37:13] [config] optimizer: adam
[2023-07-23 00:37:13] [config] optimizer-delay: 1
[2023-07-23 00:37:13] [config] optimizer-params:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] output-omit-bias: false
[2023-07-23 00:37:13] [config] overwrite: true
[2023-07-23 00:37:13] [config] precision:
[2023-07-23 00:37:13] [config]   - float16
[2023-07-23 00:37:13] [config]   - float32
[2023-07-23 00:37:13] [config] pretrained-model: ""
[2023-07-23 00:37:13] [config] quantize-biases: false
[2023-07-23 00:37:13] [config] quantize-bits: 0
[2023-07-23 00:37:13] [config] quantize-log-based: false
[2023-07-23 00:37:13] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:13] [config] quiet: false
[2023-07-23 00:37:13] [config] quiet-translation: true
[2023-07-23 00:37:13] [config] relative-paths: false
[2023-07-23 00:37:13] [config] right-left: false
[2023-07-23 00:37:13] [config] save-freq: 10000u
[2023-07-23 00:37:13] [config] seed: 1234
[2023-07-23 00:37:13] [config] sentencepiece-alphas:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:13] [config] sentencepiece-options: ""
[2023-07-23 00:37:13] [config] sharding: global
[2023-07-23 00:37:13] [config] shuffle: data
[2023-07-23 00:37:13] [config] shuffle-in-ram: false
[2023-07-23 00:37:13] [config] sigterm: save-and-exit
[2023-07-23 00:37:13] [config] skip: false
[2023-07-23 00:37:13] [config] sqlite: ""
[2023-07-23 00:37:13] [config] sqlite-drop: false
[2023-07-23 00:37:13] [config] sync-freq: 200u
[2023-07-23 00:37:13] [config] sync-sgd: false
[2023-07-23 00:37:13] [config] tempdir: /tmp
[2023-07-23 00:37:13] [config] tied-embeddings: false
[2023-07-23 00:37:13] [config] tied-embeddings-all: true
[2023-07-23 00:37:13] [config] tied-embeddings-src: false
[2023-07-23 00:37:13] [config] train-embedder-rank:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] train-sets:
[2023-07-23 00:37:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:13] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:13] [config] transformer-aan-activation: swish
[2023-07-23 00:37:13] [config] transformer-aan-depth: 2
[2023-07-23 00:37:13] [config] transformer-aan-nogate: false
[2023-07-23 00:37:13] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:13] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:13] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:13] [config] transformer-depth-scaling: false
[2023-07-23 00:37:13] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:13] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:13] [config] transformer-dropout: 0
[2023-07-23 00:37:13] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:13] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:13] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:13] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:13] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:13] [config] transformer-heads: 8
[2023-07-23 00:37:13] [config] transformer-no-projection: false
[2023-07-23 00:37:13] [config] transformer-pool: false
[2023-07-23 00:37:13] [config] transformer-postprocess: dan
[2023-07-23 00:37:13] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:13] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:13] [config] transformer-preprocess: ""
[2023-07-23 00:37:13] [config] transformer-tied-layers:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:13] [config] tsv: false
[2023-07-23 00:37:13] [config] tsv-fields: 0
[2023-07-23 00:37:13] [config] type: amun
[2023-07-23 00:37:13] [config] ulr: false
[2023-07-23 00:37:13] [config] ulr-dim-emb: 0
[2023-07-23 00:37:13] [config] ulr-dropout: 0
[2023-07-23 00:37:13] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:13] [config] ulr-query-vectors: ""
[2023-07-23 00:37:13] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:13] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:13] [config] unlikelihood-loss: false
[2023-07-23 00:37:13] [config] valid-freq: 50000000
[2023-07-23 00:37:13] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:13] [config] valid-max-length: 1000
[2023-07-23 00:37:13] [config] valid-metrics:
[2023-07-23 00:37:13] [config]   - cross-entropy
[2023-07-23 00:37:13] [config]   - translation
[2023-07-23 00:37:13] [config] valid-mini-batch: 32
[2023-07-23 00:37:13] [config] valid-reset-stalled: false
[2023-07-23 00:37:13] [config] valid-script-args:
[2023-07-23 00:37:13] [config]   []
[2023-07-23 00:37:13] [config] valid-script-path: ""
[2023-07-23 00:37:13] [config] valid-sets:
[2023-07-23 00:37:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:13] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:13] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:13] [config] vocabs:
[2023-07-23 00:37:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:13] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:13] [config] word-penalty: 0
[2023-07-23 00:37:13] [config] word-scores: false
[2023-07-23 00:37:13] [config] workspace: 5500
[2023-07-23 00:37:13] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:13] [training] Using single-device training
[2023-07-23 00:37:14] Synced seed 1234
[2023-07-23 00:37:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:14] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:15] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:15] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x5556eae3d692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x5556ead7eda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5556ead831a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5556ead8a2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5556eaf36a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5556eaf37a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5556eaf10bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5556eaa12108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5556ea9342c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5556ea8ebb9c]    main                                               + 0x3c
[0x7f58a5ef90b3]    __libc_start_main                                  + 0xf3
[0x5556ea932cbe]    _start                                             + 0x2e

[2023-07-23 00:37:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:19] [marian] Running on node23.datos.cluster.uy as process 7614 with command line:
[2023-07-23 00:37:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:19] [config] after: 0e
[2023-07-23 00:37:19] [config] after-batches: 0
[2023-07-23 00:37:19] [config] after-epochs: 170
[2023-07-23 00:37:19] [config] all-caps-every: 0
[2023-07-23 00:37:19] [config] allow-unk: false
[2023-07-23 00:37:19] [config] authors: false
[2023-07-23 00:37:19] [config] beam-size: 12
[2023-07-23 00:37:19] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:19] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:19] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:19] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:19] [config] build-info: ""
[2023-07-23 00:37:19] [config] check-gradient-nan: false
[2023-07-23 00:37:19] [config] check-nan: false
[2023-07-23 00:37:19] [config] cite: false
[2023-07-23 00:37:19] [config] clip-norm: 1
[2023-07-23 00:37:19] [config] cost-scaling:
[2023-07-23 00:37:19] [config]   - 256.f
[2023-07-23 00:37:19] [config]   - 1000
[2023-07-23 00:37:19] [config]   - 2.f
[2023-07-23 00:37:19] [config]   - 256.f
[2023-07-23 00:37:19] [config] cost-type: ce-sum
[2023-07-23 00:37:19] [config] cpu-threads: 0
[2023-07-23 00:37:19] [config] data-threads: 8
[2023-07-23 00:37:19] [config] data-weighting: ""
[2023-07-23 00:37:19] [config] data-weighting-type: sentence
[2023-07-23 00:37:19] [config] dec-cell: gru
[2023-07-23 00:37:19] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:19] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:19] [config] dec-depth: 1
[2023-07-23 00:37:19] [config] devices:
[2023-07-23 00:37:19] [config]   - 0
[2023-07-23 00:37:19] [config] dim-emb: 512
[2023-07-23 00:37:19] [config] dim-rnn: 1024
[2023-07-23 00:37:19] [config] dim-vocabs:
[2023-07-23 00:37:19] [config]   - 16384
[2023-07-23 00:37:19] [config]   - 16384
[2023-07-23 00:37:19] [config] disp-first: 0
[2023-07-23 00:37:19] [config] disp-freq: 1000u
[2023-07-23 00:37:19] [config] disp-label-counts: true
[2023-07-23 00:37:19] [config] dropout-rnn: 0
[2023-07-23 00:37:19] [config] dropout-src: 0
[2023-07-23 00:37:19] [config] dropout-trg: 0
[2023-07-23 00:37:19] [config] dump-config: ""
[2023-07-23 00:37:19] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] early-stopping: 200
[2023-07-23 00:37:19] [config] early-stopping-on: first
[2023-07-23 00:37:19] [config] embedding-fix-src: false
[2023-07-23 00:37:19] [config] embedding-fix-trg: false
[2023-07-23 00:37:19] [config] embedding-normalization: false
[2023-07-23 00:37:19] [config] embedding-vectors:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] enc-cell: tanh
[2023-07-23 00:37:19] [config] enc-cell-depth: 1
[2023-07-23 00:37:19] [config] enc-depth: 1
[2023-07-23 00:37:19] [config] enc-type: bidirectional
[2023-07-23 00:37:19] [config] english-title-case-every: 0
[2023-07-23 00:37:19] [config] exponential-smoothing: 0
[2023-07-23 00:37:19] [config] factor-weight: 1
[2023-07-23 00:37:19] [config] factors-combine: sum
[2023-07-23 00:37:19] [config] factors-dim-emb: 0
[2023-07-23 00:37:19] [config] gradient-checkpointing: false
[2023-07-23 00:37:19] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:19] [config] guided-alignment: none
[2023-07-23 00:37:19] [config] guided-alignment-cost: mse
[2023-07-23 00:37:19] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:19] [config] ignore-model-config: false
[2023-07-23 00:37:19] [config] input-types:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] interpolate-env-vars: false
[2023-07-23 00:37:19] [config] keep-best: false
[2023-07-23 00:37:19] [config] label-smoothing: 0
[2023-07-23 00:37:19] [config] layer-normalization: false
[2023-07-23 00:37:19] [config] learn-rate: 0.0001
[2023-07-23 00:37:19] [config] lemma-dependency: ""
[2023-07-23 00:37:19] [config] lemma-dim-emb: 0
[2023-07-23 00:37:19] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:19] [config] log-level: info
[2023-07-23 00:37:19] [config] log-time-zone: ""
[2023-07-23 00:37:19] [config] logical-epoch:
[2023-07-23 00:37:19] [config]   - 1e
[2023-07-23 00:37:19] [config]   - 0
[2023-07-23 00:37:19] [config] lr-decay: 0
[2023-07-23 00:37:19] [config] lr-decay-freq: 50000
[2023-07-23 00:37:19] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:19] [config]   - 0
[2023-07-23 00:37:19] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:19] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:19] [config] lr-decay-start:
[2023-07-23 00:37:19] [config]   - 10
[2023-07-23 00:37:19] [config]   - 1
[2023-07-23 00:37:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:19] [config] lr-report: false
[2023-07-23 00:37:19] [config] lr-warmup: 0
[2023-07-23 00:37:19] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:19] [config] lr-warmup-cycle: false
[2023-07-23 00:37:19] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:19] [config] max-length: 50
[2023-07-23 00:37:19] [config] max-length-crop: true
[2023-07-23 00:37:19] [config] max-length-factor: 3
[2023-07-23 00:37:19] [config] maxi-batch: 100
[2023-07-23 00:37:19] [config] maxi-batch-sort: trg
[2023-07-23 00:37:19] [config] mini-batch: 64
[2023-07-23 00:37:19] [config] mini-batch-fit: true
[2023-07-23 00:37:19] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:19] [config] mini-batch-round-up: true
[2023-07-23 00:37:19] [config] mini-batch-track-lr: false
[2023-07-23 00:37:19] [config] mini-batch-warmup: 0
[2023-07-23 00:37:19] [config] mini-batch-words: 0
[2023-07-23 00:37:19] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:19] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:19] [config] multi-loss-type: sum
[2023-07-23 00:37:19] [config] n-best: false
[2023-07-23 00:37:19] [config] no-nccl: false
[2023-07-23 00:37:19] [config] no-reload: false
[2023-07-23 00:37:19] [config] no-restore-corpus: false
[2023-07-23 00:37:19] [config] normalize: 0
[2023-07-23 00:37:19] [config] normalize-gradient: false
[2023-07-23 00:37:19] [config] num-devices: 0
[2023-07-23 00:37:19] [config] optimizer: adam
[2023-07-23 00:37:19] [config] optimizer-delay: 1
[2023-07-23 00:37:19] [config] optimizer-params:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] output-omit-bias: false
[2023-07-23 00:37:19] [config] overwrite: true
[2023-07-23 00:37:19] [config] precision:
[2023-07-23 00:37:19] [config]   - float16
[2023-07-23 00:37:19] [config]   - float32
[2023-07-23 00:37:19] [config] pretrained-model: ""
[2023-07-23 00:37:19] [config] quantize-biases: false
[2023-07-23 00:37:19] [config] quantize-bits: 0
[2023-07-23 00:37:19] [config] quantize-log-based: false
[2023-07-23 00:37:19] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:19] [config] quiet: false
[2023-07-23 00:37:19] [config] quiet-translation: true
[2023-07-23 00:37:19] [config] relative-paths: false
[2023-07-23 00:37:19] [config] right-left: false
[2023-07-23 00:37:19] [config] save-freq: 10000u
[2023-07-23 00:37:19] [config] seed: 1234
[2023-07-23 00:37:19] [config] sentencepiece-alphas:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:19] [config] sentencepiece-options: ""
[2023-07-23 00:37:19] [config] sharding: global
[2023-07-23 00:37:19] [config] shuffle: data
[2023-07-23 00:37:19] [config] shuffle-in-ram: false
[2023-07-23 00:37:19] [config] sigterm: save-and-exit
[2023-07-23 00:37:19] [config] skip: false
[2023-07-23 00:37:19] [config] sqlite: ""
[2023-07-23 00:37:19] [config] sqlite-drop: false
[2023-07-23 00:37:19] [config] sync-freq: 200u
[2023-07-23 00:37:19] [config] sync-sgd: false
[2023-07-23 00:37:19] [config] tempdir: /tmp
[2023-07-23 00:37:19] [config] tied-embeddings: false
[2023-07-23 00:37:19] [config] tied-embeddings-all: true
[2023-07-23 00:37:19] [config] tied-embeddings-src: false
[2023-07-23 00:37:19] [config] train-embedder-rank:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] train-sets:
[2023-07-23 00:37:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:19] [config] transformer-aan-activation: swish
[2023-07-23 00:37:19] [config] transformer-aan-depth: 2
[2023-07-23 00:37:19] [config] transformer-aan-nogate: false
[2023-07-23 00:37:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:19] [config] transformer-depth-scaling: false
[2023-07-23 00:37:19] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:19] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:19] [config] transformer-dropout: 0
[2023-07-23 00:37:19] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:19] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:19] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:19] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:19] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:19] [config] transformer-heads: 8
[2023-07-23 00:37:19] [config] transformer-no-projection: false
[2023-07-23 00:37:19] [config] transformer-pool: false
[2023-07-23 00:37:19] [config] transformer-postprocess: dan
[2023-07-23 00:37:19] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:19] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:19] [config] transformer-preprocess: ""
[2023-07-23 00:37:19] [config] transformer-tied-layers:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:19] [config] tsv: false
[2023-07-23 00:37:19] [config] tsv-fields: 0
[2023-07-23 00:37:19] [config] type: amun
[2023-07-23 00:37:19] [config] ulr: false
[2023-07-23 00:37:19] [config] ulr-dim-emb: 0
[2023-07-23 00:37:19] [config] ulr-dropout: 0
[2023-07-23 00:37:19] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:19] [config] ulr-query-vectors: ""
[2023-07-23 00:37:19] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:19] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:19] [config] unlikelihood-loss: false
[2023-07-23 00:37:19] [config] valid-freq: 50000000
[2023-07-23 00:37:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:19] [config] valid-max-length: 1000
[2023-07-23 00:37:19] [config] valid-metrics:
[2023-07-23 00:37:19] [config]   - cross-entropy
[2023-07-23 00:37:19] [config]   - translation
[2023-07-23 00:37:19] [config] valid-mini-batch: 32
[2023-07-23 00:37:19] [config] valid-reset-stalled: false
[2023-07-23 00:37:19] [config] valid-script-args:
[2023-07-23 00:37:19] [config]   []
[2023-07-23 00:37:19] [config] valid-script-path: ""
[2023-07-23 00:37:19] [config] valid-sets:
[2023-07-23 00:37:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:19] [config] vocabs:
[2023-07-23 00:37:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:19] [config] word-penalty: 0
[2023-07-23 00:37:19] [config] word-scores: false
[2023-07-23 00:37:19] [config] workspace: 5500
[2023-07-23 00:37:19] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:19] [training] Using single-device training
[2023-07-23 00:37:19] Synced seed 1234
[2023-07-23 00:37:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:20] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:20] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x556372ea2692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x556372de3da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x556372de81a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x556372def2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x556372f9ba0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x556372f9ca53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x556372f75bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x556372a77108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5563729992c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x556372950b9c]    main                                               + 0x3c
[0x7f166fc750b3]    __libc_start_main                                  + 0xf3
[0x556372997cbe]    _start                                             + 0x2e

[2023-07-23 00:37:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:23] [marian] Running on node23.datos.cluster.uy as process 7641 with command line:
[2023-07-23 00:37:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:23] [config] after: 0e
[2023-07-23 00:37:23] [config] after-batches: 0
[2023-07-23 00:37:23] [config] after-epochs: 180
[2023-07-23 00:37:23] [config] all-caps-every: 0
[2023-07-23 00:37:23] [config] allow-unk: false
[2023-07-23 00:37:23] [config] authors: false
[2023-07-23 00:37:23] [config] beam-size: 12
[2023-07-23 00:37:23] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:23] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:23] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:23] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:23] [config] build-info: ""
[2023-07-23 00:37:23] [config] check-gradient-nan: false
[2023-07-23 00:37:23] [config] check-nan: false
[2023-07-23 00:37:23] [config] cite: false
[2023-07-23 00:37:23] [config] clip-norm: 1
[2023-07-23 00:37:23] [config] cost-scaling:
[2023-07-23 00:37:23] [config]   - 256.f
[2023-07-23 00:37:23] [config]   - 1000
[2023-07-23 00:37:23] [config]   - 2.f
[2023-07-23 00:37:23] [config]   - 256.f
[2023-07-23 00:37:23] [config] cost-type: ce-sum
[2023-07-23 00:37:23] [config] cpu-threads: 0
[2023-07-23 00:37:23] [config] data-threads: 8
[2023-07-23 00:37:23] [config] data-weighting: ""
[2023-07-23 00:37:23] [config] data-weighting-type: sentence
[2023-07-23 00:37:23] [config] dec-cell: gru
[2023-07-23 00:37:23] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:23] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:23] [config] dec-depth: 1
[2023-07-23 00:37:23] [config] devices:
[2023-07-23 00:37:23] [config]   - 0
[2023-07-23 00:37:23] [config] dim-emb: 512
[2023-07-23 00:37:23] [config] dim-rnn: 1024
[2023-07-23 00:37:23] [config] dim-vocabs:
[2023-07-23 00:37:23] [config]   - 16384
[2023-07-23 00:37:23] [config]   - 16384
[2023-07-23 00:37:23] [config] disp-first: 0
[2023-07-23 00:37:23] [config] disp-freq: 1000u
[2023-07-23 00:37:23] [config] disp-label-counts: true
[2023-07-23 00:37:23] [config] dropout-rnn: 0
[2023-07-23 00:37:23] [config] dropout-src: 0
[2023-07-23 00:37:23] [config] dropout-trg: 0
[2023-07-23 00:37:23] [config] dump-config: ""
[2023-07-23 00:37:23] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] early-stopping: 200
[2023-07-23 00:37:23] [config] early-stopping-on: first
[2023-07-23 00:37:23] [config] embedding-fix-src: false
[2023-07-23 00:37:23] [config] embedding-fix-trg: false
[2023-07-23 00:37:23] [config] embedding-normalization: false
[2023-07-23 00:37:23] [config] embedding-vectors:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] enc-cell: tanh
[2023-07-23 00:37:23] [config] enc-cell-depth: 1
[2023-07-23 00:37:23] [config] enc-depth: 1
[2023-07-23 00:37:23] [config] enc-type: bidirectional
[2023-07-23 00:37:23] [config] english-title-case-every: 0
[2023-07-23 00:37:23] [config] exponential-smoothing: 0
[2023-07-23 00:37:23] [config] factor-weight: 1
[2023-07-23 00:37:23] [config] factors-combine: sum
[2023-07-23 00:37:23] [config] factors-dim-emb: 0
[2023-07-23 00:37:23] [config] gradient-checkpointing: false
[2023-07-23 00:37:23] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:23] [config] guided-alignment: none
[2023-07-23 00:37:23] [config] guided-alignment-cost: mse
[2023-07-23 00:37:23] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:23] [config] ignore-model-config: false
[2023-07-23 00:37:23] [config] input-types:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] interpolate-env-vars: false
[2023-07-23 00:37:23] [config] keep-best: false
[2023-07-23 00:37:23] [config] label-smoothing: 0
[2023-07-23 00:37:23] [config] layer-normalization: false
[2023-07-23 00:37:23] [config] learn-rate: 0.0001
[2023-07-23 00:37:23] [config] lemma-dependency: ""
[2023-07-23 00:37:23] [config] lemma-dim-emb: 0
[2023-07-23 00:37:23] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:23] [config] log-level: info
[2023-07-23 00:37:23] [config] log-time-zone: ""
[2023-07-23 00:37:23] [config] logical-epoch:
[2023-07-23 00:37:23] [config]   - 1e
[2023-07-23 00:37:23] [config]   - 0
[2023-07-23 00:37:23] [config] lr-decay: 0
[2023-07-23 00:37:23] [config] lr-decay-freq: 50000
[2023-07-23 00:37:23] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:23] [config]   - 0
[2023-07-23 00:37:23] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:23] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:23] [config] lr-decay-start:
[2023-07-23 00:37:23] [config]   - 10
[2023-07-23 00:37:23] [config]   - 1
[2023-07-23 00:37:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:23] [config] lr-report: false
[2023-07-23 00:37:23] [config] lr-warmup: 0
[2023-07-23 00:37:23] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:23] [config] lr-warmup-cycle: false
[2023-07-23 00:37:23] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:23] [config] max-length: 50
[2023-07-23 00:37:23] [config] max-length-crop: true
[2023-07-23 00:37:23] [config] max-length-factor: 3
[2023-07-23 00:37:23] [config] maxi-batch: 100
[2023-07-23 00:37:23] [config] maxi-batch-sort: trg
[2023-07-23 00:37:23] [config] mini-batch: 64
[2023-07-23 00:37:23] [config] mini-batch-fit: true
[2023-07-23 00:37:23] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:23] [config] mini-batch-round-up: true
[2023-07-23 00:37:23] [config] mini-batch-track-lr: false
[2023-07-23 00:37:23] [config] mini-batch-warmup: 0
[2023-07-23 00:37:23] [config] mini-batch-words: 0
[2023-07-23 00:37:23] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:23] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:23] [config] multi-loss-type: sum
[2023-07-23 00:37:23] [config] n-best: false
[2023-07-23 00:37:23] [config] no-nccl: false
[2023-07-23 00:37:23] [config] no-reload: false
[2023-07-23 00:37:23] [config] no-restore-corpus: false
[2023-07-23 00:37:23] [config] normalize: 0
[2023-07-23 00:37:23] [config] normalize-gradient: false
[2023-07-23 00:37:23] [config] num-devices: 0
[2023-07-23 00:37:23] [config] optimizer: adam
[2023-07-23 00:37:23] [config] optimizer-delay: 1
[2023-07-23 00:37:23] [config] optimizer-params:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] output-omit-bias: false
[2023-07-23 00:37:23] [config] overwrite: true
[2023-07-23 00:37:23] [config] precision:
[2023-07-23 00:37:23] [config]   - float16
[2023-07-23 00:37:23] [config]   - float32
[2023-07-23 00:37:23] [config] pretrained-model: ""
[2023-07-23 00:37:23] [config] quantize-biases: false
[2023-07-23 00:37:23] [config] quantize-bits: 0
[2023-07-23 00:37:23] [config] quantize-log-based: false
[2023-07-23 00:37:23] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:23] [config] quiet: false
[2023-07-23 00:37:23] [config] quiet-translation: true
[2023-07-23 00:37:23] [config] relative-paths: false
[2023-07-23 00:37:23] [config] right-left: false
[2023-07-23 00:37:23] [config] save-freq: 10000u
[2023-07-23 00:37:23] [config] seed: 1234
[2023-07-23 00:37:23] [config] sentencepiece-alphas:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:23] [config] sentencepiece-options: ""
[2023-07-23 00:37:23] [config] sharding: global
[2023-07-23 00:37:23] [config] shuffle: data
[2023-07-23 00:37:23] [config] shuffle-in-ram: false
[2023-07-23 00:37:23] [config] sigterm: save-and-exit
[2023-07-23 00:37:23] [config] skip: false
[2023-07-23 00:37:23] [config] sqlite: ""
[2023-07-23 00:37:23] [config] sqlite-drop: false
[2023-07-23 00:37:23] [config] sync-freq: 200u
[2023-07-23 00:37:23] [config] sync-sgd: false
[2023-07-23 00:37:23] [config] tempdir: /tmp
[2023-07-23 00:37:23] [config] tied-embeddings: false
[2023-07-23 00:37:23] [config] tied-embeddings-all: true
[2023-07-23 00:37:23] [config] tied-embeddings-src: false
[2023-07-23 00:37:23] [config] train-embedder-rank:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] train-sets:
[2023-07-23 00:37:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:23] [config] transformer-aan-activation: swish
[2023-07-23 00:37:23] [config] transformer-aan-depth: 2
[2023-07-23 00:37:23] [config] transformer-aan-nogate: false
[2023-07-23 00:37:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:23] [config] transformer-depth-scaling: false
[2023-07-23 00:37:23] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:23] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:23] [config] transformer-dropout: 0
[2023-07-23 00:37:23] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:23] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:23] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:23] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:23] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:23] [config] transformer-heads: 8
[2023-07-23 00:37:23] [config] transformer-no-projection: false
[2023-07-23 00:37:23] [config] transformer-pool: false
[2023-07-23 00:37:23] [config] transformer-postprocess: dan
[2023-07-23 00:37:23] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:23] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:23] [config] transformer-preprocess: ""
[2023-07-23 00:37:23] [config] transformer-tied-layers:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:23] [config] tsv: false
[2023-07-23 00:37:23] [config] tsv-fields: 0
[2023-07-23 00:37:23] [config] type: amun
[2023-07-23 00:37:23] [config] ulr: false
[2023-07-23 00:37:23] [config] ulr-dim-emb: 0
[2023-07-23 00:37:23] [config] ulr-dropout: 0
[2023-07-23 00:37:23] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:23] [config] ulr-query-vectors: ""
[2023-07-23 00:37:23] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:23] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:23] [config] unlikelihood-loss: false
[2023-07-23 00:37:23] [config] valid-freq: 50000000
[2023-07-23 00:37:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:23] [config] valid-max-length: 1000
[2023-07-23 00:37:23] [config] valid-metrics:
[2023-07-23 00:37:23] [config]   - cross-entropy
[2023-07-23 00:37:23] [config]   - translation
[2023-07-23 00:37:23] [config] valid-mini-batch: 32
[2023-07-23 00:37:23] [config] valid-reset-stalled: false
[2023-07-23 00:37:23] [config] valid-script-args:
[2023-07-23 00:37:23] [config]   []
[2023-07-23 00:37:23] [config] valid-script-path: ""
[2023-07-23 00:37:23] [config] valid-sets:
[2023-07-23 00:37:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:23] [config] vocabs:
[2023-07-23 00:37:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:23] [config] word-penalty: 0
[2023-07-23 00:37:23] [config] word-scores: false
[2023-07-23 00:37:23] [config] workspace: 5500
[2023-07-23 00:37:23] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:23] [training] Using single-device training
[2023-07-23 00:37:24] Synced seed 1234
[2023-07-23 00:37:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:25] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:25] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x5576ff02e692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x5576fef6fda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x5576fef741a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x5576fef7b2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x5576ff127a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x5576ff128a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x5576ff101bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x5576fec03108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x5576feb252c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x5576feadcb9c]    main                                               + 0x3c
[0x7f356047f0b3]    __libc_start_main                                  + 0xf3
[0x5576feb23cbe]    _start                                             + 0x2e

[2023-07-23 00:37:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:28] [marian] Running on node23.datos.cluster.uy as process 7670 with command line:
[2023-07-23 00:37:28] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:28] [config] after: 0e
[2023-07-23 00:37:28] [config] after-batches: 0
[2023-07-23 00:37:28] [config] after-epochs: 190
[2023-07-23 00:37:28] [config] all-caps-every: 0
[2023-07-23 00:37:28] [config] allow-unk: false
[2023-07-23 00:37:28] [config] authors: false
[2023-07-23 00:37:28] [config] beam-size: 12
[2023-07-23 00:37:28] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:28] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:28] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:28] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:28] [config] build-info: ""
[2023-07-23 00:37:28] [config] check-gradient-nan: false
[2023-07-23 00:37:28] [config] check-nan: false
[2023-07-23 00:37:28] [config] cite: false
[2023-07-23 00:37:28] [config] clip-norm: 1
[2023-07-23 00:37:28] [config] cost-scaling:
[2023-07-23 00:37:28] [config]   - 256.f
[2023-07-23 00:37:28] [config]   - 1000
[2023-07-23 00:37:28] [config]   - 2.f
[2023-07-23 00:37:28] [config]   - 256.f
[2023-07-23 00:37:28] [config] cost-type: ce-sum
[2023-07-23 00:37:28] [config] cpu-threads: 0
[2023-07-23 00:37:28] [config] data-threads: 8
[2023-07-23 00:37:28] [config] data-weighting: ""
[2023-07-23 00:37:28] [config] data-weighting-type: sentence
[2023-07-23 00:37:28] [config] dec-cell: gru
[2023-07-23 00:37:28] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:28] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:28] [config] dec-depth: 1
[2023-07-23 00:37:28] [config] devices:
[2023-07-23 00:37:28] [config]   - 0
[2023-07-23 00:37:28] [config] dim-emb: 512
[2023-07-23 00:37:28] [config] dim-rnn: 1024
[2023-07-23 00:37:28] [config] dim-vocabs:
[2023-07-23 00:37:28] [config]   - 16384
[2023-07-23 00:37:28] [config]   - 16384
[2023-07-23 00:37:28] [config] disp-first: 0
[2023-07-23 00:37:28] [config] disp-freq: 1000u
[2023-07-23 00:37:28] [config] disp-label-counts: true
[2023-07-23 00:37:28] [config] dropout-rnn: 0
[2023-07-23 00:37:28] [config] dropout-src: 0
[2023-07-23 00:37:28] [config] dropout-trg: 0
[2023-07-23 00:37:28] [config] dump-config: ""
[2023-07-23 00:37:28] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] early-stopping: 200
[2023-07-23 00:37:28] [config] early-stopping-on: first
[2023-07-23 00:37:28] [config] embedding-fix-src: false
[2023-07-23 00:37:28] [config] embedding-fix-trg: false
[2023-07-23 00:37:28] [config] embedding-normalization: false
[2023-07-23 00:37:28] [config] embedding-vectors:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] enc-cell: tanh
[2023-07-23 00:37:28] [config] enc-cell-depth: 1
[2023-07-23 00:37:28] [config] enc-depth: 1
[2023-07-23 00:37:28] [config] enc-type: bidirectional
[2023-07-23 00:37:28] [config] english-title-case-every: 0
[2023-07-23 00:37:28] [config] exponential-smoothing: 0
[2023-07-23 00:37:28] [config] factor-weight: 1
[2023-07-23 00:37:28] [config] factors-combine: sum
[2023-07-23 00:37:28] [config] factors-dim-emb: 0
[2023-07-23 00:37:28] [config] gradient-checkpointing: false
[2023-07-23 00:37:28] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:28] [config] guided-alignment: none
[2023-07-23 00:37:28] [config] guided-alignment-cost: mse
[2023-07-23 00:37:28] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:28] [config] ignore-model-config: false
[2023-07-23 00:37:28] [config] input-types:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] interpolate-env-vars: false
[2023-07-23 00:37:28] [config] keep-best: false
[2023-07-23 00:37:28] [config] label-smoothing: 0
[2023-07-23 00:37:28] [config] layer-normalization: false
[2023-07-23 00:37:28] [config] learn-rate: 0.0001
[2023-07-23 00:37:28] [config] lemma-dependency: ""
[2023-07-23 00:37:28] [config] lemma-dim-emb: 0
[2023-07-23 00:37:28] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:28] [config] log-level: info
[2023-07-23 00:37:28] [config] log-time-zone: ""
[2023-07-23 00:37:28] [config] logical-epoch:
[2023-07-23 00:37:28] [config]   - 1e
[2023-07-23 00:37:28] [config]   - 0
[2023-07-23 00:37:28] [config] lr-decay: 0
[2023-07-23 00:37:28] [config] lr-decay-freq: 50000
[2023-07-23 00:37:28] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:28] [config]   - 0
[2023-07-23 00:37:28] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:28] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:28] [config] lr-decay-start:
[2023-07-23 00:37:28] [config]   - 10
[2023-07-23 00:37:28] [config]   - 1
[2023-07-23 00:37:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:28] [config] lr-report: false
[2023-07-23 00:37:28] [config] lr-warmup: 0
[2023-07-23 00:37:28] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:28] [config] lr-warmup-cycle: false
[2023-07-23 00:37:28] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:28] [config] max-length: 50
[2023-07-23 00:37:28] [config] max-length-crop: true
[2023-07-23 00:37:28] [config] max-length-factor: 3
[2023-07-23 00:37:28] [config] maxi-batch: 100
[2023-07-23 00:37:28] [config] maxi-batch-sort: trg
[2023-07-23 00:37:28] [config] mini-batch: 64
[2023-07-23 00:37:28] [config] mini-batch-fit: true
[2023-07-23 00:37:28] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:28] [config] mini-batch-round-up: true
[2023-07-23 00:37:28] [config] mini-batch-track-lr: false
[2023-07-23 00:37:28] [config] mini-batch-warmup: 0
[2023-07-23 00:37:28] [config] mini-batch-words: 0
[2023-07-23 00:37:28] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:28] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:28] [config] multi-loss-type: sum
[2023-07-23 00:37:28] [config] n-best: false
[2023-07-23 00:37:28] [config] no-nccl: false
[2023-07-23 00:37:28] [config] no-reload: false
[2023-07-23 00:37:28] [config] no-restore-corpus: false
[2023-07-23 00:37:28] [config] normalize: 0
[2023-07-23 00:37:28] [config] normalize-gradient: false
[2023-07-23 00:37:28] [config] num-devices: 0
[2023-07-23 00:37:28] [config] optimizer: adam
[2023-07-23 00:37:28] [config] optimizer-delay: 1
[2023-07-23 00:37:28] [config] optimizer-params:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] output-omit-bias: false
[2023-07-23 00:37:28] [config] overwrite: true
[2023-07-23 00:37:28] [config] precision:
[2023-07-23 00:37:28] [config]   - float16
[2023-07-23 00:37:28] [config]   - float32
[2023-07-23 00:37:28] [config] pretrained-model: ""
[2023-07-23 00:37:28] [config] quantize-biases: false
[2023-07-23 00:37:28] [config] quantize-bits: 0
[2023-07-23 00:37:28] [config] quantize-log-based: false
[2023-07-23 00:37:28] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:28] [config] quiet: false
[2023-07-23 00:37:28] [config] quiet-translation: true
[2023-07-23 00:37:28] [config] relative-paths: false
[2023-07-23 00:37:28] [config] right-left: false
[2023-07-23 00:37:28] [config] save-freq: 10000u
[2023-07-23 00:37:28] [config] seed: 1234
[2023-07-23 00:37:28] [config] sentencepiece-alphas:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:28] [config] sentencepiece-options: ""
[2023-07-23 00:37:28] [config] sharding: global
[2023-07-23 00:37:28] [config] shuffle: data
[2023-07-23 00:37:28] [config] shuffle-in-ram: false
[2023-07-23 00:37:28] [config] sigterm: save-and-exit
[2023-07-23 00:37:28] [config] skip: false
[2023-07-23 00:37:28] [config] sqlite: ""
[2023-07-23 00:37:28] [config] sqlite-drop: false
[2023-07-23 00:37:28] [config] sync-freq: 200u
[2023-07-23 00:37:28] [config] sync-sgd: false
[2023-07-23 00:37:28] [config] tempdir: /tmp
[2023-07-23 00:37:28] [config] tied-embeddings: false
[2023-07-23 00:37:28] [config] tied-embeddings-all: true
[2023-07-23 00:37:28] [config] tied-embeddings-src: false
[2023-07-23 00:37:28] [config] train-embedder-rank:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] train-sets:
[2023-07-23 00:37:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:28] [config] transformer-aan-activation: swish
[2023-07-23 00:37:28] [config] transformer-aan-depth: 2
[2023-07-23 00:37:28] [config] transformer-aan-nogate: false
[2023-07-23 00:37:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:28] [config] transformer-depth-scaling: false
[2023-07-23 00:37:28] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:28] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:28] [config] transformer-dropout: 0
[2023-07-23 00:37:28] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:28] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:28] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:28] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:28] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:28] [config] transformer-heads: 8
[2023-07-23 00:37:28] [config] transformer-no-projection: false
[2023-07-23 00:37:28] [config] transformer-pool: false
[2023-07-23 00:37:28] [config] transformer-postprocess: dan
[2023-07-23 00:37:28] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:28] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:28] [config] transformer-preprocess: ""
[2023-07-23 00:37:28] [config] transformer-tied-layers:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:28] [config] tsv: false
[2023-07-23 00:37:28] [config] tsv-fields: 0
[2023-07-23 00:37:28] [config] type: amun
[2023-07-23 00:37:28] [config] ulr: false
[2023-07-23 00:37:28] [config] ulr-dim-emb: 0
[2023-07-23 00:37:28] [config] ulr-dropout: 0
[2023-07-23 00:37:28] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:28] [config] ulr-query-vectors: ""
[2023-07-23 00:37:28] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:28] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:28] [config] unlikelihood-loss: false
[2023-07-23 00:37:28] [config] valid-freq: 50000000
[2023-07-23 00:37:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:28] [config] valid-max-length: 1000
[2023-07-23 00:37:28] [config] valid-metrics:
[2023-07-23 00:37:28] [config]   - cross-entropy
[2023-07-23 00:37:28] [config]   - translation
[2023-07-23 00:37:28] [config] valid-mini-batch: 32
[2023-07-23 00:37:28] [config] valid-reset-stalled: false
[2023-07-23 00:37:28] [config] valid-script-args:
[2023-07-23 00:37:28] [config]   []
[2023-07-23 00:37:28] [config] valid-script-path: ""
[2023-07-23 00:37:28] [config] valid-sets:
[2023-07-23 00:37:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:28] [config] vocabs:
[2023-07-23 00:37:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:28] [config] word-penalty: 0
[2023-07-23 00:37:28] [config] word-scores: false
[2023-07-23 00:37:28] [config] workspace: 5500
[2023-07-23 00:37:28] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:28] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:28] [training] Using single-device training
[2023-07-23 00:37:29] Synced seed 1234
[2023-07-23 00:37:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:29] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:29] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:29] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:29] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:29] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:30] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:30] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:30] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55bf09574692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55bf094b5da8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55bf094ba1a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55bf094c12ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55bf0966da0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55bf0966ea53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55bf09647bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55bf09149108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55bf0906b2c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55bf09022b9c]    main                                               + 0x3c
[0x7f6b8816b0b3]    __libc_start_main                                  + 0xf3
[0x55bf09069cbe]    _start                                             + 0x2e

[2023-07-23 00:37:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:34] [marian] Running on node23.datos.cluster.uy as process 7698 with command line:
[2023-07-23 00:37:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-log /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded_node23.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --enc-cell tanh
[2023-07-23 00:37:34] [config] after: 0e
[2023-07-23 00:37:34] [config] after-batches: 0
[2023-07-23 00:37:34] [config] after-epochs: 200
[2023-07-23 00:37:34] [config] all-caps-every: 0
[2023-07-23 00:37:34] [config] allow-unk: false
[2023-07-23 00:37:34] [config] authors: false
[2023-07-23 00:37:34] [config] beam-size: 12
[2023-07-23 00:37:34] [config] bert-class-symbol: "[CLS]"
[2023-07-23 00:37:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-23 00:37:34] [config] bert-masking-fraction: 0.15
[2023-07-23 00:37:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-23 00:37:34] [config] bert-train-type-embeddings: true
[2023-07-23 00:37:34] [config] bert-type-vocab-size: 2
[2023-07-23 00:37:34] [config] build-info: ""
[2023-07-23 00:37:34] [config] check-gradient-nan: false
[2023-07-23 00:37:34] [config] check-nan: false
[2023-07-23 00:37:34] [config] cite: false
[2023-07-23 00:37:34] [config] clip-norm: 1
[2023-07-23 00:37:34] [config] cost-scaling:
[2023-07-23 00:37:34] [config]   - 256.f
[2023-07-23 00:37:34] [config]   - 1000
[2023-07-23 00:37:34] [config]   - 2.f
[2023-07-23 00:37:34] [config]   - 256.f
[2023-07-23 00:37:34] [config] cost-type: ce-sum
[2023-07-23 00:37:34] [config] cpu-threads: 0
[2023-07-23 00:37:34] [config] data-threads: 8
[2023-07-23 00:37:34] [config] data-weighting: ""
[2023-07-23 00:37:34] [config] data-weighting-type: sentence
[2023-07-23 00:37:34] [config] dec-cell: gru
[2023-07-23 00:37:34] [config] dec-cell-base-depth: 2
[2023-07-23 00:37:34] [config] dec-cell-high-depth: 1
[2023-07-23 00:37:34] [config] dec-depth: 1
[2023-07-23 00:37:34] [config] devices:
[2023-07-23 00:37:34] [config]   - 0
[2023-07-23 00:37:34] [config] dim-emb: 512
[2023-07-23 00:37:34] [config] dim-rnn: 1024
[2023-07-23 00:37:34] [config] dim-vocabs:
[2023-07-23 00:37:34] [config]   - 16384
[2023-07-23 00:37:34] [config]   - 16384
[2023-07-23 00:37:34] [config] disp-first: 0
[2023-07-23 00:37:34] [config] disp-freq: 1000u
[2023-07-23 00:37:34] [config] disp-label-counts: true
[2023-07-23 00:37:34] [config] dropout-rnn: 0
[2023-07-23 00:37:34] [config] dropout-src: 0
[2023-07-23 00:37:34] [config] dropout-trg: 0
[2023-07-23 00:37:34] [config] dump-config: ""
[2023-07-23 00:37:34] [config] dynamic-gradient-scaling:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] early-stopping: 200
[2023-07-23 00:37:34] [config] early-stopping-on: first
[2023-07-23 00:37:34] [config] embedding-fix-src: false
[2023-07-23 00:37:34] [config] embedding-fix-trg: false
[2023-07-23 00:37:34] [config] embedding-normalization: false
[2023-07-23 00:37:34] [config] embedding-vectors:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] enc-cell: tanh
[2023-07-23 00:37:34] [config] enc-cell-depth: 1
[2023-07-23 00:37:34] [config] enc-depth: 1
[2023-07-23 00:37:34] [config] enc-type: bidirectional
[2023-07-23 00:37:34] [config] english-title-case-every: 0
[2023-07-23 00:37:34] [config] exponential-smoothing: 0
[2023-07-23 00:37:34] [config] factor-weight: 1
[2023-07-23 00:37:34] [config] factors-combine: sum
[2023-07-23 00:37:34] [config] factors-dim-emb: 0
[2023-07-23 00:37:34] [config] gradient-checkpointing: false
[2023-07-23 00:37:34] [config] gradient-norm-average-window: 100
[2023-07-23 00:37:34] [config] guided-alignment: none
[2023-07-23 00:37:34] [config] guided-alignment-cost: mse
[2023-07-23 00:37:34] [config] guided-alignment-weight: 0.1
[2023-07-23 00:37:34] [config] ignore-model-config: false
[2023-07-23 00:37:34] [config] input-types:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] interpolate-env-vars: false
[2023-07-23 00:37:34] [config] keep-best: false
[2023-07-23 00:37:34] [config] label-smoothing: 0
[2023-07-23 00:37:34] [config] layer-normalization: false
[2023-07-23 00:37:34] [config] learn-rate: 0.0001
[2023-07-23 00:37:34] [config] lemma-dependency: ""
[2023-07-23 00:37:34] [config] lemma-dim-emb: 0
[2023-07-23 00:37:34] [config] log: /docker/home/marianmt/logs/marian/log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:34] [config] log-level: info
[2023-07-23 00:37:34] [config] log-time-zone: ""
[2023-07-23 00:37:34] [config] logical-epoch:
[2023-07-23 00:37:34] [config]   - 1e
[2023-07-23 00:37:34] [config]   - 0
[2023-07-23 00:37:34] [config] lr-decay: 0
[2023-07-23 00:37:34] [config] lr-decay-freq: 50000
[2023-07-23 00:37:34] [config] lr-decay-inv-sqrt:
[2023-07-23 00:37:34] [config]   - 0
[2023-07-23 00:37:34] [config] lr-decay-repeat-warmup: false
[2023-07-23 00:37:34] [config] lr-decay-reset-optimizer: false
[2023-07-23 00:37:34] [config] lr-decay-start:
[2023-07-23 00:37:34] [config]   - 10
[2023-07-23 00:37:34] [config]   - 1
[2023-07-23 00:37:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-23 00:37:34] [config] lr-report: false
[2023-07-23 00:37:34] [config] lr-warmup: 0
[2023-07-23 00:37:34] [config] lr-warmup-at-reload: false
[2023-07-23 00:37:34] [config] lr-warmup-cycle: false
[2023-07-23 00:37:34] [config] lr-warmup-start-rate: 0
[2023-07-23 00:37:34] [config] max-length: 50
[2023-07-23 00:37:34] [config] max-length-crop: true
[2023-07-23 00:37:34] [config] max-length-factor: 3
[2023-07-23 00:37:34] [config] maxi-batch: 100
[2023-07-23 00:37:34] [config] maxi-batch-sort: trg
[2023-07-23 00:37:34] [config] mini-batch: 64
[2023-07-23 00:37:34] [config] mini-batch-fit: true
[2023-07-23 00:37:34] [config] mini-batch-fit-step: 10
[2023-07-23 00:37:34] [config] mini-batch-round-up: true
[2023-07-23 00:37:34] [config] mini-batch-track-lr: false
[2023-07-23 00:37:34] [config] mini-batch-warmup: 0
[2023-07-23 00:37:34] [config] mini-batch-words: 0
[2023-07-23 00:37:34] [config] mini-batch-words-ref: 0
[2023-07-23 00:37:34] [config] model: /docker/home/marianmt/artifacts/models/model_es_gn_test_grid_lvl2_july_grid_from6_to13/es_gn_test_grid_lvl2_july_grid_from6_to13_enc-cell_tanh.npz
[2023-07-23 00:37:34] [config] multi-loss-type: sum
[2023-07-23 00:37:34] [config] n-best: false
[2023-07-23 00:37:34] [config] no-nccl: false
[2023-07-23 00:37:34] [config] no-reload: false
[2023-07-23 00:37:34] [config] no-restore-corpus: false
[2023-07-23 00:37:34] [config] normalize: 0
[2023-07-23 00:37:34] [config] normalize-gradient: false
[2023-07-23 00:37:34] [config] num-devices: 0
[2023-07-23 00:37:34] [config] optimizer: adam
[2023-07-23 00:37:34] [config] optimizer-delay: 1
[2023-07-23 00:37:34] [config] optimizer-params:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] output-omit-bias: false
[2023-07-23 00:37:34] [config] overwrite: true
[2023-07-23 00:37:34] [config] precision:
[2023-07-23 00:37:34] [config]   - float16
[2023-07-23 00:37:34] [config]   - float32
[2023-07-23 00:37:34] [config] pretrained-model: ""
[2023-07-23 00:37:34] [config] quantize-biases: false
[2023-07-23 00:37:34] [config] quantize-bits: 0
[2023-07-23 00:37:34] [config] quantize-log-based: false
[2023-07-23 00:37:34] [config] quantize-optimization-steps: 0
[2023-07-23 00:37:34] [config] quiet: false
[2023-07-23 00:37:34] [config] quiet-translation: true
[2023-07-23 00:37:34] [config] relative-paths: false
[2023-07-23 00:37:34] [config] right-left: false
[2023-07-23 00:37:34] [config] save-freq: 10000u
[2023-07-23 00:37:34] [config] seed: 1234
[2023-07-23 00:37:34] [config] sentencepiece-alphas:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] sentencepiece-max-lines: 2000000
[2023-07-23 00:37:34] [config] sentencepiece-options: ""
[2023-07-23 00:37:34] [config] sharding: global
[2023-07-23 00:37:34] [config] shuffle: data
[2023-07-23 00:37:34] [config] shuffle-in-ram: false
[2023-07-23 00:37:34] [config] sigterm: save-and-exit
[2023-07-23 00:37:34] [config] skip: false
[2023-07-23 00:37:34] [config] sqlite: ""
[2023-07-23 00:37:34] [config] sqlite-drop: false
[2023-07-23 00:37:34] [config] sync-freq: 200u
[2023-07-23 00:37:34] [config] sync-sgd: false
[2023-07-23 00:37:34] [config] tempdir: /tmp
[2023-07-23 00:37:34] [config] tied-embeddings: false
[2023-07-23 00:37:34] [config] tied-embeddings-all: true
[2023-07-23 00:37:34] [config] tied-embeddings-src: false
[2023-07-23 00:37:34] [config] train-embedder-rank:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] train-sets:
[2023-07-23 00:37:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-23 00:37:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-23 00:37:34] [config] transformer-aan-activation: swish
[2023-07-23 00:37:34] [config] transformer-aan-depth: 2
[2023-07-23 00:37:34] [config] transformer-aan-nogate: false
[2023-07-23 00:37:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-23 00:37:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-23 00:37:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-23 00:37:34] [config] transformer-depth-scaling: false
[2023-07-23 00:37:34] [config] transformer-dim-aan: 2048
[2023-07-23 00:37:34] [config] transformer-dim-ffn: 2048
[2023-07-23 00:37:34] [config] transformer-dropout: 0
[2023-07-23 00:37:34] [config] transformer-dropout-attention: 0
[2023-07-23 00:37:34] [config] transformer-dropout-ffn: 0
[2023-07-23 00:37:34] [config] transformer-ffn-activation: swish
[2023-07-23 00:37:34] [config] transformer-ffn-depth: 2
[2023-07-23 00:37:34] [config] transformer-guided-alignment-layer: last
[2023-07-23 00:37:34] [config] transformer-heads: 8
[2023-07-23 00:37:34] [config] transformer-no-projection: false
[2023-07-23 00:37:34] [config] transformer-pool: false
[2023-07-23 00:37:34] [config] transformer-postprocess: dan
[2023-07-23 00:37:34] [config] transformer-postprocess-emb: d
[2023-07-23 00:37:34] [config] transformer-postprocess-top: ""
[2023-07-23 00:37:34] [config] transformer-preprocess: ""
[2023-07-23 00:37:34] [config] transformer-tied-layers:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] transformer-train-position-embeddings: false
[2023-07-23 00:37:34] [config] tsv: false
[2023-07-23 00:37:34] [config] tsv-fields: 0
[2023-07-23 00:37:34] [config] type: amun
[2023-07-23 00:37:34] [config] ulr: false
[2023-07-23 00:37:34] [config] ulr-dim-emb: 0
[2023-07-23 00:37:34] [config] ulr-dropout: 0
[2023-07-23 00:37:34] [config] ulr-keys-vectors: ""
[2023-07-23 00:37:34] [config] ulr-query-vectors: ""
[2023-07-23 00:37:34] [config] ulr-softmax-temperature: 1
[2023-07-23 00:37:34] [config] ulr-trainable-transformation: false
[2023-07-23 00:37:34] [config] unlikelihood-loss: false
[2023-07-23 00:37:34] [config] valid-freq: 50000000
[2023-07-23 00:37:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_es_gn_test_grid_lvl2_july_grid_from6_to13.log
[2023-07-23 00:37:34] [config] valid-max-length: 1000
[2023-07-23 00:37:34] [config] valid-metrics:
[2023-07-23 00:37:34] [config]   - cross-entropy
[2023-07-23 00:37:34] [config]   - translation
[2023-07-23 00:37:34] [config] valid-mini-batch: 32
[2023-07-23 00:37:34] [config] valid-reset-stalled: false
[2023-07-23 00:37:34] [config] valid-script-args:
[2023-07-23 00:37:34] [config]   []
[2023-07-23 00:37:34] [config] valid-script-path: ""
[2023-07-23 00:37:34] [config] valid-sets:
[2023-07-23 00:37:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-23 00:37:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-23 00:37:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded_node23.txt
[2023-07-23 00:37:34] [config] vocabs:
[2023-07-23 00:37:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:34] [config] word-penalty: 0
[2023-07-23 00:37:34] [config] word-scores: false
[2023-07-23 00:37:34] [config] workspace: 5500
[2023-07-23 00:37:34] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-23 00:37:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:34] [training] Using single-device training
[2023-07-23 00:37:34] Synced seed 1234
[2023-07-23 00:37:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-23 00:37:34] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-23 00:37:34] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-23 00:37:34] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-23 00:37:34] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-23 00:37:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-23 00:37:34] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-23 00:37:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-23 00:37:36] Error: --type amun does not support other rnn cells than gru, use --type s2s
[2023-07-23 00:37:36] Error: Aborted from marian::Amun::Amun(marian::Ptr<marian::ExpressionGraph>, marian::Ptr<marian::Options>) in /marian/src/models/amun.h:30

[CALL STACK]
[0x55fc46f4d692]    marian::Amun::  Amun  (std::shared_ptr<marian::ExpressionGraph>,  std::shared_ptr<marian::Options>) + 0x17b2
[0x55fc46e8eda8]    marian::models::EncoderDecoderFactory::  construct  (std::shared_ptr<marian::ExpressionGraph>) + 0x118
[0x55fc46e931a6]    marian::models::  createBaseModelByType  (std::__cxx11::basic_string<char,std::char_traits<char>,std::allocator<char>>,  marian::models::usage,  std::shared_ptr<marian::Options>) + 0x736
[0x55fc46e9a2ba]    marian::models::  createCriterionFunctionFromOptions  (std::shared_ptr<marian::Options>,  marian::models::usage) + 0x9a
[0x55fc47046a0a]    marian::GraphGroup::  initGraphsAndOpts  ()        + 0x5da
[0x55fc47047a53]    marian::GraphGroup::  GraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x4a3
[0x55fc47020bee]    marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0x7e
[0x55fc46b22108]    marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x338
[0x55fc46a442c5]    mainTrainer  (int,  char**)                        + 0x3c5
[0x55fc469fbb9c]    main                                               + 0x3c
[0x7f34e513d0b3]    __libc_start_main                                  + 0xf3
[0x55fc46a42cbe]    _start                                             + 0x2e

