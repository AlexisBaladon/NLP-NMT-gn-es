[2023-07-19 08:39:47] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 08:39:47] [marian] Running on node18.datos.cluster.uy as process 34393 with command line:
[2023-07-19 08:39:47] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 08:39:47] [config] after: 0e
[2023-07-19 08:39:47] [config] after-batches: 0
[2023-07-19 08:39:47] [config] after-epochs: 10
[2023-07-19 08:39:47] [config] all-caps-every: 0
[2023-07-19 08:39:47] [config] allow-unk: false
[2023-07-19 08:39:47] [config] authors: false
[2023-07-19 08:39:47] [config] beam-size: 12
[2023-07-19 08:39:47] [config] bert-class-symbol: "[CLS]"
[2023-07-19 08:39:47] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 08:39:47] [config] bert-masking-fraction: 0.15
[2023-07-19 08:39:47] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 08:39:47] [config] bert-train-type-embeddings: true
[2023-07-19 08:39:47] [config] bert-type-vocab-size: 2
[2023-07-19 08:39:47] [config] build-info: ""
[2023-07-19 08:39:47] [config] check-gradient-nan: false
[2023-07-19 08:39:47] [config] check-nan: false
[2023-07-19 08:39:47] [config] cite: false
[2023-07-19 08:39:47] [config] clip-norm: 1
[2023-07-19 08:39:47] [config] cost-scaling:
[2023-07-19 08:39:47] [config]   - 256.f
[2023-07-19 08:39:47] [config]   - 1000
[2023-07-19 08:39:47] [config]   - 2.f
[2023-07-19 08:39:47] [config]   - 256.f
[2023-07-19 08:39:47] [config] cost-type: ce-sum
[2023-07-19 08:39:47] [config] cpu-threads: 0
[2023-07-19 08:39:47] [config] data-threads: 8
[2023-07-19 08:39:47] [config] data-weighting: ""
[2023-07-19 08:39:47] [config] data-weighting-type: sentence
[2023-07-19 08:39:47] [config] dec-cell: gru
[2023-07-19 08:39:47] [config] dec-cell-base-depth: 2
[2023-07-19 08:39:47] [config] dec-cell-high-depth: 1
[2023-07-19 08:39:47] [config] dec-depth: 1
[2023-07-19 08:39:47] [config] devices:
[2023-07-19 08:39:47] [config]   - 0
[2023-07-19 08:39:47] [config] dim-emb: 512
[2023-07-19 08:39:47] [config] dim-rnn: 1024
[2023-07-19 08:39:47] [config] dim-vocabs:
[2023-07-19 08:39:47] [config]   - 16384
[2023-07-19 08:39:47] [config]   - 16384
[2023-07-19 08:39:47] [config] disp-first: 0
[2023-07-19 08:39:47] [config] disp-freq: 1000u
[2023-07-19 08:39:47] [config] disp-label-counts: true
[2023-07-19 08:39:47] [config] dropout-rnn: 0
[2023-07-19 08:39:47] [config] dropout-src: 0
[2023-07-19 08:39:47] [config] dropout-trg: 0
[2023-07-19 08:39:47] [config] dump-config: ""
[2023-07-19 08:39:47] [config] dynamic-gradient-scaling:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] early-stopping: 200
[2023-07-19 08:39:47] [config] early-stopping-on: first
[2023-07-19 08:39:47] [config] embedding-fix-src: false
[2023-07-19 08:39:47] [config] embedding-fix-trg: false
[2023-07-19 08:39:47] [config] embedding-normalization: false
[2023-07-19 08:39:47] [config] embedding-vectors:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] enc-cell: gru
[2023-07-19 08:39:47] [config] enc-cell-depth: 1
[2023-07-19 08:39:47] [config] enc-depth: 1
[2023-07-19 08:39:47] [config] enc-type: bidirectional
[2023-07-19 08:39:47] [config] english-title-case-every: 0
[2023-07-19 08:39:47] [config] exponential-smoothing: 0
[2023-07-19 08:39:47] [config] factor-weight: 1
[2023-07-19 08:39:47] [config] factors-combine: sum
[2023-07-19 08:39:47] [config] factors-dim-emb: 0
[2023-07-19 08:39:47] [config] gradient-checkpointing: false
[2023-07-19 08:39:47] [config] gradient-norm-average-window: 100
[2023-07-19 08:39:47] [config] guided-alignment: none
[2023-07-19 08:39:47] [config] guided-alignment-cost: mse
[2023-07-19 08:39:47] [config] guided-alignment-weight: 0.1
[2023-07-19 08:39:47] [config] ignore-model-config: false
[2023-07-19 08:39:47] [config] input-types:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] interpolate-env-vars: false
[2023-07-19 08:39:47] [config] keep-best: false
[2023-07-19 08:39:47] [config] label-smoothing: 0
[2023-07-19 08:39:47] [config] layer-normalization: false
[2023-07-19 08:39:47] [config] learn-rate: 0.0001
[2023-07-19 08:39:47] [config] lemma-dependency: ""
[2023-07-19 08:39:47] [config] lemma-dim-emb: 0
[2023-07-19 08:39:47] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 08:39:47] [config] log-level: info
[2023-07-19 08:39:47] [config] log-time-zone: ""
[2023-07-19 08:39:47] [config] logical-epoch:
[2023-07-19 08:39:47] [config]   - 1e
[2023-07-19 08:39:47] [config]   - 0
[2023-07-19 08:39:47] [config] lr-decay: 0
[2023-07-19 08:39:47] [config] lr-decay-freq: 50000
[2023-07-19 08:39:47] [config] lr-decay-inv-sqrt:
[2023-07-19 08:39:47] [config]   - 0
[2023-07-19 08:39:47] [config] lr-decay-repeat-warmup: false
[2023-07-19 08:39:47] [config] lr-decay-reset-optimizer: false
[2023-07-19 08:39:47] [config] lr-decay-start:
[2023-07-19 08:39:47] [config]   - 10
[2023-07-19 08:39:47] [config]   - 1
[2023-07-19 08:39:47] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 08:39:47] [config] lr-report: false
[2023-07-19 08:39:47] [config] lr-warmup: 0
[2023-07-19 08:39:47] [config] lr-warmup-at-reload: false
[2023-07-19 08:39:47] [config] lr-warmup-cycle: false
[2023-07-19 08:39:47] [config] lr-warmup-start-rate: 0
[2023-07-19 08:39:47] [config] max-length: 200
[2023-07-19 08:39:47] [config] max-length-crop: true
[2023-07-19 08:39:47] [config] max-length-factor: 3
[2023-07-19 08:39:47] [config] maxi-batch: 100
[2023-07-19 08:39:47] [config] maxi-batch-sort: trg
[2023-07-19 08:39:47] [config] mini-batch: 64
[2023-07-19 08:39:47] [config] mini-batch-fit: true
[2023-07-19 08:39:47] [config] mini-batch-fit-step: 10
[2023-07-19 08:39:47] [config] mini-batch-round-up: true
[2023-07-19 08:39:47] [config] mini-batch-track-lr: false
[2023-07-19 08:39:47] [config] mini-batch-warmup: 0
[2023-07-19 08:39:47] [config] mini-batch-words: 0
[2023-07-19 08:39:47] [config] mini-batch-words-ref: 0
[2023-07-19 08:39:47] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 08:39:47] [config] multi-loss-type: sum
[2023-07-19 08:39:47] [config] n-best: false
[2023-07-19 08:39:47] [config] no-nccl: false
[2023-07-19 08:39:47] [config] no-reload: false
[2023-07-19 08:39:47] [config] no-restore-corpus: false
[2023-07-19 08:39:47] [config] normalize: 0
[2023-07-19 08:39:47] [config] normalize-gradient: false
[2023-07-19 08:39:47] [config] num-devices: 0
[2023-07-19 08:39:47] [config] optimizer: adam
[2023-07-19 08:39:47] [config] optimizer-delay: 1
[2023-07-19 08:39:47] [config] optimizer-params:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] output-omit-bias: false
[2023-07-19 08:39:47] [config] overwrite: true
[2023-07-19 08:39:47] [config] precision:
[2023-07-19 08:39:47] [config]   - float16
[2023-07-19 08:39:47] [config]   - float32
[2023-07-19 08:39:47] [config] pretrained-model: ""
[2023-07-19 08:39:47] [config] quantize-biases: false
[2023-07-19 08:39:47] [config] quantize-bits: 0
[2023-07-19 08:39:47] [config] quantize-log-based: false
[2023-07-19 08:39:47] [config] quantize-optimization-steps: 0
[2023-07-19 08:39:47] [config] quiet: false
[2023-07-19 08:39:47] [config] quiet-translation: true
[2023-07-19 08:39:47] [config] relative-paths: false
[2023-07-19 08:39:47] [config] right-left: false
[2023-07-19 08:39:47] [config] save-freq: 10000u
[2023-07-19 08:39:47] [config] seed: 1234
[2023-07-19 08:39:47] [config] sentencepiece-alphas:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] sentencepiece-max-lines: 2000000
[2023-07-19 08:39:47] [config] sentencepiece-options: ""
[2023-07-19 08:39:47] [config] sharding: global
[2023-07-19 08:39:47] [config] shuffle: data
[2023-07-19 08:39:47] [config] shuffle-in-ram: false
[2023-07-19 08:39:47] [config] sigterm: save-and-exit
[2023-07-19 08:39:47] [config] skip: false
[2023-07-19 08:39:47] [config] sqlite: ""
[2023-07-19 08:39:47] [config] sqlite-drop: false
[2023-07-19 08:39:47] [config] sync-freq: 200u
[2023-07-19 08:39:47] [config] sync-sgd: false
[2023-07-19 08:39:47] [config] tempdir: /tmp
[2023-07-19 08:39:47] [config] tied-embeddings: false
[2023-07-19 08:39:47] [config] tied-embeddings-all: true
[2023-07-19 08:39:47] [config] tied-embeddings-src: false
[2023-07-19 08:39:47] [config] train-embedder-rank:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] train-sets:
[2023-07-19 08:39:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 08:39:47] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 08:39:47] [config] transformer-aan-activation: swish
[2023-07-19 08:39:47] [config] transformer-aan-depth: 2
[2023-07-19 08:39:47] [config] transformer-aan-nogate: false
[2023-07-19 08:39:47] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 08:39:47] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 08:39:47] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 08:39:47] [config] transformer-depth-scaling: false
[2023-07-19 08:39:47] [config] transformer-dim-aan: 2048
[2023-07-19 08:39:47] [config] transformer-dim-ffn: 2048
[2023-07-19 08:39:47] [config] transformer-dropout: 0
[2023-07-19 08:39:47] [config] transformer-dropout-attention: 0
[2023-07-19 08:39:47] [config] transformer-dropout-ffn: 0
[2023-07-19 08:39:47] [config] transformer-ffn-activation: swish
[2023-07-19 08:39:47] [config] transformer-ffn-depth: 2
[2023-07-19 08:39:47] [config] transformer-guided-alignment-layer: last
[2023-07-19 08:39:47] [config] transformer-heads: 8
[2023-07-19 08:39:47] [config] transformer-no-projection: false
[2023-07-19 08:39:47] [config] transformer-pool: false
[2023-07-19 08:39:47] [config] transformer-postprocess: dan
[2023-07-19 08:39:47] [config] transformer-postprocess-emb: d
[2023-07-19 08:39:47] [config] transformer-postprocess-top: ""
[2023-07-19 08:39:47] [config] transformer-preprocess: ""
[2023-07-19 08:39:47] [config] transformer-tied-layers:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] transformer-train-position-embeddings: false
[2023-07-19 08:39:47] [config] tsv: false
[2023-07-19 08:39:47] [config] tsv-fields: 0
[2023-07-19 08:39:47] [config] type: amun
[2023-07-19 08:39:47] [config] ulr: false
[2023-07-19 08:39:47] [config] ulr-dim-emb: 0
[2023-07-19 08:39:47] [config] ulr-dropout: 0
[2023-07-19 08:39:47] [config] ulr-keys-vectors: ""
[2023-07-19 08:39:47] [config] ulr-query-vectors: ""
[2023-07-19 08:39:47] [config] ulr-softmax-temperature: 1
[2023-07-19 08:39:47] [config] ulr-trainable-transformation: false
[2023-07-19 08:39:47] [config] unlikelihood-loss: false
[2023-07-19 08:39:47] [config] valid-freq: 50000000
[2023-07-19 08:39:47] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 08:39:47] [config] valid-max-length: 1000
[2023-07-19 08:39:47] [config] valid-metrics:
[2023-07-19 08:39:47] [config]   - cross-entropy
[2023-07-19 08:39:47] [config]   - translation
[2023-07-19 08:39:47] [config] valid-mini-batch: 32
[2023-07-19 08:39:47] [config] valid-reset-stalled: false
[2023-07-19 08:39:47] [config] valid-script-args:
[2023-07-19 08:39:47] [config]   []
[2023-07-19 08:39:47] [config] valid-script-path: ""
[2023-07-19 08:39:47] [config] valid-sets:
[2023-07-19 08:39:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 08:39:47] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 08:39:47] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 08:39:47] [config] vocabs:
[2023-07-19 08:39:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 08:39:47] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 08:39:47] [config] word-penalty: 0
[2023-07-19 08:39:47] [config] word-scores: false
[2023-07-19 08:39:47] [config] workspace: 5500
[2023-07-19 08:39:47] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 08:39:47] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 08:39:47] [training] Using single-device training
[2023-07-19 08:39:47] Synced seed 1234
[2023-07-19 08:39:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 08:39:47] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 08:39:47] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 08:39:48] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 08:39:48] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 08:39:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 08:39:48] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 08:39:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 08:39:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 08:39:50] [comm] Using global sharding
[2023-07-19 08:39:50] [comm] NCCLCommunicators constructed successfully
[2023-07-19 08:39:50] [training] Using 1 GPUs
[2023-07-19 08:39:50] [logits] Applying loss function for 1 factor(s)
[2023-07-19 08:39:50] [memory] Reserving 80 MB, device gpu0
[2023-07-19 08:39:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 08:39:53] [memory] Reserving 80 MB, device gpu0
[2023-07-19 09:15:30] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 09:15:31] [valid] No post-processing script given for validating translator
[2023-07-19 09:15:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 09:15:31] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 09:15:31] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 09:15:31] [comm] Using global sharding
[2023-07-19 09:15:31] [comm] NCCLCommunicators constructed successfully
[2023-07-19 09:15:31] [training] Using 1 GPUs
[2023-07-19 09:15:31] Training started
[2023-07-19 09:15:31] [data] Shuffling data
[2023-07-19 09:15:31] [data] Done reading 20,192 sentences
[2023-07-19 09:15:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:15:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 09:15:31] [memory] Reserving 80 MB, device gpu0
[2023-07-19 09:15:33] [memory] Reserving 80 MB, device gpu0
[2023-07-19 09:15:42] Parameter type float16, optimization type float32, casting types true
[2023-07-19 09:15:42] Allocating memory for general optimizer shards
[2023-07-19 09:15:42] [memory] Reserving 322 MB, device gpu0
[2023-07-19 09:15:42] Allocating memory for Adam-specific shards
[2023-07-19 09:15:42] [memory] Reserving 322 MB, device gpu0
[2023-07-19 09:19:42] Seen 20,192 samples
[2023-07-19 09:19:42] Starting data epoch 2 in logical epoch 2
[2023-07-19 09:19:42] [data] Shuffling data
[2023-07-19 09:19:42] [data] Done reading 20,192 sentences
[2023-07-19 09:19:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:24:43] Seen 20,192 samples
[2023-07-19 09:24:43] Starting data epoch 3 in logical epoch 3
[2023-07-19 09:24:43] [data] Shuffling data
[2023-07-19 09:24:43] [data] Done reading 20,192 sentences
[2023-07-19 09:24:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:30:02] Seen 20,192 samples
[2023-07-19 09:30:02] Starting data epoch 4 in logical epoch 4
[2023-07-19 09:30:02] [data] Shuffling data
[2023-07-19 09:30:02] [data] Done reading 20,192 sentences
[2023-07-19 09:30:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:35:00] Seen 20,192 samples
[2023-07-19 09:35:00] Starting data epoch 5 in logical epoch 5
[2023-07-19 09:35:00] [data] Shuffling data
[2023-07-19 09:35:01] [data] Done reading 20,192 sentences
[2023-07-19 09:35:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:40:10] Seen 20,192 samples
[2023-07-19 09:40:10] Starting data epoch 6 in logical epoch 6
[2023-07-19 09:40:10] [data] Shuffling data
[2023-07-19 09:40:10] [data] Done reading 20,192 sentences
[2023-07-19 09:40:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:45:01] Seen 20,192 samples
[2023-07-19 09:45:01] Starting data epoch 7 in logical epoch 7
[2023-07-19 09:45:01] [data] Shuffling data
[2023-07-19 09:45:01] [data] Done reading 20,192 sentences
[2023-07-19 09:45:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:49:47] Seen 20,192 samples
[2023-07-19 09:49:47] Starting data epoch 8 in logical epoch 8
[2023-07-19 09:49:47] [data] Shuffling data
[2023-07-19 09:49:47] [data] Done reading 20,192 sentences
[2023-07-19 09:49:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 09:54:52] Seen 20,192 samples
[2023-07-19 09:54:52] Starting data epoch 9 in logical epoch 9
[2023-07-19 09:54:52] [data] Shuffling data
[2023-07-19 09:54:52] [data] Done reading 20,192 sentences
[2023-07-19 09:54:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 10:00:12] Seen 20,192 samples
[2023-07-19 10:00:12] Starting data epoch 10 in logical epoch 10
[2023-07-19 10:00:12] [data] Shuffling data
[2023-07-19 10:00:12] [data] Done reading 20,192 sentences
[2023-07-19 10:00:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 10:05:28] Seen 20,192 samples
[2023-07-19 10:05:28] Starting data epoch 11 in logical epoch 11
[2023-07-19 10:05:28] Training finished
[2023-07-19 10:05:39] [valid] Ep. 11 : Up. 385 : cross-entropy : 187.21 : new best
[2023-07-19 10:07:28] [valid] Ep. 11 : Up. 385 : translation : 0 : new best
[2023-07-19 10:07:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 10:07:31] Saving Adam parameters
[2023-07-19 10:07:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 10:07:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 10:07:40] [marian] Running on node18.datos.cluster.uy as process 40241 with command line:
[2023-07-19 10:07:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 10:07:40] [config] after: 0e
[2023-07-19 10:07:40] [config] after-batches: 0
[2023-07-19 10:07:40] [config] after-epochs: 20
[2023-07-19 10:07:40] [config] all-caps-every: 0
[2023-07-19 10:07:40] [config] allow-unk: false
[2023-07-19 10:07:40] [config] authors: false
[2023-07-19 10:07:40] [config] beam-size: 12
[2023-07-19 10:07:40] [config] bert-class-symbol: "[CLS]"
[2023-07-19 10:07:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 10:07:40] [config] bert-masking-fraction: 0.15
[2023-07-19 10:07:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 10:07:40] [config] bert-train-type-embeddings: true
[2023-07-19 10:07:40] [config] bert-type-vocab-size: 2
[2023-07-19 10:07:40] [config] build-info: ""
[2023-07-19 10:07:40] [config] check-gradient-nan: false
[2023-07-19 10:07:40] [config] check-nan: false
[2023-07-19 10:07:40] [config] cite: false
[2023-07-19 10:07:40] [config] clip-norm: 1
[2023-07-19 10:07:40] [config] cost-scaling:
[2023-07-19 10:07:40] [config]   - 256.f
[2023-07-19 10:07:40] [config]   - 1000
[2023-07-19 10:07:40] [config]   - 2.f
[2023-07-19 10:07:40] [config]   - 256.f
[2023-07-19 10:07:40] [config] cost-type: ce-sum
[2023-07-19 10:07:40] [config] cpu-threads: 0
[2023-07-19 10:07:40] [config] data-threads: 8
[2023-07-19 10:07:40] [config] data-weighting: ""
[2023-07-19 10:07:40] [config] data-weighting-type: sentence
[2023-07-19 10:07:40] [config] dec-cell: gru
[2023-07-19 10:07:40] [config] dec-cell-base-depth: 2
[2023-07-19 10:07:40] [config] dec-cell-high-depth: 1
[2023-07-19 10:07:40] [config] dec-depth: 1
[2023-07-19 10:07:40] [config] devices:
[2023-07-19 10:07:40] [config]   - 0
[2023-07-19 10:07:40] [config] dim-emb: 512
[2023-07-19 10:07:40] [config] dim-rnn: 1024
[2023-07-19 10:07:40] [config] dim-vocabs:
[2023-07-19 10:07:40] [config]   - 16384
[2023-07-19 10:07:40] [config]   - 16384
[2023-07-19 10:07:40] [config] disp-first: 0
[2023-07-19 10:07:40] [config] disp-freq: 1000u
[2023-07-19 10:07:40] [config] disp-label-counts: true
[2023-07-19 10:07:40] [config] dropout-rnn: 0
[2023-07-19 10:07:40] [config] dropout-src: 0
[2023-07-19 10:07:40] [config] dropout-trg: 0
[2023-07-19 10:07:40] [config] dump-config: ""
[2023-07-19 10:07:40] [config] dynamic-gradient-scaling:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] early-stopping: 200
[2023-07-19 10:07:40] [config] early-stopping-on: first
[2023-07-19 10:07:40] [config] embedding-fix-src: false
[2023-07-19 10:07:40] [config] embedding-fix-trg: false
[2023-07-19 10:07:40] [config] embedding-normalization: false
[2023-07-19 10:07:40] [config] embedding-vectors:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] enc-cell: gru
[2023-07-19 10:07:40] [config] enc-cell-depth: 1
[2023-07-19 10:07:40] [config] enc-depth: 1
[2023-07-19 10:07:40] [config] enc-type: bidirectional
[2023-07-19 10:07:40] [config] english-title-case-every: 0
[2023-07-19 10:07:40] [config] exponential-smoothing: 0
[2023-07-19 10:07:40] [config] factor-weight: 1
[2023-07-19 10:07:40] [config] factors-combine: sum
[2023-07-19 10:07:40] [config] factors-dim-emb: 0
[2023-07-19 10:07:40] [config] gradient-checkpointing: false
[2023-07-19 10:07:40] [config] gradient-norm-average-window: 100
[2023-07-19 10:07:40] [config] guided-alignment: none
[2023-07-19 10:07:40] [config] guided-alignment-cost: mse
[2023-07-19 10:07:40] [config] guided-alignment-weight: 0.1
[2023-07-19 10:07:40] [config] ignore-model-config: false
[2023-07-19 10:07:40] [config] input-types:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] interpolate-env-vars: false
[2023-07-19 10:07:40] [config] keep-best: false
[2023-07-19 10:07:40] [config] label-smoothing: 0
[2023-07-19 10:07:40] [config] layer-normalization: false
[2023-07-19 10:07:40] [config] learn-rate: 0.0001
[2023-07-19 10:07:40] [config] lemma-dependency: ""
[2023-07-19 10:07:40] [config] lemma-dim-emb: 0
[2023-07-19 10:07:40] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 10:07:40] [config] log-level: info
[2023-07-19 10:07:40] [config] log-time-zone: ""
[2023-07-19 10:07:40] [config] logical-epoch:
[2023-07-19 10:07:40] [config]   - 1e
[2023-07-19 10:07:40] [config]   - 0
[2023-07-19 10:07:40] [config] lr-decay: 0
[2023-07-19 10:07:40] [config] lr-decay-freq: 50000
[2023-07-19 10:07:40] [config] lr-decay-inv-sqrt:
[2023-07-19 10:07:40] [config]   - 0
[2023-07-19 10:07:40] [config] lr-decay-repeat-warmup: false
[2023-07-19 10:07:40] [config] lr-decay-reset-optimizer: false
[2023-07-19 10:07:40] [config] lr-decay-start:
[2023-07-19 10:07:40] [config]   - 10
[2023-07-19 10:07:40] [config]   - 1
[2023-07-19 10:07:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 10:07:40] [config] lr-report: false
[2023-07-19 10:07:40] [config] lr-warmup: 0
[2023-07-19 10:07:40] [config] lr-warmup-at-reload: false
[2023-07-19 10:07:40] [config] lr-warmup-cycle: false
[2023-07-19 10:07:40] [config] lr-warmup-start-rate: 0
[2023-07-19 10:07:40] [config] max-length: 200
[2023-07-19 10:07:40] [config] max-length-crop: true
[2023-07-19 10:07:40] [config] max-length-factor: 3
[2023-07-19 10:07:40] [config] maxi-batch: 100
[2023-07-19 10:07:40] [config] maxi-batch-sort: trg
[2023-07-19 10:07:40] [config] mini-batch: 64
[2023-07-19 10:07:40] [config] mini-batch-fit: true
[2023-07-19 10:07:40] [config] mini-batch-fit-step: 10
[2023-07-19 10:07:40] [config] mini-batch-round-up: true
[2023-07-19 10:07:40] [config] mini-batch-track-lr: false
[2023-07-19 10:07:40] [config] mini-batch-warmup: 0
[2023-07-19 10:07:40] [config] mini-batch-words: 0
[2023-07-19 10:07:40] [config] mini-batch-words-ref: 0
[2023-07-19 10:07:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 10:07:40] [config] multi-loss-type: sum
[2023-07-19 10:07:40] [config] n-best: false
[2023-07-19 10:07:40] [config] no-nccl: false
[2023-07-19 10:07:40] [config] no-reload: false
[2023-07-19 10:07:40] [config] no-restore-corpus: false
[2023-07-19 10:07:40] [config] normalize: 0
[2023-07-19 10:07:40] [config] normalize-gradient: false
[2023-07-19 10:07:40] [config] num-devices: 0
[2023-07-19 10:07:40] [config] optimizer: adam
[2023-07-19 10:07:40] [config] optimizer-delay: 1
[2023-07-19 10:07:40] [config] optimizer-params:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] output-omit-bias: false
[2023-07-19 10:07:40] [config] overwrite: true
[2023-07-19 10:07:40] [config] precision:
[2023-07-19 10:07:40] [config]   - float16
[2023-07-19 10:07:40] [config]   - float32
[2023-07-19 10:07:40] [config] pretrained-model: ""
[2023-07-19 10:07:40] [config] quantize-biases: false
[2023-07-19 10:07:40] [config] quantize-bits: 0
[2023-07-19 10:07:40] [config] quantize-log-based: false
[2023-07-19 10:07:40] [config] quantize-optimization-steps: 0
[2023-07-19 10:07:40] [config] quiet: false
[2023-07-19 10:07:40] [config] quiet-translation: true
[2023-07-19 10:07:40] [config] relative-paths: false
[2023-07-19 10:07:40] [config] right-left: false
[2023-07-19 10:07:40] [config] save-freq: 10000u
[2023-07-19 10:07:40] [config] seed: 1234
[2023-07-19 10:07:40] [config] sentencepiece-alphas:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] sentencepiece-max-lines: 2000000
[2023-07-19 10:07:40] [config] sentencepiece-options: ""
[2023-07-19 10:07:40] [config] sharding: global
[2023-07-19 10:07:40] [config] shuffle: data
[2023-07-19 10:07:40] [config] shuffle-in-ram: false
[2023-07-19 10:07:40] [config] sigterm: save-and-exit
[2023-07-19 10:07:40] [config] skip: false
[2023-07-19 10:07:40] [config] sqlite: ""
[2023-07-19 10:07:40] [config] sqlite-drop: false
[2023-07-19 10:07:40] [config] sync-freq: 200u
[2023-07-19 10:07:40] [config] sync-sgd: false
[2023-07-19 10:07:40] [config] tempdir: /tmp
[2023-07-19 10:07:40] [config] tied-embeddings: false
[2023-07-19 10:07:40] [config] tied-embeddings-all: true
[2023-07-19 10:07:40] [config] tied-embeddings-src: false
[2023-07-19 10:07:40] [config] train-embedder-rank:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] train-sets:
[2023-07-19 10:07:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 10:07:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 10:07:40] [config] transformer-aan-activation: swish
[2023-07-19 10:07:40] [config] transformer-aan-depth: 2
[2023-07-19 10:07:40] [config] transformer-aan-nogate: false
[2023-07-19 10:07:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 10:07:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 10:07:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 10:07:40] [config] transformer-depth-scaling: false
[2023-07-19 10:07:40] [config] transformer-dim-aan: 2048
[2023-07-19 10:07:40] [config] transformer-dim-ffn: 2048
[2023-07-19 10:07:40] [config] transformer-dropout: 0
[2023-07-19 10:07:40] [config] transformer-dropout-attention: 0
[2023-07-19 10:07:40] [config] transformer-dropout-ffn: 0
[2023-07-19 10:07:40] [config] transformer-ffn-activation: swish
[2023-07-19 10:07:40] [config] transformer-ffn-depth: 2
[2023-07-19 10:07:40] [config] transformer-guided-alignment-layer: last
[2023-07-19 10:07:40] [config] transformer-heads: 8
[2023-07-19 10:07:40] [config] transformer-no-projection: false
[2023-07-19 10:07:40] [config] transformer-pool: false
[2023-07-19 10:07:40] [config] transformer-postprocess: dan
[2023-07-19 10:07:40] [config] transformer-postprocess-emb: d
[2023-07-19 10:07:40] [config] transformer-postprocess-top: ""
[2023-07-19 10:07:40] [config] transformer-preprocess: ""
[2023-07-19 10:07:40] [config] transformer-tied-layers:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] transformer-train-position-embeddings: false
[2023-07-19 10:07:40] [config] tsv: false
[2023-07-19 10:07:40] [config] tsv-fields: 0
[2023-07-19 10:07:40] [config] type: amun
[2023-07-19 10:07:40] [config] ulr: false
[2023-07-19 10:07:40] [config] ulr-dim-emb: 0
[2023-07-19 10:07:40] [config] ulr-dropout: 0
[2023-07-19 10:07:40] [config] ulr-keys-vectors: ""
[2023-07-19 10:07:40] [config] ulr-query-vectors: ""
[2023-07-19 10:07:40] [config] ulr-softmax-temperature: 1
[2023-07-19 10:07:40] [config] ulr-trainable-transformation: false
[2023-07-19 10:07:40] [config] unlikelihood-loss: false
[2023-07-19 10:07:40] [config] valid-freq: 50000000
[2023-07-19 10:07:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 10:07:40] [config] valid-max-length: 1000
[2023-07-19 10:07:40] [config] valid-metrics:
[2023-07-19 10:07:40] [config]   - cross-entropy
[2023-07-19 10:07:40] [config]   - translation
[2023-07-19 10:07:40] [config] valid-mini-batch: 32
[2023-07-19 10:07:40] [config] valid-reset-stalled: false
[2023-07-19 10:07:40] [config] valid-script-args:
[2023-07-19 10:07:40] [config]   []
[2023-07-19 10:07:40] [config] valid-script-path: ""
[2023-07-19 10:07:40] [config] valid-sets:
[2023-07-19 10:07:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 10:07:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 10:07:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 10:07:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 10:07:40] [config] vocabs:
[2023-07-19 10:07:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 10:07:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 10:07:40] [config] word-penalty: 0
[2023-07-19 10:07:40] [config] word-scores: false
[2023-07-19 10:07:40] [config] workspace: 5500
[2023-07-19 10:07:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 10:07:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 10:07:40] [training] Using single-device training
[2023-07-19 10:07:42] Synced seed 1234
[2023-07-19 10:07:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 10:07:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 10:07:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 10:07:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 10:07:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 10:07:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 10:07:42] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 10:07:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 10:07:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 10:07:43] [comm] Using global sharding
[2023-07-19 10:07:43] [comm] NCCLCommunicators constructed successfully
[2023-07-19 10:07:43] [training] Using 1 GPUs
[2023-07-19 10:07:44] [logits] Applying loss function for 1 factor(s)
[2023-07-19 10:07:44] [memory] Reserving 80 MB, device gpu0
[2023-07-19 10:07:44] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 10:07:44] [memory] Reserving 80 MB, device gpu0
[2023-07-19 10:47:24] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 10:47:24] [valid] No post-processing script given for validating translator
[2023-07-19 10:47:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 10:47:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 10:47:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 10:47:24] [comm] Using global sharding
[2023-07-19 10:47:24] [comm] NCCLCommunicators constructed successfully
[2023-07-19 10:47:24] [training] Using 1 GPUs
[2023-07-19 10:47:24] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 10:47:29] Allocating memory for general optimizer shards
[2023-07-19 10:47:29] [memory] Reserving 322 MB, device gpu0
[2023-07-19 10:47:29] Loading Adam parameters
[2023-07-19 10:47:30] [memory] Reserving 322 MB, device gpu0
[2023-07-19 10:47:30] [memory] Reserving 80 MB, device gpu0
[2023-07-19 10:47:30] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 10:47:30] [data] Restoring the corpus state to epoch 11, batch 385
[2023-07-19 10:47:30] [data] Shuffling data
[2023-07-19 10:47:30] [data] Done reading 20,192 sentences
[2023-07-19 10:47:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 10:47:30] Training started
[2023-07-19 10:47:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 10:47:31] [memory] Reserving 80 MB, device gpu0
[2023-07-19 10:47:36] Parameter type float16, optimization type float32, casting types true
[2023-07-19 10:52:26] Seen 20,192 samples
[2023-07-19 10:52:26] Starting data epoch 12 in logical epoch 12
[2023-07-19 10:52:26] [data] Shuffling data
[2023-07-19 10:52:26] [data] Done reading 20,192 sentences
[2023-07-19 10:52:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 10:57:54] Seen 20,192 samples
[2023-07-19 10:57:54] Starting data epoch 13 in logical epoch 13
[2023-07-19 10:57:54] [data] Shuffling data
[2023-07-19 10:57:54] [data] Done reading 20,192 sentences
[2023-07-19 10:57:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:03:18] Seen 20,192 samples
[2023-07-19 11:03:18] Starting data epoch 14 in logical epoch 14
[2023-07-19 11:03:18] [data] Shuffling data
[2023-07-19 11:03:18] [data] Done reading 20,192 sentences
[2023-07-19 11:03:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:08:41] Seen 20,192 samples
[2023-07-19 11:08:41] Starting data epoch 15 in logical epoch 15
[2023-07-19 11:08:41] [data] Shuffling data
[2023-07-19 11:08:41] [data] Done reading 20,192 sentences
[2023-07-19 11:08:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:13:55] Seen 20,192 samples
[2023-07-19 11:13:55] Starting data epoch 16 in logical epoch 16
[2023-07-19 11:13:55] [data] Shuffling data
[2023-07-19 11:13:55] [data] Done reading 20,192 sentences
[2023-07-19 11:13:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:19:09] Seen 20,192 samples
[2023-07-19 11:19:09] Starting data epoch 17 in logical epoch 17
[2023-07-19 11:19:09] [data] Shuffling data
[2023-07-19 11:19:09] [data] Done reading 20,192 sentences
[2023-07-19 11:19:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:24:22] Seen 20,192 samples
[2023-07-19 11:24:22] Starting data epoch 18 in logical epoch 18
[2023-07-19 11:24:22] [data] Shuffling data
[2023-07-19 11:24:22] [data] Done reading 20,192 sentences
[2023-07-19 11:24:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:29:35] Seen 20,192 samples
[2023-07-19 11:29:35] Starting data epoch 19 in logical epoch 19
[2023-07-19 11:29:35] [data] Shuffling data
[2023-07-19 11:29:35] [data] Done reading 20,192 sentences
[2023-07-19 11:29:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:34:55] Seen 20,192 samples
[2023-07-19 11:34:55] Starting data epoch 20 in logical epoch 20
[2023-07-19 11:34:55] [data] Shuffling data
[2023-07-19 11:34:55] [data] Done reading 20,192 sentences
[2023-07-19 11:34:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 11:40:08] Seen 20,192 samples
[2023-07-19 11:40:08] Starting data epoch 21 in logical epoch 21
[2023-07-19 11:40:08] Training finished
[2023-07-19 11:40:18] [valid] Ep. 21 : Up. 769 : cross-entropy : 171.666 : new best
[2023-07-19 11:44:57] [valid] Ep. 21 : Up. 769 : translation : 0 : new best
[2023-07-19 11:44:57] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 11:44:59] Saving Adam parameters
[2023-07-19 11:44:59] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 11:45:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 11:45:08] [marian] Running on node18.datos.cluster.uy as process 5892 with command line:
[2023-07-19 11:45:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 11:45:08] [config] after: 0e
[2023-07-19 11:45:08] [config] after-batches: 0
[2023-07-19 11:45:08] [config] after-epochs: 30
[2023-07-19 11:45:08] [config] all-caps-every: 0
[2023-07-19 11:45:08] [config] allow-unk: false
[2023-07-19 11:45:08] [config] authors: false
[2023-07-19 11:45:08] [config] beam-size: 12
[2023-07-19 11:45:08] [config] bert-class-symbol: "[CLS]"
[2023-07-19 11:45:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 11:45:08] [config] bert-masking-fraction: 0.15
[2023-07-19 11:45:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 11:45:08] [config] bert-train-type-embeddings: true
[2023-07-19 11:45:08] [config] bert-type-vocab-size: 2
[2023-07-19 11:45:08] [config] build-info: ""
[2023-07-19 11:45:08] [config] check-gradient-nan: false
[2023-07-19 11:45:08] [config] check-nan: false
[2023-07-19 11:45:08] [config] cite: false
[2023-07-19 11:45:08] [config] clip-norm: 1
[2023-07-19 11:45:08] [config] cost-scaling:
[2023-07-19 11:45:08] [config]   - 256.f
[2023-07-19 11:45:08] [config]   - 1000
[2023-07-19 11:45:08] [config]   - 2.f
[2023-07-19 11:45:08] [config]   - 256.f
[2023-07-19 11:45:08] [config] cost-type: ce-sum
[2023-07-19 11:45:08] [config] cpu-threads: 0
[2023-07-19 11:45:08] [config] data-threads: 8
[2023-07-19 11:45:08] [config] data-weighting: ""
[2023-07-19 11:45:08] [config] data-weighting-type: sentence
[2023-07-19 11:45:08] [config] dec-cell: gru
[2023-07-19 11:45:08] [config] dec-cell-base-depth: 2
[2023-07-19 11:45:08] [config] dec-cell-high-depth: 1
[2023-07-19 11:45:08] [config] dec-depth: 1
[2023-07-19 11:45:08] [config] devices:
[2023-07-19 11:45:08] [config]   - 0
[2023-07-19 11:45:08] [config] dim-emb: 512
[2023-07-19 11:45:08] [config] dim-rnn: 1024
[2023-07-19 11:45:08] [config] dim-vocabs:
[2023-07-19 11:45:08] [config]   - 16384
[2023-07-19 11:45:08] [config]   - 16384
[2023-07-19 11:45:08] [config] disp-first: 0
[2023-07-19 11:45:08] [config] disp-freq: 1000u
[2023-07-19 11:45:08] [config] disp-label-counts: true
[2023-07-19 11:45:08] [config] dropout-rnn: 0
[2023-07-19 11:45:08] [config] dropout-src: 0
[2023-07-19 11:45:08] [config] dropout-trg: 0
[2023-07-19 11:45:08] [config] dump-config: ""
[2023-07-19 11:45:08] [config] dynamic-gradient-scaling:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] early-stopping: 200
[2023-07-19 11:45:08] [config] early-stopping-on: first
[2023-07-19 11:45:08] [config] embedding-fix-src: false
[2023-07-19 11:45:08] [config] embedding-fix-trg: false
[2023-07-19 11:45:08] [config] embedding-normalization: false
[2023-07-19 11:45:08] [config] embedding-vectors:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] enc-cell: gru
[2023-07-19 11:45:08] [config] enc-cell-depth: 1
[2023-07-19 11:45:08] [config] enc-depth: 1
[2023-07-19 11:45:08] [config] enc-type: bidirectional
[2023-07-19 11:45:08] [config] english-title-case-every: 0
[2023-07-19 11:45:08] [config] exponential-smoothing: 0
[2023-07-19 11:45:08] [config] factor-weight: 1
[2023-07-19 11:45:08] [config] factors-combine: sum
[2023-07-19 11:45:08] [config] factors-dim-emb: 0
[2023-07-19 11:45:08] [config] gradient-checkpointing: false
[2023-07-19 11:45:08] [config] gradient-norm-average-window: 100
[2023-07-19 11:45:08] [config] guided-alignment: none
[2023-07-19 11:45:08] [config] guided-alignment-cost: mse
[2023-07-19 11:45:08] [config] guided-alignment-weight: 0.1
[2023-07-19 11:45:08] [config] ignore-model-config: false
[2023-07-19 11:45:08] [config] input-types:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] interpolate-env-vars: false
[2023-07-19 11:45:08] [config] keep-best: false
[2023-07-19 11:45:08] [config] label-smoothing: 0
[2023-07-19 11:45:08] [config] layer-normalization: false
[2023-07-19 11:45:08] [config] learn-rate: 0.0001
[2023-07-19 11:45:08] [config] lemma-dependency: ""
[2023-07-19 11:45:08] [config] lemma-dim-emb: 0
[2023-07-19 11:45:08] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 11:45:08] [config] log-level: info
[2023-07-19 11:45:08] [config] log-time-zone: ""
[2023-07-19 11:45:08] [config] logical-epoch:
[2023-07-19 11:45:08] [config]   - 1e
[2023-07-19 11:45:08] [config]   - 0
[2023-07-19 11:45:08] [config] lr-decay: 0
[2023-07-19 11:45:08] [config] lr-decay-freq: 50000
[2023-07-19 11:45:08] [config] lr-decay-inv-sqrt:
[2023-07-19 11:45:08] [config]   - 0
[2023-07-19 11:45:08] [config] lr-decay-repeat-warmup: false
[2023-07-19 11:45:08] [config] lr-decay-reset-optimizer: false
[2023-07-19 11:45:08] [config] lr-decay-start:
[2023-07-19 11:45:08] [config]   - 10
[2023-07-19 11:45:08] [config]   - 1
[2023-07-19 11:45:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 11:45:08] [config] lr-report: false
[2023-07-19 11:45:08] [config] lr-warmup: 0
[2023-07-19 11:45:08] [config] lr-warmup-at-reload: false
[2023-07-19 11:45:08] [config] lr-warmup-cycle: false
[2023-07-19 11:45:08] [config] lr-warmup-start-rate: 0
[2023-07-19 11:45:08] [config] max-length: 200
[2023-07-19 11:45:08] [config] max-length-crop: true
[2023-07-19 11:45:08] [config] max-length-factor: 3
[2023-07-19 11:45:08] [config] maxi-batch: 100
[2023-07-19 11:45:08] [config] maxi-batch-sort: trg
[2023-07-19 11:45:08] [config] mini-batch: 64
[2023-07-19 11:45:08] [config] mini-batch-fit: true
[2023-07-19 11:45:08] [config] mini-batch-fit-step: 10
[2023-07-19 11:45:08] [config] mini-batch-round-up: true
[2023-07-19 11:45:08] [config] mini-batch-track-lr: false
[2023-07-19 11:45:08] [config] mini-batch-warmup: 0
[2023-07-19 11:45:08] [config] mini-batch-words: 0
[2023-07-19 11:45:08] [config] mini-batch-words-ref: 0
[2023-07-19 11:45:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 11:45:08] [config] multi-loss-type: sum
[2023-07-19 11:45:08] [config] n-best: false
[2023-07-19 11:45:08] [config] no-nccl: false
[2023-07-19 11:45:08] [config] no-reload: false
[2023-07-19 11:45:08] [config] no-restore-corpus: false
[2023-07-19 11:45:08] [config] normalize: 0
[2023-07-19 11:45:08] [config] normalize-gradient: false
[2023-07-19 11:45:08] [config] num-devices: 0
[2023-07-19 11:45:08] [config] optimizer: adam
[2023-07-19 11:45:08] [config] optimizer-delay: 1
[2023-07-19 11:45:08] [config] optimizer-params:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] output-omit-bias: false
[2023-07-19 11:45:08] [config] overwrite: true
[2023-07-19 11:45:08] [config] precision:
[2023-07-19 11:45:08] [config]   - float16
[2023-07-19 11:45:08] [config]   - float32
[2023-07-19 11:45:08] [config] pretrained-model: ""
[2023-07-19 11:45:08] [config] quantize-biases: false
[2023-07-19 11:45:08] [config] quantize-bits: 0
[2023-07-19 11:45:08] [config] quantize-log-based: false
[2023-07-19 11:45:08] [config] quantize-optimization-steps: 0
[2023-07-19 11:45:08] [config] quiet: false
[2023-07-19 11:45:08] [config] quiet-translation: true
[2023-07-19 11:45:08] [config] relative-paths: false
[2023-07-19 11:45:08] [config] right-left: false
[2023-07-19 11:45:08] [config] save-freq: 10000u
[2023-07-19 11:45:08] [config] seed: 1234
[2023-07-19 11:45:08] [config] sentencepiece-alphas:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] sentencepiece-max-lines: 2000000
[2023-07-19 11:45:08] [config] sentencepiece-options: ""
[2023-07-19 11:45:08] [config] sharding: global
[2023-07-19 11:45:08] [config] shuffle: data
[2023-07-19 11:45:08] [config] shuffle-in-ram: false
[2023-07-19 11:45:08] [config] sigterm: save-and-exit
[2023-07-19 11:45:08] [config] skip: false
[2023-07-19 11:45:08] [config] sqlite: ""
[2023-07-19 11:45:08] [config] sqlite-drop: false
[2023-07-19 11:45:08] [config] sync-freq: 200u
[2023-07-19 11:45:08] [config] sync-sgd: false
[2023-07-19 11:45:08] [config] tempdir: /tmp
[2023-07-19 11:45:08] [config] tied-embeddings: false
[2023-07-19 11:45:08] [config] tied-embeddings-all: true
[2023-07-19 11:45:08] [config] tied-embeddings-src: false
[2023-07-19 11:45:08] [config] train-embedder-rank:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] train-sets:
[2023-07-19 11:45:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 11:45:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 11:45:08] [config] transformer-aan-activation: swish
[2023-07-19 11:45:08] [config] transformer-aan-depth: 2
[2023-07-19 11:45:08] [config] transformer-aan-nogate: false
[2023-07-19 11:45:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 11:45:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 11:45:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 11:45:08] [config] transformer-depth-scaling: false
[2023-07-19 11:45:08] [config] transformer-dim-aan: 2048
[2023-07-19 11:45:08] [config] transformer-dim-ffn: 2048
[2023-07-19 11:45:08] [config] transformer-dropout: 0
[2023-07-19 11:45:08] [config] transformer-dropout-attention: 0
[2023-07-19 11:45:08] [config] transformer-dropout-ffn: 0
[2023-07-19 11:45:08] [config] transformer-ffn-activation: swish
[2023-07-19 11:45:08] [config] transformer-ffn-depth: 2
[2023-07-19 11:45:08] [config] transformer-guided-alignment-layer: last
[2023-07-19 11:45:08] [config] transformer-heads: 8
[2023-07-19 11:45:08] [config] transformer-no-projection: false
[2023-07-19 11:45:08] [config] transformer-pool: false
[2023-07-19 11:45:08] [config] transformer-postprocess: dan
[2023-07-19 11:45:08] [config] transformer-postprocess-emb: d
[2023-07-19 11:45:08] [config] transformer-postprocess-top: ""
[2023-07-19 11:45:08] [config] transformer-preprocess: ""
[2023-07-19 11:45:08] [config] transformer-tied-layers:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] transformer-train-position-embeddings: false
[2023-07-19 11:45:08] [config] tsv: false
[2023-07-19 11:45:08] [config] tsv-fields: 0
[2023-07-19 11:45:08] [config] type: amun
[2023-07-19 11:45:08] [config] ulr: false
[2023-07-19 11:45:08] [config] ulr-dim-emb: 0
[2023-07-19 11:45:08] [config] ulr-dropout: 0
[2023-07-19 11:45:08] [config] ulr-keys-vectors: ""
[2023-07-19 11:45:08] [config] ulr-query-vectors: ""
[2023-07-19 11:45:08] [config] ulr-softmax-temperature: 1
[2023-07-19 11:45:08] [config] ulr-trainable-transformation: false
[2023-07-19 11:45:08] [config] unlikelihood-loss: false
[2023-07-19 11:45:08] [config] valid-freq: 50000000
[2023-07-19 11:45:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 11:45:08] [config] valid-max-length: 1000
[2023-07-19 11:45:08] [config] valid-metrics:
[2023-07-19 11:45:08] [config]   - cross-entropy
[2023-07-19 11:45:08] [config]   - translation
[2023-07-19 11:45:08] [config] valid-mini-batch: 32
[2023-07-19 11:45:08] [config] valid-reset-stalled: false
[2023-07-19 11:45:08] [config] valid-script-args:
[2023-07-19 11:45:08] [config]   []
[2023-07-19 11:45:08] [config] valid-script-path: ""
[2023-07-19 11:45:08] [config] valid-sets:
[2023-07-19 11:45:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 11:45:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 11:45:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 11:45:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 11:45:08] [config] vocabs:
[2023-07-19 11:45:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 11:45:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 11:45:08] [config] word-penalty: 0
[2023-07-19 11:45:08] [config] word-scores: false
[2023-07-19 11:45:08] [config] workspace: 5500
[2023-07-19 11:45:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 11:45:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 11:45:08] [training] Using single-device training
[2023-07-19 11:45:12] Synced seed 1234
[2023-07-19 11:45:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 11:45:12] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 11:45:12] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 11:45:12] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 11:45:12] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 11:45:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 11:45:12] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 11:45:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 11:45:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 11:45:13] [comm] Using global sharding
[2023-07-19 11:45:13] [comm] NCCLCommunicators constructed successfully
[2023-07-19 11:45:13] [training] Using 1 GPUs
[2023-07-19 11:45:13] [logits] Applying loss function for 1 factor(s)
[2023-07-19 11:45:13] [memory] Reserving 80 MB, device gpu0
[2023-07-19 11:45:13] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 11:45:13] [memory] Reserving 80 MB, device gpu0
[2023-07-19 12:24:48] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 12:24:48] [valid] No post-processing script given for validating translator
[2023-07-19 12:24:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 12:24:49] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 12:24:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 12:24:49] [comm] Using global sharding
[2023-07-19 12:24:49] [comm] NCCLCommunicators constructed successfully
[2023-07-19 12:24:49] [training] Using 1 GPUs
[2023-07-19 12:24:49] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 12:24:51] Allocating memory for general optimizer shards
[2023-07-19 12:24:51] [memory] Reserving 322 MB, device gpu0
[2023-07-19 12:24:51] Loading Adam parameters
[2023-07-19 12:24:51] [memory] Reserving 322 MB, device gpu0
[2023-07-19 12:24:51] [memory] Reserving 80 MB, device gpu0
[2023-07-19 12:24:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 12:24:51] [data] Restoring the corpus state to epoch 21, batch 769
[2023-07-19 12:24:51] [data] Shuffling data
[2023-07-19 12:24:51] [data] Done reading 20,192 sentences
[2023-07-19 12:24:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 12:24:51] Training started
[2023-07-19 12:24:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 12:24:53] [memory] Reserving 80 MB, device gpu0
[2023-07-19 12:24:58] Parameter type float16, optimization type float32, casting types true
[2023-07-19 12:30:17] Seen 20,192 samples
[2023-07-19 12:30:17] Starting data epoch 22 in logical epoch 22
[2023-07-19 12:30:17] [data] Shuffling data
[2023-07-19 12:30:17] [data] Done reading 20,192 sentences
[2023-07-19 12:30:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 12:35:43] Seen 20,192 samples
[2023-07-19 12:35:43] Starting data epoch 23 in logical epoch 23
[2023-07-19 12:35:43] [data] Shuffling data
[2023-07-19 12:35:43] [data] Done reading 20,192 sentences
[2023-07-19 12:35:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 12:41:00] Seen 20,192 samples
[2023-07-19 12:41:00] Starting data epoch 24 in logical epoch 24
[2023-07-19 12:41:00] [data] Shuffling data
[2023-07-19 12:41:00] [data] Done reading 20,192 sentences
[2023-07-19 12:41:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 12:46:19] Seen 20,192 samples
[2023-07-19 12:46:19] Starting data epoch 25 in logical epoch 25
[2023-07-19 12:46:19] [data] Shuffling data
[2023-07-19 12:46:19] [data] Done reading 20,192 sentences
[2023-07-19 12:46:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 12:51:29] Seen 20,192 samples
[2023-07-19 12:51:29] Starting data epoch 26 in logical epoch 26
[2023-07-19 12:51:29] [data] Shuffling data
[2023-07-19 12:51:29] [data] Done reading 20,192 sentences
[2023-07-19 12:51:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 12:56:31] Ep. 26 : Up. 1000 : Sen. 19,715 : Cost 6.26870584 * 16,112,045 @ 14,730 after 16,112,045 : Time 1902.10s : 8470.65 words/s : gNorm 0.9098
[2023-07-19 12:56:46] Seen 20,192 samples
[2023-07-19 12:56:46] Starting data epoch 27 in logical epoch 27
[2023-07-19 12:56:46] [data] Shuffling data
[2023-07-19 12:56:46] [data] Done reading 20,192 sentences
[2023-07-19 12:56:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 13:02:11] Seen 20,192 samples
[2023-07-19 13:02:11] Starting data epoch 28 in logical epoch 28
[2023-07-19 13:02:11] [data] Shuffling data
[2023-07-19 13:02:11] [data] Done reading 20,192 sentences
[2023-07-19 13:02:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 13:07:27] Seen 20,192 samples
[2023-07-19 13:07:27] Starting data epoch 29 in logical epoch 29
[2023-07-19 13:07:27] [data] Shuffling data
[2023-07-19 13:07:27] [data] Done reading 20,192 sentences
[2023-07-19 13:07:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 13:12:44] Seen 20,192 samples
[2023-07-19 13:12:44] Starting data epoch 30 in logical epoch 30
[2023-07-19 13:12:44] [data] Shuffling data
[2023-07-19 13:12:44] [data] Done reading 20,192 sentences
[2023-07-19 13:12:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 13:18:05] Seen 20,192 samples
[2023-07-19 13:18:05] Starting data epoch 31 in logical epoch 31
[2023-07-19 13:18:05] Training finished
[2023-07-19 13:18:18] [valid] Ep. 31 : Up. 1158 : cross-entropy : 158.086 : new best
[2023-07-19 13:21:36] [valid] Ep. 31 : Up. 1158 : translation : 0 : new best
[2023-07-19 13:21:36] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 13:21:39] Saving Adam parameters
[2023-07-19 13:21:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 13:21:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 13:21:49] [marian] Running on node18.datos.cluster.uy as process 12337 with command line:
[2023-07-19 13:21:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 13:21:49] [config] after: 0e
[2023-07-19 13:21:49] [config] after-batches: 0
[2023-07-19 13:21:49] [config] after-epochs: 40
[2023-07-19 13:21:49] [config] all-caps-every: 0
[2023-07-19 13:21:49] [config] allow-unk: false
[2023-07-19 13:21:49] [config] authors: false
[2023-07-19 13:21:49] [config] beam-size: 12
[2023-07-19 13:21:49] [config] bert-class-symbol: "[CLS]"
[2023-07-19 13:21:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 13:21:49] [config] bert-masking-fraction: 0.15
[2023-07-19 13:21:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 13:21:49] [config] bert-train-type-embeddings: true
[2023-07-19 13:21:49] [config] bert-type-vocab-size: 2
[2023-07-19 13:21:49] [config] build-info: ""
[2023-07-19 13:21:49] [config] check-gradient-nan: false
[2023-07-19 13:21:49] [config] check-nan: false
[2023-07-19 13:21:49] [config] cite: false
[2023-07-19 13:21:49] [config] clip-norm: 1
[2023-07-19 13:21:49] [config] cost-scaling:
[2023-07-19 13:21:49] [config]   - 256.f
[2023-07-19 13:21:49] [config]   - 1000
[2023-07-19 13:21:49] [config]   - 2.f
[2023-07-19 13:21:49] [config]   - 256.f
[2023-07-19 13:21:49] [config] cost-type: ce-sum
[2023-07-19 13:21:49] [config] cpu-threads: 0
[2023-07-19 13:21:49] [config] data-threads: 8
[2023-07-19 13:21:49] [config] data-weighting: ""
[2023-07-19 13:21:49] [config] data-weighting-type: sentence
[2023-07-19 13:21:49] [config] dec-cell: gru
[2023-07-19 13:21:49] [config] dec-cell-base-depth: 2
[2023-07-19 13:21:49] [config] dec-cell-high-depth: 1
[2023-07-19 13:21:49] [config] dec-depth: 1
[2023-07-19 13:21:49] [config] devices:
[2023-07-19 13:21:49] [config]   - 0
[2023-07-19 13:21:49] [config] dim-emb: 512
[2023-07-19 13:21:49] [config] dim-rnn: 1024
[2023-07-19 13:21:49] [config] dim-vocabs:
[2023-07-19 13:21:49] [config]   - 16384
[2023-07-19 13:21:49] [config]   - 16384
[2023-07-19 13:21:49] [config] disp-first: 0
[2023-07-19 13:21:49] [config] disp-freq: 1000u
[2023-07-19 13:21:49] [config] disp-label-counts: true
[2023-07-19 13:21:49] [config] dropout-rnn: 0
[2023-07-19 13:21:49] [config] dropout-src: 0
[2023-07-19 13:21:49] [config] dropout-trg: 0
[2023-07-19 13:21:49] [config] dump-config: ""
[2023-07-19 13:21:49] [config] dynamic-gradient-scaling:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] early-stopping: 200
[2023-07-19 13:21:49] [config] early-stopping-on: first
[2023-07-19 13:21:49] [config] embedding-fix-src: false
[2023-07-19 13:21:49] [config] embedding-fix-trg: false
[2023-07-19 13:21:49] [config] embedding-normalization: false
[2023-07-19 13:21:49] [config] embedding-vectors:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] enc-cell: gru
[2023-07-19 13:21:49] [config] enc-cell-depth: 1
[2023-07-19 13:21:49] [config] enc-depth: 1
[2023-07-19 13:21:49] [config] enc-type: bidirectional
[2023-07-19 13:21:49] [config] english-title-case-every: 0
[2023-07-19 13:21:49] [config] exponential-smoothing: 0
[2023-07-19 13:21:49] [config] factor-weight: 1
[2023-07-19 13:21:49] [config] factors-combine: sum
[2023-07-19 13:21:49] [config] factors-dim-emb: 0
[2023-07-19 13:21:49] [config] gradient-checkpointing: false
[2023-07-19 13:21:49] [config] gradient-norm-average-window: 100
[2023-07-19 13:21:49] [config] guided-alignment: none
[2023-07-19 13:21:49] [config] guided-alignment-cost: mse
[2023-07-19 13:21:49] [config] guided-alignment-weight: 0.1
[2023-07-19 13:21:49] [config] ignore-model-config: false
[2023-07-19 13:21:49] [config] input-types:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] interpolate-env-vars: false
[2023-07-19 13:21:49] [config] keep-best: false
[2023-07-19 13:21:49] [config] label-smoothing: 0
[2023-07-19 13:21:49] [config] layer-normalization: false
[2023-07-19 13:21:49] [config] learn-rate: 0.0001
[2023-07-19 13:21:49] [config] lemma-dependency: ""
[2023-07-19 13:21:49] [config] lemma-dim-emb: 0
[2023-07-19 13:21:49] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 13:21:49] [config] log-level: info
[2023-07-19 13:21:49] [config] log-time-zone: ""
[2023-07-19 13:21:49] [config] logical-epoch:
[2023-07-19 13:21:49] [config]   - 1e
[2023-07-19 13:21:49] [config]   - 0
[2023-07-19 13:21:49] [config] lr-decay: 0
[2023-07-19 13:21:49] [config] lr-decay-freq: 50000
[2023-07-19 13:21:49] [config] lr-decay-inv-sqrt:
[2023-07-19 13:21:49] [config]   - 0
[2023-07-19 13:21:49] [config] lr-decay-repeat-warmup: false
[2023-07-19 13:21:49] [config] lr-decay-reset-optimizer: false
[2023-07-19 13:21:49] [config] lr-decay-start:
[2023-07-19 13:21:49] [config]   - 10
[2023-07-19 13:21:49] [config]   - 1
[2023-07-19 13:21:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 13:21:49] [config] lr-report: false
[2023-07-19 13:21:49] [config] lr-warmup: 0
[2023-07-19 13:21:49] [config] lr-warmup-at-reload: false
[2023-07-19 13:21:49] [config] lr-warmup-cycle: false
[2023-07-19 13:21:49] [config] lr-warmup-start-rate: 0
[2023-07-19 13:21:49] [config] max-length: 200
[2023-07-19 13:21:49] [config] max-length-crop: true
[2023-07-19 13:21:49] [config] max-length-factor: 3
[2023-07-19 13:21:49] [config] maxi-batch: 100
[2023-07-19 13:21:49] [config] maxi-batch-sort: trg
[2023-07-19 13:21:49] [config] mini-batch: 64
[2023-07-19 13:21:49] [config] mini-batch-fit: true
[2023-07-19 13:21:49] [config] mini-batch-fit-step: 10
[2023-07-19 13:21:49] [config] mini-batch-round-up: true
[2023-07-19 13:21:49] [config] mini-batch-track-lr: false
[2023-07-19 13:21:49] [config] mini-batch-warmup: 0
[2023-07-19 13:21:49] [config] mini-batch-words: 0
[2023-07-19 13:21:49] [config] mini-batch-words-ref: 0
[2023-07-19 13:21:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 13:21:49] [config] multi-loss-type: sum
[2023-07-19 13:21:49] [config] n-best: false
[2023-07-19 13:21:49] [config] no-nccl: false
[2023-07-19 13:21:49] [config] no-reload: false
[2023-07-19 13:21:49] [config] no-restore-corpus: false
[2023-07-19 13:21:49] [config] normalize: 0
[2023-07-19 13:21:49] [config] normalize-gradient: false
[2023-07-19 13:21:49] [config] num-devices: 0
[2023-07-19 13:21:49] [config] optimizer: adam
[2023-07-19 13:21:49] [config] optimizer-delay: 1
[2023-07-19 13:21:49] [config] optimizer-params:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] output-omit-bias: false
[2023-07-19 13:21:49] [config] overwrite: true
[2023-07-19 13:21:49] [config] precision:
[2023-07-19 13:21:49] [config]   - float16
[2023-07-19 13:21:49] [config]   - float32
[2023-07-19 13:21:49] [config] pretrained-model: ""
[2023-07-19 13:21:49] [config] quantize-biases: false
[2023-07-19 13:21:49] [config] quantize-bits: 0
[2023-07-19 13:21:49] [config] quantize-log-based: false
[2023-07-19 13:21:49] [config] quantize-optimization-steps: 0
[2023-07-19 13:21:49] [config] quiet: false
[2023-07-19 13:21:49] [config] quiet-translation: true
[2023-07-19 13:21:49] [config] relative-paths: false
[2023-07-19 13:21:49] [config] right-left: false
[2023-07-19 13:21:49] [config] save-freq: 10000u
[2023-07-19 13:21:49] [config] seed: 1234
[2023-07-19 13:21:49] [config] sentencepiece-alphas:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] sentencepiece-max-lines: 2000000
[2023-07-19 13:21:49] [config] sentencepiece-options: ""
[2023-07-19 13:21:49] [config] sharding: global
[2023-07-19 13:21:49] [config] shuffle: data
[2023-07-19 13:21:49] [config] shuffle-in-ram: false
[2023-07-19 13:21:49] [config] sigterm: save-and-exit
[2023-07-19 13:21:49] [config] skip: false
[2023-07-19 13:21:49] [config] sqlite: ""
[2023-07-19 13:21:49] [config] sqlite-drop: false
[2023-07-19 13:21:49] [config] sync-freq: 200u
[2023-07-19 13:21:49] [config] sync-sgd: false
[2023-07-19 13:21:49] [config] tempdir: /tmp
[2023-07-19 13:21:49] [config] tied-embeddings: false
[2023-07-19 13:21:49] [config] tied-embeddings-all: true
[2023-07-19 13:21:49] [config] tied-embeddings-src: false
[2023-07-19 13:21:49] [config] train-embedder-rank:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] train-sets:
[2023-07-19 13:21:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 13:21:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 13:21:49] [config] transformer-aan-activation: swish
[2023-07-19 13:21:49] [config] transformer-aan-depth: 2
[2023-07-19 13:21:49] [config] transformer-aan-nogate: false
[2023-07-19 13:21:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 13:21:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 13:21:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 13:21:49] [config] transformer-depth-scaling: false
[2023-07-19 13:21:49] [config] transformer-dim-aan: 2048
[2023-07-19 13:21:49] [config] transformer-dim-ffn: 2048
[2023-07-19 13:21:49] [config] transformer-dropout: 0
[2023-07-19 13:21:49] [config] transformer-dropout-attention: 0
[2023-07-19 13:21:49] [config] transformer-dropout-ffn: 0
[2023-07-19 13:21:49] [config] transformer-ffn-activation: swish
[2023-07-19 13:21:49] [config] transformer-ffn-depth: 2
[2023-07-19 13:21:49] [config] transformer-guided-alignment-layer: last
[2023-07-19 13:21:49] [config] transformer-heads: 8
[2023-07-19 13:21:49] [config] transformer-no-projection: false
[2023-07-19 13:21:49] [config] transformer-pool: false
[2023-07-19 13:21:49] [config] transformer-postprocess: dan
[2023-07-19 13:21:49] [config] transformer-postprocess-emb: d
[2023-07-19 13:21:49] [config] transformer-postprocess-top: ""
[2023-07-19 13:21:49] [config] transformer-preprocess: ""
[2023-07-19 13:21:49] [config] transformer-tied-layers:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] transformer-train-position-embeddings: false
[2023-07-19 13:21:49] [config] tsv: false
[2023-07-19 13:21:49] [config] tsv-fields: 0
[2023-07-19 13:21:49] [config] type: amun
[2023-07-19 13:21:49] [config] ulr: false
[2023-07-19 13:21:49] [config] ulr-dim-emb: 0
[2023-07-19 13:21:49] [config] ulr-dropout: 0
[2023-07-19 13:21:49] [config] ulr-keys-vectors: ""
[2023-07-19 13:21:49] [config] ulr-query-vectors: ""
[2023-07-19 13:21:49] [config] ulr-softmax-temperature: 1
[2023-07-19 13:21:49] [config] ulr-trainable-transformation: false
[2023-07-19 13:21:49] [config] unlikelihood-loss: false
[2023-07-19 13:21:49] [config] valid-freq: 50000000
[2023-07-19 13:21:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 13:21:49] [config] valid-max-length: 1000
[2023-07-19 13:21:49] [config] valid-metrics:
[2023-07-19 13:21:49] [config]   - cross-entropy
[2023-07-19 13:21:49] [config]   - translation
[2023-07-19 13:21:49] [config] valid-mini-batch: 32
[2023-07-19 13:21:49] [config] valid-reset-stalled: false
[2023-07-19 13:21:49] [config] valid-script-args:
[2023-07-19 13:21:49] [config]   []
[2023-07-19 13:21:49] [config] valid-script-path: ""
[2023-07-19 13:21:49] [config] valid-sets:
[2023-07-19 13:21:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 13:21:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 13:21:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 13:21:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 13:21:49] [config] vocabs:
[2023-07-19 13:21:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 13:21:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 13:21:49] [config] word-penalty: 0
[2023-07-19 13:21:49] [config] word-scores: false
[2023-07-19 13:21:49] [config] workspace: 5500
[2023-07-19 13:21:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 13:21:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 13:21:49] [training] Using single-device training
[2023-07-19 13:21:49] Synced seed 1234
[2023-07-19 13:21:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 13:21:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 13:21:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 13:21:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 13:21:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 13:21:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 13:21:49] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 13:21:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 13:21:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 13:21:51] [comm] Using global sharding
[2023-07-19 13:21:51] [comm] NCCLCommunicators constructed successfully
[2023-07-19 13:21:51] [training] Using 1 GPUs
[2023-07-19 13:21:51] [logits] Applying loss function for 1 factor(s)
[2023-07-19 13:21:51] [memory] Reserving 80 MB, device gpu0
[2023-07-19 13:21:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 13:21:51] [memory] Reserving 80 MB, device gpu0
[2023-07-19 14:01:45] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 14:01:45] [valid] No post-processing script given for validating translator
[2023-07-19 14:01:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 14:01:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 14:01:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 14:01:45] [comm] Using global sharding
[2023-07-19 14:01:45] [comm] NCCLCommunicators constructed successfully
[2023-07-19 14:01:45] [training] Using 1 GPUs
[2023-07-19 14:01:45] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 14:01:47] Allocating memory for general optimizer shards
[2023-07-19 14:01:47] [memory] Reserving 322 MB, device gpu0
[2023-07-19 14:01:47] Loading Adam parameters
[2023-07-19 14:01:47] [memory] Reserving 322 MB, device gpu0
[2023-07-19 14:01:47] [memory] Reserving 80 MB, device gpu0
[2023-07-19 14:01:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 14:01:47] [data] Restoring the corpus state to epoch 31, batch 1158
[2023-07-19 14:01:47] [data] Shuffling data
[2023-07-19 14:01:47] [data] Done reading 20,192 sentences
[2023-07-19 14:01:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:01:47] Training started
[2023-07-19 14:01:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 14:01:48] [memory] Reserving 80 MB, device gpu0
[2023-07-19 14:01:52] Parameter type float16, optimization type float32, casting types true
[2023-07-19 14:07:10] Seen 20,192 samples
[2023-07-19 14:07:10] Starting data epoch 32 in logical epoch 32
[2023-07-19 14:07:10] [data] Shuffling data
[2023-07-19 14:07:10] [data] Done reading 20,192 sentences
[2023-07-19 14:07:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:12:22] Seen 20,192 samples
[2023-07-19 14:12:22] Starting data epoch 33 in logical epoch 33
[2023-07-19 14:12:22] [data] Shuffling data
[2023-07-19 14:12:22] [data] Done reading 20,192 sentences
[2023-07-19 14:12:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:17:39] Seen 20,192 samples
[2023-07-19 14:17:39] Starting data epoch 34 in logical epoch 34
[2023-07-19 14:17:39] [data] Shuffling data
[2023-07-19 14:17:39] [data] Done reading 20,192 sentences
[2023-07-19 14:17:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:22:47] Seen 20,192 samples
[2023-07-19 14:22:47] Starting data epoch 35 in logical epoch 35
[2023-07-19 14:22:47] [data] Shuffling data
[2023-07-19 14:22:47] [data] Done reading 20,192 sentences
[2023-07-19 14:22:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:28:04] Seen 20,192 samples
[2023-07-19 14:28:04] Starting data epoch 36 in logical epoch 36
[2023-07-19 14:28:04] [data] Shuffling data
[2023-07-19 14:28:04] [data] Done reading 20,192 sentences
[2023-07-19 14:28:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:33:19] Seen 20,192 samples
[2023-07-19 14:33:19] Starting data epoch 37 in logical epoch 37
[2023-07-19 14:33:19] [data] Shuffling data
[2023-07-19 14:33:19] [data] Done reading 20,192 sentences
[2023-07-19 14:33:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:38:42] Seen 20,192 samples
[2023-07-19 14:38:42] Starting data epoch 38 in logical epoch 38
[2023-07-19 14:38:42] [data] Shuffling data
[2023-07-19 14:38:42] [data] Done reading 20,192 sentences
[2023-07-19 14:38:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:43:57] Seen 20,192 samples
[2023-07-19 14:43:57] Starting data epoch 39 in logical epoch 39
[2023-07-19 14:43:57] [data] Shuffling data
[2023-07-19 14:43:57] [data] Done reading 20,192 sentences
[2023-07-19 14:43:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:49:14] Seen 20,192 samples
[2023-07-19 14:49:14] Starting data epoch 40 in logical epoch 40
[2023-07-19 14:49:14] [data] Shuffling data
[2023-07-19 14:49:14] [data] Done reading 20,192 sentences
[2023-07-19 14:49:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 14:54:06] Seen 20,192 samples
[2023-07-19 14:54:06] Starting data epoch 41 in logical epoch 41
[2023-07-19 14:54:06] Training finished
[2023-07-19 14:54:19] [valid] Ep. 41 : Up. 1545 : cross-entropy : 148.95 : new best
[2023-07-19 14:56:36] [valid] Ep. 41 : Up. 1545 : translation : 0 : new best
[2023-07-19 14:56:36] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 14:56:38] Saving Adam parameters
[2023-07-19 14:56:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 14:56:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 14:56:46] [marian] Running on node18.datos.cluster.uy as process 18488 with command line:
[2023-07-19 14:56:46] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 14:56:46] [config] after: 0e
[2023-07-19 14:56:46] [config] after-batches: 0
[2023-07-19 14:56:46] [config] after-epochs: 50
[2023-07-19 14:56:46] [config] all-caps-every: 0
[2023-07-19 14:56:46] [config] allow-unk: false
[2023-07-19 14:56:46] [config] authors: false
[2023-07-19 14:56:46] [config] beam-size: 12
[2023-07-19 14:56:46] [config] bert-class-symbol: "[CLS]"
[2023-07-19 14:56:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 14:56:46] [config] bert-masking-fraction: 0.15
[2023-07-19 14:56:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 14:56:46] [config] bert-train-type-embeddings: true
[2023-07-19 14:56:46] [config] bert-type-vocab-size: 2
[2023-07-19 14:56:46] [config] build-info: ""
[2023-07-19 14:56:46] [config] check-gradient-nan: false
[2023-07-19 14:56:46] [config] check-nan: false
[2023-07-19 14:56:46] [config] cite: false
[2023-07-19 14:56:46] [config] clip-norm: 1
[2023-07-19 14:56:46] [config] cost-scaling:
[2023-07-19 14:56:46] [config]   - 256.f
[2023-07-19 14:56:46] [config]   - 1000
[2023-07-19 14:56:46] [config]   - 2.f
[2023-07-19 14:56:46] [config]   - 256.f
[2023-07-19 14:56:46] [config] cost-type: ce-sum
[2023-07-19 14:56:46] [config] cpu-threads: 0
[2023-07-19 14:56:46] [config] data-threads: 8
[2023-07-19 14:56:46] [config] data-weighting: ""
[2023-07-19 14:56:46] [config] data-weighting-type: sentence
[2023-07-19 14:56:46] [config] dec-cell: gru
[2023-07-19 14:56:46] [config] dec-cell-base-depth: 2
[2023-07-19 14:56:46] [config] dec-cell-high-depth: 1
[2023-07-19 14:56:46] [config] dec-depth: 1
[2023-07-19 14:56:46] [config] devices:
[2023-07-19 14:56:46] [config]   - 0
[2023-07-19 14:56:46] [config] dim-emb: 512
[2023-07-19 14:56:46] [config] dim-rnn: 1024
[2023-07-19 14:56:46] [config] dim-vocabs:
[2023-07-19 14:56:46] [config]   - 16384
[2023-07-19 14:56:46] [config]   - 16384
[2023-07-19 14:56:46] [config] disp-first: 0
[2023-07-19 14:56:46] [config] disp-freq: 1000u
[2023-07-19 14:56:46] [config] disp-label-counts: true
[2023-07-19 14:56:46] [config] dropout-rnn: 0
[2023-07-19 14:56:46] [config] dropout-src: 0
[2023-07-19 14:56:46] [config] dropout-trg: 0
[2023-07-19 14:56:46] [config] dump-config: ""
[2023-07-19 14:56:46] [config] dynamic-gradient-scaling:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] early-stopping: 200
[2023-07-19 14:56:46] [config] early-stopping-on: first
[2023-07-19 14:56:46] [config] embedding-fix-src: false
[2023-07-19 14:56:46] [config] embedding-fix-trg: false
[2023-07-19 14:56:46] [config] embedding-normalization: false
[2023-07-19 14:56:46] [config] embedding-vectors:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] enc-cell: gru
[2023-07-19 14:56:46] [config] enc-cell-depth: 1
[2023-07-19 14:56:46] [config] enc-depth: 1
[2023-07-19 14:56:46] [config] enc-type: bidirectional
[2023-07-19 14:56:46] [config] english-title-case-every: 0
[2023-07-19 14:56:46] [config] exponential-smoothing: 0
[2023-07-19 14:56:46] [config] factor-weight: 1
[2023-07-19 14:56:46] [config] factors-combine: sum
[2023-07-19 14:56:46] [config] factors-dim-emb: 0
[2023-07-19 14:56:46] [config] gradient-checkpointing: false
[2023-07-19 14:56:46] [config] gradient-norm-average-window: 100
[2023-07-19 14:56:46] [config] guided-alignment: none
[2023-07-19 14:56:46] [config] guided-alignment-cost: mse
[2023-07-19 14:56:46] [config] guided-alignment-weight: 0.1
[2023-07-19 14:56:46] [config] ignore-model-config: false
[2023-07-19 14:56:46] [config] input-types:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] interpolate-env-vars: false
[2023-07-19 14:56:46] [config] keep-best: false
[2023-07-19 14:56:46] [config] label-smoothing: 0
[2023-07-19 14:56:46] [config] layer-normalization: false
[2023-07-19 14:56:46] [config] learn-rate: 0.0001
[2023-07-19 14:56:46] [config] lemma-dependency: ""
[2023-07-19 14:56:46] [config] lemma-dim-emb: 0
[2023-07-19 14:56:46] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 14:56:46] [config] log-level: info
[2023-07-19 14:56:46] [config] log-time-zone: ""
[2023-07-19 14:56:46] [config] logical-epoch:
[2023-07-19 14:56:46] [config]   - 1e
[2023-07-19 14:56:46] [config]   - 0
[2023-07-19 14:56:46] [config] lr-decay: 0
[2023-07-19 14:56:46] [config] lr-decay-freq: 50000
[2023-07-19 14:56:46] [config] lr-decay-inv-sqrt:
[2023-07-19 14:56:46] [config]   - 0
[2023-07-19 14:56:46] [config] lr-decay-repeat-warmup: false
[2023-07-19 14:56:46] [config] lr-decay-reset-optimizer: false
[2023-07-19 14:56:46] [config] lr-decay-start:
[2023-07-19 14:56:46] [config]   - 10
[2023-07-19 14:56:46] [config]   - 1
[2023-07-19 14:56:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 14:56:46] [config] lr-report: false
[2023-07-19 14:56:46] [config] lr-warmup: 0
[2023-07-19 14:56:46] [config] lr-warmup-at-reload: false
[2023-07-19 14:56:46] [config] lr-warmup-cycle: false
[2023-07-19 14:56:46] [config] lr-warmup-start-rate: 0
[2023-07-19 14:56:46] [config] max-length: 200
[2023-07-19 14:56:46] [config] max-length-crop: true
[2023-07-19 14:56:46] [config] max-length-factor: 3
[2023-07-19 14:56:46] [config] maxi-batch: 100
[2023-07-19 14:56:46] [config] maxi-batch-sort: trg
[2023-07-19 14:56:46] [config] mini-batch: 64
[2023-07-19 14:56:46] [config] mini-batch-fit: true
[2023-07-19 14:56:46] [config] mini-batch-fit-step: 10
[2023-07-19 14:56:46] [config] mini-batch-round-up: true
[2023-07-19 14:56:46] [config] mini-batch-track-lr: false
[2023-07-19 14:56:46] [config] mini-batch-warmup: 0
[2023-07-19 14:56:46] [config] mini-batch-words: 0
[2023-07-19 14:56:46] [config] mini-batch-words-ref: 0
[2023-07-19 14:56:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 14:56:46] [config] multi-loss-type: sum
[2023-07-19 14:56:46] [config] n-best: false
[2023-07-19 14:56:46] [config] no-nccl: false
[2023-07-19 14:56:46] [config] no-reload: false
[2023-07-19 14:56:46] [config] no-restore-corpus: false
[2023-07-19 14:56:46] [config] normalize: 0
[2023-07-19 14:56:46] [config] normalize-gradient: false
[2023-07-19 14:56:46] [config] num-devices: 0
[2023-07-19 14:56:46] [config] optimizer: adam
[2023-07-19 14:56:46] [config] optimizer-delay: 1
[2023-07-19 14:56:46] [config] optimizer-params:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] output-omit-bias: false
[2023-07-19 14:56:46] [config] overwrite: true
[2023-07-19 14:56:46] [config] precision:
[2023-07-19 14:56:46] [config]   - float16
[2023-07-19 14:56:46] [config]   - float32
[2023-07-19 14:56:46] [config] pretrained-model: ""
[2023-07-19 14:56:46] [config] quantize-biases: false
[2023-07-19 14:56:46] [config] quantize-bits: 0
[2023-07-19 14:56:46] [config] quantize-log-based: false
[2023-07-19 14:56:46] [config] quantize-optimization-steps: 0
[2023-07-19 14:56:46] [config] quiet: false
[2023-07-19 14:56:46] [config] quiet-translation: true
[2023-07-19 14:56:46] [config] relative-paths: false
[2023-07-19 14:56:46] [config] right-left: false
[2023-07-19 14:56:46] [config] save-freq: 10000u
[2023-07-19 14:56:46] [config] seed: 1234
[2023-07-19 14:56:46] [config] sentencepiece-alphas:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] sentencepiece-max-lines: 2000000
[2023-07-19 14:56:46] [config] sentencepiece-options: ""
[2023-07-19 14:56:46] [config] sharding: global
[2023-07-19 14:56:46] [config] shuffle: data
[2023-07-19 14:56:46] [config] shuffle-in-ram: false
[2023-07-19 14:56:46] [config] sigterm: save-and-exit
[2023-07-19 14:56:46] [config] skip: false
[2023-07-19 14:56:46] [config] sqlite: ""
[2023-07-19 14:56:46] [config] sqlite-drop: false
[2023-07-19 14:56:46] [config] sync-freq: 200u
[2023-07-19 14:56:46] [config] sync-sgd: false
[2023-07-19 14:56:46] [config] tempdir: /tmp
[2023-07-19 14:56:46] [config] tied-embeddings: false
[2023-07-19 14:56:46] [config] tied-embeddings-all: true
[2023-07-19 14:56:46] [config] tied-embeddings-src: false
[2023-07-19 14:56:46] [config] train-embedder-rank:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] train-sets:
[2023-07-19 14:56:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 14:56:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 14:56:46] [config] transformer-aan-activation: swish
[2023-07-19 14:56:46] [config] transformer-aan-depth: 2
[2023-07-19 14:56:46] [config] transformer-aan-nogate: false
[2023-07-19 14:56:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 14:56:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 14:56:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 14:56:46] [config] transformer-depth-scaling: false
[2023-07-19 14:56:46] [config] transformer-dim-aan: 2048
[2023-07-19 14:56:46] [config] transformer-dim-ffn: 2048
[2023-07-19 14:56:46] [config] transformer-dropout: 0
[2023-07-19 14:56:46] [config] transformer-dropout-attention: 0
[2023-07-19 14:56:46] [config] transformer-dropout-ffn: 0
[2023-07-19 14:56:46] [config] transformer-ffn-activation: swish
[2023-07-19 14:56:46] [config] transformer-ffn-depth: 2
[2023-07-19 14:56:46] [config] transformer-guided-alignment-layer: last
[2023-07-19 14:56:46] [config] transformer-heads: 8
[2023-07-19 14:56:46] [config] transformer-no-projection: false
[2023-07-19 14:56:46] [config] transformer-pool: false
[2023-07-19 14:56:46] [config] transformer-postprocess: dan
[2023-07-19 14:56:46] [config] transformer-postprocess-emb: d
[2023-07-19 14:56:46] [config] transformer-postprocess-top: ""
[2023-07-19 14:56:46] [config] transformer-preprocess: ""
[2023-07-19 14:56:46] [config] transformer-tied-layers:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] transformer-train-position-embeddings: false
[2023-07-19 14:56:46] [config] tsv: false
[2023-07-19 14:56:46] [config] tsv-fields: 0
[2023-07-19 14:56:46] [config] type: amun
[2023-07-19 14:56:46] [config] ulr: false
[2023-07-19 14:56:46] [config] ulr-dim-emb: 0
[2023-07-19 14:56:46] [config] ulr-dropout: 0
[2023-07-19 14:56:46] [config] ulr-keys-vectors: ""
[2023-07-19 14:56:46] [config] ulr-query-vectors: ""
[2023-07-19 14:56:46] [config] ulr-softmax-temperature: 1
[2023-07-19 14:56:46] [config] ulr-trainable-transformation: false
[2023-07-19 14:56:46] [config] unlikelihood-loss: false
[2023-07-19 14:56:46] [config] valid-freq: 50000000
[2023-07-19 14:56:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 14:56:46] [config] valid-max-length: 1000
[2023-07-19 14:56:46] [config] valid-metrics:
[2023-07-19 14:56:46] [config]   - cross-entropy
[2023-07-19 14:56:46] [config]   - translation
[2023-07-19 14:56:46] [config] valid-mini-batch: 32
[2023-07-19 14:56:46] [config] valid-reset-stalled: false
[2023-07-19 14:56:46] [config] valid-script-args:
[2023-07-19 14:56:46] [config]   []
[2023-07-19 14:56:46] [config] valid-script-path: ""
[2023-07-19 14:56:46] [config] valid-sets:
[2023-07-19 14:56:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 14:56:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 14:56:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 14:56:46] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 14:56:46] [config] vocabs:
[2023-07-19 14:56:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 14:56:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 14:56:46] [config] word-penalty: 0
[2023-07-19 14:56:46] [config] word-scores: false
[2023-07-19 14:56:46] [config] workspace: 5500
[2023-07-19 14:56:46] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 14:56:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 14:56:46] [training] Using single-device training
[2023-07-19 14:56:46] Synced seed 1234
[2023-07-19 14:56:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 14:56:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 14:56:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 14:56:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 14:56:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 14:56:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 14:56:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 14:56:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 14:56:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 14:56:48] [comm] Using global sharding
[2023-07-19 14:56:48] [comm] NCCLCommunicators constructed successfully
[2023-07-19 14:56:48] [training] Using 1 GPUs
[2023-07-19 14:56:48] [logits] Applying loss function for 1 factor(s)
[2023-07-19 14:56:48] [memory] Reserving 80 MB, device gpu0
[2023-07-19 14:56:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 14:56:48] [memory] Reserving 80 MB, device gpu0
[2023-07-19 15:36:20] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 15:36:20] [valid] No post-processing script given for validating translator
[2023-07-19 15:36:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 15:36:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 15:36:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 15:36:20] [comm] Using global sharding
[2023-07-19 15:36:20] [comm] NCCLCommunicators constructed successfully
[2023-07-19 15:36:20] [training] Using 1 GPUs
[2023-07-19 15:36:20] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 15:36:21] Allocating memory for general optimizer shards
[2023-07-19 15:36:21] [memory] Reserving 322 MB, device gpu0
[2023-07-19 15:36:21] Loading Adam parameters
[2023-07-19 15:36:21] [memory] Reserving 322 MB, device gpu0
[2023-07-19 15:36:21] [memory] Reserving 80 MB, device gpu0
[2023-07-19 15:36:22] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 15:36:22] [data] Restoring the corpus state to epoch 41, batch 1545
[2023-07-19 15:36:22] [data] Shuffling data
[2023-07-19 15:36:22] [data] Done reading 20,192 sentences
[2023-07-19 15:36:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 15:36:22] Training started
[2023-07-19 15:36:22] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 15:36:22] [memory] Reserving 80 MB, device gpu0
[2023-07-19 15:36:30] Parameter type float16, optimization type float32, casting types true
[2023-07-19 15:41:06] Seen 20,192 samples
[2023-07-19 15:41:06] Starting data epoch 42 in logical epoch 42
[2023-07-19 15:41:06] [data] Shuffling data
[2023-07-19 15:41:06] [data] Done reading 20,192 sentences
[2023-07-19 15:41:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 15:46:15] Seen 20,192 samples
[2023-07-19 15:46:15] Starting data epoch 43 in logical epoch 43
[2023-07-19 15:46:15] [data] Shuffling data
[2023-07-19 15:46:15] [data] Done reading 20,192 sentences
[2023-07-19 15:46:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 15:51:30] Seen 20,192 samples
[2023-07-19 15:51:30] Starting data epoch 44 in logical epoch 44
[2023-07-19 15:51:30] [data] Shuffling data
[2023-07-19 15:51:30] [data] Done reading 20,192 sentences
[2023-07-19 15:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 15:56:38] Seen 20,192 samples
[2023-07-19 15:56:38] Starting data epoch 45 in logical epoch 45
[2023-07-19 15:56:38] [data] Shuffling data
[2023-07-19 15:56:38] [data] Done reading 20,192 sentences
[2023-07-19 15:56:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 16:01:41] Seen 20,192 samples
[2023-07-19 16:01:41] Starting data epoch 46 in logical epoch 46
[2023-07-19 16:01:41] [data] Shuffling data
[2023-07-19 16:01:42] [data] Done reading 20,192 sentences
[2023-07-19 16:01:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 16:06:47] Seen 20,192 samples
[2023-07-19 16:06:47] Starting data epoch 47 in logical epoch 47
[2023-07-19 16:06:47] [data] Shuffling data
[2023-07-19 16:06:48] [data] Done reading 20,192 sentences
[2023-07-19 16:06:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 16:11:56] Seen 20,192 samples
[2023-07-19 16:11:56] Starting data epoch 48 in logical epoch 48
[2023-07-19 16:11:56] [data] Shuffling data
[2023-07-19 16:11:56] [data] Done reading 20,192 sentences
[2023-07-19 16:11:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 16:17:04] Seen 20,192 samples
[2023-07-19 16:17:04] Starting data epoch 49 in logical epoch 49
[2023-07-19 16:17:04] [data] Shuffling data
[2023-07-19 16:17:04] [data] Done reading 20,192 sentences
[2023-07-19 16:17:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 16:22:07] Seen 20,192 samples
[2023-07-19 16:22:07] Starting data epoch 50 in logical epoch 50
[2023-07-19 16:22:07] [data] Shuffling data
[2023-07-19 16:22:07] [data] Done reading 20,192 sentences
[2023-07-19 16:22:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 16:27:02] Seen 20,192 samples
[2023-07-19 16:27:02] Starting data epoch 51 in logical epoch 51
[2023-07-19 16:27:02] Training finished
[2023-07-19 16:27:13] [valid] Ep. 51 : Up. 1930 : cross-entropy : 143.788 : new best
[2023-07-19 16:30:09] [valid] Ep. 51 : Up. 1930 : translation : 0 : new best
[2023-07-19 16:30:09] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 16:30:10] Saving Adam parameters
[2023-07-19 16:30:11] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 16:30:19] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 16:30:19] [marian] Running on node18.datos.cluster.uy as process 24434 with command line:
[2023-07-19 16:30:19] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 16:30:19] [config] after: 0e
[2023-07-19 16:30:19] [config] after-batches: 0
[2023-07-19 16:30:19] [config] after-epochs: 60
[2023-07-19 16:30:19] [config] all-caps-every: 0
[2023-07-19 16:30:19] [config] allow-unk: false
[2023-07-19 16:30:19] [config] authors: false
[2023-07-19 16:30:19] [config] beam-size: 12
[2023-07-19 16:30:19] [config] bert-class-symbol: "[CLS]"
[2023-07-19 16:30:19] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 16:30:19] [config] bert-masking-fraction: 0.15
[2023-07-19 16:30:19] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 16:30:19] [config] bert-train-type-embeddings: true
[2023-07-19 16:30:19] [config] bert-type-vocab-size: 2
[2023-07-19 16:30:19] [config] build-info: ""
[2023-07-19 16:30:19] [config] check-gradient-nan: false
[2023-07-19 16:30:19] [config] check-nan: false
[2023-07-19 16:30:19] [config] cite: false
[2023-07-19 16:30:19] [config] clip-norm: 1
[2023-07-19 16:30:19] [config] cost-scaling:
[2023-07-19 16:30:19] [config]   - 256.f
[2023-07-19 16:30:19] [config]   - 1000
[2023-07-19 16:30:19] [config]   - 2.f
[2023-07-19 16:30:19] [config]   - 256.f
[2023-07-19 16:30:19] [config] cost-type: ce-sum
[2023-07-19 16:30:19] [config] cpu-threads: 0
[2023-07-19 16:30:19] [config] data-threads: 8
[2023-07-19 16:30:19] [config] data-weighting: ""
[2023-07-19 16:30:19] [config] data-weighting-type: sentence
[2023-07-19 16:30:19] [config] dec-cell: gru
[2023-07-19 16:30:19] [config] dec-cell-base-depth: 2
[2023-07-19 16:30:19] [config] dec-cell-high-depth: 1
[2023-07-19 16:30:19] [config] dec-depth: 1
[2023-07-19 16:30:19] [config] devices:
[2023-07-19 16:30:19] [config]   - 0
[2023-07-19 16:30:19] [config] dim-emb: 512
[2023-07-19 16:30:19] [config] dim-rnn: 1024
[2023-07-19 16:30:19] [config] dim-vocabs:
[2023-07-19 16:30:19] [config]   - 16384
[2023-07-19 16:30:19] [config]   - 16384
[2023-07-19 16:30:19] [config] disp-first: 0
[2023-07-19 16:30:19] [config] disp-freq: 1000u
[2023-07-19 16:30:19] [config] disp-label-counts: true
[2023-07-19 16:30:19] [config] dropout-rnn: 0
[2023-07-19 16:30:19] [config] dropout-src: 0
[2023-07-19 16:30:19] [config] dropout-trg: 0
[2023-07-19 16:30:19] [config] dump-config: ""
[2023-07-19 16:30:19] [config] dynamic-gradient-scaling:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] early-stopping: 200
[2023-07-19 16:30:19] [config] early-stopping-on: first
[2023-07-19 16:30:19] [config] embedding-fix-src: false
[2023-07-19 16:30:19] [config] embedding-fix-trg: false
[2023-07-19 16:30:19] [config] embedding-normalization: false
[2023-07-19 16:30:19] [config] embedding-vectors:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] enc-cell: gru
[2023-07-19 16:30:19] [config] enc-cell-depth: 1
[2023-07-19 16:30:19] [config] enc-depth: 1
[2023-07-19 16:30:19] [config] enc-type: bidirectional
[2023-07-19 16:30:19] [config] english-title-case-every: 0
[2023-07-19 16:30:19] [config] exponential-smoothing: 0
[2023-07-19 16:30:19] [config] factor-weight: 1
[2023-07-19 16:30:19] [config] factors-combine: sum
[2023-07-19 16:30:19] [config] factors-dim-emb: 0
[2023-07-19 16:30:19] [config] gradient-checkpointing: false
[2023-07-19 16:30:19] [config] gradient-norm-average-window: 100
[2023-07-19 16:30:19] [config] guided-alignment: none
[2023-07-19 16:30:19] [config] guided-alignment-cost: mse
[2023-07-19 16:30:19] [config] guided-alignment-weight: 0.1
[2023-07-19 16:30:19] [config] ignore-model-config: false
[2023-07-19 16:30:19] [config] input-types:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] interpolate-env-vars: false
[2023-07-19 16:30:19] [config] keep-best: false
[2023-07-19 16:30:19] [config] label-smoothing: 0
[2023-07-19 16:30:19] [config] layer-normalization: false
[2023-07-19 16:30:19] [config] learn-rate: 0.0001
[2023-07-19 16:30:19] [config] lemma-dependency: ""
[2023-07-19 16:30:19] [config] lemma-dim-emb: 0
[2023-07-19 16:30:19] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 16:30:19] [config] log-level: info
[2023-07-19 16:30:19] [config] log-time-zone: ""
[2023-07-19 16:30:19] [config] logical-epoch:
[2023-07-19 16:30:19] [config]   - 1e
[2023-07-19 16:30:19] [config]   - 0
[2023-07-19 16:30:19] [config] lr-decay: 0
[2023-07-19 16:30:19] [config] lr-decay-freq: 50000
[2023-07-19 16:30:19] [config] lr-decay-inv-sqrt:
[2023-07-19 16:30:19] [config]   - 0
[2023-07-19 16:30:19] [config] lr-decay-repeat-warmup: false
[2023-07-19 16:30:19] [config] lr-decay-reset-optimizer: false
[2023-07-19 16:30:19] [config] lr-decay-start:
[2023-07-19 16:30:19] [config]   - 10
[2023-07-19 16:30:19] [config]   - 1
[2023-07-19 16:30:19] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 16:30:19] [config] lr-report: false
[2023-07-19 16:30:19] [config] lr-warmup: 0
[2023-07-19 16:30:19] [config] lr-warmup-at-reload: false
[2023-07-19 16:30:19] [config] lr-warmup-cycle: false
[2023-07-19 16:30:19] [config] lr-warmup-start-rate: 0
[2023-07-19 16:30:19] [config] max-length: 200
[2023-07-19 16:30:19] [config] max-length-crop: true
[2023-07-19 16:30:19] [config] max-length-factor: 3
[2023-07-19 16:30:19] [config] maxi-batch: 100
[2023-07-19 16:30:19] [config] maxi-batch-sort: trg
[2023-07-19 16:30:19] [config] mini-batch: 64
[2023-07-19 16:30:19] [config] mini-batch-fit: true
[2023-07-19 16:30:19] [config] mini-batch-fit-step: 10
[2023-07-19 16:30:19] [config] mini-batch-round-up: true
[2023-07-19 16:30:19] [config] mini-batch-track-lr: false
[2023-07-19 16:30:19] [config] mini-batch-warmup: 0
[2023-07-19 16:30:19] [config] mini-batch-words: 0
[2023-07-19 16:30:19] [config] mini-batch-words-ref: 0
[2023-07-19 16:30:19] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 16:30:19] [config] multi-loss-type: sum
[2023-07-19 16:30:19] [config] n-best: false
[2023-07-19 16:30:19] [config] no-nccl: false
[2023-07-19 16:30:19] [config] no-reload: false
[2023-07-19 16:30:19] [config] no-restore-corpus: false
[2023-07-19 16:30:19] [config] normalize: 0
[2023-07-19 16:30:19] [config] normalize-gradient: false
[2023-07-19 16:30:19] [config] num-devices: 0
[2023-07-19 16:30:19] [config] optimizer: adam
[2023-07-19 16:30:19] [config] optimizer-delay: 1
[2023-07-19 16:30:19] [config] optimizer-params:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] output-omit-bias: false
[2023-07-19 16:30:19] [config] overwrite: true
[2023-07-19 16:30:19] [config] precision:
[2023-07-19 16:30:19] [config]   - float16
[2023-07-19 16:30:19] [config]   - float32
[2023-07-19 16:30:19] [config] pretrained-model: ""
[2023-07-19 16:30:19] [config] quantize-biases: false
[2023-07-19 16:30:19] [config] quantize-bits: 0
[2023-07-19 16:30:19] [config] quantize-log-based: false
[2023-07-19 16:30:19] [config] quantize-optimization-steps: 0
[2023-07-19 16:30:19] [config] quiet: false
[2023-07-19 16:30:19] [config] quiet-translation: true
[2023-07-19 16:30:19] [config] relative-paths: false
[2023-07-19 16:30:19] [config] right-left: false
[2023-07-19 16:30:19] [config] save-freq: 10000u
[2023-07-19 16:30:19] [config] seed: 1234
[2023-07-19 16:30:19] [config] sentencepiece-alphas:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] sentencepiece-max-lines: 2000000
[2023-07-19 16:30:19] [config] sentencepiece-options: ""
[2023-07-19 16:30:19] [config] sharding: global
[2023-07-19 16:30:19] [config] shuffle: data
[2023-07-19 16:30:19] [config] shuffle-in-ram: false
[2023-07-19 16:30:19] [config] sigterm: save-and-exit
[2023-07-19 16:30:19] [config] skip: false
[2023-07-19 16:30:19] [config] sqlite: ""
[2023-07-19 16:30:19] [config] sqlite-drop: false
[2023-07-19 16:30:19] [config] sync-freq: 200u
[2023-07-19 16:30:19] [config] sync-sgd: false
[2023-07-19 16:30:19] [config] tempdir: /tmp
[2023-07-19 16:30:19] [config] tied-embeddings: false
[2023-07-19 16:30:19] [config] tied-embeddings-all: true
[2023-07-19 16:30:19] [config] tied-embeddings-src: false
[2023-07-19 16:30:19] [config] train-embedder-rank:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] train-sets:
[2023-07-19 16:30:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 16:30:19] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 16:30:19] [config] transformer-aan-activation: swish
[2023-07-19 16:30:19] [config] transformer-aan-depth: 2
[2023-07-19 16:30:19] [config] transformer-aan-nogate: false
[2023-07-19 16:30:19] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 16:30:19] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 16:30:19] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 16:30:19] [config] transformer-depth-scaling: false
[2023-07-19 16:30:19] [config] transformer-dim-aan: 2048
[2023-07-19 16:30:19] [config] transformer-dim-ffn: 2048
[2023-07-19 16:30:19] [config] transformer-dropout: 0
[2023-07-19 16:30:19] [config] transformer-dropout-attention: 0
[2023-07-19 16:30:19] [config] transformer-dropout-ffn: 0
[2023-07-19 16:30:19] [config] transformer-ffn-activation: swish
[2023-07-19 16:30:19] [config] transformer-ffn-depth: 2
[2023-07-19 16:30:19] [config] transformer-guided-alignment-layer: last
[2023-07-19 16:30:19] [config] transformer-heads: 8
[2023-07-19 16:30:19] [config] transformer-no-projection: false
[2023-07-19 16:30:19] [config] transformer-pool: false
[2023-07-19 16:30:19] [config] transformer-postprocess: dan
[2023-07-19 16:30:19] [config] transformer-postprocess-emb: d
[2023-07-19 16:30:19] [config] transformer-postprocess-top: ""
[2023-07-19 16:30:19] [config] transformer-preprocess: ""
[2023-07-19 16:30:19] [config] transformer-tied-layers:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] transformer-train-position-embeddings: false
[2023-07-19 16:30:19] [config] tsv: false
[2023-07-19 16:30:19] [config] tsv-fields: 0
[2023-07-19 16:30:19] [config] type: amun
[2023-07-19 16:30:19] [config] ulr: false
[2023-07-19 16:30:19] [config] ulr-dim-emb: 0
[2023-07-19 16:30:19] [config] ulr-dropout: 0
[2023-07-19 16:30:19] [config] ulr-keys-vectors: ""
[2023-07-19 16:30:19] [config] ulr-query-vectors: ""
[2023-07-19 16:30:19] [config] ulr-softmax-temperature: 1
[2023-07-19 16:30:19] [config] ulr-trainable-transformation: false
[2023-07-19 16:30:19] [config] unlikelihood-loss: false
[2023-07-19 16:30:19] [config] valid-freq: 50000000
[2023-07-19 16:30:19] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 16:30:19] [config] valid-max-length: 1000
[2023-07-19 16:30:19] [config] valid-metrics:
[2023-07-19 16:30:19] [config]   - cross-entropy
[2023-07-19 16:30:19] [config]   - translation
[2023-07-19 16:30:19] [config] valid-mini-batch: 32
[2023-07-19 16:30:19] [config] valid-reset-stalled: false
[2023-07-19 16:30:19] [config] valid-script-args:
[2023-07-19 16:30:19] [config]   []
[2023-07-19 16:30:19] [config] valid-script-path: ""
[2023-07-19 16:30:19] [config] valid-sets:
[2023-07-19 16:30:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 16:30:19] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 16:30:19] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 16:30:19] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 16:30:19] [config] vocabs:
[2023-07-19 16:30:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 16:30:19] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 16:30:19] [config] word-penalty: 0
[2023-07-19 16:30:19] [config] word-scores: false
[2023-07-19 16:30:19] [config] workspace: 5500
[2023-07-19 16:30:19] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 16:30:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 16:30:19] [training] Using single-device training
[2023-07-19 16:30:19] Synced seed 1234
[2023-07-19 16:30:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 16:30:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 16:30:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 16:30:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 16:30:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 16:30:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 16:30:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 16:30:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 16:30:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 16:30:21] [comm] Using global sharding
[2023-07-19 16:30:21] [comm] NCCLCommunicators constructed successfully
[2023-07-19 16:30:21] [training] Using 1 GPUs
[2023-07-19 16:30:21] [logits] Applying loss function for 1 factor(s)
[2023-07-19 16:30:21] [memory] Reserving 80 MB, device gpu0
[2023-07-19 16:30:21] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 16:30:21] [memory] Reserving 80 MB, device gpu0
[2023-07-19 17:09:56] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 17:09:56] [valid] No post-processing script given for validating translator
[2023-07-19 17:09:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 17:09:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 17:09:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 17:09:56] [comm] Using global sharding
[2023-07-19 17:09:56] [comm] NCCLCommunicators constructed successfully
[2023-07-19 17:09:56] [training] Using 1 GPUs
[2023-07-19 17:09:56] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 17:09:58] Allocating memory for general optimizer shards
[2023-07-19 17:09:58] [memory] Reserving 322 MB, device gpu0
[2023-07-19 17:09:58] Loading Adam parameters
[2023-07-19 17:09:58] [memory] Reserving 322 MB, device gpu0
[2023-07-19 17:09:58] [memory] Reserving 80 MB, device gpu0
[2023-07-19 17:09:58] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 17:09:58] [data] Restoring the corpus state to epoch 51, batch 1930
[2023-07-19 17:09:58] [data] Shuffling data
[2023-07-19 17:09:58] [data] Done reading 20,192 sentences
[2023-07-19 17:09:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:09:58] Training started
[2023-07-19 17:09:58] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 17:10:00] [memory] Reserving 80 MB, device gpu0
[2023-07-19 17:10:14] Parameter type float16, optimization type float32, casting types true
[2023-07-19 17:14:54] Seen 20,192 samples
[2023-07-19 17:14:54] Starting data epoch 52 in logical epoch 52
[2023-07-19 17:14:54] [data] Shuffling data
[2023-07-19 17:14:54] [data] Done reading 20,192 sentences
[2023-07-19 17:14:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:19:12] Ep. 52 : Up. 2000 : Sen. 17,785 : Cost 4.85965967 * 16,062,262 @ 24,690 after 32,174,302 : Time 556.25s : 28875.95 words/s : gNorm 0.9070
[2023-07-19 17:19:54] Seen 20,192 samples
[2023-07-19 17:19:54] Starting data epoch 53 in logical epoch 53
[2023-07-19 17:19:54] [data] Shuffling data
[2023-07-19 17:19:54] [data] Done reading 20,192 sentences
[2023-07-19 17:19:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:24:43] Seen 20,192 samples
[2023-07-19 17:24:43] Starting data epoch 54 in logical epoch 54
[2023-07-19 17:24:43] [data] Shuffling data
[2023-07-19 17:24:43] [data] Done reading 20,192 sentences
[2023-07-19 17:24:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:29:41] Seen 20,192 samples
[2023-07-19 17:29:41] Starting data epoch 55 in logical epoch 55
[2023-07-19 17:29:41] [data] Shuffling data
[2023-07-19 17:29:41] [data] Done reading 20,192 sentences
[2023-07-19 17:29:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:34:35] Seen 20,192 samples
[2023-07-19 17:34:35] Starting data epoch 56 in logical epoch 56
[2023-07-19 17:34:35] [data] Shuffling data
[2023-07-19 17:34:35] [data] Done reading 20,192 sentences
[2023-07-19 17:34:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:39:25] Seen 20,192 samples
[2023-07-19 17:39:25] Starting data epoch 57 in logical epoch 57
[2023-07-19 17:39:25] [data] Shuffling data
[2023-07-19 17:39:25] [data] Done reading 20,192 sentences
[2023-07-19 17:39:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:44:24] Seen 20,192 samples
[2023-07-19 17:44:24] Starting data epoch 58 in logical epoch 58
[2023-07-19 17:44:24] [data] Shuffling data
[2023-07-19 17:44:24] [data] Done reading 20,192 sentences
[2023-07-19 17:44:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:49:17] Seen 20,192 samples
[2023-07-19 17:49:17] Starting data epoch 59 in logical epoch 59
[2023-07-19 17:49:17] [data] Shuffling data
[2023-07-19 17:49:17] [data] Done reading 20,192 sentences
[2023-07-19 17:49:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:54:09] Seen 20,192 samples
[2023-07-19 17:54:09] Starting data epoch 60 in logical epoch 60
[2023-07-19 17:54:09] [data] Shuffling data
[2023-07-19 17:54:09] [data] Done reading 20,192 sentences
[2023-07-19 17:54:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 17:59:02] Seen 20,192 samples
[2023-07-19 17:59:02] Starting data epoch 61 in logical epoch 61
[2023-07-19 17:59:02] Training finished
[2023-07-19 17:59:15] [valid] Ep. 61 : Up. 2313 : cross-entropy : 139.634 : new best
[2023-07-19 18:01:28] [valid] Ep. 61 : Up. 2313 : translation : 0 : new best
[2023-07-19 18:01:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 18:01:30] Saving Adam parameters
[2023-07-19 18:01:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 18:01:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 18:01:39] [marian] Running on node18.datos.cluster.uy as process 30310 with command line:
[2023-07-19 18:01:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 18:01:39] [config] after: 0e
[2023-07-19 18:01:39] [config] after-batches: 0
[2023-07-19 18:01:39] [config] after-epochs: 70
[2023-07-19 18:01:39] [config] all-caps-every: 0
[2023-07-19 18:01:39] [config] allow-unk: false
[2023-07-19 18:01:39] [config] authors: false
[2023-07-19 18:01:39] [config] beam-size: 12
[2023-07-19 18:01:39] [config] bert-class-symbol: "[CLS]"
[2023-07-19 18:01:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 18:01:39] [config] bert-masking-fraction: 0.15
[2023-07-19 18:01:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 18:01:39] [config] bert-train-type-embeddings: true
[2023-07-19 18:01:39] [config] bert-type-vocab-size: 2
[2023-07-19 18:01:39] [config] build-info: ""
[2023-07-19 18:01:39] [config] check-gradient-nan: false
[2023-07-19 18:01:39] [config] check-nan: false
[2023-07-19 18:01:39] [config] cite: false
[2023-07-19 18:01:39] [config] clip-norm: 1
[2023-07-19 18:01:39] [config] cost-scaling:
[2023-07-19 18:01:39] [config]   - 256.f
[2023-07-19 18:01:39] [config]   - 1000
[2023-07-19 18:01:39] [config]   - 2.f
[2023-07-19 18:01:39] [config]   - 256.f
[2023-07-19 18:01:39] [config] cost-type: ce-sum
[2023-07-19 18:01:39] [config] cpu-threads: 0
[2023-07-19 18:01:39] [config] data-threads: 8
[2023-07-19 18:01:39] [config] data-weighting: ""
[2023-07-19 18:01:39] [config] data-weighting-type: sentence
[2023-07-19 18:01:39] [config] dec-cell: gru
[2023-07-19 18:01:39] [config] dec-cell-base-depth: 2
[2023-07-19 18:01:39] [config] dec-cell-high-depth: 1
[2023-07-19 18:01:39] [config] dec-depth: 1
[2023-07-19 18:01:39] [config] devices:
[2023-07-19 18:01:39] [config]   - 0
[2023-07-19 18:01:39] [config] dim-emb: 512
[2023-07-19 18:01:39] [config] dim-rnn: 1024
[2023-07-19 18:01:39] [config] dim-vocabs:
[2023-07-19 18:01:39] [config]   - 16384
[2023-07-19 18:01:39] [config]   - 16384
[2023-07-19 18:01:39] [config] disp-first: 0
[2023-07-19 18:01:39] [config] disp-freq: 1000u
[2023-07-19 18:01:39] [config] disp-label-counts: true
[2023-07-19 18:01:39] [config] dropout-rnn: 0
[2023-07-19 18:01:39] [config] dropout-src: 0
[2023-07-19 18:01:39] [config] dropout-trg: 0
[2023-07-19 18:01:39] [config] dump-config: ""
[2023-07-19 18:01:39] [config] dynamic-gradient-scaling:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] early-stopping: 200
[2023-07-19 18:01:39] [config] early-stopping-on: first
[2023-07-19 18:01:39] [config] embedding-fix-src: false
[2023-07-19 18:01:39] [config] embedding-fix-trg: false
[2023-07-19 18:01:39] [config] embedding-normalization: false
[2023-07-19 18:01:39] [config] embedding-vectors:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] enc-cell: gru
[2023-07-19 18:01:39] [config] enc-cell-depth: 1
[2023-07-19 18:01:39] [config] enc-depth: 1
[2023-07-19 18:01:39] [config] enc-type: bidirectional
[2023-07-19 18:01:39] [config] english-title-case-every: 0
[2023-07-19 18:01:39] [config] exponential-smoothing: 0
[2023-07-19 18:01:39] [config] factor-weight: 1
[2023-07-19 18:01:39] [config] factors-combine: sum
[2023-07-19 18:01:39] [config] factors-dim-emb: 0
[2023-07-19 18:01:39] [config] gradient-checkpointing: false
[2023-07-19 18:01:39] [config] gradient-norm-average-window: 100
[2023-07-19 18:01:39] [config] guided-alignment: none
[2023-07-19 18:01:39] [config] guided-alignment-cost: mse
[2023-07-19 18:01:39] [config] guided-alignment-weight: 0.1
[2023-07-19 18:01:39] [config] ignore-model-config: false
[2023-07-19 18:01:39] [config] input-types:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] interpolate-env-vars: false
[2023-07-19 18:01:39] [config] keep-best: false
[2023-07-19 18:01:39] [config] label-smoothing: 0
[2023-07-19 18:01:39] [config] layer-normalization: false
[2023-07-19 18:01:39] [config] learn-rate: 0.0001
[2023-07-19 18:01:39] [config] lemma-dependency: ""
[2023-07-19 18:01:39] [config] lemma-dim-emb: 0
[2023-07-19 18:01:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 18:01:39] [config] log-level: info
[2023-07-19 18:01:39] [config] log-time-zone: ""
[2023-07-19 18:01:39] [config] logical-epoch:
[2023-07-19 18:01:39] [config]   - 1e
[2023-07-19 18:01:39] [config]   - 0
[2023-07-19 18:01:39] [config] lr-decay: 0
[2023-07-19 18:01:39] [config] lr-decay-freq: 50000
[2023-07-19 18:01:39] [config] lr-decay-inv-sqrt:
[2023-07-19 18:01:39] [config]   - 0
[2023-07-19 18:01:39] [config] lr-decay-repeat-warmup: false
[2023-07-19 18:01:39] [config] lr-decay-reset-optimizer: false
[2023-07-19 18:01:39] [config] lr-decay-start:
[2023-07-19 18:01:39] [config]   - 10
[2023-07-19 18:01:39] [config]   - 1
[2023-07-19 18:01:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 18:01:39] [config] lr-report: false
[2023-07-19 18:01:39] [config] lr-warmup: 0
[2023-07-19 18:01:39] [config] lr-warmup-at-reload: false
[2023-07-19 18:01:39] [config] lr-warmup-cycle: false
[2023-07-19 18:01:39] [config] lr-warmup-start-rate: 0
[2023-07-19 18:01:39] [config] max-length: 200
[2023-07-19 18:01:39] [config] max-length-crop: true
[2023-07-19 18:01:39] [config] max-length-factor: 3
[2023-07-19 18:01:39] [config] maxi-batch: 100
[2023-07-19 18:01:39] [config] maxi-batch-sort: trg
[2023-07-19 18:01:39] [config] mini-batch: 64
[2023-07-19 18:01:39] [config] mini-batch-fit: true
[2023-07-19 18:01:39] [config] mini-batch-fit-step: 10
[2023-07-19 18:01:39] [config] mini-batch-round-up: true
[2023-07-19 18:01:39] [config] mini-batch-track-lr: false
[2023-07-19 18:01:39] [config] mini-batch-warmup: 0
[2023-07-19 18:01:39] [config] mini-batch-words: 0
[2023-07-19 18:01:39] [config] mini-batch-words-ref: 0
[2023-07-19 18:01:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 18:01:39] [config] multi-loss-type: sum
[2023-07-19 18:01:39] [config] n-best: false
[2023-07-19 18:01:39] [config] no-nccl: false
[2023-07-19 18:01:39] [config] no-reload: false
[2023-07-19 18:01:39] [config] no-restore-corpus: false
[2023-07-19 18:01:39] [config] normalize: 0
[2023-07-19 18:01:39] [config] normalize-gradient: false
[2023-07-19 18:01:39] [config] num-devices: 0
[2023-07-19 18:01:39] [config] optimizer: adam
[2023-07-19 18:01:39] [config] optimizer-delay: 1
[2023-07-19 18:01:39] [config] optimizer-params:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] output-omit-bias: false
[2023-07-19 18:01:39] [config] overwrite: true
[2023-07-19 18:01:39] [config] precision:
[2023-07-19 18:01:39] [config]   - float16
[2023-07-19 18:01:39] [config]   - float32
[2023-07-19 18:01:39] [config] pretrained-model: ""
[2023-07-19 18:01:39] [config] quantize-biases: false
[2023-07-19 18:01:39] [config] quantize-bits: 0
[2023-07-19 18:01:39] [config] quantize-log-based: false
[2023-07-19 18:01:39] [config] quantize-optimization-steps: 0
[2023-07-19 18:01:39] [config] quiet: false
[2023-07-19 18:01:39] [config] quiet-translation: true
[2023-07-19 18:01:39] [config] relative-paths: false
[2023-07-19 18:01:39] [config] right-left: false
[2023-07-19 18:01:39] [config] save-freq: 10000u
[2023-07-19 18:01:39] [config] seed: 1234
[2023-07-19 18:01:39] [config] sentencepiece-alphas:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] sentencepiece-max-lines: 2000000
[2023-07-19 18:01:39] [config] sentencepiece-options: ""
[2023-07-19 18:01:39] [config] sharding: global
[2023-07-19 18:01:39] [config] shuffle: data
[2023-07-19 18:01:39] [config] shuffle-in-ram: false
[2023-07-19 18:01:39] [config] sigterm: save-and-exit
[2023-07-19 18:01:39] [config] skip: false
[2023-07-19 18:01:39] [config] sqlite: ""
[2023-07-19 18:01:39] [config] sqlite-drop: false
[2023-07-19 18:01:39] [config] sync-freq: 200u
[2023-07-19 18:01:39] [config] sync-sgd: false
[2023-07-19 18:01:39] [config] tempdir: /tmp
[2023-07-19 18:01:39] [config] tied-embeddings: false
[2023-07-19 18:01:39] [config] tied-embeddings-all: true
[2023-07-19 18:01:39] [config] tied-embeddings-src: false
[2023-07-19 18:01:39] [config] train-embedder-rank:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] train-sets:
[2023-07-19 18:01:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 18:01:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 18:01:39] [config] transformer-aan-activation: swish
[2023-07-19 18:01:39] [config] transformer-aan-depth: 2
[2023-07-19 18:01:39] [config] transformer-aan-nogate: false
[2023-07-19 18:01:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 18:01:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 18:01:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 18:01:39] [config] transformer-depth-scaling: false
[2023-07-19 18:01:39] [config] transformer-dim-aan: 2048
[2023-07-19 18:01:39] [config] transformer-dim-ffn: 2048
[2023-07-19 18:01:39] [config] transformer-dropout: 0
[2023-07-19 18:01:39] [config] transformer-dropout-attention: 0
[2023-07-19 18:01:39] [config] transformer-dropout-ffn: 0
[2023-07-19 18:01:39] [config] transformer-ffn-activation: swish
[2023-07-19 18:01:39] [config] transformer-ffn-depth: 2
[2023-07-19 18:01:39] [config] transformer-guided-alignment-layer: last
[2023-07-19 18:01:39] [config] transformer-heads: 8
[2023-07-19 18:01:39] [config] transformer-no-projection: false
[2023-07-19 18:01:39] [config] transformer-pool: false
[2023-07-19 18:01:39] [config] transformer-postprocess: dan
[2023-07-19 18:01:39] [config] transformer-postprocess-emb: d
[2023-07-19 18:01:39] [config] transformer-postprocess-top: ""
[2023-07-19 18:01:39] [config] transformer-preprocess: ""
[2023-07-19 18:01:39] [config] transformer-tied-layers:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] transformer-train-position-embeddings: false
[2023-07-19 18:01:39] [config] tsv: false
[2023-07-19 18:01:39] [config] tsv-fields: 0
[2023-07-19 18:01:39] [config] type: amun
[2023-07-19 18:01:39] [config] ulr: false
[2023-07-19 18:01:39] [config] ulr-dim-emb: 0
[2023-07-19 18:01:39] [config] ulr-dropout: 0
[2023-07-19 18:01:39] [config] ulr-keys-vectors: ""
[2023-07-19 18:01:39] [config] ulr-query-vectors: ""
[2023-07-19 18:01:39] [config] ulr-softmax-temperature: 1
[2023-07-19 18:01:39] [config] ulr-trainable-transformation: false
[2023-07-19 18:01:39] [config] unlikelihood-loss: false
[2023-07-19 18:01:39] [config] valid-freq: 50000000
[2023-07-19 18:01:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 18:01:39] [config] valid-max-length: 1000
[2023-07-19 18:01:39] [config] valid-metrics:
[2023-07-19 18:01:39] [config]   - cross-entropy
[2023-07-19 18:01:39] [config]   - translation
[2023-07-19 18:01:39] [config] valid-mini-batch: 32
[2023-07-19 18:01:39] [config] valid-reset-stalled: false
[2023-07-19 18:01:39] [config] valid-script-args:
[2023-07-19 18:01:39] [config]   []
[2023-07-19 18:01:39] [config] valid-script-path: ""
[2023-07-19 18:01:39] [config] valid-sets:
[2023-07-19 18:01:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 18:01:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 18:01:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 18:01:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 18:01:39] [config] vocabs:
[2023-07-19 18:01:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 18:01:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 18:01:39] [config] word-penalty: 0
[2023-07-19 18:01:39] [config] word-scores: false
[2023-07-19 18:01:39] [config] workspace: 5500
[2023-07-19 18:01:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 18:01:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 18:01:39] [training] Using single-device training
[2023-07-19 18:01:40] Synced seed 1234
[2023-07-19 18:01:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 18:01:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 18:01:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 18:01:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 18:01:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 18:01:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 18:01:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 18:01:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 18:01:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 18:01:42] [comm] Using global sharding
[2023-07-19 18:01:42] [comm] NCCLCommunicators constructed successfully
[2023-07-19 18:01:42] [training] Using 1 GPUs
[2023-07-19 18:01:42] [logits] Applying loss function for 1 factor(s)
[2023-07-19 18:01:42] [memory] Reserving 80 MB, device gpu0
[2023-07-19 18:01:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 18:01:42] [memory] Reserving 80 MB, device gpu0
[2023-07-19 18:41:09] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 18:41:09] [valid] No post-processing script given for validating translator
[2023-07-19 18:41:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 18:41:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 18:41:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 18:41:09] [comm] Using global sharding
[2023-07-19 18:41:09] [comm] NCCLCommunicators constructed successfully
[2023-07-19 18:41:09] [training] Using 1 GPUs
[2023-07-19 18:41:09] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 18:41:10] Allocating memory for general optimizer shards
[2023-07-19 18:41:10] [memory] Reserving 322 MB, device gpu0
[2023-07-19 18:41:11] Loading Adam parameters
[2023-07-19 18:41:11] [memory] Reserving 322 MB, device gpu0
[2023-07-19 18:41:11] [memory] Reserving 80 MB, device gpu0
[2023-07-19 18:41:11] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 18:41:11] [data] Restoring the corpus state to epoch 61, batch 2313
[2023-07-19 18:41:11] [data] Shuffling data
[2023-07-19 18:41:11] [data] Done reading 20,192 sentences
[2023-07-19 18:41:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 18:41:11] Training started
[2023-07-19 18:41:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 18:41:12] [memory] Reserving 80 MB, device gpu0
[2023-07-19 18:41:18] Parameter type float16, optimization type float32, casting types true
[2023-07-19 18:45:47] Seen 20,192 samples
[2023-07-19 18:45:47] Starting data epoch 62 in logical epoch 62
[2023-07-19 18:45:47] [data] Shuffling data
[2023-07-19 18:45:47] [data] Done reading 20,192 sentences
[2023-07-19 18:45:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 18:50:36] Seen 20,192 samples
[2023-07-19 18:50:36] Starting data epoch 63 in logical epoch 63
[2023-07-19 18:50:36] [data] Shuffling data
[2023-07-19 18:50:36] [data] Done reading 20,192 sentences
[2023-07-19 18:50:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 18:55:22] Seen 20,192 samples
[2023-07-19 18:55:22] Starting data epoch 64 in logical epoch 64
[2023-07-19 18:55:22] [data] Shuffling data
[2023-07-19 18:55:22] [data] Done reading 20,192 sentences
[2023-07-19 18:55:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:00:07] Seen 20,192 samples
[2023-07-19 19:00:07] Starting data epoch 65 in logical epoch 65
[2023-07-19 19:00:07] [data] Shuffling data
[2023-07-19 19:00:07] [data] Done reading 20,192 sentences
[2023-07-19 19:00:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:04:49] Seen 20,192 samples
[2023-07-19 19:04:49] Starting data epoch 66 in logical epoch 66
[2023-07-19 19:04:49] [data] Shuffling data
[2023-07-19 19:04:49] [data] Done reading 20,192 sentences
[2023-07-19 19:04:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:09:32] Seen 20,192 samples
[2023-07-19 19:09:32] Starting data epoch 67 in logical epoch 67
[2023-07-19 19:09:32] [data] Shuffling data
[2023-07-19 19:09:32] [data] Done reading 20,192 sentences
[2023-07-19 19:09:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:14:25] Seen 20,192 samples
[2023-07-19 19:14:25] Starting data epoch 68 in logical epoch 68
[2023-07-19 19:14:25] [data] Shuffling data
[2023-07-19 19:14:25] [data] Done reading 20,192 sentences
[2023-07-19 19:14:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:19:11] Seen 20,192 samples
[2023-07-19 19:19:11] Starting data epoch 69 in logical epoch 69
[2023-07-19 19:19:11] [data] Shuffling data
[2023-07-19 19:19:11] [data] Done reading 20,192 sentences
[2023-07-19 19:19:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:23:47] Seen 20,192 samples
[2023-07-19 19:23:47] Starting data epoch 70 in logical epoch 70
[2023-07-19 19:23:47] [data] Shuffling data
[2023-07-19 19:23:47] [data] Done reading 20,192 sentences
[2023-07-19 19:23:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 19:28:34] Seen 20,192 samples
[2023-07-19 19:28:34] Starting data epoch 71 in logical epoch 71
[2023-07-19 19:28:34] Training finished
[2023-07-19 19:28:47] [valid] Ep. 71 : Up. 2696 : cross-entropy : 136.125 : new best
[2023-07-19 19:31:08] [valid] Ep. 71 : Up. 2696 : translation : 0 : new best
[2023-07-19 19:31:08] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 19:31:11] Saving Adam parameters
[2023-07-19 19:31:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 19:31:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 19:31:20] [marian] Running on node18.datos.cluster.uy as process 36164 with command line:
[2023-07-19 19:31:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 19:31:20] [config] after: 0e
[2023-07-19 19:31:20] [config] after-batches: 0
[2023-07-19 19:31:20] [config] after-epochs: 80
[2023-07-19 19:31:20] [config] all-caps-every: 0
[2023-07-19 19:31:20] [config] allow-unk: false
[2023-07-19 19:31:20] [config] authors: false
[2023-07-19 19:31:20] [config] beam-size: 12
[2023-07-19 19:31:20] [config] bert-class-symbol: "[CLS]"
[2023-07-19 19:31:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 19:31:20] [config] bert-masking-fraction: 0.15
[2023-07-19 19:31:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 19:31:20] [config] bert-train-type-embeddings: true
[2023-07-19 19:31:20] [config] bert-type-vocab-size: 2
[2023-07-19 19:31:20] [config] build-info: ""
[2023-07-19 19:31:20] [config] check-gradient-nan: false
[2023-07-19 19:31:20] [config] check-nan: false
[2023-07-19 19:31:20] [config] cite: false
[2023-07-19 19:31:20] [config] clip-norm: 1
[2023-07-19 19:31:20] [config] cost-scaling:
[2023-07-19 19:31:20] [config]   - 256.f
[2023-07-19 19:31:20] [config]   - 1000
[2023-07-19 19:31:20] [config]   - 2.f
[2023-07-19 19:31:20] [config]   - 256.f
[2023-07-19 19:31:20] [config] cost-type: ce-sum
[2023-07-19 19:31:20] [config] cpu-threads: 0
[2023-07-19 19:31:20] [config] data-threads: 8
[2023-07-19 19:31:20] [config] data-weighting: ""
[2023-07-19 19:31:20] [config] data-weighting-type: sentence
[2023-07-19 19:31:20] [config] dec-cell: gru
[2023-07-19 19:31:20] [config] dec-cell-base-depth: 2
[2023-07-19 19:31:20] [config] dec-cell-high-depth: 1
[2023-07-19 19:31:20] [config] dec-depth: 1
[2023-07-19 19:31:20] [config] devices:
[2023-07-19 19:31:20] [config]   - 0
[2023-07-19 19:31:20] [config] dim-emb: 512
[2023-07-19 19:31:20] [config] dim-rnn: 1024
[2023-07-19 19:31:20] [config] dim-vocabs:
[2023-07-19 19:31:20] [config]   - 16384
[2023-07-19 19:31:20] [config]   - 16384
[2023-07-19 19:31:20] [config] disp-first: 0
[2023-07-19 19:31:20] [config] disp-freq: 1000u
[2023-07-19 19:31:20] [config] disp-label-counts: true
[2023-07-19 19:31:20] [config] dropout-rnn: 0
[2023-07-19 19:31:20] [config] dropout-src: 0
[2023-07-19 19:31:20] [config] dropout-trg: 0
[2023-07-19 19:31:20] [config] dump-config: ""
[2023-07-19 19:31:20] [config] dynamic-gradient-scaling:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] early-stopping: 200
[2023-07-19 19:31:20] [config] early-stopping-on: first
[2023-07-19 19:31:20] [config] embedding-fix-src: false
[2023-07-19 19:31:20] [config] embedding-fix-trg: false
[2023-07-19 19:31:20] [config] embedding-normalization: false
[2023-07-19 19:31:20] [config] embedding-vectors:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] enc-cell: gru
[2023-07-19 19:31:20] [config] enc-cell-depth: 1
[2023-07-19 19:31:20] [config] enc-depth: 1
[2023-07-19 19:31:20] [config] enc-type: bidirectional
[2023-07-19 19:31:20] [config] english-title-case-every: 0
[2023-07-19 19:31:20] [config] exponential-smoothing: 0
[2023-07-19 19:31:20] [config] factor-weight: 1
[2023-07-19 19:31:20] [config] factors-combine: sum
[2023-07-19 19:31:20] [config] factors-dim-emb: 0
[2023-07-19 19:31:20] [config] gradient-checkpointing: false
[2023-07-19 19:31:20] [config] gradient-norm-average-window: 100
[2023-07-19 19:31:20] [config] guided-alignment: none
[2023-07-19 19:31:20] [config] guided-alignment-cost: mse
[2023-07-19 19:31:20] [config] guided-alignment-weight: 0.1
[2023-07-19 19:31:20] [config] ignore-model-config: false
[2023-07-19 19:31:20] [config] input-types:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] interpolate-env-vars: false
[2023-07-19 19:31:20] [config] keep-best: false
[2023-07-19 19:31:20] [config] label-smoothing: 0
[2023-07-19 19:31:20] [config] layer-normalization: false
[2023-07-19 19:31:20] [config] learn-rate: 0.0001
[2023-07-19 19:31:20] [config] lemma-dependency: ""
[2023-07-19 19:31:20] [config] lemma-dim-emb: 0
[2023-07-19 19:31:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 19:31:20] [config] log-level: info
[2023-07-19 19:31:20] [config] log-time-zone: ""
[2023-07-19 19:31:20] [config] logical-epoch:
[2023-07-19 19:31:20] [config]   - 1e
[2023-07-19 19:31:20] [config]   - 0
[2023-07-19 19:31:20] [config] lr-decay: 0
[2023-07-19 19:31:20] [config] lr-decay-freq: 50000
[2023-07-19 19:31:20] [config] lr-decay-inv-sqrt:
[2023-07-19 19:31:20] [config]   - 0
[2023-07-19 19:31:20] [config] lr-decay-repeat-warmup: false
[2023-07-19 19:31:20] [config] lr-decay-reset-optimizer: false
[2023-07-19 19:31:20] [config] lr-decay-start:
[2023-07-19 19:31:20] [config]   - 10
[2023-07-19 19:31:20] [config]   - 1
[2023-07-19 19:31:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 19:31:20] [config] lr-report: false
[2023-07-19 19:31:20] [config] lr-warmup: 0
[2023-07-19 19:31:20] [config] lr-warmup-at-reload: false
[2023-07-19 19:31:20] [config] lr-warmup-cycle: false
[2023-07-19 19:31:20] [config] lr-warmup-start-rate: 0
[2023-07-19 19:31:20] [config] max-length: 200
[2023-07-19 19:31:20] [config] max-length-crop: true
[2023-07-19 19:31:20] [config] max-length-factor: 3
[2023-07-19 19:31:20] [config] maxi-batch: 100
[2023-07-19 19:31:20] [config] maxi-batch-sort: trg
[2023-07-19 19:31:20] [config] mini-batch: 64
[2023-07-19 19:31:20] [config] mini-batch-fit: true
[2023-07-19 19:31:20] [config] mini-batch-fit-step: 10
[2023-07-19 19:31:20] [config] mini-batch-round-up: true
[2023-07-19 19:31:20] [config] mini-batch-track-lr: false
[2023-07-19 19:31:20] [config] mini-batch-warmup: 0
[2023-07-19 19:31:20] [config] mini-batch-words: 0
[2023-07-19 19:31:20] [config] mini-batch-words-ref: 0
[2023-07-19 19:31:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 19:31:20] [config] multi-loss-type: sum
[2023-07-19 19:31:20] [config] n-best: false
[2023-07-19 19:31:20] [config] no-nccl: false
[2023-07-19 19:31:20] [config] no-reload: false
[2023-07-19 19:31:20] [config] no-restore-corpus: false
[2023-07-19 19:31:20] [config] normalize: 0
[2023-07-19 19:31:20] [config] normalize-gradient: false
[2023-07-19 19:31:20] [config] num-devices: 0
[2023-07-19 19:31:20] [config] optimizer: adam
[2023-07-19 19:31:20] [config] optimizer-delay: 1
[2023-07-19 19:31:20] [config] optimizer-params:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] output-omit-bias: false
[2023-07-19 19:31:20] [config] overwrite: true
[2023-07-19 19:31:20] [config] precision:
[2023-07-19 19:31:20] [config]   - float16
[2023-07-19 19:31:20] [config]   - float32
[2023-07-19 19:31:20] [config] pretrained-model: ""
[2023-07-19 19:31:20] [config] quantize-biases: false
[2023-07-19 19:31:20] [config] quantize-bits: 0
[2023-07-19 19:31:20] [config] quantize-log-based: false
[2023-07-19 19:31:20] [config] quantize-optimization-steps: 0
[2023-07-19 19:31:20] [config] quiet: false
[2023-07-19 19:31:20] [config] quiet-translation: true
[2023-07-19 19:31:20] [config] relative-paths: false
[2023-07-19 19:31:20] [config] right-left: false
[2023-07-19 19:31:20] [config] save-freq: 10000u
[2023-07-19 19:31:20] [config] seed: 1234
[2023-07-19 19:31:20] [config] sentencepiece-alphas:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] sentencepiece-max-lines: 2000000
[2023-07-19 19:31:20] [config] sentencepiece-options: ""
[2023-07-19 19:31:20] [config] sharding: global
[2023-07-19 19:31:20] [config] shuffle: data
[2023-07-19 19:31:20] [config] shuffle-in-ram: false
[2023-07-19 19:31:20] [config] sigterm: save-and-exit
[2023-07-19 19:31:20] [config] skip: false
[2023-07-19 19:31:20] [config] sqlite: ""
[2023-07-19 19:31:20] [config] sqlite-drop: false
[2023-07-19 19:31:20] [config] sync-freq: 200u
[2023-07-19 19:31:20] [config] sync-sgd: false
[2023-07-19 19:31:20] [config] tempdir: /tmp
[2023-07-19 19:31:20] [config] tied-embeddings: false
[2023-07-19 19:31:20] [config] tied-embeddings-all: true
[2023-07-19 19:31:20] [config] tied-embeddings-src: false
[2023-07-19 19:31:20] [config] train-embedder-rank:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] train-sets:
[2023-07-19 19:31:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 19:31:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 19:31:20] [config] transformer-aan-activation: swish
[2023-07-19 19:31:20] [config] transformer-aan-depth: 2
[2023-07-19 19:31:20] [config] transformer-aan-nogate: false
[2023-07-19 19:31:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 19:31:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 19:31:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 19:31:20] [config] transformer-depth-scaling: false
[2023-07-19 19:31:20] [config] transformer-dim-aan: 2048
[2023-07-19 19:31:20] [config] transformer-dim-ffn: 2048
[2023-07-19 19:31:20] [config] transformer-dropout: 0
[2023-07-19 19:31:20] [config] transformer-dropout-attention: 0
[2023-07-19 19:31:20] [config] transformer-dropout-ffn: 0
[2023-07-19 19:31:20] [config] transformer-ffn-activation: swish
[2023-07-19 19:31:20] [config] transformer-ffn-depth: 2
[2023-07-19 19:31:20] [config] transformer-guided-alignment-layer: last
[2023-07-19 19:31:20] [config] transformer-heads: 8
[2023-07-19 19:31:20] [config] transformer-no-projection: false
[2023-07-19 19:31:20] [config] transformer-pool: false
[2023-07-19 19:31:20] [config] transformer-postprocess: dan
[2023-07-19 19:31:20] [config] transformer-postprocess-emb: d
[2023-07-19 19:31:20] [config] transformer-postprocess-top: ""
[2023-07-19 19:31:20] [config] transformer-preprocess: ""
[2023-07-19 19:31:20] [config] transformer-tied-layers:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] transformer-train-position-embeddings: false
[2023-07-19 19:31:20] [config] tsv: false
[2023-07-19 19:31:20] [config] tsv-fields: 0
[2023-07-19 19:31:20] [config] type: amun
[2023-07-19 19:31:20] [config] ulr: false
[2023-07-19 19:31:20] [config] ulr-dim-emb: 0
[2023-07-19 19:31:20] [config] ulr-dropout: 0
[2023-07-19 19:31:20] [config] ulr-keys-vectors: ""
[2023-07-19 19:31:20] [config] ulr-query-vectors: ""
[2023-07-19 19:31:20] [config] ulr-softmax-temperature: 1
[2023-07-19 19:31:20] [config] ulr-trainable-transformation: false
[2023-07-19 19:31:20] [config] unlikelihood-loss: false
[2023-07-19 19:31:20] [config] valid-freq: 50000000
[2023-07-19 19:31:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 19:31:20] [config] valid-max-length: 1000
[2023-07-19 19:31:20] [config] valid-metrics:
[2023-07-19 19:31:20] [config]   - cross-entropy
[2023-07-19 19:31:20] [config]   - translation
[2023-07-19 19:31:20] [config] valid-mini-batch: 32
[2023-07-19 19:31:20] [config] valid-reset-stalled: false
[2023-07-19 19:31:20] [config] valid-script-args:
[2023-07-19 19:31:20] [config]   []
[2023-07-19 19:31:20] [config] valid-script-path: ""
[2023-07-19 19:31:20] [config] valid-sets:
[2023-07-19 19:31:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 19:31:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 19:31:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 19:31:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 19:31:20] [config] vocabs:
[2023-07-19 19:31:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 19:31:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 19:31:20] [config] word-penalty: 0
[2023-07-19 19:31:20] [config] word-scores: false
[2023-07-19 19:31:20] [config] workspace: 5500
[2023-07-19 19:31:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 19:31:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 19:31:20] [training] Using single-device training
[2023-07-19 19:31:20] Synced seed 1234
[2023-07-19 19:31:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 19:31:20] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 19:31:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 19:31:20] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 19:31:20] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 19:31:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 19:31:20] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 19:31:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 19:31:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 19:31:21] [comm] Using global sharding
[2023-07-19 19:31:21] [comm] NCCLCommunicators constructed successfully
[2023-07-19 19:31:21] [training] Using 1 GPUs
[2023-07-19 19:31:21] [logits] Applying loss function for 1 factor(s)
[2023-07-19 19:31:21] [memory] Reserving 80 MB, device gpu0
[2023-07-19 19:31:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 19:31:22] [memory] Reserving 80 MB, device gpu0
[2023-07-19 20:10:57] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 20:10:57] [valid] No post-processing script given for validating translator
[2023-07-19 20:10:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 20:10:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 20:10:57] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 20:10:57] [comm] Using global sharding
[2023-07-19 20:10:57] [comm] NCCLCommunicators constructed successfully
[2023-07-19 20:10:57] [training] Using 1 GPUs
[2023-07-19 20:10:57] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 20:10:58] Allocating memory for general optimizer shards
[2023-07-19 20:10:58] [memory] Reserving 322 MB, device gpu0
[2023-07-19 20:10:58] Loading Adam parameters
[2023-07-19 20:10:59] [memory] Reserving 322 MB, device gpu0
[2023-07-19 20:10:59] [memory] Reserving 80 MB, device gpu0
[2023-07-19 20:10:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 20:10:59] [data] Restoring the corpus state to epoch 71, batch 2696
[2023-07-19 20:10:59] [data] Shuffling data
[2023-07-19 20:10:59] [data] Done reading 20,192 sentences
[2023-07-19 20:10:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:10:59] Training started
[2023-07-19 20:10:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 20:10:59] [memory] Reserving 80 MB, device gpu0
[2023-07-19 20:11:03] Parameter type float16, optimization type float32, casting types true
[2023-07-19 20:15:30] Seen 20,192 samples
[2023-07-19 20:15:30] Starting data epoch 72 in logical epoch 72
[2023-07-19 20:15:30] [data] Shuffling data
[2023-07-19 20:15:30] [data] Done reading 20,192 sentences
[2023-07-19 20:15:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:20:05] Seen 20,192 samples
[2023-07-19 20:20:05] Starting data epoch 73 in logical epoch 73
[2023-07-19 20:20:05] [data] Shuffling data
[2023-07-19 20:20:05] [data] Done reading 20,192 sentences
[2023-07-19 20:20:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:24:44] Seen 20,192 samples
[2023-07-19 20:24:44] Starting data epoch 74 in logical epoch 74
[2023-07-19 20:24:44] [data] Shuffling data
[2023-07-19 20:24:44] [data] Done reading 20,192 sentences
[2023-07-19 20:24:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:29:26] Seen 20,192 samples
[2023-07-19 20:29:26] Starting data epoch 75 in logical epoch 75
[2023-07-19 20:29:26] [data] Shuffling data
[2023-07-19 20:29:26] [data] Done reading 20,192 sentences
[2023-07-19 20:29:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:34:14] Seen 20,192 samples
[2023-07-19 20:34:14] Starting data epoch 76 in logical epoch 76
[2023-07-19 20:34:14] [data] Shuffling data
[2023-07-19 20:34:14] [data] Done reading 20,192 sentences
[2023-07-19 20:34:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:38:55] Seen 20,192 samples
[2023-07-19 20:38:55] Starting data epoch 77 in logical epoch 77
[2023-07-19 20:38:55] [data] Shuffling data
[2023-07-19 20:38:55] [data] Done reading 20,192 sentences
[2023-07-19 20:38:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:43:35] Seen 20,192 samples
[2023-07-19 20:43:35] Starting data epoch 78 in logical epoch 78
[2023-07-19 20:43:35] [data] Shuffling data
[2023-07-19 20:43:35] [data] Done reading 20,192 sentences
[2023-07-19 20:43:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:47:33] Ep. 78 : Up. 3000 : Sen. 18,621 : Cost 4.17891455 * 16,145,614 @ 5,479 after 48,319,914 : Time 2196.05s : 7352.12 words/s : gNorm 1.0892
[2023-07-19 20:48:22] Seen 20,192 samples
[2023-07-19 20:48:22] Starting data epoch 79 in logical epoch 79
[2023-07-19 20:48:22] [data] Shuffling data
[2023-07-19 20:48:22] [data] Done reading 20,192 sentences
[2023-07-19 20:48:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:52:55] Seen 20,192 samples
[2023-07-19 20:52:55] Starting data epoch 80 in logical epoch 80
[2023-07-19 20:52:55] [data] Shuffling data
[2023-07-19 20:52:55] [data] Done reading 20,192 sentences
[2023-07-19 20:52:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 20:57:28] Seen 20,192 samples
[2023-07-19 20:57:28] Starting data epoch 81 in logical epoch 81
[2023-07-19 20:57:28] Training finished
[2023-07-19 20:57:39] [valid] Ep. 81 : Up. 3084 : cross-entropy : 134.153 : new best
[2023-07-19 21:00:13] [valid] Ep. 81 : Up. 3084 : translation : 0 : new best
[2023-07-19 21:00:13] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 21:00:15] Saving Adam parameters
[2023-07-19 21:00:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 21:00:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 21:00:23] [marian] Running on node18.datos.cluster.uy as process 1367 with command line:
[2023-07-19 21:00:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 21:00:23] [config] after: 0e
[2023-07-19 21:00:23] [config] after-batches: 0
[2023-07-19 21:00:23] [config] after-epochs: 90
[2023-07-19 21:00:23] [config] all-caps-every: 0
[2023-07-19 21:00:23] [config] allow-unk: false
[2023-07-19 21:00:23] [config] authors: false
[2023-07-19 21:00:23] [config] beam-size: 12
[2023-07-19 21:00:23] [config] bert-class-symbol: "[CLS]"
[2023-07-19 21:00:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 21:00:23] [config] bert-masking-fraction: 0.15
[2023-07-19 21:00:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 21:00:23] [config] bert-train-type-embeddings: true
[2023-07-19 21:00:23] [config] bert-type-vocab-size: 2
[2023-07-19 21:00:23] [config] build-info: ""
[2023-07-19 21:00:23] [config] check-gradient-nan: false
[2023-07-19 21:00:23] [config] check-nan: false
[2023-07-19 21:00:23] [config] cite: false
[2023-07-19 21:00:23] [config] clip-norm: 1
[2023-07-19 21:00:23] [config] cost-scaling:
[2023-07-19 21:00:23] [config]   - 256.f
[2023-07-19 21:00:23] [config]   - 1000
[2023-07-19 21:00:23] [config]   - 2.f
[2023-07-19 21:00:23] [config]   - 256.f
[2023-07-19 21:00:23] [config] cost-type: ce-sum
[2023-07-19 21:00:23] [config] cpu-threads: 0
[2023-07-19 21:00:23] [config] data-threads: 8
[2023-07-19 21:00:23] [config] data-weighting: ""
[2023-07-19 21:00:23] [config] data-weighting-type: sentence
[2023-07-19 21:00:23] [config] dec-cell: gru
[2023-07-19 21:00:23] [config] dec-cell-base-depth: 2
[2023-07-19 21:00:23] [config] dec-cell-high-depth: 1
[2023-07-19 21:00:23] [config] dec-depth: 1
[2023-07-19 21:00:23] [config] devices:
[2023-07-19 21:00:23] [config]   - 0
[2023-07-19 21:00:23] [config] dim-emb: 512
[2023-07-19 21:00:23] [config] dim-rnn: 1024
[2023-07-19 21:00:23] [config] dim-vocabs:
[2023-07-19 21:00:23] [config]   - 16384
[2023-07-19 21:00:23] [config]   - 16384
[2023-07-19 21:00:23] [config] disp-first: 0
[2023-07-19 21:00:23] [config] disp-freq: 1000u
[2023-07-19 21:00:23] [config] disp-label-counts: true
[2023-07-19 21:00:23] [config] dropout-rnn: 0
[2023-07-19 21:00:23] [config] dropout-src: 0
[2023-07-19 21:00:23] [config] dropout-trg: 0
[2023-07-19 21:00:23] [config] dump-config: ""
[2023-07-19 21:00:23] [config] dynamic-gradient-scaling:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] early-stopping: 200
[2023-07-19 21:00:23] [config] early-stopping-on: first
[2023-07-19 21:00:23] [config] embedding-fix-src: false
[2023-07-19 21:00:23] [config] embedding-fix-trg: false
[2023-07-19 21:00:23] [config] embedding-normalization: false
[2023-07-19 21:00:23] [config] embedding-vectors:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] enc-cell: gru
[2023-07-19 21:00:23] [config] enc-cell-depth: 1
[2023-07-19 21:00:23] [config] enc-depth: 1
[2023-07-19 21:00:23] [config] enc-type: bidirectional
[2023-07-19 21:00:23] [config] english-title-case-every: 0
[2023-07-19 21:00:23] [config] exponential-smoothing: 0
[2023-07-19 21:00:23] [config] factor-weight: 1
[2023-07-19 21:00:23] [config] factors-combine: sum
[2023-07-19 21:00:23] [config] factors-dim-emb: 0
[2023-07-19 21:00:23] [config] gradient-checkpointing: false
[2023-07-19 21:00:23] [config] gradient-norm-average-window: 100
[2023-07-19 21:00:23] [config] guided-alignment: none
[2023-07-19 21:00:23] [config] guided-alignment-cost: mse
[2023-07-19 21:00:23] [config] guided-alignment-weight: 0.1
[2023-07-19 21:00:23] [config] ignore-model-config: false
[2023-07-19 21:00:23] [config] input-types:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] interpolate-env-vars: false
[2023-07-19 21:00:23] [config] keep-best: false
[2023-07-19 21:00:23] [config] label-smoothing: 0
[2023-07-19 21:00:23] [config] layer-normalization: false
[2023-07-19 21:00:23] [config] learn-rate: 0.0001
[2023-07-19 21:00:23] [config] lemma-dependency: ""
[2023-07-19 21:00:23] [config] lemma-dim-emb: 0
[2023-07-19 21:00:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 21:00:23] [config] log-level: info
[2023-07-19 21:00:23] [config] log-time-zone: ""
[2023-07-19 21:00:23] [config] logical-epoch:
[2023-07-19 21:00:23] [config]   - 1e
[2023-07-19 21:00:23] [config]   - 0
[2023-07-19 21:00:23] [config] lr-decay: 0
[2023-07-19 21:00:23] [config] lr-decay-freq: 50000
[2023-07-19 21:00:23] [config] lr-decay-inv-sqrt:
[2023-07-19 21:00:23] [config]   - 0
[2023-07-19 21:00:23] [config] lr-decay-repeat-warmup: false
[2023-07-19 21:00:23] [config] lr-decay-reset-optimizer: false
[2023-07-19 21:00:23] [config] lr-decay-start:
[2023-07-19 21:00:23] [config]   - 10
[2023-07-19 21:00:23] [config]   - 1
[2023-07-19 21:00:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 21:00:23] [config] lr-report: false
[2023-07-19 21:00:23] [config] lr-warmup: 0
[2023-07-19 21:00:23] [config] lr-warmup-at-reload: false
[2023-07-19 21:00:23] [config] lr-warmup-cycle: false
[2023-07-19 21:00:23] [config] lr-warmup-start-rate: 0
[2023-07-19 21:00:23] [config] max-length: 200
[2023-07-19 21:00:23] [config] max-length-crop: true
[2023-07-19 21:00:23] [config] max-length-factor: 3
[2023-07-19 21:00:23] [config] maxi-batch: 100
[2023-07-19 21:00:23] [config] maxi-batch-sort: trg
[2023-07-19 21:00:23] [config] mini-batch: 64
[2023-07-19 21:00:23] [config] mini-batch-fit: true
[2023-07-19 21:00:23] [config] mini-batch-fit-step: 10
[2023-07-19 21:00:23] [config] mini-batch-round-up: true
[2023-07-19 21:00:23] [config] mini-batch-track-lr: false
[2023-07-19 21:00:23] [config] mini-batch-warmup: 0
[2023-07-19 21:00:23] [config] mini-batch-words: 0
[2023-07-19 21:00:23] [config] mini-batch-words-ref: 0
[2023-07-19 21:00:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 21:00:23] [config] multi-loss-type: sum
[2023-07-19 21:00:23] [config] n-best: false
[2023-07-19 21:00:23] [config] no-nccl: false
[2023-07-19 21:00:23] [config] no-reload: false
[2023-07-19 21:00:23] [config] no-restore-corpus: false
[2023-07-19 21:00:23] [config] normalize: 0
[2023-07-19 21:00:23] [config] normalize-gradient: false
[2023-07-19 21:00:23] [config] num-devices: 0
[2023-07-19 21:00:23] [config] optimizer: adam
[2023-07-19 21:00:23] [config] optimizer-delay: 1
[2023-07-19 21:00:23] [config] optimizer-params:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] output-omit-bias: false
[2023-07-19 21:00:23] [config] overwrite: true
[2023-07-19 21:00:23] [config] precision:
[2023-07-19 21:00:23] [config]   - float16
[2023-07-19 21:00:23] [config]   - float32
[2023-07-19 21:00:23] [config] pretrained-model: ""
[2023-07-19 21:00:23] [config] quantize-biases: false
[2023-07-19 21:00:23] [config] quantize-bits: 0
[2023-07-19 21:00:23] [config] quantize-log-based: false
[2023-07-19 21:00:23] [config] quantize-optimization-steps: 0
[2023-07-19 21:00:23] [config] quiet: false
[2023-07-19 21:00:23] [config] quiet-translation: true
[2023-07-19 21:00:23] [config] relative-paths: false
[2023-07-19 21:00:23] [config] right-left: false
[2023-07-19 21:00:23] [config] save-freq: 10000u
[2023-07-19 21:00:23] [config] seed: 1234
[2023-07-19 21:00:23] [config] sentencepiece-alphas:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] sentencepiece-max-lines: 2000000
[2023-07-19 21:00:23] [config] sentencepiece-options: ""
[2023-07-19 21:00:23] [config] sharding: global
[2023-07-19 21:00:23] [config] shuffle: data
[2023-07-19 21:00:23] [config] shuffle-in-ram: false
[2023-07-19 21:00:23] [config] sigterm: save-and-exit
[2023-07-19 21:00:23] [config] skip: false
[2023-07-19 21:00:23] [config] sqlite: ""
[2023-07-19 21:00:23] [config] sqlite-drop: false
[2023-07-19 21:00:23] [config] sync-freq: 200u
[2023-07-19 21:00:23] [config] sync-sgd: false
[2023-07-19 21:00:23] [config] tempdir: /tmp
[2023-07-19 21:00:23] [config] tied-embeddings: false
[2023-07-19 21:00:23] [config] tied-embeddings-all: true
[2023-07-19 21:00:23] [config] tied-embeddings-src: false
[2023-07-19 21:00:23] [config] train-embedder-rank:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] train-sets:
[2023-07-19 21:00:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 21:00:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 21:00:23] [config] transformer-aan-activation: swish
[2023-07-19 21:00:23] [config] transformer-aan-depth: 2
[2023-07-19 21:00:23] [config] transformer-aan-nogate: false
[2023-07-19 21:00:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 21:00:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 21:00:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 21:00:23] [config] transformer-depth-scaling: false
[2023-07-19 21:00:23] [config] transformer-dim-aan: 2048
[2023-07-19 21:00:23] [config] transformer-dim-ffn: 2048
[2023-07-19 21:00:23] [config] transformer-dropout: 0
[2023-07-19 21:00:23] [config] transformer-dropout-attention: 0
[2023-07-19 21:00:23] [config] transformer-dropout-ffn: 0
[2023-07-19 21:00:23] [config] transformer-ffn-activation: swish
[2023-07-19 21:00:23] [config] transformer-ffn-depth: 2
[2023-07-19 21:00:23] [config] transformer-guided-alignment-layer: last
[2023-07-19 21:00:23] [config] transformer-heads: 8
[2023-07-19 21:00:23] [config] transformer-no-projection: false
[2023-07-19 21:00:23] [config] transformer-pool: false
[2023-07-19 21:00:23] [config] transformer-postprocess: dan
[2023-07-19 21:00:23] [config] transformer-postprocess-emb: d
[2023-07-19 21:00:23] [config] transformer-postprocess-top: ""
[2023-07-19 21:00:23] [config] transformer-preprocess: ""
[2023-07-19 21:00:23] [config] transformer-tied-layers:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] transformer-train-position-embeddings: false
[2023-07-19 21:00:23] [config] tsv: false
[2023-07-19 21:00:23] [config] tsv-fields: 0
[2023-07-19 21:00:23] [config] type: amun
[2023-07-19 21:00:23] [config] ulr: false
[2023-07-19 21:00:23] [config] ulr-dim-emb: 0
[2023-07-19 21:00:23] [config] ulr-dropout: 0
[2023-07-19 21:00:23] [config] ulr-keys-vectors: ""
[2023-07-19 21:00:23] [config] ulr-query-vectors: ""
[2023-07-19 21:00:23] [config] ulr-softmax-temperature: 1
[2023-07-19 21:00:23] [config] ulr-trainable-transformation: false
[2023-07-19 21:00:23] [config] unlikelihood-loss: false
[2023-07-19 21:00:23] [config] valid-freq: 50000000
[2023-07-19 21:00:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 21:00:23] [config] valid-max-length: 1000
[2023-07-19 21:00:23] [config] valid-metrics:
[2023-07-19 21:00:23] [config]   - cross-entropy
[2023-07-19 21:00:23] [config]   - translation
[2023-07-19 21:00:23] [config] valid-mini-batch: 32
[2023-07-19 21:00:23] [config] valid-reset-stalled: false
[2023-07-19 21:00:23] [config] valid-script-args:
[2023-07-19 21:00:23] [config]   []
[2023-07-19 21:00:23] [config] valid-script-path: ""
[2023-07-19 21:00:23] [config] valid-sets:
[2023-07-19 21:00:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 21:00:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 21:00:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 21:00:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 21:00:23] [config] vocabs:
[2023-07-19 21:00:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 21:00:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 21:00:23] [config] word-penalty: 0
[2023-07-19 21:00:23] [config] word-scores: false
[2023-07-19 21:00:23] [config] workspace: 5500
[2023-07-19 21:00:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 21:00:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 21:00:23] [training] Using single-device training
[2023-07-19 21:00:23] Synced seed 1234
[2023-07-19 21:00:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 21:00:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 21:00:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 21:00:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 21:00:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 21:00:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 21:00:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 21:00:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 21:00:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 21:00:24] [comm] Using global sharding
[2023-07-19 21:00:25] [comm] NCCLCommunicators constructed successfully
[2023-07-19 21:00:25] [training] Using 1 GPUs
[2023-07-19 21:00:25] [logits] Applying loss function for 1 factor(s)
[2023-07-19 21:00:25] [memory] Reserving 80 MB, device gpu0
[2023-07-19 21:00:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 21:00:25] [memory] Reserving 80 MB, device gpu0
[2023-07-19 21:39:50] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 21:39:50] [valid] No post-processing script given for validating translator
[2023-07-19 21:39:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 21:39:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 21:39:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 21:39:50] [comm] Using global sharding
[2023-07-19 21:39:50] [comm] NCCLCommunicators constructed successfully
[2023-07-19 21:39:50] [training] Using 1 GPUs
[2023-07-19 21:39:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 21:39:56] Allocating memory for general optimizer shards
[2023-07-19 21:39:56] [memory] Reserving 322 MB, device gpu0
[2023-07-19 21:39:56] Loading Adam parameters
[2023-07-19 21:39:56] [memory] Reserving 322 MB, device gpu0
[2023-07-19 21:39:56] [memory] Reserving 80 MB, device gpu0
[2023-07-19 21:39:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 21:39:56] [data] Restoring the corpus state to epoch 81, batch 3084
[2023-07-19 21:39:56] [data] Shuffling data
[2023-07-19 21:39:56] [data] Done reading 20,192 sentences
[2023-07-19 21:39:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 21:39:56] Training started
[2023-07-19 21:39:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 21:39:58] [memory] Reserving 80 MB, device gpu0
[2023-07-19 21:40:11] Parameter type float16, optimization type float32, casting types true
[2023-07-19 21:44:28] Seen 20,192 samples
[2023-07-19 21:44:28] Starting data epoch 82 in logical epoch 82
[2023-07-19 21:44:28] [data] Shuffling data
[2023-07-19 21:44:28] [data] Done reading 20,192 sentences
[2023-07-19 21:44:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 21:49:13] Seen 20,192 samples
[2023-07-19 21:49:13] Starting data epoch 83 in logical epoch 83
[2023-07-19 21:49:13] [data] Shuffling data
[2023-07-19 21:49:13] [data] Done reading 20,192 sentences
[2023-07-19 21:49:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 21:53:36] Seen 20,192 samples
[2023-07-19 21:53:36] Starting data epoch 84 in logical epoch 84
[2023-07-19 21:53:36] [data] Shuffling data
[2023-07-19 21:53:36] [data] Done reading 20,192 sentences
[2023-07-19 21:53:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 21:58:09] Seen 20,192 samples
[2023-07-19 21:58:09] Starting data epoch 85 in logical epoch 85
[2023-07-19 21:58:09] [data] Shuffling data
[2023-07-19 21:58:09] [data] Done reading 20,192 sentences
[2023-07-19 21:58:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 22:02:49] Seen 20,192 samples
[2023-07-19 22:02:49] Starting data epoch 86 in logical epoch 86
[2023-07-19 22:02:49] [data] Shuffling data
[2023-07-19 22:02:49] [data] Done reading 20,192 sentences
[2023-07-19 22:02:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 22:07:22] Seen 20,192 samples
[2023-07-19 22:07:22] Starting data epoch 87 in logical epoch 87
[2023-07-19 22:07:22] [data] Shuffling data
[2023-07-19 22:07:22] [data] Done reading 20,192 sentences
[2023-07-19 22:07:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 22:11:55] Seen 20,192 samples
[2023-07-19 22:11:55] Starting data epoch 88 in logical epoch 88
[2023-07-19 22:11:55] [data] Shuffling data
[2023-07-19 22:11:55] [data] Done reading 20,192 sentences
[2023-07-19 22:11:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 22:16:36] Seen 20,192 samples
[2023-07-19 22:16:36] Starting data epoch 89 in logical epoch 89
[2023-07-19 22:16:36] [data] Shuffling data
[2023-07-19 22:16:36] [data] Done reading 20,192 sentences
[2023-07-19 22:16:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 22:21:12] Seen 20,192 samples
[2023-07-19 22:21:12] Starting data epoch 90 in logical epoch 90
[2023-07-19 22:21:12] [data] Shuffling data
[2023-07-19 22:21:12] [data] Done reading 20,192 sentences
[2023-07-19 22:21:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 22:25:41] Seen 20,192 samples
[2023-07-19 22:25:41] Starting data epoch 91 in logical epoch 91
[2023-07-19 22:25:41] Training finished
[2023-07-19 22:25:53] [valid] Ep. 91 : Up. 3472 : cross-entropy : 131.103 : new best
[2023-07-19 22:28:29] [valid] Ep. 91 : Up. 3472 : translation : 0 : new best
[2023-07-19 22:28:29] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 22:28:31] Saving Adam parameters
[2023-07-19 22:28:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 22:28:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 22:28:39] [marian] Running on node18.datos.cluster.uy as process 7193 with command line:
[2023-07-19 22:28:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 22:28:39] [config] after: 0e
[2023-07-19 22:28:39] [config] after-batches: 0
[2023-07-19 22:28:39] [config] after-epochs: 100
[2023-07-19 22:28:39] [config] all-caps-every: 0
[2023-07-19 22:28:39] [config] allow-unk: false
[2023-07-19 22:28:39] [config] authors: false
[2023-07-19 22:28:39] [config] beam-size: 12
[2023-07-19 22:28:39] [config] bert-class-symbol: "[CLS]"
[2023-07-19 22:28:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 22:28:39] [config] bert-masking-fraction: 0.15
[2023-07-19 22:28:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 22:28:39] [config] bert-train-type-embeddings: true
[2023-07-19 22:28:39] [config] bert-type-vocab-size: 2
[2023-07-19 22:28:39] [config] build-info: ""
[2023-07-19 22:28:39] [config] check-gradient-nan: false
[2023-07-19 22:28:39] [config] check-nan: false
[2023-07-19 22:28:39] [config] cite: false
[2023-07-19 22:28:39] [config] clip-norm: 1
[2023-07-19 22:28:39] [config] cost-scaling:
[2023-07-19 22:28:39] [config]   - 256.f
[2023-07-19 22:28:39] [config]   - 1000
[2023-07-19 22:28:39] [config]   - 2.f
[2023-07-19 22:28:39] [config]   - 256.f
[2023-07-19 22:28:39] [config] cost-type: ce-sum
[2023-07-19 22:28:39] [config] cpu-threads: 0
[2023-07-19 22:28:39] [config] data-threads: 8
[2023-07-19 22:28:39] [config] data-weighting: ""
[2023-07-19 22:28:39] [config] data-weighting-type: sentence
[2023-07-19 22:28:39] [config] dec-cell: gru
[2023-07-19 22:28:39] [config] dec-cell-base-depth: 2
[2023-07-19 22:28:39] [config] dec-cell-high-depth: 1
[2023-07-19 22:28:39] [config] dec-depth: 1
[2023-07-19 22:28:39] [config] devices:
[2023-07-19 22:28:39] [config]   - 0
[2023-07-19 22:28:39] [config] dim-emb: 512
[2023-07-19 22:28:39] [config] dim-rnn: 1024
[2023-07-19 22:28:39] [config] dim-vocabs:
[2023-07-19 22:28:39] [config]   - 16384
[2023-07-19 22:28:39] [config]   - 16384
[2023-07-19 22:28:39] [config] disp-first: 0
[2023-07-19 22:28:39] [config] disp-freq: 1000u
[2023-07-19 22:28:39] [config] disp-label-counts: true
[2023-07-19 22:28:39] [config] dropout-rnn: 0
[2023-07-19 22:28:39] [config] dropout-src: 0
[2023-07-19 22:28:39] [config] dropout-trg: 0
[2023-07-19 22:28:39] [config] dump-config: ""
[2023-07-19 22:28:39] [config] dynamic-gradient-scaling:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] early-stopping: 200
[2023-07-19 22:28:39] [config] early-stopping-on: first
[2023-07-19 22:28:39] [config] embedding-fix-src: false
[2023-07-19 22:28:39] [config] embedding-fix-trg: false
[2023-07-19 22:28:39] [config] embedding-normalization: false
[2023-07-19 22:28:39] [config] embedding-vectors:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] enc-cell: gru
[2023-07-19 22:28:39] [config] enc-cell-depth: 1
[2023-07-19 22:28:39] [config] enc-depth: 1
[2023-07-19 22:28:39] [config] enc-type: bidirectional
[2023-07-19 22:28:39] [config] english-title-case-every: 0
[2023-07-19 22:28:39] [config] exponential-smoothing: 0
[2023-07-19 22:28:39] [config] factor-weight: 1
[2023-07-19 22:28:39] [config] factors-combine: sum
[2023-07-19 22:28:39] [config] factors-dim-emb: 0
[2023-07-19 22:28:39] [config] gradient-checkpointing: false
[2023-07-19 22:28:39] [config] gradient-norm-average-window: 100
[2023-07-19 22:28:39] [config] guided-alignment: none
[2023-07-19 22:28:39] [config] guided-alignment-cost: mse
[2023-07-19 22:28:39] [config] guided-alignment-weight: 0.1
[2023-07-19 22:28:39] [config] ignore-model-config: false
[2023-07-19 22:28:39] [config] input-types:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] interpolate-env-vars: false
[2023-07-19 22:28:39] [config] keep-best: false
[2023-07-19 22:28:39] [config] label-smoothing: 0
[2023-07-19 22:28:39] [config] layer-normalization: false
[2023-07-19 22:28:39] [config] learn-rate: 0.0001
[2023-07-19 22:28:39] [config] lemma-dependency: ""
[2023-07-19 22:28:39] [config] lemma-dim-emb: 0
[2023-07-19 22:28:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 22:28:39] [config] log-level: info
[2023-07-19 22:28:39] [config] log-time-zone: ""
[2023-07-19 22:28:39] [config] logical-epoch:
[2023-07-19 22:28:39] [config]   - 1e
[2023-07-19 22:28:39] [config]   - 0
[2023-07-19 22:28:39] [config] lr-decay: 0
[2023-07-19 22:28:39] [config] lr-decay-freq: 50000
[2023-07-19 22:28:39] [config] lr-decay-inv-sqrt:
[2023-07-19 22:28:39] [config]   - 0
[2023-07-19 22:28:39] [config] lr-decay-repeat-warmup: false
[2023-07-19 22:28:39] [config] lr-decay-reset-optimizer: false
[2023-07-19 22:28:39] [config] lr-decay-start:
[2023-07-19 22:28:39] [config]   - 10
[2023-07-19 22:28:39] [config]   - 1
[2023-07-19 22:28:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 22:28:39] [config] lr-report: false
[2023-07-19 22:28:39] [config] lr-warmup: 0
[2023-07-19 22:28:39] [config] lr-warmup-at-reload: false
[2023-07-19 22:28:39] [config] lr-warmup-cycle: false
[2023-07-19 22:28:39] [config] lr-warmup-start-rate: 0
[2023-07-19 22:28:39] [config] max-length: 200
[2023-07-19 22:28:39] [config] max-length-crop: true
[2023-07-19 22:28:39] [config] max-length-factor: 3
[2023-07-19 22:28:39] [config] maxi-batch: 100
[2023-07-19 22:28:39] [config] maxi-batch-sort: trg
[2023-07-19 22:28:39] [config] mini-batch: 64
[2023-07-19 22:28:39] [config] mini-batch-fit: true
[2023-07-19 22:28:39] [config] mini-batch-fit-step: 10
[2023-07-19 22:28:39] [config] mini-batch-round-up: true
[2023-07-19 22:28:39] [config] mini-batch-track-lr: false
[2023-07-19 22:28:39] [config] mini-batch-warmup: 0
[2023-07-19 22:28:39] [config] mini-batch-words: 0
[2023-07-19 22:28:39] [config] mini-batch-words-ref: 0
[2023-07-19 22:28:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 22:28:39] [config] multi-loss-type: sum
[2023-07-19 22:28:39] [config] n-best: false
[2023-07-19 22:28:39] [config] no-nccl: false
[2023-07-19 22:28:39] [config] no-reload: false
[2023-07-19 22:28:39] [config] no-restore-corpus: false
[2023-07-19 22:28:39] [config] normalize: 0
[2023-07-19 22:28:39] [config] normalize-gradient: false
[2023-07-19 22:28:39] [config] num-devices: 0
[2023-07-19 22:28:39] [config] optimizer: adam
[2023-07-19 22:28:39] [config] optimizer-delay: 1
[2023-07-19 22:28:39] [config] optimizer-params:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] output-omit-bias: false
[2023-07-19 22:28:39] [config] overwrite: true
[2023-07-19 22:28:39] [config] precision:
[2023-07-19 22:28:39] [config]   - float16
[2023-07-19 22:28:39] [config]   - float32
[2023-07-19 22:28:39] [config] pretrained-model: ""
[2023-07-19 22:28:39] [config] quantize-biases: false
[2023-07-19 22:28:39] [config] quantize-bits: 0
[2023-07-19 22:28:39] [config] quantize-log-based: false
[2023-07-19 22:28:39] [config] quantize-optimization-steps: 0
[2023-07-19 22:28:39] [config] quiet: false
[2023-07-19 22:28:39] [config] quiet-translation: true
[2023-07-19 22:28:39] [config] relative-paths: false
[2023-07-19 22:28:39] [config] right-left: false
[2023-07-19 22:28:39] [config] save-freq: 10000u
[2023-07-19 22:28:39] [config] seed: 1234
[2023-07-19 22:28:39] [config] sentencepiece-alphas:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] sentencepiece-max-lines: 2000000
[2023-07-19 22:28:39] [config] sentencepiece-options: ""
[2023-07-19 22:28:39] [config] sharding: global
[2023-07-19 22:28:39] [config] shuffle: data
[2023-07-19 22:28:39] [config] shuffle-in-ram: false
[2023-07-19 22:28:39] [config] sigterm: save-and-exit
[2023-07-19 22:28:39] [config] skip: false
[2023-07-19 22:28:39] [config] sqlite: ""
[2023-07-19 22:28:39] [config] sqlite-drop: false
[2023-07-19 22:28:39] [config] sync-freq: 200u
[2023-07-19 22:28:39] [config] sync-sgd: false
[2023-07-19 22:28:39] [config] tempdir: /tmp
[2023-07-19 22:28:39] [config] tied-embeddings: false
[2023-07-19 22:28:39] [config] tied-embeddings-all: true
[2023-07-19 22:28:39] [config] tied-embeddings-src: false
[2023-07-19 22:28:39] [config] train-embedder-rank:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] train-sets:
[2023-07-19 22:28:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 22:28:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 22:28:39] [config] transformer-aan-activation: swish
[2023-07-19 22:28:39] [config] transformer-aan-depth: 2
[2023-07-19 22:28:39] [config] transformer-aan-nogate: false
[2023-07-19 22:28:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 22:28:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 22:28:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 22:28:39] [config] transformer-depth-scaling: false
[2023-07-19 22:28:39] [config] transformer-dim-aan: 2048
[2023-07-19 22:28:39] [config] transformer-dim-ffn: 2048
[2023-07-19 22:28:39] [config] transformer-dropout: 0
[2023-07-19 22:28:39] [config] transformer-dropout-attention: 0
[2023-07-19 22:28:39] [config] transformer-dropout-ffn: 0
[2023-07-19 22:28:39] [config] transformer-ffn-activation: swish
[2023-07-19 22:28:39] [config] transformer-ffn-depth: 2
[2023-07-19 22:28:39] [config] transformer-guided-alignment-layer: last
[2023-07-19 22:28:39] [config] transformer-heads: 8
[2023-07-19 22:28:39] [config] transformer-no-projection: false
[2023-07-19 22:28:39] [config] transformer-pool: false
[2023-07-19 22:28:39] [config] transformer-postprocess: dan
[2023-07-19 22:28:39] [config] transformer-postprocess-emb: d
[2023-07-19 22:28:39] [config] transformer-postprocess-top: ""
[2023-07-19 22:28:39] [config] transformer-preprocess: ""
[2023-07-19 22:28:39] [config] transformer-tied-layers:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] transformer-train-position-embeddings: false
[2023-07-19 22:28:39] [config] tsv: false
[2023-07-19 22:28:39] [config] tsv-fields: 0
[2023-07-19 22:28:39] [config] type: amun
[2023-07-19 22:28:39] [config] ulr: false
[2023-07-19 22:28:39] [config] ulr-dim-emb: 0
[2023-07-19 22:28:39] [config] ulr-dropout: 0
[2023-07-19 22:28:39] [config] ulr-keys-vectors: ""
[2023-07-19 22:28:39] [config] ulr-query-vectors: ""
[2023-07-19 22:28:39] [config] ulr-softmax-temperature: 1
[2023-07-19 22:28:39] [config] ulr-trainable-transformation: false
[2023-07-19 22:28:39] [config] unlikelihood-loss: false
[2023-07-19 22:28:39] [config] valid-freq: 50000000
[2023-07-19 22:28:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 22:28:39] [config] valid-max-length: 1000
[2023-07-19 22:28:39] [config] valid-metrics:
[2023-07-19 22:28:39] [config]   - cross-entropy
[2023-07-19 22:28:39] [config]   - translation
[2023-07-19 22:28:39] [config] valid-mini-batch: 32
[2023-07-19 22:28:39] [config] valid-reset-stalled: false
[2023-07-19 22:28:39] [config] valid-script-args:
[2023-07-19 22:28:39] [config]   []
[2023-07-19 22:28:39] [config] valid-script-path: ""
[2023-07-19 22:28:39] [config] valid-sets:
[2023-07-19 22:28:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 22:28:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 22:28:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 22:28:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 22:28:39] [config] vocabs:
[2023-07-19 22:28:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 22:28:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 22:28:39] [config] word-penalty: 0
[2023-07-19 22:28:39] [config] word-scores: false
[2023-07-19 22:28:39] [config] workspace: 5500
[2023-07-19 22:28:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 22:28:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 22:28:39] [training] Using single-device training
[2023-07-19 22:28:39] Synced seed 1234
[2023-07-19 22:28:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 22:28:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 22:28:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 22:28:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 22:28:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 22:28:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 22:28:39] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 22:28:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 22:28:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 22:28:41] [comm] Using global sharding
[2023-07-19 22:28:41] [comm] NCCLCommunicators constructed successfully
[2023-07-19 22:28:41] [training] Using 1 GPUs
[2023-07-19 22:28:41] [logits] Applying loss function for 1 factor(s)
[2023-07-19 22:28:41] [memory] Reserving 80 MB, device gpu0
[2023-07-19 22:28:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 22:28:41] [memory] Reserving 80 MB, device gpu0
[2023-07-19 23:08:15] [batching] Done. Typical MB size is 35,936 target words
[2023-07-19 23:08:15] [valid] No post-processing script given for validating translator
[2023-07-19 23:08:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 23:08:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 23:08:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 23:08:15] [comm] Using global sharding
[2023-07-19 23:08:15] [comm] NCCLCommunicators constructed successfully
[2023-07-19 23:08:15] [training] Using 1 GPUs
[2023-07-19 23:08:15] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 23:08:16] Allocating memory for general optimizer shards
[2023-07-19 23:08:16] [memory] Reserving 322 MB, device gpu0
[2023-07-19 23:08:16] Loading Adam parameters
[2023-07-19 23:08:16] [memory] Reserving 322 MB, device gpu0
[2023-07-19 23:08:16] [memory] Reserving 80 MB, device gpu0
[2023-07-19 23:08:17] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 23:08:17] [data] Restoring the corpus state to epoch 91, batch 3472
[2023-07-19 23:08:17] [data] Shuffling data
[2023-07-19 23:08:17] [data] Done reading 20,192 sentences
[2023-07-19 23:08:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:08:17] Training started
[2023-07-19 23:08:17] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-19 23:08:18] [memory] Reserving 80 MB, device gpu0
[2023-07-19 23:08:26] Parameter type float16, optimization type float32, casting types true
[2023-07-19 23:12:44] Seen 20,192 samples
[2023-07-19 23:12:44] Starting data epoch 92 in logical epoch 92
[2023-07-19 23:12:44] [data] Shuffling data
[2023-07-19 23:12:44] [data] Done reading 20,192 sentences
[2023-07-19 23:12:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:17:22] Seen 20,192 samples
[2023-07-19 23:17:22] Starting data epoch 93 in logical epoch 93
[2023-07-19 23:17:22] [data] Shuffling data
[2023-07-19 23:17:22] [data] Done reading 20,192 sentences
[2023-07-19 23:17:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:21:31] Seen 20,192 samples
[2023-07-19 23:21:31] Starting data epoch 94 in logical epoch 94
[2023-07-19 23:21:31] [data] Shuffling data
[2023-07-19 23:21:31] [data] Done reading 20,192 sentences
[2023-07-19 23:21:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:26:08] Seen 20,192 samples
[2023-07-19 23:26:08] Starting data epoch 95 in logical epoch 95
[2023-07-19 23:26:08] [data] Shuffling data
[2023-07-19 23:26:08] [data] Done reading 20,192 sentences
[2023-07-19 23:26:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:30:34] Seen 20,192 samples
[2023-07-19 23:30:34] Starting data epoch 96 in logical epoch 96
[2023-07-19 23:30:34] [data] Shuffling data
[2023-07-19 23:30:34] [data] Done reading 20,192 sentences
[2023-07-19 23:30:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:35:24] Seen 20,192 samples
[2023-07-19 23:35:24] Starting data epoch 97 in logical epoch 97
[2023-07-19 23:35:24] [data] Shuffling data
[2023-07-19 23:35:24] [data] Done reading 20,192 sentences
[2023-07-19 23:35:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:40:11] Seen 20,192 samples
[2023-07-19 23:40:11] Starting data epoch 98 in logical epoch 98
[2023-07-19 23:40:11] [data] Shuffling data
[2023-07-19 23:40:11] [data] Done reading 20,192 sentences
[2023-07-19 23:40:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:44:53] Seen 20,192 samples
[2023-07-19 23:44:53] Starting data epoch 99 in logical epoch 99
[2023-07-19 23:44:53] [data] Shuffling data
[2023-07-19 23:44:53] [data] Done reading 20,192 sentences
[2023-07-19 23:44:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:49:37] Seen 20,192 samples
[2023-07-19 23:49:37] Starting data epoch 100 in logical epoch 100
[2023-07-19 23:49:37] [data] Shuffling data
[2023-07-19 23:49:37] [data] Done reading 20,192 sentences
[2023-07-19 23:49:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-19 23:53:53] Seen 20,192 samples
[2023-07-19 23:53:53] Starting data epoch 101 in logical epoch 101
[2023-07-19 23:53:53] Training finished
[2023-07-19 23:54:08] [valid] Ep. 101 : Up. 3861 : cross-entropy : 129.173 : new best
[2023-07-19 23:56:56] [valid] Ep. 101 : Up. 3861 : translation : 0 : new best
[2023-07-19 23:56:56] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 23:56:58] Saving Adam parameters
[2023-07-19 23:56:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-19 23:57:06] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 23:57:06] [marian] Running on node18.datos.cluster.uy as process 12920 with command line:
[2023-07-19 23:57:06] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-19 23:57:06] [config] after: 0e
[2023-07-19 23:57:06] [config] after-batches: 0
[2023-07-19 23:57:06] [config] after-epochs: 110
[2023-07-19 23:57:06] [config] all-caps-every: 0
[2023-07-19 23:57:06] [config] allow-unk: false
[2023-07-19 23:57:06] [config] authors: false
[2023-07-19 23:57:06] [config] beam-size: 12
[2023-07-19 23:57:06] [config] bert-class-symbol: "[CLS]"
[2023-07-19 23:57:06] [config] bert-mask-symbol: "[MASK]"
[2023-07-19 23:57:06] [config] bert-masking-fraction: 0.15
[2023-07-19 23:57:06] [config] bert-sep-symbol: "[SEP]"
[2023-07-19 23:57:06] [config] bert-train-type-embeddings: true
[2023-07-19 23:57:06] [config] bert-type-vocab-size: 2
[2023-07-19 23:57:06] [config] build-info: ""
[2023-07-19 23:57:06] [config] check-gradient-nan: false
[2023-07-19 23:57:06] [config] check-nan: false
[2023-07-19 23:57:06] [config] cite: false
[2023-07-19 23:57:06] [config] clip-norm: 1
[2023-07-19 23:57:06] [config] cost-scaling:
[2023-07-19 23:57:06] [config]   - 256.f
[2023-07-19 23:57:06] [config]   - 1000
[2023-07-19 23:57:06] [config]   - 2.f
[2023-07-19 23:57:06] [config]   - 256.f
[2023-07-19 23:57:06] [config] cost-type: ce-sum
[2023-07-19 23:57:06] [config] cpu-threads: 0
[2023-07-19 23:57:06] [config] data-threads: 8
[2023-07-19 23:57:06] [config] data-weighting: ""
[2023-07-19 23:57:06] [config] data-weighting-type: sentence
[2023-07-19 23:57:06] [config] dec-cell: gru
[2023-07-19 23:57:06] [config] dec-cell-base-depth: 2
[2023-07-19 23:57:06] [config] dec-cell-high-depth: 1
[2023-07-19 23:57:06] [config] dec-depth: 1
[2023-07-19 23:57:06] [config] devices:
[2023-07-19 23:57:06] [config]   - 0
[2023-07-19 23:57:06] [config] dim-emb: 512
[2023-07-19 23:57:06] [config] dim-rnn: 1024
[2023-07-19 23:57:06] [config] dim-vocabs:
[2023-07-19 23:57:06] [config]   - 16384
[2023-07-19 23:57:06] [config]   - 16384
[2023-07-19 23:57:06] [config] disp-first: 0
[2023-07-19 23:57:06] [config] disp-freq: 1000u
[2023-07-19 23:57:06] [config] disp-label-counts: true
[2023-07-19 23:57:06] [config] dropout-rnn: 0
[2023-07-19 23:57:06] [config] dropout-src: 0
[2023-07-19 23:57:06] [config] dropout-trg: 0
[2023-07-19 23:57:06] [config] dump-config: ""
[2023-07-19 23:57:06] [config] dynamic-gradient-scaling:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] early-stopping: 200
[2023-07-19 23:57:06] [config] early-stopping-on: first
[2023-07-19 23:57:06] [config] embedding-fix-src: false
[2023-07-19 23:57:06] [config] embedding-fix-trg: false
[2023-07-19 23:57:06] [config] embedding-normalization: false
[2023-07-19 23:57:06] [config] embedding-vectors:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] enc-cell: gru
[2023-07-19 23:57:06] [config] enc-cell-depth: 1
[2023-07-19 23:57:06] [config] enc-depth: 1
[2023-07-19 23:57:06] [config] enc-type: bidirectional
[2023-07-19 23:57:06] [config] english-title-case-every: 0
[2023-07-19 23:57:06] [config] exponential-smoothing: 0
[2023-07-19 23:57:06] [config] factor-weight: 1
[2023-07-19 23:57:06] [config] factors-combine: sum
[2023-07-19 23:57:06] [config] factors-dim-emb: 0
[2023-07-19 23:57:06] [config] gradient-checkpointing: false
[2023-07-19 23:57:06] [config] gradient-norm-average-window: 100
[2023-07-19 23:57:06] [config] guided-alignment: none
[2023-07-19 23:57:06] [config] guided-alignment-cost: mse
[2023-07-19 23:57:06] [config] guided-alignment-weight: 0.1
[2023-07-19 23:57:06] [config] ignore-model-config: false
[2023-07-19 23:57:06] [config] input-types:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] interpolate-env-vars: false
[2023-07-19 23:57:06] [config] keep-best: false
[2023-07-19 23:57:06] [config] label-smoothing: 0
[2023-07-19 23:57:06] [config] layer-normalization: false
[2023-07-19 23:57:06] [config] learn-rate: 0.0001
[2023-07-19 23:57:06] [config] lemma-dependency: ""
[2023-07-19 23:57:06] [config] lemma-dim-emb: 0
[2023-07-19 23:57:06] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 23:57:06] [config] log-level: info
[2023-07-19 23:57:06] [config] log-time-zone: ""
[2023-07-19 23:57:06] [config] logical-epoch:
[2023-07-19 23:57:06] [config]   - 1e
[2023-07-19 23:57:06] [config]   - 0
[2023-07-19 23:57:06] [config] lr-decay: 0
[2023-07-19 23:57:06] [config] lr-decay-freq: 50000
[2023-07-19 23:57:06] [config] lr-decay-inv-sqrt:
[2023-07-19 23:57:06] [config]   - 0
[2023-07-19 23:57:06] [config] lr-decay-repeat-warmup: false
[2023-07-19 23:57:06] [config] lr-decay-reset-optimizer: false
[2023-07-19 23:57:06] [config] lr-decay-start:
[2023-07-19 23:57:06] [config]   - 10
[2023-07-19 23:57:06] [config]   - 1
[2023-07-19 23:57:06] [config] lr-decay-strategy: epoch+stalled
[2023-07-19 23:57:06] [config] lr-report: false
[2023-07-19 23:57:06] [config] lr-warmup: 0
[2023-07-19 23:57:06] [config] lr-warmup-at-reload: false
[2023-07-19 23:57:06] [config] lr-warmup-cycle: false
[2023-07-19 23:57:06] [config] lr-warmup-start-rate: 0
[2023-07-19 23:57:06] [config] max-length: 200
[2023-07-19 23:57:06] [config] max-length-crop: true
[2023-07-19 23:57:06] [config] max-length-factor: 3
[2023-07-19 23:57:06] [config] maxi-batch: 100
[2023-07-19 23:57:06] [config] maxi-batch-sort: trg
[2023-07-19 23:57:06] [config] mini-batch: 64
[2023-07-19 23:57:06] [config] mini-batch-fit: true
[2023-07-19 23:57:06] [config] mini-batch-fit-step: 10
[2023-07-19 23:57:06] [config] mini-batch-round-up: true
[2023-07-19 23:57:06] [config] mini-batch-track-lr: false
[2023-07-19 23:57:06] [config] mini-batch-warmup: 0
[2023-07-19 23:57:06] [config] mini-batch-words: 0
[2023-07-19 23:57:06] [config] mini-batch-words-ref: 0
[2023-07-19 23:57:06] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-19 23:57:06] [config] multi-loss-type: sum
[2023-07-19 23:57:06] [config] n-best: false
[2023-07-19 23:57:06] [config] no-nccl: false
[2023-07-19 23:57:06] [config] no-reload: false
[2023-07-19 23:57:06] [config] no-restore-corpus: false
[2023-07-19 23:57:06] [config] normalize: 0
[2023-07-19 23:57:06] [config] normalize-gradient: false
[2023-07-19 23:57:06] [config] num-devices: 0
[2023-07-19 23:57:06] [config] optimizer: adam
[2023-07-19 23:57:06] [config] optimizer-delay: 1
[2023-07-19 23:57:06] [config] optimizer-params:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] output-omit-bias: false
[2023-07-19 23:57:06] [config] overwrite: true
[2023-07-19 23:57:06] [config] precision:
[2023-07-19 23:57:06] [config]   - float16
[2023-07-19 23:57:06] [config]   - float32
[2023-07-19 23:57:06] [config] pretrained-model: ""
[2023-07-19 23:57:06] [config] quantize-biases: false
[2023-07-19 23:57:06] [config] quantize-bits: 0
[2023-07-19 23:57:06] [config] quantize-log-based: false
[2023-07-19 23:57:06] [config] quantize-optimization-steps: 0
[2023-07-19 23:57:06] [config] quiet: false
[2023-07-19 23:57:06] [config] quiet-translation: true
[2023-07-19 23:57:06] [config] relative-paths: false
[2023-07-19 23:57:06] [config] right-left: false
[2023-07-19 23:57:06] [config] save-freq: 10000u
[2023-07-19 23:57:06] [config] seed: 1234
[2023-07-19 23:57:06] [config] sentencepiece-alphas:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] sentencepiece-max-lines: 2000000
[2023-07-19 23:57:06] [config] sentencepiece-options: ""
[2023-07-19 23:57:06] [config] sharding: global
[2023-07-19 23:57:06] [config] shuffle: data
[2023-07-19 23:57:06] [config] shuffle-in-ram: false
[2023-07-19 23:57:06] [config] sigterm: save-and-exit
[2023-07-19 23:57:06] [config] skip: false
[2023-07-19 23:57:06] [config] sqlite: ""
[2023-07-19 23:57:06] [config] sqlite-drop: false
[2023-07-19 23:57:06] [config] sync-freq: 200u
[2023-07-19 23:57:06] [config] sync-sgd: false
[2023-07-19 23:57:06] [config] tempdir: /tmp
[2023-07-19 23:57:06] [config] tied-embeddings: false
[2023-07-19 23:57:06] [config] tied-embeddings-all: true
[2023-07-19 23:57:06] [config] tied-embeddings-src: false
[2023-07-19 23:57:06] [config] train-embedder-rank:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] train-sets:
[2023-07-19 23:57:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-19 23:57:06] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-19 23:57:06] [config] transformer-aan-activation: swish
[2023-07-19 23:57:06] [config] transformer-aan-depth: 2
[2023-07-19 23:57:06] [config] transformer-aan-nogate: false
[2023-07-19 23:57:06] [config] transformer-decoder-autoreg: self-attention
[2023-07-19 23:57:06] [config] transformer-decoder-dim-ffn: 0
[2023-07-19 23:57:06] [config] transformer-decoder-ffn-depth: 0
[2023-07-19 23:57:06] [config] transformer-depth-scaling: false
[2023-07-19 23:57:06] [config] transformer-dim-aan: 2048
[2023-07-19 23:57:06] [config] transformer-dim-ffn: 2048
[2023-07-19 23:57:06] [config] transformer-dropout: 0
[2023-07-19 23:57:06] [config] transformer-dropout-attention: 0
[2023-07-19 23:57:06] [config] transformer-dropout-ffn: 0
[2023-07-19 23:57:06] [config] transformer-ffn-activation: swish
[2023-07-19 23:57:06] [config] transformer-ffn-depth: 2
[2023-07-19 23:57:06] [config] transformer-guided-alignment-layer: last
[2023-07-19 23:57:06] [config] transformer-heads: 8
[2023-07-19 23:57:06] [config] transformer-no-projection: false
[2023-07-19 23:57:06] [config] transformer-pool: false
[2023-07-19 23:57:06] [config] transformer-postprocess: dan
[2023-07-19 23:57:06] [config] transformer-postprocess-emb: d
[2023-07-19 23:57:06] [config] transformer-postprocess-top: ""
[2023-07-19 23:57:06] [config] transformer-preprocess: ""
[2023-07-19 23:57:06] [config] transformer-tied-layers:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] transformer-train-position-embeddings: false
[2023-07-19 23:57:06] [config] tsv: false
[2023-07-19 23:57:06] [config] tsv-fields: 0
[2023-07-19 23:57:06] [config] type: amun
[2023-07-19 23:57:06] [config] ulr: false
[2023-07-19 23:57:06] [config] ulr-dim-emb: 0
[2023-07-19 23:57:06] [config] ulr-dropout: 0
[2023-07-19 23:57:06] [config] ulr-keys-vectors: ""
[2023-07-19 23:57:06] [config] ulr-query-vectors: ""
[2023-07-19 23:57:06] [config] ulr-softmax-temperature: 1
[2023-07-19 23:57:06] [config] ulr-trainable-transformation: false
[2023-07-19 23:57:06] [config] unlikelihood-loss: false
[2023-07-19 23:57:06] [config] valid-freq: 50000000
[2023-07-19 23:57:06] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-19 23:57:06] [config] valid-max-length: 1000
[2023-07-19 23:57:06] [config] valid-metrics:
[2023-07-19 23:57:06] [config]   - cross-entropy
[2023-07-19 23:57:06] [config]   - translation
[2023-07-19 23:57:06] [config] valid-mini-batch: 32
[2023-07-19 23:57:06] [config] valid-reset-stalled: false
[2023-07-19 23:57:06] [config] valid-script-args:
[2023-07-19 23:57:06] [config]   []
[2023-07-19 23:57:06] [config] valid-script-path: ""
[2023-07-19 23:57:06] [config] valid-sets:
[2023-07-19 23:57:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-19 23:57:06] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-19 23:57:06] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-19 23:57:06] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 23:57:06] [config] vocabs:
[2023-07-19 23:57:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 23:57:06] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 23:57:06] [config] word-penalty: 0
[2023-07-19 23:57:06] [config] word-scores: false
[2023-07-19 23:57:06] [config] workspace: 5500
[2023-07-19 23:57:06] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-19 23:57:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 23:57:06] [training] Using single-device training
[2023-07-19 23:57:06] Synced seed 1234
[2023-07-19 23:57:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-19 23:57:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-19 23:57:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-19 23:57:07] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-19 23:57:07] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-19 23:57:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-19 23:57:07] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-19 23:57:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-19 23:57:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-19 23:57:08] [comm] Using global sharding
[2023-07-19 23:57:08] [comm] NCCLCommunicators constructed successfully
[2023-07-19 23:57:08] [training] Using 1 GPUs
[2023-07-19 23:57:08] [logits] Applying loss function for 1 factor(s)
[2023-07-19 23:57:08] [memory] Reserving 80 MB, device gpu0
[2023-07-19 23:57:08] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-19 23:57:08] [memory] Reserving 80 MB, device gpu0
[2023-07-20 00:37:13] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 00:37:13] [valid] No post-processing script given for validating translator
[2023-07-20 00:37:13] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 00:37:13] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 00:37:13] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 00:37:13] [comm] Using global sharding
[2023-07-20 00:37:13] [comm] NCCLCommunicators constructed successfully
[2023-07-20 00:37:13] [training] Using 1 GPUs
[2023-07-20 00:37:13] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 00:37:20] Allocating memory for general optimizer shards
[2023-07-20 00:37:20] [memory] Reserving 322 MB, device gpu0
[2023-07-20 00:37:20] Loading Adam parameters
[2023-07-20 00:37:21] [memory] Reserving 322 MB, device gpu0
[2023-07-20 00:37:21] [memory] Reserving 80 MB, device gpu0
[2023-07-20 00:37:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 00:37:21] [data] Restoring the corpus state to epoch 101, batch 3861
[2023-07-20 00:37:21] [data] Shuffling data
[2023-07-20 00:37:21] [data] Done reading 20,192 sentences
[2023-07-20 00:37:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 00:37:21] Training started
[2023-07-20 00:37:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 00:37:22] [memory] Reserving 80 MB, device gpu0
[2023-07-20 00:37:27] Parameter type float16, optimization type float32, casting types true
[2023-07-20 00:41:44] Seen 20,192 samples
[2023-07-20 00:41:44] Starting data epoch 102 in logical epoch 102
[2023-07-20 00:41:44] [data] Shuffling data
[2023-07-20 00:41:44] [data] Done reading 20,192 sentences
[2023-07-20 00:41:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 00:46:14] Seen 20,192 samples
[2023-07-20 00:46:14] Starting data epoch 103 in logical epoch 103
[2023-07-20 00:46:14] [data] Shuffling data
[2023-07-20 00:46:14] [data] Done reading 20,192 sentences
[2023-07-20 00:46:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 00:50:46] Seen 20,192 samples
[2023-07-20 00:50:46] Starting data epoch 104 in logical epoch 104
[2023-07-20 00:50:46] [data] Shuffling data
[2023-07-20 00:50:46] [data] Done reading 20,192 sentences
[2023-07-20 00:50:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 00:53:30] Ep. 104 : Up. 4000 : Sen. 12,400 : Cost 3.67627025 * 15,949,621 @ 22,390 after 64,269,531 : Time 976.92s : 16326.47 words/s : gNorm 1.1592
[2023-07-20 00:55:16] Seen 20,192 samples
[2023-07-20 00:55:16] Starting data epoch 105 in logical epoch 105
[2023-07-20 00:55:16] [data] Shuffling data
[2023-07-20 00:55:16] [data] Done reading 20,192 sentences
[2023-07-20 00:55:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 00:59:47] Seen 20,192 samples
[2023-07-20 00:59:47] Starting data epoch 106 in logical epoch 106
[2023-07-20 00:59:47] [data] Shuffling data
[2023-07-20 00:59:47] [data] Done reading 20,192 sentences
[2023-07-20 00:59:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 01:04:18] Seen 20,192 samples
[2023-07-20 01:04:18] Starting data epoch 107 in logical epoch 107
[2023-07-20 01:04:18] [data] Shuffling data
[2023-07-20 01:04:18] [data] Done reading 20,192 sentences
[2023-07-20 01:04:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 01:08:45] Seen 20,192 samples
[2023-07-20 01:08:45] Starting data epoch 108 in logical epoch 108
[2023-07-20 01:08:45] [data] Shuffling data
[2023-07-20 01:08:45] [data] Done reading 20,192 sentences
[2023-07-20 01:08:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 01:13:24] Seen 20,192 samples
[2023-07-20 01:13:24] Starting data epoch 109 in logical epoch 109
[2023-07-20 01:13:24] [data] Shuffling data
[2023-07-20 01:13:24] [data] Done reading 20,192 sentences
[2023-07-20 01:13:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 01:17:55] Seen 20,192 samples
[2023-07-20 01:17:55] Starting data epoch 110 in logical epoch 110
[2023-07-20 01:17:55] [data] Shuffling data
[2023-07-20 01:17:55] [data] Done reading 20,192 sentences
[2023-07-20 01:17:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 01:22:24] Seen 20,192 samples
[2023-07-20 01:22:24] Starting data epoch 111 in logical epoch 111
[2023-07-20 01:22:24] Training finished
[2023-07-20 01:22:38] [valid] Ep. 111 : Up. 4244 : cross-entropy : 126.589 : new best
[2023-07-20 01:24:55] [valid] Ep. 111 : Up. 4244 : translation : 0 : new best
[2023-07-20 01:24:55] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 01:24:57] Saving Adam parameters
[2023-07-20 01:24:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 01:25:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 01:25:05] [marian] Running on node18.datos.cluster.uy as process 18615 with command line:
[2023-07-20 01:25:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 01:25:05] [config] after: 0e
[2023-07-20 01:25:05] [config] after-batches: 0
[2023-07-20 01:25:05] [config] after-epochs: 120
[2023-07-20 01:25:05] [config] all-caps-every: 0
[2023-07-20 01:25:05] [config] allow-unk: false
[2023-07-20 01:25:05] [config] authors: false
[2023-07-20 01:25:05] [config] beam-size: 12
[2023-07-20 01:25:05] [config] bert-class-symbol: "[CLS]"
[2023-07-20 01:25:05] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 01:25:05] [config] bert-masking-fraction: 0.15
[2023-07-20 01:25:05] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 01:25:05] [config] bert-train-type-embeddings: true
[2023-07-20 01:25:05] [config] bert-type-vocab-size: 2
[2023-07-20 01:25:05] [config] build-info: ""
[2023-07-20 01:25:05] [config] check-gradient-nan: false
[2023-07-20 01:25:05] [config] check-nan: false
[2023-07-20 01:25:05] [config] cite: false
[2023-07-20 01:25:05] [config] clip-norm: 1
[2023-07-20 01:25:05] [config] cost-scaling:
[2023-07-20 01:25:05] [config]   - 256.f
[2023-07-20 01:25:05] [config]   - 1000
[2023-07-20 01:25:05] [config]   - 2.f
[2023-07-20 01:25:05] [config]   - 256.f
[2023-07-20 01:25:05] [config] cost-type: ce-sum
[2023-07-20 01:25:05] [config] cpu-threads: 0
[2023-07-20 01:25:05] [config] data-threads: 8
[2023-07-20 01:25:05] [config] data-weighting: ""
[2023-07-20 01:25:05] [config] data-weighting-type: sentence
[2023-07-20 01:25:05] [config] dec-cell: gru
[2023-07-20 01:25:05] [config] dec-cell-base-depth: 2
[2023-07-20 01:25:05] [config] dec-cell-high-depth: 1
[2023-07-20 01:25:05] [config] dec-depth: 1
[2023-07-20 01:25:05] [config] devices:
[2023-07-20 01:25:05] [config]   - 0
[2023-07-20 01:25:05] [config] dim-emb: 512
[2023-07-20 01:25:05] [config] dim-rnn: 1024
[2023-07-20 01:25:05] [config] dim-vocabs:
[2023-07-20 01:25:05] [config]   - 16384
[2023-07-20 01:25:05] [config]   - 16384
[2023-07-20 01:25:05] [config] disp-first: 0
[2023-07-20 01:25:05] [config] disp-freq: 1000u
[2023-07-20 01:25:05] [config] disp-label-counts: true
[2023-07-20 01:25:05] [config] dropout-rnn: 0
[2023-07-20 01:25:05] [config] dropout-src: 0
[2023-07-20 01:25:05] [config] dropout-trg: 0
[2023-07-20 01:25:05] [config] dump-config: ""
[2023-07-20 01:25:05] [config] dynamic-gradient-scaling:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] early-stopping: 200
[2023-07-20 01:25:05] [config] early-stopping-on: first
[2023-07-20 01:25:05] [config] embedding-fix-src: false
[2023-07-20 01:25:05] [config] embedding-fix-trg: false
[2023-07-20 01:25:05] [config] embedding-normalization: false
[2023-07-20 01:25:05] [config] embedding-vectors:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] enc-cell: gru
[2023-07-20 01:25:05] [config] enc-cell-depth: 1
[2023-07-20 01:25:05] [config] enc-depth: 1
[2023-07-20 01:25:05] [config] enc-type: bidirectional
[2023-07-20 01:25:05] [config] english-title-case-every: 0
[2023-07-20 01:25:05] [config] exponential-smoothing: 0
[2023-07-20 01:25:05] [config] factor-weight: 1
[2023-07-20 01:25:05] [config] factors-combine: sum
[2023-07-20 01:25:05] [config] factors-dim-emb: 0
[2023-07-20 01:25:05] [config] gradient-checkpointing: false
[2023-07-20 01:25:05] [config] gradient-norm-average-window: 100
[2023-07-20 01:25:05] [config] guided-alignment: none
[2023-07-20 01:25:05] [config] guided-alignment-cost: mse
[2023-07-20 01:25:05] [config] guided-alignment-weight: 0.1
[2023-07-20 01:25:05] [config] ignore-model-config: false
[2023-07-20 01:25:05] [config] input-types:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] interpolate-env-vars: false
[2023-07-20 01:25:05] [config] keep-best: false
[2023-07-20 01:25:05] [config] label-smoothing: 0
[2023-07-20 01:25:05] [config] layer-normalization: false
[2023-07-20 01:25:05] [config] learn-rate: 0.0001
[2023-07-20 01:25:05] [config] lemma-dependency: ""
[2023-07-20 01:25:05] [config] lemma-dim-emb: 0
[2023-07-20 01:25:05] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 01:25:05] [config] log-level: info
[2023-07-20 01:25:05] [config] log-time-zone: ""
[2023-07-20 01:25:05] [config] logical-epoch:
[2023-07-20 01:25:05] [config]   - 1e
[2023-07-20 01:25:05] [config]   - 0
[2023-07-20 01:25:05] [config] lr-decay: 0
[2023-07-20 01:25:05] [config] lr-decay-freq: 50000
[2023-07-20 01:25:05] [config] lr-decay-inv-sqrt:
[2023-07-20 01:25:05] [config]   - 0
[2023-07-20 01:25:05] [config] lr-decay-repeat-warmup: false
[2023-07-20 01:25:05] [config] lr-decay-reset-optimizer: false
[2023-07-20 01:25:05] [config] lr-decay-start:
[2023-07-20 01:25:05] [config]   - 10
[2023-07-20 01:25:05] [config]   - 1
[2023-07-20 01:25:05] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 01:25:05] [config] lr-report: false
[2023-07-20 01:25:05] [config] lr-warmup: 0
[2023-07-20 01:25:05] [config] lr-warmup-at-reload: false
[2023-07-20 01:25:05] [config] lr-warmup-cycle: false
[2023-07-20 01:25:05] [config] lr-warmup-start-rate: 0
[2023-07-20 01:25:05] [config] max-length: 200
[2023-07-20 01:25:05] [config] max-length-crop: true
[2023-07-20 01:25:05] [config] max-length-factor: 3
[2023-07-20 01:25:05] [config] maxi-batch: 100
[2023-07-20 01:25:05] [config] maxi-batch-sort: trg
[2023-07-20 01:25:05] [config] mini-batch: 64
[2023-07-20 01:25:05] [config] mini-batch-fit: true
[2023-07-20 01:25:05] [config] mini-batch-fit-step: 10
[2023-07-20 01:25:05] [config] mini-batch-round-up: true
[2023-07-20 01:25:05] [config] mini-batch-track-lr: false
[2023-07-20 01:25:05] [config] mini-batch-warmup: 0
[2023-07-20 01:25:05] [config] mini-batch-words: 0
[2023-07-20 01:25:05] [config] mini-batch-words-ref: 0
[2023-07-20 01:25:05] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 01:25:05] [config] multi-loss-type: sum
[2023-07-20 01:25:05] [config] n-best: false
[2023-07-20 01:25:05] [config] no-nccl: false
[2023-07-20 01:25:05] [config] no-reload: false
[2023-07-20 01:25:05] [config] no-restore-corpus: false
[2023-07-20 01:25:05] [config] normalize: 0
[2023-07-20 01:25:05] [config] normalize-gradient: false
[2023-07-20 01:25:05] [config] num-devices: 0
[2023-07-20 01:25:05] [config] optimizer: adam
[2023-07-20 01:25:05] [config] optimizer-delay: 1
[2023-07-20 01:25:05] [config] optimizer-params:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] output-omit-bias: false
[2023-07-20 01:25:05] [config] overwrite: true
[2023-07-20 01:25:05] [config] precision:
[2023-07-20 01:25:05] [config]   - float16
[2023-07-20 01:25:05] [config]   - float32
[2023-07-20 01:25:05] [config] pretrained-model: ""
[2023-07-20 01:25:05] [config] quantize-biases: false
[2023-07-20 01:25:05] [config] quantize-bits: 0
[2023-07-20 01:25:05] [config] quantize-log-based: false
[2023-07-20 01:25:05] [config] quantize-optimization-steps: 0
[2023-07-20 01:25:05] [config] quiet: false
[2023-07-20 01:25:05] [config] quiet-translation: true
[2023-07-20 01:25:05] [config] relative-paths: false
[2023-07-20 01:25:05] [config] right-left: false
[2023-07-20 01:25:05] [config] save-freq: 10000u
[2023-07-20 01:25:05] [config] seed: 1234
[2023-07-20 01:25:05] [config] sentencepiece-alphas:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] sentencepiece-max-lines: 2000000
[2023-07-20 01:25:05] [config] sentencepiece-options: ""
[2023-07-20 01:25:05] [config] sharding: global
[2023-07-20 01:25:05] [config] shuffle: data
[2023-07-20 01:25:05] [config] shuffle-in-ram: false
[2023-07-20 01:25:05] [config] sigterm: save-and-exit
[2023-07-20 01:25:05] [config] skip: false
[2023-07-20 01:25:05] [config] sqlite: ""
[2023-07-20 01:25:05] [config] sqlite-drop: false
[2023-07-20 01:25:05] [config] sync-freq: 200u
[2023-07-20 01:25:05] [config] sync-sgd: false
[2023-07-20 01:25:05] [config] tempdir: /tmp
[2023-07-20 01:25:05] [config] tied-embeddings: false
[2023-07-20 01:25:05] [config] tied-embeddings-all: true
[2023-07-20 01:25:05] [config] tied-embeddings-src: false
[2023-07-20 01:25:05] [config] train-embedder-rank:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] train-sets:
[2023-07-20 01:25:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 01:25:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 01:25:05] [config] transformer-aan-activation: swish
[2023-07-20 01:25:05] [config] transformer-aan-depth: 2
[2023-07-20 01:25:05] [config] transformer-aan-nogate: false
[2023-07-20 01:25:05] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 01:25:05] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 01:25:05] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 01:25:05] [config] transformer-depth-scaling: false
[2023-07-20 01:25:05] [config] transformer-dim-aan: 2048
[2023-07-20 01:25:05] [config] transformer-dim-ffn: 2048
[2023-07-20 01:25:05] [config] transformer-dropout: 0
[2023-07-20 01:25:05] [config] transformer-dropout-attention: 0
[2023-07-20 01:25:05] [config] transformer-dropout-ffn: 0
[2023-07-20 01:25:05] [config] transformer-ffn-activation: swish
[2023-07-20 01:25:05] [config] transformer-ffn-depth: 2
[2023-07-20 01:25:05] [config] transformer-guided-alignment-layer: last
[2023-07-20 01:25:05] [config] transformer-heads: 8
[2023-07-20 01:25:05] [config] transformer-no-projection: false
[2023-07-20 01:25:05] [config] transformer-pool: false
[2023-07-20 01:25:05] [config] transformer-postprocess: dan
[2023-07-20 01:25:05] [config] transformer-postprocess-emb: d
[2023-07-20 01:25:05] [config] transformer-postprocess-top: ""
[2023-07-20 01:25:05] [config] transformer-preprocess: ""
[2023-07-20 01:25:05] [config] transformer-tied-layers:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] transformer-train-position-embeddings: false
[2023-07-20 01:25:05] [config] tsv: false
[2023-07-20 01:25:05] [config] tsv-fields: 0
[2023-07-20 01:25:05] [config] type: amun
[2023-07-20 01:25:05] [config] ulr: false
[2023-07-20 01:25:05] [config] ulr-dim-emb: 0
[2023-07-20 01:25:05] [config] ulr-dropout: 0
[2023-07-20 01:25:05] [config] ulr-keys-vectors: ""
[2023-07-20 01:25:05] [config] ulr-query-vectors: ""
[2023-07-20 01:25:05] [config] ulr-softmax-temperature: 1
[2023-07-20 01:25:05] [config] ulr-trainable-transformation: false
[2023-07-20 01:25:05] [config] unlikelihood-loss: false
[2023-07-20 01:25:05] [config] valid-freq: 50000000
[2023-07-20 01:25:05] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 01:25:05] [config] valid-max-length: 1000
[2023-07-20 01:25:05] [config] valid-metrics:
[2023-07-20 01:25:05] [config]   - cross-entropy
[2023-07-20 01:25:05] [config]   - translation
[2023-07-20 01:25:05] [config] valid-mini-batch: 32
[2023-07-20 01:25:05] [config] valid-reset-stalled: false
[2023-07-20 01:25:05] [config] valid-script-args:
[2023-07-20 01:25:05] [config]   []
[2023-07-20 01:25:05] [config] valid-script-path: ""
[2023-07-20 01:25:05] [config] valid-sets:
[2023-07-20 01:25:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 01:25:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 01:25:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 01:25:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 01:25:05] [config] vocabs:
[2023-07-20 01:25:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 01:25:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 01:25:05] [config] word-penalty: 0
[2023-07-20 01:25:05] [config] word-scores: false
[2023-07-20 01:25:05] [config] workspace: 5500
[2023-07-20 01:25:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 01:25:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 01:25:05] [training] Using single-device training
[2023-07-20 01:25:05] Synced seed 1234
[2023-07-20 01:25:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 01:25:05] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 01:25:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 01:25:05] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 01:25:05] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 01:25:05] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 01:25:05] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 01:25:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 01:25:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 01:25:07] [comm] Using global sharding
[2023-07-20 01:25:07] [comm] NCCLCommunicators constructed successfully
[2023-07-20 01:25:07] [training] Using 1 GPUs
[2023-07-20 01:25:07] [logits] Applying loss function for 1 factor(s)
[2023-07-20 01:25:07] [memory] Reserving 80 MB, device gpu0
[2023-07-20 01:25:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 01:25:07] [memory] Reserving 80 MB, device gpu0
[2023-07-20 02:05:17] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 02:05:17] [valid] No post-processing script given for validating translator
[2023-07-20 02:05:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 02:05:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 02:05:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 02:05:17] [comm] Using global sharding
[2023-07-20 02:05:17] [comm] NCCLCommunicators constructed successfully
[2023-07-20 02:05:17] [training] Using 1 GPUs
[2023-07-20 02:05:17] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 02:05:24] Allocating memory for general optimizer shards
[2023-07-20 02:05:24] [memory] Reserving 322 MB, device gpu0
[2023-07-20 02:05:24] Loading Adam parameters
[2023-07-20 02:05:25] [memory] Reserving 322 MB, device gpu0
[2023-07-20 02:05:25] [memory] Reserving 80 MB, device gpu0
[2023-07-20 02:05:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 02:05:25] [data] Restoring the corpus state to epoch 111, batch 4244
[2023-07-20 02:05:25] [data] Shuffling data
[2023-07-20 02:05:25] [data] Done reading 20,192 sentences
[2023-07-20 02:05:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:05:25] Training started
[2023-07-20 02:05:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 02:05:25] [memory] Reserving 80 MB, device gpu0
[2023-07-20 02:05:28] Parameter type float16, optimization type float32, casting types true
[2023-07-20 02:09:28] Seen 20,192 samples
[2023-07-20 02:09:28] Starting data epoch 112 in logical epoch 112
[2023-07-20 02:09:28] [data] Shuffling data
[2023-07-20 02:09:28] [data] Done reading 20,192 sentences
[2023-07-20 02:09:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:13:46] Seen 20,192 samples
[2023-07-20 02:13:46] Starting data epoch 113 in logical epoch 113
[2023-07-20 02:13:46] [data] Shuffling data
[2023-07-20 02:13:46] [data] Done reading 20,192 sentences
[2023-07-20 02:13:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:18:21] Seen 20,192 samples
[2023-07-20 02:18:21] Starting data epoch 114 in logical epoch 114
[2023-07-20 02:18:21] [data] Shuffling data
[2023-07-20 02:18:21] [data] Done reading 20,192 sentences
[2023-07-20 02:18:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:22:55] Seen 20,192 samples
[2023-07-20 02:22:55] Starting data epoch 115 in logical epoch 115
[2023-07-20 02:22:55] [data] Shuffling data
[2023-07-20 02:22:56] [data] Done reading 20,192 sentences
[2023-07-20 02:22:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:27:31] Seen 20,192 samples
[2023-07-20 02:27:31] Starting data epoch 116 in logical epoch 116
[2023-07-20 02:27:31] [data] Shuffling data
[2023-07-20 02:27:31] [data] Done reading 20,192 sentences
[2023-07-20 02:27:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:32:04] Seen 20,192 samples
[2023-07-20 02:32:04] Starting data epoch 117 in logical epoch 117
[2023-07-20 02:32:04] [data] Shuffling data
[2023-07-20 02:32:04] [data] Done reading 20,192 sentences
[2023-07-20 02:32:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:36:37] Seen 20,192 samples
[2023-07-20 02:36:37] Starting data epoch 118 in logical epoch 118
[2023-07-20 02:36:37] [data] Shuffling data
[2023-07-20 02:36:37] [data] Done reading 20,192 sentences
[2023-07-20 02:36:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:41:11] Seen 20,192 samples
[2023-07-20 02:41:11] Starting data epoch 119 in logical epoch 119
[2023-07-20 02:41:11] [data] Shuffling data
[2023-07-20 02:41:11] [data] Done reading 20,192 sentences
[2023-07-20 02:41:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:45:31] Seen 20,192 samples
[2023-07-20 02:45:31] Starting data epoch 120 in logical epoch 120
[2023-07-20 02:45:31] [data] Shuffling data
[2023-07-20 02:45:31] [data] Done reading 20,192 sentences
[2023-07-20 02:45:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 02:49:59] Seen 20,192 samples
[2023-07-20 02:49:59] Starting data epoch 121 in logical epoch 121
[2023-07-20 02:49:59] Training finished
[2023-07-20 02:50:11] [valid] Ep. 121 : Up. 4633 : cross-entropy : 125.114 : new best
[2023-07-20 02:52:39] [valid] Ep. 121 : Up. 4633 : translation : 0 : new best
[2023-07-20 02:52:39] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 02:52:42] Saving Adam parameters
[2023-07-20 02:52:42] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 02:52:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 02:52:51] [marian] Running on node18.datos.cluster.uy as process 24322 with command line:
[2023-07-20 02:52:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 02:52:51] [config] after: 0e
[2023-07-20 02:52:51] [config] after-batches: 0
[2023-07-20 02:52:51] [config] after-epochs: 130
[2023-07-20 02:52:51] [config] all-caps-every: 0
[2023-07-20 02:52:51] [config] allow-unk: false
[2023-07-20 02:52:51] [config] authors: false
[2023-07-20 02:52:51] [config] beam-size: 12
[2023-07-20 02:52:51] [config] bert-class-symbol: "[CLS]"
[2023-07-20 02:52:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 02:52:51] [config] bert-masking-fraction: 0.15
[2023-07-20 02:52:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 02:52:51] [config] bert-train-type-embeddings: true
[2023-07-20 02:52:51] [config] bert-type-vocab-size: 2
[2023-07-20 02:52:51] [config] build-info: ""
[2023-07-20 02:52:51] [config] check-gradient-nan: false
[2023-07-20 02:52:51] [config] check-nan: false
[2023-07-20 02:52:51] [config] cite: false
[2023-07-20 02:52:51] [config] clip-norm: 1
[2023-07-20 02:52:51] [config] cost-scaling:
[2023-07-20 02:52:51] [config]   - 256.f
[2023-07-20 02:52:51] [config]   - 1000
[2023-07-20 02:52:51] [config]   - 2.f
[2023-07-20 02:52:51] [config]   - 256.f
[2023-07-20 02:52:51] [config] cost-type: ce-sum
[2023-07-20 02:52:51] [config] cpu-threads: 0
[2023-07-20 02:52:51] [config] data-threads: 8
[2023-07-20 02:52:51] [config] data-weighting: ""
[2023-07-20 02:52:51] [config] data-weighting-type: sentence
[2023-07-20 02:52:51] [config] dec-cell: gru
[2023-07-20 02:52:51] [config] dec-cell-base-depth: 2
[2023-07-20 02:52:51] [config] dec-cell-high-depth: 1
[2023-07-20 02:52:51] [config] dec-depth: 1
[2023-07-20 02:52:51] [config] devices:
[2023-07-20 02:52:51] [config]   - 0
[2023-07-20 02:52:51] [config] dim-emb: 512
[2023-07-20 02:52:51] [config] dim-rnn: 1024
[2023-07-20 02:52:51] [config] dim-vocabs:
[2023-07-20 02:52:51] [config]   - 16384
[2023-07-20 02:52:51] [config]   - 16384
[2023-07-20 02:52:51] [config] disp-first: 0
[2023-07-20 02:52:51] [config] disp-freq: 1000u
[2023-07-20 02:52:51] [config] disp-label-counts: true
[2023-07-20 02:52:51] [config] dropout-rnn: 0
[2023-07-20 02:52:51] [config] dropout-src: 0
[2023-07-20 02:52:51] [config] dropout-trg: 0
[2023-07-20 02:52:51] [config] dump-config: ""
[2023-07-20 02:52:51] [config] dynamic-gradient-scaling:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] early-stopping: 200
[2023-07-20 02:52:51] [config] early-stopping-on: first
[2023-07-20 02:52:51] [config] embedding-fix-src: false
[2023-07-20 02:52:51] [config] embedding-fix-trg: false
[2023-07-20 02:52:51] [config] embedding-normalization: false
[2023-07-20 02:52:51] [config] embedding-vectors:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] enc-cell: gru
[2023-07-20 02:52:51] [config] enc-cell-depth: 1
[2023-07-20 02:52:51] [config] enc-depth: 1
[2023-07-20 02:52:51] [config] enc-type: bidirectional
[2023-07-20 02:52:51] [config] english-title-case-every: 0
[2023-07-20 02:52:51] [config] exponential-smoothing: 0
[2023-07-20 02:52:51] [config] factor-weight: 1
[2023-07-20 02:52:51] [config] factors-combine: sum
[2023-07-20 02:52:51] [config] factors-dim-emb: 0
[2023-07-20 02:52:51] [config] gradient-checkpointing: false
[2023-07-20 02:52:51] [config] gradient-norm-average-window: 100
[2023-07-20 02:52:51] [config] guided-alignment: none
[2023-07-20 02:52:51] [config] guided-alignment-cost: mse
[2023-07-20 02:52:51] [config] guided-alignment-weight: 0.1
[2023-07-20 02:52:51] [config] ignore-model-config: false
[2023-07-20 02:52:51] [config] input-types:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] interpolate-env-vars: false
[2023-07-20 02:52:51] [config] keep-best: false
[2023-07-20 02:52:51] [config] label-smoothing: 0
[2023-07-20 02:52:51] [config] layer-normalization: false
[2023-07-20 02:52:51] [config] learn-rate: 0.0001
[2023-07-20 02:52:51] [config] lemma-dependency: ""
[2023-07-20 02:52:51] [config] lemma-dim-emb: 0
[2023-07-20 02:52:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 02:52:51] [config] log-level: info
[2023-07-20 02:52:51] [config] log-time-zone: ""
[2023-07-20 02:52:51] [config] logical-epoch:
[2023-07-20 02:52:51] [config]   - 1e
[2023-07-20 02:52:51] [config]   - 0
[2023-07-20 02:52:51] [config] lr-decay: 0
[2023-07-20 02:52:51] [config] lr-decay-freq: 50000
[2023-07-20 02:52:51] [config] lr-decay-inv-sqrt:
[2023-07-20 02:52:51] [config]   - 0
[2023-07-20 02:52:51] [config] lr-decay-repeat-warmup: false
[2023-07-20 02:52:51] [config] lr-decay-reset-optimizer: false
[2023-07-20 02:52:51] [config] lr-decay-start:
[2023-07-20 02:52:51] [config]   - 10
[2023-07-20 02:52:51] [config]   - 1
[2023-07-20 02:52:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 02:52:51] [config] lr-report: false
[2023-07-20 02:52:51] [config] lr-warmup: 0
[2023-07-20 02:52:51] [config] lr-warmup-at-reload: false
[2023-07-20 02:52:51] [config] lr-warmup-cycle: false
[2023-07-20 02:52:51] [config] lr-warmup-start-rate: 0
[2023-07-20 02:52:51] [config] max-length: 200
[2023-07-20 02:52:51] [config] max-length-crop: true
[2023-07-20 02:52:51] [config] max-length-factor: 3
[2023-07-20 02:52:51] [config] maxi-batch: 100
[2023-07-20 02:52:51] [config] maxi-batch-sort: trg
[2023-07-20 02:52:51] [config] mini-batch: 64
[2023-07-20 02:52:51] [config] mini-batch-fit: true
[2023-07-20 02:52:51] [config] mini-batch-fit-step: 10
[2023-07-20 02:52:51] [config] mini-batch-round-up: true
[2023-07-20 02:52:51] [config] mini-batch-track-lr: false
[2023-07-20 02:52:51] [config] mini-batch-warmup: 0
[2023-07-20 02:52:51] [config] mini-batch-words: 0
[2023-07-20 02:52:51] [config] mini-batch-words-ref: 0
[2023-07-20 02:52:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 02:52:51] [config] multi-loss-type: sum
[2023-07-20 02:52:51] [config] n-best: false
[2023-07-20 02:52:51] [config] no-nccl: false
[2023-07-20 02:52:51] [config] no-reload: false
[2023-07-20 02:52:51] [config] no-restore-corpus: false
[2023-07-20 02:52:51] [config] normalize: 0
[2023-07-20 02:52:51] [config] normalize-gradient: false
[2023-07-20 02:52:51] [config] num-devices: 0
[2023-07-20 02:52:51] [config] optimizer: adam
[2023-07-20 02:52:51] [config] optimizer-delay: 1
[2023-07-20 02:52:51] [config] optimizer-params:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] output-omit-bias: false
[2023-07-20 02:52:51] [config] overwrite: true
[2023-07-20 02:52:51] [config] precision:
[2023-07-20 02:52:51] [config]   - float16
[2023-07-20 02:52:51] [config]   - float32
[2023-07-20 02:52:51] [config] pretrained-model: ""
[2023-07-20 02:52:51] [config] quantize-biases: false
[2023-07-20 02:52:51] [config] quantize-bits: 0
[2023-07-20 02:52:51] [config] quantize-log-based: false
[2023-07-20 02:52:51] [config] quantize-optimization-steps: 0
[2023-07-20 02:52:51] [config] quiet: false
[2023-07-20 02:52:51] [config] quiet-translation: true
[2023-07-20 02:52:51] [config] relative-paths: false
[2023-07-20 02:52:51] [config] right-left: false
[2023-07-20 02:52:51] [config] save-freq: 10000u
[2023-07-20 02:52:51] [config] seed: 1234
[2023-07-20 02:52:51] [config] sentencepiece-alphas:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] sentencepiece-max-lines: 2000000
[2023-07-20 02:52:51] [config] sentencepiece-options: ""
[2023-07-20 02:52:51] [config] sharding: global
[2023-07-20 02:52:51] [config] shuffle: data
[2023-07-20 02:52:51] [config] shuffle-in-ram: false
[2023-07-20 02:52:51] [config] sigterm: save-and-exit
[2023-07-20 02:52:51] [config] skip: false
[2023-07-20 02:52:51] [config] sqlite: ""
[2023-07-20 02:52:51] [config] sqlite-drop: false
[2023-07-20 02:52:51] [config] sync-freq: 200u
[2023-07-20 02:52:51] [config] sync-sgd: false
[2023-07-20 02:52:51] [config] tempdir: /tmp
[2023-07-20 02:52:51] [config] tied-embeddings: false
[2023-07-20 02:52:51] [config] tied-embeddings-all: true
[2023-07-20 02:52:51] [config] tied-embeddings-src: false
[2023-07-20 02:52:51] [config] train-embedder-rank:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] train-sets:
[2023-07-20 02:52:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 02:52:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 02:52:51] [config] transformer-aan-activation: swish
[2023-07-20 02:52:51] [config] transformer-aan-depth: 2
[2023-07-20 02:52:51] [config] transformer-aan-nogate: false
[2023-07-20 02:52:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 02:52:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 02:52:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 02:52:51] [config] transformer-depth-scaling: false
[2023-07-20 02:52:51] [config] transformer-dim-aan: 2048
[2023-07-20 02:52:51] [config] transformer-dim-ffn: 2048
[2023-07-20 02:52:51] [config] transformer-dropout: 0
[2023-07-20 02:52:51] [config] transformer-dropout-attention: 0
[2023-07-20 02:52:51] [config] transformer-dropout-ffn: 0
[2023-07-20 02:52:51] [config] transformer-ffn-activation: swish
[2023-07-20 02:52:51] [config] transformer-ffn-depth: 2
[2023-07-20 02:52:51] [config] transformer-guided-alignment-layer: last
[2023-07-20 02:52:51] [config] transformer-heads: 8
[2023-07-20 02:52:51] [config] transformer-no-projection: false
[2023-07-20 02:52:51] [config] transformer-pool: false
[2023-07-20 02:52:51] [config] transformer-postprocess: dan
[2023-07-20 02:52:51] [config] transformer-postprocess-emb: d
[2023-07-20 02:52:51] [config] transformer-postprocess-top: ""
[2023-07-20 02:52:51] [config] transformer-preprocess: ""
[2023-07-20 02:52:51] [config] transformer-tied-layers:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] transformer-train-position-embeddings: false
[2023-07-20 02:52:51] [config] tsv: false
[2023-07-20 02:52:51] [config] tsv-fields: 0
[2023-07-20 02:52:51] [config] type: amun
[2023-07-20 02:52:51] [config] ulr: false
[2023-07-20 02:52:51] [config] ulr-dim-emb: 0
[2023-07-20 02:52:51] [config] ulr-dropout: 0
[2023-07-20 02:52:51] [config] ulr-keys-vectors: ""
[2023-07-20 02:52:51] [config] ulr-query-vectors: ""
[2023-07-20 02:52:51] [config] ulr-softmax-temperature: 1
[2023-07-20 02:52:51] [config] ulr-trainable-transformation: false
[2023-07-20 02:52:51] [config] unlikelihood-loss: false
[2023-07-20 02:52:51] [config] valid-freq: 50000000
[2023-07-20 02:52:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 02:52:51] [config] valid-max-length: 1000
[2023-07-20 02:52:51] [config] valid-metrics:
[2023-07-20 02:52:51] [config]   - cross-entropy
[2023-07-20 02:52:51] [config]   - translation
[2023-07-20 02:52:51] [config] valid-mini-batch: 32
[2023-07-20 02:52:51] [config] valid-reset-stalled: false
[2023-07-20 02:52:51] [config] valid-script-args:
[2023-07-20 02:52:51] [config]   []
[2023-07-20 02:52:51] [config] valid-script-path: ""
[2023-07-20 02:52:51] [config] valid-sets:
[2023-07-20 02:52:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 02:52:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 02:52:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 02:52:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 02:52:51] [config] vocabs:
[2023-07-20 02:52:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 02:52:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 02:52:51] [config] word-penalty: 0
[2023-07-20 02:52:51] [config] word-scores: false
[2023-07-20 02:52:51] [config] workspace: 5500
[2023-07-20 02:52:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 02:52:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 02:52:51] [training] Using single-device training
[2023-07-20 02:52:51] Synced seed 1234
[2023-07-20 02:52:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 02:52:51] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 02:52:51] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 02:52:51] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 02:52:51] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 02:52:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 02:52:51] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 02:52:53] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 02:52:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 02:52:53] [comm] Using global sharding
[2023-07-20 02:52:53] [comm] NCCLCommunicators constructed successfully
[2023-07-20 02:52:53] [training] Using 1 GPUs
[2023-07-20 02:52:53] [logits] Applying loss function for 1 factor(s)
[2023-07-20 02:52:53] [memory] Reserving 80 MB, device gpu0
[2023-07-20 02:52:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 02:52:53] [memory] Reserving 80 MB, device gpu0
[2023-07-20 03:32:09] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 03:32:09] [valid] No post-processing script given for validating translator
[2023-07-20 03:32:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 03:32:09] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 03:32:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 03:32:09] [comm] Using global sharding
[2023-07-20 03:32:09] [comm] NCCLCommunicators constructed successfully
[2023-07-20 03:32:09] [training] Using 1 GPUs
[2023-07-20 03:32:09] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 03:32:16] Allocating memory for general optimizer shards
[2023-07-20 03:32:16] [memory] Reserving 322 MB, device gpu0
[2023-07-20 03:32:16] Loading Adam parameters
[2023-07-20 03:32:16] [memory] Reserving 322 MB, device gpu0
[2023-07-20 03:32:16] [memory] Reserving 80 MB, device gpu0
[2023-07-20 03:32:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 03:32:16] [data] Restoring the corpus state to epoch 121, batch 4633
[2023-07-20 03:32:16] [data] Shuffling data
[2023-07-20 03:32:16] [data] Done reading 20,192 sentences
[2023-07-20 03:32:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 03:32:16] Training started
[2023-07-20 03:32:16] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 03:32:17] [memory] Reserving 80 MB, device gpu0
[2023-07-20 03:32:19] Parameter type float16, optimization type float32, casting types true
[2023-07-20 03:36:35] Seen 20,192 samples
[2023-07-20 03:36:35] Starting data epoch 122 in logical epoch 122
[2023-07-20 03:36:35] [data] Shuffling data
[2023-07-20 03:36:35] [data] Done reading 20,192 sentences
[2023-07-20 03:36:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 03:40:46] Seen 20,192 samples
[2023-07-20 03:40:46] Starting data epoch 123 in logical epoch 123
[2023-07-20 03:40:46] [data] Shuffling data
[2023-07-20 03:40:46] [data] Done reading 20,192 sentences
[2023-07-20 03:40:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 03:45:05] Seen 20,192 samples
[2023-07-20 03:45:05] Starting data epoch 124 in logical epoch 124
[2023-07-20 03:45:05] [data] Shuffling data
[2023-07-20 03:45:05] [data] Done reading 20,192 sentences
[2023-07-20 03:45:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 03:49:24] Seen 20,192 samples
[2023-07-20 03:49:24] Starting data epoch 125 in logical epoch 125
[2023-07-20 03:49:24] [data] Shuffling data
[2023-07-20 03:49:24] [data] Done reading 20,192 sentences
[2023-07-20 03:49:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 03:53:41] Seen 20,192 samples
[2023-07-20 03:53:41] Starting data epoch 126 in logical epoch 126
[2023-07-20 03:53:41] [data] Shuffling data
[2023-07-20 03:53:41] [data] Done reading 20,192 sentences
[2023-07-20 03:53:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 03:58:10] Seen 20,192 samples
[2023-07-20 03:58:10] Starting data epoch 127 in logical epoch 127
[2023-07-20 03:58:10] [data] Shuffling data
[2023-07-20 03:58:10] [data] Done reading 20,192 sentences
[2023-07-20 03:58:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 04:02:46] Seen 20,192 samples
[2023-07-20 04:02:46] Starting data epoch 128 in logical epoch 128
[2023-07-20 04:02:46] [data] Shuffling data
[2023-07-20 04:02:46] [data] Done reading 20,192 sentences
[2023-07-20 04:02:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 04:07:25] Seen 20,192 samples
[2023-07-20 04:07:25] Starting data epoch 129 in logical epoch 129
[2023-07-20 04:07:25] [data] Shuffling data
[2023-07-20 04:07:25] [data] Done reading 20,192 sentences
[2023-07-20 04:07:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 04:12:06] Seen 20,192 samples
[2023-07-20 04:12:06] Starting data epoch 130 in logical epoch 130
[2023-07-20 04:12:06] [data] Shuffling data
[2023-07-20 04:12:06] [data] Done reading 20,192 sentences
[2023-07-20 04:12:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 04:14:23] Ep. 130 : Up. 5000 : Sen. 10,731 : Cost 3.15450287 * 16,090,149 @ 19,836 after 80,359,679 : Time 2533.96s : 6349.81 words/s : gNorm 1.3477
[2023-07-20 04:16:34] Seen 20,192 samples
[2023-07-20 04:16:34] Starting data epoch 131 in logical epoch 131
[2023-07-20 04:16:34] Training finished
[2023-07-20 04:16:48] [valid] Ep. 131 : Up. 5019 : cross-entropy : 123.749 : new best
[2023-07-20 04:19:22] [valid] Ep. 131 : Up. 5019 : translation : 0 : new best
[2023-07-20 04:19:22] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 04:19:25] Saving Adam parameters
[2023-07-20 04:19:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 04:19:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 04:19:34] [marian] Running on node18.datos.cluster.uy as process 29632 with command line:
[2023-07-20 04:19:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 04:19:34] [config] after: 0e
[2023-07-20 04:19:34] [config] after-batches: 0
[2023-07-20 04:19:34] [config] after-epochs: 140
[2023-07-20 04:19:34] [config] all-caps-every: 0
[2023-07-20 04:19:34] [config] allow-unk: false
[2023-07-20 04:19:34] [config] authors: false
[2023-07-20 04:19:34] [config] beam-size: 12
[2023-07-20 04:19:34] [config] bert-class-symbol: "[CLS]"
[2023-07-20 04:19:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 04:19:34] [config] bert-masking-fraction: 0.15
[2023-07-20 04:19:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 04:19:34] [config] bert-train-type-embeddings: true
[2023-07-20 04:19:34] [config] bert-type-vocab-size: 2
[2023-07-20 04:19:34] [config] build-info: ""
[2023-07-20 04:19:34] [config] check-gradient-nan: false
[2023-07-20 04:19:34] [config] check-nan: false
[2023-07-20 04:19:34] [config] cite: false
[2023-07-20 04:19:34] [config] clip-norm: 1
[2023-07-20 04:19:34] [config] cost-scaling:
[2023-07-20 04:19:34] [config]   - 256.f
[2023-07-20 04:19:34] [config]   - 1000
[2023-07-20 04:19:34] [config]   - 2.f
[2023-07-20 04:19:34] [config]   - 256.f
[2023-07-20 04:19:34] [config] cost-type: ce-sum
[2023-07-20 04:19:34] [config] cpu-threads: 0
[2023-07-20 04:19:34] [config] data-threads: 8
[2023-07-20 04:19:34] [config] data-weighting: ""
[2023-07-20 04:19:34] [config] data-weighting-type: sentence
[2023-07-20 04:19:34] [config] dec-cell: gru
[2023-07-20 04:19:34] [config] dec-cell-base-depth: 2
[2023-07-20 04:19:34] [config] dec-cell-high-depth: 1
[2023-07-20 04:19:34] [config] dec-depth: 1
[2023-07-20 04:19:34] [config] devices:
[2023-07-20 04:19:34] [config]   - 0
[2023-07-20 04:19:34] [config] dim-emb: 512
[2023-07-20 04:19:34] [config] dim-rnn: 1024
[2023-07-20 04:19:34] [config] dim-vocabs:
[2023-07-20 04:19:34] [config]   - 16384
[2023-07-20 04:19:34] [config]   - 16384
[2023-07-20 04:19:34] [config] disp-first: 0
[2023-07-20 04:19:34] [config] disp-freq: 1000u
[2023-07-20 04:19:34] [config] disp-label-counts: true
[2023-07-20 04:19:34] [config] dropout-rnn: 0
[2023-07-20 04:19:34] [config] dropout-src: 0
[2023-07-20 04:19:34] [config] dropout-trg: 0
[2023-07-20 04:19:34] [config] dump-config: ""
[2023-07-20 04:19:34] [config] dynamic-gradient-scaling:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] early-stopping: 200
[2023-07-20 04:19:34] [config] early-stopping-on: first
[2023-07-20 04:19:34] [config] embedding-fix-src: false
[2023-07-20 04:19:34] [config] embedding-fix-trg: false
[2023-07-20 04:19:34] [config] embedding-normalization: false
[2023-07-20 04:19:34] [config] embedding-vectors:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] enc-cell: gru
[2023-07-20 04:19:34] [config] enc-cell-depth: 1
[2023-07-20 04:19:34] [config] enc-depth: 1
[2023-07-20 04:19:34] [config] enc-type: bidirectional
[2023-07-20 04:19:34] [config] english-title-case-every: 0
[2023-07-20 04:19:34] [config] exponential-smoothing: 0
[2023-07-20 04:19:34] [config] factor-weight: 1
[2023-07-20 04:19:34] [config] factors-combine: sum
[2023-07-20 04:19:34] [config] factors-dim-emb: 0
[2023-07-20 04:19:34] [config] gradient-checkpointing: false
[2023-07-20 04:19:34] [config] gradient-norm-average-window: 100
[2023-07-20 04:19:34] [config] guided-alignment: none
[2023-07-20 04:19:34] [config] guided-alignment-cost: mse
[2023-07-20 04:19:34] [config] guided-alignment-weight: 0.1
[2023-07-20 04:19:34] [config] ignore-model-config: false
[2023-07-20 04:19:34] [config] input-types:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] interpolate-env-vars: false
[2023-07-20 04:19:34] [config] keep-best: false
[2023-07-20 04:19:34] [config] label-smoothing: 0
[2023-07-20 04:19:34] [config] layer-normalization: false
[2023-07-20 04:19:34] [config] learn-rate: 0.0001
[2023-07-20 04:19:34] [config] lemma-dependency: ""
[2023-07-20 04:19:34] [config] lemma-dim-emb: 0
[2023-07-20 04:19:34] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 04:19:34] [config] log-level: info
[2023-07-20 04:19:34] [config] log-time-zone: ""
[2023-07-20 04:19:34] [config] logical-epoch:
[2023-07-20 04:19:34] [config]   - 1e
[2023-07-20 04:19:34] [config]   - 0
[2023-07-20 04:19:34] [config] lr-decay: 0
[2023-07-20 04:19:34] [config] lr-decay-freq: 50000
[2023-07-20 04:19:34] [config] lr-decay-inv-sqrt:
[2023-07-20 04:19:34] [config]   - 0
[2023-07-20 04:19:34] [config] lr-decay-repeat-warmup: false
[2023-07-20 04:19:34] [config] lr-decay-reset-optimizer: false
[2023-07-20 04:19:34] [config] lr-decay-start:
[2023-07-20 04:19:34] [config]   - 10
[2023-07-20 04:19:34] [config]   - 1
[2023-07-20 04:19:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 04:19:34] [config] lr-report: false
[2023-07-20 04:19:34] [config] lr-warmup: 0
[2023-07-20 04:19:34] [config] lr-warmup-at-reload: false
[2023-07-20 04:19:34] [config] lr-warmup-cycle: false
[2023-07-20 04:19:34] [config] lr-warmup-start-rate: 0
[2023-07-20 04:19:34] [config] max-length: 200
[2023-07-20 04:19:34] [config] max-length-crop: true
[2023-07-20 04:19:34] [config] max-length-factor: 3
[2023-07-20 04:19:34] [config] maxi-batch: 100
[2023-07-20 04:19:34] [config] maxi-batch-sort: trg
[2023-07-20 04:19:34] [config] mini-batch: 64
[2023-07-20 04:19:34] [config] mini-batch-fit: true
[2023-07-20 04:19:34] [config] mini-batch-fit-step: 10
[2023-07-20 04:19:34] [config] mini-batch-round-up: true
[2023-07-20 04:19:34] [config] mini-batch-track-lr: false
[2023-07-20 04:19:34] [config] mini-batch-warmup: 0
[2023-07-20 04:19:34] [config] mini-batch-words: 0
[2023-07-20 04:19:34] [config] mini-batch-words-ref: 0
[2023-07-20 04:19:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 04:19:34] [config] multi-loss-type: sum
[2023-07-20 04:19:34] [config] n-best: false
[2023-07-20 04:19:34] [config] no-nccl: false
[2023-07-20 04:19:34] [config] no-reload: false
[2023-07-20 04:19:34] [config] no-restore-corpus: false
[2023-07-20 04:19:34] [config] normalize: 0
[2023-07-20 04:19:34] [config] normalize-gradient: false
[2023-07-20 04:19:34] [config] num-devices: 0
[2023-07-20 04:19:34] [config] optimizer: adam
[2023-07-20 04:19:34] [config] optimizer-delay: 1
[2023-07-20 04:19:34] [config] optimizer-params:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] output-omit-bias: false
[2023-07-20 04:19:34] [config] overwrite: true
[2023-07-20 04:19:34] [config] precision:
[2023-07-20 04:19:34] [config]   - float16
[2023-07-20 04:19:34] [config]   - float32
[2023-07-20 04:19:34] [config] pretrained-model: ""
[2023-07-20 04:19:34] [config] quantize-biases: false
[2023-07-20 04:19:34] [config] quantize-bits: 0
[2023-07-20 04:19:34] [config] quantize-log-based: false
[2023-07-20 04:19:34] [config] quantize-optimization-steps: 0
[2023-07-20 04:19:34] [config] quiet: false
[2023-07-20 04:19:34] [config] quiet-translation: true
[2023-07-20 04:19:34] [config] relative-paths: false
[2023-07-20 04:19:34] [config] right-left: false
[2023-07-20 04:19:34] [config] save-freq: 10000u
[2023-07-20 04:19:34] [config] seed: 1234
[2023-07-20 04:19:34] [config] sentencepiece-alphas:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] sentencepiece-max-lines: 2000000
[2023-07-20 04:19:34] [config] sentencepiece-options: ""
[2023-07-20 04:19:34] [config] sharding: global
[2023-07-20 04:19:34] [config] shuffle: data
[2023-07-20 04:19:34] [config] shuffle-in-ram: false
[2023-07-20 04:19:34] [config] sigterm: save-and-exit
[2023-07-20 04:19:34] [config] skip: false
[2023-07-20 04:19:34] [config] sqlite: ""
[2023-07-20 04:19:34] [config] sqlite-drop: false
[2023-07-20 04:19:34] [config] sync-freq: 200u
[2023-07-20 04:19:34] [config] sync-sgd: false
[2023-07-20 04:19:34] [config] tempdir: /tmp
[2023-07-20 04:19:34] [config] tied-embeddings: false
[2023-07-20 04:19:34] [config] tied-embeddings-all: true
[2023-07-20 04:19:34] [config] tied-embeddings-src: false
[2023-07-20 04:19:34] [config] train-embedder-rank:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] train-sets:
[2023-07-20 04:19:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 04:19:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 04:19:34] [config] transformer-aan-activation: swish
[2023-07-20 04:19:34] [config] transformer-aan-depth: 2
[2023-07-20 04:19:34] [config] transformer-aan-nogate: false
[2023-07-20 04:19:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 04:19:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 04:19:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 04:19:34] [config] transformer-depth-scaling: false
[2023-07-20 04:19:34] [config] transformer-dim-aan: 2048
[2023-07-20 04:19:34] [config] transformer-dim-ffn: 2048
[2023-07-20 04:19:34] [config] transformer-dropout: 0
[2023-07-20 04:19:34] [config] transformer-dropout-attention: 0
[2023-07-20 04:19:34] [config] transformer-dropout-ffn: 0
[2023-07-20 04:19:34] [config] transformer-ffn-activation: swish
[2023-07-20 04:19:34] [config] transformer-ffn-depth: 2
[2023-07-20 04:19:34] [config] transformer-guided-alignment-layer: last
[2023-07-20 04:19:34] [config] transformer-heads: 8
[2023-07-20 04:19:34] [config] transformer-no-projection: false
[2023-07-20 04:19:34] [config] transformer-pool: false
[2023-07-20 04:19:34] [config] transformer-postprocess: dan
[2023-07-20 04:19:34] [config] transformer-postprocess-emb: d
[2023-07-20 04:19:34] [config] transformer-postprocess-top: ""
[2023-07-20 04:19:34] [config] transformer-preprocess: ""
[2023-07-20 04:19:34] [config] transformer-tied-layers:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] transformer-train-position-embeddings: false
[2023-07-20 04:19:34] [config] tsv: false
[2023-07-20 04:19:34] [config] tsv-fields: 0
[2023-07-20 04:19:34] [config] type: amun
[2023-07-20 04:19:34] [config] ulr: false
[2023-07-20 04:19:34] [config] ulr-dim-emb: 0
[2023-07-20 04:19:34] [config] ulr-dropout: 0
[2023-07-20 04:19:34] [config] ulr-keys-vectors: ""
[2023-07-20 04:19:34] [config] ulr-query-vectors: ""
[2023-07-20 04:19:34] [config] ulr-softmax-temperature: 1
[2023-07-20 04:19:34] [config] ulr-trainable-transformation: false
[2023-07-20 04:19:34] [config] unlikelihood-loss: false
[2023-07-20 04:19:34] [config] valid-freq: 50000000
[2023-07-20 04:19:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 04:19:34] [config] valid-max-length: 1000
[2023-07-20 04:19:34] [config] valid-metrics:
[2023-07-20 04:19:34] [config]   - cross-entropy
[2023-07-20 04:19:34] [config]   - translation
[2023-07-20 04:19:34] [config] valid-mini-batch: 32
[2023-07-20 04:19:34] [config] valid-reset-stalled: false
[2023-07-20 04:19:34] [config] valid-script-args:
[2023-07-20 04:19:34] [config]   []
[2023-07-20 04:19:34] [config] valid-script-path: ""
[2023-07-20 04:19:34] [config] valid-sets:
[2023-07-20 04:19:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 04:19:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 04:19:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 04:19:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 04:19:34] [config] vocabs:
[2023-07-20 04:19:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 04:19:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 04:19:34] [config] word-penalty: 0
[2023-07-20 04:19:34] [config] word-scores: false
[2023-07-20 04:19:34] [config] workspace: 5500
[2023-07-20 04:19:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 04:19:34] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 04:19:34] [training] Using single-device training
[2023-07-20 04:19:35] Synced seed 1234
[2023-07-20 04:19:35] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 04:19:35] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 04:19:35] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 04:19:35] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 04:19:35] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 04:19:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 04:19:35] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 04:19:36] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 04:19:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 04:19:36] [comm] Using global sharding
[2023-07-20 04:19:36] [comm] NCCLCommunicators constructed successfully
[2023-07-20 04:19:36] [training] Using 1 GPUs
[2023-07-20 04:19:36] [logits] Applying loss function for 1 factor(s)
[2023-07-20 04:19:36] [memory] Reserving 80 MB, device gpu0
[2023-07-20 04:19:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 04:19:36] [memory] Reserving 80 MB, device gpu0
[2023-07-20 04:59:54] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 04:59:54] [valid] No post-processing script given for validating translator
[2023-07-20 04:59:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 04:59:54] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 04:59:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 04:59:54] [comm] Using global sharding
[2023-07-20 04:59:54] [comm] NCCLCommunicators constructed successfully
[2023-07-20 04:59:54] [training] Using 1 GPUs
[2023-07-20 04:59:54] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 05:00:02] Allocating memory for general optimizer shards
[2023-07-20 05:00:02] [memory] Reserving 322 MB, device gpu0
[2023-07-20 05:00:02] Loading Adam parameters
[2023-07-20 05:00:02] [memory] Reserving 322 MB, device gpu0
[2023-07-20 05:00:02] [memory] Reserving 80 MB, device gpu0
[2023-07-20 05:00:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 05:00:03] [data] Restoring the corpus state to epoch 131, batch 5019
[2023-07-20 05:00:03] [data] Shuffling data
[2023-07-20 05:00:03] [data] Done reading 20,192 sentences
[2023-07-20 05:00:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:00:03] Training started
[2023-07-20 05:00:03] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 05:00:03] [memory] Reserving 80 MB, device gpu0
[2023-07-20 05:00:08] Parameter type float16, optimization type float32, casting types true
[2023-07-20 05:04:22] Seen 20,192 samples
[2023-07-20 05:04:22] Starting data epoch 132 in logical epoch 132
[2023-07-20 05:04:22] [data] Shuffling data
[2023-07-20 05:04:22] [data] Done reading 20,192 sentences
[2023-07-20 05:04:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:08:50] Seen 20,192 samples
[2023-07-20 05:08:50] Starting data epoch 133 in logical epoch 133
[2023-07-20 05:08:50] [data] Shuffling data
[2023-07-20 05:08:50] [data] Done reading 20,192 sentences
[2023-07-20 05:08:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:13:18] Seen 20,192 samples
[2023-07-20 05:13:18] Starting data epoch 134 in logical epoch 134
[2023-07-20 05:13:18] [data] Shuffling data
[2023-07-20 05:13:18] [data] Done reading 20,192 sentences
[2023-07-20 05:13:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:17:49] Seen 20,192 samples
[2023-07-20 05:17:49] Starting data epoch 135 in logical epoch 135
[2023-07-20 05:17:49] [data] Shuffling data
[2023-07-20 05:17:49] [data] Done reading 20,192 sentences
[2023-07-20 05:17:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:22:14] Seen 20,192 samples
[2023-07-20 05:22:14] Starting data epoch 136 in logical epoch 136
[2023-07-20 05:22:14] [data] Shuffling data
[2023-07-20 05:22:14] [data] Done reading 20,192 sentences
[2023-07-20 05:22:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:26:43] Seen 20,192 samples
[2023-07-20 05:26:43] Starting data epoch 137 in logical epoch 137
[2023-07-20 05:26:43] [data] Shuffling data
[2023-07-20 05:26:43] [data] Done reading 20,192 sentences
[2023-07-20 05:26:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:31:06] Seen 20,192 samples
[2023-07-20 05:31:06] Starting data epoch 138 in logical epoch 138
[2023-07-20 05:31:06] [data] Shuffling data
[2023-07-20 05:31:06] [data] Done reading 20,192 sentences
[2023-07-20 05:31:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:35:36] Seen 20,192 samples
[2023-07-20 05:35:36] Starting data epoch 139 in logical epoch 139
[2023-07-20 05:35:36] [data] Shuffling data
[2023-07-20 05:35:36] [data] Done reading 20,192 sentences
[2023-07-20 05:35:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:40:09] Seen 20,192 samples
[2023-07-20 05:40:09] Starting data epoch 140 in logical epoch 140
[2023-07-20 05:40:09] [data] Shuffling data
[2023-07-20 05:40:09] [data] Done reading 20,192 sentences
[2023-07-20 05:40:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 05:44:38] Seen 20,192 samples
[2023-07-20 05:44:38] Starting data epoch 141 in logical epoch 141
[2023-07-20 05:44:38] Training finished
[2023-07-20 05:44:53] [valid] Ep. 141 : Up. 5403 : cross-entropy : 122.646 : new best
[2023-07-20 05:47:10] [valid] Ep. 141 : Up. 5403 : translation : 0 : new best
[2023-07-20 05:47:10] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 05:47:13] Saving Adam parameters
[2023-07-20 05:47:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 05:47:22] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 05:47:22] [marian] Running on node18.datos.cluster.uy as process 35333 with command line:
[2023-07-20 05:47:22] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 05:47:22] [config] after: 0e
[2023-07-20 05:47:22] [config] after-batches: 0
[2023-07-20 05:47:22] [config] after-epochs: 150
[2023-07-20 05:47:22] [config] all-caps-every: 0
[2023-07-20 05:47:22] [config] allow-unk: false
[2023-07-20 05:47:22] [config] authors: false
[2023-07-20 05:47:22] [config] beam-size: 12
[2023-07-20 05:47:22] [config] bert-class-symbol: "[CLS]"
[2023-07-20 05:47:22] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 05:47:22] [config] bert-masking-fraction: 0.15
[2023-07-20 05:47:22] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 05:47:22] [config] bert-train-type-embeddings: true
[2023-07-20 05:47:22] [config] bert-type-vocab-size: 2
[2023-07-20 05:47:22] [config] build-info: ""
[2023-07-20 05:47:22] [config] check-gradient-nan: false
[2023-07-20 05:47:22] [config] check-nan: false
[2023-07-20 05:47:22] [config] cite: false
[2023-07-20 05:47:22] [config] clip-norm: 1
[2023-07-20 05:47:22] [config] cost-scaling:
[2023-07-20 05:47:22] [config]   - 256.f
[2023-07-20 05:47:22] [config]   - 1000
[2023-07-20 05:47:22] [config]   - 2.f
[2023-07-20 05:47:22] [config]   - 256.f
[2023-07-20 05:47:22] [config] cost-type: ce-sum
[2023-07-20 05:47:22] [config] cpu-threads: 0
[2023-07-20 05:47:22] [config] data-threads: 8
[2023-07-20 05:47:22] [config] data-weighting: ""
[2023-07-20 05:47:22] [config] data-weighting-type: sentence
[2023-07-20 05:47:22] [config] dec-cell: gru
[2023-07-20 05:47:22] [config] dec-cell-base-depth: 2
[2023-07-20 05:47:22] [config] dec-cell-high-depth: 1
[2023-07-20 05:47:22] [config] dec-depth: 1
[2023-07-20 05:47:22] [config] devices:
[2023-07-20 05:47:22] [config]   - 0
[2023-07-20 05:47:22] [config] dim-emb: 512
[2023-07-20 05:47:22] [config] dim-rnn: 1024
[2023-07-20 05:47:22] [config] dim-vocabs:
[2023-07-20 05:47:22] [config]   - 16384
[2023-07-20 05:47:22] [config]   - 16384
[2023-07-20 05:47:22] [config] disp-first: 0
[2023-07-20 05:47:22] [config] disp-freq: 1000u
[2023-07-20 05:47:22] [config] disp-label-counts: true
[2023-07-20 05:47:22] [config] dropout-rnn: 0
[2023-07-20 05:47:22] [config] dropout-src: 0
[2023-07-20 05:47:22] [config] dropout-trg: 0
[2023-07-20 05:47:22] [config] dump-config: ""
[2023-07-20 05:47:22] [config] dynamic-gradient-scaling:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] early-stopping: 200
[2023-07-20 05:47:22] [config] early-stopping-on: first
[2023-07-20 05:47:22] [config] embedding-fix-src: false
[2023-07-20 05:47:22] [config] embedding-fix-trg: false
[2023-07-20 05:47:22] [config] embedding-normalization: false
[2023-07-20 05:47:22] [config] embedding-vectors:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] enc-cell: gru
[2023-07-20 05:47:22] [config] enc-cell-depth: 1
[2023-07-20 05:47:22] [config] enc-depth: 1
[2023-07-20 05:47:22] [config] enc-type: bidirectional
[2023-07-20 05:47:22] [config] english-title-case-every: 0
[2023-07-20 05:47:22] [config] exponential-smoothing: 0
[2023-07-20 05:47:22] [config] factor-weight: 1
[2023-07-20 05:47:22] [config] factors-combine: sum
[2023-07-20 05:47:22] [config] factors-dim-emb: 0
[2023-07-20 05:47:22] [config] gradient-checkpointing: false
[2023-07-20 05:47:22] [config] gradient-norm-average-window: 100
[2023-07-20 05:47:22] [config] guided-alignment: none
[2023-07-20 05:47:22] [config] guided-alignment-cost: mse
[2023-07-20 05:47:22] [config] guided-alignment-weight: 0.1
[2023-07-20 05:47:22] [config] ignore-model-config: false
[2023-07-20 05:47:22] [config] input-types:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] interpolate-env-vars: false
[2023-07-20 05:47:22] [config] keep-best: false
[2023-07-20 05:47:22] [config] label-smoothing: 0
[2023-07-20 05:47:22] [config] layer-normalization: false
[2023-07-20 05:47:22] [config] learn-rate: 0.0001
[2023-07-20 05:47:22] [config] lemma-dependency: ""
[2023-07-20 05:47:22] [config] lemma-dim-emb: 0
[2023-07-20 05:47:22] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 05:47:22] [config] log-level: info
[2023-07-20 05:47:22] [config] log-time-zone: ""
[2023-07-20 05:47:22] [config] logical-epoch:
[2023-07-20 05:47:22] [config]   - 1e
[2023-07-20 05:47:22] [config]   - 0
[2023-07-20 05:47:22] [config] lr-decay: 0
[2023-07-20 05:47:22] [config] lr-decay-freq: 50000
[2023-07-20 05:47:22] [config] lr-decay-inv-sqrt:
[2023-07-20 05:47:22] [config]   - 0
[2023-07-20 05:47:22] [config] lr-decay-repeat-warmup: false
[2023-07-20 05:47:22] [config] lr-decay-reset-optimizer: false
[2023-07-20 05:47:22] [config] lr-decay-start:
[2023-07-20 05:47:22] [config]   - 10
[2023-07-20 05:47:22] [config]   - 1
[2023-07-20 05:47:22] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 05:47:22] [config] lr-report: false
[2023-07-20 05:47:22] [config] lr-warmup: 0
[2023-07-20 05:47:22] [config] lr-warmup-at-reload: false
[2023-07-20 05:47:22] [config] lr-warmup-cycle: false
[2023-07-20 05:47:22] [config] lr-warmup-start-rate: 0
[2023-07-20 05:47:22] [config] max-length: 200
[2023-07-20 05:47:22] [config] max-length-crop: true
[2023-07-20 05:47:22] [config] max-length-factor: 3
[2023-07-20 05:47:22] [config] maxi-batch: 100
[2023-07-20 05:47:22] [config] maxi-batch-sort: trg
[2023-07-20 05:47:22] [config] mini-batch: 64
[2023-07-20 05:47:22] [config] mini-batch-fit: true
[2023-07-20 05:47:22] [config] mini-batch-fit-step: 10
[2023-07-20 05:47:22] [config] mini-batch-round-up: true
[2023-07-20 05:47:22] [config] mini-batch-track-lr: false
[2023-07-20 05:47:22] [config] mini-batch-warmup: 0
[2023-07-20 05:47:22] [config] mini-batch-words: 0
[2023-07-20 05:47:22] [config] mini-batch-words-ref: 0
[2023-07-20 05:47:22] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 05:47:22] [config] multi-loss-type: sum
[2023-07-20 05:47:22] [config] n-best: false
[2023-07-20 05:47:22] [config] no-nccl: false
[2023-07-20 05:47:22] [config] no-reload: false
[2023-07-20 05:47:22] [config] no-restore-corpus: false
[2023-07-20 05:47:22] [config] normalize: 0
[2023-07-20 05:47:22] [config] normalize-gradient: false
[2023-07-20 05:47:22] [config] num-devices: 0
[2023-07-20 05:47:22] [config] optimizer: adam
[2023-07-20 05:47:22] [config] optimizer-delay: 1
[2023-07-20 05:47:22] [config] optimizer-params:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] output-omit-bias: false
[2023-07-20 05:47:22] [config] overwrite: true
[2023-07-20 05:47:22] [config] precision:
[2023-07-20 05:47:22] [config]   - float16
[2023-07-20 05:47:22] [config]   - float32
[2023-07-20 05:47:22] [config] pretrained-model: ""
[2023-07-20 05:47:22] [config] quantize-biases: false
[2023-07-20 05:47:22] [config] quantize-bits: 0
[2023-07-20 05:47:22] [config] quantize-log-based: false
[2023-07-20 05:47:22] [config] quantize-optimization-steps: 0
[2023-07-20 05:47:22] [config] quiet: false
[2023-07-20 05:47:22] [config] quiet-translation: true
[2023-07-20 05:47:22] [config] relative-paths: false
[2023-07-20 05:47:22] [config] right-left: false
[2023-07-20 05:47:22] [config] save-freq: 10000u
[2023-07-20 05:47:22] [config] seed: 1234
[2023-07-20 05:47:22] [config] sentencepiece-alphas:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] sentencepiece-max-lines: 2000000
[2023-07-20 05:47:22] [config] sentencepiece-options: ""
[2023-07-20 05:47:22] [config] sharding: global
[2023-07-20 05:47:22] [config] shuffle: data
[2023-07-20 05:47:22] [config] shuffle-in-ram: false
[2023-07-20 05:47:22] [config] sigterm: save-and-exit
[2023-07-20 05:47:22] [config] skip: false
[2023-07-20 05:47:22] [config] sqlite: ""
[2023-07-20 05:47:22] [config] sqlite-drop: false
[2023-07-20 05:47:22] [config] sync-freq: 200u
[2023-07-20 05:47:22] [config] sync-sgd: false
[2023-07-20 05:47:22] [config] tempdir: /tmp
[2023-07-20 05:47:22] [config] tied-embeddings: false
[2023-07-20 05:47:22] [config] tied-embeddings-all: true
[2023-07-20 05:47:22] [config] tied-embeddings-src: false
[2023-07-20 05:47:22] [config] train-embedder-rank:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] train-sets:
[2023-07-20 05:47:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 05:47:22] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 05:47:22] [config] transformer-aan-activation: swish
[2023-07-20 05:47:22] [config] transformer-aan-depth: 2
[2023-07-20 05:47:22] [config] transformer-aan-nogate: false
[2023-07-20 05:47:22] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 05:47:22] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 05:47:22] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 05:47:22] [config] transformer-depth-scaling: false
[2023-07-20 05:47:22] [config] transformer-dim-aan: 2048
[2023-07-20 05:47:22] [config] transformer-dim-ffn: 2048
[2023-07-20 05:47:22] [config] transformer-dropout: 0
[2023-07-20 05:47:22] [config] transformer-dropout-attention: 0
[2023-07-20 05:47:22] [config] transformer-dropout-ffn: 0
[2023-07-20 05:47:22] [config] transformer-ffn-activation: swish
[2023-07-20 05:47:22] [config] transformer-ffn-depth: 2
[2023-07-20 05:47:22] [config] transformer-guided-alignment-layer: last
[2023-07-20 05:47:22] [config] transformer-heads: 8
[2023-07-20 05:47:22] [config] transformer-no-projection: false
[2023-07-20 05:47:22] [config] transformer-pool: false
[2023-07-20 05:47:22] [config] transformer-postprocess: dan
[2023-07-20 05:47:22] [config] transformer-postprocess-emb: d
[2023-07-20 05:47:22] [config] transformer-postprocess-top: ""
[2023-07-20 05:47:22] [config] transformer-preprocess: ""
[2023-07-20 05:47:22] [config] transformer-tied-layers:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] transformer-train-position-embeddings: false
[2023-07-20 05:47:22] [config] tsv: false
[2023-07-20 05:47:22] [config] tsv-fields: 0
[2023-07-20 05:47:22] [config] type: amun
[2023-07-20 05:47:22] [config] ulr: false
[2023-07-20 05:47:22] [config] ulr-dim-emb: 0
[2023-07-20 05:47:22] [config] ulr-dropout: 0
[2023-07-20 05:47:22] [config] ulr-keys-vectors: ""
[2023-07-20 05:47:22] [config] ulr-query-vectors: ""
[2023-07-20 05:47:22] [config] ulr-softmax-temperature: 1
[2023-07-20 05:47:22] [config] ulr-trainable-transformation: false
[2023-07-20 05:47:22] [config] unlikelihood-loss: false
[2023-07-20 05:47:22] [config] valid-freq: 50000000
[2023-07-20 05:47:22] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 05:47:22] [config] valid-max-length: 1000
[2023-07-20 05:47:22] [config] valid-metrics:
[2023-07-20 05:47:22] [config]   - cross-entropy
[2023-07-20 05:47:22] [config]   - translation
[2023-07-20 05:47:22] [config] valid-mini-batch: 32
[2023-07-20 05:47:22] [config] valid-reset-stalled: false
[2023-07-20 05:47:22] [config] valid-script-args:
[2023-07-20 05:47:22] [config]   []
[2023-07-20 05:47:22] [config] valid-script-path: ""
[2023-07-20 05:47:22] [config] valid-sets:
[2023-07-20 05:47:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 05:47:22] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 05:47:22] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 05:47:22] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 05:47:22] [config] vocabs:
[2023-07-20 05:47:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 05:47:22] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 05:47:22] [config] word-penalty: 0
[2023-07-20 05:47:22] [config] word-scores: false
[2023-07-20 05:47:22] [config] workspace: 5500
[2023-07-20 05:47:22] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 05:47:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 05:47:22] [training] Using single-device training
[2023-07-20 05:47:22] Synced seed 1234
[2023-07-20 05:47:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 05:47:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 05:47:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 05:47:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 05:47:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 05:47:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 05:47:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 05:47:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 05:47:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 05:47:24] [comm] Using global sharding
[2023-07-20 05:47:24] [comm] NCCLCommunicators constructed successfully
[2023-07-20 05:47:24] [training] Using 1 GPUs
[2023-07-20 05:47:24] [logits] Applying loss function for 1 factor(s)
[2023-07-20 05:47:24] [memory] Reserving 80 MB, device gpu0
[2023-07-20 05:47:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 05:47:24] [memory] Reserving 80 MB, device gpu0
[2023-07-20 06:27:32] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 06:27:32] [valid] No post-processing script given for validating translator
[2023-07-20 06:27:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 06:27:32] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 06:27:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 06:27:33] [comm] Using global sharding
[2023-07-20 06:27:33] [comm] NCCLCommunicators constructed successfully
[2023-07-20 06:27:33] [training] Using 1 GPUs
[2023-07-20 06:27:33] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 06:27:40] Allocating memory for general optimizer shards
[2023-07-20 06:27:40] [memory] Reserving 322 MB, device gpu0
[2023-07-20 06:27:40] Loading Adam parameters
[2023-07-20 06:27:40] [memory] Reserving 322 MB, device gpu0
[2023-07-20 06:27:40] [memory] Reserving 80 MB, device gpu0
[2023-07-20 06:27:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 06:27:41] [data] Restoring the corpus state to epoch 141, batch 5403
[2023-07-20 06:27:41] [data] Shuffling data
[2023-07-20 06:27:41] [data] Done reading 20,192 sentences
[2023-07-20 06:27:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:27:41] Training started
[2023-07-20 06:27:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 06:27:42] [memory] Reserving 80 MB, device gpu0
[2023-07-20 06:27:53] Parameter type float16, optimization type float32, casting types true
[2023-07-20 06:31:54] Seen 20,192 samples
[2023-07-20 06:31:54] Starting data epoch 142 in logical epoch 142
[2023-07-20 06:31:54] [data] Shuffling data
[2023-07-20 06:31:54] [data] Done reading 20,192 sentences
[2023-07-20 06:31:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:36:19] Seen 20,192 samples
[2023-07-20 06:36:19] Starting data epoch 143 in logical epoch 143
[2023-07-20 06:36:19] [data] Shuffling data
[2023-07-20 06:36:19] [data] Done reading 20,192 sentences
[2023-07-20 06:36:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:40:46] Seen 20,192 samples
[2023-07-20 06:40:46] Starting data epoch 144 in logical epoch 144
[2023-07-20 06:40:46] [data] Shuffling data
[2023-07-20 06:40:46] [data] Done reading 20,192 sentences
[2023-07-20 06:40:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:45:12] Seen 20,192 samples
[2023-07-20 06:45:12] Starting data epoch 145 in logical epoch 145
[2023-07-20 06:45:12] [data] Shuffling data
[2023-07-20 06:45:12] [data] Done reading 20,192 sentences
[2023-07-20 06:45:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:49:47] Seen 20,192 samples
[2023-07-20 06:49:47] Starting data epoch 146 in logical epoch 146
[2023-07-20 06:49:47] [data] Shuffling data
[2023-07-20 06:49:47] [data] Done reading 20,192 sentences
[2023-07-20 06:49:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:54:08] Seen 20,192 samples
[2023-07-20 06:54:08] Starting data epoch 147 in logical epoch 147
[2023-07-20 06:54:08] [data] Shuffling data
[2023-07-20 06:54:08] [data] Done reading 20,192 sentences
[2023-07-20 06:54:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 06:58:38] Seen 20,192 samples
[2023-07-20 06:58:38] Starting data epoch 148 in logical epoch 148
[2023-07-20 06:58:38] [data] Shuffling data
[2023-07-20 06:58:38] [data] Done reading 20,192 sentences
[2023-07-20 06:58:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 07:03:05] Seen 20,192 samples
[2023-07-20 07:03:05] Starting data epoch 149 in logical epoch 149
[2023-07-20 07:03:05] [data] Shuffling data
[2023-07-20 07:03:05] [data] Done reading 20,192 sentences
[2023-07-20 07:03:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 07:07:29] Seen 20,192 samples
[2023-07-20 07:07:29] Starting data epoch 150 in logical epoch 150
[2023-07-20 07:07:29] [data] Shuffling data
[2023-07-20 07:07:29] [data] Done reading 20,192 sentences
[2023-07-20 07:07:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 07:11:55] Seen 20,192 samples
[2023-07-20 07:11:55] Starting data epoch 151 in logical epoch 151
[2023-07-20 07:11:55] Training finished
[2023-07-20 07:12:08] [valid] Ep. 151 : Up. 5789 : cross-entropy : 122.648 : stalled 1 times (last best: 122.646)
[2023-07-20 07:14:10] [valid] Ep. 151 : Up. 5789 : translation : 0 : new best
[2023-07-20 07:14:10] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 07:14:12] Saving Adam parameters
[2023-07-20 07:14:12] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 07:14:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 07:14:21] [marian] Running on node18.datos.cluster.uy as process 324 with command line:
[2023-07-20 07:14:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 07:14:21] [config] after: 0e
[2023-07-20 07:14:21] [config] after-batches: 0
[2023-07-20 07:14:21] [config] after-epochs: 160
[2023-07-20 07:14:21] [config] all-caps-every: 0
[2023-07-20 07:14:21] [config] allow-unk: false
[2023-07-20 07:14:21] [config] authors: false
[2023-07-20 07:14:21] [config] beam-size: 12
[2023-07-20 07:14:21] [config] bert-class-symbol: "[CLS]"
[2023-07-20 07:14:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 07:14:21] [config] bert-masking-fraction: 0.15
[2023-07-20 07:14:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 07:14:21] [config] bert-train-type-embeddings: true
[2023-07-20 07:14:21] [config] bert-type-vocab-size: 2
[2023-07-20 07:14:21] [config] build-info: ""
[2023-07-20 07:14:21] [config] check-gradient-nan: false
[2023-07-20 07:14:21] [config] check-nan: false
[2023-07-20 07:14:21] [config] cite: false
[2023-07-20 07:14:21] [config] clip-norm: 1
[2023-07-20 07:14:21] [config] cost-scaling:
[2023-07-20 07:14:21] [config]   - 256.f
[2023-07-20 07:14:21] [config]   - 1000
[2023-07-20 07:14:21] [config]   - 2.f
[2023-07-20 07:14:21] [config]   - 256.f
[2023-07-20 07:14:21] [config] cost-type: ce-sum
[2023-07-20 07:14:21] [config] cpu-threads: 0
[2023-07-20 07:14:21] [config] data-threads: 8
[2023-07-20 07:14:21] [config] data-weighting: ""
[2023-07-20 07:14:21] [config] data-weighting-type: sentence
[2023-07-20 07:14:21] [config] dec-cell: gru
[2023-07-20 07:14:21] [config] dec-cell-base-depth: 2
[2023-07-20 07:14:21] [config] dec-cell-high-depth: 1
[2023-07-20 07:14:21] [config] dec-depth: 1
[2023-07-20 07:14:21] [config] devices:
[2023-07-20 07:14:21] [config]   - 0
[2023-07-20 07:14:21] [config] dim-emb: 512
[2023-07-20 07:14:21] [config] dim-rnn: 1024
[2023-07-20 07:14:21] [config] dim-vocabs:
[2023-07-20 07:14:21] [config]   - 16384
[2023-07-20 07:14:21] [config]   - 16384
[2023-07-20 07:14:21] [config] disp-first: 0
[2023-07-20 07:14:21] [config] disp-freq: 1000u
[2023-07-20 07:14:21] [config] disp-label-counts: true
[2023-07-20 07:14:21] [config] dropout-rnn: 0
[2023-07-20 07:14:21] [config] dropout-src: 0
[2023-07-20 07:14:21] [config] dropout-trg: 0
[2023-07-20 07:14:21] [config] dump-config: ""
[2023-07-20 07:14:21] [config] dynamic-gradient-scaling:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] early-stopping: 200
[2023-07-20 07:14:21] [config] early-stopping-on: first
[2023-07-20 07:14:21] [config] embedding-fix-src: false
[2023-07-20 07:14:21] [config] embedding-fix-trg: false
[2023-07-20 07:14:21] [config] embedding-normalization: false
[2023-07-20 07:14:21] [config] embedding-vectors:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] enc-cell: gru
[2023-07-20 07:14:21] [config] enc-cell-depth: 1
[2023-07-20 07:14:21] [config] enc-depth: 1
[2023-07-20 07:14:21] [config] enc-type: bidirectional
[2023-07-20 07:14:21] [config] english-title-case-every: 0
[2023-07-20 07:14:21] [config] exponential-smoothing: 0
[2023-07-20 07:14:21] [config] factor-weight: 1
[2023-07-20 07:14:21] [config] factors-combine: sum
[2023-07-20 07:14:21] [config] factors-dim-emb: 0
[2023-07-20 07:14:21] [config] gradient-checkpointing: false
[2023-07-20 07:14:21] [config] gradient-norm-average-window: 100
[2023-07-20 07:14:21] [config] guided-alignment: none
[2023-07-20 07:14:21] [config] guided-alignment-cost: mse
[2023-07-20 07:14:21] [config] guided-alignment-weight: 0.1
[2023-07-20 07:14:21] [config] ignore-model-config: false
[2023-07-20 07:14:21] [config] input-types:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] interpolate-env-vars: false
[2023-07-20 07:14:21] [config] keep-best: false
[2023-07-20 07:14:21] [config] label-smoothing: 0
[2023-07-20 07:14:21] [config] layer-normalization: false
[2023-07-20 07:14:21] [config] learn-rate: 0.0001
[2023-07-20 07:14:21] [config] lemma-dependency: ""
[2023-07-20 07:14:21] [config] lemma-dim-emb: 0
[2023-07-20 07:14:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 07:14:21] [config] log-level: info
[2023-07-20 07:14:21] [config] log-time-zone: ""
[2023-07-20 07:14:21] [config] logical-epoch:
[2023-07-20 07:14:21] [config]   - 1e
[2023-07-20 07:14:21] [config]   - 0
[2023-07-20 07:14:21] [config] lr-decay: 0
[2023-07-20 07:14:21] [config] lr-decay-freq: 50000
[2023-07-20 07:14:21] [config] lr-decay-inv-sqrt:
[2023-07-20 07:14:21] [config]   - 0
[2023-07-20 07:14:21] [config] lr-decay-repeat-warmup: false
[2023-07-20 07:14:21] [config] lr-decay-reset-optimizer: false
[2023-07-20 07:14:21] [config] lr-decay-start:
[2023-07-20 07:14:21] [config]   - 10
[2023-07-20 07:14:21] [config]   - 1
[2023-07-20 07:14:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 07:14:21] [config] lr-report: false
[2023-07-20 07:14:21] [config] lr-warmup: 0
[2023-07-20 07:14:21] [config] lr-warmup-at-reload: false
[2023-07-20 07:14:21] [config] lr-warmup-cycle: false
[2023-07-20 07:14:21] [config] lr-warmup-start-rate: 0
[2023-07-20 07:14:21] [config] max-length: 200
[2023-07-20 07:14:21] [config] max-length-crop: true
[2023-07-20 07:14:21] [config] max-length-factor: 3
[2023-07-20 07:14:21] [config] maxi-batch: 100
[2023-07-20 07:14:21] [config] maxi-batch-sort: trg
[2023-07-20 07:14:21] [config] mini-batch: 64
[2023-07-20 07:14:21] [config] mini-batch-fit: true
[2023-07-20 07:14:21] [config] mini-batch-fit-step: 10
[2023-07-20 07:14:21] [config] mini-batch-round-up: true
[2023-07-20 07:14:21] [config] mini-batch-track-lr: false
[2023-07-20 07:14:21] [config] mini-batch-warmup: 0
[2023-07-20 07:14:21] [config] mini-batch-words: 0
[2023-07-20 07:14:21] [config] mini-batch-words-ref: 0
[2023-07-20 07:14:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 07:14:21] [config] multi-loss-type: sum
[2023-07-20 07:14:21] [config] n-best: false
[2023-07-20 07:14:21] [config] no-nccl: false
[2023-07-20 07:14:21] [config] no-reload: false
[2023-07-20 07:14:21] [config] no-restore-corpus: false
[2023-07-20 07:14:21] [config] normalize: 0
[2023-07-20 07:14:21] [config] normalize-gradient: false
[2023-07-20 07:14:21] [config] num-devices: 0
[2023-07-20 07:14:21] [config] optimizer: adam
[2023-07-20 07:14:21] [config] optimizer-delay: 1
[2023-07-20 07:14:21] [config] optimizer-params:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] output-omit-bias: false
[2023-07-20 07:14:21] [config] overwrite: true
[2023-07-20 07:14:21] [config] precision:
[2023-07-20 07:14:21] [config]   - float16
[2023-07-20 07:14:21] [config]   - float32
[2023-07-20 07:14:21] [config] pretrained-model: ""
[2023-07-20 07:14:21] [config] quantize-biases: false
[2023-07-20 07:14:21] [config] quantize-bits: 0
[2023-07-20 07:14:21] [config] quantize-log-based: false
[2023-07-20 07:14:21] [config] quantize-optimization-steps: 0
[2023-07-20 07:14:21] [config] quiet: false
[2023-07-20 07:14:21] [config] quiet-translation: true
[2023-07-20 07:14:21] [config] relative-paths: false
[2023-07-20 07:14:21] [config] right-left: false
[2023-07-20 07:14:21] [config] save-freq: 10000u
[2023-07-20 07:14:21] [config] seed: 1234
[2023-07-20 07:14:21] [config] sentencepiece-alphas:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] sentencepiece-max-lines: 2000000
[2023-07-20 07:14:21] [config] sentencepiece-options: ""
[2023-07-20 07:14:21] [config] sharding: global
[2023-07-20 07:14:21] [config] shuffle: data
[2023-07-20 07:14:21] [config] shuffle-in-ram: false
[2023-07-20 07:14:21] [config] sigterm: save-and-exit
[2023-07-20 07:14:21] [config] skip: false
[2023-07-20 07:14:21] [config] sqlite: ""
[2023-07-20 07:14:21] [config] sqlite-drop: false
[2023-07-20 07:14:21] [config] sync-freq: 200u
[2023-07-20 07:14:21] [config] sync-sgd: false
[2023-07-20 07:14:21] [config] tempdir: /tmp
[2023-07-20 07:14:21] [config] tied-embeddings: false
[2023-07-20 07:14:21] [config] tied-embeddings-all: true
[2023-07-20 07:14:21] [config] tied-embeddings-src: false
[2023-07-20 07:14:21] [config] train-embedder-rank:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] train-sets:
[2023-07-20 07:14:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 07:14:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 07:14:21] [config] transformer-aan-activation: swish
[2023-07-20 07:14:21] [config] transformer-aan-depth: 2
[2023-07-20 07:14:21] [config] transformer-aan-nogate: false
[2023-07-20 07:14:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 07:14:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 07:14:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 07:14:21] [config] transformer-depth-scaling: false
[2023-07-20 07:14:21] [config] transformer-dim-aan: 2048
[2023-07-20 07:14:21] [config] transformer-dim-ffn: 2048
[2023-07-20 07:14:21] [config] transformer-dropout: 0
[2023-07-20 07:14:21] [config] transformer-dropout-attention: 0
[2023-07-20 07:14:21] [config] transformer-dropout-ffn: 0
[2023-07-20 07:14:21] [config] transformer-ffn-activation: swish
[2023-07-20 07:14:21] [config] transformer-ffn-depth: 2
[2023-07-20 07:14:21] [config] transformer-guided-alignment-layer: last
[2023-07-20 07:14:21] [config] transformer-heads: 8
[2023-07-20 07:14:21] [config] transformer-no-projection: false
[2023-07-20 07:14:21] [config] transformer-pool: false
[2023-07-20 07:14:21] [config] transformer-postprocess: dan
[2023-07-20 07:14:21] [config] transformer-postprocess-emb: d
[2023-07-20 07:14:21] [config] transformer-postprocess-top: ""
[2023-07-20 07:14:21] [config] transformer-preprocess: ""
[2023-07-20 07:14:21] [config] transformer-tied-layers:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] transformer-train-position-embeddings: false
[2023-07-20 07:14:21] [config] tsv: false
[2023-07-20 07:14:21] [config] tsv-fields: 0
[2023-07-20 07:14:21] [config] type: amun
[2023-07-20 07:14:21] [config] ulr: false
[2023-07-20 07:14:21] [config] ulr-dim-emb: 0
[2023-07-20 07:14:21] [config] ulr-dropout: 0
[2023-07-20 07:14:21] [config] ulr-keys-vectors: ""
[2023-07-20 07:14:21] [config] ulr-query-vectors: ""
[2023-07-20 07:14:21] [config] ulr-softmax-temperature: 1
[2023-07-20 07:14:21] [config] ulr-trainable-transformation: false
[2023-07-20 07:14:21] [config] unlikelihood-loss: false
[2023-07-20 07:14:21] [config] valid-freq: 50000000
[2023-07-20 07:14:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 07:14:21] [config] valid-max-length: 1000
[2023-07-20 07:14:21] [config] valid-metrics:
[2023-07-20 07:14:21] [config]   - cross-entropy
[2023-07-20 07:14:21] [config]   - translation
[2023-07-20 07:14:21] [config] valid-mini-batch: 32
[2023-07-20 07:14:21] [config] valid-reset-stalled: false
[2023-07-20 07:14:21] [config] valid-script-args:
[2023-07-20 07:14:21] [config]   []
[2023-07-20 07:14:21] [config] valid-script-path: ""
[2023-07-20 07:14:21] [config] valid-sets:
[2023-07-20 07:14:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 07:14:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 07:14:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 07:14:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 07:14:21] [config] vocabs:
[2023-07-20 07:14:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 07:14:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 07:14:21] [config] word-penalty: 0
[2023-07-20 07:14:21] [config] word-scores: false
[2023-07-20 07:14:21] [config] workspace: 5500
[2023-07-20 07:14:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 07:14:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 07:14:21] [training] Using single-device training
[2023-07-20 07:14:21] Synced seed 1234
[2023-07-20 07:14:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 07:14:21] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 07:14:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 07:14:21] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 07:14:21] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 07:14:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 07:14:21] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 07:14:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 07:14:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 07:14:23] [comm] Using global sharding
[2023-07-20 07:14:23] [comm] NCCLCommunicators constructed successfully
[2023-07-20 07:14:23] [training] Using 1 GPUs
[2023-07-20 07:14:23] [logits] Applying loss function for 1 factor(s)
[2023-07-20 07:14:23] [memory] Reserving 80 MB, device gpu0
[2023-07-20 07:14:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 07:14:23] [memory] Reserving 80 MB, device gpu0
[2023-07-20 07:53:42] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 07:53:43] [valid] No post-processing script given for validating translator
[2023-07-20 07:53:43] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 07:53:43] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 07:53:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 07:53:43] [comm] Using global sharding
[2023-07-20 07:53:43] [comm] NCCLCommunicators constructed successfully
[2023-07-20 07:53:43] [training] Using 1 GPUs
[2023-07-20 07:53:43] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 07:53:50] Allocating memory for general optimizer shards
[2023-07-20 07:53:50] [memory] Reserving 322 MB, device gpu0
[2023-07-20 07:53:50] Loading Adam parameters
[2023-07-20 07:53:51] [memory] Reserving 322 MB, device gpu0
[2023-07-20 07:53:51] [memory] Reserving 80 MB, device gpu0
[2023-07-20 07:53:51] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 07:53:51] [data] Restoring the corpus state to epoch 151, batch 5789
[2023-07-20 07:53:51] [data] Shuffling data
[2023-07-20 07:53:51] [data] Done reading 20,192 sentences
[2023-07-20 07:53:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 07:53:51] Training started
[2023-07-20 07:53:51] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 07:53:51] [memory] Reserving 80 MB, device gpu0
[2023-07-20 07:53:53] Parameter type float16, optimization type float32, casting types true
[2023-07-20 07:58:06] Seen 20,192 samples
[2023-07-20 07:58:06] Starting data epoch 152 in logical epoch 152
[2023-07-20 07:58:06] [data] Shuffling data
[2023-07-20 07:58:06] [data] Done reading 20,192 sentences
[2023-07-20 07:58:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:02:35] Seen 20,192 samples
[2023-07-20 08:02:35] Starting data epoch 153 in logical epoch 153
[2023-07-20 08:02:35] [data] Shuffling data
[2023-07-20 08:02:35] [data] Done reading 20,192 sentences
[2023-07-20 08:02:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:07:03] Seen 20,192 samples
[2023-07-20 08:07:03] Starting data epoch 154 in logical epoch 154
[2023-07-20 08:07:03] [data] Shuffling data
[2023-07-20 08:07:03] [data] Done reading 20,192 sentences
[2023-07-20 08:07:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:11:39] Seen 20,192 samples
[2023-07-20 08:11:39] Starting data epoch 155 in logical epoch 155
[2023-07-20 08:11:39] [data] Shuffling data
[2023-07-20 08:11:39] [data] Done reading 20,192 sentences
[2023-07-20 08:11:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:16:09] Seen 20,192 samples
[2023-07-20 08:16:09] Starting data epoch 156 in logical epoch 156
[2023-07-20 08:16:09] [data] Shuffling data
[2023-07-20 08:16:09] [data] Done reading 20,192 sentences
[2023-07-20 08:16:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:18:19] Ep. 156 : Up. 6000 : Sen. 9,072 : Cost 2.64927649 * 16,095,742 @ 22,622 after 96,455,422 : Time 1476.13s : 10904.02 words/s : gNorm 1.5420
[2023-07-20 08:20:34] Seen 20,192 samples
[2023-07-20 08:20:34] Starting data epoch 157 in logical epoch 157
[2023-07-20 08:20:34] [data] Shuffling data
[2023-07-20 08:20:35] [data] Done reading 20,192 sentences
[2023-07-20 08:20:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:24:59] Seen 20,192 samples
[2023-07-20 08:24:59] Starting data epoch 158 in logical epoch 158
[2023-07-20 08:24:59] [data] Shuffling data
[2023-07-20 08:24:59] [data] Done reading 20,192 sentences
[2023-07-20 08:24:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:29:27] Seen 20,192 samples
[2023-07-20 08:29:27] Starting data epoch 159 in logical epoch 159
[2023-07-20 08:29:27] [data] Shuffling data
[2023-07-20 08:29:27] [data] Done reading 20,192 sentences
[2023-07-20 08:29:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:33:47] Seen 20,192 samples
[2023-07-20 08:33:47] Starting data epoch 160 in logical epoch 160
[2023-07-20 08:33:47] [data] Shuffling data
[2023-07-20 08:33:47] [data] Done reading 20,192 sentences
[2023-07-20 08:33:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 08:38:11] Seen 20,192 samples
[2023-07-20 08:38:11] Starting data epoch 161 in logical epoch 161
[2023-07-20 08:38:11] Training finished
[2023-07-20 08:38:27] [valid] Ep. 161 : Up. 6173 : cross-entropy : 123.152 : stalled 2 times (last best: 122.646)
[2023-07-20 08:40:16] [valid] Ep. 161 : Up. 6173 : translation : 0 : new best
[2023-07-20 08:40:16] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 08:40:18] Saving Adam parameters
[2023-07-20 08:40:19] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 08:40:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 08:40:27] [marian] Running on node18.datos.cluster.uy as process 6093 with command line:
[2023-07-20 08:40:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 08:40:27] [config] after: 0e
[2023-07-20 08:40:27] [config] after-batches: 0
[2023-07-20 08:40:27] [config] after-epochs: 170
[2023-07-20 08:40:27] [config] all-caps-every: 0
[2023-07-20 08:40:27] [config] allow-unk: false
[2023-07-20 08:40:27] [config] authors: false
[2023-07-20 08:40:27] [config] beam-size: 12
[2023-07-20 08:40:27] [config] bert-class-symbol: "[CLS]"
[2023-07-20 08:40:27] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 08:40:27] [config] bert-masking-fraction: 0.15
[2023-07-20 08:40:27] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 08:40:27] [config] bert-train-type-embeddings: true
[2023-07-20 08:40:27] [config] bert-type-vocab-size: 2
[2023-07-20 08:40:27] [config] build-info: ""
[2023-07-20 08:40:27] [config] check-gradient-nan: false
[2023-07-20 08:40:27] [config] check-nan: false
[2023-07-20 08:40:27] [config] cite: false
[2023-07-20 08:40:27] [config] clip-norm: 1
[2023-07-20 08:40:27] [config] cost-scaling:
[2023-07-20 08:40:27] [config]   - 256.f
[2023-07-20 08:40:27] [config]   - 1000
[2023-07-20 08:40:27] [config]   - 2.f
[2023-07-20 08:40:27] [config]   - 256.f
[2023-07-20 08:40:27] [config] cost-type: ce-sum
[2023-07-20 08:40:27] [config] cpu-threads: 0
[2023-07-20 08:40:27] [config] data-threads: 8
[2023-07-20 08:40:27] [config] data-weighting: ""
[2023-07-20 08:40:27] [config] data-weighting-type: sentence
[2023-07-20 08:40:27] [config] dec-cell: gru
[2023-07-20 08:40:27] [config] dec-cell-base-depth: 2
[2023-07-20 08:40:27] [config] dec-cell-high-depth: 1
[2023-07-20 08:40:27] [config] dec-depth: 1
[2023-07-20 08:40:27] [config] devices:
[2023-07-20 08:40:27] [config]   - 0
[2023-07-20 08:40:27] [config] dim-emb: 512
[2023-07-20 08:40:27] [config] dim-rnn: 1024
[2023-07-20 08:40:27] [config] dim-vocabs:
[2023-07-20 08:40:27] [config]   - 16384
[2023-07-20 08:40:27] [config]   - 16384
[2023-07-20 08:40:27] [config] disp-first: 0
[2023-07-20 08:40:27] [config] disp-freq: 1000u
[2023-07-20 08:40:27] [config] disp-label-counts: true
[2023-07-20 08:40:27] [config] dropout-rnn: 0
[2023-07-20 08:40:27] [config] dropout-src: 0
[2023-07-20 08:40:27] [config] dropout-trg: 0
[2023-07-20 08:40:27] [config] dump-config: ""
[2023-07-20 08:40:27] [config] dynamic-gradient-scaling:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] early-stopping: 200
[2023-07-20 08:40:27] [config] early-stopping-on: first
[2023-07-20 08:40:27] [config] embedding-fix-src: false
[2023-07-20 08:40:27] [config] embedding-fix-trg: false
[2023-07-20 08:40:27] [config] embedding-normalization: false
[2023-07-20 08:40:27] [config] embedding-vectors:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] enc-cell: gru
[2023-07-20 08:40:27] [config] enc-cell-depth: 1
[2023-07-20 08:40:27] [config] enc-depth: 1
[2023-07-20 08:40:27] [config] enc-type: bidirectional
[2023-07-20 08:40:27] [config] english-title-case-every: 0
[2023-07-20 08:40:27] [config] exponential-smoothing: 0
[2023-07-20 08:40:27] [config] factor-weight: 1
[2023-07-20 08:40:27] [config] factors-combine: sum
[2023-07-20 08:40:27] [config] factors-dim-emb: 0
[2023-07-20 08:40:27] [config] gradient-checkpointing: false
[2023-07-20 08:40:27] [config] gradient-norm-average-window: 100
[2023-07-20 08:40:27] [config] guided-alignment: none
[2023-07-20 08:40:27] [config] guided-alignment-cost: mse
[2023-07-20 08:40:27] [config] guided-alignment-weight: 0.1
[2023-07-20 08:40:27] [config] ignore-model-config: false
[2023-07-20 08:40:27] [config] input-types:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] interpolate-env-vars: false
[2023-07-20 08:40:27] [config] keep-best: false
[2023-07-20 08:40:27] [config] label-smoothing: 0
[2023-07-20 08:40:27] [config] layer-normalization: false
[2023-07-20 08:40:27] [config] learn-rate: 0.0001
[2023-07-20 08:40:27] [config] lemma-dependency: ""
[2023-07-20 08:40:27] [config] lemma-dim-emb: 0
[2023-07-20 08:40:27] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 08:40:27] [config] log-level: info
[2023-07-20 08:40:27] [config] log-time-zone: ""
[2023-07-20 08:40:27] [config] logical-epoch:
[2023-07-20 08:40:27] [config]   - 1e
[2023-07-20 08:40:27] [config]   - 0
[2023-07-20 08:40:27] [config] lr-decay: 0
[2023-07-20 08:40:27] [config] lr-decay-freq: 50000
[2023-07-20 08:40:27] [config] lr-decay-inv-sqrt:
[2023-07-20 08:40:27] [config]   - 0
[2023-07-20 08:40:27] [config] lr-decay-repeat-warmup: false
[2023-07-20 08:40:27] [config] lr-decay-reset-optimizer: false
[2023-07-20 08:40:27] [config] lr-decay-start:
[2023-07-20 08:40:27] [config]   - 10
[2023-07-20 08:40:27] [config]   - 1
[2023-07-20 08:40:27] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 08:40:27] [config] lr-report: false
[2023-07-20 08:40:27] [config] lr-warmup: 0
[2023-07-20 08:40:27] [config] lr-warmup-at-reload: false
[2023-07-20 08:40:27] [config] lr-warmup-cycle: false
[2023-07-20 08:40:27] [config] lr-warmup-start-rate: 0
[2023-07-20 08:40:27] [config] max-length: 200
[2023-07-20 08:40:27] [config] max-length-crop: true
[2023-07-20 08:40:27] [config] max-length-factor: 3
[2023-07-20 08:40:27] [config] maxi-batch: 100
[2023-07-20 08:40:27] [config] maxi-batch-sort: trg
[2023-07-20 08:40:27] [config] mini-batch: 64
[2023-07-20 08:40:27] [config] mini-batch-fit: true
[2023-07-20 08:40:27] [config] mini-batch-fit-step: 10
[2023-07-20 08:40:27] [config] mini-batch-round-up: true
[2023-07-20 08:40:27] [config] mini-batch-track-lr: false
[2023-07-20 08:40:27] [config] mini-batch-warmup: 0
[2023-07-20 08:40:27] [config] mini-batch-words: 0
[2023-07-20 08:40:27] [config] mini-batch-words-ref: 0
[2023-07-20 08:40:27] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 08:40:27] [config] multi-loss-type: sum
[2023-07-20 08:40:27] [config] n-best: false
[2023-07-20 08:40:27] [config] no-nccl: false
[2023-07-20 08:40:27] [config] no-reload: false
[2023-07-20 08:40:27] [config] no-restore-corpus: false
[2023-07-20 08:40:27] [config] normalize: 0
[2023-07-20 08:40:27] [config] normalize-gradient: false
[2023-07-20 08:40:27] [config] num-devices: 0
[2023-07-20 08:40:27] [config] optimizer: adam
[2023-07-20 08:40:27] [config] optimizer-delay: 1
[2023-07-20 08:40:27] [config] optimizer-params:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] output-omit-bias: false
[2023-07-20 08:40:27] [config] overwrite: true
[2023-07-20 08:40:27] [config] precision:
[2023-07-20 08:40:27] [config]   - float16
[2023-07-20 08:40:27] [config]   - float32
[2023-07-20 08:40:27] [config] pretrained-model: ""
[2023-07-20 08:40:27] [config] quantize-biases: false
[2023-07-20 08:40:27] [config] quantize-bits: 0
[2023-07-20 08:40:27] [config] quantize-log-based: false
[2023-07-20 08:40:27] [config] quantize-optimization-steps: 0
[2023-07-20 08:40:27] [config] quiet: false
[2023-07-20 08:40:27] [config] quiet-translation: true
[2023-07-20 08:40:27] [config] relative-paths: false
[2023-07-20 08:40:27] [config] right-left: false
[2023-07-20 08:40:27] [config] save-freq: 10000u
[2023-07-20 08:40:27] [config] seed: 1234
[2023-07-20 08:40:27] [config] sentencepiece-alphas:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] sentencepiece-max-lines: 2000000
[2023-07-20 08:40:27] [config] sentencepiece-options: ""
[2023-07-20 08:40:27] [config] sharding: global
[2023-07-20 08:40:27] [config] shuffle: data
[2023-07-20 08:40:27] [config] shuffle-in-ram: false
[2023-07-20 08:40:27] [config] sigterm: save-and-exit
[2023-07-20 08:40:27] [config] skip: false
[2023-07-20 08:40:27] [config] sqlite: ""
[2023-07-20 08:40:27] [config] sqlite-drop: false
[2023-07-20 08:40:27] [config] sync-freq: 200u
[2023-07-20 08:40:27] [config] sync-sgd: false
[2023-07-20 08:40:27] [config] tempdir: /tmp
[2023-07-20 08:40:27] [config] tied-embeddings: false
[2023-07-20 08:40:27] [config] tied-embeddings-all: true
[2023-07-20 08:40:27] [config] tied-embeddings-src: false
[2023-07-20 08:40:27] [config] train-embedder-rank:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] train-sets:
[2023-07-20 08:40:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 08:40:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 08:40:27] [config] transformer-aan-activation: swish
[2023-07-20 08:40:27] [config] transformer-aan-depth: 2
[2023-07-20 08:40:27] [config] transformer-aan-nogate: false
[2023-07-20 08:40:27] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 08:40:27] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 08:40:27] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 08:40:27] [config] transformer-depth-scaling: false
[2023-07-20 08:40:27] [config] transformer-dim-aan: 2048
[2023-07-20 08:40:27] [config] transformer-dim-ffn: 2048
[2023-07-20 08:40:27] [config] transformer-dropout: 0
[2023-07-20 08:40:27] [config] transformer-dropout-attention: 0
[2023-07-20 08:40:27] [config] transformer-dropout-ffn: 0
[2023-07-20 08:40:27] [config] transformer-ffn-activation: swish
[2023-07-20 08:40:27] [config] transformer-ffn-depth: 2
[2023-07-20 08:40:27] [config] transformer-guided-alignment-layer: last
[2023-07-20 08:40:27] [config] transformer-heads: 8
[2023-07-20 08:40:27] [config] transformer-no-projection: false
[2023-07-20 08:40:27] [config] transformer-pool: false
[2023-07-20 08:40:27] [config] transformer-postprocess: dan
[2023-07-20 08:40:27] [config] transformer-postprocess-emb: d
[2023-07-20 08:40:27] [config] transformer-postprocess-top: ""
[2023-07-20 08:40:27] [config] transformer-preprocess: ""
[2023-07-20 08:40:27] [config] transformer-tied-layers:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] transformer-train-position-embeddings: false
[2023-07-20 08:40:27] [config] tsv: false
[2023-07-20 08:40:27] [config] tsv-fields: 0
[2023-07-20 08:40:27] [config] type: amun
[2023-07-20 08:40:27] [config] ulr: false
[2023-07-20 08:40:27] [config] ulr-dim-emb: 0
[2023-07-20 08:40:27] [config] ulr-dropout: 0
[2023-07-20 08:40:27] [config] ulr-keys-vectors: ""
[2023-07-20 08:40:27] [config] ulr-query-vectors: ""
[2023-07-20 08:40:27] [config] ulr-softmax-temperature: 1
[2023-07-20 08:40:27] [config] ulr-trainable-transformation: false
[2023-07-20 08:40:27] [config] unlikelihood-loss: false
[2023-07-20 08:40:27] [config] valid-freq: 50000000
[2023-07-20 08:40:27] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 08:40:27] [config] valid-max-length: 1000
[2023-07-20 08:40:27] [config] valid-metrics:
[2023-07-20 08:40:27] [config]   - cross-entropy
[2023-07-20 08:40:27] [config]   - translation
[2023-07-20 08:40:27] [config] valid-mini-batch: 32
[2023-07-20 08:40:27] [config] valid-reset-stalled: false
[2023-07-20 08:40:27] [config] valid-script-args:
[2023-07-20 08:40:27] [config]   []
[2023-07-20 08:40:27] [config] valid-script-path: ""
[2023-07-20 08:40:27] [config] valid-sets:
[2023-07-20 08:40:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 08:40:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 08:40:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 08:40:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 08:40:27] [config] vocabs:
[2023-07-20 08:40:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 08:40:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 08:40:27] [config] word-penalty: 0
[2023-07-20 08:40:27] [config] word-scores: false
[2023-07-20 08:40:27] [config] workspace: 5500
[2023-07-20 08:40:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 08:40:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 08:40:27] [training] Using single-device training
[2023-07-20 08:40:27] Synced seed 1234
[2023-07-20 08:40:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 08:40:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 08:40:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 08:40:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 08:40:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 08:40:27] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 08:40:27] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 08:40:28] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 08:40:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 08:40:29] [comm] Using global sharding
[2023-07-20 08:40:29] [comm] NCCLCommunicators constructed successfully
[2023-07-20 08:40:29] [training] Using 1 GPUs
[2023-07-20 08:40:29] [logits] Applying loss function for 1 factor(s)
[2023-07-20 08:40:29] [memory] Reserving 80 MB, device gpu0
[2023-07-20 08:40:29] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 08:40:29] [memory] Reserving 80 MB, device gpu0
[2023-07-20 09:20:20] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 09:20:21] [valid] No post-processing script given for validating translator
[2023-07-20 09:20:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 09:20:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 09:20:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 09:20:21] [comm] Using global sharding
[2023-07-20 09:20:21] [comm] NCCLCommunicators constructed successfully
[2023-07-20 09:20:21] [training] Using 1 GPUs
[2023-07-20 09:20:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 09:20:28] Allocating memory for general optimizer shards
[2023-07-20 09:20:28] [memory] Reserving 322 MB, device gpu0
[2023-07-20 09:20:28] Loading Adam parameters
[2023-07-20 09:20:29] [memory] Reserving 322 MB, device gpu0
[2023-07-20 09:20:29] [memory] Reserving 80 MB, device gpu0
[2023-07-20 09:20:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 09:20:29] [data] Restoring the corpus state to epoch 161, batch 6173
[2023-07-20 09:20:29] [data] Shuffling data
[2023-07-20 09:20:29] [data] Done reading 20,192 sentences
[2023-07-20 09:20:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:20:29] Training started
[2023-07-20 09:20:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 09:20:30] [memory] Reserving 80 MB, device gpu0
[2023-07-20 09:20:43] Parameter type float16, optimization type float32, casting types true
[2023-07-20 09:24:25] Seen 20,192 samples
[2023-07-20 09:24:25] Starting data epoch 162 in logical epoch 162
[2023-07-20 09:24:25] [data] Shuffling data
[2023-07-20 09:24:25] [data] Done reading 20,192 sentences
[2023-07-20 09:24:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:28:45] Seen 20,192 samples
[2023-07-20 09:28:45] Starting data epoch 163 in logical epoch 163
[2023-07-20 09:28:45] [data] Shuffling data
[2023-07-20 09:28:45] [data] Done reading 20,192 sentences
[2023-07-20 09:28:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:33:10] Seen 20,192 samples
[2023-07-20 09:33:10] Starting data epoch 164 in logical epoch 164
[2023-07-20 09:33:10] [data] Shuffling data
[2023-07-20 09:33:10] [data] Done reading 20,192 sentences
[2023-07-20 09:33:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:37:32] Seen 20,192 samples
[2023-07-20 09:37:32] Starting data epoch 165 in logical epoch 165
[2023-07-20 09:37:32] [data] Shuffling data
[2023-07-20 09:37:32] [data] Done reading 20,192 sentences
[2023-07-20 09:37:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:42:00] Seen 20,192 samples
[2023-07-20 09:42:00] Starting data epoch 166 in logical epoch 166
[2023-07-20 09:42:00] [data] Shuffling data
[2023-07-20 09:42:00] [data] Done reading 20,192 sentences
[2023-07-20 09:42:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:46:27] Seen 20,192 samples
[2023-07-20 09:46:27] Starting data epoch 167 in logical epoch 167
[2023-07-20 09:46:27] [data] Shuffling data
[2023-07-20 09:46:27] [data] Done reading 20,192 sentences
[2023-07-20 09:46:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:50:48] Seen 20,192 samples
[2023-07-20 09:50:48] Starting data epoch 168 in logical epoch 168
[2023-07-20 09:50:48] [data] Shuffling data
[2023-07-20 09:50:48] [data] Done reading 20,192 sentences
[2023-07-20 09:50:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:55:13] Seen 20,192 samples
[2023-07-20 09:55:13] Starting data epoch 169 in logical epoch 169
[2023-07-20 09:55:13] [data] Shuffling data
[2023-07-20 09:55:13] [data] Done reading 20,192 sentences
[2023-07-20 09:55:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 09:59:30] Seen 20,192 samples
[2023-07-20 09:59:30] Starting data epoch 170 in logical epoch 170
[2023-07-20 09:59:30] [data] Shuffling data
[2023-07-20 09:59:30] [data] Done reading 20,192 sentences
[2023-07-20 09:59:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 10:03:57] Seen 20,192 samples
[2023-07-20 10:03:57] Starting data epoch 171 in logical epoch 171
[2023-07-20 10:03:57] Training finished
[2023-07-20 10:04:08] [valid] Ep. 171 : Up. 6559 : cross-entropy : 124.07 : stalled 3 times (last best: 122.646)
[2023-07-20 10:06:04] [valid] Ep. 171 : Up. 6559 : translation : 0 : new best
[2023-07-20 10:06:04] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 10:06:07] Saving Adam parameters
[2023-07-20 10:06:07] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 10:06:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 10:06:16] [marian] Running on node18.datos.cluster.uy as process 11770 with command line:
[2023-07-20 10:06:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 10:06:16] [config] after: 0e
[2023-07-20 10:06:16] [config] after-batches: 0
[2023-07-20 10:06:16] [config] after-epochs: 180
[2023-07-20 10:06:16] [config] all-caps-every: 0
[2023-07-20 10:06:16] [config] allow-unk: false
[2023-07-20 10:06:16] [config] authors: false
[2023-07-20 10:06:16] [config] beam-size: 12
[2023-07-20 10:06:16] [config] bert-class-symbol: "[CLS]"
[2023-07-20 10:06:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 10:06:16] [config] bert-masking-fraction: 0.15
[2023-07-20 10:06:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 10:06:16] [config] bert-train-type-embeddings: true
[2023-07-20 10:06:16] [config] bert-type-vocab-size: 2
[2023-07-20 10:06:16] [config] build-info: ""
[2023-07-20 10:06:16] [config] check-gradient-nan: false
[2023-07-20 10:06:16] [config] check-nan: false
[2023-07-20 10:06:16] [config] cite: false
[2023-07-20 10:06:16] [config] clip-norm: 1
[2023-07-20 10:06:16] [config] cost-scaling:
[2023-07-20 10:06:16] [config]   - 256.f
[2023-07-20 10:06:16] [config]   - 1000
[2023-07-20 10:06:16] [config]   - 2.f
[2023-07-20 10:06:16] [config]   - 256.f
[2023-07-20 10:06:16] [config] cost-type: ce-sum
[2023-07-20 10:06:16] [config] cpu-threads: 0
[2023-07-20 10:06:16] [config] data-threads: 8
[2023-07-20 10:06:16] [config] data-weighting: ""
[2023-07-20 10:06:16] [config] data-weighting-type: sentence
[2023-07-20 10:06:16] [config] dec-cell: gru
[2023-07-20 10:06:16] [config] dec-cell-base-depth: 2
[2023-07-20 10:06:16] [config] dec-cell-high-depth: 1
[2023-07-20 10:06:16] [config] dec-depth: 1
[2023-07-20 10:06:16] [config] devices:
[2023-07-20 10:06:16] [config]   - 0
[2023-07-20 10:06:16] [config] dim-emb: 512
[2023-07-20 10:06:16] [config] dim-rnn: 1024
[2023-07-20 10:06:16] [config] dim-vocabs:
[2023-07-20 10:06:16] [config]   - 16384
[2023-07-20 10:06:16] [config]   - 16384
[2023-07-20 10:06:16] [config] disp-first: 0
[2023-07-20 10:06:16] [config] disp-freq: 1000u
[2023-07-20 10:06:16] [config] disp-label-counts: true
[2023-07-20 10:06:16] [config] dropout-rnn: 0
[2023-07-20 10:06:16] [config] dropout-src: 0
[2023-07-20 10:06:16] [config] dropout-trg: 0
[2023-07-20 10:06:16] [config] dump-config: ""
[2023-07-20 10:06:16] [config] dynamic-gradient-scaling:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] early-stopping: 200
[2023-07-20 10:06:16] [config] early-stopping-on: first
[2023-07-20 10:06:16] [config] embedding-fix-src: false
[2023-07-20 10:06:16] [config] embedding-fix-trg: false
[2023-07-20 10:06:16] [config] embedding-normalization: false
[2023-07-20 10:06:16] [config] embedding-vectors:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] enc-cell: gru
[2023-07-20 10:06:16] [config] enc-cell-depth: 1
[2023-07-20 10:06:16] [config] enc-depth: 1
[2023-07-20 10:06:16] [config] enc-type: bidirectional
[2023-07-20 10:06:16] [config] english-title-case-every: 0
[2023-07-20 10:06:16] [config] exponential-smoothing: 0
[2023-07-20 10:06:16] [config] factor-weight: 1
[2023-07-20 10:06:16] [config] factors-combine: sum
[2023-07-20 10:06:16] [config] factors-dim-emb: 0
[2023-07-20 10:06:16] [config] gradient-checkpointing: false
[2023-07-20 10:06:16] [config] gradient-norm-average-window: 100
[2023-07-20 10:06:16] [config] guided-alignment: none
[2023-07-20 10:06:16] [config] guided-alignment-cost: mse
[2023-07-20 10:06:16] [config] guided-alignment-weight: 0.1
[2023-07-20 10:06:16] [config] ignore-model-config: false
[2023-07-20 10:06:16] [config] input-types:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] interpolate-env-vars: false
[2023-07-20 10:06:16] [config] keep-best: false
[2023-07-20 10:06:16] [config] label-smoothing: 0
[2023-07-20 10:06:16] [config] layer-normalization: false
[2023-07-20 10:06:16] [config] learn-rate: 0.0001
[2023-07-20 10:06:16] [config] lemma-dependency: ""
[2023-07-20 10:06:16] [config] lemma-dim-emb: 0
[2023-07-20 10:06:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 10:06:16] [config] log-level: info
[2023-07-20 10:06:16] [config] log-time-zone: ""
[2023-07-20 10:06:16] [config] logical-epoch:
[2023-07-20 10:06:16] [config]   - 1e
[2023-07-20 10:06:16] [config]   - 0
[2023-07-20 10:06:16] [config] lr-decay: 0
[2023-07-20 10:06:16] [config] lr-decay-freq: 50000
[2023-07-20 10:06:16] [config] lr-decay-inv-sqrt:
[2023-07-20 10:06:16] [config]   - 0
[2023-07-20 10:06:16] [config] lr-decay-repeat-warmup: false
[2023-07-20 10:06:16] [config] lr-decay-reset-optimizer: false
[2023-07-20 10:06:16] [config] lr-decay-start:
[2023-07-20 10:06:16] [config]   - 10
[2023-07-20 10:06:16] [config]   - 1
[2023-07-20 10:06:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 10:06:16] [config] lr-report: false
[2023-07-20 10:06:16] [config] lr-warmup: 0
[2023-07-20 10:06:16] [config] lr-warmup-at-reload: false
[2023-07-20 10:06:16] [config] lr-warmup-cycle: false
[2023-07-20 10:06:16] [config] lr-warmup-start-rate: 0
[2023-07-20 10:06:16] [config] max-length: 200
[2023-07-20 10:06:16] [config] max-length-crop: true
[2023-07-20 10:06:16] [config] max-length-factor: 3
[2023-07-20 10:06:16] [config] maxi-batch: 100
[2023-07-20 10:06:16] [config] maxi-batch-sort: trg
[2023-07-20 10:06:16] [config] mini-batch: 64
[2023-07-20 10:06:16] [config] mini-batch-fit: true
[2023-07-20 10:06:16] [config] mini-batch-fit-step: 10
[2023-07-20 10:06:16] [config] mini-batch-round-up: true
[2023-07-20 10:06:16] [config] mini-batch-track-lr: false
[2023-07-20 10:06:16] [config] mini-batch-warmup: 0
[2023-07-20 10:06:16] [config] mini-batch-words: 0
[2023-07-20 10:06:16] [config] mini-batch-words-ref: 0
[2023-07-20 10:06:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 10:06:16] [config] multi-loss-type: sum
[2023-07-20 10:06:16] [config] n-best: false
[2023-07-20 10:06:16] [config] no-nccl: false
[2023-07-20 10:06:16] [config] no-reload: false
[2023-07-20 10:06:16] [config] no-restore-corpus: false
[2023-07-20 10:06:16] [config] normalize: 0
[2023-07-20 10:06:16] [config] normalize-gradient: false
[2023-07-20 10:06:16] [config] num-devices: 0
[2023-07-20 10:06:16] [config] optimizer: adam
[2023-07-20 10:06:16] [config] optimizer-delay: 1
[2023-07-20 10:06:16] [config] optimizer-params:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] output-omit-bias: false
[2023-07-20 10:06:16] [config] overwrite: true
[2023-07-20 10:06:16] [config] precision:
[2023-07-20 10:06:16] [config]   - float16
[2023-07-20 10:06:16] [config]   - float32
[2023-07-20 10:06:16] [config] pretrained-model: ""
[2023-07-20 10:06:16] [config] quantize-biases: false
[2023-07-20 10:06:16] [config] quantize-bits: 0
[2023-07-20 10:06:16] [config] quantize-log-based: false
[2023-07-20 10:06:16] [config] quantize-optimization-steps: 0
[2023-07-20 10:06:16] [config] quiet: false
[2023-07-20 10:06:16] [config] quiet-translation: true
[2023-07-20 10:06:16] [config] relative-paths: false
[2023-07-20 10:06:16] [config] right-left: false
[2023-07-20 10:06:16] [config] save-freq: 10000u
[2023-07-20 10:06:16] [config] seed: 1234
[2023-07-20 10:06:16] [config] sentencepiece-alphas:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] sentencepiece-max-lines: 2000000
[2023-07-20 10:06:16] [config] sentencepiece-options: ""
[2023-07-20 10:06:16] [config] sharding: global
[2023-07-20 10:06:16] [config] shuffle: data
[2023-07-20 10:06:16] [config] shuffle-in-ram: false
[2023-07-20 10:06:16] [config] sigterm: save-and-exit
[2023-07-20 10:06:16] [config] skip: false
[2023-07-20 10:06:16] [config] sqlite: ""
[2023-07-20 10:06:16] [config] sqlite-drop: false
[2023-07-20 10:06:16] [config] sync-freq: 200u
[2023-07-20 10:06:16] [config] sync-sgd: false
[2023-07-20 10:06:16] [config] tempdir: /tmp
[2023-07-20 10:06:16] [config] tied-embeddings: false
[2023-07-20 10:06:16] [config] tied-embeddings-all: true
[2023-07-20 10:06:16] [config] tied-embeddings-src: false
[2023-07-20 10:06:16] [config] train-embedder-rank:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] train-sets:
[2023-07-20 10:06:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 10:06:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 10:06:16] [config] transformer-aan-activation: swish
[2023-07-20 10:06:16] [config] transformer-aan-depth: 2
[2023-07-20 10:06:16] [config] transformer-aan-nogate: false
[2023-07-20 10:06:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 10:06:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 10:06:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 10:06:16] [config] transformer-depth-scaling: false
[2023-07-20 10:06:16] [config] transformer-dim-aan: 2048
[2023-07-20 10:06:16] [config] transformer-dim-ffn: 2048
[2023-07-20 10:06:16] [config] transformer-dropout: 0
[2023-07-20 10:06:16] [config] transformer-dropout-attention: 0
[2023-07-20 10:06:16] [config] transformer-dropout-ffn: 0
[2023-07-20 10:06:16] [config] transformer-ffn-activation: swish
[2023-07-20 10:06:16] [config] transformer-ffn-depth: 2
[2023-07-20 10:06:16] [config] transformer-guided-alignment-layer: last
[2023-07-20 10:06:16] [config] transformer-heads: 8
[2023-07-20 10:06:16] [config] transformer-no-projection: false
[2023-07-20 10:06:16] [config] transformer-pool: false
[2023-07-20 10:06:16] [config] transformer-postprocess: dan
[2023-07-20 10:06:16] [config] transformer-postprocess-emb: d
[2023-07-20 10:06:16] [config] transformer-postprocess-top: ""
[2023-07-20 10:06:16] [config] transformer-preprocess: ""
[2023-07-20 10:06:16] [config] transformer-tied-layers:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] transformer-train-position-embeddings: false
[2023-07-20 10:06:16] [config] tsv: false
[2023-07-20 10:06:16] [config] tsv-fields: 0
[2023-07-20 10:06:16] [config] type: amun
[2023-07-20 10:06:16] [config] ulr: false
[2023-07-20 10:06:16] [config] ulr-dim-emb: 0
[2023-07-20 10:06:16] [config] ulr-dropout: 0
[2023-07-20 10:06:16] [config] ulr-keys-vectors: ""
[2023-07-20 10:06:16] [config] ulr-query-vectors: ""
[2023-07-20 10:06:16] [config] ulr-softmax-temperature: 1
[2023-07-20 10:06:16] [config] ulr-trainable-transformation: false
[2023-07-20 10:06:16] [config] unlikelihood-loss: false
[2023-07-20 10:06:16] [config] valid-freq: 50000000
[2023-07-20 10:06:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 10:06:16] [config] valid-max-length: 1000
[2023-07-20 10:06:16] [config] valid-metrics:
[2023-07-20 10:06:16] [config]   - cross-entropy
[2023-07-20 10:06:16] [config]   - translation
[2023-07-20 10:06:16] [config] valid-mini-batch: 32
[2023-07-20 10:06:16] [config] valid-reset-stalled: false
[2023-07-20 10:06:16] [config] valid-script-args:
[2023-07-20 10:06:16] [config]   []
[2023-07-20 10:06:16] [config] valid-script-path: ""
[2023-07-20 10:06:16] [config] valid-sets:
[2023-07-20 10:06:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 10:06:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 10:06:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 10:06:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 10:06:16] [config] vocabs:
[2023-07-20 10:06:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 10:06:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 10:06:16] [config] word-penalty: 0
[2023-07-20 10:06:16] [config] word-scores: false
[2023-07-20 10:06:16] [config] workspace: 5500
[2023-07-20 10:06:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 10:06:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 10:06:16] [training] Using single-device training
[2023-07-20 10:06:16] Synced seed 1234
[2023-07-20 10:06:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 10:06:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 10:06:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 10:06:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 10:06:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 10:06:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 10:06:16] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 10:06:17] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 10:06:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 10:06:17] [comm] Using global sharding
[2023-07-20 10:06:17] [comm] NCCLCommunicators constructed successfully
[2023-07-20 10:06:17] [training] Using 1 GPUs
[2023-07-20 10:06:17] [logits] Applying loss function for 1 factor(s)
[2023-07-20 10:06:17] [memory] Reserving 80 MB, device gpu0
[2023-07-20 10:06:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 10:06:18] [memory] Reserving 80 MB, device gpu0
[2023-07-20 10:45:50] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 10:45:50] [valid] No post-processing script given for validating translator
[2023-07-20 10:45:51] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 10:45:51] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 10:45:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 10:45:51] [comm] Using global sharding
[2023-07-20 10:45:51] [comm] NCCLCommunicators constructed successfully
[2023-07-20 10:45:51] [training] Using 1 GPUs
[2023-07-20 10:45:51] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 10:45:59] Allocating memory for general optimizer shards
[2023-07-20 10:45:59] [memory] Reserving 322 MB, device gpu0
[2023-07-20 10:45:59] Loading Adam parameters
[2023-07-20 10:45:59] [memory] Reserving 322 MB, device gpu0
[2023-07-20 10:45:59] [memory] Reserving 80 MB, device gpu0
[2023-07-20 10:45:59] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 10:45:59] [data] Restoring the corpus state to epoch 171, batch 6559
[2023-07-20 10:45:59] [data] Shuffling data
[2023-07-20 10:45:59] [data] Done reading 20,192 sentences
[2023-07-20 10:45:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 10:45:59] Training started
[2023-07-20 10:45:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 10:46:00] [memory] Reserving 80 MB, device gpu0
[2023-07-20 10:46:05] Parameter type float16, optimization type float32, casting types true
[2023-07-20 10:50:10] Seen 20,192 samples
[2023-07-20 10:50:10] Starting data epoch 172 in logical epoch 172
[2023-07-20 10:50:10] [data] Shuffling data
[2023-07-20 10:50:10] [data] Done reading 20,192 sentences
[2023-07-20 10:50:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 10:54:25] Seen 20,192 samples
[2023-07-20 10:54:25] Starting data epoch 173 in logical epoch 173
[2023-07-20 10:54:25] [data] Shuffling data
[2023-07-20 10:54:25] [data] Done reading 20,192 sentences
[2023-07-20 10:54:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 10:58:42] Seen 20,192 samples
[2023-07-20 10:58:42] Starting data epoch 174 in logical epoch 174
[2023-07-20 10:58:42] [data] Shuffling data
[2023-07-20 10:58:42] [data] Done reading 20,192 sentences
[2023-07-20 10:58:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:03:05] Seen 20,192 samples
[2023-07-20 11:03:05] Starting data epoch 175 in logical epoch 175
[2023-07-20 11:03:05] [data] Shuffling data
[2023-07-20 11:03:05] [data] Done reading 20,192 sentences
[2023-07-20 11:03:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:07:25] Seen 20,192 samples
[2023-07-20 11:07:25] Starting data epoch 176 in logical epoch 176
[2023-07-20 11:07:25] [data] Shuffling data
[2023-07-20 11:07:25] [data] Done reading 20,192 sentences
[2023-07-20 11:07:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:11:52] Seen 20,192 samples
[2023-07-20 11:11:52] Starting data epoch 177 in logical epoch 177
[2023-07-20 11:11:52] [data] Shuffling data
[2023-07-20 11:11:52] [data] Done reading 20,192 sentences
[2023-07-20 11:11:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:16:13] Seen 20,192 samples
[2023-07-20 11:16:13] Starting data epoch 178 in logical epoch 178
[2023-07-20 11:16:13] [data] Shuffling data
[2023-07-20 11:16:13] [data] Done reading 20,192 sentences
[2023-07-20 11:16:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:20:41] Seen 20,192 samples
[2023-07-20 11:20:41] Starting data epoch 179 in logical epoch 179
[2023-07-20 11:20:41] [data] Shuffling data
[2023-07-20 11:20:41] [data] Done reading 20,192 sentences
[2023-07-20 11:20:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:25:00] Seen 20,192 samples
[2023-07-20 11:25:00] Starting data epoch 180 in logical epoch 180
[2023-07-20 11:25:00] [data] Shuffling data
[2023-07-20 11:25:00] [data] Done reading 20,192 sentences
[2023-07-20 11:25:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 11:29:22] Seen 20,192 samples
[2023-07-20 11:29:22] Starting data epoch 181 in logical epoch 181
[2023-07-20 11:29:22] Training finished
[2023-07-20 11:29:35] [valid] Ep. 181 : Up. 6945 : cross-entropy : 125.247 : stalled 4 times (last best: 122.646)
[2023-07-20 11:31:49] [valid] Ep. 181 : Up. 6945 : translation : 0 : new best
[2023-07-20 11:31:49] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 11:31:53] Saving Adam parameters
[2023-07-20 11:31:53] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 11:32:01] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 11:32:01] [marian] Running on node18.datos.cluster.uy as process 17346 with command line:
[2023-07-20 11:32:01] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 11:32:01] [config] after: 0e
[2023-07-20 11:32:01] [config] after-batches: 0
[2023-07-20 11:32:01] [config] after-epochs: 190
[2023-07-20 11:32:01] [config] all-caps-every: 0
[2023-07-20 11:32:01] [config] allow-unk: false
[2023-07-20 11:32:01] [config] authors: false
[2023-07-20 11:32:01] [config] beam-size: 12
[2023-07-20 11:32:01] [config] bert-class-symbol: "[CLS]"
[2023-07-20 11:32:01] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 11:32:01] [config] bert-masking-fraction: 0.15
[2023-07-20 11:32:01] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 11:32:01] [config] bert-train-type-embeddings: true
[2023-07-20 11:32:01] [config] bert-type-vocab-size: 2
[2023-07-20 11:32:01] [config] build-info: ""
[2023-07-20 11:32:01] [config] check-gradient-nan: false
[2023-07-20 11:32:01] [config] check-nan: false
[2023-07-20 11:32:01] [config] cite: false
[2023-07-20 11:32:01] [config] clip-norm: 1
[2023-07-20 11:32:01] [config] cost-scaling:
[2023-07-20 11:32:01] [config]   - 256.f
[2023-07-20 11:32:01] [config]   - 1000
[2023-07-20 11:32:01] [config]   - 2.f
[2023-07-20 11:32:01] [config]   - 256.f
[2023-07-20 11:32:01] [config] cost-type: ce-sum
[2023-07-20 11:32:01] [config] cpu-threads: 0
[2023-07-20 11:32:01] [config] data-threads: 8
[2023-07-20 11:32:01] [config] data-weighting: ""
[2023-07-20 11:32:01] [config] data-weighting-type: sentence
[2023-07-20 11:32:01] [config] dec-cell: gru
[2023-07-20 11:32:01] [config] dec-cell-base-depth: 2
[2023-07-20 11:32:01] [config] dec-cell-high-depth: 1
[2023-07-20 11:32:01] [config] dec-depth: 1
[2023-07-20 11:32:01] [config] devices:
[2023-07-20 11:32:01] [config]   - 0
[2023-07-20 11:32:01] [config] dim-emb: 512
[2023-07-20 11:32:01] [config] dim-rnn: 1024
[2023-07-20 11:32:01] [config] dim-vocabs:
[2023-07-20 11:32:01] [config]   - 16384
[2023-07-20 11:32:01] [config]   - 16384
[2023-07-20 11:32:01] [config] disp-first: 0
[2023-07-20 11:32:01] [config] disp-freq: 1000u
[2023-07-20 11:32:01] [config] disp-label-counts: true
[2023-07-20 11:32:01] [config] dropout-rnn: 0
[2023-07-20 11:32:01] [config] dropout-src: 0
[2023-07-20 11:32:01] [config] dropout-trg: 0
[2023-07-20 11:32:01] [config] dump-config: ""
[2023-07-20 11:32:01] [config] dynamic-gradient-scaling:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] early-stopping: 200
[2023-07-20 11:32:01] [config] early-stopping-on: first
[2023-07-20 11:32:01] [config] embedding-fix-src: false
[2023-07-20 11:32:01] [config] embedding-fix-trg: false
[2023-07-20 11:32:01] [config] embedding-normalization: false
[2023-07-20 11:32:01] [config] embedding-vectors:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] enc-cell: gru
[2023-07-20 11:32:01] [config] enc-cell-depth: 1
[2023-07-20 11:32:01] [config] enc-depth: 1
[2023-07-20 11:32:01] [config] enc-type: bidirectional
[2023-07-20 11:32:01] [config] english-title-case-every: 0
[2023-07-20 11:32:01] [config] exponential-smoothing: 0
[2023-07-20 11:32:01] [config] factor-weight: 1
[2023-07-20 11:32:01] [config] factors-combine: sum
[2023-07-20 11:32:01] [config] factors-dim-emb: 0
[2023-07-20 11:32:01] [config] gradient-checkpointing: false
[2023-07-20 11:32:01] [config] gradient-norm-average-window: 100
[2023-07-20 11:32:01] [config] guided-alignment: none
[2023-07-20 11:32:01] [config] guided-alignment-cost: mse
[2023-07-20 11:32:01] [config] guided-alignment-weight: 0.1
[2023-07-20 11:32:01] [config] ignore-model-config: false
[2023-07-20 11:32:01] [config] input-types:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] interpolate-env-vars: false
[2023-07-20 11:32:01] [config] keep-best: false
[2023-07-20 11:32:01] [config] label-smoothing: 0
[2023-07-20 11:32:01] [config] layer-normalization: false
[2023-07-20 11:32:01] [config] learn-rate: 0.0001
[2023-07-20 11:32:01] [config] lemma-dependency: ""
[2023-07-20 11:32:01] [config] lemma-dim-emb: 0
[2023-07-20 11:32:01] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 11:32:01] [config] log-level: info
[2023-07-20 11:32:01] [config] log-time-zone: ""
[2023-07-20 11:32:01] [config] logical-epoch:
[2023-07-20 11:32:01] [config]   - 1e
[2023-07-20 11:32:01] [config]   - 0
[2023-07-20 11:32:01] [config] lr-decay: 0
[2023-07-20 11:32:01] [config] lr-decay-freq: 50000
[2023-07-20 11:32:01] [config] lr-decay-inv-sqrt:
[2023-07-20 11:32:01] [config]   - 0
[2023-07-20 11:32:01] [config] lr-decay-repeat-warmup: false
[2023-07-20 11:32:01] [config] lr-decay-reset-optimizer: false
[2023-07-20 11:32:01] [config] lr-decay-start:
[2023-07-20 11:32:01] [config]   - 10
[2023-07-20 11:32:01] [config]   - 1
[2023-07-20 11:32:01] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 11:32:01] [config] lr-report: false
[2023-07-20 11:32:01] [config] lr-warmup: 0
[2023-07-20 11:32:01] [config] lr-warmup-at-reload: false
[2023-07-20 11:32:01] [config] lr-warmup-cycle: false
[2023-07-20 11:32:01] [config] lr-warmup-start-rate: 0
[2023-07-20 11:32:01] [config] max-length: 200
[2023-07-20 11:32:01] [config] max-length-crop: true
[2023-07-20 11:32:01] [config] max-length-factor: 3
[2023-07-20 11:32:01] [config] maxi-batch: 100
[2023-07-20 11:32:01] [config] maxi-batch-sort: trg
[2023-07-20 11:32:01] [config] mini-batch: 64
[2023-07-20 11:32:01] [config] mini-batch-fit: true
[2023-07-20 11:32:01] [config] mini-batch-fit-step: 10
[2023-07-20 11:32:01] [config] mini-batch-round-up: true
[2023-07-20 11:32:01] [config] mini-batch-track-lr: false
[2023-07-20 11:32:01] [config] mini-batch-warmup: 0
[2023-07-20 11:32:01] [config] mini-batch-words: 0
[2023-07-20 11:32:01] [config] mini-batch-words-ref: 0
[2023-07-20 11:32:01] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 11:32:01] [config] multi-loss-type: sum
[2023-07-20 11:32:01] [config] n-best: false
[2023-07-20 11:32:01] [config] no-nccl: false
[2023-07-20 11:32:01] [config] no-reload: false
[2023-07-20 11:32:01] [config] no-restore-corpus: false
[2023-07-20 11:32:01] [config] normalize: 0
[2023-07-20 11:32:01] [config] normalize-gradient: false
[2023-07-20 11:32:01] [config] num-devices: 0
[2023-07-20 11:32:01] [config] optimizer: adam
[2023-07-20 11:32:01] [config] optimizer-delay: 1
[2023-07-20 11:32:01] [config] optimizer-params:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] output-omit-bias: false
[2023-07-20 11:32:01] [config] overwrite: true
[2023-07-20 11:32:01] [config] precision:
[2023-07-20 11:32:01] [config]   - float16
[2023-07-20 11:32:01] [config]   - float32
[2023-07-20 11:32:01] [config] pretrained-model: ""
[2023-07-20 11:32:01] [config] quantize-biases: false
[2023-07-20 11:32:01] [config] quantize-bits: 0
[2023-07-20 11:32:01] [config] quantize-log-based: false
[2023-07-20 11:32:01] [config] quantize-optimization-steps: 0
[2023-07-20 11:32:01] [config] quiet: false
[2023-07-20 11:32:01] [config] quiet-translation: true
[2023-07-20 11:32:01] [config] relative-paths: false
[2023-07-20 11:32:01] [config] right-left: false
[2023-07-20 11:32:01] [config] save-freq: 10000u
[2023-07-20 11:32:01] [config] seed: 1234
[2023-07-20 11:32:01] [config] sentencepiece-alphas:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] sentencepiece-max-lines: 2000000
[2023-07-20 11:32:01] [config] sentencepiece-options: ""
[2023-07-20 11:32:01] [config] sharding: global
[2023-07-20 11:32:01] [config] shuffle: data
[2023-07-20 11:32:01] [config] shuffle-in-ram: false
[2023-07-20 11:32:01] [config] sigterm: save-and-exit
[2023-07-20 11:32:01] [config] skip: false
[2023-07-20 11:32:01] [config] sqlite: ""
[2023-07-20 11:32:01] [config] sqlite-drop: false
[2023-07-20 11:32:01] [config] sync-freq: 200u
[2023-07-20 11:32:01] [config] sync-sgd: false
[2023-07-20 11:32:01] [config] tempdir: /tmp
[2023-07-20 11:32:01] [config] tied-embeddings: false
[2023-07-20 11:32:01] [config] tied-embeddings-all: true
[2023-07-20 11:32:01] [config] tied-embeddings-src: false
[2023-07-20 11:32:01] [config] train-embedder-rank:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] train-sets:
[2023-07-20 11:32:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 11:32:01] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 11:32:01] [config] transformer-aan-activation: swish
[2023-07-20 11:32:01] [config] transformer-aan-depth: 2
[2023-07-20 11:32:01] [config] transformer-aan-nogate: false
[2023-07-20 11:32:01] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 11:32:01] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 11:32:01] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 11:32:01] [config] transformer-depth-scaling: false
[2023-07-20 11:32:01] [config] transformer-dim-aan: 2048
[2023-07-20 11:32:01] [config] transformer-dim-ffn: 2048
[2023-07-20 11:32:01] [config] transformer-dropout: 0
[2023-07-20 11:32:01] [config] transformer-dropout-attention: 0
[2023-07-20 11:32:01] [config] transformer-dropout-ffn: 0
[2023-07-20 11:32:01] [config] transformer-ffn-activation: swish
[2023-07-20 11:32:01] [config] transformer-ffn-depth: 2
[2023-07-20 11:32:01] [config] transformer-guided-alignment-layer: last
[2023-07-20 11:32:01] [config] transformer-heads: 8
[2023-07-20 11:32:01] [config] transformer-no-projection: false
[2023-07-20 11:32:01] [config] transformer-pool: false
[2023-07-20 11:32:01] [config] transformer-postprocess: dan
[2023-07-20 11:32:01] [config] transformer-postprocess-emb: d
[2023-07-20 11:32:01] [config] transformer-postprocess-top: ""
[2023-07-20 11:32:01] [config] transformer-preprocess: ""
[2023-07-20 11:32:01] [config] transformer-tied-layers:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] transformer-train-position-embeddings: false
[2023-07-20 11:32:01] [config] tsv: false
[2023-07-20 11:32:01] [config] tsv-fields: 0
[2023-07-20 11:32:01] [config] type: amun
[2023-07-20 11:32:01] [config] ulr: false
[2023-07-20 11:32:01] [config] ulr-dim-emb: 0
[2023-07-20 11:32:01] [config] ulr-dropout: 0
[2023-07-20 11:32:01] [config] ulr-keys-vectors: ""
[2023-07-20 11:32:01] [config] ulr-query-vectors: ""
[2023-07-20 11:32:01] [config] ulr-softmax-temperature: 1
[2023-07-20 11:32:01] [config] ulr-trainable-transformation: false
[2023-07-20 11:32:01] [config] unlikelihood-loss: false
[2023-07-20 11:32:01] [config] valid-freq: 50000000
[2023-07-20 11:32:01] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 11:32:01] [config] valid-max-length: 1000
[2023-07-20 11:32:01] [config] valid-metrics:
[2023-07-20 11:32:01] [config]   - cross-entropy
[2023-07-20 11:32:01] [config]   - translation
[2023-07-20 11:32:01] [config] valid-mini-batch: 32
[2023-07-20 11:32:01] [config] valid-reset-stalled: false
[2023-07-20 11:32:01] [config] valid-script-args:
[2023-07-20 11:32:01] [config]   []
[2023-07-20 11:32:01] [config] valid-script-path: ""
[2023-07-20 11:32:01] [config] valid-sets:
[2023-07-20 11:32:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 11:32:01] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 11:32:01] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 11:32:01] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 11:32:01] [config] vocabs:
[2023-07-20 11:32:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 11:32:01] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 11:32:01] [config] word-penalty: 0
[2023-07-20 11:32:01] [config] word-scores: false
[2023-07-20 11:32:01] [config] workspace: 5500
[2023-07-20 11:32:01] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 11:32:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 11:32:01] [training] Using single-device training
[2023-07-20 11:32:01] Synced seed 1234
[2023-07-20 11:32:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 11:32:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 11:32:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 11:32:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 11:32:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 11:32:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 11:32:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 11:32:03] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 11:32:03] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 11:32:03] [comm] Using global sharding
[2023-07-20 11:32:03] [comm] NCCLCommunicators constructed successfully
[2023-07-20 11:32:03] [training] Using 1 GPUs
[2023-07-20 11:32:03] [logits] Applying loss function for 1 factor(s)
[2023-07-20 11:32:03] [memory] Reserving 80 MB, device gpu0
[2023-07-20 11:32:03] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 11:32:03] [memory] Reserving 80 MB, device gpu0
[2023-07-20 12:12:23] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 12:12:23] [valid] No post-processing script given for validating translator
[2023-07-20 12:12:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 12:12:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 12:12:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 12:12:23] [comm] Using global sharding
[2023-07-20 12:12:23] [comm] NCCLCommunicators constructed successfully
[2023-07-20 12:12:23] [training] Using 1 GPUs
[2023-07-20 12:12:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 12:12:29] Allocating memory for general optimizer shards
[2023-07-20 12:12:29] [memory] Reserving 322 MB, device gpu0
[2023-07-20 12:12:29] Loading Adam parameters
[2023-07-20 12:12:29] [memory] Reserving 322 MB, device gpu0
[2023-07-20 12:12:29] [memory] Reserving 80 MB, device gpu0
[2023-07-20 12:12:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 12:12:29] [data] Restoring the corpus state to epoch 181, batch 6945
[2023-07-20 12:12:29] [data] Shuffling data
[2023-07-20 12:12:30] [data] Done reading 20,192 sentences
[2023-07-20 12:12:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:12:30] Training started
[2023-07-20 12:12:30] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 12:12:31] [memory] Reserving 80 MB, device gpu0
[2023-07-20 12:12:43] Parameter type float16, optimization type float32, casting types true
[2023-07-20 12:16:36] Seen 20,192 samples
[2023-07-20 12:16:36] Starting data epoch 182 in logical epoch 182
[2023-07-20 12:16:36] [data] Shuffling data
[2023-07-20 12:16:36] [data] Done reading 20,192 sentences
[2023-07-20 12:16:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:18:22] Ep. 182 : Up. 7000 : Sen. 8,194 : Cost 2.17641544 * 16,088,375 @ 23,142 after 112,543,795 : Time 359.42s : 44761.80 words/s : gNorm 1.4071
[2023-07-20 12:20:55] Seen 20,192 samples
[2023-07-20 12:20:55] Starting data epoch 183 in logical epoch 183
[2023-07-20 12:20:55] [data] Shuffling data
[2023-07-20 12:20:56] [data] Done reading 20,192 sentences
[2023-07-20 12:20:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:25:15] Seen 20,192 samples
[2023-07-20 12:25:15] Starting data epoch 184 in logical epoch 184
[2023-07-20 12:25:15] [data] Shuffling data
[2023-07-20 12:25:15] [data] Done reading 20,192 sentences
[2023-07-20 12:25:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:29:30] Seen 20,192 samples
[2023-07-20 12:29:30] Starting data epoch 185 in logical epoch 185
[2023-07-20 12:29:30] [data] Shuffling data
[2023-07-20 12:29:30] [data] Done reading 20,192 sentences
[2023-07-20 12:29:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:33:54] Seen 20,192 samples
[2023-07-20 12:33:54] Starting data epoch 186 in logical epoch 186
[2023-07-20 12:33:54] [data] Shuffling data
[2023-07-20 12:33:54] [data] Done reading 20,192 sentences
[2023-07-20 12:33:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:38:17] Seen 20,192 samples
[2023-07-20 12:38:17] Starting data epoch 187 in logical epoch 187
[2023-07-20 12:38:17] [data] Shuffling data
[2023-07-20 12:38:17] [data] Done reading 20,192 sentences
[2023-07-20 12:38:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:42:46] Seen 20,192 samples
[2023-07-20 12:42:46] Starting data epoch 188 in logical epoch 188
[2023-07-20 12:42:46] [data] Shuffling data
[2023-07-20 12:42:46] [data] Done reading 20,192 sentences
[2023-07-20 12:42:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:47:12] Seen 20,192 samples
[2023-07-20 12:47:12] Starting data epoch 189 in logical epoch 189
[2023-07-20 12:47:12] [data] Shuffling data
[2023-07-20 12:47:12] [data] Done reading 20,192 sentences
[2023-07-20 12:47:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:51:20] Seen 20,192 samples
[2023-07-20 12:51:20] Starting data epoch 190 in logical epoch 190
[2023-07-20 12:51:20] [data] Shuffling data
[2023-07-20 12:51:20] [data] Done reading 20,192 sentences
[2023-07-20 12:51:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 12:55:41] Seen 20,192 samples
[2023-07-20 12:55:41] Starting data epoch 191 in logical epoch 191
[2023-07-20 12:55:41] Training finished
[2023-07-20 12:55:53] [valid] Ep. 191 : Up. 7329 : cross-entropy : 127.23 : stalled 5 times (last best: 122.646)
[2023-07-20 12:58:05] [valid] Ep. 191 : Up. 7329 : translation : 0 : new best
[2023-07-20 12:58:05] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 12:58:07] Saving Adam parameters
[2023-07-20 12:58:08] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 12:58:16] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 12:58:16] [marian] Running on node18.datos.cluster.uy as process 22999 with command line:
[2023-07-20 12:58:16] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 200
[2023-07-20 12:58:16] [config] after: 0e
[2023-07-20 12:58:16] [config] after-batches: 0
[2023-07-20 12:58:16] [config] after-epochs: 200
[2023-07-20 12:58:16] [config] all-caps-every: 0
[2023-07-20 12:58:16] [config] allow-unk: false
[2023-07-20 12:58:16] [config] authors: false
[2023-07-20 12:58:16] [config] beam-size: 12
[2023-07-20 12:58:16] [config] bert-class-symbol: "[CLS]"
[2023-07-20 12:58:16] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 12:58:16] [config] bert-masking-fraction: 0.15
[2023-07-20 12:58:16] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 12:58:16] [config] bert-train-type-embeddings: true
[2023-07-20 12:58:16] [config] bert-type-vocab-size: 2
[2023-07-20 12:58:16] [config] build-info: ""
[2023-07-20 12:58:16] [config] check-gradient-nan: false
[2023-07-20 12:58:16] [config] check-nan: false
[2023-07-20 12:58:16] [config] cite: false
[2023-07-20 12:58:16] [config] clip-norm: 1
[2023-07-20 12:58:16] [config] cost-scaling:
[2023-07-20 12:58:16] [config]   - 256.f
[2023-07-20 12:58:16] [config]   - 1000
[2023-07-20 12:58:16] [config]   - 2.f
[2023-07-20 12:58:16] [config]   - 256.f
[2023-07-20 12:58:16] [config] cost-type: ce-sum
[2023-07-20 12:58:16] [config] cpu-threads: 0
[2023-07-20 12:58:16] [config] data-threads: 8
[2023-07-20 12:58:16] [config] data-weighting: ""
[2023-07-20 12:58:16] [config] data-weighting-type: sentence
[2023-07-20 12:58:16] [config] dec-cell: gru
[2023-07-20 12:58:16] [config] dec-cell-base-depth: 2
[2023-07-20 12:58:16] [config] dec-cell-high-depth: 1
[2023-07-20 12:58:16] [config] dec-depth: 1
[2023-07-20 12:58:16] [config] devices:
[2023-07-20 12:58:16] [config]   - 0
[2023-07-20 12:58:16] [config] dim-emb: 512
[2023-07-20 12:58:16] [config] dim-rnn: 1024
[2023-07-20 12:58:16] [config] dim-vocabs:
[2023-07-20 12:58:16] [config]   - 16384
[2023-07-20 12:58:16] [config]   - 16384
[2023-07-20 12:58:16] [config] disp-first: 0
[2023-07-20 12:58:16] [config] disp-freq: 1000u
[2023-07-20 12:58:16] [config] disp-label-counts: true
[2023-07-20 12:58:16] [config] dropout-rnn: 0
[2023-07-20 12:58:16] [config] dropout-src: 0
[2023-07-20 12:58:16] [config] dropout-trg: 0
[2023-07-20 12:58:16] [config] dump-config: ""
[2023-07-20 12:58:16] [config] dynamic-gradient-scaling:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] early-stopping: 200
[2023-07-20 12:58:16] [config] early-stopping-on: first
[2023-07-20 12:58:16] [config] embedding-fix-src: false
[2023-07-20 12:58:16] [config] embedding-fix-trg: false
[2023-07-20 12:58:16] [config] embedding-normalization: false
[2023-07-20 12:58:16] [config] embedding-vectors:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] enc-cell: gru
[2023-07-20 12:58:16] [config] enc-cell-depth: 1
[2023-07-20 12:58:16] [config] enc-depth: 1
[2023-07-20 12:58:16] [config] enc-type: bidirectional
[2023-07-20 12:58:16] [config] english-title-case-every: 0
[2023-07-20 12:58:16] [config] exponential-smoothing: 0
[2023-07-20 12:58:16] [config] factor-weight: 1
[2023-07-20 12:58:16] [config] factors-combine: sum
[2023-07-20 12:58:16] [config] factors-dim-emb: 0
[2023-07-20 12:58:16] [config] gradient-checkpointing: false
[2023-07-20 12:58:16] [config] gradient-norm-average-window: 100
[2023-07-20 12:58:16] [config] guided-alignment: none
[2023-07-20 12:58:16] [config] guided-alignment-cost: mse
[2023-07-20 12:58:16] [config] guided-alignment-weight: 0.1
[2023-07-20 12:58:16] [config] ignore-model-config: false
[2023-07-20 12:58:16] [config] input-types:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] interpolate-env-vars: false
[2023-07-20 12:58:16] [config] keep-best: false
[2023-07-20 12:58:16] [config] label-smoothing: 0
[2023-07-20 12:58:16] [config] layer-normalization: false
[2023-07-20 12:58:16] [config] learn-rate: 0.0001
[2023-07-20 12:58:16] [config] lemma-dependency: ""
[2023-07-20 12:58:16] [config] lemma-dim-emb: 0
[2023-07-20 12:58:16] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 12:58:16] [config] log-level: info
[2023-07-20 12:58:16] [config] log-time-zone: ""
[2023-07-20 12:58:16] [config] logical-epoch:
[2023-07-20 12:58:16] [config]   - 1e
[2023-07-20 12:58:16] [config]   - 0
[2023-07-20 12:58:16] [config] lr-decay: 0
[2023-07-20 12:58:16] [config] lr-decay-freq: 50000
[2023-07-20 12:58:16] [config] lr-decay-inv-sqrt:
[2023-07-20 12:58:16] [config]   - 0
[2023-07-20 12:58:16] [config] lr-decay-repeat-warmup: false
[2023-07-20 12:58:16] [config] lr-decay-reset-optimizer: false
[2023-07-20 12:58:16] [config] lr-decay-start:
[2023-07-20 12:58:16] [config]   - 10
[2023-07-20 12:58:16] [config]   - 1
[2023-07-20 12:58:16] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 12:58:16] [config] lr-report: false
[2023-07-20 12:58:16] [config] lr-warmup: 0
[2023-07-20 12:58:16] [config] lr-warmup-at-reload: false
[2023-07-20 12:58:16] [config] lr-warmup-cycle: false
[2023-07-20 12:58:16] [config] lr-warmup-start-rate: 0
[2023-07-20 12:58:16] [config] max-length: 200
[2023-07-20 12:58:16] [config] max-length-crop: true
[2023-07-20 12:58:16] [config] max-length-factor: 3
[2023-07-20 12:58:16] [config] maxi-batch: 100
[2023-07-20 12:58:16] [config] maxi-batch-sort: trg
[2023-07-20 12:58:16] [config] mini-batch: 64
[2023-07-20 12:58:16] [config] mini-batch-fit: true
[2023-07-20 12:58:16] [config] mini-batch-fit-step: 10
[2023-07-20 12:58:16] [config] mini-batch-round-up: true
[2023-07-20 12:58:16] [config] mini-batch-track-lr: false
[2023-07-20 12:58:16] [config] mini-batch-warmup: 0
[2023-07-20 12:58:16] [config] mini-batch-words: 0
[2023-07-20 12:58:16] [config] mini-batch-words-ref: 0
[2023-07-20 12:58:16] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 12:58:16] [config] multi-loss-type: sum
[2023-07-20 12:58:16] [config] n-best: false
[2023-07-20 12:58:16] [config] no-nccl: false
[2023-07-20 12:58:16] [config] no-reload: false
[2023-07-20 12:58:16] [config] no-restore-corpus: false
[2023-07-20 12:58:16] [config] normalize: 0
[2023-07-20 12:58:16] [config] normalize-gradient: false
[2023-07-20 12:58:16] [config] num-devices: 0
[2023-07-20 12:58:16] [config] optimizer: adam
[2023-07-20 12:58:16] [config] optimizer-delay: 1
[2023-07-20 12:58:16] [config] optimizer-params:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] output-omit-bias: false
[2023-07-20 12:58:16] [config] overwrite: true
[2023-07-20 12:58:16] [config] precision:
[2023-07-20 12:58:16] [config]   - float16
[2023-07-20 12:58:16] [config]   - float32
[2023-07-20 12:58:16] [config] pretrained-model: ""
[2023-07-20 12:58:16] [config] quantize-biases: false
[2023-07-20 12:58:16] [config] quantize-bits: 0
[2023-07-20 12:58:16] [config] quantize-log-based: false
[2023-07-20 12:58:16] [config] quantize-optimization-steps: 0
[2023-07-20 12:58:16] [config] quiet: false
[2023-07-20 12:58:16] [config] quiet-translation: true
[2023-07-20 12:58:16] [config] relative-paths: false
[2023-07-20 12:58:16] [config] right-left: false
[2023-07-20 12:58:16] [config] save-freq: 10000u
[2023-07-20 12:58:16] [config] seed: 1234
[2023-07-20 12:58:16] [config] sentencepiece-alphas:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] sentencepiece-max-lines: 2000000
[2023-07-20 12:58:16] [config] sentencepiece-options: ""
[2023-07-20 12:58:16] [config] sharding: global
[2023-07-20 12:58:16] [config] shuffle: data
[2023-07-20 12:58:16] [config] shuffle-in-ram: false
[2023-07-20 12:58:16] [config] sigterm: save-and-exit
[2023-07-20 12:58:16] [config] skip: false
[2023-07-20 12:58:16] [config] sqlite: ""
[2023-07-20 12:58:16] [config] sqlite-drop: false
[2023-07-20 12:58:16] [config] sync-freq: 200u
[2023-07-20 12:58:16] [config] sync-sgd: false
[2023-07-20 12:58:16] [config] tempdir: /tmp
[2023-07-20 12:58:16] [config] tied-embeddings: false
[2023-07-20 12:58:16] [config] tied-embeddings-all: true
[2023-07-20 12:58:16] [config] tied-embeddings-src: false
[2023-07-20 12:58:16] [config] train-embedder-rank:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] train-sets:
[2023-07-20 12:58:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 12:58:16] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 12:58:16] [config] transformer-aan-activation: swish
[2023-07-20 12:58:16] [config] transformer-aan-depth: 2
[2023-07-20 12:58:16] [config] transformer-aan-nogate: false
[2023-07-20 12:58:16] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 12:58:16] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 12:58:16] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 12:58:16] [config] transformer-depth-scaling: false
[2023-07-20 12:58:16] [config] transformer-dim-aan: 2048
[2023-07-20 12:58:16] [config] transformer-dim-ffn: 2048
[2023-07-20 12:58:16] [config] transformer-dropout: 0
[2023-07-20 12:58:16] [config] transformer-dropout-attention: 0
[2023-07-20 12:58:16] [config] transformer-dropout-ffn: 0
[2023-07-20 12:58:16] [config] transformer-ffn-activation: swish
[2023-07-20 12:58:16] [config] transformer-ffn-depth: 2
[2023-07-20 12:58:16] [config] transformer-guided-alignment-layer: last
[2023-07-20 12:58:16] [config] transformer-heads: 8
[2023-07-20 12:58:16] [config] transformer-no-projection: false
[2023-07-20 12:58:16] [config] transformer-pool: false
[2023-07-20 12:58:16] [config] transformer-postprocess: dan
[2023-07-20 12:58:16] [config] transformer-postprocess-emb: d
[2023-07-20 12:58:16] [config] transformer-postprocess-top: ""
[2023-07-20 12:58:16] [config] transformer-preprocess: ""
[2023-07-20 12:58:16] [config] transformer-tied-layers:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] transformer-train-position-embeddings: false
[2023-07-20 12:58:16] [config] tsv: false
[2023-07-20 12:58:16] [config] tsv-fields: 0
[2023-07-20 12:58:16] [config] type: amun
[2023-07-20 12:58:16] [config] ulr: false
[2023-07-20 12:58:16] [config] ulr-dim-emb: 0
[2023-07-20 12:58:16] [config] ulr-dropout: 0
[2023-07-20 12:58:16] [config] ulr-keys-vectors: ""
[2023-07-20 12:58:16] [config] ulr-query-vectors: ""
[2023-07-20 12:58:16] [config] ulr-softmax-temperature: 1
[2023-07-20 12:58:16] [config] ulr-trainable-transformation: false
[2023-07-20 12:58:16] [config] unlikelihood-loss: false
[2023-07-20 12:58:16] [config] valid-freq: 50000000
[2023-07-20 12:58:16] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 12:58:16] [config] valid-max-length: 1000
[2023-07-20 12:58:16] [config] valid-metrics:
[2023-07-20 12:58:16] [config]   - cross-entropy
[2023-07-20 12:58:16] [config]   - translation
[2023-07-20 12:58:16] [config] valid-mini-batch: 32
[2023-07-20 12:58:16] [config] valid-reset-stalled: false
[2023-07-20 12:58:16] [config] valid-script-args:
[2023-07-20 12:58:16] [config]   []
[2023-07-20 12:58:16] [config] valid-script-path: ""
[2023-07-20 12:58:16] [config] valid-sets:
[2023-07-20 12:58:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 12:58:16] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 12:58:16] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 12:58:16] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 12:58:16] [config] vocabs:
[2023-07-20 12:58:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 12:58:16] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 12:58:16] [config] word-penalty: 0
[2023-07-20 12:58:16] [config] word-scores: false
[2023-07-20 12:58:16] [config] workspace: 5500
[2023-07-20 12:58:16] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 12:58:16] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 12:58:16] [training] Using single-device training
[2023-07-20 12:58:17] Synced seed 1234
[2023-07-20 12:58:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 12:58:17] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 12:58:17] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 12:58:17] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 12:58:17] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 12:58:17] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 12:58:17] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 12:58:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 12:58:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 12:58:18] [comm] Using global sharding
[2023-07-20 12:58:18] [comm] NCCLCommunicators constructed successfully
[2023-07-20 12:58:18] [training] Using 1 GPUs
[2023-07-20 12:58:18] [logits] Applying loss function for 1 factor(s)
[2023-07-20 12:58:18] [memory] Reserving 80 MB, device gpu0
[2023-07-20 12:58:18] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 12:58:18] [memory] Reserving 80 MB, device gpu0
[2023-07-20 13:38:50] [batching] Done. Typical MB size is 35,936 target words
[2023-07-20 13:38:50] [valid] No post-processing script given for validating translator
[2023-07-20 13:38:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 13:38:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 13:38:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 13:38:51] [comm] Using global sharding
[2023-07-20 13:38:51] [comm] NCCLCommunicators constructed successfully
[2023-07-20 13:38:51] [training] Using 1 GPUs
[2023-07-20 13:38:51] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 13:39:01] Allocating memory for general optimizer shards
[2023-07-20 13:39:01] [memory] Reserving 322 MB, device gpu0
[2023-07-20 13:39:01] Loading Adam parameters
[2023-07-20 13:39:01] [memory] Reserving 322 MB, device gpu0
[2023-07-20 13:39:01] [memory] Reserving 80 MB, device gpu0
[2023-07-20 13:39:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 13:39:01] [data] Restoring the corpus state to epoch 191, batch 7329
[2023-07-20 13:39:01] [data] Shuffling data
[2023-07-20 13:39:01] [data] Done reading 20,192 sentences
[2023-07-20 13:39:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 13:39:01] Training started
[2023-07-20 13:39:01] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 13:39:02] [memory] Reserving 80 MB, device gpu0
[2023-07-20 13:39:05] Parameter type float16, optimization type float32, casting types true
[2023-07-20 13:43:13] Seen 20,192 samples
[2023-07-20 13:43:13] Starting data epoch 192 in logical epoch 192
[2023-07-20 13:43:13] [data] Shuffling data
[2023-07-20 13:43:13] [data] Done reading 20,192 sentences
[2023-07-20 13:43:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 13:47:51] Seen 20,192 samples
[2023-07-20 13:47:51] Starting data epoch 193 in logical epoch 193
[2023-07-20 13:47:51] [data] Shuffling data
[2023-07-20 13:47:51] [data] Done reading 20,192 sentences
[2023-07-20 13:47:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 13:52:09] Seen 20,192 samples
[2023-07-20 13:52:09] Starting data epoch 194 in logical epoch 194
[2023-07-20 13:52:09] [data] Shuffling data
[2023-07-20 13:52:10] [data] Done reading 20,192 sentences
[2023-07-20 13:52:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 13:56:42] Seen 20,192 samples
[2023-07-20 13:56:42] Starting data epoch 195 in logical epoch 195
[2023-07-20 13:56:42] [data] Shuffling data
[2023-07-20 13:56:42] [data] Done reading 20,192 sentences
[2023-07-20 13:56:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 14:01:20] Seen 20,192 samples
[2023-07-20 14:01:20] Starting data epoch 196 in logical epoch 196
[2023-07-20 14:01:20] [data] Shuffling data
[2023-07-20 14:01:20] [data] Done reading 20,192 sentences
[2023-07-20 14:01:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 14:05:49] Seen 20,192 samples
[2023-07-20 14:05:49] Starting data epoch 197 in logical epoch 197
[2023-07-20 14:05:49] [data] Shuffling data
[2023-07-20 14:05:49] [data] Done reading 20,192 sentences
[2023-07-20 14:05:49] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 14:10:23] Seen 20,192 samples
[2023-07-20 14:10:23] Starting data epoch 198 in logical epoch 198
[2023-07-20 14:10:23] [data] Shuffling data
[2023-07-20 14:10:23] [data] Done reading 20,192 sentences
[2023-07-20 14:10:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 14:14:46] Seen 20,192 samples
[2023-07-20 14:14:46] Starting data epoch 199 in logical epoch 199
[2023-07-20 14:14:46] [data] Shuffling data
[2023-07-20 14:14:46] [data] Done reading 20,192 sentences
[2023-07-20 14:14:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 14:19:06] Seen 20,192 samples
[2023-07-20 14:19:06] Starting data epoch 200 in logical epoch 200
[2023-07-20 14:19:06] [data] Shuffling data
[2023-07-20 14:19:06] [data] Done reading 20,192 sentences
[2023-07-20 14:19:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 14:23:13] Seen 20,192 samples
[2023-07-20 14:23:13] Starting data epoch 201 in logical epoch 201
[2023-07-20 14:23:13] Training finished
[2023-07-20 14:23:27] [valid] Ep. 201 : Up. 7714 : cross-entropy : 129.156 : stalled 6 times (last best: 122.646)
[2023-07-20 14:25:47] [valid] Ep. 201 : Up. 7714 : translation : 0 : new best
[2023-07-20 14:25:47] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz
[2023-07-20 14:25:49] Saving Adam parameters
[2023-07-20 14:25:49] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_200.npz.optimizer.npz
[2023-07-20 14:25:57] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 14:25:57] [marian] Running on node18.datos.cluster.uy as process 28750 with command line:
[2023-07-20 14:25:57] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 14:25:57] [config] after: 0e
[2023-07-20 14:25:57] [config] after-batches: 0
[2023-07-20 14:25:57] [config] after-epochs: 10
[2023-07-20 14:25:57] [config] all-caps-every: 0
[2023-07-20 14:25:57] [config] allow-unk: false
[2023-07-20 14:25:57] [config] authors: false
[2023-07-20 14:25:57] [config] beam-size: 12
[2023-07-20 14:25:57] [config] bert-class-symbol: "[CLS]"
[2023-07-20 14:25:57] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 14:25:57] [config] bert-masking-fraction: 0.15
[2023-07-20 14:25:57] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 14:25:57] [config] bert-train-type-embeddings: true
[2023-07-20 14:25:57] [config] bert-type-vocab-size: 2
[2023-07-20 14:25:57] [config] build-info: ""
[2023-07-20 14:25:57] [config] check-gradient-nan: false
[2023-07-20 14:25:57] [config] check-nan: false
[2023-07-20 14:25:57] [config] cite: false
[2023-07-20 14:25:57] [config] clip-norm: 1
[2023-07-20 14:25:57] [config] cost-scaling:
[2023-07-20 14:25:57] [config]   - 256.f
[2023-07-20 14:25:57] [config]   - 1000
[2023-07-20 14:25:57] [config]   - 2.f
[2023-07-20 14:25:57] [config]   - 256.f
[2023-07-20 14:25:57] [config] cost-type: ce-sum
[2023-07-20 14:25:57] [config] cpu-threads: 0
[2023-07-20 14:25:57] [config] data-threads: 8
[2023-07-20 14:25:57] [config] data-weighting: ""
[2023-07-20 14:25:57] [config] data-weighting-type: sentence
[2023-07-20 14:25:57] [config] dec-cell: gru
[2023-07-20 14:25:57] [config] dec-cell-base-depth: 2
[2023-07-20 14:25:57] [config] dec-cell-high-depth: 1
[2023-07-20 14:25:57] [config] dec-depth: 1
[2023-07-20 14:25:57] [config] devices:
[2023-07-20 14:25:57] [config]   - 0
[2023-07-20 14:25:57] [config] dim-emb: 512
[2023-07-20 14:25:57] [config] dim-rnn: 1024
[2023-07-20 14:25:57] [config] dim-vocabs:
[2023-07-20 14:25:57] [config]   - 16384
[2023-07-20 14:25:57] [config]   - 16384
[2023-07-20 14:25:57] [config] disp-first: 0
[2023-07-20 14:25:57] [config] disp-freq: 1000u
[2023-07-20 14:25:57] [config] disp-label-counts: true
[2023-07-20 14:25:57] [config] dropout-rnn: 0
[2023-07-20 14:25:57] [config] dropout-src: 0
[2023-07-20 14:25:57] [config] dropout-trg: 0
[2023-07-20 14:25:57] [config] dump-config: ""
[2023-07-20 14:25:57] [config] dynamic-gradient-scaling:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] early-stopping: 200
[2023-07-20 14:25:57] [config] early-stopping-on: first
[2023-07-20 14:25:57] [config] embedding-fix-src: false
[2023-07-20 14:25:57] [config] embedding-fix-trg: false
[2023-07-20 14:25:57] [config] embedding-normalization: false
[2023-07-20 14:25:57] [config] embedding-vectors:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] enc-cell: gru
[2023-07-20 14:25:57] [config] enc-cell-depth: 1
[2023-07-20 14:25:57] [config] enc-depth: 1
[2023-07-20 14:25:57] [config] enc-type: bidirectional
[2023-07-20 14:25:57] [config] english-title-case-every: 0
[2023-07-20 14:25:57] [config] exponential-smoothing: 0
[2023-07-20 14:25:57] [config] factor-weight: 1
[2023-07-20 14:25:57] [config] factors-combine: sum
[2023-07-20 14:25:57] [config] factors-dim-emb: 0
[2023-07-20 14:25:57] [config] gradient-checkpointing: false
[2023-07-20 14:25:57] [config] gradient-norm-average-window: 100
[2023-07-20 14:25:57] [config] guided-alignment: none
[2023-07-20 14:25:57] [config] guided-alignment-cost: mse
[2023-07-20 14:25:57] [config] guided-alignment-weight: 0.1
[2023-07-20 14:25:57] [config] ignore-model-config: false
[2023-07-20 14:25:57] [config] input-types:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] interpolate-env-vars: false
[2023-07-20 14:25:57] [config] keep-best: false
[2023-07-20 14:25:57] [config] label-smoothing: 0
[2023-07-20 14:25:57] [config] layer-normalization: false
[2023-07-20 14:25:57] [config] learn-rate: 0.0001
[2023-07-20 14:25:57] [config] lemma-dependency: ""
[2023-07-20 14:25:57] [config] lemma-dim-emb: 0
[2023-07-20 14:25:57] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 14:25:57] [config] log-level: info
[2023-07-20 14:25:57] [config] log-time-zone: ""
[2023-07-20 14:25:57] [config] logical-epoch:
[2023-07-20 14:25:57] [config]   - 1e
[2023-07-20 14:25:57] [config]   - 0
[2023-07-20 14:25:57] [config] lr-decay: 0
[2023-07-20 14:25:57] [config] lr-decay-freq: 50000
[2023-07-20 14:25:57] [config] lr-decay-inv-sqrt:
[2023-07-20 14:25:57] [config]   - 0
[2023-07-20 14:25:57] [config] lr-decay-repeat-warmup: false
[2023-07-20 14:25:57] [config] lr-decay-reset-optimizer: false
[2023-07-20 14:25:57] [config] lr-decay-start:
[2023-07-20 14:25:57] [config]   - 10
[2023-07-20 14:25:57] [config]   - 1
[2023-07-20 14:25:57] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 14:25:57] [config] lr-report: false
[2023-07-20 14:25:57] [config] lr-warmup: 0
[2023-07-20 14:25:57] [config] lr-warmup-at-reload: false
[2023-07-20 14:25:57] [config] lr-warmup-cycle: false
[2023-07-20 14:25:57] [config] lr-warmup-start-rate: 0
[2023-07-20 14:25:57] [config] max-length: 250
[2023-07-20 14:25:57] [config] max-length-crop: true
[2023-07-20 14:25:57] [config] max-length-factor: 3
[2023-07-20 14:25:57] [config] maxi-batch: 100
[2023-07-20 14:25:57] [config] maxi-batch-sort: trg
[2023-07-20 14:25:57] [config] mini-batch: 64
[2023-07-20 14:25:57] [config] mini-batch-fit: true
[2023-07-20 14:25:57] [config] mini-batch-fit-step: 10
[2023-07-20 14:25:57] [config] mini-batch-round-up: true
[2023-07-20 14:25:57] [config] mini-batch-track-lr: false
[2023-07-20 14:25:57] [config] mini-batch-warmup: 0
[2023-07-20 14:25:57] [config] mini-batch-words: 0
[2023-07-20 14:25:57] [config] mini-batch-words-ref: 0
[2023-07-20 14:25:57] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 14:25:57] [config] multi-loss-type: sum
[2023-07-20 14:25:57] [config] n-best: false
[2023-07-20 14:25:57] [config] no-nccl: false
[2023-07-20 14:25:57] [config] no-reload: false
[2023-07-20 14:25:57] [config] no-restore-corpus: false
[2023-07-20 14:25:57] [config] normalize: 0
[2023-07-20 14:25:57] [config] normalize-gradient: false
[2023-07-20 14:25:57] [config] num-devices: 0
[2023-07-20 14:25:57] [config] optimizer: adam
[2023-07-20 14:25:57] [config] optimizer-delay: 1
[2023-07-20 14:25:57] [config] optimizer-params:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] output-omit-bias: false
[2023-07-20 14:25:57] [config] overwrite: true
[2023-07-20 14:25:57] [config] precision:
[2023-07-20 14:25:57] [config]   - float16
[2023-07-20 14:25:57] [config]   - float32
[2023-07-20 14:25:57] [config] pretrained-model: ""
[2023-07-20 14:25:57] [config] quantize-biases: false
[2023-07-20 14:25:57] [config] quantize-bits: 0
[2023-07-20 14:25:57] [config] quantize-log-based: false
[2023-07-20 14:25:57] [config] quantize-optimization-steps: 0
[2023-07-20 14:25:57] [config] quiet: false
[2023-07-20 14:25:57] [config] quiet-translation: true
[2023-07-20 14:25:57] [config] relative-paths: false
[2023-07-20 14:25:57] [config] right-left: false
[2023-07-20 14:25:57] [config] save-freq: 10000u
[2023-07-20 14:25:57] [config] seed: 1234
[2023-07-20 14:25:57] [config] sentencepiece-alphas:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] sentencepiece-max-lines: 2000000
[2023-07-20 14:25:57] [config] sentencepiece-options: ""
[2023-07-20 14:25:57] [config] sharding: global
[2023-07-20 14:25:57] [config] shuffle: data
[2023-07-20 14:25:57] [config] shuffle-in-ram: false
[2023-07-20 14:25:57] [config] sigterm: save-and-exit
[2023-07-20 14:25:57] [config] skip: false
[2023-07-20 14:25:57] [config] sqlite: ""
[2023-07-20 14:25:57] [config] sqlite-drop: false
[2023-07-20 14:25:57] [config] sync-freq: 200u
[2023-07-20 14:25:57] [config] sync-sgd: false
[2023-07-20 14:25:57] [config] tempdir: /tmp
[2023-07-20 14:25:57] [config] tied-embeddings: false
[2023-07-20 14:25:57] [config] tied-embeddings-all: true
[2023-07-20 14:25:57] [config] tied-embeddings-src: false
[2023-07-20 14:25:57] [config] train-embedder-rank:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] train-sets:
[2023-07-20 14:25:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 14:25:57] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 14:25:57] [config] transformer-aan-activation: swish
[2023-07-20 14:25:57] [config] transformer-aan-depth: 2
[2023-07-20 14:25:57] [config] transformer-aan-nogate: false
[2023-07-20 14:25:57] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 14:25:57] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 14:25:57] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 14:25:57] [config] transformer-depth-scaling: false
[2023-07-20 14:25:57] [config] transformer-dim-aan: 2048
[2023-07-20 14:25:57] [config] transformer-dim-ffn: 2048
[2023-07-20 14:25:57] [config] transformer-dropout: 0
[2023-07-20 14:25:57] [config] transformer-dropout-attention: 0
[2023-07-20 14:25:57] [config] transformer-dropout-ffn: 0
[2023-07-20 14:25:57] [config] transformer-ffn-activation: swish
[2023-07-20 14:25:57] [config] transformer-ffn-depth: 2
[2023-07-20 14:25:57] [config] transformer-guided-alignment-layer: last
[2023-07-20 14:25:57] [config] transformer-heads: 8
[2023-07-20 14:25:57] [config] transformer-no-projection: false
[2023-07-20 14:25:57] [config] transformer-pool: false
[2023-07-20 14:25:57] [config] transformer-postprocess: dan
[2023-07-20 14:25:57] [config] transformer-postprocess-emb: d
[2023-07-20 14:25:57] [config] transformer-postprocess-top: ""
[2023-07-20 14:25:57] [config] transformer-preprocess: ""
[2023-07-20 14:25:57] [config] transformer-tied-layers:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] transformer-train-position-embeddings: false
[2023-07-20 14:25:57] [config] tsv: false
[2023-07-20 14:25:57] [config] tsv-fields: 0
[2023-07-20 14:25:57] [config] type: amun
[2023-07-20 14:25:57] [config] ulr: false
[2023-07-20 14:25:57] [config] ulr-dim-emb: 0
[2023-07-20 14:25:57] [config] ulr-dropout: 0
[2023-07-20 14:25:57] [config] ulr-keys-vectors: ""
[2023-07-20 14:25:57] [config] ulr-query-vectors: ""
[2023-07-20 14:25:57] [config] ulr-softmax-temperature: 1
[2023-07-20 14:25:57] [config] ulr-trainable-transformation: false
[2023-07-20 14:25:57] [config] unlikelihood-loss: false
[2023-07-20 14:25:57] [config] valid-freq: 50000000
[2023-07-20 14:25:57] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 14:25:57] [config] valid-max-length: 1000
[2023-07-20 14:25:57] [config] valid-metrics:
[2023-07-20 14:25:57] [config]   - cross-entropy
[2023-07-20 14:25:57] [config]   - translation
[2023-07-20 14:25:57] [config] valid-mini-batch: 32
[2023-07-20 14:25:57] [config] valid-reset-stalled: false
[2023-07-20 14:25:57] [config] valid-script-args:
[2023-07-20 14:25:57] [config]   []
[2023-07-20 14:25:57] [config] valid-script-path: ""
[2023-07-20 14:25:57] [config] valid-sets:
[2023-07-20 14:25:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 14:25:57] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 14:25:57] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 14:25:57] [config] vocabs:
[2023-07-20 14:25:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 14:25:57] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 14:25:57] [config] word-penalty: 0
[2023-07-20 14:25:57] [config] word-scores: false
[2023-07-20 14:25:57] [config] workspace: 5500
[2023-07-20 14:25:57] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 14:25:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 14:25:57] [training] Using single-device training
[2023-07-20 14:25:57] Synced seed 1234
[2023-07-20 14:25:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 14:25:57] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 14:25:57] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 14:25:57] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 14:25:57] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 14:25:57] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 14:25:57] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 14:25:58] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 14:25:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 14:25:58] [comm] Using global sharding
[2023-07-20 14:25:58] [comm] NCCLCommunicators constructed successfully
[2023-07-20 14:25:58] [training] Using 1 GPUs
[2023-07-20 14:25:58] [logits] Applying loss function for 1 factor(s)
[2023-07-20 14:25:58] [memory] Reserving 80 MB, device gpu0
[2023-07-20 14:25:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 14:25:59] [memory] Reserving 80 MB, device gpu0
[2023-07-20 15:17:45] [batching] Done. Typical MB size is 35,869 target words
[2023-07-20 15:17:45] [valid] No post-processing script given for validating translator
[2023-07-20 15:17:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 15:17:45] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 15:17:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 15:17:45] [comm] Using global sharding
[2023-07-20 15:17:46] [comm] NCCLCommunicators constructed successfully
[2023-07-20 15:17:46] [training] Using 1 GPUs
[2023-07-20 15:17:46] Training started
[2023-07-20 15:17:46] [data] Shuffling data
[2023-07-20 15:17:46] [data] Done reading 20,192 sentences
[2023-07-20 15:17:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:17:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 15:17:46] [memory] Reserving 80 MB, device gpu0
[2023-07-20 15:17:47] [memory] Reserving 80 MB, device gpu0
[2023-07-20 15:17:55] Parameter type float16, optimization type float32, casting types true
[2023-07-20 15:17:55] Allocating memory for general optimizer shards
[2023-07-20 15:17:55] [memory] Reserving 322 MB, device gpu0
[2023-07-20 15:17:55] Allocating memory for Adam-specific shards
[2023-07-20 15:17:55] [memory] Reserving 322 MB, device gpu0
[2023-07-20 15:21:49] Seen 20,192 samples
[2023-07-20 15:21:49] Starting data epoch 2 in logical epoch 2
[2023-07-20 15:21:49] [data] Shuffling data
[2023-07-20 15:21:50] [data] Done reading 20,192 sentences
[2023-07-20 15:21:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:27:13] Seen 20,192 samples
[2023-07-20 15:27:13] Starting data epoch 3 in logical epoch 3
[2023-07-20 15:27:13] [data] Shuffling data
[2023-07-20 15:27:13] [data] Done reading 20,192 sentences
[2023-07-20 15:27:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:32:34] Seen 20,192 samples
[2023-07-20 15:32:34] Starting data epoch 4 in logical epoch 4
[2023-07-20 15:32:34] [data] Shuffling data
[2023-07-20 15:32:34] [data] Done reading 20,192 sentences
[2023-07-20 15:32:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:37:20] Seen 20,192 samples
[2023-07-20 15:37:20] Starting data epoch 5 in logical epoch 5
[2023-07-20 15:37:20] [data] Shuffling data
[2023-07-20 15:37:20] [data] Done reading 20,192 sentences
[2023-07-20 15:37:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:42:21] Seen 20,192 samples
[2023-07-20 15:42:21] Starting data epoch 6 in logical epoch 6
[2023-07-20 15:42:21] [data] Shuffling data
[2023-07-20 15:42:21] [data] Done reading 20,192 sentences
[2023-07-20 15:42:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:47:18] Seen 20,192 samples
[2023-07-20 15:47:18] Starting data epoch 7 in logical epoch 7
[2023-07-20 15:47:18] [data] Shuffling data
[2023-07-20 15:47:18] [data] Done reading 20,192 sentences
[2023-07-20 15:47:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:52:21] Seen 20,192 samples
[2023-07-20 15:52:21] Starting data epoch 8 in logical epoch 8
[2023-07-20 15:52:21] [data] Shuffling data
[2023-07-20 15:52:21] [data] Done reading 20,192 sentences
[2023-07-20 15:52:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 15:57:34] Seen 20,192 samples
[2023-07-20 15:57:34] Starting data epoch 9 in logical epoch 9
[2023-07-20 15:57:34] [data] Shuffling data
[2023-07-20 15:57:34] [data] Done reading 20,192 sentences
[2023-07-20 15:57:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 16:02:45] Seen 20,192 samples
[2023-07-20 16:02:45] Starting data epoch 10 in logical epoch 10
[2023-07-20 16:02:45] [data] Shuffling data
[2023-07-20 16:02:45] [data] Done reading 20,192 sentences
[2023-07-20 16:02:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 16:07:47] Seen 20,192 samples
[2023-07-20 16:07:47] Starting data epoch 11 in logical epoch 11
[2023-07-20 16:07:47] Training finished
[2023-07-20 16:08:00] [valid] Ep. 11 : Up. 388 : cross-entropy : 186.016 : new best
[2023-07-20 16:10:35] [valid] Ep. 11 : Up. 388 : translation : 0 : new best
[2023-07-20 16:10:35] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 16:10:38] Saving Adam parameters
[2023-07-20 16:10:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 16:10:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:10:44] [marian] Running on node18.datos.cluster.uy as process 35433 with command line:
[2023-07-20 16:10:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 16:10:44] [config] after: 0e
[2023-07-20 16:10:44] [config] after-batches: 0
[2023-07-20 16:10:44] [config] after-epochs: 20
[2023-07-20 16:10:44] [config] all-caps-every: 0
[2023-07-20 16:10:44] [config] allow-unk: false
[2023-07-20 16:10:44] [config] authors: false
[2023-07-20 16:10:44] [config] beam-size: 12
[2023-07-20 16:10:44] [config] bert-class-symbol: "[CLS]"
[2023-07-20 16:10:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 16:10:44] [config] bert-masking-fraction: 0.15
[2023-07-20 16:10:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 16:10:44] [config] bert-train-type-embeddings: true
[2023-07-20 16:10:44] [config] bert-type-vocab-size: 2
[2023-07-20 16:10:44] [config] build-info: ""
[2023-07-20 16:10:44] [config] check-gradient-nan: false
[2023-07-20 16:10:44] [config] check-nan: false
[2023-07-20 16:10:44] [config] cite: false
[2023-07-20 16:10:44] [config] clip-norm: 1
[2023-07-20 16:10:44] [config] cost-scaling:
[2023-07-20 16:10:44] [config]   - 256.f
[2023-07-20 16:10:44] [config]   - 1000
[2023-07-20 16:10:44] [config]   - 2.f
[2023-07-20 16:10:44] [config]   - 256.f
[2023-07-20 16:10:44] [config] cost-type: ce-sum
[2023-07-20 16:10:44] [config] cpu-threads: 0
[2023-07-20 16:10:44] [config] data-threads: 8
[2023-07-20 16:10:44] [config] data-weighting: ""
[2023-07-20 16:10:44] [config] data-weighting-type: sentence
[2023-07-20 16:10:44] [config] dec-cell: gru
[2023-07-20 16:10:44] [config] dec-cell-base-depth: 2
[2023-07-20 16:10:44] [config] dec-cell-high-depth: 1
[2023-07-20 16:10:44] [config] dec-depth: 1
[2023-07-20 16:10:44] [config] devices:
[2023-07-20 16:10:44] [config]   - 0
[2023-07-20 16:10:44] [config] dim-emb: 512
[2023-07-20 16:10:44] [config] dim-rnn: 1024
[2023-07-20 16:10:44] [config] dim-vocabs:
[2023-07-20 16:10:44] [config]   - 16384
[2023-07-20 16:10:44] [config]   - 16384
[2023-07-20 16:10:44] [config] disp-first: 0
[2023-07-20 16:10:44] [config] disp-freq: 1000u
[2023-07-20 16:10:44] [config] disp-label-counts: true
[2023-07-20 16:10:44] [config] dropout-rnn: 0
[2023-07-20 16:10:44] [config] dropout-src: 0
[2023-07-20 16:10:44] [config] dropout-trg: 0
[2023-07-20 16:10:44] [config] dump-config: ""
[2023-07-20 16:10:44] [config] dynamic-gradient-scaling:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] early-stopping: 200
[2023-07-20 16:10:44] [config] early-stopping-on: first
[2023-07-20 16:10:44] [config] embedding-fix-src: false
[2023-07-20 16:10:44] [config] embedding-fix-trg: false
[2023-07-20 16:10:44] [config] embedding-normalization: false
[2023-07-20 16:10:44] [config] embedding-vectors:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] enc-cell: gru
[2023-07-20 16:10:44] [config] enc-cell-depth: 1
[2023-07-20 16:10:44] [config] enc-depth: 1
[2023-07-20 16:10:44] [config] enc-type: bidirectional
[2023-07-20 16:10:44] [config] english-title-case-every: 0
[2023-07-20 16:10:44] [config] exponential-smoothing: 0
[2023-07-20 16:10:44] [config] factor-weight: 1
[2023-07-20 16:10:44] [config] factors-combine: sum
[2023-07-20 16:10:44] [config] factors-dim-emb: 0
[2023-07-20 16:10:44] [config] gradient-checkpointing: false
[2023-07-20 16:10:44] [config] gradient-norm-average-window: 100
[2023-07-20 16:10:44] [config] guided-alignment: none
[2023-07-20 16:10:44] [config] guided-alignment-cost: mse
[2023-07-20 16:10:44] [config] guided-alignment-weight: 0.1
[2023-07-20 16:10:44] [config] ignore-model-config: false
[2023-07-20 16:10:44] [config] input-types:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] interpolate-env-vars: false
[2023-07-20 16:10:44] [config] keep-best: false
[2023-07-20 16:10:44] [config] label-smoothing: 0
[2023-07-20 16:10:44] [config] layer-normalization: false
[2023-07-20 16:10:44] [config] learn-rate: 0.0001
[2023-07-20 16:10:44] [config] lemma-dependency: ""
[2023-07-20 16:10:44] [config] lemma-dim-emb: 0
[2023-07-20 16:10:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 16:10:44] [config] log-level: info
[2023-07-20 16:10:44] [config] log-time-zone: ""
[2023-07-20 16:10:44] [config] logical-epoch:
[2023-07-20 16:10:44] [config]   - 1e
[2023-07-20 16:10:44] [config]   - 0
[2023-07-20 16:10:44] [config] lr-decay: 0
[2023-07-20 16:10:44] [config] lr-decay-freq: 50000
[2023-07-20 16:10:44] [config] lr-decay-inv-sqrt:
[2023-07-20 16:10:44] [config]   - 0
[2023-07-20 16:10:44] [config] lr-decay-repeat-warmup: false
[2023-07-20 16:10:44] [config] lr-decay-reset-optimizer: false
[2023-07-20 16:10:44] [config] lr-decay-start:
[2023-07-20 16:10:44] [config]   - 10
[2023-07-20 16:10:44] [config]   - 1
[2023-07-20 16:10:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 16:10:44] [config] lr-report: false
[2023-07-20 16:10:44] [config] lr-warmup: 0
[2023-07-20 16:10:44] [config] lr-warmup-at-reload: false
[2023-07-20 16:10:44] [config] lr-warmup-cycle: false
[2023-07-20 16:10:44] [config] lr-warmup-start-rate: 0
[2023-07-20 16:10:44] [config] max-length: 250
[2023-07-20 16:10:44] [config] max-length-crop: true
[2023-07-20 16:10:44] [config] max-length-factor: 3
[2023-07-20 16:10:44] [config] maxi-batch: 100
[2023-07-20 16:10:44] [config] maxi-batch-sort: trg
[2023-07-20 16:10:44] [config] mini-batch: 64
[2023-07-20 16:10:44] [config] mini-batch-fit: true
[2023-07-20 16:10:44] [config] mini-batch-fit-step: 10
[2023-07-20 16:10:44] [config] mini-batch-round-up: true
[2023-07-20 16:10:44] [config] mini-batch-track-lr: false
[2023-07-20 16:10:44] [config] mini-batch-warmup: 0
[2023-07-20 16:10:44] [config] mini-batch-words: 0
[2023-07-20 16:10:44] [config] mini-batch-words-ref: 0
[2023-07-20 16:10:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 16:10:44] [config] multi-loss-type: sum
[2023-07-20 16:10:44] [config] n-best: false
[2023-07-20 16:10:44] [config] no-nccl: false
[2023-07-20 16:10:44] [config] no-reload: false
[2023-07-20 16:10:44] [config] no-restore-corpus: false
[2023-07-20 16:10:44] [config] normalize: 0
[2023-07-20 16:10:44] [config] normalize-gradient: false
[2023-07-20 16:10:44] [config] num-devices: 0
[2023-07-20 16:10:44] [config] optimizer: adam
[2023-07-20 16:10:44] [config] optimizer-delay: 1
[2023-07-20 16:10:44] [config] optimizer-params:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] output-omit-bias: false
[2023-07-20 16:10:44] [config] overwrite: true
[2023-07-20 16:10:44] [config] precision:
[2023-07-20 16:10:44] [config]   - float16
[2023-07-20 16:10:44] [config]   - float32
[2023-07-20 16:10:44] [config] pretrained-model: ""
[2023-07-20 16:10:44] [config] quantize-biases: false
[2023-07-20 16:10:44] [config] quantize-bits: 0
[2023-07-20 16:10:44] [config] quantize-log-based: false
[2023-07-20 16:10:44] [config] quantize-optimization-steps: 0
[2023-07-20 16:10:44] [config] quiet: false
[2023-07-20 16:10:44] [config] quiet-translation: true
[2023-07-20 16:10:44] [config] relative-paths: false
[2023-07-20 16:10:44] [config] right-left: false
[2023-07-20 16:10:44] [config] save-freq: 10000u
[2023-07-20 16:10:44] [config] seed: 1234
[2023-07-20 16:10:44] [config] sentencepiece-alphas:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] sentencepiece-max-lines: 2000000
[2023-07-20 16:10:44] [config] sentencepiece-options: ""
[2023-07-20 16:10:44] [config] sharding: global
[2023-07-20 16:10:44] [config] shuffle: data
[2023-07-20 16:10:44] [config] shuffle-in-ram: false
[2023-07-20 16:10:44] [config] sigterm: save-and-exit
[2023-07-20 16:10:44] [config] skip: false
[2023-07-20 16:10:44] [config] sqlite: ""
[2023-07-20 16:10:44] [config] sqlite-drop: false
[2023-07-20 16:10:44] [config] sync-freq: 200u
[2023-07-20 16:10:44] [config] sync-sgd: false
[2023-07-20 16:10:44] [config] tempdir: /tmp
[2023-07-20 16:10:44] [config] tied-embeddings: false
[2023-07-20 16:10:44] [config] tied-embeddings-all: true
[2023-07-20 16:10:44] [config] tied-embeddings-src: false
[2023-07-20 16:10:44] [config] train-embedder-rank:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] train-sets:
[2023-07-20 16:10:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 16:10:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 16:10:44] [config] transformer-aan-activation: swish
[2023-07-20 16:10:44] [config] transformer-aan-depth: 2
[2023-07-20 16:10:44] [config] transformer-aan-nogate: false
[2023-07-20 16:10:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 16:10:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 16:10:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 16:10:44] [config] transformer-depth-scaling: false
[2023-07-20 16:10:44] [config] transformer-dim-aan: 2048
[2023-07-20 16:10:44] [config] transformer-dim-ffn: 2048
[2023-07-20 16:10:44] [config] transformer-dropout: 0
[2023-07-20 16:10:44] [config] transformer-dropout-attention: 0
[2023-07-20 16:10:44] [config] transformer-dropout-ffn: 0
[2023-07-20 16:10:44] [config] transformer-ffn-activation: swish
[2023-07-20 16:10:44] [config] transformer-ffn-depth: 2
[2023-07-20 16:10:44] [config] transformer-guided-alignment-layer: last
[2023-07-20 16:10:44] [config] transformer-heads: 8
[2023-07-20 16:10:44] [config] transformer-no-projection: false
[2023-07-20 16:10:44] [config] transformer-pool: false
[2023-07-20 16:10:44] [config] transformer-postprocess: dan
[2023-07-20 16:10:44] [config] transformer-postprocess-emb: d
[2023-07-20 16:10:44] [config] transformer-postprocess-top: ""
[2023-07-20 16:10:44] [config] transformer-preprocess: ""
[2023-07-20 16:10:44] [config] transformer-tied-layers:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] transformer-train-position-embeddings: false
[2023-07-20 16:10:44] [config] tsv: false
[2023-07-20 16:10:44] [config] tsv-fields: 0
[2023-07-20 16:10:44] [config] type: amun
[2023-07-20 16:10:44] [config] ulr: false
[2023-07-20 16:10:44] [config] ulr-dim-emb: 0
[2023-07-20 16:10:44] [config] ulr-dropout: 0
[2023-07-20 16:10:44] [config] ulr-keys-vectors: ""
[2023-07-20 16:10:44] [config] ulr-query-vectors: ""
[2023-07-20 16:10:44] [config] ulr-softmax-temperature: 1
[2023-07-20 16:10:44] [config] ulr-trainable-transformation: false
[2023-07-20 16:10:44] [config] unlikelihood-loss: false
[2023-07-20 16:10:44] [config] valid-freq: 50000000
[2023-07-20 16:10:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 16:10:44] [config] valid-max-length: 1000
[2023-07-20 16:10:44] [config] valid-metrics:
[2023-07-20 16:10:44] [config]   - cross-entropy
[2023-07-20 16:10:44] [config]   - translation
[2023-07-20 16:10:44] [config] valid-mini-batch: 32
[2023-07-20 16:10:44] [config] valid-reset-stalled: false
[2023-07-20 16:10:44] [config] valid-script-args:
[2023-07-20 16:10:44] [config]   []
[2023-07-20 16:10:44] [config] valid-script-path: ""
[2023-07-20 16:10:44] [config] valid-sets:
[2023-07-20 16:10:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 16:10:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 16:10:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 16:10:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:10:44] [config] vocabs:
[2023-07-20 16:10:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:10:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:10:44] [config] word-penalty: 0
[2023-07-20 16:10:44] [config] word-scores: false
[2023-07-20 16:10:44] [config] workspace: 5500
[2023-07-20 16:10:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 16:10:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:10:44] [training] Using single-device training
[2023-07-20 16:10:44] Synced seed 1234
[2023-07-20 16:10:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 16:10:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 16:10:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 16:10:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 16:10:44] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 16:10:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 16:10:44] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 16:10:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 16:10:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 16:10:46] [comm] Using global sharding
[2023-07-20 16:10:46] [comm] NCCLCommunicators constructed successfully
[2023-07-20 16:10:46] [training] Using 1 GPUs
[2023-07-20 16:10:46] [logits] Applying loss function for 1 factor(s)
[2023-07-20 16:10:46] [memory] Reserving 80 MB, device gpu0
[2023-07-20 16:10:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 16:10:46] [memory] Reserving 80 MB, device gpu0
[2023-07-20 17:02:29] [batching] Done. Typical MB size is 35,869 target words
[2023-07-20 17:02:29] [valid] No post-processing script given for validating translator
[2023-07-20 17:02:29] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 17:02:29] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 17:02:29] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 17:02:29] [comm] Using global sharding
[2023-07-20 17:02:30] [comm] NCCLCommunicators constructed successfully
[2023-07-20 17:02:30] [training] Using 1 GPUs
[2023-07-20 17:02:30] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 17:02:36] Allocating memory for general optimizer shards
[2023-07-20 17:02:36] [memory] Reserving 322 MB, device gpu0
[2023-07-20 17:02:36] Loading Adam parameters
[2023-07-20 17:02:36] [memory] Reserving 322 MB, device gpu0
[2023-07-20 17:02:37] [memory] Reserving 80 MB, device gpu0
[2023-07-20 17:02:37] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 17:02:37] [data] Restoring the corpus state to epoch 11, batch 388
[2023-07-20 17:02:37] [data] Shuffling data
[2023-07-20 17:02:37] [data] Done reading 20,192 sentences
[2023-07-20 17:02:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:02:37] Training started
[2023-07-20 17:02:37] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 17:02:37] [memory] Reserving 80 MB, device gpu0
[2023-07-20 17:02:42] Parameter type float16, optimization type float32, casting types true
[2023-07-20 17:07:33] Seen 20,192 samples
[2023-07-20 17:07:33] Starting data epoch 12 in logical epoch 12
[2023-07-20 17:07:33] [data] Shuffling data
[2023-07-20 17:07:34] [data] Done reading 20,192 sentences
[2023-07-20 17:07:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:12:35] Seen 20,192 samples
[2023-07-20 17:12:35] Starting data epoch 13 in logical epoch 13
[2023-07-20 17:12:35] [data] Shuffling data
[2023-07-20 17:12:35] [data] Done reading 20,192 sentences
[2023-07-20 17:12:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:17:39] Seen 20,192 samples
[2023-07-20 17:17:39] Starting data epoch 14 in logical epoch 14
[2023-07-20 17:17:39] [data] Shuffling data
[2023-07-20 17:17:39] [data] Done reading 20,192 sentences
[2023-07-20 17:17:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:22:57] Seen 20,192 samples
[2023-07-20 17:22:57] Starting data epoch 15 in logical epoch 15
[2023-07-20 17:22:57] [data] Shuffling data
[2023-07-20 17:22:57] [data] Done reading 20,192 sentences
[2023-07-20 17:22:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:28:07] Seen 20,192 samples
[2023-07-20 17:28:07] Starting data epoch 16 in logical epoch 16
[2023-07-20 17:28:07] [data] Shuffling data
[2023-07-20 17:28:07] [data] Done reading 20,192 sentences
[2023-07-20 17:28:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:33:20] Seen 20,192 samples
[2023-07-20 17:33:20] Starting data epoch 17 in logical epoch 17
[2023-07-20 17:33:20] [data] Shuffling data
[2023-07-20 17:33:20] [data] Done reading 20,192 sentences
[2023-07-20 17:33:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:38:24] Seen 20,192 samples
[2023-07-20 17:38:24] Starting data epoch 18 in logical epoch 18
[2023-07-20 17:38:24] [data] Shuffling data
[2023-07-20 17:38:24] [data] Done reading 20,192 sentences
[2023-07-20 17:38:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:41:54] Seen 20,192 samples
[2023-07-20 17:41:54] Starting data epoch 19 in logical epoch 19
[2023-07-20 17:41:54] [data] Shuffling data
[2023-07-20 17:41:54] [data] Done reading 20,192 sentences
[2023-07-20 17:41:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:45:35] Seen 20,192 samples
[2023-07-20 17:45:35] Starting data epoch 20 in logical epoch 20
[2023-07-20 17:45:35] [data] Shuffling data
[2023-07-20 17:45:35] [data] Done reading 20,192 sentences
[2023-07-20 17:45:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 17:49:09] Seen 20,192 samples
[2023-07-20 17:49:09] Starting data epoch 21 in logical epoch 21
[2023-07-20 17:49:09] Training finished
[2023-07-20 17:49:20] [valid] Ep. 21 : Up. 774 : cross-entropy : 173.427 : new best
[2023-07-20 17:52:32] [valid] Ep. 21 : Up. 774 : translation : 0 : new best
[2023-07-20 17:52:32] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 17:52:35] Saving Adam parameters
[2023-07-20 17:52:35] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 17:52:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 17:52:48] [marian] Running on node18.datos.cluster.uy as process 1995 with command line:
[2023-07-20 17:52:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 17:52:48] [config] after: 0e
[2023-07-20 17:52:48] [config] after-batches: 0
[2023-07-20 17:52:48] [config] after-epochs: 30
[2023-07-20 17:52:48] [config] all-caps-every: 0
[2023-07-20 17:52:48] [config] allow-unk: false
[2023-07-20 17:52:48] [config] authors: false
[2023-07-20 17:52:48] [config] beam-size: 12
[2023-07-20 17:52:48] [config] bert-class-symbol: "[CLS]"
[2023-07-20 17:52:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 17:52:48] [config] bert-masking-fraction: 0.15
[2023-07-20 17:52:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 17:52:48] [config] bert-train-type-embeddings: true
[2023-07-20 17:52:48] [config] bert-type-vocab-size: 2
[2023-07-20 17:52:48] [config] build-info: ""
[2023-07-20 17:52:48] [config] check-gradient-nan: false
[2023-07-20 17:52:48] [config] check-nan: false
[2023-07-20 17:52:48] [config] cite: false
[2023-07-20 17:52:48] [config] clip-norm: 1
[2023-07-20 17:52:48] [config] cost-scaling:
[2023-07-20 17:52:48] [config]   - 256.f
[2023-07-20 17:52:48] [config]   - 1000
[2023-07-20 17:52:48] [config]   - 2.f
[2023-07-20 17:52:48] [config]   - 256.f
[2023-07-20 17:52:48] [config] cost-type: ce-sum
[2023-07-20 17:52:48] [config] cpu-threads: 0
[2023-07-20 17:52:48] [config] data-threads: 8
[2023-07-20 17:52:48] [config] data-weighting: ""
[2023-07-20 17:52:48] [config] data-weighting-type: sentence
[2023-07-20 17:52:48] [config] dec-cell: gru
[2023-07-20 17:52:48] [config] dec-cell-base-depth: 2
[2023-07-20 17:52:48] [config] dec-cell-high-depth: 1
[2023-07-20 17:52:48] [config] dec-depth: 1
[2023-07-20 17:52:48] [config] devices:
[2023-07-20 17:52:48] [config]   - 0
[2023-07-20 17:52:48] [config] dim-emb: 512
[2023-07-20 17:52:48] [config] dim-rnn: 1024
[2023-07-20 17:52:48] [config] dim-vocabs:
[2023-07-20 17:52:48] [config]   - 16384
[2023-07-20 17:52:48] [config]   - 16384
[2023-07-20 17:52:48] [config] disp-first: 0
[2023-07-20 17:52:48] [config] disp-freq: 1000u
[2023-07-20 17:52:48] [config] disp-label-counts: true
[2023-07-20 17:52:48] [config] dropout-rnn: 0
[2023-07-20 17:52:48] [config] dropout-src: 0
[2023-07-20 17:52:48] [config] dropout-trg: 0
[2023-07-20 17:52:48] [config] dump-config: ""
[2023-07-20 17:52:48] [config] dynamic-gradient-scaling:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] early-stopping: 200
[2023-07-20 17:52:48] [config] early-stopping-on: first
[2023-07-20 17:52:48] [config] embedding-fix-src: false
[2023-07-20 17:52:48] [config] embedding-fix-trg: false
[2023-07-20 17:52:48] [config] embedding-normalization: false
[2023-07-20 17:52:48] [config] embedding-vectors:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] enc-cell: gru
[2023-07-20 17:52:48] [config] enc-cell-depth: 1
[2023-07-20 17:52:48] [config] enc-depth: 1
[2023-07-20 17:52:48] [config] enc-type: bidirectional
[2023-07-20 17:52:48] [config] english-title-case-every: 0
[2023-07-20 17:52:48] [config] exponential-smoothing: 0
[2023-07-20 17:52:48] [config] factor-weight: 1
[2023-07-20 17:52:48] [config] factors-combine: sum
[2023-07-20 17:52:48] [config] factors-dim-emb: 0
[2023-07-20 17:52:48] [config] gradient-checkpointing: false
[2023-07-20 17:52:48] [config] gradient-norm-average-window: 100
[2023-07-20 17:52:48] [config] guided-alignment: none
[2023-07-20 17:52:48] [config] guided-alignment-cost: mse
[2023-07-20 17:52:48] [config] guided-alignment-weight: 0.1
[2023-07-20 17:52:48] [config] ignore-model-config: false
[2023-07-20 17:52:48] [config] input-types:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] interpolate-env-vars: false
[2023-07-20 17:52:48] [config] keep-best: false
[2023-07-20 17:52:48] [config] label-smoothing: 0
[2023-07-20 17:52:48] [config] layer-normalization: false
[2023-07-20 17:52:48] [config] learn-rate: 0.0001
[2023-07-20 17:52:48] [config] lemma-dependency: ""
[2023-07-20 17:52:48] [config] lemma-dim-emb: 0
[2023-07-20 17:52:48] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 17:52:48] [config] log-level: info
[2023-07-20 17:52:48] [config] log-time-zone: ""
[2023-07-20 17:52:48] [config] logical-epoch:
[2023-07-20 17:52:48] [config]   - 1e
[2023-07-20 17:52:48] [config]   - 0
[2023-07-20 17:52:48] [config] lr-decay: 0
[2023-07-20 17:52:48] [config] lr-decay-freq: 50000
[2023-07-20 17:52:48] [config] lr-decay-inv-sqrt:
[2023-07-20 17:52:48] [config]   - 0
[2023-07-20 17:52:48] [config] lr-decay-repeat-warmup: false
[2023-07-20 17:52:48] [config] lr-decay-reset-optimizer: false
[2023-07-20 17:52:48] [config] lr-decay-start:
[2023-07-20 17:52:48] [config]   - 10
[2023-07-20 17:52:48] [config]   - 1
[2023-07-20 17:52:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 17:52:48] [config] lr-report: false
[2023-07-20 17:52:48] [config] lr-warmup: 0
[2023-07-20 17:52:48] [config] lr-warmup-at-reload: false
[2023-07-20 17:52:48] [config] lr-warmup-cycle: false
[2023-07-20 17:52:48] [config] lr-warmup-start-rate: 0
[2023-07-20 17:52:48] [config] max-length: 250
[2023-07-20 17:52:48] [config] max-length-crop: true
[2023-07-20 17:52:48] [config] max-length-factor: 3
[2023-07-20 17:52:48] [config] maxi-batch: 100
[2023-07-20 17:52:48] [config] maxi-batch-sort: trg
[2023-07-20 17:52:48] [config] mini-batch: 64
[2023-07-20 17:52:48] [config] mini-batch-fit: true
[2023-07-20 17:52:48] [config] mini-batch-fit-step: 10
[2023-07-20 17:52:48] [config] mini-batch-round-up: true
[2023-07-20 17:52:48] [config] mini-batch-track-lr: false
[2023-07-20 17:52:48] [config] mini-batch-warmup: 0
[2023-07-20 17:52:48] [config] mini-batch-words: 0
[2023-07-20 17:52:48] [config] mini-batch-words-ref: 0
[2023-07-20 17:52:48] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 17:52:48] [config] multi-loss-type: sum
[2023-07-20 17:52:48] [config] n-best: false
[2023-07-20 17:52:48] [config] no-nccl: false
[2023-07-20 17:52:48] [config] no-reload: false
[2023-07-20 17:52:48] [config] no-restore-corpus: false
[2023-07-20 17:52:48] [config] normalize: 0
[2023-07-20 17:52:48] [config] normalize-gradient: false
[2023-07-20 17:52:48] [config] num-devices: 0
[2023-07-20 17:52:48] [config] optimizer: adam
[2023-07-20 17:52:48] [config] optimizer-delay: 1
[2023-07-20 17:52:48] [config] optimizer-params:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] output-omit-bias: false
[2023-07-20 17:52:48] [config] overwrite: true
[2023-07-20 17:52:48] [config] precision:
[2023-07-20 17:52:48] [config]   - float16
[2023-07-20 17:52:48] [config]   - float32
[2023-07-20 17:52:48] [config] pretrained-model: ""
[2023-07-20 17:52:48] [config] quantize-biases: false
[2023-07-20 17:52:48] [config] quantize-bits: 0
[2023-07-20 17:52:48] [config] quantize-log-based: false
[2023-07-20 17:52:48] [config] quantize-optimization-steps: 0
[2023-07-20 17:52:48] [config] quiet: false
[2023-07-20 17:52:48] [config] quiet-translation: true
[2023-07-20 17:52:48] [config] relative-paths: false
[2023-07-20 17:52:48] [config] right-left: false
[2023-07-20 17:52:48] [config] save-freq: 10000u
[2023-07-20 17:52:48] [config] seed: 1234
[2023-07-20 17:52:48] [config] sentencepiece-alphas:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] sentencepiece-max-lines: 2000000
[2023-07-20 17:52:48] [config] sentencepiece-options: ""
[2023-07-20 17:52:48] [config] sharding: global
[2023-07-20 17:52:48] [config] shuffle: data
[2023-07-20 17:52:48] [config] shuffle-in-ram: false
[2023-07-20 17:52:48] [config] sigterm: save-and-exit
[2023-07-20 17:52:48] [config] skip: false
[2023-07-20 17:52:48] [config] sqlite: ""
[2023-07-20 17:52:48] [config] sqlite-drop: false
[2023-07-20 17:52:48] [config] sync-freq: 200u
[2023-07-20 17:52:48] [config] sync-sgd: false
[2023-07-20 17:52:48] [config] tempdir: /tmp
[2023-07-20 17:52:48] [config] tied-embeddings: false
[2023-07-20 17:52:48] [config] tied-embeddings-all: true
[2023-07-20 17:52:48] [config] tied-embeddings-src: false
[2023-07-20 17:52:48] [config] train-embedder-rank:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] train-sets:
[2023-07-20 17:52:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 17:52:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 17:52:48] [config] transformer-aan-activation: swish
[2023-07-20 17:52:48] [config] transformer-aan-depth: 2
[2023-07-20 17:52:48] [config] transformer-aan-nogate: false
[2023-07-20 17:52:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 17:52:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 17:52:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 17:52:48] [config] transformer-depth-scaling: false
[2023-07-20 17:52:48] [config] transformer-dim-aan: 2048
[2023-07-20 17:52:48] [config] transformer-dim-ffn: 2048
[2023-07-20 17:52:48] [config] transformer-dropout: 0
[2023-07-20 17:52:48] [config] transformer-dropout-attention: 0
[2023-07-20 17:52:48] [config] transformer-dropout-ffn: 0
[2023-07-20 17:52:48] [config] transformer-ffn-activation: swish
[2023-07-20 17:52:48] [config] transformer-ffn-depth: 2
[2023-07-20 17:52:48] [config] transformer-guided-alignment-layer: last
[2023-07-20 17:52:48] [config] transformer-heads: 8
[2023-07-20 17:52:48] [config] transformer-no-projection: false
[2023-07-20 17:52:48] [config] transformer-pool: false
[2023-07-20 17:52:48] [config] transformer-postprocess: dan
[2023-07-20 17:52:48] [config] transformer-postprocess-emb: d
[2023-07-20 17:52:48] [config] transformer-postprocess-top: ""
[2023-07-20 17:52:48] [config] transformer-preprocess: ""
[2023-07-20 17:52:48] [config] transformer-tied-layers:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] transformer-train-position-embeddings: false
[2023-07-20 17:52:48] [config] tsv: false
[2023-07-20 17:52:48] [config] tsv-fields: 0
[2023-07-20 17:52:48] [config] type: amun
[2023-07-20 17:52:48] [config] ulr: false
[2023-07-20 17:52:48] [config] ulr-dim-emb: 0
[2023-07-20 17:52:48] [config] ulr-dropout: 0
[2023-07-20 17:52:48] [config] ulr-keys-vectors: ""
[2023-07-20 17:52:48] [config] ulr-query-vectors: ""
[2023-07-20 17:52:48] [config] ulr-softmax-temperature: 1
[2023-07-20 17:52:48] [config] ulr-trainable-transformation: false
[2023-07-20 17:52:48] [config] unlikelihood-loss: false
[2023-07-20 17:52:48] [config] valid-freq: 50000000
[2023-07-20 17:52:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 17:52:48] [config] valid-max-length: 1000
[2023-07-20 17:52:48] [config] valid-metrics:
[2023-07-20 17:52:48] [config]   - cross-entropy
[2023-07-20 17:52:48] [config]   - translation
[2023-07-20 17:52:48] [config] valid-mini-batch: 32
[2023-07-20 17:52:48] [config] valid-reset-stalled: false
[2023-07-20 17:52:48] [config] valid-script-args:
[2023-07-20 17:52:48] [config]   []
[2023-07-20 17:52:48] [config] valid-script-path: ""
[2023-07-20 17:52:48] [config] valid-sets:
[2023-07-20 17:52:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 17:52:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 17:52:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 17:52:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 17:52:48] [config] vocabs:
[2023-07-20 17:52:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 17:52:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 17:52:48] [config] word-penalty: 0
[2023-07-20 17:52:48] [config] word-scores: false
[2023-07-20 17:52:48] [config] workspace: 5500
[2023-07-20 17:52:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 17:52:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 17:52:48] [training] Using single-device training
[2023-07-20 17:52:49] Synced seed 1234
[2023-07-20 17:52:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 17:52:49] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 17:52:49] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 17:52:49] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 17:52:49] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 17:52:49] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 17:52:49] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 17:52:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 17:52:51] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 17:52:51] [comm] Using global sharding
[2023-07-20 17:52:51] [comm] NCCLCommunicators constructed successfully
[2023-07-20 17:52:51] [training] Using 1 GPUs
[2023-07-20 17:52:51] [logits] Applying loss function for 1 factor(s)
[2023-07-20 17:52:51] [memory] Reserving 80 MB, device gpu0
[2023-07-20 17:52:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 17:52:51] [memory] Reserving 80 MB, device gpu0
[2023-07-20 18:34:08] [batching] Done. Typical MB size is 35,869 target words
[2023-07-20 18:34:08] [valid] No post-processing script given for validating translator
[2023-07-20 18:34:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 18:34:08] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 18:34:08] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 18:34:08] [comm] Using global sharding
[2023-07-20 18:34:08] [comm] NCCLCommunicators constructed successfully
[2023-07-20 18:34:08] [training] Using 1 GPUs
[2023-07-20 18:34:08] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 18:34:16] Allocating memory for general optimizer shards
[2023-07-20 18:34:16] [memory] Reserving 322 MB, device gpu0
[2023-07-20 18:34:16] Loading Adam parameters
[2023-07-20 18:34:16] [memory] Reserving 322 MB, device gpu0
[2023-07-20 18:34:16] [memory] Reserving 80 MB, device gpu0
[2023-07-20 18:34:16] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 18:34:16] [data] Restoring the corpus state to epoch 21, batch 774
[2023-07-20 18:34:16] [data] Shuffling data
[2023-07-20 18:34:16] [data] Done reading 20,192 sentences
[2023-07-20 18:34:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:34:16] Training started
[2023-07-20 18:34:16] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 18:34:17] [memory] Reserving 80 MB, device gpu0
[2023-07-20 18:34:24] Parameter type float16, optimization type float32, casting types true
[2023-07-20 18:38:14] Seen 20,192 samples
[2023-07-20 18:38:14] Starting data epoch 22 in logical epoch 22
[2023-07-20 18:38:14] [data] Shuffling data
[2023-07-20 18:38:14] [data] Done reading 20,192 sentences
[2023-07-20 18:38:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:42:04] Seen 20,192 samples
[2023-07-20 18:42:04] Starting data epoch 23 in logical epoch 23
[2023-07-20 18:42:04] [data] Shuffling data
[2023-07-20 18:42:04] [data] Done reading 20,192 sentences
[2023-07-20 18:42:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:45:54] Seen 20,192 samples
[2023-07-20 18:45:54] Starting data epoch 24 in logical epoch 24
[2023-07-20 18:45:54] [data] Shuffling data
[2023-07-20 18:45:54] [data] Done reading 20,192 sentences
[2023-07-20 18:45:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:49:46] Seen 20,192 samples
[2023-07-20 18:49:46] Starting data epoch 25 in logical epoch 25
[2023-07-20 18:49:46] [data] Shuffling data
[2023-07-20 18:49:46] [data] Done reading 20,192 sentences
[2023-07-20 18:49:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:53:40] Seen 20,192 samples
[2023-07-20 18:53:40] Starting data epoch 26 in logical epoch 26
[2023-07-20 18:53:40] [data] Shuffling data
[2023-07-20 18:53:40] [data] Done reading 20,192 sentences
[2023-07-20 18:53:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 18:56:42] Ep. 26 : Up. 1000 : Sen. 16,083 : Cost 6.31234837 * 16,009,909 @ 22,530 after 16,009,909 : Time 1354.46s : 11820.16 words/s : gNorm 0.9464
[2023-07-20 18:57:40] Seen 20,192 samples
[2023-07-20 18:57:40] Starting data epoch 27 in logical epoch 27
[2023-07-20 18:57:40] [data] Shuffling data
[2023-07-20 18:57:40] [data] Done reading 20,192 sentences
[2023-07-20 18:57:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:01:38] Seen 20,192 samples
[2023-07-20 19:01:38] Starting data epoch 28 in logical epoch 28
[2023-07-20 19:01:38] [data] Shuffling data
[2023-07-20 19:01:39] [data] Done reading 20,192 sentences
[2023-07-20 19:01:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:05:32] Seen 20,192 samples
[2023-07-20 19:05:32] Starting data epoch 29 in logical epoch 29
[2023-07-20 19:05:32] [data] Shuffling data
[2023-07-20 19:05:32] [data] Done reading 20,192 sentences
[2023-07-20 19:05:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:09:22] Seen 20,192 samples
[2023-07-20 19:09:22] Starting data epoch 30 in logical epoch 30
[2023-07-20 19:09:22] [data] Shuffling data
[2023-07-20 19:09:22] [data] Done reading 20,192 sentences
[2023-07-20 19:09:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:13:20] Seen 20,192 samples
[2023-07-20 19:13:20] Starting data epoch 31 in logical epoch 31
[2023-07-20 19:13:20] Training finished
[2023-07-20 19:13:30] [valid] Ep. 31 : Up. 1166 : cross-entropy : 161.946 : new best
[2023-07-20 19:14:45] [valid] Ep. 31 : Up. 1166 : translation : 0 : new best
[2023-07-20 19:14:45] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 19:14:48] Saving Adam parameters
[2023-07-20 19:14:48] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 19:14:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 19:14:55] [marian] Running on node18.datos.cluster.uy as process 7379 with command line:
[2023-07-20 19:14:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 19:14:55] [config] after: 0e
[2023-07-20 19:14:55] [config] after-batches: 0
[2023-07-20 19:14:55] [config] after-epochs: 40
[2023-07-20 19:14:55] [config] all-caps-every: 0
[2023-07-20 19:14:55] [config] allow-unk: false
[2023-07-20 19:14:55] [config] authors: false
[2023-07-20 19:14:55] [config] beam-size: 12
[2023-07-20 19:14:55] [config] bert-class-symbol: "[CLS]"
[2023-07-20 19:14:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 19:14:55] [config] bert-masking-fraction: 0.15
[2023-07-20 19:14:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 19:14:55] [config] bert-train-type-embeddings: true
[2023-07-20 19:14:55] [config] bert-type-vocab-size: 2
[2023-07-20 19:14:55] [config] build-info: ""
[2023-07-20 19:14:55] [config] check-gradient-nan: false
[2023-07-20 19:14:55] [config] check-nan: false
[2023-07-20 19:14:55] [config] cite: false
[2023-07-20 19:14:55] [config] clip-norm: 1
[2023-07-20 19:14:55] [config] cost-scaling:
[2023-07-20 19:14:55] [config]   - 256.f
[2023-07-20 19:14:55] [config]   - 1000
[2023-07-20 19:14:55] [config]   - 2.f
[2023-07-20 19:14:55] [config]   - 256.f
[2023-07-20 19:14:55] [config] cost-type: ce-sum
[2023-07-20 19:14:55] [config] cpu-threads: 0
[2023-07-20 19:14:55] [config] data-threads: 8
[2023-07-20 19:14:55] [config] data-weighting: ""
[2023-07-20 19:14:55] [config] data-weighting-type: sentence
[2023-07-20 19:14:55] [config] dec-cell: gru
[2023-07-20 19:14:55] [config] dec-cell-base-depth: 2
[2023-07-20 19:14:55] [config] dec-cell-high-depth: 1
[2023-07-20 19:14:55] [config] dec-depth: 1
[2023-07-20 19:14:55] [config] devices:
[2023-07-20 19:14:55] [config]   - 0
[2023-07-20 19:14:55] [config] dim-emb: 512
[2023-07-20 19:14:55] [config] dim-rnn: 1024
[2023-07-20 19:14:55] [config] dim-vocabs:
[2023-07-20 19:14:55] [config]   - 16384
[2023-07-20 19:14:55] [config]   - 16384
[2023-07-20 19:14:55] [config] disp-first: 0
[2023-07-20 19:14:55] [config] disp-freq: 1000u
[2023-07-20 19:14:55] [config] disp-label-counts: true
[2023-07-20 19:14:55] [config] dropout-rnn: 0
[2023-07-20 19:14:55] [config] dropout-src: 0
[2023-07-20 19:14:55] [config] dropout-trg: 0
[2023-07-20 19:14:55] [config] dump-config: ""
[2023-07-20 19:14:55] [config] dynamic-gradient-scaling:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] early-stopping: 200
[2023-07-20 19:14:55] [config] early-stopping-on: first
[2023-07-20 19:14:55] [config] embedding-fix-src: false
[2023-07-20 19:14:55] [config] embedding-fix-trg: false
[2023-07-20 19:14:55] [config] embedding-normalization: false
[2023-07-20 19:14:55] [config] embedding-vectors:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] enc-cell: gru
[2023-07-20 19:14:55] [config] enc-cell-depth: 1
[2023-07-20 19:14:55] [config] enc-depth: 1
[2023-07-20 19:14:55] [config] enc-type: bidirectional
[2023-07-20 19:14:55] [config] english-title-case-every: 0
[2023-07-20 19:14:55] [config] exponential-smoothing: 0
[2023-07-20 19:14:55] [config] factor-weight: 1
[2023-07-20 19:14:55] [config] factors-combine: sum
[2023-07-20 19:14:55] [config] factors-dim-emb: 0
[2023-07-20 19:14:55] [config] gradient-checkpointing: false
[2023-07-20 19:14:55] [config] gradient-norm-average-window: 100
[2023-07-20 19:14:55] [config] guided-alignment: none
[2023-07-20 19:14:55] [config] guided-alignment-cost: mse
[2023-07-20 19:14:55] [config] guided-alignment-weight: 0.1
[2023-07-20 19:14:55] [config] ignore-model-config: false
[2023-07-20 19:14:55] [config] input-types:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] interpolate-env-vars: false
[2023-07-20 19:14:55] [config] keep-best: false
[2023-07-20 19:14:55] [config] label-smoothing: 0
[2023-07-20 19:14:55] [config] layer-normalization: false
[2023-07-20 19:14:55] [config] learn-rate: 0.0001
[2023-07-20 19:14:55] [config] lemma-dependency: ""
[2023-07-20 19:14:55] [config] lemma-dim-emb: 0
[2023-07-20 19:14:55] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 19:14:55] [config] log-level: info
[2023-07-20 19:14:55] [config] log-time-zone: ""
[2023-07-20 19:14:55] [config] logical-epoch:
[2023-07-20 19:14:55] [config]   - 1e
[2023-07-20 19:14:55] [config]   - 0
[2023-07-20 19:14:55] [config] lr-decay: 0
[2023-07-20 19:14:55] [config] lr-decay-freq: 50000
[2023-07-20 19:14:55] [config] lr-decay-inv-sqrt:
[2023-07-20 19:14:55] [config]   - 0
[2023-07-20 19:14:55] [config] lr-decay-repeat-warmup: false
[2023-07-20 19:14:55] [config] lr-decay-reset-optimizer: false
[2023-07-20 19:14:55] [config] lr-decay-start:
[2023-07-20 19:14:55] [config]   - 10
[2023-07-20 19:14:55] [config]   - 1
[2023-07-20 19:14:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 19:14:55] [config] lr-report: false
[2023-07-20 19:14:55] [config] lr-warmup: 0
[2023-07-20 19:14:55] [config] lr-warmup-at-reload: false
[2023-07-20 19:14:55] [config] lr-warmup-cycle: false
[2023-07-20 19:14:55] [config] lr-warmup-start-rate: 0
[2023-07-20 19:14:55] [config] max-length: 250
[2023-07-20 19:14:55] [config] max-length-crop: true
[2023-07-20 19:14:55] [config] max-length-factor: 3
[2023-07-20 19:14:55] [config] maxi-batch: 100
[2023-07-20 19:14:55] [config] maxi-batch-sort: trg
[2023-07-20 19:14:55] [config] mini-batch: 64
[2023-07-20 19:14:55] [config] mini-batch-fit: true
[2023-07-20 19:14:55] [config] mini-batch-fit-step: 10
[2023-07-20 19:14:55] [config] mini-batch-round-up: true
[2023-07-20 19:14:55] [config] mini-batch-track-lr: false
[2023-07-20 19:14:55] [config] mini-batch-warmup: 0
[2023-07-20 19:14:55] [config] mini-batch-words: 0
[2023-07-20 19:14:55] [config] mini-batch-words-ref: 0
[2023-07-20 19:14:55] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 19:14:55] [config] multi-loss-type: sum
[2023-07-20 19:14:55] [config] n-best: false
[2023-07-20 19:14:55] [config] no-nccl: false
[2023-07-20 19:14:55] [config] no-reload: false
[2023-07-20 19:14:55] [config] no-restore-corpus: false
[2023-07-20 19:14:55] [config] normalize: 0
[2023-07-20 19:14:55] [config] normalize-gradient: false
[2023-07-20 19:14:55] [config] num-devices: 0
[2023-07-20 19:14:55] [config] optimizer: adam
[2023-07-20 19:14:55] [config] optimizer-delay: 1
[2023-07-20 19:14:55] [config] optimizer-params:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] output-omit-bias: false
[2023-07-20 19:14:55] [config] overwrite: true
[2023-07-20 19:14:55] [config] precision:
[2023-07-20 19:14:55] [config]   - float16
[2023-07-20 19:14:55] [config]   - float32
[2023-07-20 19:14:55] [config] pretrained-model: ""
[2023-07-20 19:14:55] [config] quantize-biases: false
[2023-07-20 19:14:55] [config] quantize-bits: 0
[2023-07-20 19:14:55] [config] quantize-log-based: false
[2023-07-20 19:14:55] [config] quantize-optimization-steps: 0
[2023-07-20 19:14:55] [config] quiet: false
[2023-07-20 19:14:55] [config] quiet-translation: true
[2023-07-20 19:14:55] [config] relative-paths: false
[2023-07-20 19:14:55] [config] right-left: false
[2023-07-20 19:14:55] [config] save-freq: 10000u
[2023-07-20 19:14:55] [config] seed: 1234
[2023-07-20 19:14:55] [config] sentencepiece-alphas:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] sentencepiece-max-lines: 2000000
[2023-07-20 19:14:55] [config] sentencepiece-options: ""
[2023-07-20 19:14:55] [config] sharding: global
[2023-07-20 19:14:55] [config] shuffle: data
[2023-07-20 19:14:55] [config] shuffle-in-ram: false
[2023-07-20 19:14:55] [config] sigterm: save-and-exit
[2023-07-20 19:14:55] [config] skip: false
[2023-07-20 19:14:55] [config] sqlite: ""
[2023-07-20 19:14:55] [config] sqlite-drop: false
[2023-07-20 19:14:55] [config] sync-freq: 200u
[2023-07-20 19:14:55] [config] sync-sgd: false
[2023-07-20 19:14:55] [config] tempdir: /tmp
[2023-07-20 19:14:55] [config] tied-embeddings: false
[2023-07-20 19:14:55] [config] tied-embeddings-all: true
[2023-07-20 19:14:55] [config] tied-embeddings-src: false
[2023-07-20 19:14:55] [config] train-embedder-rank:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] train-sets:
[2023-07-20 19:14:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 19:14:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 19:14:55] [config] transformer-aan-activation: swish
[2023-07-20 19:14:55] [config] transformer-aan-depth: 2
[2023-07-20 19:14:55] [config] transformer-aan-nogate: false
[2023-07-20 19:14:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 19:14:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 19:14:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 19:14:55] [config] transformer-depth-scaling: false
[2023-07-20 19:14:55] [config] transformer-dim-aan: 2048
[2023-07-20 19:14:55] [config] transformer-dim-ffn: 2048
[2023-07-20 19:14:55] [config] transformer-dropout: 0
[2023-07-20 19:14:55] [config] transformer-dropout-attention: 0
[2023-07-20 19:14:55] [config] transformer-dropout-ffn: 0
[2023-07-20 19:14:55] [config] transformer-ffn-activation: swish
[2023-07-20 19:14:55] [config] transformer-ffn-depth: 2
[2023-07-20 19:14:55] [config] transformer-guided-alignment-layer: last
[2023-07-20 19:14:55] [config] transformer-heads: 8
[2023-07-20 19:14:55] [config] transformer-no-projection: false
[2023-07-20 19:14:55] [config] transformer-pool: false
[2023-07-20 19:14:55] [config] transformer-postprocess: dan
[2023-07-20 19:14:55] [config] transformer-postprocess-emb: d
[2023-07-20 19:14:55] [config] transformer-postprocess-top: ""
[2023-07-20 19:14:55] [config] transformer-preprocess: ""
[2023-07-20 19:14:55] [config] transformer-tied-layers:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] transformer-train-position-embeddings: false
[2023-07-20 19:14:55] [config] tsv: false
[2023-07-20 19:14:55] [config] tsv-fields: 0
[2023-07-20 19:14:55] [config] type: amun
[2023-07-20 19:14:55] [config] ulr: false
[2023-07-20 19:14:55] [config] ulr-dim-emb: 0
[2023-07-20 19:14:55] [config] ulr-dropout: 0
[2023-07-20 19:14:55] [config] ulr-keys-vectors: ""
[2023-07-20 19:14:55] [config] ulr-query-vectors: ""
[2023-07-20 19:14:55] [config] ulr-softmax-temperature: 1
[2023-07-20 19:14:55] [config] ulr-trainable-transformation: false
[2023-07-20 19:14:55] [config] unlikelihood-loss: false
[2023-07-20 19:14:55] [config] valid-freq: 50000000
[2023-07-20 19:14:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 19:14:55] [config] valid-max-length: 1000
[2023-07-20 19:14:55] [config] valid-metrics:
[2023-07-20 19:14:55] [config]   - cross-entropy
[2023-07-20 19:14:55] [config]   - translation
[2023-07-20 19:14:55] [config] valid-mini-batch: 32
[2023-07-20 19:14:55] [config] valid-reset-stalled: false
[2023-07-20 19:14:55] [config] valid-script-args:
[2023-07-20 19:14:55] [config]   []
[2023-07-20 19:14:55] [config] valid-script-path: ""
[2023-07-20 19:14:55] [config] valid-sets:
[2023-07-20 19:14:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 19:14:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 19:14:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 19:14:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 19:14:55] [config] vocabs:
[2023-07-20 19:14:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 19:14:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 19:14:55] [config] word-penalty: 0
[2023-07-20 19:14:55] [config] word-scores: false
[2023-07-20 19:14:55] [config] workspace: 5500
[2023-07-20 19:14:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 19:14:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 19:14:55] [training] Using single-device training
[2023-07-20 19:14:56] Synced seed 1234
[2023-07-20 19:14:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 19:14:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 19:14:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 19:14:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 19:14:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 19:14:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 19:14:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 19:14:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 19:14:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 19:14:58] [comm] Using global sharding
[2023-07-20 19:14:58] [comm] NCCLCommunicators constructed successfully
[2023-07-20 19:14:58] [training] Using 1 GPUs
[2023-07-20 19:14:58] [logits] Applying loss function for 1 factor(s)
[2023-07-20 19:14:58] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:14:58] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 19:14:58] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:55:35] [batching] Done. Typical MB size is 35,869 target words
[2023-07-20 19:55:35] [valid] No post-processing script given for validating translator
[2023-07-20 19:55:35] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 19:55:35] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 19:55:35] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 19:55:35] [comm] Using global sharding
[2023-07-20 19:55:35] [comm] NCCLCommunicators constructed successfully
[2023-07-20 19:55:35] [training] Using 1 GPUs
[2023-07-20 19:55:35] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 19:55:42] Allocating memory for general optimizer shards
[2023-07-20 19:55:42] [memory] Reserving 322 MB, device gpu0
[2023-07-20 19:55:42] Loading Adam parameters
[2023-07-20 19:55:43] [memory] Reserving 322 MB, device gpu0
[2023-07-20 19:55:43] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:55:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 19:55:43] [data] Restoring the corpus state to epoch 31, batch 1166
[2023-07-20 19:55:43] [data] Shuffling data
[2023-07-20 19:55:43] [data] Done reading 20,192 sentences
[2023-07-20 19:55:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 19:55:43] Training started
[2023-07-20 19:55:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 19:55:44] [memory] Reserving 80 MB, device gpu0
[2023-07-20 19:55:52] Parameter type float16, optimization type float32, casting types true
[2023-07-20 19:59:31] Seen 20,192 samples
[2023-07-20 19:59:31] Starting data epoch 32 in logical epoch 32
[2023-07-20 19:59:31] [data] Shuffling data
[2023-07-20 19:59:31] [data] Done reading 20,192 sentences
[2023-07-20 19:59:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:03:19] Seen 20,192 samples
[2023-07-20 20:03:19] Starting data epoch 33 in logical epoch 33
[2023-07-20 20:03:19] [data] Shuffling data
[2023-07-20 20:03:19] [data] Done reading 20,192 sentences
[2023-07-20 20:03:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:07:08] Seen 20,192 samples
[2023-07-20 20:07:08] Starting data epoch 34 in logical epoch 34
[2023-07-20 20:07:08] [data] Shuffling data
[2023-07-20 20:07:08] [data] Done reading 20,192 sentences
[2023-07-20 20:07:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:10:55] Seen 20,192 samples
[2023-07-20 20:10:55] Starting data epoch 35 in logical epoch 35
[2023-07-20 20:10:55] [data] Shuffling data
[2023-07-20 20:10:55] [data] Done reading 20,192 sentences
[2023-07-20 20:10:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:14:43] Seen 20,192 samples
[2023-07-20 20:14:43] Starting data epoch 36 in logical epoch 36
[2023-07-20 20:14:43] [data] Shuffling data
[2023-07-20 20:14:43] [data] Done reading 20,192 sentences
[2023-07-20 20:14:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:18:35] Seen 20,192 samples
[2023-07-20 20:18:35] Starting data epoch 37 in logical epoch 37
[2023-07-20 20:18:35] [data] Shuffling data
[2023-07-20 20:18:35] [data] Done reading 20,192 sentences
[2023-07-20 20:18:35] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:22:20] Seen 20,192 samples
[2023-07-20 20:22:20] Starting data epoch 38 in logical epoch 38
[2023-07-20 20:22:20] [data] Shuffling data
[2023-07-20 20:22:20] [data] Done reading 20,192 sentences
[2023-07-20 20:22:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:25:41] Seen 20,192 samples
[2023-07-20 20:25:41] Starting data epoch 39 in logical epoch 39
[2023-07-20 20:25:41] [data] Shuffling data
[2023-07-20 20:25:41] [data] Done reading 20,192 sentences
[2023-07-20 20:25:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:29:10] Seen 20,192 samples
[2023-07-20 20:29:10] Starting data epoch 40 in logical epoch 40
[2023-07-20 20:29:10] [data] Shuffling data
[2023-07-20 20:29:10] [data] Done reading 20,192 sentences
[2023-07-20 20:29:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 20:32:45] Seen 20,192 samples
[2023-07-20 20:32:45] Starting data epoch 41 in logical epoch 41
[2023-07-20 20:32:45] Training finished
[2023-07-20 20:32:54] [valid] Ep. 41 : Up. 1555 : cross-entropy : 154.264 : new best
[2023-07-20 20:34:14] [valid] Ep. 41 : Up. 1555 : translation : 0 : new best
[2023-07-20 20:34:14] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 20:34:16] Saving Adam parameters
[2023-07-20 20:34:17] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 20:34:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 20:34:23] [marian] Running on node18.datos.cluster.uy as process 12952 with command line:
[2023-07-20 20:34:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 20:34:23] [config] after: 0e
[2023-07-20 20:34:23] [config] after-batches: 0
[2023-07-20 20:34:23] [config] after-epochs: 50
[2023-07-20 20:34:23] [config] all-caps-every: 0
[2023-07-20 20:34:23] [config] allow-unk: false
[2023-07-20 20:34:23] [config] authors: false
[2023-07-20 20:34:23] [config] beam-size: 12
[2023-07-20 20:34:23] [config] bert-class-symbol: "[CLS]"
[2023-07-20 20:34:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 20:34:23] [config] bert-masking-fraction: 0.15
[2023-07-20 20:34:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 20:34:23] [config] bert-train-type-embeddings: true
[2023-07-20 20:34:23] [config] bert-type-vocab-size: 2
[2023-07-20 20:34:23] [config] build-info: ""
[2023-07-20 20:34:23] [config] check-gradient-nan: false
[2023-07-20 20:34:23] [config] check-nan: false
[2023-07-20 20:34:23] [config] cite: false
[2023-07-20 20:34:23] [config] clip-norm: 1
[2023-07-20 20:34:23] [config] cost-scaling:
[2023-07-20 20:34:23] [config]   - 256.f
[2023-07-20 20:34:23] [config]   - 1000
[2023-07-20 20:34:23] [config]   - 2.f
[2023-07-20 20:34:23] [config]   - 256.f
[2023-07-20 20:34:23] [config] cost-type: ce-sum
[2023-07-20 20:34:23] [config] cpu-threads: 0
[2023-07-20 20:34:23] [config] data-threads: 8
[2023-07-20 20:34:23] [config] data-weighting: ""
[2023-07-20 20:34:23] [config] data-weighting-type: sentence
[2023-07-20 20:34:23] [config] dec-cell: gru
[2023-07-20 20:34:23] [config] dec-cell-base-depth: 2
[2023-07-20 20:34:23] [config] dec-cell-high-depth: 1
[2023-07-20 20:34:23] [config] dec-depth: 1
[2023-07-20 20:34:23] [config] devices:
[2023-07-20 20:34:23] [config]   - 0
[2023-07-20 20:34:23] [config] dim-emb: 512
[2023-07-20 20:34:23] [config] dim-rnn: 1024
[2023-07-20 20:34:23] [config] dim-vocabs:
[2023-07-20 20:34:23] [config]   - 16384
[2023-07-20 20:34:23] [config]   - 16384
[2023-07-20 20:34:23] [config] disp-first: 0
[2023-07-20 20:34:23] [config] disp-freq: 1000u
[2023-07-20 20:34:23] [config] disp-label-counts: true
[2023-07-20 20:34:23] [config] dropout-rnn: 0
[2023-07-20 20:34:23] [config] dropout-src: 0
[2023-07-20 20:34:23] [config] dropout-trg: 0
[2023-07-20 20:34:23] [config] dump-config: ""
[2023-07-20 20:34:23] [config] dynamic-gradient-scaling:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] early-stopping: 200
[2023-07-20 20:34:23] [config] early-stopping-on: first
[2023-07-20 20:34:23] [config] embedding-fix-src: false
[2023-07-20 20:34:23] [config] embedding-fix-trg: false
[2023-07-20 20:34:23] [config] embedding-normalization: false
[2023-07-20 20:34:23] [config] embedding-vectors:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] enc-cell: gru
[2023-07-20 20:34:23] [config] enc-cell-depth: 1
[2023-07-20 20:34:23] [config] enc-depth: 1
[2023-07-20 20:34:23] [config] enc-type: bidirectional
[2023-07-20 20:34:23] [config] english-title-case-every: 0
[2023-07-20 20:34:23] [config] exponential-smoothing: 0
[2023-07-20 20:34:23] [config] factor-weight: 1
[2023-07-20 20:34:23] [config] factors-combine: sum
[2023-07-20 20:34:23] [config] factors-dim-emb: 0
[2023-07-20 20:34:23] [config] gradient-checkpointing: false
[2023-07-20 20:34:23] [config] gradient-norm-average-window: 100
[2023-07-20 20:34:23] [config] guided-alignment: none
[2023-07-20 20:34:23] [config] guided-alignment-cost: mse
[2023-07-20 20:34:23] [config] guided-alignment-weight: 0.1
[2023-07-20 20:34:23] [config] ignore-model-config: false
[2023-07-20 20:34:23] [config] input-types:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] interpolate-env-vars: false
[2023-07-20 20:34:23] [config] keep-best: false
[2023-07-20 20:34:23] [config] label-smoothing: 0
[2023-07-20 20:34:23] [config] layer-normalization: false
[2023-07-20 20:34:23] [config] learn-rate: 0.0001
[2023-07-20 20:34:23] [config] lemma-dependency: ""
[2023-07-20 20:34:23] [config] lemma-dim-emb: 0
[2023-07-20 20:34:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 20:34:23] [config] log-level: info
[2023-07-20 20:34:23] [config] log-time-zone: ""
[2023-07-20 20:34:23] [config] logical-epoch:
[2023-07-20 20:34:23] [config]   - 1e
[2023-07-20 20:34:23] [config]   - 0
[2023-07-20 20:34:23] [config] lr-decay: 0
[2023-07-20 20:34:23] [config] lr-decay-freq: 50000
[2023-07-20 20:34:23] [config] lr-decay-inv-sqrt:
[2023-07-20 20:34:23] [config]   - 0
[2023-07-20 20:34:23] [config] lr-decay-repeat-warmup: false
[2023-07-20 20:34:23] [config] lr-decay-reset-optimizer: false
[2023-07-20 20:34:23] [config] lr-decay-start:
[2023-07-20 20:34:23] [config]   - 10
[2023-07-20 20:34:23] [config]   - 1
[2023-07-20 20:34:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 20:34:23] [config] lr-report: false
[2023-07-20 20:34:23] [config] lr-warmup: 0
[2023-07-20 20:34:23] [config] lr-warmup-at-reload: false
[2023-07-20 20:34:23] [config] lr-warmup-cycle: false
[2023-07-20 20:34:23] [config] lr-warmup-start-rate: 0
[2023-07-20 20:34:23] [config] max-length: 250
[2023-07-20 20:34:23] [config] max-length-crop: true
[2023-07-20 20:34:23] [config] max-length-factor: 3
[2023-07-20 20:34:23] [config] maxi-batch: 100
[2023-07-20 20:34:23] [config] maxi-batch-sort: trg
[2023-07-20 20:34:23] [config] mini-batch: 64
[2023-07-20 20:34:23] [config] mini-batch-fit: true
[2023-07-20 20:34:23] [config] mini-batch-fit-step: 10
[2023-07-20 20:34:23] [config] mini-batch-round-up: true
[2023-07-20 20:34:23] [config] mini-batch-track-lr: false
[2023-07-20 20:34:23] [config] mini-batch-warmup: 0
[2023-07-20 20:34:23] [config] mini-batch-words: 0
[2023-07-20 20:34:23] [config] mini-batch-words-ref: 0
[2023-07-20 20:34:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 20:34:23] [config] multi-loss-type: sum
[2023-07-20 20:34:23] [config] n-best: false
[2023-07-20 20:34:23] [config] no-nccl: false
[2023-07-20 20:34:23] [config] no-reload: false
[2023-07-20 20:34:23] [config] no-restore-corpus: false
[2023-07-20 20:34:23] [config] normalize: 0
[2023-07-20 20:34:23] [config] normalize-gradient: false
[2023-07-20 20:34:23] [config] num-devices: 0
[2023-07-20 20:34:23] [config] optimizer: adam
[2023-07-20 20:34:23] [config] optimizer-delay: 1
[2023-07-20 20:34:23] [config] optimizer-params:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] output-omit-bias: false
[2023-07-20 20:34:23] [config] overwrite: true
[2023-07-20 20:34:23] [config] precision:
[2023-07-20 20:34:23] [config]   - float16
[2023-07-20 20:34:23] [config]   - float32
[2023-07-20 20:34:23] [config] pretrained-model: ""
[2023-07-20 20:34:23] [config] quantize-biases: false
[2023-07-20 20:34:23] [config] quantize-bits: 0
[2023-07-20 20:34:23] [config] quantize-log-based: false
[2023-07-20 20:34:23] [config] quantize-optimization-steps: 0
[2023-07-20 20:34:23] [config] quiet: false
[2023-07-20 20:34:23] [config] quiet-translation: true
[2023-07-20 20:34:23] [config] relative-paths: false
[2023-07-20 20:34:23] [config] right-left: false
[2023-07-20 20:34:23] [config] save-freq: 10000u
[2023-07-20 20:34:23] [config] seed: 1234
[2023-07-20 20:34:23] [config] sentencepiece-alphas:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] sentencepiece-max-lines: 2000000
[2023-07-20 20:34:23] [config] sentencepiece-options: ""
[2023-07-20 20:34:23] [config] sharding: global
[2023-07-20 20:34:23] [config] shuffle: data
[2023-07-20 20:34:23] [config] shuffle-in-ram: false
[2023-07-20 20:34:23] [config] sigterm: save-and-exit
[2023-07-20 20:34:23] [config] skip: false
[2023-07-20 20:34:23] [config] sqlite: ""
[2023-07-20 20:34:23] [config] sqlite-drop: false
[2023-07-20 20:34:23] [config] sync-freq: 200u
[2023-07-20 20:34:23] [config] sync-sgd: false
[2023-07-20 20:34:23] [config] tempdir: /tmp
[2023-07-20 20:34:23] [config] tied-embeddings: false
[2023-07-20 20:34:23] [config] tied-embeddings-all: true
[2023-07-20 20:34:23] [config] tied-embeddings-src: false
[2023-07-20 20:34:23] [config] train-embedder-rank:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] train-sets:
[2023-07-20 20:34:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 20:34:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 20:34:23] [config] transformer-aan-activation: swish
[2023-07-20 20:34:23] [config] transformer-aan-depth: 2
[2023-07-20 20:34:23] [config] transformer-aan-nogate: false
[2023-07-20 20:34:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 20:34:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 20:34:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 20:34:23] [config] transformer-depth-scaling: false
[2023-07-20 20:34:23] [config] transformer-dim-aan: 2048
[2023-07-20 20:34:23] [config] transformer-dim-ffn: 2048
[2023-07-20 20:34:23] [config] transformer-dropout: 0
[2023-07-20 20:34:23] [config] transformer-dropout-attention: 0
[2023-07-20 20:34:23] [config] transformer-dropout-ffn: 0
[2023-07-20 20:34:23] [config] transformer-ffn-activation: swish
[2023-07-20 20:34:23] [config] transformer-ffn-depth: 2
[2023-07-20 20:34:23] [config] transformer-guided-alignment-layer: last
[2023-07-20 20:34:23] [config] transformer-heads: 8
[2023-07-20 20:34:23] [config] transformer-no-projection: false
[2023-07-20 20:34:23] [config] transformer-pool: false
[2023-07-20 20:34:23] [config] transformer-postprocess: dan
[2023-07-20 20:34:23] [config] transformer-postprocess-emb: d
[2023-07-20 20:34:23] [config] transformer-postprocess-top: ""
[2023-07-20 20:34:23] [config] transformer-preprocess: ""
[2023-07-20 20:34:23] [config] transformer-tied-layers:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] transformer-train-position-embeddings: false
[2023-07-20 20:34:23] [config] tsv: false
[2023-07-20 20:34:23] [config] tsv-fields: 0
[2023-07-20 20:34:23] [config] type: amun
[2023-07-20 20:34:23] [config] ulr: false
[2023-07-20 20:34:23] [config] ulr-dim-emb: 0
[2023-07-20 20:34:23] [config] ulr-dropout: 0
[2023-07-20 20:34:23] [config] ulr-keys-vectors: ""
[2023-07-20 20:34:23] [config] ulr-query-vectors: ""
[2023-07-20 20:34:23] [config] ulr-softmax-temperature: 1
[2023-07-20 20:34:23] [config] ulr-trainable-transformation: false
[2023-07-20 20:34:23] [config] unlikelihood-loss: false
[2023-07-20 20:34:23] [config] valid-freq: 50000000
[2023-07-20 20:34:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 20:34:23] [config] valid-max-length: 1000
[2023-07-20 20:34:23] [config] valid-metrics:
[2023-07-20 20:34:23] [config]   - cross-entropy
[2023-07-20 20:34:23] [config]   - translation
[2023-07-20 20:34:23] [config] valid-mini-batch: 32
[2023-07-20 20:34:23] [config] valid-reset-stalled: false
[2023-07-20 20:34:23] [config] valid-script-args:
[2023-07-20 20:34:23] [config]   []
[2023-07-20 20:34:23] [config] valid-script-path: ""
[2023-07-20 20:34:23] [config] valid-sets:
[2023-07-20 20:34:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 20:34:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 20:34:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 20:34:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 20:34:23] [config] vocabs:
[2023-07-20 20:34:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 20:34:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 20:34:23] [config] word-penalty: 0
[2023-07-20 20:34:23] [config] word-scores: false
[2023-07-20 20:34:23] [config] workspace: 5500
[2023-07-20 20:34:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 20:34:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 20:34:23] [training] Using single-device training
[2023-07-20 20:34:25] Synced seed 1234
[2023-07-20 20:34:25] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 20:34:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 20:34:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 20:34:26] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 20:34:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 20:34:26] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 20:34:26] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 20:34:27] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 20:34:27] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 20:34:27] [comm] Using global sharding
[2023-07-20 20:34:27] [comm] NCCLCommunicators constructed successfully
[2023-07-20 20:34:27] [training] Using 1 GPUs
[2023-07-20 20:34:27] [logits] Applying loss function for 1 factor(s)
[2023-07-20 20:34:27] [memory] Reserving 80 MB, device gpu0
[2023-07-20 20:34:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 20:34:27] [memory] Reserving 80 MB, device gpu0
[2023-07-20 21:17:02] [batching] Done. Typical MB size is 35,869 target words
[2023-07-20 21:17:02] [valid] No post-processing script given for validating translator
[2023-07-20 21:17:02] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 21:17:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 21:17:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 21:17:02] [comm] Using global sharding
[2023-07-20 21:17:03] [comm] NCCLCommunicators constructed successfully
[2023-07-20 21:17:03] [training] Using 1 GPUs
[2023-07-20 21:17:03] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 21:17:10] Allocating memory for general optimizer shards
[2023-07-20 21:17:10] [memory] Reserving 322 MB, device gpu0
[2023-07-20 21:17:10] Loading Adam parameters
[2023-07-20 21:17:10] [memory] Reserving 322 MB, device gpu0
[2023-07-20 21:17:10] [memory] Reserving 80 MB, device gpu0
[2023-07-20 21:17:10] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 21:17:10] [data] Restoring the corpus state to epoch 41, batch 1555
[2023-07-20 21:17:10] [data] Shuffling data
[2023-07-20 21:17:10] [data] Done reading 20,192 sentences
[2023-07-20 21:17:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:17:10] Training started
[2023-07-20 21:17:11] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 21:17:11] [memory] Reserving 80 MB, device gpu0
[2023-07-20 21:17:17] Parameter type float16, optimization type float32, casting types true
[2023-07-20 21:21:11] Seen 20,192 samples
[2023-07-20 21:21:11] Starting data epoch 42 in logical epoch 42
[2023-07-20 21:21:11] [data] Shuffling data
[2023-07-20 21:21:11] [data] Done reading 20,192 sentences
[2023-07-20 21:21:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:25:18] Seen 20,192 samples
[2023-07-20 21:25:18] Starting data epoch 43 in logical epoch 43
[2023-07-20 21:25:18] [data] Shuffling data
[2023-07-20 21:25:18] [data] Done reading 20,192 sentences
[2023-07-20 21:25:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:29:19] Seen 20,192 samples
[2023-07-20 21:29:19] Starting data epoch 44 in logical epoch 44
[2023-07-20 21:29:19] [data] Shuffling data
[2023-07-20 21:29:19] [data] Done reading 20,192 sentences
[2023-07-20 21:29:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:33:33] Seen 20,192 samples
[2023-07-20 21:33:33] Starting data epoch 45 in logical epoch 45
[2023-07-20 21:33:33] [data] Shuffling data
[2023-07-20 21:33:33] [data] Done reading 20,192 sentences
[2023-07-20 21:33:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:37:24] Seen 20,192 samples
[2023-07-20 21:37:24] Starting data epoch 46 in logical epoch 46
[2023-07-20 21:37:24] [data] Shuffling data
[2023-07-20 21:37:24] [data] Done reading 20,192 sentences
[2023-07-20 21:37:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:41:37] Seen 20,192 samples
[2023-07-20 21:41:37] Starting data epoch 47 in logical epoch 47
[2023-07-20 21:41:37] [data] Shuffling data
[2023-07-20 21:41:37] [data] Done reading 20,192 sentences
[2023-07-20 21:41:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:45:37] Seen 20,192 samples
[2023-07-20 21:45:37] Starting data epoch 48 in logical epoch 48
[2023-07-20 21:45:37] [data] Shuffling data
[2023-07-20 21:45:37] [data] Done reading 20,192 sentences
[2023-07-20 21:45:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:49:45] Seen 20,192 samples
[2023-07-20 21:49:45] Starting data epoch 49 in logical epoch 49
[2023-07-20 21:49:45] [data] Shuffling data
[2023-07-20 21:49:45] [data] Done reading 20,192 sentences
[2023-07-20 21:49:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:53:46] Seen 20,192 samples
[2023-07-20 21:53:46] Starting data epoch 50 in logical epoch 50
[2023-07-20 21:53:46] [data] Shuffling data
[2023-07-20 21:53:46] [data] Done reading 20,192 sentences
[2023-07-20 21:53:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 21:57:46] Seen 20,192 samples
[2023-07-20 21:57:46] Starting data epoch 51 in logical epoch 51
[2023-07-20 21:57:46] Training finished
[2023-07-20 21:57:56] [valid] Ep. 51 : Up. 1942 : cross-entropy : 147.914 : new best
[2023-07-20 22:00:01] [valid] Ep. 51 : Up. 1942 : translation : 0 : new best
[2023-07-20 22:00:01] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 22:00:04] Saving Adam parameters
[2023-07-20 22:00:04] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 22:00:14] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 22:00:14] [marian] Running on node18.datos.cluster.uy as process 18812 with command line:
[2023-07-20 22:00:14] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 22:00:14] [config] after: 0e
[2023-07-20 22:00:14] [config] after-batches: 0
[2023-07-20 22:00:14] [config] after-epochs: 60
[2023-07-20 22:00:14] [config] all-caps-every: 0
[2023-07-20 22:00:14] [config] allow-unk: false
[2023-07-20 22:00:14] [config] authors: false
[2023-07-20 22:00:14] [config] beam-size: 12
[2023-07-20 22:00:14] [config] bert-class-symbol: "[CLS]"
[2023-07-20 22:00:14] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 22:00:14] [config] bert-masking-fraction: 0.15
[2023-07-20 22:00:14] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 22:00:14] [config] bert-train-type-embeddings: true
[2023-07-20 22:00:14] [config] bert-type-vocab-size: 2
[2023-07-20 22:00:14] [config] build-info: ""
[2023-07-20 22:00:14] [config] check-gradient-nan: false
[2023-07-20 22:00:14] [config] check-nan: false
[2023-07-20 22:00:14] [config] cite: false
[2023-07-20 22:00:14] [config] clip-norm: 1
[2023-07-20 22:00:14] [config] cost-scaling:
[2023-07-20 22:00:14] [config]   - 256.f
[2023-07-20 22:00:14] [config]   - 1000
[2023-07-20 22:00:14] [config]   - 2.f
[2023-07-20 22:00:14] [config]   - 256.f
[2023-07-20 22:00:14] [config] cost-type: ce-sum
[2023-07-20 22:00:14] [config] cpu-threads: 0
[2023-07-20 22:00:14] [config] data-threads: 8
[2023-07-20 22:00:14] [config] data-weighting: ""
[2023-07-20 22:00:14] [config] data-weighting-type: sentence
[2023-07-20 22:00:14] [config] dec-cell: gru
[2023-07-20 22:00:14] [config] dec-cell-base-depth: 2
[2023-07-20 22:00:14] [config] dec-cell-high-depth: 1
[2023-07-20 22:00:14] [config] dec-depth: 1
[2023-07-20 22:00:14] [config] devices:
[2023-07-20 22:00:14] [config]   - 0
[2023-07-20 22:00:14] [config] dim-emb: 512
[2023-07-20 22:00:14] [config] dim-rnn: 1024
[2023-07-20 22:00:14] [config] dim-vocabs:
[2023-07-20 22:00:14] [config]   - 16384
[2023-07-20 22:00:14] [config]   - 16384
[2023-07-20 22:00:14] [config] disp-first: 0
[2023-07-20 22:00:14] [config] disp-freq: 1000u
[2023-07-20 22:00:14] [config] disp-label-counts: true
[2023-07-20 22:00:14] [config] dropout-rnn: 0
[2023-07-20 22:00:14] [config] dropout-src: 0
[2023-07-20 22:00:14] [config] dropout-trg: 0
[2023-07-20 22:00:14] [config] dump-config: ""
[2023-07-20 22:00:14] [config] dynamic-gradient-scaling:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] early-stopping: 200
[2023-07-20 22:00:14] [config] early-stopping-on: first
[2023-07-20 22:00:14] [config] embedding-fix-src: false
[2023-07-20 22:00:14] [config] embedding-fix-trg: false
[2023-07-20 22:00:14] [config] embedding-normalization: false
[2023-07-20 22:00:14] [config] embedding-vectors:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] enc-cell: gru
[2023-07-20 22:00:14] [config] enc-cell-depth: 1
[2023-07-20 22:00:14] [config] enc-depth: 1
[2023-07-20 22:00:14] [config] enc-type: bidirectional
[2023-07-20 22:00:14] [config] english-title-case-every: 0
[2023-07-20 22:00:14] [config] exponential-smoothing: 0
[2023-07-20 22:00:14] [config] factor-weight: 1
[2023-07-20 22:00:14] [config] factors-combine: sum
[2023-07-20 22:00:14] [config] factors-dim-emb: 0
[2023-07-20 22:00:14] [config] gradient-checkpointing: false
[2023-07-20 22:00:14] [config] gradient-norm-average-window: 100
[2023-07-20 22:00:14] [config] guided-alignment: none
[2023-07-20 22:00:14] [config] guided-alignment-cost: mse
[2023-07-20 22:00:14] [config] guided-alignment-weight: 0.1
[2023-07-20 22:00:14] [config] ignore-model-config: false
[2023-07-20 22:00:14] [config] input-types:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] interpolate-env-vars: false
[2023-07-20 22:00:14] [config] keep-best: false
[2023-07-20 22:00:14] [config] label-smoothing: 0
[2023-07-20 22:00:14] [config] layer-normalization: false
[2023-07-20 22:00:14] [config] learn-rate: 0.0001
[2023-07-20 22:00:14] [config] lemma-dependency: ""
[2023-07-20 22:00:14] [config] lemma-dim-emb: 0
[2023-07-20 22:00:14] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 22:00:14] [config] log-level: info
[2023-07-20 22:00:14] [config] log-time-zone: ""
[2023-07-20 22:00:14] [config] logical-epoch:
[2023-07-20 22:00:14] [config]   - 1e
[2023-07-20 22:00:14] [config]   - 0
[2023-07-20 22:00:14] [config] lr-decay: 0
[2023-07-20 22:00:14] [config] lr-decay-freq: 50000
[2023-07-20 22:00:14] [config] lr-decay-inv-sqrt:
[2023-07-20 22:00:14] [config]   - 0
[2023-07-20 22:00:14] [config] lr-decay-repeat-warmup: false
[2023-07-20 22:00:14] [config] lr-decay-reset-optimizer: false
[2023-07-20 22:00:14] [config] lr-decay-start:
[2023-07-20 22:00:14] [config]   - 10
[2023-07-20 22:00:14] [config]   - 1
[2023-07-20 22:00:14] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 22:00:14] [config] lr-report: false
[2023-07-20 22:00:14] [config] lr-warmup: 0
[2023-07-20 22:00:14] [config] lr-warmup-at-reload: false
[2023-07-20 22:00:14] [config] lr-warmup-cycle: false
[2023-07-20 22:00:14] [config] lr-warmup-start-rate: 0
[2023-07-20 22:00:14] [config] max-length: 250
[2023-07-20 22:00:14] [config] max-length-crop: true
[2023-07-20 22:00:14] [config] max-length-factor: 3
[2023-07-20 22:00:14] [config] maxi-batch: 100
[2023-07-20 22:00:14] [config] maxi-batch-sort: trg
[2023-07-20 22:00:14] [config] mini-batch: 64
[2023-07-20 22:00:14] [config] mini-batch-fit: true
[2023-07-20 22:00:14] [config] mini-batch-fit-step: 10
[2023-07-20 22:00:14] [config] mini-batch-round-up: true
[2023-07-20 22:00:14] [config] mini-batch-track-lr: false
[2023-07-20 22:00:14] [config] mini-batch-warmup: 0
[2023-07-20 22:00:14] [config] mini-batch-words: 0
[2023-07-20 22:00:14] [config] mini-batch-words-ref: 0
[2023-07-20 22:00:14] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 22:00:14] [config] multi-loss-type: sum
[2023-07-20 22:00:14] [config] n-best: false
[2023-07-20 22:00:14] [config] no-nccl: false
[2023-07-20 22:00:14] [config] no-reload: false
[2023-07-20 22:00:14] [config] no-restore-corpus: false
[2023-07-20 22:00:14] [config] normalize: 0
[2023-07-20 22:00:14] [config] normalize-gradient: false
[2023-07-20 22:00:14] [config] num-devices: 0
[2023-07-20 22:00:14] [config] optimizer: adam
[2023-07-20 22:00:14] [config] optimizer-delay: 1
[2023-07-20 22:00:14] [config] optimizer-params:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] output-omit-bias: false
[2023-07-20 22:00:14] [config] overwrite: true
[2023-07-20 22:00:14] [config] precision:
[2023-07-20 22:00:14] [config]   - float16
[2023-07-20 22:00:14] [config]   - float32
[2023-07-20 22:00:14] [config] pretrained-model: ""
[2023-07-20 22:00:14] [config] quantize-biases: false
[2023-07-20 22:00:14] [config] quantize-bits: 0
[2023-07-20 22:00:14] [config] quantize-log-based: false
[2023-07-20 22:00:14] [config] quantize-optimization-steps: 0
[2023-07-20 22:00:14] [config] quiet: false
[2023-07-20 22:00:14] [config] quiet-translation: true
[2023-07-20 22:00:14] [config] relative-paths: false
[2023-07-20 22:00:14] [config] right-left: false
[2023-07-20 22:00:14] [config] save-freq: 10000u
[2023-07-20 22:00:14] [config] seed: 1234
[2023-07-20 22:00:14] [config] sentencepiece-alphas:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] sentencepiece-max-lines: 2000000
[2023-07-20 22:00:14] [config] sentencepiece-options: ""
[2023-07-20 22:00:14] [config] sharding: global
[2023-07-20 22:00:14] [config] shuffle: data
[2023-07-20 22:00:14] [config] shuffle-in-ram: false
[2023-07-20 22:00:14] [config] sigterm: save-and-exit
[2023-07-20 22:00:14] [config] skip: false
[2023-07-20 22:00:14] [config] sqlite: ""
[2023-07-20 22:00:14] [config] sqlite-drop: false
[2023-07-20 22:00:14] [config] sync-freq: 200u
[2023-07-20 22:00:14] [config] sync-sgd: false
[2023-07-20 22:00:14] [config] tempdir: /tmp
[2023-07-20 22:00:14] [config] tied-embeddings: false
[2023-07-20 22:00:14] [config] tied-embeddings-all: true
[2023-07-20 22:00:14] [config] tied-embeddings-src: false
[2023-07-20 22:00:14] [config] train-embedder-rank:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] train-sets:
[2023-07-20 22:00:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 22:00:14] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 22:00:14] [config] transformer-aan-activation: swish
[2023-07-20 22:00:14] [config] transformer-aan-depth: 2
[2023-07-20 22:00:14] [config] transformer-aan-nogate: false
[2023-07-20 22:00:14] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 22:00:14] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 22:00:14] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 22:00:14] [config] transformer-depth-scaling: false
[2023-07-20 22:00:14] [config] transformer-dim-aan: 2048
[2023-07-20 22:00:14] [config] transformer-dim-ffn: 2048
[2023-07-20 22:00:14] [config] transformer-dropout: 0
[2023-07-20 22:00:14] [config] transformer-dropout-attention: 0
[2023-07-20 22:00:14] [config] transformer-dropout-ffn: 0
[2023-07-20 22:00:14] [config] transformer-ffn-activation: swish
[2023-07-20 22:00:14] [config] transformer-ffn-depth: 2
[2023-07-20 22:00:14] [config] transformer-guided-alignment-layer: last
[2023-07-20 22:00:14] [config] transformer-heads: 8
[2023-07-20 22:00:14] [config] transformer-no-projection: false
[2023-07-20 22:00:14] [config] transformer-pool: false
[2023-07-20 22:00:14] [config] transformer-postprocess: dan
[2023-07-20 22:00:14] [config] transformer-postprocess-emb: d
[2023-07-20 22:00:14] [config] transformer-postprocess-top: ""
[2023-07-20 22:00:14] [config] transformer-preprocess: ""
[2023-07-20 22:00:14] [config] transformer-tied-layers:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] transformer-train-position-embeddings: false
[2023-07-20 22:00:14] [config] tsv: false
[2023-07-20 22:00:14] [config] tsv-fields: 0
[2023-07-20 22:00:14] [config] type: amun
[2023-07-20 22:00:14] [config] ulr: false
[2023-07-20 22:00:14] [config] ulr-dim-emb: 0
[2023-07-20 22:00:14] [config] ulr-dropout: 0
[2023-07-20 22:00:14] [config] ulr-keys-vectors: ""
[2023-07-20 22:00:14] [config] ulr-query-vectors: ""
[2023-07-20 22:00:14] [config] ulr-softmax-temperature: 1
[2023-07-20 22:00:14] [config] ulr-trainable-transformation: false
[2023-07-20 22:00:14] [config] unlikelihood-loss: false
[2023-07-20 22:00:14] [config] valid-freq: 50000000
[2023-07-20 22:00:14] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 22:00:14] [config] valid-max-length: 1000
[2023-07-20 22:00:14] [config] valid-metrics:
[2023-07-20 22:00:14] [config]   - cross-entropy
[2023-07-20 22:00:14] [config]   - translation
[2023-07-20 22:00:14] [config] valid-mini-batch: 32
[2023-07-20 22:00:14] [config] valid-reset-stalled: false
[2023-07-20 22:00:14] [config] valid-script-args:
[2023-07-20 22:00:14] [config]   []
[2023-07-20 22:00:14] [config] valid-script-path: ""
[2023-07-20 22:00:14] [config] valid-sets:
[2023-07-20 22:00:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 22:00:14] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 22:00:14] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 22:00:14] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 22:00:14] [config] vocabs:
[2023-07-20 22:00:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 22:00:14] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 22:00:14] [config] word-penalty: 0
[2023-07-20 22:00:14] [config] word-scores: false
[2023-07-20 22:00:14] [config] workspace: 5500
[2023-07-20 22:00:14] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 22:00:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 22:00:14] [training] Using single-device training
[2023-07-20 22:00:15] Synced seed 1234
[2023-07-20 22:00:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 22:00:15] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 22:00:15] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 22:00:15] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 22:00:15] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 22:00:15] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 22:00:15] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 22:00:16] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 22:00:17] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 22:00:17] [comm] Using global sharding
[2023-07-20 22:00:17] [comm] NCCLCommunicators constructed successfully
[2023-07-20 22:00:17] [training] Using 1 GPUs
[2023-07-20 22:00:17] [logits] Applying loss function for 1 factor(s)
[2023-07-20 22:00:17] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:00:17] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 22:00:17] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:41:20] [batching] Done. Typical MB size is 35,869 target words
[2023-07-20 22:41:21] [valid] No post-processing script given for validating translator
[2023-07-20 22:41:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 22:41:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 22:41:21] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 22:41:21] [comm] Using global sharding
[2023-07-20 22:41:21] [comm] NCCLCommunicators constructed successfully
[2023-07-20 22:41:21] [training] Using 1 GPUs
[2023-07-20 22:41:21] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 22:41:28] Allocating memory for general optimizer shards
[2023-07-20 22:41:28] [memory] Reserving 322 MB, device gpu0
[2023-07-20 22:41:28] Loading Adam parameters
[2023-07-20 22:41:28] [memory] Reserving 322 MB, device gpu0
[2023-07-20 22:41:28] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:41:28] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 22:41:28] [data] Restoring the corpus state to epoch 51, batch 1942
[2023-07-20 22:41:28] [data] Shuffling data
[2023-07-20 22:41:28] [data] Done reading 20,192 sentences
[2023-07-20 22:41:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:41:28] Training started
[2023-07-20 22:41:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-20 22:41:29] [memory] Reserving 80 MB, device gpu0
[2023-07-20 22:41:34] Parameter type float16, optimization type float32, casting types true
[2023-07-20 22:45:04] Seen 20,192 samples
[2023-07-20 22:45:04] Starting data epoch 52 in logical epoch 52
[2023-07-20 22:45:04] [data] Shuffling data
[2023-07-20 22:45:04] [data] Done reading 20,192 sentences
[2023-07-20 22:45:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:47:08] Ep. 52 : Up. 2000 : Sen. 10,063 : Cost 5.06882143 * 15,972,087 @ 13,007 after 31,981,997 : Time 348.01s : 45894.91 words/s : gNorm 0.9644
[2023-07-20 22:48:46] Seen 20,192 samples
[2023-07-20 22:48:46] Starting data epoch 53 in logical epoch 53
[2023-07-20 22:48:46] [data] Shuffling data
[2023-07-20 22:48:46] [data] Done reading 20,192 sentences
[2023-07-20 22:48:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:52:17] Seen 20,192 samples
[2023-07-20 22:52:17] Starting data epoch 54 in logical epoch 54
[2023-07-20 22:52:17] [data] Shuffling data
[2023-07-20 22:52:18] [data] Done reading 20,192 sentences
[2023-07-20 22:52:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:55:48] Seen 20,192 samples
[2023-07-20 22:55:48] Starting data epoch 55 in logical epoch 55
[2023-07-20 22:55:48] [data] Shuffling data
[2023-07-20 22:55:48] [data] Done reading 20,192 sentences
[2023-07-20 22:55:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 22:59:18] Seen 20,192 samples
[2023-07-20 22:59:18] Starting data epoch 56 in logical epoch 56
[2023-07-20 22:59:18] [data] Shuffling data
[2023-07-20 22:59:18] [data] Done reading 20,192 sentences
[2023-07-20 22:59:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:02:48] Seen 20,192 samples
[2023-07-20 23:02:48] Starting data epoch 57 in logical epoch 57
[2023-07-20 23:02:48] [data] Shuffling data
[2023-07-20 23:02:48] [data] Done reading 20,192 sentences
[2023-07-20 23:02:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:06:34] Seen 20,192 samples
[2023-07-20 23:06:34] Starting data epoch 58 in logical epoch 58
[2023-07-20 23:06:34] [data] Shuffling data
[2023-07-20 23:06:34] [data] Done reading 20,192 sentences
[2023-07-20 23:06:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:10:14] Seen 20,192 samples
[2023-07-20 23:10:14] Starting data epoch 59 in logical epoch 59
[2023-07-20 23:10:14] [data] Shuffling data
[2023-07-20 23:10:14] [data] Done reading 20,192 sentences
[2023-07-20 23:10:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:14:00] Seen 20,192 samples
[2023-07-20 23:14:00] Starting data epoch 60 in logical epoch 60
[2023-07-20 23:14:00] [data] Shuffling data
[2023-07-20 23:14:00] [data] Done reading 20,192 sentences
[2023-07-20 23:14:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-20 23:17:48] Seen 20,192 samples
[2023-07-20 23:17:48] Starting data epoch 61 in logical epoch 61
[2023-07-20 23:17:48] Training finished
[2023-07-20 23:17:57] [valid] Ep. 61 : Up. 2328 : cross-entropy : 143.684 : new best
[2023-07-20 23:19:44] [valid] Ep. 61 : Up. 2328 : translation : 0 : new best
[2023-07-20 23:19:44] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 23:19:46] Saving Adam parameters
[2023-07-20 23:19:47] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-20 23:19:55] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 23:19:55] [marian] Running on node18.datos.cluster.uy as process 24086 with command line:
[2023-07-20 23:19:55] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-20 23:19:55] [config] after: 0e
[2023-07-20 23:19:55] [config] after-batches: 0
[2023-07-20 23:19:55] [config] after-epochs: 70
[2023-07-20 23:19:55] [config] all-caps-every: 0
[2023-07-20 23:19:55] [config] allow-unk: false
[2023-07-20 23:19:55] [config] authors: false
[2023-07-20 23:19:55] [config] beam-size: 12
[2023-07-20 23:19:55] [config] bert-class-symbol: "[CLS]"
[2023-07-20 23:19:55] [config] bert-mask-symbol: "[MASK]"
[2023-07-20 23:19:55] [config] bert-masking-fraction: 0.15
[2023-07-20 23:19:55] [config] bert-sep-symbol: "[SEP]"
[2023-07-20 23:19:55] [config] bert-train-type-embeddings: true
[2023-07-20 23:19:55] [config] bert-type-vocab-size: 2
[2023-07-20 23:19:55] [config] build-info: ""
[2023-07-20 23:19:55] [config] check-gradient-nan: false
[2023-07-20 23:19:55] [config] check-nan: false
[2023-07-20 23:19:55] [config] cite: false
[2023-07-20 23:19:55] [config] clip-norm: 1
[2023-07-20 23:19:55] [config] cost-scaling:
[2023-07-20 23:19:55] [config]   - 256.f
[2023-07-20 23:19:55] [config]   - 1000
[2023-07-20 23:19:55] [config]   - 2.f
[2023-07-20 23:19:55] [config]   - 256.f
[2023-07-20 23:19:55] [config] cost-type: ce-sum
[2023-07-20 23:19:55] [config] cpu-threads: 0
[2023-07-20 23:19:55] [config] data-threads: 8
[2023-07-20 23:19:55] [config] data-weighting: ""
[2023-07-20 23:19:55] [config] data-weighting-type: sentence
[2023-07-20 23:19:55] [config] dec-cell: gru
[2023-07-20 23:19:55] [config] dec-cell-base-depth: 2
[2023-07-20 23:19:55] [config] dec-cell-high-depth: 1
[2023-07-20 23:19:55] [config] dec-depth: 1
[2023-07-20 23:19:55] [config] devices:
[2023-07-20 23:19:55] [config]   - 0
[2023-07-20 23:19:55] [config] dim-emb: 512
[2023-07-20 23:19:55] [config] dim-rnn: 1024
[2023-07-20 23:19:55] [config] dim-vocabs:
[2023-07-20 23:19:55] [config]   - 16384
[2023-07-20 23:19:55] [config]   - 16384
[2023-07-20 23:19:55] [config] disp-first: 0
[2023-07-20 23:19:55] [config] disp-freq: 1000u
[2023-07-20 23:19:55] [config] disp-label-counts: true
[2023-07-20 23:19:55] [config] dropout-rnn: 0
[2023-07-20 23:19:55] [config] dropout-src: 0
[2023-07-20 23:19:55] [config] dropout-trg: 0
[2023-07-20 23:19:55] [config] dump-config: ""
[2023-07-20 23:19:55] [config] dynamic-gradient-scaling:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] early-stopping: 200
[2023-07-20 23:19:55] [config] early-stopping-on: first
[2023-07-20 23:19:55] [config] embedding-fix-src: false
[2023-07-20 23:19:55] [config] embedding-fix-trg: false
[2023-07-20 23:19:55] [config] embedding-normalization: false
[2023-07-20 23:19:55] [config] embedding-vectors:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] enc-cell: gru
[2023-07-20 23:19:55] [config] enc-cell-depth: 1
[2023-07-20 23:19:55] [config] enc-depth: 1
[2023-07-20 23:19:55] [config] enc-type: bidirectional
[2023-07-20 23:19:55] [config] english-title-case-every: 0
[2023-07-20 23:19:55] [config] exponential-smoothing: 0
[2023-07-20 23:19:55] [config] factor-weight: 1
[2023-07-20 23:19:55] [config] factors-combine: sum
[2023-07-20 23:19:55] [config] factors-dim-emb: 0
[2023-07-20 23:19:55] [config] gradient-checkpointing: false
[2023-07-20 23:19:55] [config] gradient-norm-average-window: 100
[2023-07-20 23:19:55] [config] guided-alignment: none
[2023-07-20 23:19:55] [config] guided-alignment-cost: mse
[2023-07-20 23:19:55] [config] guided-alignment-weight: 0.1
[2023-07-20 23:19:55] [config] ignore-model-config: false
[2023-07-20 23:19:55] [config] input-types:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] interpolate-env-vars: false
[2023-07-20 23:19:55] [config] keep-best: false
[2023-07-20 23:19:55] [config] label-smoothing: 0
[2023-07-20 23:19:55] [config] layer-normalization: false
[2023-07-20 23:19:55] [config] learn-rate: 0.0001
[2023-07-20 23:19:55] [config] lemma-dependency: ""
[2023-07-20 23:19:55] [config] lemma-dim-emb: 0
[2023-07-20 23:19:55] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 23:19:55] [config] log-level: info
[2023-07-20 23:19:55] [config] log-time-zone: ""
[2023-07-20 23:19:55] [config] logical-epoch:
[2023-07-20 23:19:55] [config]   - 1e
[2023-07-20 23:19:55] [config]   - 0
[2023-07-20 23:19:55] [config] lr-decay: 0
[2023-07-20 23:19:55] [config] lr-decay-freq: 50000
[2023-07-20 23:19:55] [config] lr-decay-inv-sqrt:
[2023-07-20 23:19:55] [config]   - 0
[2023-07-20 23:19:55] [config] lr-decay-repeat-warmup: false
[2023-07-20 23:19:55] [config] lr-decay-reset-optimizer: false
[2023-07-20 23:19:55] [config] lr-decay-start:
[2023-07-20 23:19:55] [config]   - 10
[2023-07-20 23:19:55] [config]   - 1
[2023-07-20 23:19:55] [config] lr-decay-strategy: epoch+stalled
[2023-07-20 23:19:55] [config] lr-report: false
[2023-07-20 23:19:55] [config] lr-warmup: 0
[2023-07-20 23:19:55] [config] lr-warmup-at-reload: false
[2023-07-20 23:19:55] [config] lr-warmup-cycle: false
[2023-07-20 23:19:55] [config] lr-warmup-start-rate: 0
[2023-07-20 23:19:55] [config] max-length: 250
[2023-07-20 23:19:55] [config] max-length-crop: true
[2023-07-20 23:19:55] [config] max-length-factor: 3
[2023-07-20 23:19:55] [config] maxi-batch: 100
[2023-07-20 23:19:55] [config] maxi-batch-sort: trg
[2023-07-20 23:19:55] [config] mini-batch: 64
[2023-07-20 23:19:55] [config] mini-batch-fit: true
[2023-07-20 23:19:55] [config] mini-batch-fit-step: 10
[2023-07-20 23:19:55] [config] mini-batch-round-up: true
[2023-07-20 23:19:55] [config] mini-batch-track-lr: false
[2023-07-20 23:19:55] [config] mini-batch-warmup: 0
[2023-07-20 23:19:55] [config] mini-batch-words: 0
[2023-07-20 23:19:55] [config] mini-batch-words-ref: 0
[2023-07-20 23:19:55] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-20 23:19:55] [config] multi-loss-type: sum
[2023-07-20 23:19:55] [config] n-best: false
[2023-07-20 23:19:55] [config] no-nccl: false
[2023-07-20 23:19:55] [config] no-reload: false
[2023-07-20 23:19:55] [config] no-restore-corpus: false
[2023-07-20 23:19:55] [config] normalize: 0
[2023-07-20 23:19:55] [config] normalize-gradient: false
[2023-07-20 23:19:55] [config] num-devices: 0
[2023-07-20 23:19:55] [config] optimizer: adam
[2023-07-20 23:19:55] [config] optimizer-delay: 1
[2023-07-20 23:19:55] [config] optimizer-params:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] output-omit-bias: false
[2023-07-20 23:19:55] [config] overwrite: true
[2023-07-20 23:19:55] [config] precision:
[2023-07-20 23:19:55] [config]   - float16
[2023-07-20 23:19:55] [config]   - float32
[2023-07-20 23:19:55] [config] pretrained-model: ""
[2023-07-20 23:19:55] [config] quantize-biases: false
[2023-07-20 23:19:55] [config] quantize-bits: 0
[2023-07-20 23:19:55] [config] quantize-log-based: false
[2023-07-20 23:19:55] [config] quantize-optimization-steps: 0
[2023-07-20 23:19:55] [config] quiet: false
[2023-07-20 23:19:55] [config] quiet-translation: true
[2023-07-20 23:19:55] [config] relative-paths: false
[2023-07-20 23:19:55] [config] right-left: false
[2023-07-20 23:19:55] [config] save-freq: 10000u
[2023-07-20 23:19:55] [config] seed: 1234
[2023-07-20 23:19:55] [config] sentencepiece-alphas:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] sentencepiece-max-lines: 2000000
[2023-07-20 23:19:55] [config] sentencepiece-options: ""
[2023-07-20 23:19:55] [config] sharding: global
[2023-07-20 23:19:55] [config] shuffle: data
[2023-07-20 23:19:55] [config] shuffle-in-ram: false
[2023-07-20 23:19:55] [config] sigterm: save-and-exit
[2023-07-20 23:19:55] [config] skip: false
[2023-07-20 23:19:55] [config] sqlite: ""
[2023-07-20 23:19:55] [config] sqlite-drop: false
[2023-07-20 23:19:55] [config] sync-freq: 200u
[2023-07-20 23:19:55] [config] sync-sgd: false
[2023-07-20 23:19:55] [config] tempdir: /tmp
[2023-07-20 23:19:55] [config] tied-embeddings: false
[2023-07-20 23:19:55] [config] tied-embeddings-all: true
[2023-07-20 23:19:55] [config] tied-embeddings-src: false
[2023-07-20 23:19:55] [config] train-embedder-rank:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] train-sets:
[2023-07-20 23:19:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-20 23:19:55] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-20 23:19:55] [config] transformer-aan-activation: swish
[2023-07-20 23:19:55] [config] transformer-aan-depth: 2
[2023-07-20 23:19:55] [config] transformer-aan-nogate: false
[2023-07-20 23:19:55] [config] transformer-decoder-autoreg: self-attention
[2023-07-20 23:19:55] [config] transformer-decoder-dim-ffn: 0
[2023-07-20 23:19:55] [config] transformer-decoder-ffn-depth: 0
[2023-07-20 23:19:55] [config] transformer-depth-scaling: false
[2023-07-20 23:19:55] [config] transformer-dim-aan: 2048
[2023-07-20 23:19:55] [config] transformer-dim-ffn: 2048
[2023-07-20 23:19:55] [config] transformer-dropout: 0
[2023-07-20 23:19:55] [config] transformer-dropout-attention: 0
[2023-07-20 23:19:55] [config] transformer-dropout-ffn: 0
[2023-07-20 23:19:55] [config] transformer-ffn-activation: swish
[2023-07-20 23:19:55] [config] transformer-ffn-depth: 2
[2023-07-20 23:19:55] [config] transformer-guided-alignment-layer: last
[2023-07-20 23:19:55] [config] transformer-heads: 8
[2023-07-20 23:19:55] [config] transformer-no-projection: false
[2023-07-20 23:19:55] [config] transformer-pool: false
[2023-07-20 23:19:55] [config] transformer-postprocess: dan
[2023-07-20 23:19:55] [config] transformer-postprocess-emb: d
[2023-07-20 23:19:55] [config] transformer-postprocess-top: ""
[2023-07-20 23:19:55] [config] transformer-preprocess: ""
[2023-07-20 23:19:55] [config] transformer-tied-layers:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] transformer-train-position-embeddings: false
[2023-07-20 23:19:55] [config] tsv: false
[2023-07-20 23:19:55] [config] tsv-fields: 0
[2023-07-20 23:19:55] [config] type: amun
[2023-07-20 23:19:55] [config] ulr: false
[2023-07-20 23:19:55] [config] ulr-dim-emb: 0
[2023-07-20 23:19:55] [config] ulr-dropout: 0
[2023-07-20 23:19:55] [config] ulr-keys-vectors: ""
[2023-07-20 23:19:55] [config] ulr-query-vectors: ""
[2023-07-20 23:19:55] [config] ulr-softmax-temperature: 1
[2023-07-20 23:19:55] [config] ulr-trainable-transformation: false
[2023-07-20 23:19:55] [config] unlikelihood-loss: false
[2023-07-20 23:19:55] [config] valid-freq: 50000000
[2023-07-20 23:19:55] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-20 23:19:55] [config] valid-max-length: 1000
[2023-07-20 23:19:55] [config] valid-metrics:
[2023-07-20 23:19:55] [config]   - cross-entropy
[2023-07-20 23:19:55] [config]   - translation
[2023-07-20 23:19:55] [config] valid-mini-batch: 32
[2023-07-20 23:19:55] [config] valid-reset-stalled: false
[2023-07-20 23:19:55] [config] valid-script-args:
[2023-07-20 23:19:55] [config]   []
[2023-07-20 23:19:55] [config] valid-script-path: ""
[2023-07-20 23:19:55] [config] valid-sets:
[2023-07-20 23:19:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-20 23:19:55] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-20 23:19:55] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-20 23:19:55] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 23:19:55] [config] vocabs:
[2023-07-20 23:19:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 23:19:55] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 23:19:55] [config] word-penalty: 0
[2023-07-20 23:19:55] [config] word-scores: false
[2023-07-20 23:19:55] [config] workspace: 5500
[2023-07-20 23:19:55] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-20 23:19:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 23:19:55] [training] Using single-device training
[2023-07-20 23:19:56] Synced seed 1234
[2023-07-20 23:19:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-20 23:19:56] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-20 23:19:56] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-20 23:19:56] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-20 23:19:56] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-20 23:19:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-20 23:19:56] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-20 23:19:57] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-20 23:19:58] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-20 23:19:58] [comm] Using global sharding
[2023-07-20 23:19:58] [comm] NCCLCommunicators constructed successfully
[2023-07-20 23:19:58] [training] Using 1 GPUs
[2023-07-20 23:19:58] [logits] Applying loss function for 1 factor(s)
[2023-07-20 23:19:58] [memory] Reserving 80 MB, device gpu0
[2023-07-20 23:19:58] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-20 23:19:58] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:00:22] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 00:00:22] [valid] No post-processing script given for validating translator
[2023-07-21 00:00:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 00:00:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 00:00:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 00:00:22] [comm] Using global sharding
[2023-07-21 00:00:22] [comm] NCCLCommunicators constructed successfully
[2023-07-21 00:00:22] [training] Using 1 GPUs
[2023-07-21 00:00:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 00:00:29] Allocating memory for general optimizer shards
[2023-07-21 00:00:29] [memory] Reserving 322 MB, device gpu0
[2023-07-21 00:00:29] Loading Adam parameters
[2023-07-21 00:00:29] [memory] Reserving 322 MB, device gpu0
[2023-07-21 00:00:29] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:00:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 00:00:29] [data] Restoring the corpus state to epoch 61, batch 2328
[2023-07-21 00:00:29] [data] Shuffling data
[2023-07-21 00:00:29] [data] Done reading 20,192 sentences
[2023-07-21 00:00:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:00:29] Training started
[2023-07-21 00:00:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 00:00:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:00:31] Parameter type float16, optimization type float32, casting types true
[2023-07-21 00:04:04] Seen 20,192 samples
[2023-07-21 00:04:04] Starting data epoch 62 in logical epoch 62
[2023-07-21 00:04:04] [data] Shuffling data
[2023-07-21 00:04:04] [data] Done reading 20,192 sentences
[2023-07-21 00:04:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:07:42] Seen 20,192 samples
[2023-07-21 00:07:42] Starting data epoch 63 in logical epoch 63
[2023-07-21 00:07:42] [data] Shuffling data
[2023-07-21 00:07:42] [data] Done reading 20,192 sentences
[2023-07-21 00:07:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:11:17] Seen 20,192 samples
[2023-07-21 00:11:17] Starting data epoch 64 in logical epoch 64
[2023-07-21 00:11:17] [data] Shuffling data
[2023-07-21 00:11:17] [data] Done reading 20,192 sentences
[2023-07-21 00:11:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:14:57] Seen 20,192 samples
[2023-07-21 00:14:57] Starting data epoch 65 in logical epoch 65
[2023-07-21 00:14:57] [data] Shuffling data
[2023-07-21 00:14:57] [data] Done reading 20,192 sentences
[2023-07-21 00:14:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:18:30] Seen 20,192 samples
[2023-07-21 00:18:30] Starting data epoch 66 in logical epoch 66
[2023-07-21 00:18:30] [data] Shuffling data
[2023-07-21 00:18:30] [data] Done reading 20,192 sentences
[2023-07-21 00:18:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:21:55] Seen 20,192 samples
[2023-07-21 00:21:55] Starting data epoch 67 in logical epoch 67
[2023-07-21 00:21:55] [data] Shuffling data
[2023-07-21 00:21:55] [data] Done reading 20,192 sentences
[2023-07-21 00:21:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:25:23] Seen 20,192 samples
[2023-07-21 00:25:23] Starting data epoch 68 in logical epoch 68
[2023-07-21 00:25:23] [data] Shuffling data
[2023-07-21 00:25:23] [data] Done reading 20,192 sentences
[2023-07-21 00:25:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:28:55] Seen 20,192 samples
[2023-07-21 00:28:55] Starting data epoch 69 in logical epoch 69
[2023-07-21 00:28:55] [data] Shuffling data
[2023-07-21 00:28:55] [data] Done reading 20,192 sentences
[2023-07-21 00:28:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:32:29] Seen 20,192 samples
[2023-07-21 00:32:29] Starting data epoch 70 in logical epoch 70
[2023-07-21 00:32:29] [data] Shuffling data
[2023-07-21 00:32:29] [data] Done reading 20,192 sentences
[2023-07-21 00:32:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 00:35:49] Seen 20,192 samples
[2023-07-21 00:35:49] Starting data epoch 71 in logical epoch 71
[2023-07-21 00:35:49] Training finished
[2023-07-21 00:35:58] [valid] Ep. 71 : Up. 2712 : cross-entropy : 140.473 : new best
[2023-07-21 00:38:07] [valid] Ep. 71 : Up. 2712 : translation : 0 : new best
[2023-07-21 00:38:07] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 00:38:10] Saving Adam parameters
[2023-07-21 00:38:10] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 00:38:17] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 00:38:17] [marian] Running on node18.datos.cluster.uy as process 29566 with command line:
[2023-07-21 00:38:17] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 00:38:18] [config] after: 0e
[2023-07-21 00:38:18] [config] after-batches: 0
[2023-07-21 00:38:18] [config] after-epochs: 80
[2023-07-21 00:38:18] [config] all-caps-every: 0
[2023-07-21 00:38:18] [config] allow-unk: false
[2023-07-21 00:38:18] [config] authors: false
[2023-07-21 00:38:18] [config] beam-size: 12
[2023-07-21 00:38:18] [config] bert-class-symbol: "[CLS]"
[2023-07-21 00:38:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 00:38:18] [config] bert-masking-fraction: 0.15
[2023-07-21 00:38:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 00:38:18] [config] bert-train-type-embeddings: true
[2023-07-21 00:38:18] [config] bert-type-vocab-size: 2
[2023-07-21 00:38:18] [config] build-info: ""
[2023-07-21 00:38:18] [config] check-gradient-nan: false
[2023-07-21 00:38:18] [config] check-nan: false
[2023-07-21 00:38:18] [config] cite: false
[2023-07-21 00:38:18] [config] clip-norm: 1
[2023-07-21 00:38:18] [config] cost-scaling:
[2023-07-21 00:38:18] [config]   - 256.f
[2023-07-21 00:38:18] [config]   - 1000
[2023-07-21 00:38:18] [config]   - 2.f
[2023-07-21 00:38:18] [config]   - 256.f
[2023-07-21 00:38:18] [config] cost-type: ce-sum
[2023-07-21 00:38:18] [config] cpu-threads: 0
[2023-07-21 00:38:18] [config] data-threads: 8
[2023-07-21 00:38:18] [config] data-weighting: ""
[2023-07-21 00:38:18] [config] data-weighting-type: sentence
[2023-07-21 00:38:18] [config] dec-cell: gru
[2023-07-21 00:38:18] [config] dec-cell-base-depth: 2
[2023-07-21 00:38:18] [config] dec-cell-high-depth: 1
[2023-07-21 00:38:18] [config] dec-depth: 1
[2023-07-21 00:38:18] [config] devices:
[2023-07-21 00:38:18] [config]   - 0
[2023-07-21 00:38:18] [config] dim-emb: 512
[2023-07-21 00:38:18] [config] dim-rnn: 1024
[2023-07-21 00:38:18] [config] dim-vocabs:
[2023-07-21 00:38:18] [config]   - 16384
[2023-07-21 00:38:18] [config]   - 16384
[2023-07-21 00:38:18] [config] disp-first: 0
[2023-07-21 00:38:18] [config] disp-freq: 1000u
[2023-07-21 00:38:18] [config] disp-label-counts: true
[2023-07-21 00:38:18] [config] dropout-rnn: 0
[2023-07-21 00:38:18] [config] dropout-src: 0
[2023-07-21 00:38:18] [config] dropout-trg: 0
[2023-07-21 00:38:18] [config] dump-config: ""
[2023-07-21 00:38:18] [config] dynamic-gradient-scaling:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] early-stopping: 200
[2023-07-21 00:38:18] [config] early-stopping-on: first
[2023-07-21 00:38:18] [config] embedding-fix-src: false
[2023-07-21 00:38:18] [config] embedding-fix-trg: false
[2023-07-21 00:38:18] [config] embedding-normalization: false
[2023-07-21 00:38:18] [config] embedding-vectors:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] enc-cell: gru
[2023-07-21 00:38:18] [config] enc-cell-depth: 1
[2023-07-21 00:38:18] [config] enc-depth: 1
[2023-07-21 00:38:18] [config] enc-type: bidirectional
[2023-07-21 00:38:18] [config] english-title-case-every: 0
[2023-07-21 00:38:18] [config] exponential-smoothing: 0
[2023-07-21 00:38:18] [config] factor-weight: 1
[2023-07-21 00:38:18] [config] factors-combine: sum
[2023-07-21 00:38:18] [config] factors-dim-emb: 0
[2023-07-21 00:38:18] [config] gradient-checkpointing: false
[2023-07-21 00:38:18] [config] gradient-norm-average-window: 100
[2023-07-21 00:38:18] [config] guided-alignment: none
[2023-07-21 00:38:18] [config] guided-alignment-cost: mse
[2023-07-21 00:38:18] [config] guided-alignment-weight: 0.1
[2023-07-21 00:38:18] [config] ignore-model-config: false
[2023-07-21 00:38:18] [config] input-types:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] interpolate-env-vars: false
[2023-07-21 00:38:18] [config] keep-best: false
[2023-07-21 00:38:18] [config] label-smoothing: 0
[2023-07-21 00:38:18] [config] layer-normalization: false
[2023-07-21 00:38:18] [config] learn-rate: 0.0001
[2023-07-21 00:38:18] [config] lemma-dependency: ""
[2023-07-21 00:38:18] [config] lemma-dim-emb: 0
[2023-07-21 00:38:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 00:38:18] [config] log-level: info
[2023-07-21 00:38:18] [config] log-time-zone: ""
[2023-07-21 00:38:18] [config] logical-epoch:
[2023-07-21 00:38:18] [config]   - 1e
[2023-07-21 00:38:18] [config]   - 0
[2023-07-21 00:38:18] [config] lr-decay: 0
[2023-07-21 00:38:18] [config] lr-decay-freq: 50000
[2023-07-21 00:38:18] [config] lr-decay-inv-sqrt:
[2023-07-21 00:38:18] [config]   - 0
[2023-07-21 00:38:18] [config] lr-decay-repeat-warmup: false
[2023-07-21 00:38:18] [config] lr-decay-reset-optimizer: false
[2023-07-21 00:38:18] [config] lr-decay-start:
[2023-07-21 00:38:18] [config]   - 10
[2023-07-21 00:38:18] [config]   - 1
[2023-07-21 00:38:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 00:38:18] [config] lr-report: false
[2023-07-21 00:38:18] [config] lr-warmup: 0
[2023-07-21 00:38:18] [config] lr-warmup-at-reload: false
[2023-07-21 00:38:18] [config] lr-warmup-cycle: false
[2023-07-21 00:38:18] [config] lr-warmup-start-rate: 0
[2023-07-21 00:38:18] [config] max-length: 250
[2023-07-21 00:38:18] [config] max-length-crop: true
[2023-07-21 00:38:18] [config] max-length-factor: 3
[2023-07-21 00:38:18] [config] maxi-batch: 100
[2023-07-21 00:38:18] [config] maxi-batch-sort: trg
[2023-07-21 00:38:18] [config] mini-batch: 64
[2023-07-21 00:38:18] [config] mini-batch-fit: true
[2023-07-21 00:38:18] [config] mini-batch-fit-step: 10
[2023-07-21 00:38:18] [config] mini-batch-round-up: true
[2023-07-21 00:38:18] [config] mini-batch-track-lr: false
[2023-07-21 00:38:18] [config] mini-batch-warmup: 0
[2023-07-21 00:38:18] [config] mini-batch-words: 0
[2023-07-21 00:38:18] [config] mini-batch-words-ref: 0
[2023-07-21 00:38:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 00:38:18] [config] multi-loss-type: sum
[2023-07-21 00:38:18] [config] n-best: false
[2023-07-21 00:38:18] [config] no-nccl: false
[2023-07-21 00:38:18] [config] no-reload: false
[2023-07-21 00:38:18] [config] no-restore-corpus: false
[2023-07-21 00:38:18] [config] normalize: 0
[2023-07-21 00:38:18] [config] normalize-gradient: false
[2023-07-21 00:38:18] [config] num-devices: 0
[2023-07-21 00:38:18] [config] optimizer: adam
[2023-07-21 00:38:18] [config] optimizer-delay: 1
[2023-07-21 00:38:18] [config] optimizer-params:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] output-omit-bias: false
[2023-07-21 00:38:18] [config] overwrite: true
[2023-07-21 00:38:18] [config] precision:
[2023-07-21 00:38:18] [config]   - float16
[2023-07-21 00:38:18] [config]   - float32
[2023-07-21 00:38:18] [config] pretrained-model: ""
[2023-07-21 00:38:18] [config] quantize-biases: false
[2023-07-21 00:38:18] [config] quantize-bits: 0
[2023-07-21 00:38:18] [config] quantize-log-based: false
[2023-07-21 00:38:18] [config] quantize-optimization-steps: 0
[2023-07-21 00:38:18] [config] quiet: false
[2023-07-21 00:38:18] [config] quiet-translation: true
[2023-07-21 00:38:18] [config] relative-paths: false
[2023-07-21 00:38:18] [config] right-left: false
[2023-07-21 00:38:18] [config] save-freq: 10000u
[2023-07-21 00:38:18] [config] seed: 1234
[2023-07-21 00:38:18] [config] sentencepiece-alphas:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] sentencepiece-max-lines: 2000000
[2023-07-21 00:38:18] [config] sentencepiece-options: ""
[2023-07-21 00:38:18] [config] sharding: global
[2023-07-21 00:38:18] [config] shuffle: data
[2023-07-21 00:38:18] [config] shuffle-in-ram: false
[2023-07-21 00:38:18] [config] sigterm: save-and-exit
[2023-07-21 00:38:18] [config] skip: false
[2023-07-21 00:38:18] [config] sqlite: ""
[2023-07-21 00:38:18] [config] sqlite-drop: false
[2023-07-21 00:38:18] [config] sync-freq: 200u
[2023-07-21 00:38:18] [config] sync-sgd: false
[2023-07-21 00:38:18] [config] tempdir: /tmp
[2023-07-21 00:38:18] [config] tied-embeddings: false
[2023-07-21 00:38:18] [config] tied-embeddings-all: true
[2023-07-21 00:38:18] [config] tied-embeddings-src: false
[2023-07-21 00:38:18] [config] train-embedder-rank:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] train-sets:
[2023-07-21 00:38:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 00:38:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 00:38:18] [config] transformer-aan-activation: swish
[2023-07-21 00:38:18] [config] transformer-aan-depth: 2
[2023-07-21 00:38:18] [config] transformer-aan-nogate: false
[2023-07-21 00:38:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 00:38:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 00:38:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 00:38:18] [config] transformer-depth-scaling: false
[2023-07-21 00:38:18] [config] transformer-dim-aan: 2048
[2023-07-21 00:38:18] [config] transformer-dim-ffn: 2048
[2023-07-21 00:38:18] [config] transformer-dropout: 0
[2023-07-21 00:38:18] [config] transformer-dropout-attention: 0
[2023-07-21 00:38:18] [config] transformer-dropout-ffn: 0
[2023-07-21 00:38:18] [config] transformer-ffn-activation: swish
[2023-07-21 00:38:18] [config] transformer-ffn-depth: 2
[2023-07-21 00:38:18] [config] transformer-guided-alignment-layer: last
[2023-07-21 00:38:18] [config] transformer-heads: 8
[2023-07-21 00:38:18] [config] transformer-no-projection: false
[2023-07-21 00:38:18] [config] transformer-pool: false
[2023-07-21 00:38:18] [config] transformer-postprocess: dan
[2023-07-21 00:38:18] [config] transformer-postprocess-emb: d
[2023-07-21 00:38:18] [config] transformer-postprocess-top: ""
[2023-07-21 00:38:18] [config] transformer-preprocess: ""
[2023-07-21 00:38:18] [config] transformer-tied-layers:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] transformer-train-position-embeddings: false
[2023-07-21 00:38:18] [config] tsv: false
[2023-07-21 00:38:18] [config] tsv-fields: 0
[2023-07-21 00:38:18] [config] type: amun
[2023-07-21 00:38:18] [config] ulr: false
[2023-07-21 00:38:18] [config] ulr-dim-emb: 0
[2023-07-21 00:38:18] [config] ulr-dropout: 0
[2023-07-21 00:38:18] [config] ulr-keys-vectors: ""
[2023-07-21 00:38:18] [config] ulr-query-vectors: ""
[2023-07-21 00:38:18] [config] ulr-softmax-temperature: 1
[2023-07-21 00:38:18] [config] ulr-trainable-transformation: false
[2023-07-21 00:38:18] [config] unlikelihood-loss: false
[2023-07-21 00:38:18] [config] valid-freq: 50000000
[2023-07-21 00:38:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 00:38:18] [config] valid-max-length: 1000
[2023-07-21 00:38:18] [config] valid-metrics:
[2023-07-21 00:38:18] [config]   - cross-entropy
[2023-07-21 00:38:18] [config]   - translation
[2023-07-21 00:38:18] [config] valid-mini-batch: 32
[2023-07-21 00:38:18] [config] valid-reset-stalled: false
[2023-07-21 00:38:18] [config] valid-script-args:
[2023-07-21 00:38:18] [config]   []
[2023-07-21 00:38:18] [config] valid-script-path: ""
[2023-07-21 00:38:18] [config] valid-sets:
[2023-07-21 00:38:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 00:38:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 00:38:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 00:38:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 00:38:18] [config] vocabs:
[2023-07-21 00:38:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 00:38:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 00:38:18] [config] word-penalty: 0
[2023-07-21 00:38:18] [config] word-scores: false
[2023-07-21 00:38:18] [config] workspace: 5500
[2023-07-21 00:38:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 00:38:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 00:38:18] [training] Using single-device training
[2023-07-21 00:38:18] Synced seed 1234
[2023-07-21 00:38:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 00:38:19] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 00:38:19] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 00:38:19] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 00:38:19] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 00:38:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 00:38:19] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 00:38:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 00:38:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 00:38:20] [comm] Using global sharding
[2023-07-21 00:38:20] [comm] NCCLCommunicators constructed successfully
[2023-07-21 00:38:20] [training] Using 1 GPUs
[2023-07-21 00:38:20] [logits] Applying loss function for 1 factor(s)
[2023-07-21 00:38:20] [memory] Reserving 80 MB, device gpu0
[2023-07-21 00:38:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 00:38:20] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:19:18] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 01:19:19] [valid] No post-processing script given for validating translator
[2023-07-21 01:19:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 01:19:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 01:19:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 01:19:19] [comm] Using global sharding
[2023-07-21 01:19:19] [comm] NCCLCommunicators constructed successfully
[2023-07-21 01:19:19] [training] Using 1 GPUs
[2023-07-21 01:19:19] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 01:19:25] Allocating memory for general optimizer shards
[2023-07-21 01:19:25] [memory] Reserving 322 MB, device gpu0
[2023-07-21 01:19:25] Loading Adam parameters
[2023-07-21 01:19:25] [memory] Reserving 322 MB, device gpu0
[2023-07-21 01:19:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:19:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 01:19:25] [data] Restoring the corpus state to epoch 71, batch 2712
[2023-07-21 01:19:25] [data] Shuffling data
[2023-07-21 01:19:25] [data] Done reading 20,192 sentences
[2023-07-21 01:19:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:19:25] Training started
[2023-07-21 01:19:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 01:19:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:19:29] Parameter type float16, optimization type float32, casting types true
[2023-07-21 01:22:50] Seen 20,192 samples
[2023-07-21 01:22:50] Starting data epoch 72 in logical epoch 72
[2023-07-21 01:22:50] [data] Shuffling data
[2023-07-21 01:22:50] [data] Done reading 20,192 sentences
[2023-07-21 01:22:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:26:14] Seen 20,192 samples
[2023-07-21 01:26:14] Starting data epoch 73 in logical epoch 73
[2023-07-21 01:26:14] [data] Shuffling data
[2023-07-21 01:26:14] [data] Done reading 20,192 sentences
[2023-07-21 01:26:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:30:02] Seen 20,192 samples
[2023-07-21 01:30:02] Starting data epoch 74 in logical epoch 74
[2023-07-21 01:30:02] [data] Shuffling data
[2023-07-21 01:30:02] [data] Done reading 20,192 sentences
[2023-07-21 01:30:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:33:45] Seen 20,192 samples
[2023-07-21 01:33:45] Starting data epoch 75 in logical epoch 75
[2023-07-21 01:33:45] [data] Shuffling data
[2023-07-21 01:33:45] [data] Done reading 20,192 sentences
[2023-07-21 01:33:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:37:29] Seen 20,192 samples
[2023-07-21 01:37:29] Starting data epoch 76 in logical epoch 76
[2023-07-21 01:37:29] [data] Shuffling data
[2023-07-21 01:37:29] [data] Done reading 20,192 sentences
[2023-07-21 01:37:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:41:21] Seen 20,192 samples
[2023-07-21 01:41:21] Starting data epoch 77 in logical epoch 77
[2023-07-21 01:41:21] [data] Shuffling data
[2023-07-21 01:41:21] [data] Done reading 20,192 sentences
[2023-07-21 01:41:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:45:02] Seen 20,192 samples
[2023-07-21 01:45:02] Starting data epoch 78 in logical epoch 78
[2023-07-21 01:45:02] [data] Shuffling data
[2023-07-21 01:45:02] [data] Done reading 20,192 sentences
[2023-07-21 01:45:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:46:36] Ep. 78 : Up. 3000 : Sen. 9,784 : Cost 4.40286016 * 16,069,652 @ 9,615 after 48,051,652 : Time 1637.07s : 9816.10 words/s : gNorm 1.0688
[2023-07-21 01:48:53] Seen 20,192 samples
[2023-07-21 01:48:53] Starting data epoch 79 in logical epoch 79
[2023-07-21 01:48:53] [data] Shuffling data
[2023-07-21 01:48:53] [data] Done reading 20,192 sentences
[2023-07-21 01:48:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:52:20] Seen 20,192 samples
[2023-07-21 01:52:20] Starting data epoch 80 in logical epoch 80
[2023-07-21 01:52:20] [data] Shuffling data
[2023-07-21 01:52:20] [data] Done reading 20,192 sentences
[2023-07-21 01:52:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 01:55:48] Seen 20,192 samples
[2023-07-21 01:55:48] Starting data epoch 81 in logical epoch 81
[2023-07-21 01:55:48] Training finished
[2023-07-21 01:55:57] [valid] Ep. 81 : Up. 3100 : cross-entropy : 137.77 : new best
[2023-07-21 01:58:12] [valid] Ep. 81 : Up. 3100 : translation : 0 : new best
[2023-07-21 01:58:12] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 01:58:14] Saving Adam parameters
[2023-07-21 01:58:15] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 01:58:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 01:58:23] [marian] Running on node18.datos.cluster.uy as process 35196 with command line:
[2023-07-21 01:58:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 01:58:23] [config] after: 0e
[2023-07-21 01:58:23] [config] after-batches: 0
[2023-07-21 01:58:23] [config] after-epochs: 90
[2023-07-21 01:58:23] [config] all-caps-every: 0
[2023-07-21 01:58:23] [config] allow-unk: false
[2023-07-21 01:58:23] [config] authors: false
[2023-07-21 01:58:23] [config] beam-size: 12
[2023-07-21 01:58:23] [config] bert-class-symbol: "[CLS]"
[2023-07-21 01:58:23] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 01:58:23] [config] bert-masking-fraction: 0.15
[2023-07-21 01:58:23] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 01:58:23] [config] bert-train-type-embeddings: true
[2023-07-21 01:58:23] [config] bert-type-vocab-size: 2
[2023-07-21 01:58:23] [config] build-info: ""
[2023-07-21 01:58:23] [config] check-gradient-nan: false
[2023-07-21 01:58:23] [config] check-nan: false
[2023-07-21 01:58:23] [config] cite: false
[2023-07-21 01:58:23] [config] clip-norm: 1
[2023-07-21 01:58:23] [config] cost-scaling:
[2023-07-21 01:58:23] [config]   - 256.f
[2023-07-21 01:58:23] [config]   - 1000
[2023-07-21 01:58:23] [config]   - 2.f
[2023-07-21 01:58:23] [config]   - 256.f
[2023-07-21 01:58:23] [config] cost-type: ce-sum
[2023-07-21 01:58:23] [config] cpu-threads: 0
[2023-07-21 01:58:23] [config] data-threads: 8
[2023-07-21 01:58:23] [config] data-weighting: ""
[2023-07-21 01:58:23] [config] data-weighting-type: sentence
[2023-07-21 01:58:23] [config] dec-cell: gru
[2023-07-21 01:58:23] [config] dec-cell-base-depth: 2
[2023-07-21 01:58:23] [config] dec-cell-high-depth: 1
[2023-07-21 01:58:23] [config] dec-depth: 1
[2023-07-21 01:58:23] [config] devices:
[2023-07-21 01:58:23] [config]   - 0
[2023-07-21 01:58:23] [config] dim-emb: 512
[2023-07-21 01:58:23] [config] dim-rnn: 1024
[2023-07-21 01:58:23] [config] dim-vocabs:
[2023-07-21 01:58:23] [config]   - 16384
[2023-07-21 01:58:23] [config]   - 16384
[2023-07-21 01:58:23] [config] disp-first: 0
[2023-07-21 01:58:23] [config] disp-freq: 1000u
[2023-07-21 01:58:23] [config] disp-label-counts: true
[2023-07-21 01:58:23] [config] dropout-rnn: 0
[2023-07-21 01:58:23] [config] dropout-src: 0
[2023-07-21 01:58:23] [config] dropout-trg: 0
[2023-07-21 01:58:23] [config] dump-config: ""
[2023-07-21 01:58:23] [config] dynamic-gradient-scaling:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] early-stopping: 200
[2023-07-21 01:58:23] [config] early-stopping-on: first
[2023-07-21 01:58:23] [config] embedding-fix-src: false
[2023-07-21 01:58:23] [config] embedding-fix-trg: false
[2023-07-21 01:58:23] [config] embedding-normalization: false
[2023-07-21 01:58:23] [config] embedding-vectors:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] enc-cell: gru
[2023-07-21 01:58:23] [config] enc-cell-depth: 1
[2023-07-21 01:58:23] [config] enc-depth: 1
[2023-07-21 01:58:23] [config] enc-type: bidirectional
[2023-07-21 01:58:23] [config] english-title-case-every: 0
[2023-07-21 01:58:23] [config] exponential-smoothing: 0
[2023-07-21 01:58:23] [config] factor-weight: 1
[2023-07-21 01:58:23] [config] factors-combine: sum
[2023-07-21 01:58:23] [config] factors-dim-emb: 0
[2023-07-21 01:58:23] [config] gradient-checkpointing: false
[2023-07-21 01:58:23] [config] gradient-norm-average-window: 100
[2023-07-21 01:58:23] [config] guided-alignment: none
[2023-07-21 01:58:23] [config] guided-alignment-cost: mse
[2023-07-21 01:58:23] [config] guided-alignment-weight: 0.1
[2023-07-21 01:58:23] [config] ignore-model-config: false
[2023-07-21 01:58:23] [config] input-types:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] interpolate-env-vars: false
[2023-07-21 01:58:23] [config] keep-best: false
[2023-07-21 01:58:23] [config] label-smoothing: 0
[2023-07-21 01:58:23] [config] layer-normalization: false
[2023-07-21 01:58:23] [config] learn-rate: 0.0001
[2023-07-21 01:58:23] [config] lemma-dependency: ""
[2023-07-21 01:58:23] [config] lemma-dim-emb: 0
[2023-07-21 01:58:23] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 01:58:23] [config] log-level: info
[2023-07-21 01:58:23] [config] log-time-zone: ""
[2023-07-21 01:58:23] [config] logical-epoch:
[2023-07-21 01:58:23] [config]   - 1e
[2023-07-21 01:58:23] [config]   - 0
[2023-07-21 01:58:23] [config] lr-decay: 0
[2023-07-21 01:58:23] [config] lr-decay-freq: 50000
[2023-07-21 01:58:23] [config] lr-decay-inv-sqrt:
[2023-07-21 01:58:23] [config]   - 0
[2023-07-21 01:58:23] [config] lr-decay-repeat-warmup: false
[2023-07-21 01:58:23] [config] lr-decay-reset-optimizer: false
[2023-07-21 01:58:23] [config] lr-decay-start:
[2023-07-21 01:58:23] [config]   - 10
[2023-07-21 01:58:23] [config]   - 1
[2023-07-21 01:58:23] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 01:58:23] [config] lr-report: false
[2023-07-21 01:58:23] [config] lr-warmup: 0
[2023-07-21 01:58:23] [config] lr-warmup-at-reload: false
[2023-07-21 01:58:23] [config] lr-warmup-cycle: false
[2023-07-21 01:58:23] [config] lr-warmup-start-rate: 0
[2023-07-21 01:58:23] [config] max-length: 250
[2023-07-21 01:58:23] [config] max-length-crop: true
[2023-07-21 01:58:23] [config] max-length-factor: 3
[2023-07-21 01:58:23] [config] maxi-batch: 100
[2023-07-21 01:58:23] [config] maxi-batch-sort: trg
[2023-07-21 01:58:23] [config] mini-batch: 64
[2023-07-21 01:58:23] [config] mini-batch-fit: true
[2023-07-21 01:58:23] [config] mini-batch-fit-step: 10
[2023-07-21 01:58:23] [config] mini-batch-round-up: true
[2023-07-21 01:58:23] [config] mini-batch-track-lr: false
[2023-07-21 01:58:23] [config] mini-batch-warmup: 0
[2023-07-21 01:58:23] [config] mini-batch-words: 0
[2023-07-21 01:58:23] [config] mini-batch-words-ref: 0
[2023-07-21 01:58:23] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 01:58:23] [config] multi-loss-type: sum
[2023-07-21 01:58:23] [config] n-best: false
[2023-07-21 01:58:23] [config] no-nccl: false
[2023-07-21 01:58:23] [config] no-reload: false
[2023-07-21 01:58:23] [config] no-restore-corpus: false
[2023-07-21 01:58:23] [config] normalize: 0
[2023-07-21 01:58:23] [config] normalize-gradient: false
[2023-07-21 01:58:23] [config] num-devices: 0
[2023-07-21 01:58:23] [config] optimizer: adam
[2023-07-21 01:58:23] [config] optimizer-delay: 1
[2023-07-21 01:58:23] [config] optimizer-params:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] output-omit-bias: false
[2023-07-21 01:58:23] [config] overwrite: true
[2023-07-21 01:58:23] [config] precision:
[2023-07-21 01:58:23] [config]   - float16
[2023-07-21 01:58:23] [config]   - float32
[2023-07-21 01:58:23] [config] pretrained-model: ""
[2023-07-21 01:58:23] [config] quantize-biases: false
[2023-07-21 01:58:23] [config] quantize-bits: 0
[2023-07-21 01:58:23] [config] quantize-log-based: false
[2023-07-21 01:58:23] [config] quantize-optimization-steps: 0
[2023-07-21 01:58:23] [config] quiet: false
[2023-07-21 01:58:23] [config] quiet-translation: true
[2023-07-21 01:58:23] [config] relative-paths: false
[2023-07-21 01:58:23] [config] right-left: false
[2023-07-21 01:58:23] [config] save-freq: 10000u
[2023-07-21 01:58:23] [config] seed: 1234
[2023-07-21 01:58:23] [config] sentencepiece-alphas:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] sentencepiece-max-lines: 2000000
[2023-07-21 01:58:23] [config] sentencepiece-options: ""
[2023-07-21 01:58:23] [config] sharding: global
[2023-07-21 01:58:23] [config] shuffle: data
[2023-07-21 01:58:23] [config] shuffle-in-ram: false
[2023-07-21 01:58:23] [config] sigterm: save-and-exit
[2023-07-21 01:58:23] [config] skip: false
[2023-07-21 01:58:23] [config] sqlite: ""
[2023-07-21 01:58:23] [config] sqlite-drop: false
[2023-07-21 01:58:23] [config] sync-freq: 200u
[2023-07-21 01:58:23] [config] sync-sgd: false
[2023-07-21 01:58:23] [config] tempdir: /tmp
[2023-07-21 01:58:23] [config] tied-embeddings: false
[2023-07-21 01:58:23] [config] tied-embeddings-all: true
[2023-07-21 01:58:23] [config] tied-embeddings-src: false
[2023-07-21 01:58:23] [config] train-embedder-rank:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] train-sets:
[2023-07-21 01:58:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 01:58:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 01:58:23] [config] transformer-aan-activation: swish
[2023-07-21 01:58:23] [config] transformer-aan-depth: 2
[2023-07-21 01:58:23] [config] transformer-aan-nogate: false
[2023-07-21 01:58:23] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 01:58:23] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 01:58:23] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 01:58:23] [config] transformer-depth-scaling: false
[2023-07-21 01:58:23] [config] transformer-dim-aan: 2048
[2023-07-21 01:58:23] [config] transformer-dim-ffn: 2048
[2023-07-21 01:58:23] [config] transformer-dropout: 0
[2023-07-21 01:58:23] [config] transformer-dropout-attention: 0
[2023-07-21 01:58:23] [config] transformer-dropout-ffn: 0
[2023-07-21 01:58:23] [config] transformer-ffn-activation: swish
[2023-07-21 01:58:23] [config] transformer-ffn-depth: 2
[2023-07-21 01:58:23] [config] transformer-guided-alignment-layer: last
[2023-07-21 01:58:23] [config] transformer-heads: 8
[2023-07-21 01:58:23] [config] transformer-no-projection: false
[2023-07-21 01:58:23] [config] transformer-pool: false
[2023-07-21 01:58:23] [config] transformer-postprocess: dan
[2023-07-21 01:58:23] [config] transformer-postprocess-emb: d
[2023-07-21 01:58:23] [config] transformer-postprocess-top: ""
[2023-07-21 01:58:23] [config] transformer-preprocess: ""
[2023-07-21 01:58:23] [config] transformer-tied-layers:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] transformer-train-position-embeddings: false
[2023-07-21 01:58:23] [config] tsv: false
[2023-07-21 01:58:23] [config] tsv-fields: 0
[2023-07-21 01:58:23] [config] type: amun
[2023-07-21 01:58:23] [config] ulr: false
[2023-07-21 01:58:23] [config] ulr-dim-emb: 0
[2023-07-21 01:58:23] [config] ulr-dropout: 0
[2023-07-21 01:58:23] [config] ulr-keys-vectors: ""
[2023-07-21 01:58:23] [config] ulr-query-vectors: ""
[2023-07-21 01:58:23] [config] ulr-softmax-temperature: 1
[2023-07-21 01:58:23] [config] ulr-trainable-transformation: false
[2023-07-21 01:58:23] [config] unlikelihood-loss: false
[2023-07-21 01:58:23] [config] valid-freq: 50000000
[2023-07-21 01:58:23] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 01:58:23] [config] valid-max-length: 1000
[2023-07-21 01:58:23] [config] valid-metrics:
[2023-07-21 01:58:23] [config]   - cross-entropy
[2023-07-21 01:58:23] [config]   - translation
[2023-07-21 01:58:23] [config] valid-mini-batch: 32
[2023-07-21 01:58:23] [config] valid-reset-stalled: false
[2023-07-21 01:58:23] [config] valid-script-args:
[2023-07-21 01:58:23] [config]   []
[2023-07-21 01:58:23] [config] valid-script-path: ""
[2023-07-21 01:58:23] [config] valid-sets:
[2023-07-21 01:58:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 01:58:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 01:58:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 01:58:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 01:58:23] [config] vocabs:
[2023-07-21 01:58:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 01:58:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 01:58:23] [config] word-penalty: 0
[2023-07-21 01:58:23] [config] word-scores: false
[2023-07-21 01:58:23] [config] workspace: 5500
[2023-07-21 01:58:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 01:58:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 01:58:23] [training] Using single-device training
[2023-07-21 01:58:24] Synced seed 1234
[2023-07-21 01:58:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 01:58:24] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 01:58:24] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 01:58:24] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 01:58:24] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 01:58:24] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 01:58:24] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 01:58:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 01:58:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 01:58:25] [comm] Using global sharding
[2023-07-21 01:58:25] [comm] NCCLCommunicators constructed successfully
[2023-07-21 01:58:25] [training] Using 1 GPUs
[2023-07-21 01:58:25] [logits] Applying loss function for 1 factor(s)
[2023-07-21 01:58:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 01:58:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 01:58:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 02:39:48] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 02:39:48] [valid] No post-processing script given for validating translator
[2023-07-21 02:39:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 02:39:48] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 02:39:48] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 02:39:48] [comm] Using global sharding
[2023-07-21 02:39:48] [comm] NCCLCommunicators constructed successfully
[2023-07-21 02:39:48] [training] Using 1 GPUs
[2023-07-21 02:39:48] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 02:39:56] Allocating memory for general optimizer shards
[2023-07-21 02:39:56] [memory] Reserving 322 MB, device gpu0
[2023-07-21 02:39:56] Loading Adam parameters
[2023-07-21 02:39:56] [memory] Reserving 322 MB, device gpu0
[2023-07-21 02:39:56] [memory] Reserving 80 MB, device gpu0
[2023-07-21 02:39:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 02:39:56] [data] Restoring the corpus state to epoch 81, batch 3100
[2023-07-21 02:39:56] [data] Shuffling data
[2023-07-21 02:39:56] [data] Done reading 20,192 sentences
[2023-07-21 02:39:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:39:56] Training started
[2023-07-21 02:39:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 02:39:57] [memory] Reserving 80 MB, device gpu0
[2023-07-21 02:39:58] Parameter type float16, optimization type float32, casting types true
[2023-07-21 02:43:34] Seen 20,192 samples
[2023-07-21 02:43:34] Starting data epoch 82 in logical epoch 82
[2023-07-21 02:43:34] [data] Shuffling data
[2023-07-21 02:43:34] [data] Done reading 20,192 sentences
[2023-07-21 02:43:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:47:14] Seen 20,192 samples
[2023-07-21 02:47:14] Starting data epoch 83 in logical epoch 83
[2023-07-21 02:47:14] [data] Shuffling data
[2023-07-21 02:47:14] [data] Done reading 20,192 sentences
[2023-07-21 02:47:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:50:57] Seen 20,192 samples
[2023-07-21 02:50:57] Starting data epoch 84 in logical epoch 84
[2023-07-21 02:50:57] [data] Shuffling data
[2023-07-21 02:50:57] [data] Done reading 20,192 sentences
[2023-07-21 02:50:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:54:39] Seen 20,192 samples
[2023-07-21 02:54:39] Starting data epoch 85 in logical epoch 85
[2023-07-21 02:54:39] [data] Shuffling data
[2023-07-21 02:54:39] [data] Done reading 20,192 sentences
[2023-07-21 02:54:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 02:58:24] Seen 20,192 samples
[2023-07-21 02:58:24] Starting data epoch 86 in logical epoch 86
[2023-07-21 02:58:24] [data] Shuffling data
[2023-07-21 02:58:24] [data] Done reading 20,192 sentences
[2023-07-21 02:58:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:02:09] Seen 20,192 samples
[2023-07-21 03:02:09] Starting data epoch 87 in logical epoch 87
[2023-07-21 03:02:09] [data] Shuffling data
[2023-07-21 03:02:09] [data] Done reading 20,192 sentences
[2023-07-21 03:02:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:05:53] Seen 20,192 samples
[2023-07-21 03:05:53] Starting data epoch 88 in logical epoch 88
[2023-07-21 03:05:53] [data] Shuffling data
[2023-07-21 03:05:53] [data] Done reading 20,192 sentences
[2023-07-21 03:05:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:09:43] Seen 20,192 samples
[2023-07-21 03:09:43] Starting data epoch 89 in logical epoch 89
[2023-07-21 03:09:43] [data] Shuffling data
[2023-07-21 03:09:43] [data] Done reading 20,192 sentences
[2023-07-21 03:09:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:13:25] Seen 20,192 samples
[2023-07-21 03:13:25] Starting data epoch 90 in logical epoch 90
[2023-07-21 03:13:25] [data] Shuffling data
[2023-07-21 03:13:25] [data] Done reading 20,192 sentences
[2023-07-21 03:13:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 03:17:07] Seen 20,192 samples
[2023-07-21 03:17:07] Starting data epoch 91 in logical epoch 91
[2023-07-21 03:17:07] Training finished
[2023-07-21 03:17:16] [valid] Ep. 91 : Up. 3488 : cross-entropy : 135.707 : new best
[2023-07-21 03:19:07] [valid] Ep. 91 : Up. 3488 : translation : 0 : new best
[2023-07-21 03:19:07] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 03:19:09] Saving Adam parameters
[2023-07-21 03:19:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 03:19:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 03:19:18] [marian] Running on node18.datos.cluster.uy as process 40537 with command line:
[2023-07-21 03:19:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 03:19:18] [config] after: 0e
[2023-07-21 03:19:18] [config] after-batches: 0
[2023-07-21 03:19:18] [config] after-epochs: 100
[2023-07-21 03:19:18] [config] all-caps-every: 0
[2023-07-21 03:19:18] [config] allow-unk: false
[2023-07-21 03:19:18] [config] authors: false
[2023-07-21 03:19:18] [config] beam-size: 12
[2023-07-21 03:19:18] [config] bert-class-symbol: "[CLS]"
[2023-07-21 03:19:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 03:19:18] [config] bert-masking-fraction: 0.15
[2023-07-21 03:19:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 03:19:18] [config] bert-train-type-embeddings: true
[2023-07-21 03:19:18] [config] bert-type-vocab-size: 2
[2023-07-21 03:19:18] [config] build-info: ""
[2023-07-21 03:19:18] [config] check-gradient-nan: false
[2023-07-21 03:19:18] [config] check-nan: false
[2023-07-21 03:19:18] [config] cite: false
[2023-07-21 03:19:18] [config] clip-norm: 1
[2023-07-21 03:19:18] [config] cost-scaling:
[2023-07-21 03:19:18] [config]   - 256.f
[2023-07-21 03:19:18] [config]   - 1000
[2023-07-21 03:19:18] [config]   - 2.f
[2023-07-21 03:19:18] [config]   - 256.f
[2023-07-21 03:19:18] [config] cost-type: ce-sum
[2023-07-21 03:19:18] [config] cpu-threads: 0
[2023-07-21 03:19:18] [config] data-threads: 8
[2023-07-21 03:19:18] [config] data-weighting: ""
[2023-07-21 03:19:18] [config] data-weighting-type: sentence
[2023-07-21 03:19:18] [config] dec-cell: gru
[2023-07-21 03:19:18] [config] dec-cell-base-depth: 2
[2023-07-21 03:19:18] [config] dec-cell-high-depth: 1
[2023-07-21 03:19:18] [config] dec-depth: 1
[2023-07-21 03:19:18] [config] devices:
[2023-07-21 03:19:18] [config]   - 0
[2023-07-21 03:19:18] [config] dim-emb: 512
[2023-07-21 03:19:18] [config] dim-rnn: 1024
[2023-07-21 03:19:18] [config] dim-vocabs:
[2023-07-21 03:19:18] [config]   - 16384
[2023-07-21 03:19:18] [config]   - 16384
[2023-07-21 03:19:18] [config] disp-first: 0
[2023-07-21 03:19:18] [config] disp-freq: 1000u
[2023-07-21 03:19:18] [config] disp-label-counts: true
[2023-07-21 03:19:18] [config] dropout-rnn: 0
[2023-07-21 03:19:18] [config] dropout-src: 0
[2023-07-21 03:19:18] [config] dropout-trg: 0
[2023-07-21 03:19:18] [config] dump-config: ""
[2023-07-21 03:19:18] [config] dynamic-gradient-scaling:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] early-stopping: 200
[2023-07-21 03:19:18] [config] early-stopping-on: first
[2023-07-21 03:19:18] [config] embedding-fix-src: false
[2023-07-21 03:19:18] [config] embedding-fix-trg: false
[2023-07-21 03:19:18] [config] embedding-normalization: false
[2023-07-21 03:19:18] [config] embedding-vectors:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] enc-cell: gru
[2023-07-21 03:19:18] [config] enc-cell-depth: 1
[2023-07-21 03:19:18] [config] enc-depth: 1
[2023-07-21 03:19:18] [config] enc-type: bidirectional
[2023-07-21 03:19:18] [config] english-title-case-every: 0
[2023-07-21 03:19:18] [config] exponential-smoothing: 0
[2023-07-21 03:19:18] [config] factor-weight: 1
[2023-07-21 03:19:18] [config] factors-combine: sum
[2023-07-21 03:19:18] [config] factors-dim-emb: 0
[2023-07-21 03:19:18] [config] gradient-checkpointing: false
[2023-07-21 03:19:18] [config] gradient-norm-average-window: 100
[2023-07-21 03:19:18] [config] guided-alignment: none
[2023-07-21 03:19:18] [config] guided-alignment-cost: mse
[2023-07-21 03:19:18] [config] guided-alignment-weight: 0.1
[2023-07-21 03:19:18] [config] ignore-model-config: false
[2023-07-21 03:19:18] [config] input-types:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] interpolate-env-vars: false
[2023-07-21 03:19:18] [config] keep-best: false
[2023-07-21 03:19:18] [config] label-smoothing: 0
[2023-07-21 03:19:18] [config] layer-normalization: false
[2023-07-21 03:19:18] [config] learn-rate: 0.0001
[2023-07-21 03:19:18] [config] lemma-dependency: ""
[2023-07-21 03:19:18] [config] lemma-dim-emb: 0
[2023-07-21 03:19:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 03:19:18] [config] log-level: info
[2023-07-21 03:19:18] [config] log-time-zone: ""
[2023-07-21 03:19:18] [config] logical-epoch:
[2023-07-21 03:19:18] [config]   - 1e
[2023-07-21 03:19:18] [config]   - 0
[2023-07-21 03:19:18] [config] lr-decay: 0
[2023-07-21 03:19:18] [config] lr-decay-freq: 50000
[2023-07-21 03:19:18] [config] lr-decay-inv-sqrt:
[2023-07-21 03:19:18] [config]   - 0
[2023-07-21 03:19:18] [config] lr-decay-repeat-warmup: false
[2023-07-21 03:19:18] [config] lr-decay-reset-optimizer: false
[2023-07-21 03:19:18] [config] lr-decay-start:
[2023-07-21 03:19:18] [config]   - 10
[2023-07-21 03:19:18] [config]   - 1
[2023-07-21 03:19:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 03:19:18] [config] lr-report: false
[2023-07-21 03:19:18] [config] lr-warmup: 0
[2023-07-21 03:19:18] [config] lr-warmup-at-reload: false
[2023-07-21 03:19:18] [config] lr-warmup-cycle: false
[2023-07-21 03:19:18] [config] lr-warmup-start-rate: 0
[2023-07-21 03:19:18] [config] max-length: 250
[2023-07-21 03:19:18] [config] max-length-crop: true
[2023-07-21 03:19:18] [config] max-length-factor: 3
[2023-07-21 03:19:18] [config] maxi-batch: 100
[2023-07-21 03:19:18] [config] maxi-batch-sort: trg
[2023-07-21 03:19:18] [config] mini-batch: 64
[2023-07-21 03:19:18] [config] mini-batch-fit: true
[2023-07-21 03:19:18] [config] mini-batch-fit-step: 10
[2023-07-21 03:19:18] [config] mini-batch-round-up: true
[2023-07-21 03:19:18] [config] mini-batch-track-lr: false
[2023-07-21 03:19:18] [config] mini-batch-warmup: 0
[2023-07-21 03:19:18] [config] mini-batch-words: 0
[2023-07-21 03:19:18] [config] mini-batch-words-ref: 0
[2023-07-21 03:19:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 03:19:18] [config] multi-loss-type: sum
[2023-07-21 03:19:18] [config] n-best: false
[2023-07-21 03:19:18] [config] no-nccl: false
[2023-07-21 03:19:18] [config] no-reload: false
[2023-07-21 03:19:18] [config] no-restore-corpus: false
[2023-07-21 03:19:18] [config] normalize: 0
[2023-07-21 03:19:18] [config] normalize-gradient: false
[2023-07-21 03:19:18] [config] num-devices: 0
[2023-07-21 03:19:18] [config] optimizer: adam
[2023-07-21 03:19:18] [config] optimizer-delay: 1
[2023-07-21 03:19:18] [config] optimizer-params:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] output-omit-bias: false
[2023-07-21 03:19:18] [config] overwrite: true
[2023-07-21 03:19:18] [config] precision:
[2023-07-21 03:19:18] [config]   - float16
[2023-07-21 03:19:18] [config]   - float32
[2023-07-21 03:19:18] [config] pretrained-model: ""
[2023-07-21 03:19:18] [config] quantize-biases: false
[2023-07-21 03:19:18] [config] quantize-bits: 0
[2023-07-21 03:19:18] [config] quantize-log-based: false
[2023-07-21 03:19:18] [config] quantize-optimization-steps: 0
[2023-07-21 03:19:18] [config] quiet: false
[2023-07-21 03:19:18] [config] quiet-translation: true
[2023-07-21 03:19:18] [config] relative-paths: false
[2023-07-21 03:19:18] [config] right-left: false
[2023-07-21 03:19:18] [config] save-freq: 10000u
[2023-07-21 03:19:18] [config] seed: 1234
[2023-07-21 03:19:18] [config] sentencepiece-alphas:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] sentencepiece-max-lines: 2000000
[2023-07-21 03:19:18] [config] sentencepiece-options: ""
[2023-07-21 03:19:18] [config] sharding: global
[2023-07-21 03:19:18] [config] shuffle: data
[2023-07-21 03:19:18] [config] shuffle-in-ram: false
[2023-07-21 03:19:18] [config] sigterm: save-and-exit
[2023-07-21 03:19:18] [config] skip: false
[2023-07-21 03:19:18] [config] sqlite: ""
[2023-07-21 03:19:18] [config] sqlite-drop: false
[2023-07-21 03:19:18] [config] sync-freq: 200u
[2023-07-21 03:19:18] [config] sync-sgd: false
[2023-07-21 03:19:18] [config] tempdir: /tmp
[2023-07-21 03:19:18] [config] tied-embeddings: false
[2023-07-21 03:19:18] [config] tied-embeddings-all: true
[2023-07-21 03:19:18] [config] tied-embeddings-src: false
[2023-07-21 03:19:18] [config] train-embedder-rank:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] train-sets:
[2023-07-21 03:19:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 03:19:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 03:19:18] [config] transformer-aan-activation: swish
[2023-07-21 03:19:18] [config] transformer-aan-depth: 2
[2023-07-21 03:19:18] [config] transformer-aan-nogate: false
[2023-07-21 03:19:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 03:19:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 03:19:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 03:19:18] [config] transformer-depth-scaling: false
[2023-07-21 03:19:18] [config] transformer-dim-aan: 2048
[2023-07-21 03:19:18] [config] transformer-dim-ffn: 2048
[2023-07-21 03:19:18] [config] transformer-dropout: 0
[2023-07-21 03:19:18] [config] transformer-dropout-attention: 0
[2023-07-21 03:19:18] [config] transformer-dropout-ffn: 0
[2023-07-21 03:19:18] [config] transformer-ffn-activation: swish
[2023-07-21 03:19:18] [config] transformer-ffn-depth: 2
[2023-07-21 03:19:18] [config] transformer-guided-alignment-layer: last
[2023-07-21 03:19:18] [config] transformer-heads: 8
[2023-07-21 03:19:18] [config] transformer-no-projection: false
[2023-07-21 03:19:18] [config] transformer-pool: false
[2023-07-21 03:19:18] [config] transformer-postprocess: dan
[2023-07-21 03:19:18] [config] transformer-postprocess-emb: d
[2023-07-21 03:19:18] [config] transformer-postprocess-top: ""
[2023-07-21 03:19:18] [config] transformer-preprocess: ""
[2023-07-21 03:19:18] [config] transformer-tied-layers:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] transformer-train-position-embeddings: false
[2023-07-21 03:19:18] [config] tsv: false
[2023-07-21 03:19:18] [config] tsv-fields: 0
[2023-07-21 03:19:18] [config] type: amun
[2023-07-21 03:19:18] [config] ulr: false
[2023-07-21 03:19:18] [config] ulr-dim-emb: 0
[2023-07-21 03:19:18] [config] ulr-dropout: 0
[2023-07-21 03:19:18] [config] ulr-keys-vectors: ""
[2023-07-21 03:19:18] [config] ulr-query-vectors: ""
[2023-07-21 03:19:18] [config] ulr-softmax-temperature: 1
[2023-07-21 03:19:18] [config] ulr-trainable-transformation: false
[2023-07-21 03:19:18] [config] unlikelihood-loss: false
[2023-07-21 03:19:18] [config] valid-freq: 50000000
[2023-07-21 03:19:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 03:19:18] [config] valid-max-length: 1000
[2023-07-21 03:19:18] [config] valid-metrics:
[2023-07-21 03:19:18] [config]   - cross-entropy
[2023-07-21 03:19:18] [config]   - translation
[2023-07-21 03:19:18] [config] valid-mini-batch: 32
[2023-07-21 03:19:18] [config] valid-reset-stalled: false
[2023-07-21 03:19:18] [config] valid-script-args:
[2023-07-21 03:19:18] [config]   []
[2023-07-21 03:19:18] [config] valid-script-path: ""
[2023-07-21 03:19:18] [config] valid-sets:
[2023-07-21 03:19:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 03:19:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 03:19:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 03:19:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 03:19:18] [config] vocabs:
[2023-07-21 03:19:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 03:19:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 03:19:18] [config] word-penalty: 0
[2023-07-21 03:19:18] [config] word-scores: false
[2023-07-21 03:19:18] [config] workspace: 5500
[2023-07-21 03:19:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 03:19:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 03:19:18] [training] Using single-device training
[2023-07-21 03:19:18] Synced seed 1234
[2023-07-21 03:19:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 03:19:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 03:19:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 03:19:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 03:19:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 03:19:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 03:19:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 03:19:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 03:19:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 03:19:20] [comm] Using global sharding
[2023-07-21 03:19:20] [comm] NCCLCommunicators constructed successfully
[2023-07-21 03:19:20] [training] Using 1 GPUs
[2023-07-21 03:19:20] [logits] Applying loss function for 1 factor(s)
[2023-07-21 03:19:20] [memory] Reserving 80 MB, device gpu0
[2023-07-21 03:19:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 03:19:20] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:01:19] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 04:01:19] [valid] No post-processing script given for validating translator
[2023-07-21 04:01:19] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 04:01:19] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 04:01:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 04:01:19] [comm] Using global sharding
[2023-07-21 04:01:19] [comm] NCCLCommunicators constructed successfully
[2023-07-21 04:01:19] [training] Using 1 GPUs
[2023-07-21 04:01:19] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 04:01:24] Allocating memory for general optimizer shards
[2023-07-21 04:01:24] [memory] Reserving 322 MB, device gpu0
[2023-07-21 04:01:24] Loading Adam parameters
[2023-07-21 04:01:24] [memory] Reserving 322 MB, device gpu0
[2023-07-21 04:01:24] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:01:25] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 04:01:25] [data] Restoring the corpus state to epoch 91, batch 3488
[2023-07-21 04:01:25] [data] Shuffling data
[2023-07-21 04:01:25] [data] Done reading 20,192 sentences
[2023-07-21 04:01:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:01:25] Training started
[2023-07-21 04:01:25] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 04:01:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:01:29] Parameter type float16, optimization type float32, casting types true
[2023-07-21 04:04:53] Seen 20,192 samples
[2023-07-21 04:04:53] Starting data epoch 92 in logical epoch 92
[2023-07-21 04:04:53] [data] Shuffling data
[2023-07-21 04:04:53] [data] Done reading 20,192 sentences
[2023-07-21 04:04:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:08:29] Seen 20,192 samples
[2023-07-21 04:08:29] Starting data epoch 93 in logical epoch 93
[2023-07-21 04:08:29] [data] Shuffling data
[2023-07-21 04:08:30] [data] Done reading 20,192 sentences
[2023-07-21 04:08:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:12:12] Seen 20,192 samples
[2023-07-21 04:12:12] Starting data epoch 94 in logical epoch 94
[2023-07-21 04:12:12] [data] Shuffling data
[2023-07-21 04:12:12] [data] Done reading 20,192 sentences
[2023-07-21 04:12:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:15:55] Seen 20,192 samples
[2023-07-21 04:15:55] Starting data epoch 95 in logical epoch 95
[2023-07-21 04:15:55] [data] Shuffling data
[2023-07-21 04:15:55] [data] Done reading 20,192 sentences
[2023-07-21 04:15:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:19:39] Seen 20,192 samples
[2023-07-21 04:19:39] Starting data epoch 96 in logical epoch 96
[2023-07-21 04:19:39] [data] Shuffling data
[2023-07-21 04:19:39] [data] Done reading 20,192 sentences
[2023-07-21 04:19:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:23:11] Seen 20,192 samples
[2023-07-21 04:23:11] Starting data epoch 97 in logical epoch 97
[2023-07-21 04:23:11] [data] Shuffling data
[2023-07-21 04:23:11] [data] Done reading 20,192 sentences
[2023-07-21 04:23:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:26:36] Seen 20,192 samples
[2023-07-21 04:26:36] Starting data epoch 98 in logical epoch 98
[2023-07-21 04:26:36] [data] Shuffling data
[2023-07-21 04:26:36] [data] Done reading 20,192 sentences
[2023-07-21 04:26:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:29:56] Seen 20,192 samples
[2023-07-21 04:29:56] Starting data epoch 99 in logical epoch 99
[2023-07-21 04:29:56] [data] Shuffling data
[2023-07-21 04:29:56] [data] Done reading 20,192 sentences
[2023-07-21 04:29:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:33:16] Seen 20,192 samples
[2023-07-21 04:33:16] Starting data epoch 100 in logical epoch 100
[2023-07-21 04:33:16] [data] Shuffling data
[2023-07-21 04:33:16] [data] Done reading 20,192 sentences
[2023-07-21 04:33:16] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 04:36:39] Seen 20,192 samples
[2023-07-21 04:36:39] Starting data epoch 101 in logical epoch 101
[2023-07-21 04:36:39] Training finished
[2023-07-21 04:36:48] [valid] Ep. 101 : Up. 3879 : cross-entropy : 134.682 : new best
[2023-07-21 04:38:36] [valid] Ep. 101 : Up. 3879 : translation : 0 : new best
[2023-07-21 04:38:36] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 04:38:38] Saving Adam parameters
[2023-07-21 04:38:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 04:38:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 04:38:45] [marian] Running on node18.datos.cluster.uy as process 5645 with command line:
[2023-07-21 04:38:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 04:38:45] [config] after: 0e
[2023-07-21 04:38:45] [config] after-batches: 0
[2023-07-21 04:38:45] [config] after-epochs: 110
[2023-07-21 04:38:45] [config] all-caps-every: 0
[2023-07-21 04:38:45] [config] allow-unk: false
[2023-07-21 04:38:45] [config] authors: false
[2023-07-21 04:38:45] [config] beam-size: 12
[2023-07-21 04:38:45] [config] bert-class-symbol: "[CLS]"
[2023-07-21 04:38:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 04:38:45] [config] bert-masking-fraction: 0.15
[2023-07-21 04:38:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 04:38:45] [config] bert-train-type-embeddings: true
[2023-07-21 04:38:45] [config] bert-type-vocab-size: 2
[2023-07-21 04:38:45] [config] build-info: ""
[2023-07-21 04:38:45] [config] check-gradient-nan: false
[2023-07-21 04:38:45] [config] check-nan: false
[2023-07-21 04:38:45] [config] cite: false
[2023-07-21 04:38:45] [config] clip-norm: 1
[2023-07-21 04:38:45] [config] cost-scaling:
[2023-07-21 04:38:45] [config]   - 256.f
[2023-07-21 04:38:45] [config]   - 1000
[2023-07-21 04:38:45] [config]   - 2.f
[2023-07-21 04:38:45] [config]   - 256.f
[2023-07-21 04:38:45] [config] cost-type: ce-sum
[2023-07-21 04:38:45] [config] cpu-threads: 0
[2023-07-21 04:38:45] [config] data-threads: 8
[2023-07-21 04:38:45] [config] data-weighting: ""
[2023-07-21 04:38:45] [config] data-weighting-type: sentence
[2023-07-21 04:38:45] [config] dec-cell: gru
[2023-07-21 04:38:45] [config] dec-cell-base-depth: 2
[2023-07-21 04:38:45] [config] dec-cell-high-depth: 1
[2023-07-21 04:38:45] [config] dec-depth: 1
[2023-07-21 04:38:45] [config] devices:
[2023-07-21 04:38:45] [config]   - 0
[2023-07-21 04:38:45] [config] dim-emb: 512
[2023-07-21 04:38:45] [config] dim-rnn: 1024
[2023-07-21 04:38:45] [config] dim-vocabs:
[2023-07-21 04:38:45] [config]   - 16384
[2023-07-21 04:38:45] [config]   - 16384
[2023-07-21 04:38:45] [config] disp-first: 0
[2023-07-21 04:38:45] [config] disp-freq: 1000u
[2023-07-21 04:38:45] [config] disp-label-counts: true
[2023-07-21 04:38:45] [config] dropout-rnn: 0
[2023-07-21 04:38:45] [config] dropout-src: 0
[2023-07-21 04:38:45] [config] dropout-trg: 0
[2023-07-21 04:38:45] [config] dump-config: ""
[2023-07-21 04:38:45] [config] dynamic-gradient-scaling:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] early-stopping: 200
[2023-07-21 04:38:45] [config] early-stopping-on: first
[2023-07-21 04:38:45] [config] embedding-fix-src: false
[2023-07-21 04:38:45] [config] embedding-fix-trg: false
[2023-07-21 04:38:45] [config] embedding-normalization: false
[2023-07-21 04:38:45] [config] embedding-vectors:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] enc-cell: gru
[2023-07-21 04:38:45] [config] enc-cell-depth: 1
[2023-07-21 04:38:45] [config] enc-depth: 1
[2023-07-21 04:38:45] [config] enc-type: bidirectional
[2023-07-21 04:38:45] [config] english-title-case-every: 0
[2023-07-21 04:38:45] [config] exponential-smoothing: 0
[2023-07-21 04:38:45] [config] factor-weight: 1
[2023-07-21 04:38:45] [config] factors-combine: sum
[2023-07-21 04:38:45] [config] factors-dim-emb: 0
[2023-07-21 04:38:45] [config] gradient-checkpointing: false
[2023-07-21 04:38:45] [config] gradient-norm-average-window: 100
[2023-07-21 04:38:45] [config] guided-alignment: none
[2023-07-21 04:38:45] [config] guided-alignment-cost: mse
[2023-07-21 04:38:45] [config] guided-alignment-weight: 0.1
[2023-07-21 04:38:45] [config] ignore-model-config: false
[2023-07-21 04:38:45] [config] input-types:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] interpolate-env-vars: false
[2023-07-21 04:38:45] [config] keep-best: false
[2023-07-21 04:38:45] [config] label-smoothing: 0
[2023-07-21 04:38:45] [config] layer-normalization: false
[2023-07-21 04:38:45] [config] learn-rate: 0.0001
[2023-07-21 04:38:45] [config] lemma-dependency: ""
[2023-07-21 04:38:45] [config] lemma-dim-emb: 0
[2023-07-21 04:38:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 04:38:45] [config] log-level: info
[2023-07-21 04:38:45] [config] log-time-zone: ""
[2023-07-21 04:38:45] [config] logical-epoch:
[2023-07-21 04:38:45] [config]   - 1e
[2023-07-21 04:38:45] [config]   - 0
[2023-07-21 04:38:45] [config] lr-decay: 0
[2023-07-21 04:38:45] [config] lr-decay-freq: 50000
[2023-07-21 04:38:45] [config] lr-decay-inv-sqrt:
[2023-07-21 04:38:45] [config]   - 0
[2023-07-21 04:38:45] [config] lr-decay-repeat-warmup: false
[2023-07-21 04:38:45] [config] lr-decay-reset-optimizer: false
[2023-07-21 04:38:45] [config] lr-decay-start:
[2023-07-21 04:38:45] [config]   - 10
[2023-07-21 04:38:45] [config]   - 1
[2023-07-21 04:38:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 04:38:45] [config] lr-report: false
[2023-07-21 04:38:45] [config] lr-warmup: 0
[2023-07-21 04:38:45] [config] lr-warmup-at-reload: false
[2023-07-21 04:38:45] [config] lr-warmup-cycle: false
[2023-07-21 04:38:45] [config] lr-warmup-start-rate: 0
[2023-07-21 04:38:45] [config] max-length: 250
[2023-07-21 04:38:45] [config] max-length-crop: true
[2023-07-21 04:38:45] [config] max-length-factor: 3
[2023-07-21 04:38:45] [config] maxi-batch: 100
[2023-07-21 04:38:45] [config] maxi-batch-sort: trg
[2023-07-21 04:38:45] [config] mini-batch: 64
[2023-07-21 04:38:45] [config] mini-batch-fit: true
[2023-07-21 04:38:45] [config] mini-batch-fit-step: 10
[2023-07-21 04:38:45] [config] mini-batch-round-up: true
[2023-07-21 04:38:45] [config] mini-batch-track-lr: false
[2023-07-21 04:38:45] [config] mini-batch-warmup: 0
[2023-07-21 04:38:45] [config] mini-batch-words: 0
[2023-07-21 04:38:45] [config] mini-batch-words-ref: 0
[2023-07-21 04:38:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 04:38:45] [config] multi-loss-type: sum
[2023-07-21 04:38:45] [config] n-best: false
[2023-07-21 04:38:45] [config] no-nccl: false
[2023-07-21 04:38:45] [config] no-reload: false
[2023-07-21 04:38:45] [config] no-restore-corpus: false
[2023-07-21 04:38:45] [config] normalize: 0
[2023-07-21 04:38:45] [config] normalize-gradient: false
[2023-07-21 04:38:45] [config] num-devices: 0
[2023-07-21 04:38:45] [config] optimizer: adam
[2023-07-21 04:38:45] [config] optimizer-delay: 1
[2023-07-21 04:38:45] [config] optimizer-params:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] output-omit-bias: false
[2023-07-21 04:38:45] [config] overwrite: true
[2023-07-21 04:38:45] [config] precision:
[2023-07-21 04:38:45] [config]   - float16
[2023-07-21 04:38:45] [config]   - float32
[2023-07-21 04:38:45] [config] pretrained-model: ""
[2023-07-21 04:38:45] [config] quantize-biases: false
[2023-07-21 04:38:45] [config] quantize-bits: 0
[2023-07-21 04:38:45] [config] quantize-log-based: false
[2023-07-21 04:38:45] [config] quantize-optimization-steps: 0
[2023-07-21 04:38:45] [config] quiet: false
[2023-07-21 04:38:45] [config] quiet-translation: true
[2023-07-21 04:38:45] [config] relative-paths: false
[2023-07-21 04:38:45] [config] right-left: false
[2023-07-21 04:38:45] [config] save-freq: 10000u
[2023-07-21 04:38:45] [config] seed: 1234
[2023-07-21 04:38:45] [config] sentencepiece-alphas:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] sentencepiece-max-lines: 2000000
[2023-07-21 04:38:45] [config] sentencepiece-options: ""
[2023-07-21 04:38:45] [config] sharding: global
[2023-07-21 04:38:45] [config] shuffle: data
[2023-07-21 04:38:45] [config] shuffle-in-ram: false
[2023-07-21 04:38:45] [config] sigterm: save-and-exit
[2023-07-21 04:38:45] [config] skip: false
[2023-07-21 04:38:45] [config] sqlite: ""
[2023-07-21 04:38:45] [config] sqlite-drop: false
[2023-07-21 04:38:45] [config] sync-freq: 200u
[2023-07-21 04:38:45] [config] sync-sgd: false
[2023-07-21 04:38:45] [config] tempdir: /tmp
[2023-07-21 04:38:45] [config] tied-embeddings: false
[2023-07-21 04:38:45] [config] tied-embeddings-all: true
[2023-07-21 04:38:45] [config] tied-embeddings-src: false
[2023-07-21 04:38:45] [config] train-embedder-rank:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] train-sets:
[2023-07-21 04:38:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 04:38:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 04:38:45] [config] transformer-aan-activation: swish
[2023-07-21 04:38:45] [config] transformer-aan-depth: 2
[2023-07-21 04:38:45] [config] transformer-aan-nogate: false
[2023-07-21 04:38:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 04:38:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 04:38:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 04:38:45] [config] transformer-depth-scaling: false
[2023-07-21 04:38:45] [config] transformer-dim-aan: 2048
[2023-07-21 04:38:45] [config] transformer-dim-ffn: 2048
[2023-07-21 04:38:45] [config] transformer-dropout: 0
[2023-07-21 04:38:45] [config] transformer-dropout-attention: 0
[2023-07-21 04:38:45] [config] transformer-dropout-ffn: 0
[2023-07-21 04:38:45] [config] transformer-ffn-activation: swish
[2023-07-21 04:38:45] [config] transformer-ffn-depth: 2
[2023-07-21 04:38:45] [config] transformer-guided-alignment-layer: last
[2023-07-21 04:38:45] [config] transformer-heads: 8
[2023-07-21 04:38:45] [config] transformer-no-projection: false
[2023-07-21 04:38:45] [config] transformer-pool: false
[2023-07-21 04:38:45] [config] transformer-postprocess: dan
[2023-07-21 04:38:45] [config] transformer-postprocess-emb: d
[2023-07-21 04:38:45] [config] transformer-postprocess-top: ""
[2023-07-21 04:38:45] [config] transformer-preprocess: ""
[2023-07-21 04:38:45] [config] transformer-tied-layers:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] transformer-train-position-embeddings: false
[2023-07-21 04:38:45] [config] tsv: false
[2023-07-21 04:38:45] [config] tsv-fields: 0
[2023-07-21 04:38:45] [config] type: amun
[2023-07-21 04:38:45] [config] ulr: false
[2023-07-21 04:38:45] [config] ulr-dim-emb: 0
[2023-07-21 04:38:45] [config] ulr-dropout: 0
[2023-07-21 04:38:45] [config] ulr-keys-vectors: ""
[2023-07-21 04:38:45] [config] ulr-query-vectors: ""
[2023-07-21 04:38:45] [config] ulr-softmax-temperature: 1
[2023-07-21 04:38:45] [config] ulr-trainable-transformation: false
[2023-07-21 04:38:45] [config] unlikelihood-loss: false
[2023-07-21 04:38:45] [config] valid-freq: 50000000
[2023-07-21 04:38:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 04:38:45] [config] valid-max-length: 1000
[2023-07-21 04:38:45] [config] valid-metrics:
[2023-07-21 04:38:45] [config]   - cross-entropy
[2023-07-21 04:38:45] [config]   - translation
[2023-07-21 04:38:45] [config] valid-mini-batch: 32
[2023-07-21 04:38:45] [config] valid-reset-stalled: false
[2023-07-21 04:38:45] [config] valid-script-args:
[2023-07-21 04:38:45] [config]   []
[2023-07-21 04:38:45] [config] valid-script-path: ""
[2023-07-21 04:38:45] [config] valid-sets:
[2023-07-21 04:38:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 04:38:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 04:38:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 04:38:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 04:38:45] [config] vocabs:
[2023-07-21 04:38:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 04:38:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 04:38:45] [config] word-penalty: 0
[2023-07-21 04:38:45] [config] word-scores: false
[2023-07-21 04:38:45] [config] workspace: 5500
[2023-07-21 04:38:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 04:38:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 04:38:45] [training] Using single-device training
[2023-07-21 04:38:46] Synced seed 1234
[2023-07-21 04:38:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 04:38:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 04:38:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 04:38:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 04:38:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 04:38:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 04:38:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 04:38:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 04:38:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 04:38:47] [comm] Using global sharding
[2023-07-21 04:38:48] [comm] NCCLCommunicators constructed successfully
[2023-07-21 04:38:48] [training] Using 1 GPUs
[2023-07-21 04:38:48] [logits] Applying loss function for 1 factor(s)
[2023-07-21 04:38:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 04:38:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 04:38:48] [memory] Reserving 80 MB, device gpu0
[2023-07-21 05:21:05] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 05:21:06] [valid] No post-processing script given for validating translator
[2023-07-21 05:21:06] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 05:21:06] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 05:21:06] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 05:21:06] [comm] Using global sharding
[2023-07-21 05:21:06] [comm] NCCLCommunicators constructed successfully
[2023-07-21 05:21:06] [training] Using 1 GPUs
[2023-07-21 05:21:06] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 05:21:13] Allocating memory for general optimizer shards
[2023-07-21 05:21:13] [memory] Reserving 322 MB, device gpu0
[2023-07-21 05:21:13] Loading Adam parameters
[2023-07-21 05:21:13] [memory] Reserving 322 MB, device gpu0
[2023-07-21 05:21:13] [memory] Reserving 80 MB, device gpu0
[2023-07-21 05:21:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 05:21:13] [data] Restoring the corpus state to epoch 101, batch 3879
[2023-07-21 05:21:13] [data] Shuffling data
[2023-07-21 05:21:14] [data] Done reading 20,192 sentences
[2023-07-21 05:21:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:21:14] Training started
[2023-07-21 05:21:14] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 05:21:14] [memory] Reserving 80 MB, device gpu0
[2023-07-21 05:21:19] Parameter type float16, optimization type float32, casting types true
[2023-07-21 05:24:57] Seen 20,192 samples
[2023-07-21 05:24:57] Starting data epoch 102 in logical epoch 102
[2023-07-21 05:24:57] [data] Shuffling data
[2023-07-21 05:24:57] [data] Done reading 20,192 sentences
[2023-07-21 05:24:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:28:44] Seen 20,192 samples
[2023-07-21 05:28:44] Starting data epoch 103 in logical epoch 103
[2023-07-21 05:28:44] [data] Shuffling data
[2023-07-21 05:28:44] [data] Done reading 20,192 sentences
[2023-07-21 05:28:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:32:32] Seen 20,192 samples
[2023-07-21 05:32:32] Starting data epoch 104 in logical epoch 104
[2023-07-21 05:32:32] [data] Shuffling data
[2023-07-21 05:32:32] [data] Done reading 20,192 sentences
[2023-07-21 05:32:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:33:07] Ep. 104 : Up. 4000 : Sen. 2,220 : Cost 3.94325066 * 15,923,925 @ 17,433 after 63,975,575 : Time 721.28s : 22077.44 words/s : gNorm 1.1318
[2023-07-21 05:36:18] Seen 20,192 samples
[2023-07-21 05:36:18] Starting data epoch 105 in logical epoch 105
[2023-07-21 05:36:18] [data] Shuffling data
[2023-07-21 05:36:18] [data] Done reading 20,192 sentences
[2023-07-21 05:36:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:40:03] Seen 20,192 samples
[2023-07-21 05:40:03] Starting data epoch 106 in logical epoch 106
[2023-07-21 05:40:03] [data] Shuffling data
[2023-07-21 05:40:03] [data] Done reading 20,192 sentences
[2023-07-21 05:40:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:43:50] Seen 20,192 samples
[2023-07-21 05:43:50] Starting data epoch 107 in logical epoch 107
[2023-07-21 05:43:50] [data] Shuffling data
[2023-07-21 05:43:50] [data] Done reading 20,192 sentences
[2023-07-21 05:43:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:47:37] Seen 20,192 samples
[2023-07-21 05:47:37] Starting data epoch 108 in logical epoch 108
[2023-07-21 05:47:37] [data] Shuffling data
[2023-07-21 05:47:37] [data] Done reading 20,192 sentences
[2023-07-21 05:47:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:51:18] Seen 20,192 samples
[2023-07-21 05:51:18] Starting data epoch 109 in logical epoch 109
[2023-07-21 05:51:18] [data] Shuffling data
[2023-07-21 05:51:18] [data] Done reading 20,192 sentences
[2023-07-21 05:51:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:54:50] Seen 20,192 samples
[2023-07-21 05:54:50] Starting data epoch 110 in logical epoch 110
[2023-07-21 05:54:50] [data] Shuffling data
[2023-07-21 05:54:50] [data] Done reading 20,192 sentences
[2023-07-21 05:54:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 05:58:23] Seen 20,192 samples
[2023-07-21 05:58:23] Starting data epoch 111 in logical epoch 111
[2023-07-21 05:58:23] Training finished
[2023-07-21 05:58:32] [valid] Ep. 111 : Up. 4265 : cross-entropy : 133.39 : new best
[2023-07-21 06:00:03] [valid] Ep. 111 : Up. 4265 : translation : 0 : new best
[2023-07-21 06:00:03] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 06:00:05] Saving Adam parameters
[2023-07-21 06:00:06] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 06:00:20] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 06:00:20] [marian] Running on node18.datos.cluster.uy as process 11888 with command line:
[2023-07-21 06:00:20] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 06:00:20] [config] after: 0e
[2023-07-21 06:00:20] [config] after-batches: 0
[2023-07-21 06:00:20] [config] after-epochs: 120
[2023-07-21 06:00:20] [config] all-caps-every: 0
[2023-07-21 06:00:20] [config] allow-unk: false
[2023-07-21 06:00:20] [config] authors: false
[2023-07-21 06:00:20] [config] beam-size: 12
[2023-07-21 06:00:20] [config] bert-class-symbol: "[CLS]"
[2023-07-21 06:00:20] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 06:00:20] [config] bert-masking-fraction: 0.15
[2023-07-21 06:00:20] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 06:00:20] [config] bert-train-type-embeddings: true
[2023-07-21 06:00:20] [config] bert-type-vocab-size: 2
[2023-07-21 06:00:20] [config] build-info: ""
[2023-07-21 06:00:20] [config] check-gradient-nan: false
[2023-07-21 06:00:20] [config] check-nan: false
[2023-07-21 06:00:20] [config] cite: false
[2023-07-21 06:00:20] [config] clip-norm: 1
[2023-07-21 06:00:20] [config] cost-scaling:
[2023-07-21 06:00:20] [config]   - 256.f
[2023-07-21 06:00:20] [config]   - 1000
[2023-07-21 06:00:20] [config]   - 2.f
[2023-07-21 06:00:20] [config]   - 256.f
[2023-07-21 06:00:20] [config] cost-type: ce-sum
[2023-07-21 06:00:20] [config] cpu-threads: 0
[2023-07-21 06:00:20] [config] data-threads: 8
[2023-07-21 06:00:20] [config] data-weighting: ""
[2023-07-21 06:00:20] [config] data-weighting-type: sentence
[2023-07-21 06:00:20] [config] dec-cell: gru
[2023-07-21 06:00:20] [config] dec-cell-base-depth: 2
[2023-07-21 06:00:20] [config] dec-cell-high-depth: 1
[2023-07-21 06:00:20] [config] dec-depth: 1
[2023-07-21 06:00:20] [config] devices:
[2023-07-21 06:00:20] [config]   - 0
[2023-07-21 06:00:20] [config] dim-emb: 512
[2023-07-21 06:00:20] [config] dim-rnn: 1024
[2023-07-21 06:00:20] [config] dim-vocabs:
[2023-07-21 06:00:20] [config]   - 16384
[2023-07-21 06:00:20] [config]   - 16384
[2023-07-21 06:00:20] [config] disp-first: 0
[2023-07-21 06:00:20] [config] disp-freq: 1000u
[2023-07-21 06:00:20] [config] disp-label-counts: true
[2023-07-21 06:00:20] [config] dropout-rnn: 0
[2023-07-21 06:00:20] [config] dropout-src: 0
[2023-07-21 06:00:20] [config] dropout-trg: 0
[2023-07-21 06:00:20] [config] dump-config: ""
[2023-07-21 06:00:20] [config] dynamic-gradient-scaling:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] early-stopping: 200
[2023-07-21 06:00:20] [config] early-stopping-on: first
[2023-07-21 06:00:20] [config] embedding-fix-src: false
[2023-07-21 06:00:20] [config] embedding-fix-trg: false
[2023-07-21 06:00:20] [config] embedding-normalization: false
[2023-07-21 06:00:20] [config] embedding-vectors:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] enc-cell: gru
[2023-07-21 06:00:20] [config] enc-cell-depth: 1
[2023-07-21 06:00:20] [config] enc-depth: 1
[2023-07-21 06:00:20] [config] enc-type: bidirectional
[2023-07-21 06:00:20] [config] english-title-case-every: 0
[2023-07-21 06:00:20] [config] exponential-smoothing: 0
[2023-07-21 06:00:20] [config] factor-weight: 1
[2023-07-21 06:00:20] [config] factors-combine: sum
[2023-07-21 06:00:20] [config] factors-dim-emb: 0
[2023-07-21 06:00:20] [config] gradient-checkpointing: false
[2023-07-21 06:00:20] [config] gradient-norm-average-window: 100
[2023-07-21 06:00:20] [config] guided-alignment: none
[2023-07-21 06:00:20] [config] guided-alignment-cost: mse
[2023-07-21 06:00:20] [config] guided-alignment-weight: 0.1
[2023-07-21 06:00:20] [config] ignore-model-config: false
[2023-07-21 06:00:20] [config] input-types:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] interpolate-env-vars: false
[2023-07-21 06:00:20] [config] keep-best: false
[2023-07-21 06:00:20] [config] label-smoothing: 0
[2023-07-21 06:00:20] [config] layer-normalization: false
[2023-07-21 06:00:20] [config] learn-rate: 0.0001
[2023-07-21 06:00:20] [config] lemma-dependency: ""
[2023-07-21 06:00:20] [config] lemma-dim-emb: 0
[2023-07-21 06:00:20] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 06:00:20] [config] log-level: info
[2023-07-21 06:00:20] [config] log-time-zone: ""
[2023-07-21 06:00:20] [config] logical-epoch:
[2023-07-21 06:00:20] [config]   - 1e
[2023-07-21 06:00:20] [config]   - 0
[2023-07-21 06:00:20] [config] lr-decay: 0
[2023-07-21 06:00:20] [config] lr-decay-freq: 50000
[2023-07-21 06:00:20] [config] lr-decay-inv-sqrt:
[2023-07-21 06:00:20] [config]   - 0
[2023-07-21 06:00:20] [config] lr-decay-repeat-warmup: false
[2023-07-21 06:00:20] [config] lr-decay-reset-optimizer: false
[2023-07-21 06:00:20] [config] lr-decay-start:
[2023-07-21 06:00:20] [config]   - 10
[2023-07-21 06:00:20] [config]   - 1
[2023-07-21 06:00:20] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 06:00:20] [config] lr-report: false
[2023-07-21 06:00:20] [config] lr-warmup: 0
[2023-07-21 06:00:20] [config] lr-warmup-at-reload: false
[2023-07-21 06:00:20] [config] lr-warmup-cycle: false
[2023-07-21 06:00:20] [config] lr-warmup-start-rate: 0
[2023-07-21 06:00:20] [config] max-length: 250
[2023-07-21 06:00:20] [config] max-length-crop: true
[2023-07-21 06:00:20] [config] max-length-factor: 3
[2023-07-21 06:00:20] [config] maxi-batch: 100
[2023-07-21 06:00:20] [config] maxi-batch-sort: trg
[2023-07-21 06:00:20] [config] mini-batch: 64
[2023-07-21 06:00:20] [config] mini-batch-fit: true
[2023-07-21 06:00:20] [config] mini-batch-fit-step: 10
[2023-07-21 06:00:20] [config] mini-batch-round-up: true
[2023-07-21 06:00:20] [config] mini-batch-track-lr: false
[2023-07-21 06:00:20] [config] mini-batch-warmup: 0
[2023-07-21 06:00:20] [config] mini-batch-words: 0
[2023-07-21 06:00:20] [config] mini-batch-words-ref: 0
[2023-07-21 06:00:20] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 06:00:20] [config] multi-loss-type: sum
[2023-07-21 06:00:20] [config] n-best: false
[2023-07-21 06:00:20] [config] no-nccl: false
[2023-07-21 06:00:20] [config] no-reload: false
[2023-07-21 06:00:20] [config] no-restore-corpus: false
[2023-07-21 06:00:20] [config] normalize: 0
[2023-07-21 06:00:20] [config] normalize-gradient: false
[2023-07-21 06:00:20] [config] num-devices: 0
[2023-07-21 06:00:20] [config] optimizer: adam
[2023-07-21 06:00:20] [config] optimizer-delay: 1
[2023-07-21 06:00:20] [config] optimizer-params:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] output-omit-bias: false
[2023-07-21 06:00:20] [config] overwrite: true
[2023-07-21 06:00:20] [config] precision:
[2023-07-21 06:00:20] [config]   - float16
[2023-07-21 06:00:20] [config]   - float32
[2023-07-21 06:00:20] [config] pretrained-model: ""
[2023-07-21 06:00:20] [config] quantize-biases: false
[2023-07-21 06:00:20] [config] quantize-bits: 0
[2023-07-21 06:00:20] [config] quantize-log-based: false
[2023-07-21 06:00:20] [config] quantize-optimization-steps: 0
[2023-07-21 06:00:20] [config] quiet: false
[2023-07-21 06:00:20] [config] quiet-translation: true
[2023-07-21 06:00:20] [config] relative-paths: false
[2023-07-21 06:00:20] [config] right-left: false
[2023-07-21 06:00:20] [config] save-freq: 10000u
[2023-07-21 06:00:20] [config] seed: 1234
[2023-07-21 06:00:20] [config] sentencepiece-alphas:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] sentencepiece-max-lines: 2000000
[2023-07-21 06:00:20] [config] sentencepiece-options: ""
[2023-07-21 06:00:20] [config] sharding: global
[2023-07-21 06:00:20] [config] shuffle: data
[2023-07-21 06:00:20] [config] shuffle-in-ram: false
[2023-07-21 06:00:20] [config] sigterm: save-and-exit
[2023-07-21 06:00:20] [config] skip: false
[2023-07-21 06:00:20] [config] sqlite: ""
[2023-07-21 06:00:20] [config] sqlite-drop: false
[2023-07-21 06:00:20] [config] sync-freq: 200u
[2023-07-21 06:00:20] [config] sync-sgd: false
[2023-07-21 06:00:20] [config] tempdir: /tmp
[2023-07-21 06:00:20] [config] tied-embeddings: false
[2023-07-21 06:00:20] [config] tied-embeddings-all: true
[2023-07-21 06:00:20] [config] tied-embeddings-src: false
[2023-07-21 06:00:20] [config] train-embedder-rank:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] train-sets:
[2023-07-21 06:00:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 06:00:20] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 06:00:20] [config] transformer-aan-activation: swish
[2023-07-21 06:00:20] [config] transformer-aan-depth: 2
[2023-07-21 06:00:20] [config] transformer-aan-nogate: false
[2023-07-21 06:00:20] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 06:00:20] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 06:00:20] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 06:00:20] [config] transformer-depth-scaling: false
[2023-07-21 06:00:20] [config] transformer-dim-aan: 2048
[2023-07-21 06:00:20] [config] transformer-dim-ffn: 2048
[2023-07-21 06:00:20] [config] transformer-dropout: 0
[2023-07-21 06:00:20] [config] transformer-dropout-attention: 0
[2023-07-21 06:00:20] [config] transformer-dropout-ffn: 0
[2023-07-21 06:00:20] [config] transformer-ffn-activation: swish
[2023-07-21 06:00:20] [config] transformer-ffn-depth: 2
[2023-07-21 06:00:20] [config] transformer-guided-alignment-layer: last
[2023-07-21 06:00:20] [config] transformer-heads: 8
[2023-07-21 06:00:20] [config] transformer-no-projection: false
[2023-07-21 06:00:20] [config] transformer-pool: false
[2023-07-21 06:00:20] [config] transformer-postprocess: dan
[2023-07-21 06:00:20] [config] transformer-postprocess-emb: d
[2023-07-21 06:00:20] [config] transformer-postprocess-top: ""
[2023-07-21 06:00:20] [config] transformer-preprocess: ""
[2023-07-21 06:00:20] [config] transformer-tied-layers:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] transformer-train-position-embeddings: false
[2023-07-21 06:00:20] [config] tsv: false
[2023-07-21 06:00:20] [config] tsv-fields: 0
[2023-07-21 06:00:20] [config] type: amun
[2023-07-21 06:00:20] [config] ulr: false
[2023-07-21 06:00:20] [config] ulr-dim-emb: 0
[2023-07-21 06:00:20] [config] ulr-dropout: 0
[2023-07-21 06:00:20] [config] ulr-keys-vectors: ""
[2023-07-21 06:00:20] [config] ulr-query-vectors: ""
[2023-07-21 06:00:20] [config] ulr-softmax-temperature: 1
[2023-07-21 06:00:20] [config] ulr-trainable-transformation: false
[2023-07-21 06:00:20] [config] unlikelihood-loss: false
[2023-07-21 06:00:20] [config] valid-freq: 50000000
[2023-07-21 06:00:20] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 06:00:20] [config] valid-max-length: 1000
[2023-07-21 06:00:20] [config] valid-metrics:
[2023-07-21 06:00:20] [config]   - cross-entropy
[2023-07-21 06:00:20] [config]   - translation
[2023-07-21 06:00:20] [config] valid-mini-batch: 32
[2023-07-21 06:00:20] [config] valid-reset-stalled: false
[2023-07-21 06:00:20] [config] valid-script-args:
[2023-07-21 06:00:20] [config]   []
[2023-07-21 06:00:20] [config] valid-script-path: ""
[2023-07-21 06:00:20] [config] valid-sets:
[2023-07-21 06:00:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 06:00:20] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 06:00:20] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 06:00:20] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 06:00:20] [config] vocabs:
[2023-07-21 06:00:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 06:00:20] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 06:00:20] [config] word-penalty: 0
[2023-07-21 06:00:20] [config] word-scores: false
[2023-07-21 06:00:20] [config] workspace: 5500
[2023-07-21 06:00:20] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 06:00:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 06:00:20] [training] Using single-device training
[2023-07-21 06:00:20] Synced seed 1234
[2023-07-21 06:00:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 06:00:20] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 06:00:20] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 06:00:20] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 06:00:20] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 06:00:20] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 06:00:20] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 06:00:21] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 06:00:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 06:00:22] [comm] Using global sharding
[2023-07-21 06:00:22] [comm] NCCLCommunicators constructed successfully
[2023-07-21 06:00:22] [training] Using 1 GPUs
[2023-07-21 06:00:22] [logits] Applying loss function for 1 factor(s)
[2023-07-21 06:00:22] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:00:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 06:00:22] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:44:38] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 06:44:38] [valid] No post-processing script given for validating translator
[2023-07-21 06:44:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 06:44:38] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 06:44:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 06:44:38] [comm] Using global sharding
[2023-07-21 06:44:39] [comm] NCCLCommunicators constructed successfully
[2023-07-21 06:44:39] [training] Using 1 GPUs
[2023-07-21 06:44:39] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 06:44:45] Allocating memory for general optimizer shards
[2023-07-21 06:44:45] [memory] Reserving 322 MB, device gpu0
[2023-07-21 06:44:45] Loading Adam parameters
[2023-07-21 06:44:45] [memory] Reserving 322 MB, device gpu0
[2023-07-21 06:44:45] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:44:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 06:44:45] [data] Restoring the corpus state to epoch 111, batch 4265
[2023-07-21 06:44:45] [data] Shuffling data
[2023-07-21 06:44:45] [data] Done reading 20,192 sentences
[2023-07-21 06:44:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:44:45] Training started
[2023-07-21 06:44:45] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 06:44:46] [memory] Reserving 80 MB, device gpu0
[2023-07-21 06:44:54] Parameter type float16, optimization type float32, casting types true
[2023-07-21 06:48:13] Seen 20,192 samples
[2023-07-21 06:48:13] Starting data epoch 112 in logical epoch 112
[2023-07-21 06:48:13] [data] Shuffling data
[2023-07-21 06:48:13] [data] Done reading 20,192 sentences
[2023-07-21 06:48:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:51:36] Seen 20,192 samples
[2023-07-21 06:51:36] Starting data epoch 113 in logical epoch 113
[2023-07-21 06:51:36] [data] Shuffling data
[2023-07-21 06:51:36] [data] Done reading 20,192 sentences
[2023-07-21 06:51:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:55:17] Seen 20,192 samples
[2023-07-21 06:55:17] Starting data epoch 114 in logical epoch 114
[2023-07-21 06:55:17] [data] Shuffling data
[2023-07-21 06:55:18] [data] Done reading 20,192 sentences
[2023-07-21 06:55:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 06:58:52] Seen 20,192 samples
[2023-07-21 06:58:52] Starting data epoch 115 in logical epoch 115
[2023-07-21 06:58:52] [data] Shuffling data
[2023-07-21 06:58:52] [data] Done reading 20,192 sentences
[2023-07-21 06:58:52] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:02:20] Seen 20,192 samples
[2023-07-21 07:02:20] Starting data epoch 116 in logical epoch 116
[2023-07-21 07:02:20] [data] Shuffling data
[2023-07-21 07:02:20] [data] Done reading 20,192 sentences
[2023-07-21 07:02:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:05:53] Seen 20,192 samples
[2023-07-21 07:05:53] Starting data epoch 117 in logical epoch 117
[2023-07-21 07:05:53] [data] Shuffling data
[2023-07-21 07:05:53] [data] Done reading 20,192 sentences
[2023-07-21 07:05:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:09:29] Seen 20,192 samples
[2023-07-21 07:09:29] Starting data epoch 118 in logical epoch 118
[2023-07-21 07:09:29] [data] Shuffling data
[2023-07-21 07:09:29] [data] Done reading 20,192 sentences
[2023-07-21 07:09:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:13:01] Seen 20,192 samples
[2023-07-21 07:13:01] Starting data epoch 119 in logical epoch 119
[2023-07-21 07:13:01] [data] Shuffling data
[2023-07-21 07:13:01] [data] Done reading 20,192 sentences
[2023-07-21 07:13:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:16:33] Seen 20,192 samples
[2023-07-21 07:16:33] Starting data epoch 120 in logical epoch 120
[2023-07-21 07:16:33] [data] Shuffling data
[2023-07-21 07:16:33] [data] Done reading 20,192 sentences
[2023-07-21 07:16:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 07:20:24] Seen 20,192 samples
[2023-07-21 07:20:24] Starting data epoch 121 in logical epoch 121
[2023-07-21 07:20:24] Training finished
[2023-07-21 07:20:33] [valid] Ep. 121 : Up. 4654 : cross-entropy : 132.209 : new best
[2023-07-21 07:22:11] [valid] Ep. 121 : Up. 4654 : translation : 0 : new best
[2023-07-21 07:22:11] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 07:22:13] Saving Adam parameters
[2023-07-21 07:22:13] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 07:22:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 07:22:21] [marian] Running on node18.datos.cluster.uy as process 40380 with command line:
[2023-07-21 07:22:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 07:22:21] [config] after: 0e
[2023-07-21 07:22:21] [config] after-batches: 0
[2023-07-21 07:22:21] [config] after-epochs: 130
[2023-07-21 07:22:21] [config] all-caps-every: 0
[2023-07-21 07:22:21] [config] allow-unk: false
[2023-07-21 07:22:21] [config] authors: false
[2023-07-21 07:22:21] [config] beam-size: 12
[2023-07-21 07:22:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 07:22:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 07:22:21] [config] bert-masking-fraction: 0.15
[2023-07-21 07:22:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 07:22:21] [config] bert-train-type-embeddings: true
[2023-07-21 07:22:21] [config] bert-type-vocab-size: 2
[2023-07-21 07:22:21] [config] build-info: ""
[2023-07-21 07:22:21] [config] check-gradient-nan: false
[2023-07-21 07:22:21] [config] check-nan: false
[2023-07-21 07:22:21] [config] cite: false
[2023-07-21 07:22:21] [config] clip-norm: 1
[2023-07-21 07:22:21] [config] cost-scaling:
[2023-07-21 07:22:21] [config]   - 256.f
[2023-07-21 07:22:21] [config]   - 1000
[2023-07-21 07:22:21] [config]   - 2.f
[2023-07-21 07:22:21] [config]   - 256.f
[2023-07-21 07:22:21] [config] cost-type: ce-sum
[2023-07-21 07:22:21] [config] cpu-threads: 0
[2023-07-21 07:22:21] [config] data-threads: 8
[2023-07-21 07:22:21] [config] data-weighting: ""
[2023-07-21 07:22:21] [config] data-weighting-type: sentence
[2023-07-21 07:22:21] [config] dec-cell: gru
[2023-07-21 07:22:21] [config] dec-cell-base-depth: 2
[2023-07-21 07:22:21] [config] dec-cell-high-depth: 1
[2023-07-21 07:22:21] [config] dec-depth: 1
[2023-07-21 07:22:21] [config] devices:
[2023-07-21 07:22:21] [config]   - 0
[2023-07-21 07:22:21] [config] dim-emb: 512
[2023-07-21 07:22:21] [config] dim-rnn: 1024
[2023-07-21 07:22:21] [config] dim-vocabs:
[2023-07-21 07:22:21] [config]   - 16384
[2023-07-21 07:22:21] [config]   - 16384
[2023-07-21 07:22:21] [config] disp-first: 0
[2023-07-21 07:22:21] [config] disp-freq: 1000u
[2023-07-21 07:22:21] [config] disp-label-counts: true
[2023-07-21 07:22:21] [config] dropout-rnn: 0
[2023-07-21 07:22:21] [config] dropout-src: 0
[2023-07-21 07:22:21] [config] dropout-trg: 0
[2023-07-21 07:22:21] [config] dump-config: ""
[2023-07-21 07:22:21] [config] dynamic-gradient-scaling:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] early-stopping: 200
[2023-07-21 07:22:21] [config] early-stopping-on: first
[2023-07-21 07:22:21] [config] embedding-fix-src: false
[2023-07-21 07:22:21] [config] embedding-fix-trg: false
[2023-07-21 07:22:21] [config] embedding-normalization: false
[2023-07-21 07:22:21] [config] embedding-vectors:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] enc-cell: gru
[2023-07-21 07:22:21] [config] enc-cell-depth: 1
[2023-07-21 07:22:21] [config] enc-depth: 1
[2023-07-21 07:22:21] [config] enc-type: bidirectional
[2023-07-21 07:22:21] [config] english-title-case-every: 0
[2023-07-21 07:22:21] [config] exponential-smoothing: 0
[2023-07-21 07:22:21] [config] factor-weight: 1
[2023-07-21 07:22:21] [config] factors-combine: sum
[2023-07-21 07:22:21] [config] factors-dim-emb: 0
[2023-07-21 07:22:21] [config] gradient-checkpointing: false
[2023-07-21 07:22:21] [config] gradient-norm-average-window: 100
[2023-07-21 07:22:21] [config] guided-alignment: none
[2023-07-21 07:22:21] [config] guided-alignment-cost: mse
[2023-07-21 07:22:21] [config] guided-alignment-weight: 0.1
[2023-07-21 07:22:21] [config] ignore-model-config: false
[2023-07-21 07:22:21] [config] input-types:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] interpolate-env-vars: false
[2023-07-21 07:22:21] [config] keep-best: false
[2023-07-21 07:22:21] [config] label-smoothing: 0
[2023-07-21 07:22:21] [config] layer-normalization: false
[2023-07-21 07:22:21] [config] learn-rate: 0.0001
[2023-07-21 07:22:21] [config] lemma-dependency: ""
[2023-07-21 07:22:21] [config] lemma-dim-emb: 0
[2023-07-21 07:22:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 07:22:21] [config] log-level: info
[2023-07-21 07:22:21] [config] log-time-zone: ""
[2023-07-21 07:22:21] [config] logical-epoch:
[2023-07-21 07:22:21] [config]   - 1e
[2023-07-21 07:22:21] [config]   - 0
[2023-07-21 07:22:21] [config] lr-decay: 0
[2023-07-21 07:22:21] [config] lr-decay-freq: 50000
[2023-07-21 07:22:21] [config] lr-decay-inv-sqrt:
[2023-07-21 07:22:21] [config]   - 0
[2023-07-21 07:22:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 07:22:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 07:22:21] [config] lr-decay-start:
[2023-07-21 07:22:21] [config]   - 10
[2023-07-21 07:22:21] [config]   - 1
[2023-07-21 07:22:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 07:22:21] [config] lr-report: false
[2023-07-21 07:22:21] [config] lr-warmup: 0
[2023-07-21 07:22:21] [config] lr-warmup-at-reload: false
[2023-07-21 07:22:21] [config] lr-warmup-cycle: false
[2023-07-21 07:22:21] [config] lr-warmup-start-rate: 0
[2023-07-21 07:22:21] [config] max-length: 250
[2023-07-21 07:22:21] [config] max-length-crop: true
[2023-07-21 07:22:21] [config] max-length-factor: 3
[2023-07-21 07:22:21] [config] maxi-batch: 100
[2023-07-21 07:22:21] [config] maxi-batch-sort: trg
[2023-07-21 07:22:21] [config] mini-batch: 64
[2023-07-21 07:22:21] [config] mini-batch-fit: true
[2023-07-21 07:22:21] [config] mini-batch-fit-step: 10
[2023-07-21 07:22:21] [config] mini-batch-round-up: true
[2023-07-21 07:22:21] [config] mini-batch-track-lr: false
[2023-07-21 07:22:21] [config] mini-batch-warmup: 0
[2023-07-21 07:22:21] [config] mini-batch-words: 0
[2023-07-21 07:22:21] [config] mini-batch-words-ref: 0
[2023-07-21 07:22:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 07:22:21] [config] multi-loss-type: sum
[2023-07-21 07:22:21] [config] n-best: false
[2023-07-21 07:22:21] [config] no-nccl: false
[2023-07-21 07:22:21] [config] no-reload: false
[2023-07-21 07:22:21] [config] no-restore-corpus: false
[2023-07-21 07:22:21] [config] normalize: 0
[2023-07-21 07:22:21] [config] normalize-gradient: false
[2023-07-21 07:22:21] [config] num-devices: 0
[2023-07-21 07:22:21] [config] optimizer: adam
[2023-07-21 07:22:21] [config] optimizer-delay: 1
[2023-07-21 07:22:21] [config] optimizer-params:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] output-omit-bias: false
[2023-07-21 07:22:21] [config] overwrite: true
[2023-07-21 07:22:21] [config] precision:
[2023-07-21 07:22:21] [config]   - float16
[2023-07-21 07:22:21] [config]   - float32
[2023-07-21 07:22:21] [config] pretrained-model: ""
[2023-07-21 07:22:21] [config] quantize-biases: false
[2023-07-21 07:22:21] [config] quantize-bits: 0
[2023-07-21 07:22:21] [config] quantize-log-based: false
[2023-07-21 07:22:21] [config] quantize-optimization-steps: 0
[2023-07-21 07:22:21] [config] quiet: false
[2023-07-21 07:22:21] [config] quiet-translation: true
[2023-07-21 07:22:21] [config] relative-paths: false
[2023-07-21 07:22:21] [config] right-left: false
[2023-07-21 07:22:21] [config] save-freq: 10000u
[2023-07-21 07:22:21] [config] seed: 1234
[2023-07-21 07:22:21] [config] sentencepiece-alphas:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 07:22:21] [config] sentencepiece-options: ""
[2023-07-21 07:22:21] [config] sharding: global
[2023-07-21 07:22:21] [config] shuffle: data
[2023-07-21 07:22:21] [config] shuffle-in-ram: false
[2023-07-21 07:22:21] [config] sigterm: save-and-exit
[2023-07-21 07:22:21] [config] skip: false
[2023-07-21 07:22:21] [config] sqlite: ""
[2023-07-21 07:22:21] [config] sqlite-drop: false
[2023-07-21 07:22:21] [config] sync-freq: 200u
[2023-07-21 07:22:21] [config] sync-sgd: false
[2023-07-21 07:22:21] [config] tempdir: /tmp
[2023-07-21 07:22:21] [config] tied-embeddings: false
[2023-07-21 07:22:21] [config] tied-embeddings-all: true
[2023-07-21 07:22:21] [config] tied-embeddings-src: false
[2023-07-21 07:22:21] [config] train-embedder-rank:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] train-sets:
[2023-07-21 07:22:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 07:22:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 07:22:21] [config] transformer-aan-activation: swish
[2023-07-21 07:22:21] [config] transformer-aan-depth: 2
[2023-07-21 07:22:21] [config] transformer-aan-nogate: false
[2023-07-21 07:22:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 07:22:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 07:22:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 07:22:21] [config] transformer-depth-scaling: false
[2023-07-21 07:22:21] [config] transformer-dim-aan: 2048
[2023-07-21 07:22:21] [config] transformer-dim-ffn: 2048
[2023-07-21 07:22:21] [config] transformer-dropout: 0
[2023-07-21 07:22:21] [config] transformer-dropout-attention: 0
[2023-07-21 07:22:21] [config] transformer-dropout-ffn: 0
[2023-07-21 07:22:21] [config] transformer-ffn-activation: swish
[2023-07-21 07:22:21] [config] transformer-ffn-depth: 2
[2023-07-21 07:22:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 07:22:21] [config] transformer-heads: 8
[2023-07-21 07:22:21] [config] transformer-no-projection: false
[2023-07-21 07:22:21] [config] transformer-pool: false
[2023-07-21 07:22:21] [config] transformer-postprocess: dan
[2023-07-21 07:22:21] [config] transformer-postprocess-emb: d
[2023-07-21 07:22:21] [config] transformer-postprocess-top: ""
[2023-07-21 07:22:21] [config] transformer-preprocess: ""
[2023-07-21 07:22:21] [config] transformer-tied-layers:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] transformer-train-position-embeddings: false
[2023-07-21 07:22:21] [config] tsv: false
[2023-07-21 07:22:21] [config] tsv-fields: 0
[2023-07-21 07:22:21] [config] type: amun
[2023-07-21 07:22:21] [config] ulr: false
[2023-07-21 07:22:21] [config] ulr-dim-emb: 0
[2023-07-21 07:22:21] [config] ulr-dropout: 0
[2023-07-21 07:22:21] [config] ulr-keys-vectors: ""
[2023-07-21 07:22:21] [config] ulr-query-vectors: ""
[2023-07-21 07:22:21] [config] ulr-softmax-temperature: 1
[2023-07-21 07:22:21] [config] ulr-trainable-transformation: false
[2023-07-21 07:22:21] [config] unlikelihood-loss: false
[2023-07-21 07:22:21] [config] valid-freq: 50000000
[2023-07-21 07:22:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 07:22:21] [config] valid-max-length: 1000
[2023-07-21 07:22:21] [config] valid-metrics:
[2023-07-21 07:22:21] [config]   - cross-entropy
[2023-07-21 07:22:21] [config]   - translation
[2023-07-21 07:22:21] [config] valid-mini-batch: 32
[2023-07-21 07:22:21] [config] valid-reset-stalled: false
[2023-07-21 07:22:21] [config] valid-script-args:
[2023-07-21 07:22:21] [config]   []
[2023-07-21 07:22:21] [config] valid-script-path: ""
[2023-07-21 07:22:21] [config] valid-sets:
[2023-07-21 07:22:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 07:22:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 07:22:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 07:22:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 07:22:21] [config] vocabs:
[2023-07-21 07:22:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 07:22:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 07:22:21] [config] word-penalty: 0
[2023-07-21 07:22:21] [config] word-scores: false
[2023-07-21 07:22:21] [config] workspace: 5500
[2023-07-21 07:22:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 07:22:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 07:22:21] [training] Using single-device training
[2023-07-21 07:22:23] Synced seed 1234
[2023-07-21 07:22:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 07:22:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 07:22:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 07:22:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 07:22:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 07:22:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 07:22:23] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 07:22:24] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 07:22:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 07:22:24] [comm] Using global sharding
[2023-07-21 07:22:24] [comm] NCCLCommunicators constructed successfully
[2023-07-21 07:22:24] [training] Using 1 GPUs
[2023-07-21 07:22:24] [logits] Applying loss function for 1 factor(s)
[2023-07-21 07:22:24] [memory] Reserving 80 MB, device gpu0
[2023-07-21 07:22:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 07:22:25] [memory] Reserving 80 MB, device gpu0
[2023-07-21 08:04:55] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 08:04:55] [valid] No post-processing script given for validating translator
[2023-07-21 08:04:55] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 08:04:55] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 08:04:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 08:04:55] [comm] Using global sharding
[2023-07-21 08:04:55] [comm] NCCLCommunicators constructed successfully
[2023-07-21 08:04:55] [training] Using 1 GPUs
[2023-07-21 08:04:55] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 08:05:03] Allocating memory for general optimizer shards
[2023-07-21 08:05:03] [memory] Reserving 322 MB, device gpu0
[2023-07-21 08:05:03] Loading Adam parameters
[2023-07-21 08:05:03] [memory] Reserving 322 MB, device gpu0
[2023-07-21 08:05:03] [memory] Reserving 80 MB, device gpu0
[2023-07-21 08:05:03] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 08:05:03] [data] Restoring the corpus state to epoch 121, batch 4654
[2023-07-21 08:05:03] [data] Shuffling data
[2023-07-21 08:05:04] [data] Done reading 20,192 sentences
[2023-07-21 08:05:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:05:04] Training started
[2023-07-21 08:05:04] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 08:05:04] [memory] Reserving 80 MB, device gpu0
[2023-07-21 08:05:09] Parameter type float16, optimization type float32, casting types true
[2023-07-21 08:09:01] Seen 20,192 samples
[2023-07-21 08:09:01] Starting data epoch 122 in logical epoch 122
[2023-07-21 08:09:01] [data] Shuffling data
[2023-07-21 08:09:01] [data] Done reading 20,192 sentences
[2023-07-21 08:09:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:12:53] Seen 20,192 samples
[2023-07-21 08:12:53] Starting data epoch 123 in logical epoch 123
[2023-07-21 08:12:53] [data] Shuffling data
[2023-07-21 08:12:53] [data] Done reading 20,192 sentences
[2023-07-21 08:12:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:16:55] Seen 20,192 samples
[2023-07-21 08:16:55] Starting data epoch 124 in logical epoch 124
[2023-07-21 08:16:55] [data] Shuffling data
[2023-07-21 08:16:55] [data] Done reading 20,192 sentences
[2023-07-21 08:16:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:20:41] Seen 20,192 samples
[2023-07-21 08:20:41] Starting data epoch 125 in logical epoch 125
[2023-07-21 08:20:41] [data] Shuffling data
[2023-07-21 08:20:41] [data] Done reading 20,192 sentences
[2023-07-21 08:20:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:24:39] Seen 20,192 samples
[2023-07-21 08:24:39] Starting data epoch 126 in logical epoch 126
[2023-07-21 08:24:39] [data] Shuffling data
[2023-07-21 08:24:39] [data] Done reading 20,192 sentences
[2023-07-21 08:24:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:28:38] Seen 20,192 samples
[2023-07-21 08:28:38] Starting data epoch 127 in logical epoch 127
[2023-07-21 08:28:38] [data] Shuffling data
[2023-07-21 08:28:38] [data] Done reading 20,192 sentences
[2023-07-21 08:28:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:32:31] Seen 20,192 samples
[2023-07-21 08:32:31] Starting data epoch 128 in logical epoch 128
[2023-07-21 08:32:31] [data] Shuffling data
[2023-07-21 08:32:31] [data] Done reading 20,192 sentences
[2023-07-21 08:32:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:36:23] Seen 20,192 samples
[2023-07-21 08:36:23] Starting data epoch 129 in logical epoch 129
[2023-07-21 08:36:23] [data] Shuffling data
[2023-07-21 08:36:23] [data] Done reading 20,192 sentences
[2023-07-21 08:36:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:39:56] Ep. 129 : Up. 5000 : Sen. 19,486 : Cost 3.55514622 * 16,036,876 @ 2,296 after 80,012,456 : Time 2100.99s : 7633.01 words/s : gNorm 1.3710
[2023-07-21 08:40:11] Seen 20,192 samples
[2023-07-21 08:40:11] Starting data epoch 130 in logical epoch 130
[2023-07-21 08:40:11] [data] Shuffling data
[2023-07-21 08:40:11] [data] Done reading 20,192 sentences
[2023-07-21 08:40:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 08:43:52] Seen 20,192 samples
[2023-07-21 08:43:52] Starting data epoch 131 in logical epoch 131
[2023-07-21 08:43:52] Training finished
[2023-07-21 08:44:02] [valid] Ep. 131 : Up. 5041 : cross-entropy : 131.847 : new best
[2023-07-21 08:45:36] [valid] Ep. 131 : Up. 5041 : translation : 0 : new best
[2023-07-21 08:45:36] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 08:45:37] Saving Adam parameters
[2023-07-21 08:45:38] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 08:45:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 08:45:45] [marian] Running on node18.datos.cluster.uy as process 5264 with command line:
[2023-07-21 08:45:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 08:45:45] [config] after: 0e
[2023-07-21 08:45:45] [config] after-batches: 0
[2023-07-21 08:45:45] [config] after-epochs: 140
[2023-07-21 08:45:45] [config] all-caps-every: 0
[2023-07-21 08:45:45] [config] allow-unk: false
[2023-07-21 08:45:45] [config] authors: false
[2023-07-21 08:45:45] [config] beam-size: 12
[2023-07-21 08:45:45] [config] bert-class-symbol: "[CLS]"
[2023-07-21 08:45:45] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 08:45:45] [config] bert-masking-fraction: 0.15
[2023-07-21 08:45:45] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 08:45:45] [config] bert-train-type-embeddings: true
[2023-07-21 08:45:45] [config] bert-type-vocab-size: 2
[2023-07-21 08:45:45] [config] build-info: ""
[2023-07-21 08:45:45] [config] check-gradient-nan: false
[2023-07-21 08:45:45] [config] check-nan: false
[2023-07-21 08:45:45] [config] cite: false
[2023-07-21 08:45:45] [config] clip-norm: 1
[2023-07-21 08:45:45] [config] cost-scaling:
[2023-07-21 08:45:45] [config]   - 256.f
[2023-07-21 08:45:45] [config]   - 1000
[2023-07-21 08:45:45] [config]   - 2.f
[2023-07-21 08:45:45] [config]   - 256.f
[2023-07-21 08:45:45] [config] cost-type: ce-sum
[2023-07-21 08:45:45] [config] cpu-threads: 0
[2023-07-21 08:45:45] [config] data-threads: 8
[2023-07-21 08:45:45] [config] data-weighting: ""
[2023-07-21 08:45:45] [config] data-weighting-type: sentence
[2023-07-21 08:45:45] [config] dec-cell: gru
[2023-07-21 08:45:45] [config] dec-cell-base-depth: 2
[2023-07-21 08:45:45] [config] dec-cell-high-depth: 1
[2023-07-21 08:45:45] [config] dec-depth: 1
[2023-07-21 08:45:45] [config] devices:
[2023-07-21 08:45:45] [config]   - 0
[2023-07-21 08:45:45] [config] dim-emb: 512
[2023-07-21 08:45:45] [config] dim-rnn: 1024
[2023-07-21 08:45:45] [config] dim-vocabs:
[2023-07-21 08:45:45] [config]   - 16384
[2023-07-21 08:45:45] [config]   - 16384
[2023-07-21 08:45:45] [config] disp-first: 0
[2023-07-21 08:45:45] [config] disp-freq: 1000u
[2023-07-21 08:45:45] [config] disp-label-counts: true
[2023-07-21 08:45:45] [config] dropout-rnn: 0
[2023-07-21 08:45:45] [config] dropout-src: 0
[2023-07-21 08:45:45] [config] dropout-trg: 0
[2023-07-21 08:45:45] [config] dump-config: ""
[2023-07-21 08:45:45] [config] dynamic-gradient-scaling:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] early-stopping: 200
[2023-07-21 08:45:45] [config] early-stopping-on: first
[2023-07-21 08:45:45] [config] embedding-fix-src: false
[2023-07-21 08:45:45] [config] embedding-fix-trg: false
[2023-07-21 08:45:45] [config] embedding-normalization: false
[2023-07-21 08:45:45] [config] embedding-vectors:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] enc-cell: gru
[2023-07-21 08:45:45] [config] enc-cell-depth: 1
[2023-07-21 08:45:45] [config] enc-depth: 1
[2023-07-21 08:45:45] [config] enc-type: bidirectional
[2023-07-21 08:45:45] [config] english-title-case-every: 0
[2023-07-21 08:45:45] [config] exponential-smoothing: 0
[2023-07-21 08:45:45] [config] factor-weight: 1
[2023-07-21 08:45:45] [config] factors-combine: sum
[2023-07-21 08:45:45] [config] factors-dim-emb: 0
[2023-07-21 08:45:45] [config] gradient-checkpointing: false
[2023-07-21 08:45:45] [config] gradient-norm-average-window: 100
[2023-07-21 08:45:45] [config] guided-alignment: none
[2023-07-21 08:45:45] [config] guided-alignment-cost: mse
[2023-07-21 08:45:45] [config] guided-alignment-weight: 0.1
[2023-07-21 08:45:45] [config] ignore-model-config: false
[2023-07-21 08:45:45] [config] input-types:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] interpolate-env-vars: false
[2023-07-21 08:45:45] [config] keep-best: false
[2023-07-21 08:45:45] [config] label-smoothing: 0
[2023-07-21 08:45:45] [config] layer-normalization: false
[2023-07-21 08:45:45] [config] learn-rate: 0.0001
[2023-07-21 08:45:45] [config] lemma-dependency: ""
[2023-07-21 08:45:45] [config] lemma-dim-emb: 0
[2023-07-21 08:45:45] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 08:45:45] [config] log-level: info
[2023-07-21 08:45:45] [config] log-time-zone: ""
[2023-07-21 08:45:45] [config] logical-epoch:
[2023-07-21 08:45:45] [config]   - 1e
[2023-07-21 08:45:45] [config]   - 0
[2023-07-21 08:45:45] [config] lr-decay: 0
[2023-07-21 08:45:45] [config] lr-decay-freq: 50000
[2023-07-21 08:45:45] [config] lr-decay-inv-sqrt:
[2023-07-21 08:45:45] [config]   - 0
[2023-07-21 08:45:45] [config] lr-decay-repeat-warmup: false
[2023-07-21 08:45:45] [config] lr-decay-reset-optimizer: false
[2023-07-21 08:45:45] [config] lr-decay-start:
[2023-07-21 08:45:45] [config]   - 10
[2023-07-21 08:45:45] [config]   - 1
[2023-07-21 08:45:45] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 08:45:45] [config] lr-report: false
[2023-07-21 08:45:45] [config] lr-warmup: 0
[2023-07-21 08:45:45] [config] lr-warmup-at-reload: false
[2023-07-21 08:45:45] [config] lr-warmup-cycle: false
[2023-07-21 08:45:45] [config] lr-warmup-start-rate: 0
[2023-07-21 08:45:45] [config] max-length: 250
[2023-07-21 08:45:45] [config] max-length-crop: true
[2023-07-21 08:45:45] [config] max-length-factor: 3
[2023-07-21 08:45:45] [config] maxi-batch: 100
[2023-07-21 08:45:45] [config] maxi-batch-sort: trg
[2023-07-21 08:45:45] [config] mini-batch: 64
[2023-07-21 08:45:45] [config] mini-batch-fit: true
[2023-07-21 08:45:45] [config] mini-batch-fit-step: 10
[2023-07-21 08:45:45] [config] mini-batch-round-up: true
[2023-07-21 08:45:45] [config] mini-batch-track-lr: false
[2023-07-21 08:45:45] [config] mini-batch-warmup: 0
[2023-07-21 08:45:45] [config] mini-batch-words: 0
[2023-07-21 08:45:45] [config] mini-batch-words-ref: 0
[2023-07-21 08:45:45] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 08:45:45] [config] multi-loss-type: sum
[2023-07-21 08:45:45] [config] n-best: false
[2023-07-21 08:45:45] [config] no-nccl: false
[2023-07-21 08:45:45] [config] no-reload: false
[2023-07-21 08:45:45] [config] no-restore-corpus: false
[2023-07-21 08:45:45] [config] normalize: 0
[2023-07-21 08:45:45] [config] normalize-gradient: false
[2023-07-21 08:45:45] [config] num-devices: 0
[2023-07-21 08:45:45] [config] optimizer: adam
[2023-07-21 08:45:45] [config] optimizer-delay: 1
[2023-07-21 08:45:45] [config] optimizer-params:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] output-omit-bias: false
[2023-07-21 08:45:45] [config] overwrite: true
[2023-07-21 08:45:45] [config] precision:
[2023-07-21 08:45:45] [config]   - float16
[2023-07-21 08:45:45] [config]   - float32
[2023-07-21 08:45:45] [config] pretrained-model: ""
[2023-07-21 08:45:45] [config] quantize-biases: false
[2023-07-21 08:45:45] [config] quantize-bits: 0
[2023-07-21 08:45:45] [config] quantize-log-based: false
[2023-07-21 08:45:45] [config] quantize-optimization-steps: 0
[2023-07-21 08:45:45] [config] quiet: false
[2023-07-21 08:45:45] [config] quiet-translation: true
[2023-07-21 08:45:45] [config] relative-paths: false
[2023-07-21 08:45:45] [config] right-left: false
[2023-07-21 08:45:45] [config] save-freq: 10000u
[2023-07-21 08:45:45] [config] seed: 1234
[2023-07-21 08:45:45] [config] sentencepiece-alphas:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] sentencepiece-max-lines: 2000000
[2023-07-21 08:45:45] [config] sentencepiece-options: ""
[2023-07-21 08:45:45] [config] sharding: global
[2023-07-21 08:45:45] [config] shuffle: data
[2023-07-21 08:45:45] [config] shuffle-in-ram: false
[2023-07-21 08:45:45] [config] sigterm: save-and-exit
[2023-07-21 08:45:45] [config] skip: false
[2023-07-21 08:45:45] [config] sqlite: ""
[2023-07-21 08:45:45] [config] sqlite-drop: false
[2023-07-21 08:45:45] [config] sync-freq: 200u
[2023-07-21 08:45:45] [config] sync-sgd: false
[2023-07-21 08:45:45] [config] tempdir: /tmp
[2023-07-21 08:45:45] [config] tied-embeddings: false
[2023-07-21 08:45:45] [config] tied-embeddings-all: true
[2023-07-21 08:45:45] [config] tied-embeddings-src: false
[2023-07-21 08:45:45] [config] train-embedder-rank:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] train-sets:
[2023-07-21 08:45:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 08:45:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 08:45:45] [config] transformer-aan-activation: swish
[2023-07-21 08:45:45] [config] transformer-aan-depth: 2
[2023-07-21 08:45:45] [config] transformer-aan-nogate: false
[2023-07-21 08:45:45] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 08:45:45] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 08:45:45] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 08:45:45] [config] transformer-depth-scaling: false
[2023-07-21 08:45:45] [config] transformer-dim-aan: 2048
[2023-07-21 08:45:45] [config] transformer-dim-ffn: 2048
[2023-07-21 08:45:45] [config] transformer-dropout: 0
[2023-07-21 08:45:45] [config] transformer-dropout-attention: 0
[2023-07-21 08:45:45] [config] transformer-dropout-ffn: 0
[2023-07-21 08:45:45] [config] transformer-ffn-activation: swish
[2023-07-21 08:45:45] [config] transformer-ffn-depth: 2
[2023-07-21 08:45:45] [config] transformer-guided-alignment-layer: last
[2023-07-21 08:45:45] [config] transformer-heads: 8
[2023-07-21 08:45:45] [config] transformer-no-projection: false
[2023-07-21 08:45:45] [config] transformer-pool: false
[2023-07-21 08:45:45] [config] transformer-postprocess: dan
[2023-07-21 08:45:45] [config] transformer-postprocess-emb: d
[2023-07-21 08:45:45] [config] transformer-postprocess-top: ""
[2023-07-21 08:45:45] [config] transformer-preprocess: ""
[2023-07-21 08:45:45] [config] transformer-tied-layers:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] transformer-train-position-embeddings: false
[2023-07-21 08:45:45] [config] tsv: false
[2023-07-21 08:45:45] [config] tsv-fields: 0
[2023-07-21 08:45:45] [config] type: amun
[2023-07-21 08:45:45] [config] ulr: false
[2023-07-21 08:45:45] [config] ulr-dim-emb: 0
[2023-07-21 08:45:45] [config] ulr-dropout: 0
[2023-07-21 08:45:45] [config] ulr-keys-vectors: ""
[2023-07-21 08:45:45] [config] ulr-query-vectors: ""
[2023-07-21 08:45:45] [config] ulr-softmax-temperature: 1
[2023-07-21 08:45:45] [config] ulr-trainable-transformation: false
[2023-07-21 08:45:45] [config] unlikelihood-loss: false
[2023-07-21 08:45:45] [config] valid-freq: 50000000
[2023-07-21 08:45:45] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 08:45:45] [config] valid-max-length: 1000
[2023-07-21 08:45:45] [config] valid-metrics:
[2023-07-21 08:45:45] [config]   - cross-entropy
[2023-07-21 08:45:45] [config]   - translation
[2023-07-21 08:45:45] [config] valid-mini-batch: 32
[2023-07-21 08:45:45] [config] valid-reset-stalled: false
[2023-07-21 08:45:45] [config] valid-script-args:
[2023-07-21 08:45:45] [config]   []
[2023-07-21 08:45:45] [config] valid-script-path: ""
[2023-07-21 08:45:45] [config] valid-sets:
[2023-07-21 08:45:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 08:45:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 08:45:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 08:45:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 08:45:45] [config] vocabs:
[2023-07-21 08:45:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 08:45:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 08:45:45] [config] word-penalty: 0
[2023-07-21 08:45:45] [config] word-scores: false
[2023-07-21 08:45:45] [config] workspace: 5500
[2023-07-21 08:45:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 08:45:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 08:45:45] [training] Using single-device training
[2023-07-21 08:45:46] Synced seed 1234
[2023-07-21 08:45:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 08:45:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 08:45:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 08:45:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 08:45:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 08:45:46] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 08:45:46] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 08:45:47] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 08:45:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 08:45:47] [comm] Using global sharding
[2023-07-21 08:45:47] [comm] NCCLCommunicators constructed successfully
[2023-07-21 08:45:47] [training] Using 1 GPUs
[2023-07-21 08:45:47] [logits] Applying loss function for 1 factor(s)
[2023-07-21 08:45:47] [memory] Reserving 80 MB, device gpu0
[2023-07-21 08:45:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 08:45:47] [memory] Reserving 80 MB, device gpu0
[2023-07-21 09:27:07] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 09:27:07] [valid] No post-processing script given for validating translator
[2023-07-21 09:27:07] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 09:27:07] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 09:27:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 09:27:07] [comm] Using global sharding
[2023-07-21 09:27:07] [comm] NCCLCommunicators constructed successfully
[2023-07-21 09:27:07] [training] Using 1 GPUs
[2023-07-21 09:27:07] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 09:27:14] Allocating memory for general optimizer shards
[2023-07-21 09:27:14] [memory] Reserving 322 MB, device gpu0
[2023-07-21 09:27:14] Loading Adam parameters
[2023-07-21 09:27:14] [memory] Reserving 322 MB, device gpu0
[2023-07-21 09:27:14] [memory] Reserving 80 MB, device gpu0
[2023-07-21 09:27:15] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 09:27:15] [data] Restoring the corpus state to epoch 131, batch 5041
[2023-07-21 09:27:15] [data] Shuffling data
[2023-07-21 09:27:15] [data] Done reading 20,192 sentences
[2023-07-21 09:27:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:27:15] Training started
[2023-07-21 09:27:15] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 09:27:16] [memory] Reserving 80 MB, device gpu0
[2023-07-21 09:27:24] Parameter type float16, optimization type float32, casting types true
[2023-07-21 09:31:54] Seen 20,192 samples
[2023-07-21 09:31:54] Starting data epoch 132 in logical epoch 132
[2023-07-21 09:31:54] [data] Shuffling data
[2023-07-21 09:31:54] [data] Done reading 20,192 sentences
[2023-07-21 09:31:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:37:04] Seen 20,192 samples
[2023-07-21 09:37:04] Starting data epoch 133 in logical epoch 133
[2023-07-21 09:37:04] [data] Shuffling data
[2023-07-21 09:37:04] [data] Done reading 20,192 sentences
[2023-07-21 09:37:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:42:12] Seen 20,192 samples
[2023-07-21 09:42:12] Starting data epoch 134 in logical epoch 134
[2023-07-21 09:42:12] [data] Shuffling data
[2023-07-21 09:42:12] [data] Done reading 20,192 sentences
[2023-07-21 09:42:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:47:21] Seen 20,192 samples
[2023-07-21 09:47:21] Starting data epoch 135 in logical epoch 135
[2023-07-21 09:47:21] [data] Shuffling data
[2023-07-21 09:47:21] [data] Done reading 20,192 sentences
[2023-07-21 09:47:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:52:02] Seen 20,192 samples
[2023-07-21 09:52:02] Starting data epoch 136 in logical epoch 136
[2023-07-21 09:52:02] [data] Shuffling data
[2023-07-21 09:52:03] [data] Done reading 20,192 sentences
[2023-07-21 09:52:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 09:56:56] Seen 20,192 samples
[2023-07-21 09:56:56] Starting data epoch 137 in logical epoch 137
[2023-07-21 09:56:56] [data] Shuffling data
[2023-07-21 09:56:56] [data] Done reading 20,192 sentences
[2023-07-21 09:56:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:02:04] Seen 20,192 samples
[2023-07-21 10:02:04] Starting data epoch 138 in logical epoch 138
[2023-07-21 10:02:04] [data] Shuffling data
[2023-07-21 10:02:04] [data] Done reading 20,192 sentences
[2023-07-21 10:02:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:07:07] Seen 20,192 samples
[2023-07-21 10:07:07] Starting data epoch 139 in logical epoch 139
[2023-07-21 10:07:07] [data] Shuffling data
[2023-07-21 10:07:07] [data] Done reading 20,192 sentences
[2023-07-21 10:07:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:11:51] Seen 20,192 samples
[2023-07-21 10:11:51] Starting data epoch 140 in logical epoch 140
[2023-07-21 10:11:51] [data] Shuffling data
[2023-07-21 10:11:51] [data] Done reading 20,192 sentences
[2023-07-21 10:11:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 10:16:42] Seen 20,192 samples
[2023-07-21 10:16:42] Starting data epoch 141 in logical epoch 141
[2023-07-21 10:16:42] Training finished
[2023-07-21 10:16:56] [valid] Ep. 141 : Up. 5427 : cross-entropy : 130.991 : new best
[2023-07-21 10:19:43] [valid] Ep. 141 : Up. 5427 : translation : 0 : new best
[2023-07-21 10:19:43] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 10:19:45] Saving Adam parameters
[2023-07-21 10:19:46] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 10:19:54] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 10:19:54] [marian] Running on node18.datos.cluster.uy as process 11514 with command line:
[2023-07-21 10:19:54] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 10:19:54] [config] after: 0e
[2023-07-21 10:19:54] [config] after-batches: 0
[2023-07-21 10:19:54] [config] after-epochs: 150
[2023-07-21 10:19:54] [config] all-caps-every: 0
[2023-07-21 10:19:54] [config] allow-unk: false
[2023-07-21 10:19:54] [config] authors: false
[2023-07-21 10:19:54] [config] beam-size: 12
[2023-07-21 10:19:54] [config] bert-class-symbol: "[CLS]"
[2023-07-21 10:19:54] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 10:19:54] [config] bert-masking-fraction: 0.15
[2023-07-21 10:19:54] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 10:19:54] [config] bert-train-type-embeddings: true
[2023-07-21 10:19:54] [config] bert-type-vocab-size: 2
[2023-07-21 10:19:54] [config] build-info: ""
[2023-07-21 10:19:54] [config] check-gradient-nan: false
[2023-07-21 10:19:54] [config] check-nan: false
[2023-07-21 10:19:54] [config] cite: false
[2023-07-21 10:19:54] [config] clip-norm: 1
[2023-07-21 10:19:54] [config] cost-scaling:
[2023-07-21 10:19:54] [config]   - 256.f
[2023-07-21 10:19:54] [config]   - 1000
[2023-07-21 10:19:54] [config]   - 2.f
[2023-07-21 10:19:54] [config]   - 256.f
[2023-07-21 10:19:54] [config] cost-type: ce-sum
[2023-07-21 10:19:54] [config] cpu-threads: 0
[2023-07-21 10:19:54] [config] data-threads: 8
[2023-07-21 10:19:54] [config] data-weighting: ""
[2023-07-21 10:19:54] [config] data-weighting-type: sentence
[2023-07-21 10:19:54] [config] dec-cell: gru
[2023-07-21 10:19:54] [config] dec-cell-base-depth: 2
[2023-07-21 10:19:54] [config] dec-cell-high-depth: 1
[2023-07-21 10:19:54] [config] dec-depth: 1
[2023-07-21 10:19:54] [config] devices:
[2023-07-21 10:19:54] [config]   - 0
[2023-07-21 10:19:54] [config] dim-emb: 512
[2023-07-21 10:19:54] [config] dim-rnn: 1024
[2023-07-21 10:19:54] [config] dim-vocabs:
[2023-07-21 10:19:54] [config]   - 16384
[2023-07-21 10:19:54] [config]   - 16384
[2023-07-21 10:19:54] [config] disp-first: 0
[2023-07-21 10:19:54] [config] disp-freq: 1000u
[2023-07-21 10:19:54] [config] disp-label-counts: true
[2023-07-21 10:19:54] [config] dropout-rnn: 0
[2023-07-21 10:19:54] [config] dropout-src: 0
[2023-07-21 10:19:54] [config] dropout-trg: 0
[2023-07-21 10:19:54] [config] dump-config: ""
[2023-07-21 10:19:54] [config] dynamic-gradient-scaling:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] early-stopping: 200
[2023-07-21 10:19:54] [config] early-stopping-on: first
[2023-07-21 10:19:54] [config] embedding-fix-src: false
[2023-07-21 10:19:54] [config] embedding-fix-trg: false
[2023-07-21 10:19:54] [config] embedding-normalization: false
[2023-07-21 10:19:54] [config] embedding-vectors:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] enc-cell: gru
[2023-07-21 10:19:54] [config] enc-cell-depth: 1
[2023-07-21 10:19:54] [config] enc-depth: 1
[2023-07-21 10:19:54] [config] enc-type: bidirectional
[2023-07-21 10:19:54] [config] english-title-case-every: 0
[2023-07-21 10:19:54] [config] exponential-smoothing: 0
[2023-07-21 10:19:54] [config] factor-weight: 1
[2023-07-21 10:19:54] [config] factors-combine: sum
[2023-07-21 10:19:54] [config] factors-dim-emb: 0
[2023-07-21 10:19:54] [config] gradient-checkpointing: false
[2023-07-21 10:19:54] [config] gradient-norm-average-window: 100
[2023-07-21 10:19:54] [config] guided-alignment: none
[2023-07-21 10:19:54] [config] guided-alignment-cost: mse
[2023-07-21 10:19:54] [config] guided-alignment-weight: 0.1
[2023-07-21 10:19:54] [config] ignore-model-config: false
[2023-07-21 10:19:54] [config] input-types:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] interpolate-env-vars: false
[2023-07-21 10:19:54] [config] keep-best: false
[2023-07-21 10:19:54] [config] label-smoothing: 0
[2023-07-21 10:19:54] [config] layer-normalization: false
[2023-07-21 10:19:54] [config] learn-rate: 0.0001
[2023-07-21 10:19:54] [config] lemma-dependency: ""
[2023-07-21 10:19:54] [config] lemma-dim-emb: 0
[2023-07-21 10:19:54] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 10:19:54] [config] log-level: info
[2023-07-21 10:19:54] [config] log-time-zone: ""
[2023-07-21 10:19:54] [config] logical-epoch:
[2023-07-21 10:19:54] [config]   - 1e
[2023-07-21 10:19:54] [config]   - 0
[2023-07-21 10:19:54] [config] lr-decay: 0
[2023-07-21 10:19:54] [config] lr-decay-freq: 50000
[2023-07-21 10:19:54] [config] lr-decay-inv-sqrt:
[2023-07-21 10:19:54] [config]   - 0
[2023-07-21 10:19:54] [config] lr-decay-repeat-warmup: false
[2023-07-21 10:19:54] [config] lr-decay-reset-optimizer: false
[2023-07-21 10:19:54] [config] lr-decay-start:
[2023-07-21 10:19:54] [config]   - 10
[2023-07-21 10:19:54] [config]   - 1
[2023-07-21 10:19:54] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 10:19:54] [config] lr-report: false
[2023-07-21 10:19:54] [config] lr-warmup: 0
[2023-07-21 10:19:54] [config] lr-warmup-at-reload: false
[2023-07-21 10:19:54] [config] lr-warmup-cycle: false
[2023-07-21 10:19:54] [config] lr-warmup-start-rate: 0
[2023-07-21 10:19:54] [config] max-length: 250
[2023-07-21 10:19:54] [config] max-length-crop: true
[2023-07-21 10:19:54] [config] max-length-factor: 3
[2023-07-21 10:19:54] [config] maxi-batch: 100
[2023-07-21 10:19:54] [config] maxi-batch-sort: trg
[2023-07-21 10:19:54] [config] mini-batch: 64
[2023-07-21 10:19:54] [config] mini-batch-fit: true
[2023-07-21 10:19:54] [config] mini-batch-fit-step: 10
[2023-07-21 10:19:54] [config] mini-batch-round-up: true
[2023-07-21 10:19:54] [config] mini-batch-track-lr: false
[2023-07-21 10:19:54] [config] mini-batch-warmup: 0
[2023-07-21 10:19:54] [config] mini-batch-words: 0
[2023-07-21 10:19:54] [config] mini-batch-words-ref: 0
[2023-07-21 10:19:54] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 10:19:54] [config] multi-loss-type: sum
[2023-07-21 10:19:54] [config] n-best: false
[2023-07-21 10:19:54] [config] no-nccl: false
[2023-07-21 10:19:54] [config] no-reload: false
[2023-07-21 10:19:54] [config] no-restore-corpus: false
[2023-07-21 10:19:54] [config] normalize: 0
[2023-07-21 10:19:54] [config] normalize-gradient: false
[2023-07-21 10:19:54] [config] num-devices: 0
[2023-07-21 10:19:54] [config] optimizer: adam
[2023-07-21 10:19:54] [config] optimizer-delay: 1
[2023-07-21 10:19:54] [config] optimizer-params:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] output-omit-bias: false
[2023-07-21 10:19:54] [config] overwrite: true
[2023-07-21 10:19:54] [config] precision:
[2023-07-21 10:19:54] [config]   - float16
[2023-07-21 10:19:54] [config]   - float32
[2023-07-21 10:19:54] [config] pretrained-model: ""
[2023-07-21 10:19:54] [config] quantize-biases: false
[2023-07-21 10:19:54] [config] quantize-bits: 0
[2023-07-21 10:19:54] [config] quantize-log-based: false
[2023-07-21 10:19:54] [config] quantize-optimization-steps: 0
[2023-07-21 10:19:54] [config] quiet: false
[2023-07-21 10:19:54] [config] quiet-translation: true
[2023-07-21 10:19:54] [config] relative-paths: false
[2023-07-21 10:19:54] [config] right-left: false
[2023-07-21 10:19:54] [config] save-freq: 10000u
[2023-07-21 10:19:54] [config] seed: 1234
[2023-07-21 10:19:54] [config] sentencepiece-alphas:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] sentencepiece-max-lines: 2000000
[2023-07-21 10:19:54] [config] sentencepiece-options: ""
[2023-07-21 10:19:54] [config] sharding: global
[2023-07-21 10:19:54] [config] shuffle: data
[2023-07-21 10:19:54] [config] shuffle-in-ram: false
[2023-07-21 10:19:54] [config] sigterm: save-and-exit
[2023-07-21 10:19:54] [config] skip: false
[2023-07-21 10:19:54] [config] sqlite: ""
[2023-07-21 10:19:54] [config] sqlite-drop: false
[2023-07-21 10:19:54] [config] sync-freq: 200u
[2023-07-21 10:19:54] [config] sync-sgd: false
[2023-07-21 10:19:54] [config] tempdir: /tmp
[2023-07-21 10:19:54] [config] tied-embeddings: false
[2023-07-21 10:19:54] [config] tied-embeddings-all: true
[2023-07-21 10:19:54] [config] tied-embeddings-src: false
[2023-07-21 10:19:54] [config] train-embedder-rank:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] train-sets:
[2023-07-21 10:19:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 10:19:54] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 10:19:54] [config] transformer-aan-activation: swish
[2023-07-21 10:19:54] [config] transformer-aan-depth: 2
[2023-07-21 10:19:54] [config] transformer-aan-nogate: false
[2023-07-21 10:19:54] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 10:19:54] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 10:19:54] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 10:19:54] [config] transformer-depth-scaling: false
[2023-07-21 10:19:54] [config] transformer-dim-aan: 2048
[2023-07-21 10:19:54] [config] transformer-dim-ffn: 2048
[2023-07-21 10:19:54] [config] transformer-dropout: 0
[2023-07-21 10:19:54] [config] transformer-dropout-attention: 0
[2023-07-21 10:19:54] [config] transformer-dropout-ffn: 0
[2023-07-21 10:19:54] [config] transformer-ffn-activation: swish
[2023-07-21 10:19:54] [config] transformer-ffn-depth: 2
[2023-07-21 10:19:54] [config] transformer-guided-alignment-layer: last
[2023-07-21 10:19:54] [config] transformer-heads: 8
[2023-07-21 10:19:54] [config] transformer-no-projection: false
[2023-07-21 10:19:54] [config] transformer-pool: false
[2023-07-21 10:19:54] [config] transformer-postprocess: dan
[2023-07-21 10:19:54] [config] transformer-postprocess-emb: d
[2023-07-21 10:19:54] [config] transformer-postprocess-top: ""
[2023-07-21 10:19:54] [config] transformer-preprocess: ""
[2023-07-21 10:19:54] [config] transformer-tied-layers:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] transformer-train-position-embeddings: false
[2023-07-21 10:19:54] [config] tsv: false
[2023-07-21 10:19:54] [config] tsv-fields: 0
[2023-07-21 10:19:54] [config] type: amun
[2023-07-21 10:19:54] [config] ulr: false
[2023-07-21 10:19:54] [config] ulr-dim-emb: 0
[2023-07-21 10:19:54] [config] ulr-dropout: 0
[2023-07-21 10:19:54] [config] ulr-keys-vectors: ""
[2023-07-21 10:19:54] [config] ulr-query-vectors: ""
[2023-07-21 10:19:54] [config] ulr-softmax-temperature: 1
[2023-07-21 10:19:54] [config] ulr-trainable-transformation: false
[2023-07-21 10:19:54] [config] unlikelihood-loss: false
[2023-07-21 10:19:54] [config] valid-freq: 50000000
[2023-07-21 10:19:54] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 10:19:54] [config] valid-max-length: 1000
[2023-07-21 10:19:54] [config] valid-metrics:
[2023-07-21 10:19:54] [config]   - cross-entropy
[2023-07-21 10:19:54] [config]   - translation
[2023-07-21 10:19:54] [config] valid-mini-batch: 32
[2023-07-21 10:19:54] [config] valid-reset-stalled: false
[2023-07-21 10:19:54] [config] valid-script-args:
[2023-07-21 10:19:54] [config]   []
[2023-07-21 10:19:54] [config] valid-script-path: ""
[2023-07-21 10:19:54] [config] valid-sets:
[2023-07-21 10:19:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 10:19:54] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 10:19:54] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 10:19:54] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 10:19:54] [config] vocabs:
[2023-07-21 10:19:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 10:19:54] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 10:19:54] [config] word-penalty: 0
[2023-07-21 10:19:54] [config] word-scores: false
[2023-07-21 10:19:54] [config] workspace: 5500
[2023-07-21 10:19:54] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 10:19:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 10:19:54] [training] Using single-device training
[2023-07-21 10:19:54] Synced seed 1234
[2023-07-21 10:19:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 10:19:54] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 10:19:54] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 10:19:54] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 10:19:54] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 10:19:54] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 10:19:54] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 10:19:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 10:19:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 10:19:56] [comm] Using global sharding
[2023-07-21 10:19:56] [comm] NCCLCommunicators constructed successfully
[2023-07-21 10:19:56] [training] Using 1 GPUs
[2023-07-21 10:19:56] [logits] Applying loss function for 1 factor(s)
[2023-07-21 10:19:56] [memory] Reserving 80 MB, device gpu0
[2023-07-21 10:19:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 10:19:56] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:10:50] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 11:10:50] [valid] No post-processing script given for validating translator
[2023-07-21 11:10:50] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 11:10:50] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 11:10:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 11:10:50] [comm] Using global sharding
[2023-07-21 11:10:50] [comm] NCCLCommunicators constructed successfully
[2023-07-21 11:10:50] [training] Using 1 GPUs
[2023-07-21 11:10:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 11:10:56] Allocating memory for general optimizer shards
[2023-07-21 11:10:56] [memory] Reserving 322 MB, device gpu0
[2023-07-21 11:10:56] Loading Adam parameters
[2023-07-21 11:10:56] [memory] Reserving 322 MB, device gpu0
[2023-07-21 11:10:56] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:10:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 11:10:57] [data] Restoring the corpus state to epoch 141, batch 5427
[2023-07-21 11:10:57] [data] Shuffling data
[2023-07-21 11:10:57] [data] Done reading 20,192 sentences
[2023-07-21 11:10:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:10:57] Training started
[2023-07-21 11:10:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 11:10:57] [memory] Reserving 80 MB, device gpu0
[2023-07-21 11:11:04] Parameter type float16, optimization type float32, casting types true
[2023-07-21 11:15:55] Seen 20,192 samples
[2023-07-21 11:15:55] Starting data epoch 142 in logical epoch 142
[2023-07-21 11:15:55] [data] Shuffling data
[2023-07-21 11:15:55] [data] Done reading 20,192 sentences
[2023-07-21 11:15:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:20:46] Seen 20,192 samples
[2023-07-21 11:20:46] Starting data epoch 143 in logical epoch 143
[2023-07-21 11:20:46] [data] Shuffling data
[2023-07-21 11:20:46] [data] Done reading 20,192 sentences
[2023-07-21 11:20:47] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:25:42] Seen 20,192 samples
[2023-07-21 11:25:42] Starting data epoch 144 in logical epoch 144
[2023-07-21 11:25:42] [data] Shuffling data
[2023-07-21 11:25:42] [data] Done reading 20,192 sentences
[2023-07-21 11:25:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:30:25] Seen 20,192 samples
[2023-07-21 11:30:25] Starting data epoch 145 in logical epoch 145
[2023-07-21 11:30:25] [data] Shuffling data
[2023-07-21 11:30:25] [data] Done reading 20,192 sentences
[2023-07-21 11:30:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:35:28] Seen 20,192 samples
[2023-07-21 11:35:28] Starting data epoch 146 in logical epoch 146
[2023-07-21 11:35:28] [data] Shuffling data
[2023-07-21 11:35:28] [data] Done reading 20,192 sentences
[2023-07-21 11:35:28] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:40:24] Seen 20,192 samples
[2023-07-21 11:40:24] Starting data epoch 147 in logical epoch 147
[2023-07-21 11:40:24] [data] Shuffling data
[2023-07-21 11:40:24] [data] Done reading 20,192 sentences
[2023-07-21 11:40:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:45:21] Seen 20,192 samples
[2023-07-21 11:45:21] Starting data epoch 148 in logical epoch 148
[2023-07-21 11:45:21] [data] Shuffling data
[2023-07-21 11:45:21] [data] Done reading 20,192 sentences
[2023-07-21 11:45:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:50:24] Seen 20,192 samples
[2023-07-21 11:50:24] Starting data epoch 149 in logical epoch 149
[2023-07-21 11:50:24] [data] Shuffling data
[2023-07-21 11:50:24] [data] Done reading 20,192 sentences
[2023-07-21 11:50:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:54:55] Seen 20,192 samples
[2023-07-21 11:54:55] Starting data epoch 150 in logical epoch 150
[2023-07-21 11:54:55] [data] Shuffling data
[2023-07-21 11:54:55] [data] Done reading 20,192 sentences
[2023-07-21 11:54:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 11:59:45] Seen 20,192 samples
[2023-07-21 11:59:45] Starting data epoch 151 in logical epoch 151
[2023-07-21 11:59:45] Training finished
[2023-07-21 12:00:00] [valid] Ep. 151 : Up. 5814 : cross-entropy : 131.489 : stalled 1 times (last best: 130.991)
[2023-07-21 12:02:02] [valid] Ep. 151 : Up. 5814 : translation : 0 : new best
[2023-07-21 12:02:02] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 12:02:04] Saving Adam parameters
[2023-07-21 12:02:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 12:02:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 12:02:12] [marian] Running on node18.datos.cluster.uy as process 18309 with command line:
[2023-07-21 12:02:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 12:02:12] [config] after: 0e
[2023-07-21 12:02:12] [config] after-batches: 0
[2023-07-21 12:02:12] [config] after-epochs: 160
[2023-07-21 12:02:12] [config] all-caps-every: 0
[2023-07-21 12:02:12] [config] allow-unk: false
[2023-07-21 12:02:12] [config] authors: false
[2023-07-21 12:02:12] [config] beam-size: 12
[2023-07-21 12:02:12] [config] bert-class-symbol: "[CLS]"
[2023-07-21 12:02:12] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 12:02:12] [config] bert-masking-fraction: 0.15
[2023-07-21 12:02:12] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 12:02:12] [config] bert-train-type-embeddings: true
[2023-07-21 12:02:12] [config] bert-type-vocab-size: 2
[2023-07-21 12:02:12] [config] build-info: ""
[2023-07-21 12:02:12] [config] check-gradient-nan: false
[2023-07-21 12:02:12] [config] check-nan: false
[2023-07-21 12:02:12] [config] cite: false
[2023-07-21 12:02:12] [config] clip-norm: 1
[2023-07-21 12:02:12] [config] cost-scaling:
[2023-07-21 12:02:12] [config]   - 256.f
[2023-07-21 12:02:12] [config]   - 1000
[2023-07-21 12:02:12] [config]   - 2.f
[2023-07-21 12:02:12] [config]   - 256.f
[2023-07-21 12:02:12] [config] cost-type: ce-sum
[2023-07-21 12:02:12] [config] cpu-threads: 0
[2023-07-21 12:02:12] [config] data-threads: 8
[2023-07-21 12:02:12] [config] data-weighting: ""
[2023-07-21 12:02:12] [config] data-weighting-type: sentence
[2023-07-21 12:02:12] [config] dec-cell: gru
[2023-07-21 12:02:12] [config] dec-cell-base-depth: 2
[2023-07-21 12:02:12] [config] dec-cell-high-depth: 1
[2023-07-21 12:02:12] [config] dec-depth: 1
[2023-07-21 12:02:12] [config] devices:
[2023-07-21 12:02:12] [config]   - 0
[2023-07-21 12:02:12] [config] dim-emb: 512
[2023-07-21 12:02:12] [config] dim-rnn: 1024
[2023-07-21 12:02:12] [config] dim-vocabs:
[2023-07-21 12:02:12] [config]   - 16384
[2023-07-21 12:02:12] [config]   - 16384
[2023-07-21 12:02:12] [config] disp-first: 0
[2023-07-21 12:02:12] [config] disp-freq: 1000u
[2023-07-21 12:02:12] [config] disp-label-counts: true
[2023-07-21 12:02:12] [config] dropout-rnn: 0
[2023-07-21 12:02:12] [config] dropout-src: 0
[2023-07-21 12:02:12] [config] dropout-trg: 0
[2023-07-21 12:02:12] [config] dump-config: ""
[2023-07-21 12:02:12] [config] dynamic-gradient-scaling:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] early-stopping: 200
[2023-07-21 12:02:12] [config] early-stopping-on: first
[2023-07-21 12:02:12] [config] embedding-fix-src: false
[2023-07-21 12:02:12] [config] embedding-fix-trg: false
[2023-07-21 12:02:12] [config] embedding-normalization: false
[2023-07-21 12:02:12] [config] embedding-vectors:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] enc-cell: gru
[2023-07-21 12:02:12] [config] enc-cell-depth: 1
[2023-07-21 12:02:12] [config] enc-depth: 1
[2023-07-21 12:02:12] [config] enc-type: bidirectional
[2023-07-21 12:02:12] [config] english-title-case-every: 0
[2023-07-21 12:02:12] [config] exponential-smoothing: 0
[2023-07-21 12:02:12] [config] factor-weight: 1
[2023-07-21 12:02:12] [config] factors-combine: sum
[2023-07-21 12:02:12] [config] factors-dim-emb: 0
[2023-07-21 12:02:12] [config] gradient-checkpointing: false
[2023-07-21 12:02:12] [config] gradient-norm-average-window: 100
[2023-07-21 12:02:12] [config] guided-alignment: none
[2023-07-21 12:02:12] [config] guided-alignment-cost: mse
[2023-07-21 12:02:12] [config] guided-alignment-weight: 0.1
[2023-07-21 12:02:12] [config] ignore-model-config: false
[2023-07-21 12:02:12] [config] input-types:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] interpolate-env-vars: false
[2023-07-21 12:02:12] [config] keep-best: false
[2023-07-21 12:02:12] [config] label-smoothing: 0
[2023-07-21 12:02:12] [config] layer-normalization: false
[2023-07-21 12:02:12] [config] learn-rate: 0.0001
[2023-07-21 12:02:12] [config] lemma-dependency: ""
[2023-07-21 12:02:12] [config] lemma-dim-emb: 0
[2023-07-21 12:02:12] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 12:02:12] [config] log-level: info
[2023-07-21 12:02:12] [config] log-time-zone: ""
[2023-07-21 12:02:12] [config] logical-epoch:
[2023-07-21 12:02:12] [config]   - 1e
[2023-07-21 12:02:12] [config]   - 0
[2023-07-21 12:02:12] [config] lr-decay: 0
[2023-07-21 12:02:12] [config] lr-decay-freq: 50000
[2023-07-21 12:02:12] [config] lr-decay-inv-sqrt:
[2023-07-21 12:02:12] [config]   - 0
[2023-07-21 12:02:12] [config] lr-decay-repeat-warmup: false
[2023-07-21 12:02:12] [config] lr-decay-reset-optimizer: false
[2023-07-21 12:02:12] [config] lr-decay-start:
[2023-07-21 12:02:12] [config]   - 10
[2023-07-21 12:02:12] [config]   - 1
[2023-07-21 12:02:12] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 12:02:12] [config] lr-report: false
[2023-07-21 12:02:12] [config] lr-warmup: 0
[2023-07-21 12:02:12] [config] lr-warmup-at-reload: false
[2023-07-21 12:02:12] [config] lr-warmup-cycle: false
[2023-07-21 12:02:12] [config] lr-warmup-start-rate: 0
[2023-07-21 12:02:12] [config] max-length: 250
[2023-07-21 12:02:12] [config] max-length-crop: true
[2023-07-21 12:02:12] [config] max-length-factor: 3
[2023-07-21 12:02:12] [config] maxi-batch: 100
[2023-07-21 12:02:12] [config] maxi-batch-sort: trg
[2023-07-21 12:02:12] [config] mini-batch: 64
[2023-07-21 12:02:12] [config] mini-batch-fit: true
[2023-07-21 12:02:12] [config] mini-batch-fit-step: 10
[2023-07-21 12:02:12] [config] mini-batch-round-up: true
[2023-07-21 12:02:12] [config] mini-batch-track-lr: false
[2023-07-21 12:02:12] [config] mini-batch-warmup: 0
[2023-07-21 12:02:12] [config] mini-batch-words: 0
[2023-07-21 12:02:12] [config] mini-batch-words-ref: 0
[2023-07-21 12:02:12] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 12:02:12] [config] multi-loss-type: sum
[2023-07-21 12:02:12] [config] n-best: false
[2023-07-21 12:02:12] [config] no-nccl: false
[2023-07-21 12:02:12] [config] no-reload: false
[2023-07-21 12:02:12] [config] no-restore-corpus: false
[2023-07-21 12:02:12] [config] normalize: 0
[2023-07-21 12:02:12] [config] normalize-gradient: false
[2023-07-21 12:02:12] [config] num-devices: 0
[2023-07-21 12:02:12] [config] optimizer: adam
[2023-07-21 12:02:12] [config] optimizer-delay: 1
[2023-07-21 12:02:12] [config] optimizer-params:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] output-omit-bias: false
[2023-07-21 12:02:12] [config] overwrite: true
[2023-07-21 12:02:12] [config] precision:
[2023-07-21 12:02:12] [config]   - float16
[2023-07-21 12:02:12] [config]   - float32
[2023-07-21 12:02:12] [config] pretrained-model: ""
[2023-07-21 12:02:12] [config] quantize-biases: false
[2023-07-21 12:02:12] [config] quantize-bits: 0
[2023-07-21 12:02:12] [config] quantize-log-based: false
[2023-07-21 12:02:12] [config] quantize-optimization-steps: 0
[2023-07-21 12:02:12] [config] quiet: false
[2023-07-21 12:02:12] [config] quiet-translation: true
[2023-07-21 12:02:12] [config] relative-paths: false
[2023-07-21 12:02:12] [config] right-left: false
[2023-07-21 12:02:12] [config] save-freq: 10000u
[2023-07-21 12:02:12] [config] seed: 1234
[2023-07-21 12:02:12] [config] sentencepiece-alphas:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] sentencepiece-max-lines: 2000000
[2023-07-21 12:02:12] [config] sentencepiece-options: ""
[2023-07-21 12:02:12] [config] sharding: global
[2023-07-21 12:02:12] [config] shuffle: data
[2023-07-21 12:02:12] [config] shuffle-in-ram: false
[2023-07-21 12:02:12] [config] sigterm: save-and-exit
[2023-07-21 12:02:12] [config] skip: false
[2023-07-21 12:02:12] [config] sqlite: ""
[2023-07-21 12:02:12] [config] sqlite-drop: false
[2023-07-21 12:02:12] [config] sync-freq: 200u
[2023-07-21 12:02:12] [config] sync-sgd: false
[2023-07-21 12:02:12] [config] tempdir: /tmp
[2023-07-21 12:02:12] [config] tied-embeddings: false
[2023-07-21 12:02:12] [config] tied-embeddings-all: true
[2023-07-21 12:02:12] [config] tied-embeddings-src: false
[2023-07-21 12:02:12] [config] train-embedder-rank:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] train-sets:
[2023-07-21 12:02:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 12:02:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 12:02:12] [config] transformer-aan-activation: swish
[2023-07-21 12:02:12] [config] transformer-aan-depth: 2
[2023-07-21 12:02:12] [config] transformer-aan-nogate: false
[2023-07-21 12:02:12] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 12:02:12] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 12:02:12] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 12:02:12] [config] transformer-depth-scaling: false
[2023-07-21 12:02:12] [config] transformer-dim-aan: 2048
[2023-07-21 12:02:12] [config] transformer-dim-ffn: 2048
[2023-07-21 12:02:12] [config] transformer-dropout: 0
[2023-07-21 12:02:12] [config] transformer-dropout-attention: 0
[2023-07-21 12:02:12] [config] transformer-dropout-ffn: 0
[2023-07-21 12:02:12] [config] transformer-ffn-activation: swish
[2023-07-21 12:02:12] [config] transformer-ffn-depth: 2
[2023-07-21 12:02:12] [config] transformer-guided-alignment-layer: last
[2023-07-21 12:02:12] [config] transformer-heads: 8
[2023-07-21 12:02:12] [config] transformer-no-projection: false
[2023-07-21 12:02:12] [config] transformer-pool: false
[2023-07-21 12:02:12] [config] transformer-postprocess: dan
[2023-07-21 12:02:12] [config] transformer-postprocess-emb: d
[2023-07-21 12:02:12] [config] transformer-postprocess-top: ""
[2023-07-21 12:02:12] [config] transformer-preprocess: ""
[2023-07-21 12:02:12] [config] transformer-tied-layers:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] transformer-train-position-embeddings: false
[2023-07-21 12:02:12] [config] tsv: false
[2023-07-21 12:02:12] [config] tsv-fields: 0
[2023-07-21 12:02:12] [config] type: amun
[2023-07-21 12:02:12] [config] ulr: false
[2023-07-21 12:02:12] [config] ulr-dim-emb: 0
[2023-07-21 12:02:12] [config] ulr-dropout: 0
[2023-07-21 12:02:12] [config] ulr-keys-vectors: ""
[2023-07-21 12:02:12] [config] ulr-query-vectors: ""
[2023-07-21 12:02:12] [config] ulr-softmax-temperature: 1
[2023-07-21 12:02:12] [config] ulr-trainable-transformation: false
[2023-07-21 12:02:12] [config] unlikelihood-loss: false
[2023-07-21 12:02:12] [config] valid-freq: 50000000
[2023-07-21 12:02:12] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 12:02:12] [config] valid-max-length: 1000
[2023-07-21 12:02:12] [config] valid-metrics:
[2023-07-21 12:02:12] [config]   - cross-entropy
[2023-07-21 12:02:12] [config]   - translation
[2023-07-21 12:02:12] [config] valid-mini-batch: 32
[2023-07-21 12:02:12] [config] valid-reset-stalled: false
[2023-07-21 12:02:12] [config] valid-script-args:
[2023-07-21 12:02:12] [config]   []
[2023-07-21 12:02:12] [config] valid-script-path: ""
[2023-07-21 12:02:12] [config] valid-sets:
[2023-07-21 12:02:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 12:02:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 12:02:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 12:02:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 12:02:12] [config] vocabs:
[2023-07-21 12:02:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 12:02:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 12:02:12] [config] word-penalty: 0
[2023-07-21 12:02:12] [config] word-scores: false
[2023-07-21 12:02:12] [config] workspace: 5500
[2023-07-21 12:02:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 12:02:12] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 12:02:12] [training] Using single-device training
[2023-07-21 12:02:14] Synced seed 1234
[2023-07-21 12:02:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 12:02:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 12:02:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 12:02:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 12:02:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 12:02:14] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 12:02:14] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 12:02:15] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 12:02:16] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 12:02:16] [comm] Using global sharding
[2023-07-21 12:02:16] [comm] NCCLCommunicators constructed successfully
[2023-07-21 12:02:16] [training] Using 1 GPUs
[2023-07-21 12:02:16] [logits] Applying loss function for 1 factor(s)
[2023-07-21 12:02:16] [memory] Reserving 80 MB, device gpu0
[2023-07-21 12:02:16] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 12:02:16] [memory] Reserving 80 MB, device gpu0
[2023-07-21 12:52:39] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 12:52:40] [valid] No post-processing script given for validating translator
[2023-07-21 12:52:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 12:52:40] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 12:52:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 12:52:40] [comm] Using global sharding
[2023-07-21 12:52:40] [comm] NCCLCommunicators constructed successfully
[2023-07-21 12:52:40] [training] Using 1 GPUs
[2023-07-21 12:52:40] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 12:52:52] Allocating memory for general optimizer shards
[2023-07-21 12:52:52] [memory] Reserving 322 MB, device gpu0
[2023-07-21 12:52:52] Loading Adam parameters
[2023-07-21 12:52:53] [memory] Reserving 322 MB, device gpu0
[2023-07-21 12:52:53] [memory] Reserving 80 MB, device gpu0
[2023-07-21 12:52:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 12:52:53] [data] Restoring the corpus state to epoch 151, batch 5814
[2023-07-21 12:52:53] [data] Shuffling data
[2023-07-21 12:52:53] [data] Done reading 20,192 sentences
[2023-07-21 12:52:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 12:52:53] Training started
[2023-07-21 12:52:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 12:52:53] [memory] Reserving 80 MB, device gpu0
[2023-07-21 12:52:57] Parameter type float16, optimization type float32, casting types true
[2023-07-21 12:57:17] Seen 20,192 samples
[2023-07-21 12:57:17] Starting data epoch 152 in logical epoch 152
[2023-07-21 12:57:17] [data] Shuffling data
[2023-07-21 12:57:17] [data] Done reading 20,192 sentences
[2023-07-21 12:57:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:02:10] Seen 20,192 samples
[2023-07-21 13:02:10] Starting data epoch 153 in logical epoch 153
[2023-07-21 13:02:10] [data] Shuffling data
[2023-07-21 13:02:10] [data] Done reading 20,192 sentences
[2023-07-21 13:02:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:07:08] Seen 20,192 samples
[2023-07-21 13:07:08] Starting data epoch 154 in logical epoch 154
[2023-07-21 13:07:08] [data] Shuffling data
[2023-07-21 13:07:08] [data] Done reading 20,192 sentences
[2023-07-21 13:07:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:12:06] Seen 20,192 samples
[2023-07-21 13:12:06] Starting data epoch 155 in logical epoch 155
[2023-07-21 13:12:06] [data] Shuffling data
[2023-07-21 13:12:06] [data] Done reading 20,192 sentences
[2023-07-21 13:12:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:15:51] Ep. 155 : Up. 6000 : Sen. 16,387 : Cost 3.19166327 * 16,006,629 @ 13,725 after 96,019,089 : Time 1391.82s : 11500.48 words/s : gNorm 1.3588
[2023-07-21 13:17:02] Seen 20,192 samples
[2023-07-21 13:17:02] Starting data epoch 156 in logical epoch 156
[2023-07-21 13:17:02] [data] Shuffling data
[2023-07-21 13:17:02] [data] Done reading 20,192 sentences
[2023-07-21 13:17:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:21:43] Seen 20,192 samples
[2023-07-21 13:21:43] Starting data epoch 157 in logical epoch 157
[2023-07-21 13:21:43] [data] Shuffling data
[2023-07-21 13:21:43] [data] Done reading 20,192 sentences
[2023-07-21 13:21:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:26:39] Seen 20,192 samples
[2023-07-21 13:26:39] Starting data epoch 158 in logical epoch 158
[2023-07-21 13:26:39] [data] Shuffling data
[2023-07-21 13:26:39] [data] Done reading 20,192 sentences
[2023-07-21 13:26:39] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:31:32] Seen 20,192 samples
[2023-07-21 13:31:32] Starting data epoch 159 in logical epoch 159
[2023-07-21 13:31:32] [data] Shuffling data
[2023-07-21 13:31:32] [data] Done reading 20,192 sentences
[2023-07-21 13:31:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:36:12] Seen 20,192 samples
[2023-07-21 13:36:12] Starting data epoch 160 in logical epoch 160
[2023-07-21 13:36:12] [data] Shuffling data
[2023-07-21 13:36:12] [data] Done reading 20,192 sentences
[2023-07-21 13:36:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 13:41:07] Seen 20,192 samples
[2023-07-21 13:41:07] Starting data epoch 161 in logical epoch 161
[2023-07-21 13:41:07] Training finished
[2023-07-21 13:41:19] [valid] Ep. 161 : Up. 6200 : cross-entropy : 131.772 : stalled 2 times (last best: 130.991)
[2023-07-21 13:43:30] [valid] Ep. 161 : Up. 6200 : translation : 0 : new best
[2023-07-21 13:43:30] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 13:43:32] Saving Adam parameters
[2023-07-21 13:43:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 13:43:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 13:43:40] [marian] Running on node18.datos.cluster.uy as process 24723 with command line:
[2023-07-21 13:43:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 13:43:40] [config] after: 0e
[2023-07-21 13:43:40] [config] after-batches: 0
[2023-07-21 13:43:40] [config] after-epochs: 170
[2023-07-21 13:43:40] [config] all-caps-every: 0
[2023-07-21 13:43:40] [config] allow-unk: false
[2023-07-21 13:43:40] [config] authors: false
[2023-07-21 13:43:40] [config] beam-size: 12
[2023-07-21 13:43:40] [config] bert-class-symbol: "[CLS]"
[2023-07-21 13:43:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 13:43:40] [config] bert-masking-fraction: 0.15
[2023-07-21 13:43:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 13:43:40] [config] bert-train-type-embeddings: true
[2023-07-21 13:43:40] [config] bert-type-vocab-size: 2
[2023-07-21 13:43:40] [config] build-info: ""
[2023-07-21 13:43:40] [config] check-gradient-nan: false
[2023-07-21 13:43:40] [config] check-nan: false
[2023-07-21 13:43:40] [config] cite: false
[2023-07-21 13:43:40] [config] clip-norm: 1
[2023-07-21 13:43:40] [config] cost-scaling:
[2023-07-21 13:43:40] [config]   - 256.f
[2023-07-21 13:43:40] [config]   - 1000
[2023-07-21 13:43:40] [config]   - 2.f
[2023-07-21 13:43:40] [config]   - 256.f
[2023-07-21 13:43:40] [config] cost-type: ce-sum
[2023-07-21 13:43:40] [config] cpu-threads: 0
[2023-07-21 13:43:40] [config] data-threads: 8
[2023-07-21 13:43:40] [config] data-weighting: ""
[2023-07-21 13:43:40] [config] data-weighting-type: sentence
[2023-07-21 13:43:40] [config] dec-cell: gru
[2023-07-21 13:43:40] [config] dec-cell-base-depth: 2
[2023-07-21 13:43:40] [config] dec-cell-high-depth: 1
[2023-07-21 13:43:40] [config] dec-depth: 1
[2023-07-21 13:43:40] [config] devices:
[2023-07-21 13:43:40] [config]   - 0
[2023-07-21 13:43:40] [config] dim-emb: 512
[2023-07-21 13:43:40] [config] dim-rnn: 1024
[2023-07-21 13:43:40] [config] dim-vocabs:
[2023-07-21 13:43:40] [config]   - 16384
[2023-07-21 13:43:40] [config]   - 16384
[2023-07-21 13:43:40] [config] disp-first: 0
[2023-07-21 13:43:40] [config] disp-freq: 1000u
[2023-07-21 13:43:40] [config] disp-label-counts: true
[2023-07-21 13:43:40] [config] dropout-rnn: 0
[2023-07-21 13:43:40] [config] dropout-src: 0
[2023-07-21 13:43:40] [config] dropout-trg: 0
[2023-07-21 13:43:40] [config] dump-config: ""
[2023-07-21 13:43:40] [config] dynamic-gradient-scaling:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] early-stopping: 200
[2023-07-21 13:43:40] [config] early-stopping-on: first
[2023-07-21 13:43:40] [config] embedding-fix-src: false
[2023-07-21 13:43:40] [config] embedding-fix-trg: false
[2023-07-21 13:43:40] [config] embedding-normalization: false
[2023-07-21 13:43:40] [config] embedding-vectors:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] enc-cell: gru
[2023-07-21 13:43:40] [config] enc-cell-depth: 1
[2023-07-21 13:43:40] [config] enc-depth: 1
[2023-07-21 13:43:40] [config] enc-type: bidirectional
[2023-07-21 13:43:40] [config] english-title-case-every: 0
[2023-07-21 13:43:40] [config] exponential-smoothing: 0
[2023-07-21 13:43:40] [config] factor-weight: 1
[2023-07-21 13:43:40] [config] factors-combine: sum
[2023-07-21 13:43:40] [config] factors-dim-emb: 0
[2023-07-21 13:43:40] [config] gradient-checkpointing: false
[2023-07-21 13:43:40] [config] gradient-norm-average-window: 100
[2023-07-21 13:43:40] [config] guided-alignment: none
[2023-07-21 13:43:40] [config] guided-alignment-cost: mse
[2023-07-21 13:43:40] [config] guided-alignment-weight: 0.1
[2023-07-21 13:43:40] [config] ignore-model-config: false
[2023-07-21 13:43:40] [config] input-types:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] interpolate-env-vars: false
[2023-07-21 13:43:40] [config] keep-best: false
[2023-07-21 13:43:40] [config] label-smoothing: 0
[2023-07-21 13:43:40] [config] layer-normalization: false
[2023-07-21 13:43:40] [config] learn-rate: 0.0001
[2023-07-21 13:43:40] [config] lemma-dependency: ""
[2023-07-21 13:43:40] [config] lemma-dim-emb: 0
[2023-07-21 13:43:40] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 13:43:40] [config] log-level: info
[2023-07-21 13:43:40] [config] log-time-zone: ""
[2023-07-21 13:43:40] [config] logical-epoch:
[2023-07-21 13:43:40] [config]   - 1e
[2023-07-21 13:43:40] [config]   - 0
[2023-07-21 13:43:40] [config] lr-decay: 0
[2023-07-21 13:43:40] [config] lr-decay-freq: 50000
[2023-07-21 13:43:40] [config] lr-decay-inv-sqrt:
[2023-07-21 13:43:40] [config]   - 0
[2023-07-21 13:43:40] [config] lr-decay-repeat-warmup: false
[2023-07-21 13:43:40] [config] lr-decay-reset-optimizer: false
[2023-07-21 13:43:40] [config] lr-decay-start:
[2023-07-21 13:43:40] [config]   - 10
[2023-07-21 13:43:40] [config]   - 1
[2023-07-21 13:43:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 13:43:40] [config] lr-report: false
[2023-07-21 13:43:40] [config] lr-warmup: 0
[2023-07-21 13:43:40] [config] lr-warmup-at-reload: false
[2023-07-21 13:43:40] [config] lr-warmup-cycle: false
[2023-07-21 13:43:40] [config] lr-warmup-start-rate: 0
[2023-07-21 13:43:40] [config] max-length: 250
[2023-07-21 13:43:40] [config] max-length-crop: true
[2023-07-21 13:43:40] [config] max-length-factor: 3
[2023-07-21 13:43:40] [config] maxi-batch: 100
[2023-07-21 13:43:40] [config] maxi-batch-sort: trg
[2023-07-21 13:43:40] [config] mini-batch: 64
[2023-07-21 13:43:40] [config] mini-batch-fit: true
[2023-07-21 13:43:40] [config] mini-batch-fit-step: 10
[2023-07-21 13:43:40] [config] mini-batch-round-up: true
[2023-07-21 13:43:40] [config] mini-batch-track-lr: false
[2023-07-21 13:43:40] [config] mini-batch-warmup: 0
[2023-07-21 13:43:40] [config] mini-batch-words: 0
[2023-07-21 13:43:40] [config] mini-batch-words-ref: 0
[2023-07-21 13:43:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 13:43:40] [config] multi-loss-type: sum
[2023-07-21 13:43:40] [config] n-best: false
[2023-07-21 13:43:40] [config] no-nccl: false
[2023-07-21 13:43:40] [config] no-reload: false
[2023-07-21 13:43:40] [config] no-restore-corpus: false
[2023-07-21 13:43:40] [config] normalize: 0
[2023-07-21 13:43:40] [config] normalize-gradient: false
[2023-07-21 13:43:40] [config] num-devices: 0
[2023-07-21 13:43:40] [config] optimizer: adam
[2023-07-21 13:43:40] [config] optimizer-delay: 1
[2023-07-21 13:43:40] [config] optimizer-params:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] output-omit-bias: false
[2023-07-21 13:43:40] [config] overwrite: true
[2023-07-21 13:43:40] [config] precision:
[2023-07-21 13:43:40] [config]   - float16
[2023-07-21 13:43:40] [config]   - float32
[2023-07-21 13:43:40] [config] pretrained-model: ""
[2023-07-21 13:43:40] [config] quantize-biases: false
[2023-07-21 13:43:40] [config] quantize-bits: 0
[2023-07-21 13:43:40] [config] quantize-log-based: false
[2023-07-21 13:43:40] [config] quantize-optimization-steps: 0
[2023-07-21 13:43:40] [config] quiet: false
[2023-07-21 13:43:40] [config] quiet-translation: true
[2023-07-21 13:43:40] [config] relative-paths: false
[2023-07-21 13:43:40] [config] right-left: false
[2023-07-21 13:43:40] [config] save-freq: 10000u
[2023-07-21 13:43:40] [config] seed: 1234
[2023-07-21 13:43:40] [config] sentencepiece-alphas:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] sentencepiece-max-lines: 2000000
[2023-07-21 13:43:40] [config] sentencepiece-options: ""
[2023-07-21 13:43:40] [config] sharding: global
[2023-07-21 13:43:40] [config] shuffle: data
[2023-07-21 13:43:40] [config] shuffle-in-ram: false
[2023-07-21 13:43:40] [config] sigterm: save-and-exit
[2023-07-21 13:43:40] [config] skip: false
[2023-07-21 13:43:40] [config] sqlite: ""
[2023-07-21 13:43:40] [config] sqlite-drop: false
[2023-07-21 13:43:40] [config] sync-freq: 200u
[2023-07-21 13:43:40] [config] sync-sgd: false
[2023-07-21 13:43:40] [config] tempdir: /tmp
[2023-07-21 13:43:40] [config] tied-embeddings: false
[2023-07-21 13:43:40] [config] tied-embeddings-all: true
[2023-07-21 13:43:40] [config] tied-embeddings-src: false
[2023-07-21 13:43:40] [config] train-embedder-rank:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] train-sets:
[2023-07-21 13:43:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 13:43:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 13:43:40] [config] transformer-aan-activation: swish
[2023-07-21 13:43:40] [config] transformer-aan-depth: 2
[2023-07-21 13:43:40] [config] transformer-aan-nogate: false
[2023-07-21 13:43:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 13:43:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 13:43:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 13:43:40] [config] transformer-depth-scaling: false
[2023-07-21 13:43:40] [config] transformer-dim-aan: 2048
[2023-07-21 13:43:40] [config] transformer-dim-ffn: 2048
[2023-07-21 13:43:40] [config] transformer-dropout: 0
[2023-07-21 13:43:40] [config] transformer-dropout-attention: 0
[2023-07-21 13:43:40] [config] transformer-dropout-ffn: 0
[2023-07-21 13:43:40] [config] transformer-ffn-activation: swish
[2023-07-21 13:43:40] [config] transformer-ffn-depth: 2
[2023-07-21 13:43:40] [config] transformer-guided-alignment-layer: last
[2023-07-21 13:43:40] [config] transformer-heads: 8
[2023-07-21 13:43:40] [config] transformer-no-projection: false
[2023-07-21 13:43:40] [config] transformer-pool: false
[2023-07-21 13:43:40] [config] transformer-postprocess: dan
[2023-07-21 13:43:40] [config] transformer-postprocess-emb: d
[2023-07-21 13:43:40] [config] transformer-postprocess-top: ""
[2023-07-21 13:43:40] [config] transformer-preprocess: ""
[2023-07-21 13:43:40] [config] transformer-tied-layers:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] transformer-train-position-embeddings: false
[2023-07-21 13:43:40] [config] tsv: false
[2023-07-21 13:43:40] [config] tsv-fields: 0
[2023-07-21 13:43:40] [config] type: amun
[2023-07-21 13:43:40] [config] ulr: false
[2023-07-21 13:43:40] [config] ulr-dim-emb: 0
[2023-07-21 13:43:40] [config] ulr-dropout: 0
[2023-07-21 13:43:40] [config] ulr-keys-vectors: ""
[2023-07-21 13:43:40] [config] ulr-query-vectors: ""
[2023-07-21 13:43:40] [config] ulr-softmax-temperature: 1
[2023-07-21 13:43:40] [config] ulr-trainable-transformation: false
[2023-07-21 13:43:40] [config] unlikelihood-loss: false
[2023-07-21 13:43:40] [config] valid-freq: 50000000
[2023-07-21 13:43:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 13:43:40] [config] valid-max-length: 1000
[2023-07-21 13:43:40] [config] valid-metrics:
[2023-07-21 13:43:40] [config]   - cross-entropy
[2023-07-21 13:43:40] [config]   - translation
[2023-07-21 13:43:40] [config] valid-mini-batch: 32
[2023-07-21 13:43:40] [config] valid-reset-stalled: false
[2023-07-21 13:43:40] [config] valid-script-args:
[2023-07-21 13:43:40] [config]   []
[2023-07-21 13:43:40] [config] valid-script-path: ""
[2023-07-21 13:43:40] [config] valid-sets:
[2023-07-21 13:43:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 13:43:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 13:43:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 13:43:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 13:43:40] [config] vocabs:
[2023-07-21 13:43:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 13:43:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 13:43:40] [config] word-penalty: 0
[2023-07-21 13:43:40] [config] word-scores: false
[2023-07-21 13:43:40] [config] workspace: 5500
[2023-07-21 13:43:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 13:43:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 13:43:40] [training] Using single-device training
[2023-07-21 13:43:40] Synced seed 1234
[2023-07-21 13:43:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 13:43:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 13:43:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 13:43:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 13:43:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 13:43:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 13:43:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 13:43:41] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 13:43:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 13:43:42] [comm] Using global sharding
[2023-07-21 13:43:42] [comm] NCCLCommunicators constructed successfully
[2023-07-21 13:43:42] [training] Using 1 GPUs
[2023-07-21 13:43:42] [logits] Applying loss function for 1 factor(s)
[2023-07-21 13:43:42] [memory] Reserving 80 MB, device gpu0
[2023-07-21 13:43:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 13:43:42] [memory] Reserving 80 MB, device gpu0
[2023-07-21 14:34:37] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 14:34:37] [valid] No post-processing script given for validating translator
[2023-07-21 14:34:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 14:34:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 14:34:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 14:34:37] [comm] Using global sharding
[2023-07-21 14:34:37] [comm] NCCLCommunicators constructed successfully
[2023-07-21 14:34:37] [training] Using 1 GPUs
[2023-07-21 14:34:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 14:34:44] Allocating memory for general optimizer shards
[2023-07-21 14:34:44] [memory] Reserving 322 MB, device gpu0
[2023-07-21 14:34:44] Loading Adam parameters
[2023-07-21 14:34:44] [memory] Reserving 322 MB, device gpu0
[2023-07-21 14:34:44] [memory] Reserving 80 MB, device gpu0
[2023-07-21 14:34:45] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 14:34:45] [data] Restoring the corpus state to epoch 161, batch 6200
[2023-07-21 14:34:45] [data] Shuffling data
[2023-07-21 14:34:45] [data] Done reading 20,192 sentences
[2023-07-21 14:34:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:34:45] Training started
[2023-07-21 14:34:45] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 14:34:45] [memory] Reserving 80 MB, device gpu0
[2023-07-21 14:34:49] Parameter type float16, optimization type float32, casting types true
[2023-07-21 14:39:23] Seen 20,192 samples
[2023-07-21 14:39:23] Starting data epoch 162 in logical epoch 162
[2023-07-21 14:39:23] [data] Shuffling data
[2023-07-21 14:39:23] [data] Done reading 20,192 sentences
[2023-07-21 14:39:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:44:23] Seen 20,192 samples
[2023-07-21 14:44:23] Starting data epoch 163 in logical epoch 163
[2023-07-21 14:44:23] [data] Shuffling data
[2023-07-21 14:44:23] [data] Done reading 20,192 sentences
[2023-07-21 14:44:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:49:21] Seen 20,192 samples
[2023-07-21 14:49:21] Starting data epoch 164 in logical epoch 164
[2023-07-21 14:49:21] [data] Shuffling data
[2023-07-21 14:49:21] [data] Done reading 20,192 sentences
[2023-07-21 14:49:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:53:54] Seen 20,192 samples
[2023-07-21 14:53:54] Starting data epoch 165 in logical epoch 165
[2023-07-21 14:53:54] [data] Shuffling data
[2023-07-21 14:53:54] [data] Done reading 20,192 sentences
[2023-07-21 14:53:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 14:58:41] Seen 20,192 samples
[2023-07-21 14:58:41] Starting data epoch 166 in logical epoch 166
[2023-07-21 14:58:41] [data] Shuffling data
[2023-07-21 14:58:41] [data] Done reading 20,192 sentences
[2023-07-21 14:58:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:03:34] Seen 20,192 samples
[2023-07-21 15:03:34] Starting data epoch 167 in logical epoch 167
[2023-07-21 15:03:34] [data] Shuffling data
[2023-07-21 15:03:34] [data] Done reading 20,192 sentences
[2023-07-21 15:03:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:08:29] Seen 20,192 samples
[2023-07-21 15:08:29] Starting data epoch 168 in logical epoch 168
[2023-07-21 15:08:29] [data] Shuffling data
[2023-07-21 15:08:29] [data] Done reading 20,192 sentences
[2023-07-21 15:08:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:13:26] Seen 20,192 samples
[2023-07-21 15:13:26] Starting data epoch 169 in logical epoch 169
[2023-07-21 15:13:26] [data] Shuffling data
[2023-07-21 15:13:26] [data] Done reading 20,192 sentences
[2023-07-21 15:13:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:18:10] Seen 20,192 samples
[2023-07-21 15:18:10] Starting data epoch 170 in logical epoch 170
[2023-07-21 15:18:10] [data] Shuffling data
[2023-07-21 15:18:10] [data] Done reading 20,192 sentences
[2023-07-21 15:18:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 15:23:09] Seen 20,192 samples
[2023-07-21 15:23:09] Starting data epoch 171 in logical epoch 171
[2023-07-21 15:23:09] Training finished
[2023-07-21 15:23:27] [valid] Ep. 171 : Up. 6587 : cross-entropy : 132.159 : stalled 3 times (last best: 130.991)
[2023-07-21 15:25:57] [valid] Ep. 171 : Up. 6587 : translation : 0 : new best
[2023-07-21 15:25:57] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 15:26:00] Saving Adam parameters
[2023-07-21 15:26:01] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 15:26:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 15:26:08] [marian] Running on node18.datos.cluster.uy as process 31541 with command line:
[2023-07-21 15:26:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 15:26:08] [config] after: 0e
[2023-07-21 15:26:08] [config] after-batches: 0
[2023-07-21 15:26:08] [config] after-epochs: 180
[2023-07-21 15:26:08] [config] all-caps-every: 0
[2023-07-21 15:26:08] [config] allow-unk: false
[2023-07-21 15:26:08] [config] authors: false
[2023-07-21 15:26:08] [config] beam-size: 12
[2023-07-21 15:26:08] [config] bert-class-symbol: "[CLS]"
[2023-07-21 15:26:08] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 15:26:08] [config] bert-masking-fraction: 0.15
[2023-07-21 15:26:08] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 15:26:08] [config] bert-train-type-embeddings: true
[2023-07-21 15:26:08] [config] bert-type-vocab-size: 2
[2023-07-21 15:26:08] [config] build-info: ""
[2023-07-21 15:26:08] [config] check-gradient-nan: false
[2023-07-21 15:26:08] [config] check-nan: false
[2023-07-21 15:26:08] [config] cite: false
[2023-07-21 15:26:08] [config] clip-norm: 1
[2023-07-21 15:26:08] [config] cost-scaling:
[2023-07-21 15:26:08] [config]   - 256.f
[2023-07-21 15:26:08] [config]   - 1000
[2023-07-21 15:26:08] [config]   - 2.f
[2023-07-21 15:26:08] [config]   - 256.f
[2023-07-21 15:26:08] [config] cost-type: ce-sum
[2023-07-21 15:26:08] [config] cpu-threads: 0
[2023-07-21 15:26:08] [config] data-threads: 8
[2023-07-21 15:26:08] [config] data-weighting: ""
[2023-07-21 15:26:08] [config] data-weighting-type: sentence
[2023-07-21 15:26:08] [config] dec-cell: gru
[2023-07-21 15:26:08] [config] dec-cell-base-depth: 2
[2023-07-21 15:26:08] [config] dec-cell-high-depth: 1
[2023-07-21 15:26:08] [config] dec-depth: 1
[2023-07-21 15:26:08] [config] devices:
[2023-07-21 15:26:08] [config]   - 0
[2023-07-21 15:26:08] [config] dim-emb: 512
[2023-07-21 15:26:08] [config] dim-rnn: 1024
[2023-07-21 15:26:08] [config] dim-vocabs:
[2023-07-21 15:26:08] [config]   - 16384
[2023-07-21 15:26:08] [config]   - 16384
[2023-07-21 15:26:08] [config] disp-first: 0
[2023-07-21 15:26:08] [config] disp-freq: 1000u
[2023-07-21 15:26:08] [config] disp-label-counts: true
[2023-07-21 15:26:08] [config] dropout-rnn: 0
[2023-07-21 15:26:08] [config] dropout-src: 0
[2023-07-21 15:26:08] [config] dropout-trg: 0
[2023-07-21 15:26:08] [config] dump-config: ""
[2023-07-21 15:26:08] [config] dynamic-gradient-scaling:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] early-stopping: 200
[2023-07-21 15:26:08] [config] early-stopping-on: first
[2023-07-21 15:26:08] [config] embedding-fix-src: false
[2023-07-21 15:26:08] [config] embedding-fix-trg: false
[2023-07-21 15:26:08] [config] embedding-normalization: false
[2023-07-21 15:26:08] [config] embedding-vectors:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] enc-cell: gru
[2023-07-21 15:26:08] [config] enc-cell-depth: 1
[2023-07-21 15:26:08] [config] enc-depth: 1
[2023-07-21 15:26:08] [config] enc-type: bidirectional
[2023-07-21 15:26:08] [config] english-title-case-every: 0
[2023-07-21 15:26:08] [config] exponential-smoothing: 0
[2023-07-21 15:26:08] [config] factor-weight: 1
[2023-07-21 15:26:08] [config] factors-combine: sum
[2023-07-21 15:26:08] [config] factors-dim-emb: 0
[2023-07-21 15:26:08] [config] gradient-checkpointing: false
[2023-07-21 15:26:08] [config] gradient-norm-average-window: 100
[2023-07-21 15:26:08] [config] guided-alignment: none
[2023-07-21 15:26:08] [config] guided-alignment-cost: mse
[2023-07-21 15:26:08] [config] guided-alignment-weight: 0.1
[2023-07-21 15:26:08] [config] ignore-model-config: false
[2023-07-21 15:26:08] [config] input-types:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] interpolate-env-vars: false
[2023-07-21 15:26:08] [config] keep-best: false
[2023-07-21 15:26:08] [config] label-smoothing: 0
[2023-07-21 15:26:08] [config] layer-normalization: false
[2023-07-21 15:26:08] [config] learn-rate: 0.0001
[2023-07-21 15:26:08] [config] lemma-dependency: ""
[2023-07-21 15:26:08] [config] lemma-dim-emb: 0
[2023-07-21 15:26:08] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 15:26:08] [config] log-level: info
[2023-07-21 15:26:08] [config] log-time-zone: ""
[2023-07-21 15:26:08] [config] logical-epoch:
[2023-07-21 15:26:08] [config]   - 1e
[2023-07-21 15:26:08] [config]   - 0
[2023-07-21 15:26:08] [config] lr-decay: 0
[2023-07-21 15:26:08] [config] lr-decay-freq: 50000
[2023-07-21 15:26:08] [config] lr-decay-inv-sqrt:
[2023-07-21 15:26:08] [config]   - 0
[2023-07-21 15:26:08] [config] lr-decay-repeat-warmup: false
[2023-07-21 15:26:08] [config] lr-decay-reset-optimizer: false
[2023-07-21 15:26:08] [config] lr-decay-start:
[2023-07-21 15:26:08] [config]   - 10
[2023-07-21 15:26:08] [config]   - 1
[2023-07-21 15:26:08] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 15:26:08] [config] lr-report: false
[2023-07-21 15:26:08] [config] lr-warmup: 0
[2023-07-21 15:26:08] [config] lr-warmup-at-reload: false
[2023-07-21 15:26:08] [config] lr-warmup-cycle: false
[2023-07-21 15:26:08] [config] lr-warmup-start-rate: 0
[2023-07-21 15:26:08] [config] max-length: 250
[2023-07-21 15:26:08] [config] max-length-crop: true
[2023-07-21 15:26:08] [config] max-length-factor: 3
[2023-07-21 15:26:08] [config] maxi-batch: 100
[2023-07-21 15:26:08] [config] maxi-batch-sort: trg
[2023-07-21 15:26:08] [config] mini-batch: 64
[2023-07-21 15:26:08] [config] mini-batch-fit: true
[2023-07-21 15:26:08] [config] mini-batch-fit-step: 10
[2023-07-21 15:26:08] [config] mini-batch-round-up: true
[2023-07-21 15:26:08] [config] mini-batch-track-lr: false
[2023-07-21 15:26:08] [config] mini-batch-warmup: 0
[2023-07-21 15:26:08] [config] mini-batch-words: 0
[2023-07-21 15:26:08] [config] mini-batch-words-ref: 0
[2023-07-21 15:26:08] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 15:26:08] [config] multi-loss-type: sum
[2023-07-21 15:26:08] [config] n-best: false
[2023-07-21 15:26:08] [config] no-nccl: false
[2023-07-21 15:26:08] [config] no-reload: false
[2023-07-21 15:26:08] [config] no-restore-corpus: false
[2023-07-21 15:26:08] [config] normalize: 0
[2023-07-21 15:26:08] [config] normalize-gradient: false
[2023-07-21 15:26:08] [config] num-devices: 0
[2023-07-21 15:26:08] [config] optimizer: adam
[2023-07-21 15:26:08] [config] optimizer-delay: 1
[2023-07-21 15:26:08] [config] optimizer-params:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] output-omit-bias: false
[2023-07-21 15:26:08] [config] overwrite: true
[2023-07-21 15:26:08] [config] precision:
[2023-07-21 15:26:08] [config]   - float16
[2023-07-21 15:26:08] [config]   - float32
[2023-07-21 15:26:08] [config] pretrained-model: ""
[2023-07-21 15:26:08] [config] quantize-biases: false
[2023-07-21 15:26:08] [config] quantize-bits: 0
[2023-07-21 15:26:08] [config] quantize-log-based: false
[2023-07-21 15:26:08] [config] quantize-optimization-steps: 0
[2023-07-21 15:26:08] [config] quiet: false
[2023-07-21 15:26:08] [config] quiet-translation: true
[2023-07-21 15:26:08] [config] relative-paths: false
[2023-07-21 15:26:08] [config] right-left: false
[2023-07-21 15:26:08] [config] save-freq: 10000u
[2023-07-21 15:26:08] [config] seed: 1234
[2023-07-21 15:26:08] [config] sentencepiece-alphas:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] sentencepiece-max-lines: 2000000
[2023-07-21 15:26:08] [config] sentencepiece-options: ""
[2023-07-21 15:26:08] [config] sharding: global
[2023-07-21 15:26:08] [config] shuffle: data
[2023-07-21 15:26:08] [config] shuffle-in-ram: false
[2023-07-21 15:26:08] [config] sigterm: save-and-exit
[2023-07-21 15:26:08] [config] skip: false
[2023-07-21 15:26:08] [config] sqlite: ""
[2023-07-21 15:26:08] [config] sqlite-drop: false
[2023-07-21 15:26:08] [config] sync-freq: 200u
[2023-07-21 15:26:08] [config] sync-sgd: false
[2023-07-21 15:26:08] [config] tempdir: /tmp
[2023-07-21 15:26:08] [config] tied-embeddings: false
[2023-07-21 15:26:08] [config] tied-embeddings-all: true
[2023-07-21 15:26:08] [config] tied-embeddings-src: false
[2023-07-21 15:26:08] [config] train-embedder-rank:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] train-sets:
[2023-07-21 15:26:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 15:26:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 15:26:08] [config] transformer-aan-activation: swish
[2023-07-21 15:26:08] [config] transformer-aan-depth: 2
[2023-07-21 15:26:08] [config] transformer-aan-nogate: false
[2023-07-21 15:26:08] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 15:26:08] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 15:26:08] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 15:26:08] [config] transformer-depth-scaling: false
[2023-07-21 15:26:08] [config] transformer-dim-aan: 2048
[2023-07-21 15:26:08] [config] transformer-dim-ffn: 2048
[2023-07-21 15:26:08] [config] transformer-dropout: 0
[2023-07-21 15:26:08] [config] transformer-dropout-attention: 0
[2023-07-21 15:26:08] [config] transformer-dropout-ffn: 0
[2023-07-21 15:26:08] [config] transformer-ffn-activation: swish
[2023-07-21 15:26:08] [config] transformer-ffn-depth: 2
[2023-07-21 15:26:08] [config] transformer-guided-alignment-layer: last
[2023-07-21 15:26:08] [config] transformer-heads: 8
[2023-07-21 15:26:08] [config] transformer-no-projection: false
[2023-07-21 15:26:08] [config] transformer-pool: false
[2023-07-21 15:26:08] [config] transformer-postprocess: dan
[2023-07-21 15:26:08] [config] transformer-postprocess-emb: d
[2023-07-21 15:26:08] [config] transformer-postprocess-top: ""
[2023-07-21 15:26:08] [config] transformer-preprocess: ""
[2023-07-21 15:26:08] [config] transformer-tied-layers:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] transformer-train-position-embeddings: false
[2023-07-21 15:26:08] [config] tsv: false
[2023-07-21 15:26:08] [config] tsv-fields: 0
[2023-07-21 15:26:08] [config] type: amun
[2023-07-21 15:26:08] [config] ulr: false
[2023-07-21 15:26:08] [config] ulr-dim-emb: 0
[2023-07-21 15:26:08] [config] ulr-dropout: 0
[2023-07-21 15:26:08] [config] ulr-keys-vectors: ""
[2023-07-21 15:26:08] [config] ulr-query-vectors: ""
[2023-07-21 15:26:08] [config] ulr-softmax-temperature: 1
[2023-07-21 15:26:08] [config] ulr-trainable-transformation: false
[2023-07-21 15:26:08] [config] unlikelihood-loss: false
[2023-07-21 15:26:08] [config] valid-freq: 50000000
[2023-07-21 15:26:08] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 15:26:08] [config] valid-max-length: 1000
[2023-07-21 15:26:08] [config] valid-metrics:
[2023-07-21 15:26:08] [config]   - cross-entropy
[2023-07-21 15:26:08] [config]   - translation
[2023-07-21 15:26:08] [config] valid-mini-batch: 32
[2023-07-21 15:26:08] [config] valid-reset-stalled: false
[2023-07-21 15:26:08] [config] valid-script-args:
[2023-07-21 15:26:08] [config]   []
[2023-07-21 15:26:08] [config] valid-script-path: ""
[2023-07-21 15:26:08] [config] valid-sets:
[2023-07-21 15:26:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 15:26:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 15:26:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 15:26:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 15:26:08] [config] vocabs:
[2023-07-21 15:26:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 15:26:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 15:26:08] [config] word-penalty: 0
[2023-07-21 15:26:08] [config] word-scores: false
[2023-07-21 15:26:08] [config] workspace: 5500
[2023-07-21 15:26:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 15:26:08] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 15:26:08] [training] Using single-device training
[2023-07-21 15:26:09] Synced seed 1234
[2023-07-21 15:26:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 15:26:09] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 15:26:09] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 15:26:09] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 15:26:09] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 15:26:09] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 15:26:09] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 15:26:10] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 15:26:10] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 15:26:10] [comm] Using global sharding
[2023-07-21 15:26:10] [comm] NCCLCommunicators constructed successfully
[2023-07-21 15:26:10] [training] Using 1 GPUs
[2023-07-21 15:26:10] [logits] Applying loss function for 1 factor(s)
[2023-07-21 15:26:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 15:26:10] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 15:26:10] [memory] Reserving 80 MB, device gpu0
[2023-07-21 16:17:56] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 16:17:56] [valid] No post-processing script given for validating translator
[2023-07-21 16:17:56] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 16:17:56] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 16:17:56] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 16:17:56] [comm] Using global sharding
[2023-07-21 16:17:57] [comm] NCCLCommunicators constructed successfully
[2023-07-21 16:17:57] [training] Using 1 GPUs
[2023-07-21 16:17:57] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 16:18:05] Allocating memory for general optimizer shards
[2023-07-21 16:18:05] [memory] Reserving 322 MB, device gpu0
[2023-07-21 16:18:05] Loading Adam parameters
[2023-07-21 16:18:05] [memory] Reserving 322 MB, device gpu0
[2023-07-21 16:18:05] [memory] Reserving 80 MB, device gpu0
[2023-07-21 16:18:06] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 16:18:06] [data] Restoring the corpus state to epoch 171, batch 6587
[2023-07-21 16:18:06] [data] Shuffling data
[2023-07-21 16:18:06] [data] Done reading 20,192 sentences
[2023-07-21 16:18:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:18:06] Training started
[2023-07-21 16:18:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 16:18:06] [memory] Reserving 80 MB, device gpu0
[2023-07-21 16:18:12] Parameter type float16, optimization type float32, casting types true
[2023-07-21 16:22:43] Seen 20,192 samples
[2023-07-21 16:22:43] Starting data epoch 172 in logical epoch 172
[2023-07-21 16:22:43] [data] Shuffling data
[2023-07-21 16:22:44] [data] Done reading 20,192 sentences
[2023-07-21 16:22:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:27:43] Seen 20,192 samples
[2023-07-21 16:27:43] Starting data epoch 173 in logical epoch 173
[2023-07-21 16:27:43] [data] Shuffling data
[2023-07-21 16:27:43] [data] Done reading 20,192 sentences
[2023-07-21 16:27:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:32:37] Seen 20,192 samples
[2023-07-21 16:32:37] Starting data epoch 174 in logical epoch 174
[2023-07-21 16:32:37] [data] Shuffling data
[2023-07-21 16:32:37] [data] Done reading 20,192 sentences
[2023-07-21 16:32:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:37:36] Seen 20,192 samples
[2023-07-21 16:37:36] Starting data epoch 175 in logical epoch 175
[2023-07-21 16:37:36] [data] Shuffling data
[2023-07-21 16:37:36] [data] Done reading 20,192 sentences
[2023-07-21 16:37:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:42:24] Seen 20,192 samples
[2023-07-21 16:42:24] Starting data epoch 176 in logical epoch 176
[2023-07-21 16:42:24] [data] Shuffling data
[2023-07-21 16:42:24] [data] Done reading 20,192 sentences
[2023-07-21 16:42:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:47:25] Seen 20,192 samples
[2023-07-21 16:47:25] Starting data epoch 177 in logical epoch 177
[2023-07-21 16:47:25] [data] Shuffling data
[2023-07-21 16:47:25] [data] Done reading 20,192 sentences
[2023-07-21 16:47:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:52:04] Seen 20,192 samples
[2023-07-21 16:52:04] Starting data epoch 178 in logical epoch 178
[2023-07-21 16:52:04] [data] Shuffling data
[2023-07-21 16:52:04] [data] Done reading 20,192 sentences
[2023-07-21 16:52:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 16:57:02] Seen 20,192 samples
[2023-07-21 16:57:02] Starting data epoch 179 in logical epoch 179
[2023-07-21 16:57:02] [data] Shuffling data
[2023-07-21 16:57:02] [data] Done reading 20,192 sentences
[2023-07-21 16:57:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:01:48] Seen 20,192 samples
[2023-07-21 17:01:48] Starting data epoch 180 in logical epoch 180
[2023-07-21 17:01:48] [data] Shuffling data
[2023-07-21 17:01:48] [data] Done reading 20,192 sentences
[2023-07-21 17:01:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 17:06:31] Seen 20,192 samples
[2023-07-21 17:06:31] Starting data epoch 181 in logical epoch 181
[2023-07-21 17:06:31] Training finished
[2023-07-21 17:06:44] [valid] Ep. 181 : Up. 6975 : cross-entropy : 133.189 : stalled 4 times (last best: 130.991)
[2023-07-21 17:08:50] [valid] Ep. 181 : Up. 6975 : translation : 0 : new best
[2023-07-21 17:08:50] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 17:08:52] Saving Adam parameters
[2023-07-21 17:08:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 17:09:00] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:09:00] [marian] Running on node18.datos.cluster.uy as process 38089 with command line:
[2023-07-21 17:09:00] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 17:09:00] [config] after: 0e
[2023-07-21 17:09:00] [config] after-batches: 0
[2023-07-21 17:09:00] [config] after-epochs: 190
[2023-07-21 17:09:00] [config] all-caps-every: 0
[2023-07-21 17:09:00] [config] allow-unk: false
[2023-07-21 17:09:00] [config] authors: false
[2023-07-21 17:09:00] [config] beam-size: 12
[2023-07-21 17:09:00] [config] bert-class-symbol: "[CLS]"
[2023-07-21 17:09:00] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 17:09:00] [config] bert-masking-fraction: 0.15
[2023-07-21 17:09:00] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 17:09:00] [config] bert-train-type-embeddings: true
[2023-07-21 17:09:00] [config] bert-type-vocab-size: 2
[2023-07-21 17:09:00] [config] build-info: ""
[2023-07-21 17:09:00] [config] check-gradient-nan: false
[2023-07-21 17:09:00] [config] check-nan: false
[2023-07-21 17:09:00] [config] cite: false
[2023-07-21 17:09:00] [config] clip-norm: 1
[2023-07-21 17:09:00] [config] cost-scaling:
[2023-07-21 17:09:00] [config]   - 256.f
[2023-07-21 17:09:00] [config]   - 1000
[2023-07-21 17:09:00] [config]   - 2.f
[2023-07-21 17:09:00] [config]   - 256.f
[2023-07-21 17:09:00] [config] cost-type: ce-sum
[2023-07-21 17:09:00] [config] cpu-threads: 0
[2023-07-21 17:09:00] [config] data-threads: 8
[2023-07-21 17:09:00] [config] data-weighting: ""
[2023-07-21 17:09:00] [config] data-weighting-type: sentence
[2023-07-21 17:09:00] [config] dec-cell: gru
[2023-07-21 17:09:00] [config] dec-cell-base-depth: 2
[2023-07-21 17:09:00] [config] dec-cell-high-depth: 1
[2023-07-21 17:09:00] [config] dec-depth: 1
[2023-07-21 17:09:00] [config] devices:
[2023-07-21 17:09:00] [config]   - 0
[2023-07-21 17:09:00] [config] dim-emb: 512
[2023-07-21 17:09:00] [config] dim-rnn: 1024
[2023-07-21 17:09:00] [config] dim-vocabs:
[2023-07-21 17:09:00] [config]   - 16384
[2023-07-21 17:09:00] [config]   - 16384
[2023-07-21 17:09:00] [config] disp-first: 0
[2023-07-21 17:09:00] [config] disp-freq: 1000u
[2023-07-21 17:09:00] [config] disp-label-counts: true
[2023-07-21 17:09:00] [config] dropout-rnn: 0
[2023-07-21 17:09:00] [config] dropout-src: 0
[2023-07-21 17:09:00] [config] dropout-trg: 0
[2023-07-21 17:09:00] [config] dump-config: ""
[2023-07-21 17:09:00] [config] dynamic-gradient-scaling:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] early-stopping: 200
[2023-07-21 17:09:00] [config] early-stopping-on: first
[2023-07-21 17:09:00] [config] embedding-fix-src: false
[2023-07-21 17:09:00] [config] embedding-fix-trg: false
[2023-07-21 17:09:00] [config] embedding-normalization: false
[2023-07-21 17:09:00] [config] embedding-vectors:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] enc-cell: gru
[2023-07-21 17:09:00] [config] enc-cell-depth: 1
[2023-07-21 17:09:00] [config] enc-depth: 1
[2023-07-21 17:09:00] [config] enc-type: bidirectional
[2023-07-21 17:09:00] [config] english-title-case-every: 0
[2023-07-21 17:09:00] [config] exponential-smoothing: 0
[2023-07-21 17:09:00] [config] factor-weight: 1
[2023-07-21 17:09:00] [config] factors-combine: sum
[2023-07-21 17:09:00] [config] factors-dim-emb: 0
[2023-07-21 17:09:00] [config] gradient-checkpointing: false
[2023-07-21 17:09:00] [config] gradient-norm-average-window: 100
[2023-07-21 17:09:00] [config] guided-alignment: none
[2023-07-21 17:09:00] [config] guided-alignment-cost: mse
[2023-07-21 17:09:00] [config] guided-alignment-weight: 0.1
[2023-07-21 17:09:00] [config] ignore-model-config: false
[2023-07-21 17:09:00] [config] input-types:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] interpolate-env-vars: false
[2023-07-21 17:09:00] [config] keep-best: false
[2023-07-21 17:09:00] [config] label-smoothing: 0
[2023-07-21 17:09:00] [config] layer-normalization: false
[2023-07-21 17:09:00] [config] learn-rate: 0.0001
[2023-07-21 17:09:00] [config] lemma-dependency: ""
[2023-07-21 17:09:00] [config] lemma-dim-emb: 0
[2023-07-21 17:09:00] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 17:09:00] [config] log-level: info
[2023-07-21 17:09:00] [config] log-time-zone: ""
[2023-07-21 17:09:00] [config] logical-epoch:
[2023-07-21 17:09:00] [config]   - 1e
[2023-07-21 17:09:00] [config]   - 0
[2023-07-21 17:09:00] [config] lr-decay: 0
[2023-07-21 17:09:00] [config] lr-decay-freq: 50000
[2023-07-21 17:09:00] [config] lr-decay-inv-sqrt:
[2023-07-21 17:09:00] [config]   - 0
[2023-07-21 17:09:00] [config] lr-decay-repeat-warmup: false
[2023-07-21 17:09:00] [config] lr-decay-reset-optimizer: false
[2023-07-21 17:09:00] [config] lr-decay-start:
[2023-07-21 17:09:00] [config]   - 10
[2023-07-21 17:09:00] [config]   - 1
[2023-07-21 17:09:00] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 17:09:00] [config] lr-report: false
[2023-07-21 17:09:00] [config] lr-warmup: 0
[2023-07-21 17:09:00] [config] lr-warmup-at-reload: false
[2023-07-21 17:09:00] [config] lr-warmup-cycle: false
[2023-07-21 17:09:00] [config] lr-warmup-start-rate: 0
[2023-07-21 17:09:00] [config] max-length: 250
[2023-07-21 17:09:00] [config] max-length-crop: true
[2023-07-21 17:09:00] [config] max-length-factor: 3
[2023-07-21 17:09:00] [config] maxi-batch: 100
[2023-07-21 17:09:00] [config] maxi-batch-sort: trg
[2023-07-21 17:09:00] [config] mini-batch: 64
[2023-07-21 17:09:00] [config] mini-batch-fit: true
[2023-07-21 17:09:00] [config] mini-batch-fit-step: 10
[2023-07-21 17:09:00] [config] mini-batch-round-up: true
[2023-07-21 17:09:00] [config] mini-batch-track-lr: false
[2023-07-21 17:09:00] [config] mini-batch-warmup: 0
[2023-07-21 17:09:00] [config] mini-batch-words: 0
[2023-07-21 17:09:00] [config] mini-batch-words-ref: 0
[2023-07-21 17:09:00] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 17:09:00] [config] multi-loss-type: sum
[2023-07-21 17:09:00] [config] n-best: false
[2023-07-21 17:09:00] [config] no-nccl: false
[2023-07-21 17:09:00] [config] no-reload: false
[2023-07-21 17:09:00] [config] no-restore-corpus: false
[2023-07-21 17:09:00] [config] normalize: 0
[2023-07-21 17:09:00] [config] normalize-gradient: false
[2023-07-21 17:09:00] [config] num-devices: 0
[2023-07-21 17:09:00] [config] optimizer: adam
[2023-07-21 17:09:00] [config] optimizer-delay: 1
[2023-07-21 17:09:00] [config] optimizer-params:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] output-omit-bias: false
[2023-07-21 17:09:00] [config] overwrite: true
[2023-07-21 17:09:00] [config] precision:
[2023-07-21 17:09:00] [config]   - float16
[2023-07-21 17:09:00] [config]   - float32
[2023-07-21 17:09:00] [config] pretrained-model: ""
[2023-07-21 17:09:00] [config] quantize-biases: false
[2023-07-21 17:09:00] [config] quantize-bits: 0
[2023-07-21 17:09:00] [config] quantize-log-based: false
[2023-07-21 17:09:00] [config] quantize-optimization-steps: 0
[2023-07-21 17:09:00] [config] quiet: false
[2023-07-21 17:09:00] [config] quiet-translation: true
[2023-07-21 17:09:00] [config] relative-paths: false
[2023-07-21 17:09:00] [config] right-left: false
[2023-07-21 17:09:00] [config] save-freq: 10000u
[2023-07-21 17:09:00] [config] seed: 1234
[2023-07-21 17:09:00] [config] sentencepiece-alphas:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] sentencepiece-max-lines: 2000000
[2023-07-21 17:09:00] [config] sentencepiece-options: ""
[2023-07-21 17:09:00] [config] sharding: global
[2023-07-21 17:09:00] [config] shuffle: data
[2023-07-21 17:09:00] [config] shuffle-in-ram: false
[2023-07-21 17:09:00] [config] sigterm: save-and-exit
[2023-07-21 17:09:00] [config] skip: false
[2023-07-21 17:09:00] [config] sqlite: ""
[2023-07-21 17:09:00] [config] sqlite-drop: false
[2023-07-21 17:09:00] [config] sync-freq: 200u
[2023-07-21 17:09:00] [config] sync-sgd: false
[2023-07-21 17:09:00] [config] tempdir: /tmp
[2023-07-21 17:09:00] [config] tied-embeddings: false
[2023-07-21 17:09:00] [config] tied-embeddings-all: true
[2023-07-21 17:09:00] [config] tied-embeddings-src: false
[2023-07-21 17:09:00] [config] train-embedder-rank:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] train-sets:
[2023-07-21 17:09:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 17:09:00] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 17:09:00] [config] transformer-aan-activation: swish
[2023-07-21 17:09:00] [config] transformer-aan-depth: 2
[2023-07-21 17:09:00] [config] transformer-aan-nogate: false
[2023-07-21 17:09:00] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 17:09:00] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 17:09:00] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 17:09:00] [config] transformer-depth-scaling: false
[2023-07-21 17:09:00] [config] transformer-dim-aan: 2048
[2023-07-21 17:09:00] [config] transformer-dim-ffn: 2048
[2023-07-21 17:09:00] [config] transformer-dropout: 0
[2023-07-21 17:09:00] [config] transformer-dropout-attention: 0
[2023-07-21 17:09:00] [config] transformer-dropout-ffn: 0
[2023-07-21 17:09:00] [config] transformer-ffn-activation: swish
[2023-07-21 17:09:00] [config] transformer-ffn-depth: 2
[2023-07-21 17:09:00] [config] transformer-guided-alignment-layer: last
[2023-07-21 17:09:00] [config] transformer-heads: 8
[2023-07-21 17:09:00] [config] transformer-no-projection: false
[2023-07-21 17:09:00] [config] transformer-pool: false
[2023-07-21 17:09:00] [config] transformer-postprocess: dan
[2023-07-21 17:09:00] [config] transformer-postprocess-emb: d
[2023-07-21 17:09:00] [config] transformer-postprocess-top: ""
[2023-07-21 17:09:00] [config] transformer-preprocess: ""
[2023-07-21 17:09:00] [config] transformer-tied-layers:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] transformer-train-position-embeddings: false
[2023-07-21 17:09:00] [config] tsv: false
[2023-07-21 17:09:00] [config] tsv-fields: 0
[2023-07-21 17:09:00] [config] type: amun
[2023-07-21 17:09:00] [config] ulr: false
[2023-07-21 17:09:00] [config] ulr-dim-emb: 0
[2023-07-21 17:09:00] [config] ulr-dropout: 0
[2023-07-21 17:09:00] [config] ulr-keys-vectors: ""
[2023-07-21 17:09:00] [config] ulr-query-vectors: ""
[2023-07-21 17:09:00] [config] ulr-softmax-temperature: 1
[2023-07-21 17:09:00] [config] ulr-trainable-transformation: false
[2023-07-21 17:09:00] [config] unlikelihood-loss: false
[2023-07-21 17:09:00] [config] valid-freq: 50000000
[2023-07-21 17:09:00] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 17:09:00] [config] valid-max-length: 1000
[2023-07-21 17:09:00] [config] valid-metrics:
[2023-07-21 17:09:00] [config]   - cross-entropy
[2023-07-21 17:09:00] [config]   - translation
[2023-07-21 17:09:00] [config] valid-mini-batch: 32
[2023-07-21 17:09:00] [config] valid-reset-stalled: false
[2023-07-21 17:09:00] [config] valid-script-args:
[2023-07-21 17:09:00] [config]   []
[2023-07-21 17:09:00] [config] valid-script-path: ""
[2023-07-21 17:09:00] [config] valid-sets:
[2023-07-21 17:09:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 17:09:00] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 17:09:00] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 17:09:00] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:09:00] [config] vocabs:
[2023-07-21 17:09:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 17:09:00] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 17:09:00] [config] word-penalty: 0
[2023-07-21 17:09:00] [config] word-scores: false
[2023-07-21 17:09:00] [config] workspace: 5500
[2023-07-21 17:09:00] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 17:09:00] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:09:00] [training] Using single-device training
[2023-07-21 17:09:01] Synced seed 1234
[2023-07-21 17:09:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 17:09:01] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 17:09:01] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 17:09:01] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 17:09:01] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 17:09:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 17:09:01] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 17:09:02] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 17:09:02] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 17:09:02] [comm] Using global sharding
[2023-07-21 17:09:02] [comm] NCCLCommunicators constructed successfully
[2023-07-21 17:09:02] [training] Using 1 GPUs
[2023-07-21 17:09:02] [logits] Applying loss function for 1 factor(s)
[2023-07-21 17:09:02] [memory] Reserving 80 MB, device gpu0
[2023-07-21 17:09:02] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 17:09:02] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:00:22] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 18:00:22] [valid] No post-processing script given for validating translator
[2023-07-21 18:00:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:00:22] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:00:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:00:22] [comm] Using global sharding
[2023-07-21 18:00:22] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:00:22] [training] Using 1 GPUs
[2023-07-21 18:00:22] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 18:00:30] Allocating memory for general optimizer shards
[2023-07-21 18:00:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:00:30] Loading Adam parameters
[2023-07-21 18:00:30] [memory] Reserving 322 MB, device gpu0
[2023-07-21 18:00:30] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:00:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 18:00:31] [data] Restoring the corpus state to epoch 181, batch 6975
[2023-07-21 18:00:31] [data] Shuffling data
[2023-07-21 18:00:31] [data] Done reading 20,192 sentences
[2023-07-21 18:00:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:00:31] Training started
[2023-07-21 18:00:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 18:00:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:00:36] Parameter type float16, optimization type float32, casting types true
[2023-07-21 18:03:20] Ep. 181 : Up. 7000 : Sen. 13,277 : Cost 2.81140685 * 16,074,491 @ 16,138 after 112,093,581 : Time 177.53s : 90547.44 words/s : gNorm 1.7939
[2023-07-21 18:05:07] Seen 20,192 samples
[2023-07-21 18:05:07] Starting data epoch 182 in logical epoch 182
[2023-07-21 18:05:07] [data] Shuffling data
[2023-07-21 18:05:08] [data] Done reading 20,192 sentences
[2023-07-21 18:05:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:09:59] Seen 20,192 samples
[2023-07-21 18:09:59] Starting data epoch 183 in logical epoch 183
[2023-07-21 18:09:59] [data] Shuffling data
[2023-07-21 18:09:59] [data] Done reading 20,192 sentences
[2023-07-21 18:09:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:14:53] Seen 20,192 samples
[2023-07-21 18:14:53] Starting data epoch 184 in logical epoch 184
[2023-07-21 18:14:53] [data] Shuffling data
[2023-07-21 18:14:53] [data] Done reading 20,192 sentences
[2023-07-21 18:14:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:19:36] Seen 20,192 samples
[2023-07-21 18:19:36] Starting data epoch 185 in logical epoch 185
[2023-07-21 18:19:36] [data] Shuffling data
[2023-07-21 18:19:36] [data] Done reading 20,192 sentences
[2023-07-21 18:19:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:24:08] Seen 20,192 samples
[2023-07-21 18:24:08] Starting data epoch 186 in logical epoch 186
[2023-07-21 18:24:08] [data] Shuffling data
[2023-07-21 18:24:08] [data] Done reading 20,192 sentences
[2023-07-21 18:24:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:28:57] Seen 20,192 samples
[2023-07-21 18:28:57] Starting data epoch 187 in logical epoch 187
[2023-07-21 18:28:57] [data] Shuffling data
[2023-07-21 18:28:57] [data] Done reading 20,192 sentences
[2023-07-21 18:28:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:33:45] Seen 20,192 samples
[2023-07-21 18:33:45] Starting data epoch 188 in logical epoch 188
[2023-07-21 18:33:45] [data] Shuffling data
[2023-07-21 18:33:45] [data] Done reading 20,192 sentences
[2023-07-21 18:33:45] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:38:38] Seen 20,192 samples
[2023-07-21 18:38:38] Starting data epoch 189 in logical epoch 189
[2023-07-21 18:38:38] [data] Shuffling data
[2023-07-21 18:38:38] [data] Done reading 20,192 sentences
[2023-07-21 18:38:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:43:20] Seen 20,192 samples
[2023-07-21 18:43:20] Starting data epoch 190 in logical epoch 190
[2023-07-21 18:43:20] [data] Shuffling data
[2023-07-21 18:43:20] [data] Done reading 20,192 sentences
[2023-07-21 18:43:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 18:48:12] Seen 20,192 samples
[2023-07-21 18:48:12] Starting data epoch 191 in logical epoch 191
[2023-07-21 18:48:12] Training finished
[2023-07-21 18:48:24] [valid] Ep. 191 : Up. 7363 : cross-entropy : 135.581 : stalled 5 times (last best: 130.991)
[2023-07-21 18:50:28] [valid] Ep. 191 : Up. 7363 : translation : 0 : new best
[2023-07-21 18:50:28] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 18:50:29] Saving Adam parameters
[2023-07-21 18:50:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 18:50:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:50:39] [marian] Running on node18.datos.cluster.uy as process 4393 with command line:
[2023-07-21 18:50:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 250
[2023-07-21 18:50:39] [config] after: 0e
[2023-07-21 18:50:39] [config] after-batches: 0
[2023-07-21 18:50:39] [config] after-epochs: 200
[2023-07-21 18:50:39] [config] all-caps-every: 0
[2023-07-21 18:50:39] [config] allow-unk: false
[2023-07-21 18:50:39] [config] authors: false
[2023-07-21 18:50:39] [config] beam-size: 12
[2023-07-21 18:50:39] [config] bert-class-symbol: "[CLS]"
[2023-07-21 18:50:39] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 18:50:39] [config] bert-masking-fraction: 0.15
[2023-07-21 18:50:39] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 18:50:39] [config] bert-train-type-embeddings: true
[2023-07-21 18:50:39] [config] bert-type-vocab-size: 2
[2023-07-21 18:50:39] [config] build-info: ""
[2023-07-21 18:50:39] [config] check-gradient-nan: false
[2023-07-21 18:50:39] [config] check-nan: false
[2023-07-21 18:50:39] [config] cite: false
[2023-07-21 18:50:39] [config] clip-norm: 1
[2023-07-21 18:50:39] [config] cost-scaling:
[2023-07-21 18:50:39] [config]   - 256.f
[2023-07-21 18:50:39] [config]   - 1000
[2023-07-21 18:50:39] [config]   - 2.f
[2023-07-21 18:50:39] [config]   - 256.f
[2023-07-21 18:50:39] [config] cost-type: ce-sum
[2023-07-21 18:50:39] [config] cpu-threads: 0
[2023-07-21 18:50:39] [config] data-threads: 8
[2023-07-21 18:50:39] [config] data-weighting: ""
[2023-07-21 18:50:39] [config] data-weighting-type: sentence
[2023-07-21 18:50:39] [config] dec-cell: gru
[2023-07-21 18:50:39] [config] dec-cell-base-depth: 2
[2023-07-21 18:50:39] [config] dec-cell-high-depth: 1
[2023-07-21 18:50:39] [config] dec-depth: 1
[2023-07-21 18:50:39] [config] devices:
[2023-07-21 18:50:39] [config]   - 0
[2023-07-21 18:50:39] [config] dim-emb: 512
[2023-07-21 18:50:39] [config] dim-rnn: 1024
[2023-07-21 18:50:39] [config] dim-vocabs:
[2023-07-21 18:50:39] [config]   - 16384
[2023-07-21 18:50:39] [config]   - 16384
[2023-07-21 18:50:39] [config] disp-first: 0
[2023-07-21 18:50:39] [config] disp-freq: 1000u
[2023-07-21 18:50:39] [config] disp-label-counts: true
[2023-07-21 18:50:39] [config] dropout-rnn: 0
[2023-07-21 18:50:39] [config] dropout-src: 0
[2023-07-21 18:50:39] [config] dropout-trg: 0
[2023-07-21 18:50:39] [config] dump-config: ""
[2023-07-21 18:50:39] [config] dynamic-gradient-scaling:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] early-stopping: 200
[2023-07-21 18:50:39] [config] early-stopping-on: first
[2023-07-21 18:50:39] [config] embedding-fix-src: false
[2023-07-21 18:50:39] [config] embedding-fix-trg: false
[2023-07-21 18:50:39] [config] embedding-normalization: false
[2023-07-21 18:50:39] [config] embedding-vectors:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] enc-cell: gru
[2023-07-21 18:50:39] [config] enc-cell-depth: 1
[2023-07-21 18:50:39] [config] enc-depth: 1
[2023-07-21 18:50:39] [config] enc-type: bidirectional
[2023-07-21 18:50:39] [config] english-title-case-every: 0
[2023-07-21 18:50:39] [config] exponential-smoothing: 0
[2023-07-21 18:50:39] [config] factor-weight: 1
[2023-07-21 18:50:39] [config] factors-combine: sum
[2023-07-21 18:50:39] [config] factors-dim-emb: 0
[2023-07-21 18:50:39] [config] gradient-checkpointing: false
[2023-07-21 18:50:39] [config] gradient-norm-average-window: 100
[2023-07-21 18:50:39] [config] guided-alignment: none
[2023-07-21 18:50:39] [config] guided-alignment-cost: mse
[2023-07-21 18:50:39] [config] guided-alignment-weight: 0.1
[2023-07-21 18:50:39] [config] ignore-model-config: false
[2023-07-21 18:50:39] [config] input-types:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] interpolate-env-vars: false
[2023-07-21 18:50:39] [config] keep-best: false
[2023-07-21 18:50:39] [config] label-smoothing: 0
[2023-07-21 18:50:39] [config] layer-normalization: false
[2023-07-21 18:50:39] [config] learn-rate: 0.0001
[2023-07-21 18:50:39] [config] lemma-dependency: ""
[2023-07-21 18:50:39] [config] lemma-dim-emb: 0
[2023-07-21 18:50:39] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 18:50:39] [config] log-level: info
[2023-07-21 18:50:39] [config] log-time-zone: ""
[2023-07-21 18:50:39] [config] logical-epoch:
[2023-07-21 18:50:39] [config]   - 1e
[2023-07-21 18:50:39] [config]   - 0
[2023-07-21 18:50:39] [config] lr-decay: 0
[2023-07-21 18:50:39] [config] lr-decay-freq: 50000
[2023-07-21 18:50:39] [config] lr-decay-inv-sqrt:
[2023-07-21 18:50:39] [config]   - 0
[2023-07-21 18:50:39] [config] lr-decay-repeat-warmup: false
[2023-07-21 18:50:39] [config] lr-decay-reset-optimizer: false
[2023-07-21 18:50:39] [config] lr-decay-start:
[2023-07-21 18:50:39] [config]   - 10
[2023-07-21 18:50:39] [config]   - 1
[2023-07-21 18:50:39] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 18:50:39] [config] lr-report: false
[2023-07-21 18:50:39] [config] lr-warmup: 0
[2023-07-21 18:50:39] [config] lr-warmup-at-reload: false
[2023-07-21 18:50:39] [config] lr-warmup-cycle: false
[2023-07-21 18:50:39] [config] lr-warmup-start-rate: 0
[2023-07-21 18:50:39] [config] max-length: 250
[2023-07-21 18:50:39] [config] max-length-crop: true
[2023-07-21 18:50:39] [config] max-length-factor: 3
[2023-07-21 18:50:39] [config] maxi-batch: 100
[2023-07-21 18:50:39] [config] maxi-batch-sort: trg
[2023-07-21 18:50:39] [config] mini-batch: 64
[2023-07-21 18:50:39] [config] mini-batch-fit: true
[2023-07-21 18:50:39] [config] mini-batch-fit-step: 10
[2023-07-21 18:50:39] [config] mini-batch-round-up: true
[2023-07-21 18:50:39] [config] mini-batch-track-lr: false
[2023-07-21 18:50:39] [config] mini-batch-warmup: 0
[2023-07-21 18:50:39] [config] mini-batch-words: 0
[2023-07-21 18:50:39] [config] mini-batch-words-ref: 0
[2023-07-21 18:50:39] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 18:50:39] [config] multi-loss-type: sum
[2023-07-21 18:50:39] [config] n-best: false
[2023-07-21 18:50:39] [config] no-nccl: false
[2023-07-21 18:50:39] [config] no-reload: false
[2023-07-21 18:50:39] [config] no-restore-corpus: false
[2023-07-21 18:50:39] [config] normalize: 0
[2023-07-21 18:50:39] [config] normalize-gradient: false
[2023-07-21 18:50:39] [config] num-devices: 0
[2023-07-21 18:50:39] [config] optimizer: adam
[2023-07-21 18:50:39] [config] optimizer-delay: 1
[2023-07-21 18:50:39] [config] optimizer-params:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] output-omit-bias: false
[2023-07-21 18:50:39] [config] overwrite: true
[2023-07-21 18:50:39] [config] precision:
[2023-07-21 18:50:39] [config]   - float16
[2023-07-21 18:50:39] [config]   - float32
[2023-07-21 18:50:39] [config] pretrained-model: ""
[2023-07-21 18:50:39] [config] quantize-biases: false
[2023-07-21 18:50:39] [config] quantize-bits: 0
[2023-07-21 18:50:39] [config] quantize-log-based: false
[2023-07-21 18:50:39] [config] quantize-optimization-steps: 0
[2023-07-21 18:50:39] [config] quiet: false
[2023-07-21 18:50:39] [config] quiet-translation: true
[2023-07-21 18:50:39] [config] relative-paths: false
[2023-07-21 18:50:39] [config] right-left: false
[2023-07-21 18:50:39] [config] save-freq: 10000u
[2023-07-21 18:50:39] [config] seed: 1234
[2023-07-21 18:50:39] [config] sentencepiece-alphas:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] sentencepiece-max-lines: 2000000
[2023-07-21 18:50:39] [config] sentencepiece-options: ""
[2023-07-21 18:50:39] [config] sharding: global
[2023-07-21 18:50:39] [config] shuffle: data
[2023-07-21 18:50:39] [config] shuffle-in-ram: false
[2023-07-21 18:50:39] [config] sigterm: save-and-exit
[2023-07-21 18:50:39] [config] skip: false
[2023-07-21 18:50:39] [config] sqlite: ""
[2023-07-21 18:50:39] [config] sqlite-drop: false
[2023-07-21 18:50:39] [config] sync-freq: 200u
[2023-07-21 18:50:39] [config] sync-sgd: false
[2023-07-21 18:50:39] [config] tempdir: /tmp
[2023-07-21 18:50:39] [config] tied-embeddings: false
[2023-07-21 18:50:39] [config] tied-embeddings-all: true
[2023-07-21 18:50:39] [config] tied-embeddings-src: false
[2023-07-21 18:50:39] [config] train-embedder-rank:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] train-sets:
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 18:50:39] [config] transformer-aan-activation: swish
[2023-07-21 18:50:39] [config] transformer-aan-depth: 2
[2023-07-21 18:50:39] [config] transformer-aan-nogate: false
[2023-07-21 18:50:39] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 18:50:39] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 18:50:39] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 18:50:39] [config] transformer-depth-scaling: false
[2023-07-21 18:50:39] [config] transformer-dim-aan: 2048
[2023-07-21 18:50:39] [config] transformer-dim-ffn: 2048
[2023-07-21 18:50:39] [config] transformer-dropout: 0
[2023-07-21 18:50:39] [config] transformer-dropout-attention: 0
[2023-07-21 18:50:39] [config] transformer-dropout-ffn: 0
[2023-07-21 18:50:39] [config] transformer-ffn-activation: swish
[2023-07-21 18:50:39] [config] transformer-ffn-depth: 2
[2023-07-21 18:50:39] [config] transformer-guided-alignment-layer: last
[2023-07-21 18:50:39] [config] transformer-heads: 8
[2023-07-21 18:50:39] [config] transformer-no-projection: false
[2023-07-21 18:50:39] [config] transformer-pool: false
[2023-07-21 18:50:39] [config] transformer-postprocess: dan
[2023-07-21 18:50:39] [config] transformer-postprocess-emb: d
[2023-07-21 18:50:39] [config] transformer-postprocess-top: ""
[2023-07-21 18:50:39] [config] transformer-preprocess: ""
[2023-07-21 18:50:39] [config] transformer-tied-layers:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] transformer-train-position-embeddings: false
[2023-07-21 18:50:39] [config] tsv: false
[2023-07-21 18:50:39] [config] tsv-fields: 0
[2023-07-21 18:50:39] [config] type: amun
[2023-07-21 18:50:39] [config] ulr: false
[2023-07-21 18:50:39] [config] ulr-dim-emb: 0
[2023-07-21 18:50:39] [config] ulr-dropout: 0
[2023-07-21 18:50:39] [config] ulr-keys-vectors: ""
[2023-07-21 18:50:39] [config] ulr-query-vectors: ""
[2023-07-21 18:50:39] [config] ulr-softmax-temperature: 1
[2023-07-21 18:50:39] [config] ulr-trainable-transformation: false
[2023-07-21 18:50:39] [config] unlikelihood-loss: false
[2023-07-21 18:50:39] [config] valid-freq: 50000000
[2023-07-21 18:50:39] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 18:50:39] [config] valid-max-length: 1000
[2023-07-21 18:50:39] [config] valid-metrics:
[2023-07-21 18:50:39] [config]   - cross-entropy
[2023-07-21 18:50:39] [config]   - translation
[2023-07-21 18:50:39] [config] valid-mini-batch: 32
[2023-07-21 18:50:39] [config] valid-reset-stalled: false
[2023-07-21 18:50:39] [config] valid-script-args:
[2023-07-21 18:50:39] [config]   []
[2023-07-21 18:50:39] [config] valid-script-path: ""
[2023-07-21 18:50:39] [config] valid-sets:
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 18:50:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 18:50:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:50:39] [config] vocabs:
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:50:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:50:39] [config] word-penalty: 0
[2023-07-21 18:50:39] [config] word-scores: false
[2023-07-21 18:50:39] [config] workspace: 5500
[2023-07-21 18:50:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 18:50:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:50:39] [training] Using single-device training
[2023-07-21 18:50:40] Synced seed 1234
[2023-07-21 18:50:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 18:50:40] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 18:50:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 18:50:40] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 18:50:40] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 18:50:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 18:50:40] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 18:50:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 18:50:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 18:50:42] [comm] Using global sharding
[2023-07-21 18:50:42] [comm] NCCLCommunicators constructed successfully
[2023-07-21 18:50:42] [training] Using 1 GPUs
[2023-07-21 18:50:42] [logits] Applying loss function for 1 factor(s)
[2023-07-21 18:50:42] [memory] Reserving 80 MB, device gpu0
[2023-07-21 18:50:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 18:50:42] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:42:18] [batching] Done. Typical MB size is 35,869 target words
[2023-07-21 19:42:18] [valid] No post-processing script given for validating translator
[2023-07-21 19:42:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 19:42:18] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 19:42:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 19:42:18] [comm] Using global sharding
[2023-07-21 19:42:18] [comm] NCCLCommunicators constructed successfully
[2023-07-21 19:42:18] [training] Using 1 GPUs
[2023-07-21 19:42:18] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 19:42:26] Allocating memory for general optimizer shards
[2023-07-21 19:42:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:42:26] Loading Adam parameters
[2023-07-21 19:42:26] [memory] Reserving 322 MB, device gpu0
[2023-07-21 19:42:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:42:27] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 19:42:27] [data] Restoring the corpus state to epoch 191, batch 7363
[2023-07-21 19:42:27] [data] Shuffling data
[2023-07-21 19:42:27] [data] Done reading 20,192 sentences
[2023-07-21 19:42:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:42:27] Training started
[2023-07-21 19:42:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 19:42:27] [memory] Reserving 80 MB, device gpu0
[2023-07-21 19:42:30] Parameter type float16, optimization type float32, casting types true
[2023-07-21 19:46:44] Seen 20,192 samples
[2023-07-21 19:46:44] Starting data epoch 192 in logical epoch 192
[2023-07-21 19:46:44] [data] Shuffling data
[2023-07-21 19:46:44] [data] Done reading 20,192 sentences
[2023-07-21 19:46:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:51:29] Seen 20,192 samples
[2023-07-21 19:51:29] Starting data epoch 193 in logical epoch 193
[2023-07-21 19:51:29] [data] Shuffling data
[2023-07-21 19:51:29] [data] Done reading 20,192 sentences
[2023-07-21 19:51:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 19:56:26] Seen 20,192 samples
[2023-07-21 19:56:26] Starting data epoch 194 in logical epoch 194
[2023-07-21 19:56:26] [data] Shuffling data
[2023-07-21 19:56:26] [data] Done reading 20,192 sentences
[2023-07-21 19:56:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:01:10] Seen 20,192 samples
[2023-07-21 20:01:10] Starting data epoch 195 in logical epoch 195
[2023-07-21 20:01:10] [data] Shuffling data
[2023-07-21 20:01:10] [data] Done reading 20,192 sentences
[2023-07-21 20:01:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:05:50] Seen 20,192 samples
[2023-07-21 20:05:50] Starting data epoch 196 in logical epoch 196
[2023-07-21 20:05:50] [data] Shuffling data
[2023-07-21 20:05:50] [data] Done reading 20,192 sentences
[2023-07-21 20:05:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:10:30] Seen 20,192 samples
[2023-07-21 20:10:30] Starting data epoch 197 in logical epoch 197
[2023-07-21 20:10:30] [data] Shuffling data
[2023-07-21 20:10:31] [data] Done reading 20,192 sentences
[2023-07-21 20:10:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:15:27] Seen 20,192 samples
[2023-07-21 20:15:27] Starting data epoch 198 in logical epoch 198
[2023-07-21 20:15:27] [data] Shuffling data
[2023-07-21 20:15:27] [data] Done reading 20,192 sentences
[2023-07-21 20:15:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:20:13] Seen 20,192 samples
[2023-07-21 20:20:13] Starting data epoch 199 in logical epoch 199
[2023-07-21 20:20:13] [data] Shuffling data
[2023-07-21 20:20:13] [data] Done reading 20,192 sentences
[2023-07-21 20:20:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:24:55] Seen 20,192 samples
[2023-07-21 20:24:55] Starting data epoch 200 in logical epoch 200
[2023-07-21 20:24:55] [data] Shuffling data
[2023-07-21 20:24:55] [data] Done reading 20,192 sentences
[2023-07-21 20:24:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 20:29:46] Seen 20,192 samples
[2023-07-21 20:29:46] Starting data epoch 201 in logical epoch 201
[2023-07-21 20:29:46] Training finished
[2023-07-21 20:30:02] [valid] Ep. 201 : Up. 7750 : cross-entropy : 136.262 : stalled 6 times (last best: 130.991)
[2023-07-21 20:32:27] [valid] Ep. 201 : Up. 7750 : translation : 0 : new best
[2023-07-21 20:32:27] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz
[2023-07-21 20:32:29] Saving Adam parameters
[2023-07-21 20:32:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_250.npz.optimizer.npz
[2023-07-21 20:32:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:32:37] [marian] Running on node18.datos.cluster.uy as process 10871 with command line:
[2023-07-21 20:32:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-21 20:32:37] [config] after: 0e
[2023-07-21 20:32:37] [config] after-batches: 0
[2023-07-21 20:32:37] [config] after-epochs: 10
[2023-07-21 20:32:37] [config] all-caps-every: 0
[2023-07-21 20:32:37] [config] allow-unk: false
[2023-07-21 20:32:37] [config] authors: false
[2023-07-21 20:32:37] [config] beam-size: 12
[2023-07-21 20:32:37] [config] bert-class-symbol: "[CLS]"
[2023-07-21 20:32:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 20:32:37] [config] bert-masking-fraction: 0.15
[2023-07-21 20:32:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 20:32:37] [config] bert-train-type-embeddings: true
[2023-07-21 20:32:37] [config] bert-type-vocab-size: 2
[2023-07-21 20:32:37] [config] build-info: ""
[2023-07-21 20:32:37] [config] check-gradient-nan: false
[2023-07-21 20:32:37] [config] check-nan: false
[2023-07-21 20:32:37] [config] cite: false
[2023-07-21 20:32:37] [config] clip-norm: 1
[2023-07-21 20:32:37] [config] cost-scaling:
[2023-07-21 20:32:37] [config]   - 256.f
[2023-07-21 20:32:37] [config]   - 1000
[2023-07-21 20:32:37] [config]   - 2.f
[2023-07-21 20:32:37] [config]   - 256.f
[2023-07-21 20:32:37] [config] cost-type: ce-sum
[2023-07-21 20:32:37] [config] cpu-threads: 0
[2023-07-21 20:32:37] [config] data-threads: 8
[2023-07-21 20:32:37] [config] data-weighting: ""
[2023-07-21 20:32:37] [config] data-weighting-type: sentence
[2023-07-21 20:32:37] [config] dec-cell: gru
[2023-07-21 20:32:37] [config] dec-cell-base-depth: 2
[2023-07-21 20:32:37] [config] dec-cell-high-depth: 1
[2023-07-21 20:32:37] [config] dec-depth: 1
[2023-07-21 20:32:37] [config] devices:
[2023-07-21 20:32:37] [config]   - 0
[2023-07-21 20:32:37] [config] dim-emb: 512
[2023-07-21 20:32:37] [config] dim-rnn: 1024
[2023-07-21 20:32:37] [config] dim-vocabs:
[2023-07-21 20:32:37] [config]   - 16384
[2023-07-21 20:32:37] [config]   - 16384
[2023-07-21 20:32:37] [config] disp-first: 0
[2023-07-21 20:32:37] [config] disp-freq: 1000u
[2023-07-21 20:32:37] [config] disp-label-counts: true
[2023-07-21 20:32:37] [config] dropout-rnn: 0
[2023-07-21 20:32:37] [config] dropout-src: 0
[2023-07-21 20:32:37] [config] dropout-trg: 0
[2023-07-21 20:32:37] [config] dump-config: ""
[2023-07-21 20:32:37] [config] dynamic-gradient-scaling:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] early-stopping: 200
[2023-07-21 20:32:37] [config] early-stopping-on: first
[2023-07-21 20:32:37] [config] embedding-fix-src: false
[2023-07-21 20:32:37] [config] embedding-fix-trg: false
[2023-07-21 20:32:37] [config] embedding-normalization: false
[2023-07-21 20:32:37] [config] embedding-vectors:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] enc-cell: gru
[2023-07-21 20:32:37] [config] enc-cell-depth: 1
[2023-07-21 20:32:37] [config] enc-depth: 1
[2023-07-21 20:32:37] [config] enc-type: bidirectional
[2023-07-21 20:32:37] [config] english-title-case-every: 0
[2023-07-21 20:32:37] [config] exponential-smoothing: 0
[2023-07-21 20:32:37] [config] factor-weight: 1
[2023-07-21 20:32:37] [config] factors-combine: sum
[2023-07-21 20:32:37] [config] factors-dim-emb: 0
[2023-07-21 20:32:37] [config] gradient-checkpointing: false
[2023-07-21 20:32:37] [config] gradient-norm-average-window: 100
[2023-07-21 20:32:37] [config] guided-alignment: none
[2023-07-21 20:32:37] [config] guided-alignment-cost: mse
[2023-07-21 20:32:37] [config] guided-alignment-weight: 0.1
[2023-07-21 20:32:37] [config] ignore-model-config: false
[2023-07-21 20:32:37] [config] input-types:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] interpolate-env-vars: false
[2023-07-21 20:32:37] [config] keep-best: false
[2023-07-21 20:32:37] [config] label-smoothing: 0
[2023-07-21 20:32:37] [config] layer-normalization: false
[2023-07-21 20:32:37] [config] learn-rate: 0.0001
[2023-07-21 20:32:37] [config] lemma-dependency: ""
[2023-07-21 20:32:37] [config] lemma-dim-emb: 0
[2023-07-21 20:32:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 20:32:37] [config] log-level: info
[2023-07-21 20:32:37] [config] log-time-zone: ""
[2023-07-21 20:32:37] [config] logical-epoch:
[2023-07-21 20:32:37] [config]   - 1e
[2023-07-21 20:32:37] [config]   - 0
[2023-07-21 20:32:37] [config] lr-decay: 0
[2023-07-21 20:32:37] [config] lr-decay-freq: 50000
[2023-07-21 20:32:37] [config] lr-decay-inv-sqrt:
[2023-07-21 20:32:37] [config]   - 0
[2023-07-21 20:32:37] [config] lr-decay-repeat-warmup: false
[2023-07-21 20:32:37] [config] lr-decay-reset-optimizer: false
[2023-07-21 20:32:37] [config] lr-decay-start:
[2023-07-21 20:32:37] [config]   - 10
[2023-07-21 20:32:37] [config]   - 1
[2023-07-21 20:32:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 20:32:37] [config] lr-report: false
[2023-07-21 20:32:37] [config] lr-warmup: 0
[2023-07-21 20:32:37] [config] lr-warmup-at-reload: false
[2023-07-21 20:32:37] [config] lr-warmup-cycle: false
[2023-07-21 20:32:37] [config] lr-warmup-start-rate: 0
[2023-07-21 20:32:37] [config] max-length: 300
[2023-07-21 20:32:37] [config] max-length-crop: true
[2023-07-21 20:32:37] [config] max-length-factor: 3
[2023-07-21 20:32:37] [config] maxi-batch: 100
[2023-07-21 20:32:37] [config] maxi-batch-sort: trg
[2023-07-21 20:32:37] [config] mini-batch: 64
[2023-07-21 20:32:37] [config] mini-batch-fit: true
[2023-07-21 20:32:37] [config] mini-batch-fit-step: 10
[2023-07-21 20:32:37] [config] mini-batch-round-up: true
[2023-07-21 20:32:37] [config] mini-batch-track-lr: false
[2023-07-21 20:32:37] [config] mini-batch-warmup: 0
[2023-07-21 20:32:37] [config] mini-batch-words: 0
[2023-07-21 20:32:37] [config] mini-batch-words-ref: 0
[2023-07-21 20:32:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 20:32:37] [config] multi-loss-type: sum
[2023-07-21 20:32:37] [config] n-best: false
[2023-07-21 20:32:37] [config] no-nccl: false
[2023-07-21 20:32:37] [config] no-reload: false
[2023-07-21 20:32:37] [config] no-restore-corpus: false
[2023-07-21 20:32:37] [config] normalize: 0
[2023-07-21 20:32:37] [config] normalize-gradient: false
[2023-07-21 20:32:37] [config] num-devices: 0
[2023-07-21 20:32:37] [config] optimizer: adam
[2023-07-21 20:32:37] [config] optimizer-delay: 1
[2023-07-21 20:32:37] [config] optimizer-params:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] output-omit-bias: false
[2023-07-21 20:32:37] [config] overwrite: true
[2023-07-21 20:32:37] [config] precision:
[2023-07-21 20:32:37] [config]   - float16
[2023-07-21 20:32:37] [config]   - float32
[2023-07-21 20:32:37] [config] pretrained-model: ""
[2023-07-21 20:32:37] [config] quantize-biases: false
[2023-07-21 20:32:37] [config] quantize-bits: 0
[2023-07-21 20:32:37] [config] quantize-log-based: false
[2023-07-21 20:32:37] [config] quantize-optimization-steps: 0
[2023-07-21 20:32:37] [config] quiet: false
[2023-07-21 20:32:37] [config] quiet-translation: true
[2023-07-21 20:32:37] [config] relative-paths: false
[2023-07-21 20:32:37] [config] right-left: false
[2023-07-21 20:32:37] [config] save-freq: 10000u
[2023-07-21 20:32:37] [config] seed: 1234
[2023-07-21 20:32:37] [config] sentencepiece-alphas:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] sentencepiece-max-lines: 2000000
[2023-07-21 20:32:37] [config] sentencepiece-options: ""
[2023-07-21 20:32:37] [config] sharding: global
[2023-07-21 20:32:37] [config] shuffle: data
[2023-07-21 20:32:37] [config] shuffle-in-ram: false
[2023-07-21 20:32:37] [config] sigterm: save-and-exit
[2023-07-21 20:32:37] [config] skip: false
[2023-07-21 20:32:37] [config] sqlite: ""
[2023-07-21 20:32:37] [config] sqlite-drop: false
[2023-07-21 20:32:37] [config] sync-freq: 200u
[2023-07-21 20:32:37] [config] sync-sgd: false
[2023-07-21 20:32:37] [config] tempdir: /tmp
[2023-07-21 20:32:37] [config] tied-embeddings: false
[2023-07-21 20:32:37] [config] tied-embeddings-all: true
[2023-07-21 20:32:37] [config] tied-embeddings-src: false
[2023-07-21 20:32:37] [config] train-embedder-rank:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] train-sets:
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 20:32:37] [config] transformer-aan-activation: swish
[2023-07-21 20:32:37] [config] transformer-aan-depth: 2
[2023-07-21 20:32:37] [config] transformer-aan-nogate: false
[2023-07-21 20:32:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 20:32:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 20:32:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 20:32:37] [config] transformer-depth-scaling: false
[2023-07-21 20:32:37] [config] transformer-dim-aan: 2048
[2023-07-21 20:32:37] [config] transformer-dim-ffn: 2048
[2023-07-21 20:32:37] [config] transformer-dropout: 0
[2023-07-21 20:32:37] [config] transformer-dropout-attention: 0
[2023-07-21 20:32:37] [config] transformer-dropout-ffn: 0
[2023-07-21 20:32:37] [config] transformer-ffn-activation: swish
[2023-07-21 20:32:37] [config] transformer-ffn-depth: 2
[2023-07-21 20:32:37] [config] transformer-guided-alignment-layer: last
[2023-07-21 20:32:37] [config] transformer-heads: 8
[2023-07-21 20:32:37] [config] transformer-no-projection: false
[2023-07-21 20:32:37] [config] transformer-pool: false
[2023-07-21 20:32:37] [config] transformer-postprocess: dan
[2023-07-21 20:32:37] [config] transformer-postprocess-emb: d
[2023-07-21 20:32:37] [config] transformer-postprocess-top: ""
[2023-07-21 20:32:37] [config] transformer-preprocess: ""
[2023-07-21 20:32:37] [config] transformer-tied-layers:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] transformer-train-position-embeddings: false
[2023-07-21 20:32:37] [config] tsv: false
[2023-07-21 20:32:37] [config] tsv-fields: 0
[2023-07-21 20:32:37] [config] type: amun
[2023-07-21 20:32:37] [config] ulr: false
[2023-07-21 20:32:37] [config] ulr-dim-emb: 0
[2023-07-21 20:32:37] [config] ulr-dropout: 0
[2023-07-21 20:32:37] [config] ulr-keys-vectors: ""
[2023-07-21 20:32:37] [config] ulr-query-vectors: ""
[2023-07-21 20:32:37] [config] ulr-softmax-temperature: 1
[2023-07-21 20:32:37] [config] ulr-trainable-transformation: false
[2023-07-21 20:32:37] [config] unlikelihood-loss: false
[2023-07-21 20:32:37] [config] valid-freq: 50000000
[2023-07-21 20:32:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 20:32:37] [config] valid-max-length: 1000
[2023-07-21 20:32:37] [config] valid-metrics:
[2023-07-21 20:32:37] [config]   - cross-entropy
[2023-07-21 20:32:37] [config]   - translation
[2023-07-21 20:32:37] [config] valid-mini-batch: 32
[2023-07-21 20:32:37] [config] valid-reset-stalled: false
[2023-07-21 20:32:37] [config] valid-script-args:
[2023-07-21 20:32:37] [config]   []
[2023-07-21 20:32:37] [config] valid-script-path: ""
[2023-07-21 20:32:37] [config] valid-sets:
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 20:32:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 20:32:37] [config] vocabs:
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:32:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:32:37] [config] word-penalty: 0
[2023-07-21 20:32:37] [config] word-scores: false
[2023-07-21 20:32:37] [config] workspace: 5500
[2023-07-21 20:32:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 20:32:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:32:37] [training] Using single-device training
[2023-07-21 20:32:38] Synced seed 1234
[2023-07-21 20:32:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 20:32:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 20:32:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 20:32:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 20:32:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 20:32:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 20:32:38] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 20:32:39] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 20:32:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 20:32:39] [comm] Using global sharding
[2023-07-21 20:32:39] [comm] NCCLCommunicators constructed successfully
[2023-07-21 20:32:39] [training] Using 1 GPUs
[2023-07-21 20:32:39] [logits] Applying loss function for 1 factor(s)
[2023-07-21 20:32:39] [memory] Reserving 80 MB, device gpu0
[2023-07-21 20:32:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 20:32:40] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:36:23] [batching] Done. Typical MB size is 35,811 target words
[2023-07-21 21:36:23] [valid] No post-processing script given for validating translator
[2023-07-21 21:36:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 21:36:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 21:36:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 21:36:23] [comm] Using global sharding
[2023-07-21 21:36:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 21:36:23] [training] Using 1 GPUs
[2023-07-21 21:36:23] Training started
[2023-07-21 21:36:23] [data] Shuffling data
[2023-07-21 21:36:23] [data] Done reading 20,192 sentences
[2023-07-21 21:36:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:36:23] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 21:36:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:36:26] [memory] Reserving 80 MB, device gpu0
[2023-07-21 21:36:34] Parameter type float16, optimization type float32, casting types true
[2023-07-21 21:36:34] Allocating memory for general optimizer shards
[2023-07-21 21:36:34] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:36:34] Allocating memory for Adam-specific shards
[2023-07-21 21:36:34] [memory] Reserving 322 MB, device gpu0
[2023-07-21 21:40:33] Seen 20,192 samples
[2023-07-21 21:40:33] Starting data epoch 2 in logical epoch 2
[2023-07-21 21:40:33] [data] Shuffling data
[2023-07-21 21:40:34] [data] Done reading 20,192 sentences
[2023-07-21 21:40:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:46:10] Seen 20,192 samples
[2023-07-21 21:46:10] Starting data epoch 3 in logical epoch 3
[2023-07-21 21:46:10] [data] Shuffling data
[2023-07-21 21:46:10] [data] Done reading 20,192 sentences
[2023-07-21 21:46:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:51:25] Seen 20,192 samples
[2023-07-21 21:51:25] Starting data epoch 4 in logical epoch 4
[2023-07-21 21:51:25] [data] Shuffling data
[2023-07-21 21:51:25] [data] Done reading 20,192 sentences
[2023-07-21 21:51:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 21:56:22] Seen 20,192 samples
[2023-07-21 21:56:22] Starting data epoch 5 in logical epoch 5
[2023-07-21 21:56:22] [data] Shuffling data
[2023-07-21 21:56:22] [data] Done reading 20,192 sentences
[2023-07-21 21:56:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:01:08] Seen 20,192 samples
[2023-07-21 22:01:08] Starting data epoch 6 in logical epoch 6
[2023-07-21 22:01:08] [data] Shuffling data
[2023-07-21 22:01:08] [data] Done reading 20,192 sentences
[2023-07-21 22:01:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:06:10] Seen 20,192 samples
[2023-07-21 22:06:10] Starting data epoch 7 in logical epoch 7
[2023-07-21 22:06:10] [data] Shuffling data
[2023-07-21 22:06:10] [data] Done reading 20,192 sentences
[2023-07-21 22:06:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:11:22] Seen 20,192 samples
[2023-07-21 22:11:22] Starting data epoch 8 in logical epoch 8
[2023-07-21 22:11:22] [data] Shuffling data
[2023-07-21 22:11:22] [data] Done reading 20,192 sentences
[2023-07-21 22:11:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:16:46] Seen 20,192 samples
[2023-07-21 22:16:46] Starting data epoch 9 in logical epoch 9
[2023-07-21 22:16:46] [data] Shuffling data
[2023-07-21 22:16:46] [data] Done reading 20,192 sentences
[2023-07-21 22:16:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:21:32] Seen 20,192 samples
[2023-07-21 22:21:32] Starting data epoch 10 in logical epoch 10
[2023-07-21 22:21:32] [data] Shuffling data
[2023-07-21 22:21:32] [data] Done reading 20,192 sentences
[2023-07-21 22:21:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 22:26:38] Seen 20,192 samples
[2023-07-21 22:26:38] Starting data epoch 11 in logical epoch 11
[2023-07-21 22:26:38] Training finished
[2023-07-21 22:26:55] [valid] Ep. 11 : Up. 389 : cross-entropy : 186.711 : new best
[2023-07-21 22:30:12] [valid] Ep. 11 : Up. 389 : translation : 0 : new best
[2023-07-21 22:30:12] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 22:30:14] Saving Adam parameters
[2023-07-21 22:30:14] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-21 22:30:21] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:30:21] [marian] Running on node18.datos.cluster.uy as process 18540 with command line:
[2023-07-21 22:30:21] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-21 22:30:21] [config] after: 0e
[2023-07-21 22:30:21] [config] after-batches: 0
[2023-07-21 22:30:21] [config] after-epochs: 20
[2023-07-21 22:30:21] [config] all-caps-every: 0
[2023-07-21 22:30:21] [config] allow-unk: false
[2023-07-21 22:30:21] [config] authors: false
[2023-07-21 22:30:21] [config] beam-size: 12
[2023-07-21 22:30:21] [config] bert-class-symbol: "[CLS]"
[2023-07-21 22:30:21] [config] bert-mask-symbol: "[MASK]"
[2023-07-21 22:30:21] [config] bert-masking-fraction: 0.15
[2023-07-21 22:30:21] [config] bert-sep-symbol: "[SEP]"
[2023-07-21 22:30:21] [config] bert-train-type-embeddings: true
[2023-07-21 22:30:21] [config] bert-type-vocab-size: 2
[2023-07-21 22:30:21] [config] build-info: ""
[2023-07-21 22:30:21] [config] check-gradient-nan: false
[2023-07-21 22:30:21] [config] check-nan: false
[2023-07-21 22:30:21] [config] cite: false
[2023-07-21 22:30:21] [config] clip-norm: 1
[2023-07-21 22:30:21] [config] cost-scaling:
[2023-07-21 22:30:21] [config]   - 256.f
[2023-07-21 22:30:21] [config]   - 1000
[2023-07-21 22:30:21] [config]   - 2.f
[2023-07-21 22:30:21] [config]   - 256.f
[2023-07-21 22:30:21] [config] cost-type: ce-sum
[2023-07-21 22:30:21] [config] cpu-threads: 0
[2023-07-21 22:30:21] [config] data-threads: 8
[2023-07-21 22:30:21] [config] data-weighting: ""
[2023-07-21 22:30:21] [config] data-weighting-type: sentence
[2023-07-21 22:30:21] [config] dec-cell: gru
[2023-07-21 22:30:21] [config] dec-cell-base-depth: 2
[2023-07-21 22:30:21] [config] dec-cell-high-depth: 1
[2023-07-21 22:30:21] [config] dec-depth: 1
[2023-07-21 22:30:21] [config] devices:
[2023-07-21 22:30:21] [config]   - 0
[2023-07-21 22:30:21] [config] dim-emb: 512
[2023-07-21 22:30:21] [config] dim-rnn: 1024
[2023-07-21 22:30:21] [config] dim-vocabs:
[2023-07-21 22:30:21] [config]   - 16384
[2023-07-21 22:30:21] [config]   - 16384
[2023-07-21 22:30:21] [config] disp-first: 0
[2023-07-21 22:30:21] [config] disp-freq: 1000u
[2023-07-21 22:30:21] [config] disp-label-counts: true
[2023-07-21 22:30:21] [config] dropout-rnn: 0
[2023-07-21 22:30:21] [config] dropout-src: 0
[2023-07-21 22:30:21] [config] dropout-trg: 0
[2023-07-21 22:30:21] [config] dump-config: ""
[2023-07-21 22:30:21] [config] dynamic-gradient-scaling:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] early-stopping: 200
[2023-07-21 22:30:21] [config] early-stopping-on: first
[2023-07-21 22:30:21] [config] embedding-fix-src: false
[2023-07-21 22:30:21] [config] embedding-fix-trg: false
[2023-07-21 22:30:21] [config] embedding-normalization: false
[2023-07-21 22:30:21] [config] embedding-vectors:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] enc-cell: gru
[2023-07-21 22:30:21] [config] enc-cell-depth: 1
[2023-07-21 22:30:21] [config] enc-depth: 1
[2023-07-21 22:30:21] [config] enc-type: bidirectional
[2023-07-21 22:30:21] [config] english-title-case-every: 0
[2023-07-21 22:30:21] [config] exponential-smoothing: 0
[2023-07-21 22:30:21] [config] factor-weight: 1
[2023-07-21 22:30:21] [config] factors-combine: sum
[2023-07-21 22:30:21] [config] factors-dim-emb: 0
[2023-07-21 22:30:21] [config] gradient-checkpointing: false
[2023-07-21 22:30:21] [config] gradient-norm-average-window: 100
[2023-07-21 22:30:21] [config] guided-alignment: none
[2023-07-21 22:30:21] [config] guided-alignment-cost: mse
[2023-07-21 22:30:21] [config] guided-alignment-weight: 0.1
[2023-07-21 22:30:21] [config] ignore-model-config: false
[2023-07-21 22:30:21] [config] input-types:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] interpolate-env-vars: false
[2023-07-21 22:30:21] [config] keep-best: false
[2023-07-21 22:30:21] [config] label-smoothing: 0
[2023-07-21 22:30:21] [config] layer-normalization: false
[2023-07-21 22:30:21] [config] learn-rate: 0.0001
[2023-07-21 22:30:21] [config] lemma-dependency: ""
[2023-07-21 22:30:21] [config] lemma-dim-emb: 0
[2023-07-21 22:30:21] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 22:30:21] [config] log-level: info
[2023-07-21 22:30:21] [config] log-time-zone: ""
[2023-07-21 22:30:21] [config] logical-epoch:
[2023-07-21 22:30:21] [config]   - 1e
[2023-07-21 22:30:21] [config]   - 0
[2023-07-21 22:30:21] [config] lr-decay: 0
[2023-07-21 22:30:21] [config] lr-decay-freq: 50000
[2023-07-21 22:30:21] [config] lr-decay-inv-sqrt:
[2023-07-21 22:30:21] [config]   - 0
[2023-07-21 22:30:21] [config] lr-decay-repeat-warmup: false
[2023-07-21 22:30:21] [config] lr-decay-reset-optimizer: false
[2023-07-21 22:30:21] [config] lr-decay-start:
[2023-07-21 22:30:21] [config]   - 10
[2023-07-21 22:30:21] [config]   - 1
[2023-07-21 22:30:21] [config] lr-decay-strategy: epoch+stalled
[2023-07-21 22:30:21] [config] lr-report: false
[2023-07-21 22:30:21] [config] lr-warmup: 0
[2023-07-21 22:30:21] [config] lr-warmup-at-reload: false
[2023-07-21 22:30:21] [config] lr-warmup-cycle: false
[2023-07-21 22:30:21] [config] lr-warmup-start-rate: 0
[2023-07-21 22:30:21] [config] max-length: 300
[2023-07-21 22:30:21] [config] max-length-crop: true
[2023-07-21 22:30:21] [config] max-length-factor: 3
[2023-07-21 22:30:21] [config] maxi-batch: 100
[2023-07-21 22:30:21] [config] maxi-batch-sort: trg
[2023-07-21 22:30:21] [config] mini-batch: 64
[2023-07-21 22:30:21] [config] mini-batch-fit: true
[2023-07-21 22:30:21] [config] mini-batch-fit-step: 10
[2023-07-21 22:30:21] [config] mini-batch-round-up: true
[2023-07-21 22:30:21] [config] mini-batch-track-lr: false
[2023-07-21 22:30:21] [config] mini-batch-warmup: 0
[2023-07-21 22:30:21] [config] mini-batch-words: 0
[2023-07-21 22:30:21] [config] mini-batch-words-ref: 0
[2023-07-21 22:30:21] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 22:30:21] [config] multi-loss-type: sum
[2023-07-21 22:30:21] [config] n-best: false
[2023-07-21 22:30:21] [config] no-nccl: false
[2023-07-21 22:30:21] [config] no-reload: false
[2023-07-21 22:30:21] [config] no-restore-corpus: false
[2023-07-21 22:30:21] [config] normalize: 0
[2023-07-21 22:30:21] [config] normalize-gradient: false
[2023-07-21 22:30:21] [config] num-devices: 0
[2023-07-21 22:30:21] [config] optimizer: adam
[2023-07-21 22:30:21] [config] optimizer-delay: 1
[2023-07-21 22:30:21] [config] optimizer-params:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] output-omit-bias: false
[2023-07-21 22:30:21] [config] overwrite: true
[2023-07-21 22:30:21] [config] precision:
[2023-07-21 22:30:21] [config]   - float16
[2023-07-21 22:30:21] [config]   - float32
[2023-07-21 22:30:21] [config] pretrained-model: ""
[2023-07-21 22:30:21] [config] quantize-biases: false
[2023-07-21 22:30:21] [config] quantize-bits: 0
[2023-07-21 22:30:21] [config] quantize-log-based: false
[2023-07-21 22:30:21] [config] quantize-optimization-steps: 0
[2023-07-21 22:30:21] [config] quiet: false
[2023-07-21 22:30:21] [config] quiet-translation: true
[2023-07-21 22:30:21] [config] relative-paths: false
[2023-07-21 22:30:21] [config] right-left: false
[2023-07-21 22:30:21] [config] save-freq: 10000u
[2023-07-21 22:30:21] [config] seed: 1234
[2023-07-21 22:30:21] [config] sentencepiece-alphas:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] sentencepiece-max-lines: 2000000
[2023-07-21 22:30:21] [config] sentencepiece-options: ""
[2023-07-21 22:30:21] [config] sharding: global
[2023-07-21 22:30:21] [config] shuffle: data
[2023-07-21 22:30:21] [config] shuffle-in-ram: false
[2023-07-21 22:30:21] [config] sigterm: save-and-exit
[2023-07-21 22:30:21] [config] skip: false
[2023-07-21 22:30:21] [config] sqlite: ""
[2023-07-21 22:30:21] [config] sqlite-drop: false
[2023-07-21 22:30:21] [config] sync-freq: 200u
[2023-07-21 22:30:21] [config] sync-sgd: false
[2023-07-21 22:30:21] [config] tempdir: /tmp
[2023-07-21 22:30:21] [config] tied-embeddings: false
[2023-07-21 22:30:21] [config] tied-embeddings-all: true
[2023-07-21 22:30:21] [config] tied-embeddings-src: false
[2023-07-21 22:30:21] [config] train-embedder-rank:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] train-sets:
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-21 22:30:21] [config] transformer-aan-activation: swish
[2023-07-21 22:30:21] [config] transformer-aan-depth: 2
[2023-07-21 22:30:21] [config] transformer-aan-nogate: false
[2023-07-21 22:30:21] [config] transformer-decoder-autoreg: self-attention
[2023-07-21 22:30:21] [config] transformer-decoder-dim-ffn: 0
[2023-07-21 22:30:21] [config] transformer-decoder-ffn-depth: 0
[2023-07-21 22:30:21] [config] transformer-depth-scaling: false
[2023-07-21 22:30:21] [config] transformer-dim-aan: 2048
[2023-07-21 22:30:21] [config] transformer-dim-ffn: 2048
[2023-07-21 22:30:21] [config] transformer-dropout: 0
[2023-07-21 22:30:21] [config] transformer-dropout-attention: 0
[2023-07-21 22:30:21] [config] transformer-dropout-ffn: 0
[2023-07-21 22:30:21] [config] transformer-ffn-activation: swish
[2023-07-21 22:30:21] [config] transformer-ffn-depth: 2
[2023-07-21 22:30:21] [config] transformer-guided-alignment-layer: last
[2023-07-21 22:30:21] [config] transformer-heads: 8
[2023-07-21 22:30:21] [config] transformer-no-projection: false
[2023-07-21 22:30:21] [config] transformer-pool: false
[2023-07-21 22:30:21] [config] transformer-postprocess: dan
[2023-07-21 22:30:21] [config] transformer-postprocess-emb: d
[2023-07-21 22:30:21] [config] transformer-postprocess-top: ""
[2023-07-21 22:30:21] [config] transformer-preprocess: ""
[2023-07-21 22:30:21] [config] transformer-tied-layers:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] transformer-train-position-embeddings: false
[2023-07-21 22:30:21] [config] tsv: false
[2023-07-21 22:30:21] [config] tsv-fields: 0
[2023-07-21 22:30:21] [config] type: amun
[2023-07-21 22:30:21] [config] ulr: false
[2023-07-21 22:30:21] [config] ulr-dim-emb: 0
[2023-07-21 22:30:21] [config] ulr-dropout: 0
[2023-07-21 22:30:21] [config] ulr-keys-vectors: ""
[2023-07-21 22:30:21] [config] ulr-query-vectors: ""
[2023-07-21 22:30:21] [config] ulr-softmax-temperature: 1
[2023-07-21 22:30:21] [config] ulr-trainable-transformation: false
[2023-07-21 22:30:21] [config] unlikelihood-loss: false
[2023-07-21 22:30:21] [config] valid-freq: 50000000
[2023-07-21 22:30:21] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-21 22:30:21] [config] valid-max-length: 1000
[2023-07-21 22:30:21] [config] valid-metrics:
[2023-07-21 22:30:21] [config]   - cross-entropy
[2023-07-21 22:30:21] [config]   - translation
[2023-07-21 22:30:21] [config] valid-mini-batch: 32
[2023-07-21 22:30:21] [config] valid-reset-stalled: false
[2023-07-21 22:30:21] [config] valid-script-args:
[2023-07-21 22:30:21] [config]   []
[2023-07-21 22:30:21] [config] valid-script-path: ""
[2023-07-21 22:30:21] [config] valid-sets:
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-21 22:30:21] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-21 22:30:21] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:30:21] [config] vocabs:
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:30:21] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:30:21] [config] word-penalty: 0
[2023-07-21 22:30:21] [config] word-scores: false
[2023-07-21 22:30:21] [config] workspace: 5500
[2023-07-21 22:30:21] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-21 22:30:21] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:30:21] [training] Using single-device training
[2023-07-21 22:30:21] Synced seed 1234
[2023-07-21 22:30:21] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-21 22:30:22] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-21 22:30:22] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-21 22:30:22] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-21 22:30:22] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-21 22:30:22] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 22:30:22] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-21 22:30:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 22:30:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 22:30:23] [comm] Using global sharding
[2023-07-21 22:30:23] [comm] NCCLCommunicators constructed successfully
[2023-07-21 22:30:23] [training] Using 1 GPUs
[2023-07-21 22:30:23] [logits] Applying loss function for 1 factor(s)
[2023-07-21 22:30:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 22:30:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-21 22:30:23] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:34:25] [batching] Done. Typical MB size is 35,811 target words
[2023-07-21 23:34:25] [valid] No post-processing script given for validating translator
[2023-07-21 23:34:25] [MPI rank 0 out of 1]: GPU[0]
[2023-07-21 23:34:25] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-21 23:34:25] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-21 23:34:25] [comm] Using global sharding
[2023-07-21 23:34:25] [comm] NCCLCommunicators constructed successfully
[2023-07-21 23:34:25] [training] Using 1 GPUs
[2023-07-21 23:34:25] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-21 23:34:31] Allocating memory for general optimizer shards
[2023-07-21 23:34:31] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:34:31] Loading Adam parameters
[2023-07-21 23:34:31] [memory] Reserving 322 MB, device gpu0
[2023-07-21 23:34:31] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:34:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-21 23:34:31] [data] Restoring the corpus state to epoch 11, batch 389
[2023-07-21 23:34:31] [data] Shuffling data
[2023-07-21 23:34:31] [data] Done reading 20,192 sentences
[2023-07-21 23:34:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:34:31] Training started
[2023-07-21 23:34:32] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-21 23:34:32] [memory] Reserving 80 MB, device gpu0
[2023-07-21 23:34:36] Parameter type float16, optimization type float32, casting types true
[2023-07-21 23:39:05] Seen 20,192 samples
[2023-07-21 23:39:05] Starting data epoch 12 in logical epoch 12
[2023-07-21 23:39:05] [data] Shuffling data
[2023-07-21 23:39:05] [data] Done reading 20,192 sentences
[2023-07-21 23:39:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:44:20] Seen 20,192 samples
[2023-07-21 23:44:20] Starting data epoch 13 in logical epoch 13
[2023-07-21 23:44:20] [data] Shuffling data
[2023-07-21 23:44:20] [data] Done reading 20,192 sentences
[2023-07-21 23:44:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:49:15] Seen 20,192 samples
[2023-07-21 23:49:15] Starting data epoch 14 in logical epoch 14
[2023-07-21 23:49:15] [data] Shuffling data
[2023-07-21 23:49:15] [data] Done reading 20,192 sentences
[2023-07-21 23:49:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:54:22] Seen 20,192 samples
[2023-07-21 23:54:22] Starting data epoch 15 in logical epoch 15
[2023-07-21 23:54:22] [data] Shuffling data
[2023-07-21 23:54:22] [data] Done reading 20,192 sentences
[2023-07-21 23:54:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-21 23:59:31] Seen 20,192 samples
[2023-07-21 23:59:31] Starting data epoch 16 in logical epoch 16
[2023-07-21 23:59:31] [data] Shuffling data
[2023-07-21 23:59:31] [data] Done reading 20,192 sentences
[2023-07-21 23:59:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:04:43] Seen 20,192 samples
[2023-07-22 00:04:43] Starting data epoch 17 in logical epoch 17
[2023-07-22 00:04:43] [data] Shuffling data
[2023-07-22 00:04:43] [data] Done reading 20,192 sentences
[2023-07-22 00:04:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:10:01] Seen 20,192 samples
[2023-07-22 00:10:01] Starting data epoch 18 in logical epoch 18
[2023-07-22 00:10:01] [data] Shuffling data
[2023-07-22 00:10:01] [data] Done reading 20,192 sentences
[2023-07-22 00:10:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:15:20] Seen 20,192 samples
[2023-07-22 00:15:20] Starting data epoch 19 in logical epoch 19
[2023-07-22 00:15:20] [data] Shuffling data
[2023-07-22 00:15:20] [data] Done reading 20,192 sentences
[2023-07-22 00:15:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:20:34] Seen 20,192 samples
[2023-07-22 00:20:34] Starting data epoch 20 in logical epoch 20
[2023-07-22 00:20:34] [data] Shuffling data
[2023-07-22 00:20:34] [data] Done reading 20,192 sentences
[2023-07-22 00:20:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 00:25:45] Seen 20,192 samples
[2023-07-22 00:25:45] Starting data epoch 21 in logical epoch 21
[2023-07-22 00:25:45] Training finished
[2023-07-22 00:25:57] [valid] Ep. 21 : Up. 776 : cross-entropy : 173.424 : new best
[2023-07-22 00:30:29] [valid] Ep. 21 : Up. 776 : translation : 0 : new best
[2023-07-22 00:30:29] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 00:30:32] Saving Adam parameters
[2023-07-22 00:30:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 00:30:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:30:40] [marian] Running on node18.datos.cluster.uy as process 26358 with command line:
[2023-07-22 00:30:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 00:30:40] [config] after: 0e
[2023-07-22 00:30:40] [config] after-batches: 0
[2023-07-22 00:30:40] [config] after-epochs: 30
[2023-07-22 00:30:40] [config] all-caps-every: 0
[2023-07-22 00:30:40] [config] allow-unk: false
[2023-07-22 00:30:40] [config] authors: false
[2023-07-22 00:30:40] [config] beam-size: 12
[2023-07-22 00:30:40] [config] bert-class-symbol: "[CLS]"
[2023-07-22 00:30:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 00:30:40] [config] bert-masking-fraction: 0.15
[2023-07-22 00:30:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 00:30:40] [config] bert-train-type-embeddings: true
[2023-07-22 00:30:40] [config] bert-type-vocab-size: 2
[2023-07-22 00:30:40] [config] build-info: ""
[2023-07-22 00:30:40] [config] check-gradient-nan: false
[2023-07-22 00:30:40] [config] check-nan: false
[2023-07-22 00:30:40] [config] cite: false
[2023-07-22 00:30:40] [config] clip-norm: 1
[2023-07-22 00:30:40] [config] cost-scaling:
[2023-07-22 00:30:40] [config]   - 256.f
[2023-07-22 00:30:40] [config]   - 1000
[2023-07-22 00:30:40] [config]   - 2.f
[2023-07-22 00:30:40] [config]   - 256.f
[2023-07-22 00:30:40] [config] cost-type: ce-sum
[2023-07-22 00:30:40] [config] cpu-threads: 0
[2023-07-22 00:30:40] [config] data-threads: 8
[2023-07-22 00:30:40] [config] data-weighting: ""
[2023-07-22 00:30:40] [config] data-weighting-type: sentence
[2023-07-22 00:30:40] [config] dec-cell: gru
[2023-07-22 00:30:40] [config] dec-cell-base-depth: 2
[2023-07-22 00:30:40] [config] dec-cell-high-depth: 1
[2023-07-22 00:30:40] [config] dec-depth: 1
[2023-07-22 00:30:40] [config] devices:
[2023-07-22 00:30:40] [config]   - 0
[2023-07-22 00:30:40] [config] dim-emb: 512
[2023-07-22 00:30:40] [config] dim-rnn: 1024
[2023-07-22 00:30:40] [config] dim-vocabs:
[2023-07-22 00:30:40] [config]   - 16384
[2023-07-22 00:30:40] [config]   - 16384
[2023-07-22 00:30:40] [config] disp-first: 0
[2023-07-22 00:30:40] [config] disp-freq: 1000u
[2023-07-22 00:30:40] [config] disp-label-counts: true
[2023-07-22 00:30:40] [config] dropout-rnn: 0
[2023-07-22 00:30:40] [config] dropout-src: 0
[2023-07-22 00:30:40] [config] dropout-trg: 0
[2023-07-22 00:30:40] [config] dump-config: ""
[2023-07-22 00:30:40] [config] dynamic-gradient-scaling:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] early-stopping: 200
[2023-07-22 00:30:40] [config] early-stopping-on: first
[2023-07-22 00:30:40] [config] embedding-fix-src: false
[2023-07-22 00:30:40] [config] embedding-fix-trg: false
[2023-07-22 00:30:40] [config] embedding-normalization: false
[2023-07-22 00:30:40] [config] embedding-vectors:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] enc-cell: gru
[2023-07-22 00:30:40] [config] enc-cell-depth: 1
[2023-07-22 00:30:40] [config] enc-depth: 1
[2023-07-22 00:30:40] [config] enc-type: bidirectional
[2023-07-22 00:30:40] [config] english-title-case-every: 0
[2023-07-22 00:30:40] [config] exponential-smoothing: 0
[2023-07-22 00:30:40] [config] factor-weight: 1
[2023-07-22 00:30:40] [config] factors-combine: sum
[2023-07-22 00:30:40] [config] factors-dim-emb: 0
[2023-07-22 00:30:40] [config] gradient-checkpointing: false
[2023-07-22 00:30:40] [config] gradient-norm-average-window: 100
[2023-07-22 00:30:40] [config] guided-alignment: none
[2023-07-22 00:30:40] [config] guided-alignment-cost: mse
[2023-07-22 00:30:40] [config] guided-alignment-weight: 0.1
[2023-07-22 00:30:40] [config] ignore-model-config: false
[2023-07-22 00:30:40] [config] input-types:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] interpolate-env-vars: false
[2023-07-22 00:30:40] [config] keep-best: false
[2023-07-22 00:30:40] [config] label-smoothing: 0
[2023-07-22 00:30:40] [config] layer-normalization: false
[2023-07-22 00:30:40] [config] learn-rate: 0.0001
[2023-07-22 00:30:40] [config] lemma-dependency: ""
[2023-07-22 00:30:40] [config] lemma-dim-emb: 0
[2023-07-22 00:30:40] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 00:30:40] [config] log-level: info
[2023-07-22 00:30:40] [config] log-time-zone: ""
[2023-07-22 00:30:40] [config] logical-epoch:
[2023-07-22 00:30:40] [config]   - 1e
[2023-07-22 00:30:40] [config]   - 0
[2023-07-22 00:30:40] [config] lr-decay: 0
[2023-07-22 00:30:40] [config] lr-decay-freq: 50000
[2023-07-22 00:30:40] [config] lr-decay-inv-sqrt:
[2023-07-22 00:30:40] [config]   - 0
[2023-07-22 00:30:40] [config] lr-decay-repeat-warmup: false
[2023-07-22 00:30:40] [config] lr-decay-reset-optimizer: false
[2023-07-22 00:30:40] [config] lr-decay-start:
[2023-07-22 00:30:40] [config]   - 10
[2023-07-22 00:30:40] [config]   - 1
[2023-07-22 00:30:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 00:30:40] [config] lr-report: false
[2023-07-22 00:30:40] [config] lr-warmup: 0
[2023-07-22 00:30:40] [config] lr-warmup-at-reload: false
[2023-07-22 00:30:40] [config] lr-warmup-cycle: false
[2023-07-22 00:30:40] [config] lr-warmup-start-rate: 0
[2023-07-22 00:30:40] [config] max-length: 300
[2023-07-22 00:30:40] [config] max-length-crop: true
[2023-07-22 00:30:40] [config] max-length-factor: 3
[2023-07-22 00:30:40] [config] maxi-batch: 100
[2023-07-22 00:30:40] [config] maxi-batch-sort: trg
[2023-07-22 00:30:40] [config] mini-batch: 64
[2023-07-22 00:30:40] [config] mini-batch-fit: true
[2023-07-22 00:30:40] [config] mini-batch-fit-step: 10
[2023-07-22 00:30:40] [config] mini-batch-round-up: true
[2023-07-22 00:30:40] [config] mini-batch-track-lr: false
[2023-07-22 00:30:40] [config] mini-batch-warmup: 0
[2023-07-22 00:30:40] [config] mini-batch-words: 0
[2023-07-22 00:30:40] [config] mini-batch-words-ref: 0
[2023-07-22 00:30:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 00:30:40] [config] multi-loss-type: sum
[2023-07-22 00:30:40] [config] n-best: false
[2023-07-22 00:30:40] [config] no-nccl: false
[2023-07-22 00:30:40] [config] no-reload: false
[2023-07-22 00:30:40] [config] no-restore-corpus: false
[2023-07-22 00:30:40] [config] normalize: 0
[2023-07-22 00:30:40] [config] normalize-gradient: false
[2023-07-22 00:30:40] [config] num-devices: 0
[2023-07-22 00:30:40] [config] optimizer: adam
[2023-07-22 00:30:40] [config] optimizer-delay: 1
[2023-07-22 00:30:40] [config] optimizer-params:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] output-omit-bias: false
[2023-07-22 00:30:40] [config] overwrite: true
[2023-07-22 00:30:40] [config] precision:
[2023-07-22 00:30:40] [config]   - float16
[2023-07-22 00:30:40] [config]   - float32
[2023-07-22 00:30:40] [config] pretrained-model: ""
[2023-07-22 00:30:40] [config] quantize-biases: false
[2023-07-22 00:30:40] [config] quantize-bits: 0
[2023-07-22 00:30:40] [config] quantize-log-based: false
[2023-07-22 00:30:40] [config] quantize-optimization-steps: 0
[2023-07-22 00:30:40] [config] quiet: false
[2023-07-22 00:30:40] [config] quiet-translation: true
[2023-07-22 00:30:40] [config] relative-paths: false
[2023-07-22 00:30:40] [config] right-left: false
[2023-07-22 00:30:40] [config] save-freq: 10000u
[2023-07-22 00:30:40] [config] seed: 1234
[2023-07-22 00:30:40] [config] sentencepiece-alphas:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] sentencepiece-max-lines: 2000000
[2023-07-22 00:30:40] [config] sentencepiece-options: ""
[2023-07-22 00:30:40] [config] sharding: global
[2023-07-22 00:30:40] [config] shuffle: data
[2023-07-22 00:30:40] [config] shuffle-in-ram: false
[2023-07-22 00:30:40] [config] sigterm: save-and-exit
[2023-07-22 00:30:40] [config] skip: false
[2023-07-22 00:30:40] [config] sqlite: ""
[2023-07-22 00:30:40] [config] sqlite-drop: false
[2023-07-22 00:30:40] [config] sync-freq: 200u
[2023-07-22 00:30:40] [config] sync-sgd: false
[2023-07-22 00:30:40] [config] tempdir: /tmp
[2023-07-22 00:30:40] [config] tied-embeddings: false
[2023-07-22 00:30:40] [config] tied-embeddings-all: true
[2023-07-22 00:30:40] [config] tied-embeddings-src: false
[2023-07-22 00:30:40] [config] train-embedder-rank:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] train-sets:
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 00:30:40] [config] transformer-aan-activation: swish
[2023-07-22 00:30:40] [config] transformer-aan-depth: 2
[2023-07-22 00:30:40] [config] transformer-aan-nogate: false
[2023-07-22 00:30:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 00:30:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 00:30:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 00:30:40] [config] transformer-depth-scaling: false
[2023-07-22 00:30:40] [config] transformer-dim-aan: 2048
[2023-07-22 00:30:40] [config] transformer-dim-ffn: 2048
[2023-07-22 00:30:40] [config] transformer-dropout: 0
[2023-07-22 00:30:40] [config] transformer-dropout-attention: 0
[2023-07-22 00:30:40] [config] transformer-dropout-ffn: 0
[2023-07-22 00:30:40] [config] transformer-ffn-activation: swish
[2023-07-22 00:30:40] [config] transformer-ffn-depth: 2
[2023-07-22 00:30:40] [config] transformer-guided-alignment-layer: last
[2023-07-22 00:30:40] [config] transformer-heads: 8
[2023-07-22 00:30:40] [config] transformer-no-projection: false
[2023-07-22 00:30:40] [config] transformer-pool: false
[2023-07-22 00:30:40] [config] transformer-postprocess: dan
[2023-07-22 00:30:40] [config] transformer-postprocess-emb: d
[2023-07-22 00:30:40] [config] transformer-postprocess-top: ""
[2023-07-22 00:30:40] [config] transformer-preprocess: ""
[2023-07-22 00:30:40] [config] transformer-tied-layers:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] transformer-train-position-embeddings: false
[2023-07-22 00:30:40] [config] tsv: false
[2023-07-22 00:30:40] [config] tsv-fields: 0
[2023-07-22 00:30:40] [config] type: amun
[2023-07-22 00:30:40] [config] ulr: false
[2023-07-22 00:30:40] [config] ulr-dim-emb: 0
[2023-07-22 00:30:40] [config] ulr-dropout: 0
[2023-07-22 00:30:40] [config] ulr-keys-vectors: ""
[2023-07-22 00:30:40] [config] ulr-query-vectors: ""
[2023-07-22 00:30:40] [config] ulr-softmax-temperature: 1
[2023-07-22 00:30:40] [config] ulr-trainable-transformation: false
[2023-07-22 00:30:40] [config] unlikelihood-loss: false
[2023-07-22 00:30:40] [config] valid-freq: 50000000
[2023-07-22 00:30:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 00:30:40] [config] valid-max-length: 1000
[2023-07-22 00:30:40] [config] valid-metrics:
[2023-07-22 00:30:40] [config]   - cross-entropy
[2023-07-22 00:30:40] [config]   - translation
[2023-07-22 00:30:40] [config] valid-mini-batch: 32
[2023-07-22 00:30:40] [config] valid-reset-stalled: false
[2023-07-22 00:30:40] [config] valid-script-args:
[2023-07-22 00:30:40] [config]   []
[2023-07-22 00:30:40] [config] valid-script-path: ""
[2023-07-22 00:30:40] [config] valid-sets:
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 00:30:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 00:30:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:30:40] [config] vocabs:
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 00:30:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 00:30:40] [config] word-penalty: 0
[2023-07-22 00:30:40] [config] word-scores: false
[2023-07-22 00:30:40] [config] workspace: 5500
[2023-07-22 00:30:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 00:30:40] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:30:40] [training] Using single-device training
[2023-07-22 00:30:40] Synced seed 1234
[2023-07-22 00:30:40] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 00:30:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 00:30:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 00:30:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 00:30:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 00:30:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 00:30:41] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 00:30:42] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 00:30:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 00:30:42] [comm] Using global sharding
[2023-07-22 00:30:42] [comm] NCCLCommunicators constructed successfully
[2023-07-22 00:30:42] [training] Using 1 GPUs
[2023-07-22 00:30:42] [logits] Applying loss function for 1 factor(s)
[2023-07-22 00:30:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 00:30:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 00:30:42] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:00] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 01:34:00] [valid] No post-processing script given for validating translator
[2023-07-22 01:34:01] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 01:34:01] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 01:34:01] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 01:34:01] [comm] Using global sharding
[2023-07-22 01:34:01] [comm] NCCLCommunicators constructed successfully
[2023-07-22 01:34:01] [training] Using 1 GPUs
[2023-07-22 01:34:01] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 01:34:09] Allocating memory for general optimizer shards
[2023-07-22 01:34:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:34:09] Loading Adam parameters
[2023-07-22 01:34:09] [memory] Reserving 322 MB, device gpu0
[2023-07-22 01:34:09] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:09] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 01:34:09] [data] Restoring the corpus state to epoch 21, batch 776
[2023-07-22 01:34:09] [data] Shuffling data
[2023-07-22 01:34:09] [data] Done reading 20,192 sentences
[2023-07-22 01:34:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:34:09] Training started
[2023-07-22 01:34:09] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 01:34:10] [memory] Reserving 80 MB, device gpu0
[2023-07-22 01:34:19] Parameter type float16, optimization type float32, casting types true
[2023-07-22 01:39:08] Seen 20,192 samples
[2023-07-22 01:39:08] Starting data epoch 22 in logical epoch 22
[2023-07-22 01:39:08] [data] Shuffling data
[2023-07-22 01:39:08] [data] Done reading 20,192 sentences
[2023-07-22 01:39:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:44:27] Seen 20,192 samples
[2023-07-22 01:44:27] Starting data epoch 23 in logical epoch 23
[2023-07-22 01:44:27] [data] Shuffling data
[2023-07-22 01:44:27] [data] Done reading 20,192 sentences
[2023-07-22 01:44:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:50:02] Seen 20,192 samples
[2023-07-22 01:50:02] Starting data epoch 24 in logical epoch 24
[2023-07-22 01:50:02] [data] Shuffling data
[2023-07-22 01:50:02] [data] Done reading 20,192 sentences
[2023-07-22 01:50:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 01:55:24] Seen 20,192 samples
[2023-07-22 01:55:24] Starting data epoch 25 in logical epoch 25
[2023-07-22 01:55:24] [data] Shuffling data
[2023-07-22 01:55:24] [data] Done reading 20,192 sentences
[2023-07-22 01:55:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:00:44] Seen 20,192 samples
[2023-07-22 02:00:44] Starting data epoch 26 in logical epoch 26
[2023-07-22 02:00:44] [data] Shuffling data
[2023-07-22 02:00:44] [data] Done reading 20,192 sentences
[2023-07-22 02:00:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:04:28] Ep. 26 : Up. 1000 : Sen. 13,971 : Cost 6.31807470 * 15,941,837 @ 17,481 after 15,941,837 : Time 1828.31s : 8719.42 words/s : gNorm 1.0954
[2023-07-22 02:06:23] Seen 20,192 samples
[2023-07-22 02:06:23] Starting data epoch 27 in logical epoch 27
[2023-07-22 02:06:23] [data] Shuffling data
[2023-07-22 02:06:23] [data] Done reading 20,192 sentences
[2023-07-22 02:06:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:11:51] Seen 20,192 samples
[2023-07-22 02:11:51] Starting data epoch 28 in logical epoch 28
[2023-07-22 02:11:51] [data] Shuffling data
[2023-07-22 02:11:51] [data] Done reading 20,192 sentences
[2023-07-22 02:11:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:17:17] Seen 20,192 samples
[2023-07-22 02:17:17] Starting data epoch 29 in logical epoch 29
[2023-07-22 02:17:17] [data] Shuffling data
[2023-07-22 02:17:17] [data] Done reading 20,192 sentences
[2023-07-22 02:17:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:22:25] Seen 20,192 samples
[2023-07-22 02:22:25] Starting data epoch 30 in logical epoch 30
[2023-07-22 02:22:25] [data] Shuffling data
[2023-07-22 02:22:25] [data] Done reading 20,192 sentences
[2023-07-22 02:22:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 02:27:52] Seen 20,192 samples
[2023-07-22 02:27:52] Starting data epoch 31 in logical epoch 31
[2023-07-22 02:27:52] Training finished
[2023-07-22 02:28:05] [valid] Ep. 31 : Up. 1171 : cross-entropy : 161.181 : new best
[2023-07-22 02:30:33] [valid] Ep. 31 : Up. 1171 : translation : 0 : new best
[2023-07-22 02:30:33] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 02:30:35] Saving Adam parameters
[2023-07-22 02:30:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 02:30:44] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:30:44] [marian] Running on node18.datos.cluster.uy as process 34156 with command line:
[2023-07-22 02:30:44] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 02:30:44] [config] after: 0e
[2023-07-22 02:30:44] [config] after-batches: 0
[2023-07-22 02:30:44] [config] after-epochs: 40
[2023-07-22 02:30:44] [config] all-caps-every: 0
[2023-07-22 02:30:44] [config] allow-unk: false
[2023-07-22 02:30:44] [config] authors: false
[2023-07-22 02:30:44] [config] beam-size: 12
[2023-07-22 02:30:44] [config] bert-class-symbol: "[CLS]"
[2023-07-22 02:30:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 02:30:44] [config] bert-masking-fraction: 0.15
[2023-07-22 02:30:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 02:30:44] [config] bert-train-type-embeddings: true
[2023-07-22 02:30:44] [config] bert-type-vocab-size: 2
[2023-07-22 02:30:44] [config] build-info: ""
[2023-07-22 02:30:44] [config] check-gradient-nan: false
[2023-07-22 02:30:44] [config] check-nan: false
[2023-07-22 02:30:44] [config] cite: false
[2023-07-22 02:30:44] [config] clip-norm: 1
[2023-07-22 02:30:44] [config] cost-scaling:
[2023-07-22 02:30:44] [config]   - 256.f
[2023-07-22 02:30:44] [config]   - 1000
[2023-07-22 02:30:44] [config]   - 2.f
[2023-07-22 02:30:44] [config]   - 256.f
[2023-07-22 02:30:44] [config] cost-type: ce-sum
[2023-07-22 02:30:44] [config] cpu-threads: 0
[2023-07-22 02:30:44] [config] data-threads: 8
[2023-07-22 02:30:44] [config] data-weighting: ""
[2023-07-22 02:30:44] [config] data-weighting-type: sentence
[2023-07-22 02:30:44] [config] dec-cell: gru
[2023-07-22 02:30:44] [config] dec-cell-base-depth: 2
[2023-07-22 02:30:44] [config] dec-cell-high-depth: 1
[2023-07-22 02:30:44] [config] dec-depth: 1
[2023-07-22 02:30:44] [config] devices:
[2023-07-22 02:30:44] [config]   - 0
[2023-07-22 02:30:44] [config] dim-emb: 512
[2023-07-22 02:30:44] [config] dim-rnn: 1024
[2023-07-22 02:30:44] [config] dim-vocabs:
[2023-07-22 02:30:44] [config]   - 16384
[2023-07-22 02:30:44] [config]   - 16384
[2023-07-22 02:30:44] [config] disp-first: 0
[2023-07-22 02:30:44] [config] disp-freq: 1000u
[2023-07-22 02:30:44] [config] disp-label-counts: true
[2023-07-22 02:30:44] [config] dropout-rnn: 0
[2023-07-22 02:30:44] [config] dropout-src: 0
[2023-07-22 02:30:44] [config] dropout-trg: 0
[2023-07-22 02:30:44] [config] dump-config: ""
[2023-07-22 02:30:44] [config] dynamic-gradient-scaling:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] early-stopping: 200
[2023-07-22 02:30:44] [config] early-stopping-on: first
[2023-07-22 02:30:44] [config] embedding-fix-src: false
[2023-07-22 02:30:44] [config] embedding-fix-trg: false
[2023-07-22 02:30:44] [config] embedding-normalization: false
[2023-07-22 02:30:44] [config] embedding-vectors:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] enc-cell: gru
[2023-07-22 02:30:44] [config] enc-cell-depth: 1
[2023-07-22 02:30:44] [config] enc-depth: 1
[2023-07-22 02:30:44] [config] enc-type: bidirectional
[2023-07-22 02:30:44] [config] english-title-case-every: 0
[2023-07-22 02:30:44] [config] exponential-smoothing: 0
[2023-07-22 02:30:44] [config] factor-weight: 1
[2023-07-22 02:30:44] [config] factors-combine: sum
[2023-07-22 02:30:44] [config] factors-dim-emb: 0
[2023-07-22 02:30:44] [config] gradient-checkpointing: false
[2023-07-22 02:30:44] [config] gradient-norm-average-window: 100
[2023-07-22 02:30:44] [config] guided-alignment: none
[2023-07-22 02:30:44] [config] guided-alignment-cost: mse
[2023-07-22 02:30:44] [config] guided-alignment-weight: 0.1
[2023-07-22 02:30:44] [config] ignore-model-config: false
[2023-07-22 02:30:44] [config] input-types:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] interpolate-env-vars: false
[2023-07-22 02:30:44] [config] keep-best: false
[2023-07-22 02:30:44] [config] label-smoothing: 0
[2023-07-22 02:30:44] [config] layer-normalization: false
[2023-07-22 02:30:44] [config] learn-rate: 0.0001
[2023-07-22 02:30:44] [config] lemma-dependency: ""
[2023-07-22 02:30:44] [config] lemma-dim-emb: 0
[2023-07-22 02:30:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 02:30:44] [config] log-level: info
[2023-07-22 02:30:44] [config] log-time-zone: ""
[2023-07-22 02:30:44] [config] logical-epoch:
[2023-07-22 02:30:44] [config]   - 1e
[2023-07-22 02:30:44] [config]   - 0
[2023-07-22 02:30:44] [config] lr-decay: 0
[2023-07-22 02:30:44] [config] lr-decay-freq: 50000
[2023-07-22 02:30:44] [config] lr-decay-inv-sqrt:
[2023-07-22 02:30:44] [config]   - 0
[2023-07-22 02:30:44] [config] lr-decay-repeat-warmup: false
[2023-07-22 02:30:44] [config] lr-decay-reset-optimizer: false
[2023-07-22 02:30:44] [config] lr-decay-start:
[2023-07-22 02:30:44] [config]   - 10
[2023-07-22 02:30:44] [config]   - 1
[2023-07-22 02:30:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 02:30:44] [config] lr-report: false
[2023-07-22 02:30:44] [config] lr-warmup: 0
[2023-07-22 02:30:44] [config] lr-warmup-at-reload: false
[2023-07-22 02:30:44] [config] lr-warmup-cycle: false
[2023-07-22 02:30:44] [config] lr-warmup-start-rate: 0
[2023-07-22 02:30:44] [config] max-length: 300
[2023-07-22 02:30:44] [config] max-length-crop: true
[2023-07-22 02:30:44] [config] max-length-factor: 3
[2023-07-22 02:30:44] [config] maxi-batch: 100
[2023-07-22 02:30:44] [config] maxi-batch-sort: trg
[2023-07-22 02:30:44] [config] mini-batch: 64
[2023-07-22 02:30:44] [config] mini-batch-fit: true
[2023-07-22 02:30:44] [config] mini-batch-fit-step: 10
[2023-07-22 02:30:44] [config] mini-batch-round-up: true
[2023-07-22 02:30:44] [config] mini-batch-track-lr: false
[2023-07-22 02:30:44] [config] mini-batch-warmup: 0
[2023-07-22 02:30:44] [config] mini-batch-words: 0
[2023-07-22 02:30:44] [config] mini-batch-words-ref: 0
[2023-07-22 02:30:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 02:30:44] [config] multi-loss-type: sum
[2023-07-22 02:30:44] [config] n-best: false
[2023-07-22 02:30:44] [config] no-nccl: false
[2023-07-22 02:30:44] [config] no-reload: false
[2023-07-22 02:30:44] [config] no-restore-corpus: false
[2023-07-22 02:30:44] [config] normalize: 0
[2023-07-22 02:30:44] [config] normalize-gradient: false
[2023-07-22 02:30:44] [config] num-devices: 0
[2023-07-22 02:30:44] [config] optimizer: adam
[2023-07-22 02:30:44] [config] optimizer-delay: 1
[2023-07-22 02:30:44] [config] optimizer-params:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] output-omit-bias: false
[2023-07-22 02:30:44] [config] overwrite: true
[2023-07-22 02:30:44] [config] precision:
[2023-07-22 02:30:44] [config]   - float16
[2023-07-22 02:30:44] [config]   - float32
[2023-07-22 02:30:44] [config] pretrained-model: ""
[2023-07-22 02:30:44] [config] quantize-biases: false
[2023-07-22 02:30:44] [config] quantize-bits: 0
[2023-07-22 02:30:44] [config] quantize-log-based: false
[2023-07-22 02:30:44] [config] quantize-optimization-steps: 0
[2023-07-22 02:30:44] [config] quiet: false
[2023-07-22 02:30:44] [config] quiet-translation: true
[2023-07-22 02:30:44] [config] relative-paths: false
[2023-07-22 02:30:44] [config] right-left: false
[2023-07-22 02:30:44] [config] save-freq: 10000u
[2023-07-22 02:30:44] [config] seed: 1234
[2023-07-22 02:30:44] [config] sentencepiece-alphas:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] sentencepiece-max-lines: 2000000
[2023-07-22 02:30:44] [config] sentencepiece-options: ""
[2023-07-22 02:30:44] [config] sharding: global
[2023-07-22 02:30:44] [config] shuffle: data
[2023-07-22 02:30:44] [config] shuffle-in-ram: false
[2023-07-22 02:30:44] [config] sigterm: save-and-exit
[2023-07-22 02:30:44] [config] skip: false
[2023-07-22 02:30:44] [config] sqlite: ""
[2023-07-22 02:30:44] [config] sqlite-drop: false
[2023-07-22 02:30:44] [config] sync-freq: 200u
[2023-07-22 02:30:44] [config] sync-sgd: false
[2023-07-22 02:30:44] [config] tempdir: /tmp
[2023-07-22 02:30:44] [config] tied-embeddings: false
[2023-07-22 02:30:44] [config] tied-embeddings-all: true
[2023-07-22 02:30:44] [config] tied-embeddings-src: false
[2023-07-22 02:30:44] [config] train-embedder-rank:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] train-sets:
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 02:30:44] [config] transformer-aan-activation: swish
[2023-07-22 02:30:44] [config] transformer-aan-depth: 2
[2023-07-22 02:30:44] [config] transformer-aan-nogate: false
[2023-07-22 02:30:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 02:30:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 02:30:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 02:30:44] [config] transformer-depth-scaling: false
[2023-07-22 02:30:44] [config] transformer-dim-aan: 2048
[2023-07-22 02:30:44] [config] transformer-dim-ffn: 2048
[2023-07-22 02:30:44] [config] transformer-dropout: 0
[2023-07-22 02:30:44] [config] transformer-dropout-attention: 0
[2023-07-22 02:30:44] [config] transformer-dropout-ffn: 0
[2023-07-22 02:30:44] [config] transformer-ffn-activation: swish
[2023-07-22 02:30:44] [config] transformer-ffn-depth: 2
[2023-07-22 02:30:44] [config] transformer-guided-alignment-layer: last
[2023-07-22 02:30:44] [config] transformer-heads: 8
[2023-07-22 02:30:44] [config] transformer-no-projection: false
[2023-07-22 02:30:44] [config] transformer-pool: false
[2023-07-22 02:30:44] [config] transformer-postprocess: dan
[2023-07-22 02:30:44] [config] transformer-postprocess-emb: d
[2023-07-22 02:30:44] [config] transformer-postprocess-top: ""
[2023-07-22 02:30:44] [config] transformer-preprocess: ""
[2023-07-22 02:30:44] [config] transformer-tied-layers:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] transformer-train-position-embeddings: false
[2023-07-22 02:30:44] [config] tsv: false
[2023-07-22 02:30:44] [config] tsv-fields: 0
[2023-07-22 02:30:44] [config] type: amun
[2023-07-22 02:30:44] [config] ulr: false
[2023-07-22 02:30:44] [config] ulr-dim-emb: 0
[2023-07-22 02:30:44] [config] ulr-dropout: 0
[2023-07-22 02:30:44] [config] ulr-keys-vectors: ""
[2023-07-22 02:30:44] [config] ulr-query-vectors: ""
[2023-07-22 02:30:44] [config] ulr-softmax-temperature: 1
[2023-07-22 02:30:44] [config] ulr-trainable-transformation: false
[2023-07-22 02:30:44] [config] unlikelihood-loss: false
[2023-07-22 02:30:44] [config] valid-freq: 50000000
[2023-07-22 02:30:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 02:30:44] [config] valid-max-length: 1000
[2023-07-22 02:30:44] [config] valid-metrics:
[2023-07-22 02:30:44] [config]   - cross-entropy
[2023-07-22 02:30:44] [config]   - translation
[2023-07-22 02:30:44] [config] valid-mini-batch: 32
[2023-07-22 02:30:44] [config] valid-reset-stalled: false
[2023-07-22 02:30:44] [config] valid-script-args:
[2023-07-22 02:30:44] [config]   []
[2023-07-22 02:30:44] [config] valid-script-path: ""
[2023-07-22 02:30:44] [config] valid-sets:
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 02:30:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 02:30:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:30:44] [config] vocabs:
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:30:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:30:44] [config] word-penalty: 0
[2023-07-22 02:30:44] [config] word-scores: false
[2023-07-22 02:30:44] [config] workspace: 5500
[2023-07-22 02:30:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 02:30:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:30:44] [training] Using single-device training
[2023-07-22 02:30:44] Synced seed 1234
[2023-07-22 02:30:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 02:30:44] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 02:30:44] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 02:30:44] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 02:30:45] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 02:30:45] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 02:30:45] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 02:30:46] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 02:30:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 02:30:46] [comm] Using global sharding
[2023-07-22 02:30:46] [comm] NCCLCommunicators constructed successfully
[2023-07-22 02:30:46] [training] Using 1 GPUs
[2023-07-22 02:30:46] [logits] Applying loss function for 1 factor(s)
[2023-07-22 02:30:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 02:30:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 02:30:46] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:34:23] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 03:34:23] [valid] No post-processing script given for validating translator
[2023-07-22 03:34:23] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 03:34:23] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 03:34:23] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 03:34:23] [comm] Using global sharding
[2023-07-22 03:34:23] [comm] NCCLCommunicators constructed successfully
[2023-07-22 03:34:23] [training] Using 1 GPUs
[2023-07-22 03:34:23] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 03:34:30] Allocating memory for general optimizer shards
[2023-07-22 03:34:30] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:34:30] Loading Adam parameters
[2023-07-22 03:34:31] [memory] Reserving 322 MB, device gpu0
[2023-07-22 03:34:31] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:34:31] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 03:34:31] [data] Restoring the corpus state to epoch 31, batch 1171
[2023-07-22 03:34:31] [data] Shuffling data
[2023-07-22 03:34:31] [data] Done reading 20,192 sentences
[2023-07-22 03:34:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:34:31] Training started
[2023-07-22 03:34:31] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 03:34:32] [memory] Reserving 80 MB, device gpu0
[2023-07-22 03:34:42] Parameter type float16, optimization type float32, casting types true
[2023-07-22 03:39:48] Seen 20,192 samples
[2023-07-22 03:39:48] Starting data epoch 32 in logical epoch 32
[2023-07-22 03:39:48] [data] Shuffling data
[2023-07-22 03:39:48] [data] Done reading 20,192 sentences
[2023-07-22 03:39:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:45:07] Seen 20,192 samples
[2023-07-22 03:45:07] Starting data epoch 33 in logical epoch 33
[2023-07-22 03:45:07] [data] Shuffling data
[2023-07-22 03:45:07] [data] Done reading 20,192 sentences
[2023-07-22 03:45:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:50:30] Seen 20,192 samples
[2023-07-22 03:50:30] Starting data epoch 34 in logical epoch 34
[2023-07-22 03:50:30] [data] Shuffling data
[2023-07-22 03:50:30] [data] Done reading 20,192 sentences
[2023-07-22 03:50:30] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 03:55:54] Seen 20,192 samples
[2023-07-22 03:55:54] Starting data epoch 35 in logical epoch 35
[2023-07-22 03:55:54] [data] Shuffling data
[2023-07-22 03:55:54] [data] Done reading 20,192 sentences
[2023-07-22 03:55:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:01:22] Seen 20,192 samples
[2023-07-22 04:01:22] Starting data epoch 36 in logical epoch 36
[2023-07-22 04:01:22] [data] Shuffling data
[2023-07-22 04:01:22] [data] Done reading 20,192 sentences
[2023-07-22 04:01:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:06:55] Seen 20,192 samples
[2023-07-22 04:06:55] Starting data epoch 37 in logical epoch 37
[2023-07-22 04:06:55] [data] Shuffling data
[2023-07-22 04:06:55] [data] Done reading 20,192 sentences
[2023-07-22 04:06:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:12:27] Seen 20,192 samples
[2023-07-22 04:12:27] Starting data epoch 38 in logical epoch 38
[2023-07-22 04:12:27] [data] Shuffling data
[2023-07-22 04:12:27] [data] Done reading 20,192 sentences
[2023-07-22 04:12:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:17:54] Seen 20,192 samples
[2023-07-22 04:17:54] Starting data epoch 39 in logical epoch 39
[2023-07-22 04:17:54] [data] Shuffling data
[2023-07-22 04:17:54] [data] Done reading 20,192 sentences
[2023-07-22 04:17:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:23:13] Seen 20,192 samples
[2023-07-22 04:23:13] Starting data epoch 40 in logical epoch 40
[2023-07-22 04:23:13] [data] Shuffling data
[2023-07-22 04:23:13] [data] Done reading 20,192 sentences
[2023-07-22 04:23:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 04:28:33] Seen 20,192 samples
[2023-07-22 04:28:33] Starting data epoch 41 in logical epoch 41
[2023-07-22 04:28:33] Training finished
[2023-07-22 04:28:45] [valid] Ep. 41 : Up. 1562 : cross-entropy : 153.005 : new best
[2023-07-22 04:31:06] [valid] Ep. 41 : Up. 1562 : translation : 0 : new best
[2023-07-22 04:31:06] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 04:31:08] Saving Adam parameters
[2023-07-22 04:31:09] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 04:31:18] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:31:18] [marian] Running on node18.datos.cluster.uy as process 1492 with command line:
[2023-07-22 04:31:18] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 04:31:18] [config] after: 0e
[2023-07-22 04:31:18] [config] after-batches: 0
[2023-07-22 04:31:18] [config] after-epochs: 50
[2023-07-22 04:31:18] [config] all-caps-every: 0
[2023-07-22 04:31:18] [config] allow-unk: false
[2023-07-22 04:31:18] [config] authors: false
[2023-07-22 04:31:18] [config] beam-size: 12
[2023-07-22 04:31:18] [config] bert-class-symbol: "[CLS]"
[2023-07-22 04:31:18] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 04:31:18] [config] bert-masking-fraction: 0.15
[2023-07-22 04:31:18] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 04:31:18] [config] bert-train-type-embeddings: true
[2023-07-22 04:31:18] [config] bert-type-vocab-size: 2
[2023-07-22 04:31:18] [config] build-info: ""
[2023-07-22 04:31:18] [config] check-gradient-nan: false
[2023-07-22 04:31:18] [config] check-nan: false
[2023-07-22 04:31:18] [config] cite: false
[2023-07-22 04:31:18] [config] clip-norm: 1
[2023-07-22 04:31:18] [config] cost-scaling:
[2023-07-22 04:31:18] [config]   - 256.f
[2023-07-22 04:31:18] [config]   - 1000
[2023-07-22 04:31:18] [config]   - 2.f
[2023-07-22 04:31:18] [config]   - 256.f
[2023-07-22 04:31:18] [config] cost-type: ce-sum
[2023-07-22 04:31:18] [config] cpu-threads: 0
[2023-07-22 04:31:18] [config] data-threads: 8
[2023-07-22 04:31:18] [config] data-weighting: ""
[2023-07-22 04:31:18] [config] data-weighting-type: sentence
[2023-07-22 04:31:18] [config] dec-cell: gru
[2023-07-22 04:31:18] [config] dec-cell-base-depth: 2
[2023-07-22 04:31:18] [config] dec-cell-high-depth: 1
[2023-07-22 04:31:18] [config] dec-depth: 1
[2023-07-22 04:31:18] [config] devices:
[2023-07-22 04:31:18] [config]   - 0
[2023-07-22 04:31:18] [config] dim-emb: 512
[2023-07-22 04:31:18] [config] dim-rnn: 1024
[2023-07-22 04:31:18] [config] dim-vocabs:
[2023-07-22 04:31:18] [config]   - 16384
[2023-07-22 04:31:18] [config]   - 16384
[2023-07-22 04:31:18] [config] disp-first: 0
[2023-07-22 04:31:18] [config] disp-freq: 1000u
[2023-07-22 04:31:18] [config] disp-label-counts: true
[2023-07-22 04:31:18] [config] dropout-rnn: 0
[2023-07-22 04:31:18] [config] dropout-src: 0
[2023-07-22 04:31:18] [config] dropout-trg: 0
[2023-07-22 04:31:18] [config] dump-config: ""
[2023-07-22 04:31:18] [config] dynamic-gradient-scaling:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] early-stopping: 200
[2023-07-22 04:31:18] [config] early-stopping-on: first
[2023-07-22 04:31:18] [config] embedding-fix-src: false
[2023-07-22 04:31:18] [config] embedding-fix-trg: false
[2023-07-22 04:31:18] [config] embedding-normalization: false
[2023-07-22 04:31:18] [config] embedding-vectors:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] enc-cell: gru
[2023-07-22 04:31:18] [config] enc-cell-depth: 1
[2023-07-22 04:31:18] [config] enc-depth: 1
[2023-07-22 04:31:18] [config] enc-type: bidirectional
[2023-07-22 04:31:18] [config] english-title-case-every: 0
[2023-07-22 04:31:18] [config] exponential-smoothing: 0
[2023-07-22 04:31:18] [config] factor-weight: 1
[2023-07-22 04:31:18] [config] factors-combine: sum
[2023-07-22 04:31:18] [config] factors-dim-emb: 0
[2023-07-22 04:31:18] [config] gradient-checkpointing: false
[2023-07-22 04:31:18] [config] gradient-norm-average-window: 100
[2023-07-22 04:31:18] [config] guided-alignment: none
[2023-07-22 04:31:18] [config] guided-alignment-cost: mse
[2023-07-22 04:31:18] [config] guided-alignment-weight: 0.1
[2023-07-22 04:31:18] [config] ignore-model-config: false
[2023-07-22 04:31:18] [config] input-types:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] interpolate-env-vars: false
[2023-07-22 04:31:18] [config] keep-best: false
[2023-07-22 04:31:18] [config] label-smoothing: 0
[2023-07-22 04:31:18] [config] layer-normalization: false
[2023-07-22 04:31:18] [config] learn-rate: 0.0001
[2023-07-22 04:31:18] [config] lemma-dependency: ""
[2023-07-22 04:31:18] [config] lemma-dim-emb: 0
[2023-07-22 04:31:18] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 04:31:18] [config] log-level: info
[2023-07-22 04:31:18] [config] log-time-zone: ""
[2023-07-22 04:31:18] [config] logical-epoch:
[2023-07-22 04:31:18] [config]   - 1e
[2023-07-22 04:31:18] [config]   - 0
[2023-07-22 04:31:18] [config] lr-decay: 0
[2023-07-22 04:31:18] [config] lr-decay-freq: 50000
[2023-07-22 04:31:18] [config] lr-decay-inv-sqrt:
[2023-07-22 04:31:18] [config]   - 0
[2023-07-22 04:31:18] [config] lr-decay-repeat-warmup: false
[2023-07-22 04:31:18] [config] lr-decay-reset-optimizer: false
[2023-07-22 04:31:18] [config] lr-decay-start:
[2023-07-22 04:31:18] [config]   - 10
[2023-07-22 04:31:18] [config]   - 1
[2023-07-22 04:31:18] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 04:31:18] [config] lr-report: false
[2023-07-22 04:31:18] [config] lr-warmup: 0
[2023-07-22 04:31:18] [config] lr-warmup-at-reload: false
[2023-07-22 04:31:18] [config] lr-warmup-cycle: false
[2023-07-22 04:31:18] [config] lr-warmup-start-rate: 0
[2023-07-22 04:31:18] [config] max-length: 300
[2023-07-22 04:31:18] [config] max-length-crop: true
[2023-07-22 04:31:18] [config] max-length-factor: 3
[2023-07-22 04:31:18] [config] maxi-batch: 100
[2023-07-22 04:31:18] [config] maxi-batch-sort: trg
[2023-07-22 04:31:18] [config] mini-batch: 64
[2023-07-22 04:31:18] [config] mini-batch-fit: true
[2023-07-22 04:31:18] [config] mini-batch-fit-step: 10
[2023-07-22 04:31:18] [config] mini-batch-round-up: true
[2023-07-22 04:31:18] [config] mini-batch-track-lr: false
[2023-07-22 04:31:18] [config] mini-batch-warmup: 0
[2023-07-22 04:31:18] [config] mini-batch-words: 0
[2023-07-22 04:31:18] [config] mini-batch-words-ref: 0
[2023-07-22 04:31:18] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 04:31:18] [config] multi-loss-type: sum
[2023-07-22 04:31:18] [config] n-best: false
[2023-07-22 04:31:18] [config] no-nccl: false
[2023-07-22 04:31:18] [config] no-reload: false
[2023-07-22 04:31:18] [config] no-restore-corpus: false
[2023-07-22 04:31:18] [config] normalize: 0
[2023-07-22 04:31:18] [config] normalize-gradient: false
[2023-07-22 04:31:18] [config] num-devices: 0
[2023-07-22 04:31:18] [config] optimizer: adam
[2023-07-22 04:31:18] [config] optimizer-delay: 1
[2023-07-22 04:31:18] [config] optimizer-params:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] output-omit-bias: false
[2023-07-22 04:31:18] [config] overwrite: true
[2023-07-22 04:31:18] [config] precision:
[2023-07-22 04:31:18] [config]   - float16
[2023-07-22 04:31:18] [config]   - float32
[2023-07-22 04:31:18] [config] pretrained-model: ""
[2023-07-22 04:31:18] [config] quantize-biases: false
[2023-07-22 04:31:18] [config] quantize-bits: 0
[2023-07-22 04:31:18] [config] quantize-log-based: false
[2023-07-22 04:31:18] [config] quantize-optimization-steps: 0
[2023-07-22 04:31:18] [config] quiet: false
[2023-07-22 04:31:18] [config] quiet-translation: true
[2023-07-22 04:31:18] [config] relative-paths: false
[2023-07-22 04:31:18] [config] right-left: false
[2023-07-22 04:31:18] [config] save-freq: 10000u
[2023-07-22 04:31:18] [config] seed: 1234
[2023-07-22 04:31:18] [config] sentencepiece-alphas:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] sentencepiece-max-lines: 2000000
[2023-07-22 04:31:18] [config] sentencepiece-options: ""
[2023-07-22 04:31:18] [config] sharding: global
[2023-07-22 04:31:18] [config] shuffle: data
[2023-07-22 04:31:18] [config] shuffle-in-ram: false
[2023-07-22 04:31:18] [config] sigterm: save-and-exit
[2023-07-22 04:31:18] [config] skip: false
[2023-07-22 04:31:18] [config] sqlite: ""
[2023-07-22 04:31:18] [config] sqlite-drop: false
[2023-07-22 04:31:18] [config] sync-freq: 200u
[2023-07-22 04:31:18] [config] sync-sgd: false
[2023-07-22 04:31:18] [config] tempdir: /tmp
[2023-07-22 04:31:18] [config] tied-embeddings: false
[2023-07-22 04:31:18] [config] tied-embeddings-all: true
[2023-07-22 04:31:18] [config] tied-embeddings-src: false
[2023-07-22 04:31:18] [config] train-embedder-rank:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] train-sets:
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 04:31:18] [config] transformer-aan-activation: swish
[2023-07-22 04:31:18] [config] transformer-aan-depth: 2
[2023-07-22 04:31:18] [config] transformer-aan-nogate: false
[2023-07-22 04:31:18] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 04:31:18] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 04:31:18] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 04:31:18] [config] transformer-depth-scaling: false
[2023-07-22 04:31:18] [config] transformer-dim-aan: 2048
[2023-07-22 04:31:18] [config] transformer-dim-ffn: 2048
[2023-07-22 04:31:18] [config] transformer-dropout: 0
[2023-07-22 04:31:18] [config] transformer-dropout-attention: 0
[2023-07-22 04:31:18] [config] transformer-dropout-ffn: 0
[2023-07-22 04:31:18] [config] transformer-ffn-activation: swish
[2023-07-22 04:31:18] [config] transformer-ffn-depth: 2
[2023-07-22 04:31:18] [config] transformer-guided-alignment-layer: last
[2023-07-22 04:31:18] [config] transformer-heads: 8
[2023-07-22 04:31:18] [config] transformer-no-projection: false
[2023-07-22 04:31:18] [config] transformer-pool: false
[2023-07-22 04:31:18] [config] transformer-postprocess: dan
[2023-07-22 04:31:18] [config] transformer-postprocess-emb: d
[2023-07-22 04:31:18] [config] transformer-postprocess-top: ""
[2023-07-22 04:31:18] [config] transformer-preprocess: ""
[2023-07-22 04:31:18] [config] transformer-tied-layers:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] transformer-train-position-embeddings: false
[2023-07-22 04:31:18] [config] tsv: false
[2023-07-22 04:31:18] [config] tsv-fields: 0
[2023-07-22 04:31:18] [config] type: amun
[2023-07-22 04:31:18] [config] ulr: false
[2023-07-22 04:31:18] [config] ulr-dim-emb: 0
[2023-07-22 04:31:18] [config] ulr-dropout: 0
[2023-07-22 04:31:18] [config] ulr-keys-vectors: ""
[2023-07-22 04:31:18] [config] ulr-query-vectors: ""
[2023-07-22 04:31:18] [config] ulr-softmax-temperature: 1
[2023-07-22 04:31:18] [config] ulr-trainable-transformation: false
[2023-07-22 04:31:18] [config] unlikelihood-loss: false
[2023-07-22 04:31:18] [config] valid-freq: 50000000
[2023-07-22 04:31:18] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 04:31:18] [config] valid-max-length: 1000
[2023-07-22 04:31:18] [config] valid-metrics:
[2023-07-22 04:31:18] [config]   - cross-entropy
[2023-07-22 04:31:18] [config]   - translation
[2023-07-22 04:31:18] [config] valid-mini-batch: 32
[2023-07-22 04:31:18] [config] valid-reset-stalled: false
[2023-07-22 04:31:18] [config] valid-script-args:
[2023-07-22 04:31:18] [config]   []
[2023-07-22 04:31:18] [config] valid-script-path: ""
[2023-07-22 04:31:18] [config] valid-sets:
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 04:31:18] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 04:31:18] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:31:18] [config] vocabs:
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:31:18] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:31:18] [config] word-penalty: 0
[2023-07-22 04:31:18] [config] word-scores: false
[2023-07-22 04:31:18] [config] workspace: 5500
[2023-07-22 04:31:18] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 04:31:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:31:18] [training] Using single-device training
[2023-07-22 04:31:18] Synced seed 1234
[2023-07-22 04:31:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 04:31:18] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 04:31:18] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 04:31:18] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 04:31:18] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 04:31:18] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 04:31:18] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 04:31:20] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 04:31:20] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 04:31:20] [comm] Using global sharding
[2023-07-22 04:31:20] [comm] NCCLCommunicators constructed successfully
[2023-07-22 04:31:20] [training] Using 1 GPUs
[2023-07-22 04:31:20] [logits] Applying loss function for 1 factor(s)
[2023-07-22 04:31:20] [memory] Reserving 80 MB, device gpu0
[2023-07-22 04:31:20] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 04:31:20] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:34:59] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 05:34:59] [valid] No post-processing script given for validating translator
[2023-07-22 05:34:59] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 05:34:59] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 05:34:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 05:34:59] [comm] Using global sharding
[2023-07-22 05:34:59] [comm] NCCLCommunicators constructed successfully
[2023-07-22 05:34:59] [training] Using 1 GPUs
[2023-07-22 05:34:59] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 05:35:07] Allocating memory for general optimizer shards
[2023-07-22 05:35:07] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:35:07] Loading Adam parameters
[2023-07-22 05:35:07] [memory] Reserving 322 MB, device gpu0
[2023-07-22 05:35:07] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:35:08] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 05:35:08] [data] Restoring the corpus state to epoch 41, batch 1562
[2023-07-22 05:35:08] [data] Shuffling data
[2023-07-22 05:35:08] [data] Done reading 20,192 sentences
[2023-07-22 05:35:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:35:08] Training started
[2023-07-22 05:35:08] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 05:35:08] [memory] Reserving 80 MB, device gpu0
[2023-07-22 05:35:17] Parameter type float16, optimization type float32, casting types true
[2023-07-22 05:40:14] Seen 20,192 samples
[2023-07-22 05:40:14] Starting data epoch 42 in logical epoch 42
[2023-07-22 05:40:14] [data] Shuffling data
[2023-07-22 05:40:14] [data] Done reading 20,192 sentences
[2023-07-22 05:40:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:45:41] Seen 20,192 samples
[2023-07-22 05:45:41] Starting data epoch 43 in logical epoch 43
[2023-07-22 05:45:41] [data] Shuffling data
[2023-07-22 05:45:41] [data] Done reading 20,192 sentences
[2023-07-22 05:45:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:50:57] Seen 20,192 samples
[2023-07-22 05:50:57] Starting data epoch 44 in logical epoch 44
[2023-07-22 05:50:57] [data] Shuffling data
[2023-07-22 05:50:57] [data] Done reading 20,192 sentences
[2023-07-22 05:50:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 05:56:08] Seen 20,192 samples
[2023-07-22 05:56:08] Starting data epoch 45 in logical epoch 45
[2023-07-22 05:56:08] [data] Shuffling data
[2023-07-22 05:56:08] [data] Done reading 20,192 sentences
[2023-07-22 05:56:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:01:15] Seen 20,192 samples
[2023-07-22 06:01:15] Starting data epoch 46 in logical epoch 46
[2023-07-22 06:01:15] [data] Shuffling data
[2023-07-22 06:01:15] [data] Done reading 20,192 sentences
[2023-07-22 06:01:15] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:06:42] Seen 20,192 samples
[2023-07-22 06:06:42] Starting data epoch 47 in logical epoch 47
[2023-07-22 06:06:42] [data] Shuffling data
[2023-07-22 06:06:42] [data] Done reading 20,192 sentences
[2023-07-22 06:06:42] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:12:01] Seen 20,192 samples
[2023-07-22 06:12:01] Starting data epoch 48 in logical epoch 48
[2023-07-22 06:12:01] [data] Shuffling data
[2023-07-22 06:12:01] [data] Done reading 20,192 sentences
[2023-07-22 06:12:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:17:21] Seen 20,192 samples
[2023-07-22 06:17:21] Starting data epoch 49 in logical epoch 49
[2023-07-22 06:17:21] [data] Shuffling data
[2023-07-22 06:17:21] [data] Done reading 20,192 sentences
[2023-07-22 06:17:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:22:31] Seen 20,192 samples
[2023-07-22 06:22:31] Starting data epoch 50 in logical epoch 50
[2023-07-22 06:22:31] [data] Shuffling data
[2023-07-22 06:22:31] [data] Done reading 20,192 sentences
[2023-07-22 06:22:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 06:27:47] Seen 20,192 samples
[2023-07-22 06:27:47] Starting data epoch 51 in logical epoch 51
[2023-07-22 06:27:47] Training finished
[2023-07-22 06:27:59] [valid] Ep. 51 : Up. 1949 : cross-entropy : 146.804 : new best
[2023-07-22 06:30:22] [valid] Ep. 51 : Up. 1949 : translation : 0 : new best
[2023-07-22 06:30:22] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 06:30:24] Saving Adam parameters
[2023-07-22 06:30:25] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 06:30:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:30:32] [marian] Running on node18.datos.cluster.uy as process 9287 with command line:
[2023-07-22 06:30:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 06:30:32] [config] after: 0e
[2023-07-22 06:30:32] [config] after-batches: 0
[2023-07-22 06:30:32] [config] after-epochs: 60
[2023-07-22 06:30:32] [config] all-caps-every: 0
[2023-07-22 06:30:32] [config] allow-unk: false
[2023-07-22 06:30:32] [config] authors: false
[2023-07-22 06:30:32] [config] beam-size: 12
[2023-07-22 06:30:32] [config] bert-class-symbol: "[CLS]"
[2023-07-22 06:30:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 06:30:32] [config] bert-masking-fraction: 0.15
[2023-07-22 06:30:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 06:30:32] [config] bert-train-type-embeddings: true
[2023-07-22 06:30:32] [config] bert-type-vocab-size: 2
[2023-07-22 06:30:32] [config] build-info: ""
[2023-07-22 06:30:32] [config] check-gradient-nan: false
[2023-07-22 06:30:32] [config] check-nan: false
[2023-07-22 06:30:32] [config] cite: false
[2023-07-22 06:30:32] [config] clip-norm: 1
[2023-07-22 06:30:32] [config] cost-scaling:
[2023-07-22 06:30:32] [config]   - 256.f
[2023-07-22 06:30:32] [config]   - 1000
[2023-07-22 06:30:32] [config]   - 2.f
[2023-07-22 06:30:32] [config]   - 256.f
[2023-07-22 06:30:32] [config] cost-type: ce-sum
[2023-07-22 06:30:32] [config] cpu-threads: 0
[2023-07-22 06:30:32] [config] data-threads: 8
[2023-07-22 06:30:32] [config] data-weighting: ""
[2023-07-22 06:30:32] [config] data-weighting-type: sentence
[2023-07-22 06:30:32] [config] dec-cell: gru
[2023-07-22 06:30:32] [config] dec-cell-base-depth: 2
[2023-07-22 06:30:32] [config] dec-cell-high-depth: 1
[2023-07-22 06:30:32] [config] dec-depth: 1
[2023-07-22 06:30:32] [config] devices:
[2023-07-22 06:30:32] [config]   - 0
[2023-07-22 06:30:32] [config] dim-emb: 512
[2023-07-22 06:30:32] [config] dim-rnn: 1024
[2023-07-22 06:30:32] [config] dim-vocabs:
[2023-07-22 06:30:32] [config]   - 16384
[2023-07-22 06:30:32] [config]   - 16384
[2023-07-22 06:30:32] [config] disp-first: 0
[2023-07-22 06:30:32] [config] disp-freq: 1000u
[2023-07-22 06:30:32] [config] disp-label-counts: true
[2023-07-22 06:30:32] [config] dropout-rnn: 0
[2023-07-22 06:30:32] [config] dropout-src: 0
[2023-07-22 06:30:32] [config] dropout-trg: 0
[2023-07-22 06:30:32] [config] dump-config: ""
[2023-07-22 06:30:32] [config] dynamic-gradient-scaling:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] early-stopping: 200
[2023-07-22 06:30:32] [config] early-stopping-on: first
[2023-07-22 06:30:32] [config] embedding-fix-src: false
[2023-07-22 06:30:32] [config] embedding-fix-trg: false
[2023-07-22 06:30:32] [config] embedding-normalization: false
[2023-07-22 06:30:32] [config] embedding-vectors:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] enc-cell: gru
[2023-07-22 06:30:32] [config] enc-cell-depth: 1
[2023-07-22 06:30:32] [config] enc-depth: 1
[2023-07-22 06:30:32] [config] enc-type: bidirectional
[2023-07-22 06:30:32] [config] english-title-case-every: 0
[2023-07-22 06:30:32] [config] exponential-smoothing: 0
[2023-07-22 06:30:32] [config] factor-weight: 1
[2023-07-22 06:30:32] [config] factors-combine: sum
[2023-07-22 06:30:32] [config] factors-dim-emb: 0
[2023-07-22 06:30:32] [config] gradient-checkpointing: false
[2023-07-22 06:30:32] [config] gradient-norm-average-window: 100
[2023-07-22 06:30:32] [config] guided-alignment: none
[2023-07-22 06:30:32] [config] guided-alignment-cost: mse
[2023-07-22 06:30:32] [config] guided-alignment-weight: 0.1
[2023-07-22 06:30:32] [config] ignore-model-config: false
[2023-07-22 06:30:32] [config] input-types:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] interpolate-env-vars: false
[2023-07-22 06:30:32] [config] keep-best: false
[2023-07-22 06:30:32] [config] label-smoothing: 0
[2023-07-22 06:30:32] [config] layer-normalization: false
[2023-07-22 06:30:32] [config] learn-rate: 0.0001
[2023-07-22 06:30:32] [config] lemma-dependency: ""
[2023-07-22 06:30:32] [config] lemma-dim-emb: 0
[2023-07-22 06:30:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 06:30:32] [config] log-level: info
[2023-07-22 06:30:32] [config] log-time-zone: ""
[2023-07-22 06:30:32] [config] logical-epoch:
[2023-07-22 06:30:32] [config]   - 1e
[2023-07-22 06:30:32] [config]   - 0
[2023-07-22 06:30:32] [config] lr-decay: 0
[2023-07-22 06:30:32] [config] lr-decay-freq: 50000
[2023-07-22 06:30:32] [config] lr-decay-inv-sqrt:
[2023-07-22 06:30:32] [config]   - 0
[2023-07-22 06:30:32] [config] lr-decay-repeat-warmup: false
[2023-07-22 06:30:32] [config] lr-decay-reset-optimizer: false
[2023-07-22 06:30:32] [config] lr-decay-start:
[2023-07-22 06:30:32] [config]   - 10
[2023-07-22 06:30:32] [config]   - 1
[2023-07-22 06:30:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 06:30:32] [config] lr-report: false
[2023-07-22 06:30:32] [config] lr-warmup: 0
[2023-07-22 06:30:32] [config] lr-warmup-at-reload: false
[2023-07-22 06:30:32] [config] lr-warmup-cycle: false
[2023-07-22 06:30:32] [config] lr-warmup-start-rate: 0
[2023-07-22 06:30:32] [config] max-length: 300
[2023-07-22 06:30:32] [config] max-length-crop: true
[2023-07-22 06:30:32] [config] max-length-factor: 3
[2023-07-22 06:30:32] [config] maxi-batch: 100
[2023-07-22 06:30:32] [config] maxi-batch-sort: trg
[2023-07-22 06:30:32] [config] mini-batch: 64
[2023-07-22 06:30:32] [config] mini-batch-fit: true
[2023-07-22 06:30:32] [config] mini-batch-fit-step: 10
[2023-07-22 06:30:32] [config] mini-batch-round-up: true
[2023-07-22 06:30:32] [config] mini-batch-track-lr: false
[2023-07-22 06:30:32] [config] mini-batch-warmup: 0
[2023-07-22 06:30:32] [config] mini-batch-words: 0
[2023-07-22 06:30:32] [config] mini-batch-words-ref: 0
[2023-07-22 06:30:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 06:30:32] [config] multi-loss-type: sum
[2023-07-22 06:30:32] [config] n-best: false
[2023-07-22 06:30:32] [config] no-nccl: false
[2023-07-22 06:30:32] [config] no-reload: false
[2023-07-22 06:30:32] [config] no-restore-corpus: false
[2023-07-22 06:30:32] [config] normalize: 0
[2023-07-22 06:30:32] [config] normalize-gradient: false
[2023-07-22 06:30:32] [config] num-devices: 0
[2023-07-22 06:30:32] [config] optimizer: adam
[2023-07-22 06:30:32] [config] optimizer-delay: 1
[2023-07-22 06:30:32] [config] optimizer-params:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] output-omit-bias: false
[2023-07-22 06:30:32] [config] overwrite: true
[2023-07-22 06:30:32] [config] precision:
[2023-07-22 06:30:32] [config]   - float16
[2023-07-22 06:30:32] [config]   - float32
[2023-07-22 06:30:32] [config] pretrained-model: ""
[2023-07-22 06:30:32] [config] quantize-biases: false
[2023-07-22 06:30:32] [config] quantize-bits: 0
[2023-07-22 06:30:32] [config] quantize-log-based: false
[2023-07-22 06:30:32] [config] quantize-optimization-steps: 0
[2023-07-22 06:30:32] [config] quiet: false
[2023-07-22 06:30:32] [config] quiet-translation: true
[2023-07-22 06:30:32] [config] relative-paths: false
[2023-07-22 06:30:32] [config] right-left: false
[2023-07-22 06:30:32] [config] save-freq: 10000u
[2023-07-22 06:30:32] [config] seed: 1234
[2023-07-22 06:30:32] [config] sentencepiece-alphas:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] sentencepiece-max-lines: 2000000
[2023-07-22 06:30:32] [config] sentencepiece-options: ""
[2023-07-22 06:30:32] [config] sharding: global
[2023-07-22 06:30:32] [config] shuffle: data
[2023-07-22 06:30:32] [config] shuffle-in-ram: false
[2023-07-22 06:30:32] [config] sigterm: save-and-exit
[2023-07-22 06:30:32] [config] skip: false
[2023-07-22 06:30:32] [config] sqlite: ""
[2023-07-22 06:30:32] [config] sqlite-drop: false
[2023-07-22 06:30:32] [config] sync-freq: 200u
[2023-07-22 06:30:32] [config] sync-sgd: false
[2023-07-22 06:30:32] [config] tempdir: /tmp
[2023-07-22 06:30:32] [config] tied-embeddings: false
[2023-07-22 06:30:32] [config] tied-embeddings-all: true
[2023-07-22 06:30:32] [config] tied-embeddings-src: false
[2023-07-22 06:30:32] [config] train-embedder-rank:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] train-sets:
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 06:30:32] [config] transformer-aan-activation: swish
[2023-07-22 06:30:32] [config] transformer-aan-depth: 2
[2023-07-22 06:30:32] [config] transformer-aan-nogate: false
[2023-07-22 06:30:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 06:30:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 06:30:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 06:30:32] [config] transformer-depth-scaling: false
[2023-07-22 06:30:32] [config] transformer-dim-aan: 2048
[2023-07-22 06:30:32] [config] transformer-dim-ffn: 2048
[2023-07-22 06:30:32] [config] transformer-dropout: 0
[2023-07-22 06:30:32] [config] transformer-dropout-attention: 0
[2023-07-22 06:30:32] [config] transformer-dropout-ffn: 0
[2023-07-22 06:30:32] [config] transformer-ffn-activation: swish
[2023-07-22 06:30:32] [config] transformer-ffn-depth: 2
[2023-07-22 06:30:32] [config] transformer-guided-alignment-layer: last
[2023-07-22 06:30:32] [config] transformer-heads: 8
[2023-07-22 06:30:32] [config] transformer-no-projection: false
[2023-07-22 06:30:32] [config] transformer-pool: false
[2023-07-22 06:30:32] [config] transformer-postprocess: dan
[2023-07-22 06:30:32] [config] transformer-postprocess-emb: d
[2023-07-22 06:30:32] [config] transformer-postprocess-top: ""
[2023-07-22 06:30:32] [config] transformer-preprocess: ""
[2023-07-22 06:30:32] [config] transformer-tied-layers:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] transformer-train-position-embeddings: false
[2023-07-22 06:30:32] [config] tsv: false
[2023-07-22 06:30:32] [config] tsv-fields: 0
[2023-07-22 06:30:32] [config] type: amun
[2023-07-22 06:30:32] [config] ulr: false
[2023-07-22 06:30:32] [config] ulr-dim-emb: 0
[2023-07-22 06:30:32] [config] ulr-dropout: 0
[2023-07-22 06:30:32] [config] ulr-keys-vectors: ""
[2023-07-22 06:30:32] [config] ulr-query-vectors: ""
[2023-07-22 06:30:32] [config] ulr-softmax-temperature: 1
[2023-07-22 06:30:32] [config] ulr-trainable-transformation: false
[2023-07-22 06:30:32] [config] unlikelihood-loss: false
[2023-07-22 06:30:32] [config] valid-freq: 50000000
[2023-07-22 06:30:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 06:30:32] [config] valid-max-length: 1000
[2023-07-22 06:30:32] [config] valid-metrics:
[2023-07-22 06:30:32] [config]   - cross-entropy
[2023-07-22 06:30:32] [config]   - translation
[2023-07-22 06:30:32] [config] valid-mini-batch: 32
[2023-07-22 06:30:32] [config] valid-reset-stalled: false
[2023-07-22 06:30:32] [config] valid-script-args:
[2023-07-22 06:30:32] [config]   []
[2023-07-22 06:30:32] [config] valid-script-path: ""
[2023-07-22 06:30:32] [config] valid-sets:
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 06:30:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 06:30:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:30:32] [config] vocabs:
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:30:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:30:32] [config] word-penalty: 0
[2023-07-22 06:30:32] [config] word-scores: false
[2023-07-22 06:30:32] [config] workspace: 5500
[2023-07-22 06:30:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 06:30:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:30:32] [training] Using single-device training
[2023-07-22 06:30:33] Synced seed 1234
[2023-07-22 06:30:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 06:30:33] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 06:30:33] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 06:30:33] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 06:30:33] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 06:30:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 06:30:33] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 06:30:34] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 06:30:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 06:30:34] [comm] Using global sharding
[2023-07-22 06:30:34] [comm] NCCLCommunicators constructed successfully
[2023-07-22 06:30:34] [training] Using 1 GPUs
[2023-07-22 06:30:34] [logits] Applying loss function for 1 factor(s)
[2023-07-22 06:30:34] [memory] Reserving 80 MB, device gpu0
[2023-07-22 06:30:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 06:30:34] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:34:37] [batching] Done. Typical MB size is 35,811 target words
[2023-07-22 07:34:37] [valid] No post-processing script given for validating translator
[2023-07-22 07:34:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 07:34:37] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 07:34:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 07:34:37] [comm] Using global sharding
[2023-07-22 07:34:37] [comm] NCCLCommunicators constructed successfully
[2023-07-22 07:34:37] [training] Using 1 GPUs
[2023-07-22 07:34:37] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 07:34:43] Allocating memory for general optimizer shards
[2023-07-22 07:34:43] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:34:43] Loading Adam parameters
[2023-07-22 07:34:44] [memory] Reserving 322 MB, device gpu0
[2023-07-22 07:34:44] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:34:44] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 07:34:44] [data] Restoring the corpus state to epoch 51, batch 1949
[2023-07-22 07:34:44] [data] Shuffling data
[2023-07-22 07:34:44] [data] Done reading 20,192 sentences
[2023-07-22 07:34:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:34:44] Training started
[2023-07-22 07:34:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-22 07:34:45] [memory] Reserving 80 MB, device gpu0
[2023-07-22 07:34:53] Parameter type float16, optimization type float32, casting types true
[2023-07-22 07:39:59] Seen 20,192 samples
[2023-07-22 07:39:59] Starting data epoch 52 in logical epoch 52
[2023-07-22 07:39:59] [data] Shuffling data
[2023-07-22 07:39:59] [data] Done reading 20,192 sentences
[2023-07-22 07:39:59] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:41:47] Ep. 52 : Up. 2000 : Sen. 7,603 : Cost 5.02863550 * 15,912,376 @ 12,218 after 31,854,216 : Time 429.76s : 37026.48 words/s : gNorm 0.9483
[2023-07-22 07:45:23] Seen 20,192 samples
[2023-07-22 07:45:23] Starting data epoch 53 in logical epoch 53
[2023-07-22 07:45:23] [data] Shuffling data
[2023-07-22 07:45:23] [data] Done reading 20,192 sentences
[2023-07-22 07:45:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:50:32] Seen 20,192 samples
[2023-07-22 07:50:32] Starting data epoch 54 in logical epoch 54
[2023-07-22 07:50:32] [data] Shuffling data
[2023-07-22 07:50:32] [data] Done reading 20,192 sentences
[2023-07-22 07:50:32] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 07:55:55] Seen 20,192 samples
[2023-07-22 07:55:55] Starting data epoch 55 in logical epoch 55
[2023-07-22 07:55:55] [data] Shuffling data
[2023-07-22 07:55:55] [data] Done reading 20,192 sentences
[2023-07-22 07:55:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:01:02] Seen 20,192 samples
[2023-07-22 08:01:02] Starting data epoch 56 in logical epoch 56
[2023-07-22 08:01:02] [data] Shuffling data
[2023-07-22 08:01:02] [data] Done reading 20,192 sentences
[2023-07-22 08:01:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:06:20] Seen 20,192 samples
[2023-07-22 08:06:20] Starting data epoch 57 in logical epoch 57
[2023-07-22 08:06:20] [data] Shuffling data
[2023-07-22 08:06:21] [data] Done reading 20,192 sentences
[2023-07-22 08:06:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:11:40] Seen 20,192 samples
[2023-07-22 08:11:40] Starting data epoch 58 in logical epoch 58
[2023-07-22 08:11:40] [data] Shuffling data
[2023-07-22 08:11:40] [data] Done reading 20,192 sentences
[2023-07-22 08:11:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:16:43] Seen 20,192 samples
[2023-07-22 08:16:43] Starting data epoch 59 in logical epoch 59
[2023-07-22 08:16:43] [data] Shuffling data
[2023-07-22 08:16:43] [data] Done reading 20,192 sentences
[2023-07-22 08:16:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:21:56] Seen 20,192 samples
[2023-07-22 08:21:56] Starting data epoch 60 in logical epoch 60
[2023-07-22 08:21:56] [data] Shuffling data
[2023-07-22 08:21:56] [data] Done reading 20,192 sentences
[2023-07-22 08:21:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-22 08:27:13] Seen 20,192 samples
[2023-07-22 08:27:13] Starting data epoch 61 in logical epoch 61
[2023-07-22 08:27:13] Training finished
[2023-07-22 08:27:26] [valid] Ep. 61 : Up. 2336 : cross-entropy : 142.415 : new best
[2023-07-22 08:29:53] [valid] Ep. 61 : Up. 2336 : translation : 0 : new best
[2023-07-22 08:29:53] Saving model to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 08:29:55] Saving Adam parameters
[2023-07-22 08:29:55] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz and /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz.optimizer.npz
[2023-07-22 08:30:03] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:30:03] [marian] Running on node18.datos.cluster.uy as process 17049 with command line:
[2023-07-22 08:30:03] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm --seed 1234 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/test.txt --quiet-translation --overwrite --early-stopping 200 --fp16 --tied-embeddings-all --workspace 5500 --mini-batch-fit --dim-vocabs 16384 16384 --max-length-crop --max-length 300
[2023-07-22 08:30:03] [config] after: 0e
[2023-07-22 08:30:03] [config] after-batches: 0
[2023-07-22 08:30:03] [config] after-epochs: 70
[2023-07-22 08:30:03] [config] all-caps-every: 0
[2023-07-22 08:30:03] [config] allow-unk: false
[2023-07-22 08:30:03] [config] authors: false
[2023-07-22 08:30:03] [config] beam-size: 12
[2023-07-22 08:30:03] [config] bert-class-symbol: "[CLS]"
[2023-07-22 08:30:03] [config] bert-mask-symbol: "[MASK]"
[2023-07-22 08:30:03] [config] bert-masking-fraction: 0.15
[2023-07-22 08:30:03] [config] bert-sep-symbol: "[SEP]"
[2023-07-22 08:30:03] [config] bert-train-type-embeddings: true
[2023-07-22 08:30:03] [config] bert-type-vocab-size: 2
[2023-07-22 08:30:03] [config] build-info: ""
[2023-07-22 08:30:03] [config] check-gradient-nan: false
[2023-07-22 08:30:03] [config] check-nan: false
[2023-07-22 08:30:03] [config] cite: false
[2023-07-22 08:30:03] [config] clip-norm: 1
[2023-07-22 08:30:03] [config] cost-scaling:
[2023-07-22 08:30:03] [config]   - 256.f
[2023-07-22 08:30:03] [config]   - 1000
[2023-07-22 08:30:03] [config]   - 2.f
[2023-07-22 08:30:03] [config]   - 256.f
[2023-07-22 08:30:03] [config] cost-type: ce-sum
[2023-07-22 08:30:03] [config] cpu-threads: 0
[2023-07-22 08:30:03] [config] data-threads: 8
[2023-07-22 08:30:03] [config] data-weighting: ""
[2023-07-22 08:30:03] [config] data-weighting-type: sentence
[2023-07-22 08:30:03] [config] dec-cell: gru
[2023-07-22 08:30:03] [config] dec-cell-base-depth: 2
[2023-07-22 08:30:03] [config] dec-cell-high-depth: 1
[2023-07-22 08:30:03] [config] dec-depth: 1
[2023-07-22 08:30:03] [config] devices:
[2023-07-22 08:30:03] [config]   - 0
[2023-07-22 08:30:03] [config] dim-emb: 512
[2023-07-22 08:30:03] [config] dim-rnn: 1024
[2023-07-22 08:30:03] [config] dim-vocabs:
[2023-07-22 08:30:03] [config]   - 16384
[2023-07-22 08:30:03] [config]   - 16384
[2023-07-22 08:30:03] [config] disp-first: 0
[2023-07-22 08:30:03] [config] disp-freq: 1000u
[2023-07-22 08:30:03] [config] disp-label-counts: true
[2023-07-22 08:30:03] [config] dropout-rnn: 0
[2023-07-22 08:30:03] [config] dropout-src: 0
[2023-07-22 08:30:03] [config] dropout-trg: 0
[2023-07-22 08:30:03] [config] dump-config: ""
[2023-07-22 08:30:03] [config] dynamic-gradient-scaling:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] early-stopping: 200
[2023-07-22 08:30:03] [config] early-stopping-on: first
[2023-07-22 08:30:03] [config] embedding-fix-src: false
[2023-07-22 08:30:03] [config] embedding-fix-trg: false
[2023-07-22 08:30:03] [config] embedding-normalization: false
[2023-07-22 08:30:03] [config] embedding-vectors:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] enc-cell: gru
[2023-07-22 08:30:03] [config] enc-cell-depth: 1
[2023-07-22 08:30:03] [config] enc-depth: 1
[2023-07-22 08:30:03] [config] enc-type: bidirectional
[2023-07-22 08:30:03] [config] english-title-case-every: 0
[2023-07-22 08:30:03] [config] exponential-smoothing: 0
[2023-07-22 08:30:03] [config] factor-weight: 1
[2023-07-22 08:30:03] [config] factors-combine: sum
[2023-07-22 08:30:03] [config] factors-dim-emb: 0
[2023-07-22 08:30:03] [config] gradient-checkpointing: false
[2023-07-22 08:30:03] [config] gradient-norm-average-window: 100
[2023-07-22 08:30:03] [config] guided-alignment: none
[2023-07-22 08:30:03] [config] guided-alignment-cost: mse
[2023-07-22 08:30:03] [config] guided-alignment-weight: 0.1
[2023-07-22 08:30:03] [config] ignore-model-config: false
[2023-07-22 08:30:03] [config] input-types:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] interpolate-env-vars: false
[2023-07-22 08:30:03] [config] keep-best: false
[2023-07-22 08:30:03] [config] label-smoothing: 0
[2023-07-22 08:30:03] [config] layer-normalization: false
[2023-07-22 08:30:03] [config] learn-rate: 0.0001
[2023-07-22 08:30:03] [config] lemma-dependency: ""
[2023-07-22 08:30:03] [config] lemma-dim-emb: 0
[2023-07-22 08:30:03] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 08:30:03] [config] log-level: info
[2023-07-22 08:30:03] [config] log-time-zone: ""
[2023-07-22 08:30:03] [config] logical-epoch:
[2023-07-22 08:30:03] [config]   - 1e
[2023-07-22 08:30:03] [config]   - 0
[2023-07-22 08:30:03] [config] lr-decay: 0
[2023-07-22 08:30:03] [config] lr-decay-freq: 50000
[2023-07-22 08:30:03] [config] lr-decay-inv-sqrt:
[2023-07-22 08:30:03] [config]   - 0
[2023-07-22 08:30:03] [config] lr-decay-repeat-warmup: false
[2023-07-22 08:30:03] [config] lr-decay-reset-optimizer: false
[2023-07-22 08:30:03] [config] lr-decay-start:
[2023-07-22 08:30:03] [config]   - 10
[2023-07-22 08:30:03] [config]   - 1
[2023-07-22 08:30:03] [config] lr-decay-strategy: epoch+stalled
[2023-07-22 08:30:03] [config] lr-report: false
[2023-07-22 08:30:03] [config] lr-warmup: 0
[2023-07-22 08:30:03] [config] lr-warmup-at-reload: false
[2023-07-22 08:30:03] [config] lr-warmup-cycle: false
[2023-07-22 08:30:03] [config] lr-warmup-start-rate: 0
[2023-07-22 08:30:03] [config] max-length: 300
[2023-07-22 08:30:03] [config] max-length-crop: true
[2023-07-22 08:30:03] [config] max-length-factor: 3
[2023-07-22 08:30:03] [config] maxi-batch: 100
[2023-07-22 08:30:03] [config] maxi-batch-sort: trg
[2023-07-22 08:30:03] [config] mini-batch: 64
[2023-07-22 08:30:03] [config] mini-batch-fit: true
[2023-07-22 08:30:03] [config] mini-batch-fit-step: 10
[2023-07-22 08:30:03] [config] mini-batch-round-up: true
[2023-07-22 08:30:03] [config] mini-batch-track-lr: false
[2023-07-22 08:30:03] [config] mini-batch-warmup: 0
[2023-07-22 08:30:03] [config] mini-batch-words: 0
[2023-07-22 08:30:03] [config] mini-batch-words-ref: 0
[2023-07-22 08:30:03] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_test_grid_lvl2_july_node18/gn_es_test_grid_lvl2_july_node18_max-length_300.npz
[2023-07-22 08:30:03] [config] multi-loss-type: sum
[2023-07-22 08:30:03] [config] n-best: false
[2023-07-22 08:30:03] [config] no-nccl: false
[2023-07-22 08:30:03] [config] no-reload: false
[2023-07-22 08:30:03] [config] no-restore-corpus: false
[2023-07-22 08:30:03] [config] normalize: 0
[2023-07-22 08:30:03] [config] normalize-gradient: false
[2023-07-22 08:30:03] [config] num-devices: 0
[2023-07-22 08:30:03] [config] optimizer: adam
[2023-07-22 08:30:03] [config] optimizer-delay: 1
[2023-07-22 08:30:03] [config] optimizer-params:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] output-omit-bias: false
[2023-07-22 08:30:03] [config] overwrite: true
[2023-07-22 08:30:03] [config] precision:
[2023-07-22 08:30:03] [config]   - float16
[2023-07-22 08:30:03] [config]   - float32
[2023-07-22 08:30:03] [config] pretrained-model: ""
[2023-07-22 08:30:03] [config] quantize-biases: false
[2023-07-22 08:30:03] [config] quantize-bits: 0
[2023-07-22 08:30:03] [config] quantize-log-based: false
[2023-07-22 08:30:03] [config] quantize-optimization-steps: 0
[2023-07-22 08:30:03] [config] quiet: false
[2023-07-22 08:30:03] [config] quiet-translation: true
[2023-07-22 08:30:03] [config] relative-paths: false
[2023-07-22 08:30:03] [config] right-left: false
[2023-07-22 08:30:03] [config] save-freq: 10000u
[2023-07-22 08:30:03] [config] seed: 1234
[2023-07-22 08:30:03] [config] sentencepiece-alphas:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] sentencepiece-max-lines: 2000000
[2023-07-22 08:30:03] [config] sentencepiece-options: ""
[2023-07-22 08:30:03] [config] sharding: global
[2023-07-22 08:30:03] [config] shuffle: data
[2023-07-22 08:30:03] [config] shuffle-in-ram: false
[2023-07-22 08:30:03] [config] sigterm: save-and-exit
[2023-07-22 08:30:03] [config] skip: false
[2023-07-22 08:30:03] [config] sqlite: ""
[2023-07-22 08:30:03] [config] sqlite-drop: false
[2023-07-22 08:30:03] [config] sync-freq: 200u
[2023-07-22 08:30:03] [config] sync-sgd: false
[2023-07-22 08:30:03] [config] tempdir: /tmp
[2023-07-22 08:30:03] [config] tied-embeddings: false
[2023-07-22 08:30:03] [config] tied-embeddings-all: true
[2023-07-22 08:30:03] [config] tied-embeddings-src: false
[2023-07-22 08:30:03] [config] train-embedder-rank:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] train-sets:
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-22 08:30:03] [config] transformer-aan-activation: swish
[2023-07-22 08:30:03] [config] transformer-aan-depth: 2
[2023-07-22 08:30:03] [config] transformer-aan-nogate: false
[2023-07-22 08:30:03] [config] transformer-decoder-autoreg: self-attention
[2023-07-22 08:30:03] [config] transformer-decoder-dim-ffn: 0
[2023-07-22 08:30:03] [config] transformer-decoder-ffn-depth: 0
[2023-07-22 08:30:03] [config] transformer-depth-scaling: false
[2023-07-22 08:30:03] [config] transformer-dim-aan: 2048
[2023-07-22 08:30:03] [config] transformer-dim-ffn: 2048
[2023-07-22 08:30:03] [config] transformer-dropout: 0
[2023-07-22 08:30:03] [config] transformer-dropout-attention: 0
[2023-07-22 08:30:03] [config] transformer-dropout-ffn: 0
[2023-07-22 08:30:03] [config] transformer-ffn-activation: swish
[2023-07-22 08:30:03] [config] transformer-ffn-depth: 2
[2023-07-22 08:30:03] [config] transformer-guided-alignment-layer: last
[2023-07-22 08:30:03] [config] transformer-heads: 8
[2023-07-22 08:30:03] [config] transformer-no-projection: false
[2023-07-22 08:30:03] [config] transformer-pool: false
[2023-07-22 08:30:03] [config] transformer-postprocess: dan
[2023-07-22 08:30:03] [config] transformer-postprocess-emb: d
[2023-07-22 08:30:03] [config] transformer-postprocess-top: ""
[2023-07-22 08:30:03] [config] transformer-preprocess: ""
[2023-07-22 08:30:03] [config] transformer-tied-layers:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] transformer-train-position-embeddings: false
[2023-07-22 08:30:03] [config] tsv: false
[2023-07-22 08:30:03] [config] tsv-fields: 0
[2023-07-22 08:30:03] [config] type: amun
[2023-07-22 08:30:03] [config] ulr: false
[2023-07-22 08:30:03] [config] ulr-dim-emb: 0
[2023-07-22 08:30:03] [config] ulr-dropout: 0
[2023-07-22 08:30:03] [config] ulr-keys-vectors: ""
[2023-07-22 08:30:03] [config] ulr-query-vectors: ""
[2023-07-22 08:30:03] [config] ulr-softmax-temperature: 1
[2023-07-22 08:30:03] [config] ulr-trainable-transformation: false
[2023-07-22 08:30:03] [config] unlikelihood-loss: false
[2023-07-22 08:30:03] [config] valid-freq: 50000000
[2023-07-22 08:30:03] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_test_grid_lvl2_july_node18.log
[2023-07-22 08:30:03] [config] valid-max-length: 1000
[2023-07-22 08:30:03] [config] valid-metrics:
[2023-07-22 08:30:03] [config]   - cross-entropy
[2023-07-22 08:30:03] [config]   - translation
[2023-07-22 08:30:03] [config] valid-mini-batch: 32
[2023-07-22 08:30:03] [config] valid-reset-stalled: false
[2023-07-22 08:30:03] [config] valid-script-args:
[2023-07-22 08:30:03] [config]   []
[2023-07-22 08:30:03] [config] valid-script-path: ""
[2023-07-22 08:30:03] [config] valid-sets:
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-22 08:30:03] [config] valid-translation-output: /docker/home/marianmt/evaluation/test.txt
[2023-07-22 08:30:03] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:30:03] [config] vocabs:
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:30:03] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:30:03] [config] word-penalty: 0
[2023-07-22 08:30:03] [config] word-scores: false
[2023-07-22 08:30:03] [config] workspace: 5500
[2023-07-22 08:30:03] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-22 08:30:03] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:30:03] [training] Using single-device training
[2023-07-22 08:30:04] Synced seed 1234
[2023-07-22 08:30:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens_gridlvl2.txt.gn.spm
[2023-07-22 08:30:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-07-22 08:30:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens_gridlvl2.txt.es.spm
[2023-07-22 08:30:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-07-22 08:30:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-07-22 08:30:04] [MPI rank 0 out of 1]: GPU[0]
[2023-07-22 08:30:04] Training with cost scaling - factor: 256, frequency: 1000, multiplier: 2, minimum: 256
[2023-07-22 08:30:05] [memory] Extending reserved space to 5504 MB (device gpu0)
[2023-07-22 08:30:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-22 08:30:05] [comm] Using global sharding
[2023-07-22 08:30:06] [comm] NCCLCommunicators constructed successfully
[2023-07-22 08:30:06] [training] Using 1 GPUs
[2023-07-22 08:30:06] [logits] Applying loss function for 1 factor(s)
[2023-07-22 08:30:06] [memory] Reserving 80 MB, device gpu0
[2023-07-22 08:30:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-22 08:30:06] [memory] Reserving 80 MB, device gpu0
