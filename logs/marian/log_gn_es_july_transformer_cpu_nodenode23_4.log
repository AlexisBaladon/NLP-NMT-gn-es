[2023-07-11 13:20:25] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:25] [marian] Running on node23.datos.cluster.uy as process 9599 with command line:
[2023-07-11 13:20:25] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:25] [config] after: 0e
[2023-07-11 13:20:25] [config] after-batches: 0
[2023-07-11 13:20:25] [config] after-epochs: 10
[2023-07-11 13:20:25] [config] all-caps-every: 0
[2023-07-11 13:20:25] [config] allow-unk: false
[2023-07-11 13:20:25] [config] authors: false
[2023-07-11 13:20:25] [config] beam-size: 12
[2023-07-11 13:20:25] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:25] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:25] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:25] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:25] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:25] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:25] [config] build-info: ""
[2023-07-11 13:20:25] [config] check-gradient-nan: false
[2023-07-11 13:20:25] [config] check-nan: false
[2023-07-11 13:20:25] [config] cite: false
[2023-07-11 13:20:25] [config] clip-norm: 1
[2023-07-11 13:20:25] [config] cost-scaling:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] cost-type: ce-sum
[2023-07-11 13:20:25] [config] cpu-threads: 0
[2023-07-11 13:20:25] [config] data-threads: 8
[2023-07-11 13:20:25] [config] data-weighting: ""
[2023-07-11 13:20:25] [config] data-weighting-type: sentence
[2023-07-11 13:20:25] [config] dec-cell: gru
[2023-07-11 13:20:25] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:25] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:25] [config] dec-depth: 1
[2023-07-11 13:20:25] [config] devices:
[2023-07-11 13:20:25] [config]   - 0
[2023-07-11 13:20:25] [config] dim-emb: 512
[2023-07-11 13:20:25] [config] dim-rnn: 1024
[2023-07-11 13:20:25] [config] dim-vocabs:
[2023-07-11 13:20:25] [config]   - 0
[2023-07-11 13:20:25] [config]   - 0
[2023-07-11 13:20:25] [config] disp-first: 0
[2023-07-11 13:20:25] [config] disp-freq: 1000u
[2023-07-11 13:20:25] [config] disp-label-counts: true
[2023-07-11 13:20:25] [config] dropout-rnn: 0
[2023-07-11 13:20:25] [config] dropout-src: 0
[2023-07-11 13:20:25] [config] dropout-trg: 0
[2023-07-11 13:20:25] [config] dump-config: ""
[2023-07-11 13:20:25] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] early-stopping: 10
[2023-07-11 13:20:25] [config] early-stopping-on: first
[2023-07-11 13:20:25] [config] embedding-fix-src: false
[2023-07-11 13:20:25] [config] embedding-fix-trg: false
[2023-07-11 13:20:25] [config] embedding-normalization: false
[2023-07-11 13:20:25] [config] embedding-vectors:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] enc-cell: gru
[2023-07-11 13:20:25] [config] enc-cell-depth: 1
[2023-07-11 13:20:25] [config] enc-depth: 1
[2023-07-11 13:20:25] [config] enc-type: bidirectional
[2023-07-11 13:20:25] [config] english-title-case-every: 0
[2023-07-11 13:20:25] [config] exponential-smoothing: 0
[2023-07-11 13:20:25] [config] factor-weight: 1
[2023-07-11 13:20:25] [config] factors-combine: sum
[2023-07-11 13:20:25] [config] factors-dim-emb: 0
[2023-07-11 13:20:25] [config] gradient-checkpointing: false
[2023-07-11 13:20:25] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:25] [config] guided-alignment: none
[2023-07-11 13:20:25] [config] guided-alignment-cost: mse
[2023-07-11 13:20:25] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:25] [config] ignore-model-config: false
[2023-07-11 13:20:25] [config] input-types:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] interpolate-env-vars: false
[2023-07-11 13:20:25] [config] keep-best: false
[2023-07-11 13:20:25] [config] label-smoothing: 0
[2023-07-11 13:20:25] [config] layer-normalization: false
[2023-07-11 13:20:25] [config] learn-rate: 0.0001
[2023-07-11 13:20:25] [config] lemma-dependency: ""
[2023-07-11 13:20:25] [config] lemma-dim-emb: 0
[2023-07-11 13:20:25] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:25] [config] log-level: info
[2023-07-11 13:20:25] [config] log-time-zone: ""
[2023-07-11 13:20:25] [config] logical-epoch:
[2023-07-11 13:20:25] [config]   - 1e
[2023-07-11 13:20:25] [config]   - 0
[2023-07-11 13:20:25] [config] lr-decay: 0
[2023-07-11 13:20:25] [config] lr-decay-freq: 50000
[2023-07-11 13:20:25] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:25] [config]   - 0
[2023-07-11 13:20:25] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:25] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:25] [config] lr-decay-start:
[2023-07-11 13:20:25] [config]   - 10
[2023-07-11 13:20:25] [config]   - 1
[2023-07-11 13:20:25] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:25] [config] lr-report: false
[2023-07-11 13:20:25] [config] lr-warmup: 0
[2023-07-11 13:20:25] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:25] [config] lr-warmup-cycle: false
[2023-07-11 13:20:25] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:25] [config] max-length: 50
[2023-07-11 13:20:25] [config] max-length-crop: false
[2023-07-11 13:20:25] [config] max-length-factor: 3
[2023-07-11 13:20:25] [config] maxi-batch: 100
[2023-07-11 13:20:25] [config] maxi-batch-sort: trg
[2023-07-11 13:20:25] [config] mini-batch: 64
[2023-07-11 13:20:25] [config] mini-batch-fit: false
[2023-07-11 13:20:25] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:25] [config] mini-batch-round-up: true
[2023-07-11 13:20:25] [config] mini-batch-track-lr: false
[2023-07-11 13:20:25] [config] mini-batch-warmup: 0
[2023-07-11 13:20:25] [config] mini-batch-words: 0
[2023-07-11 13:20:25] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:25] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:25] [config] multi-loss-type: sum
[2023-07-11 13:20:25] [config] n-best: false
[2023-07-11 13:20:25] [config] no-nccl: false
[2023-07-11 13:20:25] [config] no-reload: false
[2023-07-11 13:20:25] [config] no-restore-corpus: false
[2023-07-11 13:20:25] [config] normalize: 0
[2023-07-11 13:20:25] [config] normalize-gradient: false
[2023-07-11 13:20:25] [config] num-devices: 3
[2023-07-11 13:20:25] [config] optimizer: adam
[2023-07-11 13:20:25] [config] optimizer-delay: 1
[2023-07-11 13:20:25] [config] optimizer-params:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] output-omit-bias: false
[2023-07-11 13:20:25] [config] overwrite: true
[2023-07-11 13:20:25] [config] precision:
[2023-07-11 13:20:25] [config]   - float32
[2023-07-11 13:20:25] [config]   - float32
[2023-07-11 13:20:25] [config] pretrained-model: ""
[2023-07-11 13:20:25] [config] quantize-biases: false
[2023-07-11 13:20:25] [config] quantize-bits: 0
[2023-07-11 13:20:25] [config] quantize-log-based: false
[2023-07-11 13:20:25] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:25] [config] quiet: false
[2023-07-11 13:20:25] [config] quiet-translation: true
[2023-07-11 13:20:25] [config] relative-paths: false
[2023-07-11 13:20:25] [config] right-left: false
[2023-07-11 13:20:25] [config] save-freq: 10000u
[2023-07-11 13:20:25] [config] seed: 1234
[2023-07-11 13:20:25] [config] sentencepiece-alphas:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:25] [config] sentencepiece-options: ""
[2023-07-11 13:20:25] [config] sharding: global
[2023-07-11 13:20:25] [config] shuffle: data
[2023-07-11 13:20:25] [config] shuffle-in-ram: false
[2023-07-11 13:20:25] [config] sigterm: save-and-exit
[2023-07-11 13:20:25] [config] skip: false
[2023-07-11 13:20:25] [config] sqlite: ""
[2023-07-11 13:20:25] [config] sqlite-drop: false
[2023-07-11 13:20:25] [config] sync-freq: 200u
[2023-07-11 13:20:25] [config] sync-sgd: false
[2023-07-11 13:20:25] [config] tempdir: /tmp
[2023-07-11 13:20:25] [config] tied-embeddings: false
[2023-07-11 13:20:25] [config] tied-embeddings-all: false
[2023-07-11 13:20:25] [config] tied-embeddings-src: false
[2023-07-11 13:20:25] [config] train-embedder-rank:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] train-sets:
[2023-07-11 13:20:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:25] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:25] [config] transformer-aan-activation: swish
[2023-07-11 13:20:25] [config] transformer-aan-depth: 2
[2023-07-11 13:20:25] [config] transformer-aan-nogate: false
[2023-07-11 13:20:25] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:25] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:25] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:25] [config] transformer-depth-scaling: false
[2023-07-11 13:20:25] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:25] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:25] [config] transformer-dropout: 0
[2023-07-11 13:20:25] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:25] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:25] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:25] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:25] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:25] [config] transformer-heads: 8
[2023-07-11 13:20:25] [config] transformer-no-projection: false
[2023-07-11 13:20:25] [config] transformer-pool: false
[2023-07-11 13:20:25] [config] transformer-postprocess: dan
[2023-07-11 13:20:25] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:25] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:25] [config] transformer-preprocess: ""
[2023-07-11 13:20:25] [config] transformer-tied-layers:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:25] [config] tsv: false
[2023-07-11 13:20:25] [config] tsv-fields: 0
[2023-07-11 13:20:25] [config] type: transformer
[2023-07-11 13:20:25] [config] ulr: false
[2023-07-11 13:20:25] [config] ulr-dim-emb: 0
[2023-07-11 13:20:25] [config] ulr-dropout: 0
[2023-07-11 13:20:25] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:25] [config] ulr-query-vectors: ""
[2023-07-11 13:20:25] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:25] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:25] [config] unlikelihood-loss: false
[2023-07-11 13:20:25] [config] valid-freq: 50000000
[2023-07-11 13:20:25] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:25] [config] valid-max-length: 1000
[2023-07-11 13:20:25] [config] valid-metrics:
[2023-07-11 13:20:25] [config]   - cross-entropy
[2023-07-11 13:20:25] [config]   - translation
[2023-07-11 13:20:25] [config] valid-mini-batch: 32
[2023-07-11 13:20:25] [config] valid-reset-stalled: false
[2023-07-11 13:20:25] [config] valid-script-args:
[2023-07-11 13:20:25] [config]   []
[2023-07-11 13:20:25] [config] valid-script-path: ""
[2023-07-11 13:20:25] [config] valid-sets:
[2023-07-11 13:20:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:25] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:25] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:25] [config] vocabs:
[2023-07-11 13:20:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:25] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:25] [config] word-penalty: 0
[2023-07-11 13:20:25] [config] word-scores: false
[2023-07-11 13:20:25] [config] workspace: 2048
[2023-07-11 13:20:25] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:25] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:25] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x556c59ebf5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x556c59d750c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x556c59d2cb9c]    main                                               + 0x3c
[0x7f51e3d750b3]    __libc_start_main                                  + 0xf3
[0x556c59d73cbe]    _start                                             + 0x2e

[2023-07-11 13:20:28] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:28] [marian] Running on node23.datos.cluster.uy as process 9620 with command line:
[2023-07-11 13:20:28] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:28] [config] after: 0e
[2023-07-11 13:20:28] [config] after-batches: 0
[2023-07-11 13:20:28] [config] after-epochs: 20
[2023-07-11 13:20:28] [config] all-caps-every: 0
[2023-07-11 13:20:28] [config] allow-unk: false
[2023-07-11 13:20:28] [config] authors: false
[2023-07-11 13:20:28] [config] beam-size: 12
[2023-07-11 13:20:28] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:28] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:28] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:28] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:28] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:28] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:28] [config] build-info: ""
[2023-07-11 13:20:28] [config] check-gradient-nan: false
[2023-07-11 13:20:28] [config] check-nan: false
[2023-07-11 13:20:28] [config] cite: false
[2023-07-11 13:20:28] [config] clip-norm: 1
[2023-07-11 13:20:28] [config] cost-scaling:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] cost-type: ce-sum
[2023-07-11 13:20:28] [config] cpu-threads: 0
[2023-07-11 13:20:28] [config] data-threads: 8
[2023-07-11 13:20:28] [config] data-weighting: ""
[2023-07-11 13:20:28] [config] data-weighting-type: sentence
[2023-07-11 13:20:28] [config] dec-cell: gru
[2023-07-11 13:20:28] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:28] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:28] [config] dec-depth: 1
[2023-07-11 13:20:28] [config] devices:
[2023-07-11 13:20:28] [config]   - 0
[2023-07-11 13:20:28] [config] dim-emb: 512
[2023-07-11 13:20:28] [config] dim-rnn: 1024
[2023-07-11 13:20:28] [config] dim-vocabs:
[2023-07-11 13:20:28] [config]   - 0
[2023-07-11 13:20:28] [config]   - 0
[2023-07-11 13:20:28] [config] disp-first: 0
[2023-07-11 13:20:28] [config] disp-freq: 1000u
[2023-07-11 13:20:28] [config] disp-label-counts: true
[2023-07-11 13:20:28] [config] dropout-rnn: 0
[2023-07-11 13:20:28] [config] dropout-src: 0
[2023-07-11 13:20:28] [config] dropout-trg: 0
[2023-07-11 13:20:28] [config] dump-config: ""
[2023-07-11 13:20:28] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] early-stopping: 10
[2023-07-11 13:20:28] [config] early-stopping-on: first
[2023-07-11 13:20:28] [config] embedding-fix-src: false
[2023-07-11 13:20:28] [config] embedding-fix-trg: false
[2023-07-11 13:20:28] [config] embedding-normalization: false
[2023-07-11 13:20:28] [config] embedding-vectors:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] enc-cell: gru
[2023-07-11 13:20:28] [config] enc-cell-depth: 1
[2023-07-11 13:20:28] [config] enc-depth: 1
[2023-07-11 13:20:28] [config] enc-type: bidirectional
[2023-07-11 13:20:28] [config] english-title-case-every: 0
[2023-07-11 13:20:28] [config] exponential-smoothing: 0
[2023-07-11 13:20:28] [config] factor-weight: 1
[2023-07-11 13:20:28] [config] factors-combine: sum
[2023-07-11 13:20:28] [config] factors-dim-emb: 0
[2023-07-11 13:20:28] [config] gradient-checkpointing: false
[2023-07-11 13:20:28] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:28] [config] guided-alignment: none
[2023-07-11 13:20:28] [config] guided-alignment-cost: mse
[2023-07-11 13:20:28] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:28] [config] ignore-model-config: false
[2023-07-11 13:20:28] [config] input-types:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] interpolate-env-vars: false
[2023-07-11 13:20:28] [config] keep-best: false
[2023-07-11 13:20:28] [config] label-smoothing: 0
[2023-07-11 13:20:28] [config] layer-normalization: false
[2023-07-11 13:20:28] [config] learn-rate: 0.0001
[2023-07-11 13:20:28] [config] lemma-dependency: ""
[2023-07-11 13:20:28] [config] lemma-dim-emb: 0
[2023-07-11 13:20:28] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:28] [config] log-level: info
[2023-07-11 13:20:28] [config] log-time-zone: ""
[2023-07-11 13:20:28] [config] logical-epoch:
[2023-07-11 13:20:28] [config]   - 1e
[2023-07-11 13:20:28] [config]   - 0
[2023-07-11 13:20:28] [config] lr-decay: 0
[2023-07-11 13:20:28] [config] lr-decay-freq: 50000
[2023-07-11 13:20:28] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:28] [config]   - 0
[2023-07-11 13:20:28] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:28] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:28] [config] lr-decay-start:
[2023-07-11 13:20:28] [config]   - 10
[2023-07-11 13:20:28] [config]   - 1
[2023-07-11 13:20:28] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:28] [config] lr-report: false
[2023-07-11 13:20:28] [config] lr-warmup: 0
[2023-07-11 13:20:28] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:28] [config] lr-warmup-cycle: false
[2023-07-11 13:20:28] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:28] [config] max-length: 50
[2023-07-11 13:20:28] [config] max-length-crop: false
[2023-07-11 13:20:28] [config] max-length-factor: 3
[2023-07-11 13:20:28] [config] maxi-batch: 100
[2023-07-11 13:20:28] [config] maxi-batch-sort: trg
[2023-07-11 13:20:28] [config] mini-batch: 64
[2023-07-11 13:20:28] [config] mini-batch-fit: false
[2023-07-11 13:20:28] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:28] [config] mini-batch-round-up: true
[2023-07-11 13:20:28] [config] mini-batch-track-lr: false
[2023-07-11 13:20:28] [config] mini-batch-warmup: 0
[2023-07-11 13:20:28] [config] mini-batch-words: 0
[2023-07-11 13:20:28] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:28] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:28] [config] multi-loss-type: sum
[2023-07-11 13:20:28] [config] n-best: false
[2023-07-11 13:20:28] [config] no-nccl: false
[2023-07-11 13:20:28] [config] no-reload: false
[2023-07-11 13:20:28] [config] no-restore-corpus: false
[2023-07-11 13:20:28] [config] normalize: 0
[2023-07-11 13:20:28] [config] normalize-gradient: false
[2023-07-11 13:20:28] [config] num-devices: 3
[2023-07-11 13:20:28] [config] optimizer: adam
[2023-07-11 13:20:28] [config] optimizer-delay: 1
[2023-07-11 13:20:28] [config] optimizer-params:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] output-omit-bias: false
[2023-07-11 13:20:28] [config] overwrite: true
[2023-07-11 13:20:28] [config] precision:
[2023-07-11 13:20:28] [config]   - float32
[2023-07-11 13:20:28] [config]   - float32
[2023-07-11 13:20:28] [config] pretrained-model: ""
[2023-07-11 13:20:28] [config] quantize-biases: false
[2023-07-11 13:20:28] [config] quantize-bits: 0
[2023-07-11 13:20:28] [config] quantize-log-based: false
[2023-07-11 13:20:28] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:28] [config] quiet: false
[2023-07-11 13:20:28] [config] quiet-translation: true
[2023-07-11 13:20:28] [config] relative-paths: false
[2023-07-11 13:20:28] [config] right-left: false
[2023-07-11 13:20:28] [config] save-freq: 10000u
[2023-07-11 13:20:28] [config] seed: 1234
[2023-07-11 13:20:28] [config] sentencepiece-alphas:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:28] [config] sentencepiece-options: ""
[2023-07-11 13:20:28] [config] sharding: global
[2023-07-11 13:20:28] [config] shuffle: data
[2023-07-11 13:20:28] [config] shuffle-in-ram: false
[2023-07-11 13:20:28] [config] sigterm: save-and-exit
[2023-07-11 13:20:28] [config] skip: false
[2023-07-11 13:20:28] [config] sqlite: ""
[2023-07-11 13:20:28] [config] sqlite-drop: false
[2023-07-11 13:20:28] [config] sync-freq: 200u
[2023-07-11 13:20:28] [config] sync-sgd: false
[2023-07-11 13:20:28] [config] tempdir: /tmp
[2023-07-11 13:20:28] [config] tied-embeddings: false
[2023-07-11 13:20:28] [config] tied-embeddings-all: false
[2023-07-11 13:20:28] [config] tied-embeddings-src: false
[2023-07-11 13:20:28] [config] train-embedder-rank:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] train-sets:
[2023-07-11 13:20:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:28] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:28] [config] transformer-aan-activation: swish
[2023-07-11 13:20:28] [config] transformer-aan-depth: 2
[2023-07-11 13:20:28] [config] transformer-aan-nogate: false
[2023-07-11 13:20:28] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:28] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:28] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:28] [config] transformer-depth-scaling: false
[2023-07-11 13:20:28] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:28] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:28] [config] transformer-dropout: 0
[2023-07-11 13:20:28] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:28] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:28] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:28] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:28] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:28] [config] transformer-heads: 8
[2023-07-11 13:20:28] [config] transformer-no-projection: false
[2023-07-11 13:20:28] [config] transformer-pool: false
[2023-07-11 13:20:28] [config] transformer-postprocess: dan
[2023-07-11 13:20:28] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:28] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:28] [config] transformer-preprocess: ""
[2023-07-11 13:20:28] [config] transformer-tied-layers:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:28] [config] tsv: false
[2023-07-11 13:20:28] [config] tsv-fields: 0
[2023-07-11 13:20:28] [config] type: transformer
[2023-07-11 13:20:28] [config] ulr: false
[2023-07-11 13:20:28] [config] ulr-dim-emb: 0
[2023-07-11 13:20:28] [config] ulr-dropout: 0
[2023-07-11 13:20:28] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:28] [config] ulr-query-vectors: ""
[2023-07-11 13:20:28] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:28] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:28] [config] unlikelihood-loss: false
[2023-07-11 13:20:28] [config] valid-freq: 50000000
[2023-07-11 13:20:28] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:28] [config] valid-max-length: 1000
[2023-07-11 13:20:28] [config] valid-metrics:
[2023-07-11 13:20:28] [config]   - cross-entropy
[2023-07-11 13:20:28] [config]   - translation
[2023-07-11 13:20:28] [config] valid-mini-batch: 32
[2023-07-11 13:20:28] [config] valid-reset-stalled: false
[2023-07-11 13:20:28] [config] valid-script-args:
[2023-07-11 13:20:28] [config]   []
[2023-07-11 13:20:28] [config] valid-script-path: ""
[2023-07-11 13:20:28] [config] valid-sets:
[2023-07-11 13:20:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:28] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:28] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:28] [config] vocabs:
[2023-07-11 13:20:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:28] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:28] [config] word-penalty: 0
[2023-07-11 13:20:28] [config] word-scores: false
[2023-07-11 13:20:28] [config] workspace: 2048
[2023-07-11 13:20:28] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:28] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:28] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x56367946e5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x5636793240c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x5636792dbb9c]    main                                               + 0x3c
[0x7f8546a640b3]    __libc_start_main                                  + 0xf3
[0x563679322cbe]    _start                                             + 0x2e

[2023-07-11 13:20:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:32] [marian] Running on node23.datos.cluster.uy as process 9625 with command line:
[2023-07-11 13:20:32] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:32] [config] after: 0e
[2023-07-11 13:20:32] [config] after-batches: 0
[2023-07-11 13:20:32] [config] after-epochs: 30
[2023-07-11 13:20:32] [config] all-caps-every: 0
[2023-07-11 13:20:32] [config] allow-unk: false
[2023-07-11 13:20:32] [config] authors: false
[2023-07-11 13:20:32] [config] beam-size: 12
[2023-07-11 13:20:32] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:32] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:32] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:32] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:32] [config] build-info: ""
[2023-07-11 13:20:32] [config] check-gradient-nan: false
[2023-07-11 13:20:32] [config] check-nan: false
[2023-07-11 13:20:32] [config] cite: false
[2023-07-11 13:20:32] [config] clip-norm: 1
[2023-07-11 13:20:32] [config] cost-scaling:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] cost-type: ce-sum
[2023-07-11 13:20:32] [config] cpu-threads: 0
[2023-07-11 13:20:32] [config] data-threads: 8
[2023-07-11 13:20:32] [config] data-weighting: ""
[2023-07-11 13:20:32] [config] data-weighting-type: sentence
[2023-07-11 13:20:32] [config] dec-cell: gru
[2023-07-11 13:20:32] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:32] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:32] [config] dec-depth: 1
[2023-07-11 13:20:32] [config] devices:
[2023-07-11 13:20:32] [config]   - 0
[2023-07-11 13:20:32] [config] dim-emb: 512
[2023-07-11 13:20:32] [config] dim-rnn: 1024
[2023-07-11 13:20:32] [config] dim-vocabs:
[2023-07-11 13:20:32] [config]   - 0
[2023-07-11 13:20:32] [config]   - 0
[2023-07-11 13:20:32] [config] disp-first: 0
[2023-07-11 13:20:32] [config] disp-freq: 1000u
[2023-07-11 13:20:32] [config] disp-label-counts: true
[2023-07-11 13:20:32] [config] dropout-rnn: 0
[2023-07-11 13:20:32] [config] dropout-src: 0
[2023-07-11 13:20:32] [config] dropout-trg: 0
[2023-07-11 13:20:32] [config] dump-config: ""
[2023-07-11 13:20:32] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] early-stopping: 10
[2023-07-11 13:20:32] [config] early-stopping-on: first
[2023-07-11 13:20:32] [config] embedding-fix-src: false
[2023-07-11 13:20:32] [config] embedding-fix-trg: false
[2023-07-11 13:20:32] [config] embedding-normalization: false
[2023-07-11 13:20:32] [config] embedding-vectors:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] enc-cell: gru
[2023-07-11 13:20:32] [config] enc-cell-depth: 1
[2023-07-11 13:20:32] [config] enc-depth: 1
[2023-07-11 13:20:32] [config] enc-type: bidirectional
[2023-07-11 13:20:32] [config] english-title-case-every: 0
[2023-07-11 13:20:32] [config] exponential-smoothing: 0
[2023-07-11 13:20:32] [config] factor-weight: 1
[2023-07-11 13:20:32] [config] factors-combine: sum
[2023-07-11 13:20:32] [config] factors-dim-emb: 0
[2023-07-11 13:20:32] [config] gradient-checkpointing: false
[2023-07-11 13:20:32] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:32] [config] guided-alignment: none
[2023-07-11 13:20:32] [config] guided-alignment-cost: mse
[2023-07-11 13:20:32] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:32] [config] ignore-model-config: false
[2023-07-11 13:20:32] [config] input-types:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] interpolate-env-vars: false
[2023-07-11 13:20:32] [config] keep-best: false
[2023-07-11 13:20:32] [config] label-smoothing: 0
[2023-07-11 13:20:32] [config] layer-normalization: false
[2023-07-11 13:20:32] [config] learn-rate: 0.0001
[2023-07-11 13:20:32] [config] lemma-dependency: ""
[2023-07-11 13:20:32] [config] lemma-dim-emb: 0
[2023-07-11 13:20:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:32] [config] log-level: info
[2023-07-11 13:20:32] [config] log-time-zone: ""
[2023-07-11 13:20:32] [config] logical-epoch:
[2023-07-11 13:20:32] [config]   - 1e
[2023-07-11 13:20:32] [config]   - 0
[2023-07-11 13:20:32] [config] lr-decay: 0
[2023-07-11 13:20:32] [config] lr-decay-freq: 50000
[2023-07-11 13:20:32] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:32] [config]   - 0
[2023-07-11 13:20:32] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:32] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:32] [config] lr-decay-start:
[2023-07-11 13:20:32] [config]   - 10
[2023-07-11 13:20:32] [config]   - 1
[2023-07-11 13:20:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:32] [config] lr-report: false
[2023-07-11 13:20:32] [config] lr-warmup: 0
[2023-07-11 13:20:32] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:32] [config] lr-warmup-cycle: false
[2023-07-11 13:20:32] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:32] [config] max-length: 50
[2023-07-11 13:20:32] [config] max-length-crop: false
[2023-07-11 13:20:32] [config] max-length-factor: 3
[2023-07-11 13:20:32] [config] maxi-batch: 100
[2023-07-11 13:20:32] [config] maxi-batch-sort: trg
[2023-07-11 13:20:32] [config] mini-batch: 64
[2023-07-11 13:20:32] [config] mini-batch-fit: false
[2023-07-11 13:20:32] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:32] [config] mini-batch-round-up: true
[2023-07-11 13:20:32] [config] mini-batch-track-lr: false
[2023-07-11 13:20:32] [config] mini-batch-warmup: 0
[2023-07-11 13:20:32] [config] mini-batch-words: 0
[2023-07-11 13:20:32] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:32] [config] multi-loss-type: sum
[2023-07-11 13:20:32] [config] n-best: false
[2023-07-11 13:20:32] [config] no-nccl: false
[2023-07-11 13:20:32] [config] no-reload: false
[2023-07-11 13:20:32] [config] no-restore-corpus: false
[2023-07-11 13:20:32] [config] normalize: 0
[2023-07-11 13:20:32] [config] normalize-gradient: false
[2023-07-11 13:20:32] [config] num-devices: 3
[2023-07-11 13:20:32] [config] optimizer: adam
[2023-07-11 13:20:32] [config] optimizer-delay: 1
[2023-07-11 13:20:32] [config] optimizer-params:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] output-omit-bias: false
[2023-07-11 13:20:32] [config] overwrite: true
[2023-07-11 13:20:32] [config] precision:
[2023-07-11 13:20:32] [config]   - float32
[2023-07-11 13:20:32] [config]   - float32
[2023-07-11 13:20:32] [config] pretrained-model: ""
[2023-07-11 13:20:32] [config] quantize-biases: false
[2023-07-11 13:20:32] [config] quantize-bits: 0
[2023-07-11 13:20:32] [config] quantize-log-based: false
[2023-07-11 13:20:32] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:32] [config] quiet: false
[2023-07-11 13:20:32] [config] quiet-translation: true
[2023-07-11 13:20:32] [config] relative-paths: false
[2023-07-11 13:20:32] [config] right-left: false
[2023-07-11 13:20:32] [config] save-freq: 10000u
[2023-07-11 13:20:32] [config] seed: 1234
[2023-07-11 13:20:32] [config] sentencepiece-alphas:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:32] [config] sentencepiece-options: ""
[2023-07-11 13:20:32] [config] sharding: global
[2023-07-11 13:20:32] [config] shuffle: data
[2023-07-11 13:20:32] [config] shuffle-in-ram: false
[2023-07-11 13:20:32] [config] sigterm: save-and-exit
[2023-07-11 13:20:32] [config] skip: false
[2023-07-11 13:20:32] [config] sqlite: ""
[2023-07-11 13:20:32] [config] sqlite-drop: false
[2023-07-11 13:20:32] [config] sync-freq: 200u
[2023-07-11 13:20:32] [config] sync-sgd: false
[2023-07-11 13:20:32] [config] tempdir: /tmp
[2023-07-11 13:20:32] [config] tied-embeddings: false
[2023-07-11 13:20:32] [config] tied-embeddings-all: false
[2023-07-11 13:20:32] [config] tied-embeddings-src: false
[2023-07-11 13:20:32] [config] train-embedder-rank:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] train-sets:
[2023-07-11 13:20:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:32] [config] transformer-aan-activation: swish
[2023-07-11 13:20:32] [config] transformer-aan-depth: 2
[2023-07-11 13:20:32] [config] transformer-aan-nogate: false
[2023-07-11 13:20:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:32] [config] transformer-depth-scaling: false
[2023-07-11 13:20:32] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:32] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:32] [config] transformer-dropout: 0
[2023-07-11 13:20:32] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:32] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:32] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:32] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:32] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:32] [config] transformer-heads: 8
[2023-07-11 13:20:32] [config] transformer-no-projection: false
[2023-07-11 13:20:32] [config] transformer-pool: false
[2023-07-11 13:20:32] [config] transformer-postprocess: dan
[2023-07-11 13:20:32] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:32] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:32] [config] transformer-preprocess: ""
[2023-07-11 13:20:32] [config] transformer-tied-layers:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:32] [config] tsv: false
[2023-07-11 13:20:32] [config] tsv-fields: 0
[2023-07-11 13:20:32] [config] type: transformer
[2023-07-11 13:20:32] [config] ulr: false
[2023-07-11 13:20:32] [config] ulr-dim-emb: 0
[2023-07-11 13:20:32] [config] ulr-dropout: 0
[2023-07-11 13:20:32] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:32] [config] ulr-query-vectors: ""
[2023-07-11 13:20:32] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:32] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:32] [config] unlikelihood-loss: false
[2023-07-11 13:20:32] [config] valid-freq: 50000000
[2023-07-11 13:20:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:32] [config] valid-max-length: 1000
[2023-07-11 13:20:32] [config] valid-metrics:
[2023-07-11 13:20:32] [config]   - cross-entropy
[2023-07-11 13:20:32] [config]   - translation
[2023-07-11 13:20:32] [config] valid-mini-batch: 32
[2023-07-11 13:20:32] [config] valid-reset-stalled: false
[2023-07-11 13:20:32] [config] valid-script-args:
[2023-07-11 13:20:32] [config]   []
[2023-07-11 13:20:32] [config] valid-script-path: ""
[2023-07-11 13:20:32] [config] valid-sets:
[2023-07-11 13:20:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:32] [config] vocabs:
[2023-07-11 13:20:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:32] [config] word-penalty: 0
[2023-07-11 13:20:32] [config] word-scores: false
[2023-07-11 13:20:32] [config] workspace: 2048
[2023-07-11 13:20:32] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:32] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:32] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x55ea5b68c5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x55ea5b5420c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x55ea5b4f9b9c]    main                                               + 0x3c
[0x7f8167a530b3]    __libc_start_main                                  + 0xf3
[0x55ea5b540cbe]    _start                                             + 0x2e

[2023-07-11 13:20:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:34] [marian] Running on node23.datos.cluster.uy as process 9630 with command line:
[2023-07-11 13:20:34] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:34] [config] after: 0e
[2023-07-11 13:20:34] [config] after-batches: 0
[2023-07-11 13:20:34] [config] after-epochs: 40
[2023-07-11 13:20:34] [config] all-caps-every: 0
[2023-07-11 13:20:34] [config] allow-unk: false
[2023-07-11 13:20:34] [config] authors: false
[2023-07-11 13:20:34] [config] beam-size: 12
[2023-07-11 13:20:34] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:34] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:34] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:34] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:34] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:34] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:34] [config] build-info: ""
[2023-07-11 13:20:34] [config] check-gradient-nan: false
[2023-07-11 13:20:34] [config] check-nan: false
[2023-07-11 13:20:34] [config] cite: false
[2023-07-11 13:20:34] [config] clip-norm: 1
[2023-07-11 13:20:34] [config] cost-scaling:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] cost-type: ce-sum
[2023-07-11 13:20:34] [config] cpu-threads: 0
[2023-07-11 13:20:34] [config] data-threads: 8
[2023-07-11 13:20:34] [config] data-weighting: ""
[2023-07-11 13:20:34] [config] data-weighting-type: sentence
[2023-07-11 13:20:34] [config] dec-cell: gru
[2023-07-11 13:20:34] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:34] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:34] [config] dec-depth: 1
[2023-07-11 13:20:34] [config] devices:
[2023-07-11 13:20:34] [config]   - 0
[2023-07-11 13:20:34] [config] dim-emb: 512
[2023-07-11 13:20:34] [config] dim-rnn: 1024
[2023-07-11 13:20:34] [config] dim-vocabs:
[2023-07-11 13:20:34] [config]   - 0
[2023-07-11 13:20:34] [config]   - 0
[2023-07-11 13:20:34] [config] disp-first: 0
[2023-07-11 13:20:34] [config] disp-freq: 1000u
[2023-07-11 13:20:34] [config] disp-label-counts: true
[2023-07-11 13:20:34] [config] dropout-rnn: 0
[2023-07-11 13:20:34] [config] dropout-src: 0
[2023-07-11 13:20:34] [config] dropout-trg: 0
[2023-07-11 13:20:34] [config] dump-config: ""
[2023-07-11 13:20:34] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] early-stopping: 10
[2023-07-11 13:20:34] [config] early-stopping-on: first
[2023-07-11 13:20:34] [config] embedding-fix-src: false
[2023-07-11 13:20:34] [config] embedding-fix-trg: false
[2023-07-11 13:20:34] [config] embedding-normalization: false
[2023-07-11 13:20:34] [config] embedding-vectors:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] enc-cell: gru
[2023-07-11 13:20:34] [config] enc-cell-depth: 1
[2023-07-11 13:20:34] [config] enc-depth: 1
[2023-07-11 13:20:34] [config] enc-type: bidirectional
[2023-07-11 13:20:34] [config] english-title-case-every: 0
[2023-07-11 13:20:34] [config] exponential-smoothing: 0
[2023-07-11 13:20:34] [config] factor-weight: 1
[2023-07-11 13:20:34] [config] factors-combine: sum
[2023-07-11 13:20:34] [config] factors-dim-emb: 0
[2023-07-11 13:20:34] [config] gradient-checkpointing: false
[2023-07-11 13:20:34] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:34] [config] guided-alignment: none
[2023-07-11 13:20:34] [config] guided-alignment-cost: mse
[2023-07-11 13:20:34] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:34] [config] ignore-model-config: false
[2023-07-11 13:20:34] [config] input-types:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] interpolate-env-vars: false
[2023-07-11 13:20:34] [config] keep-best: false
[2023-07-11 13:20:34] [config] label-smoothing: 0
[2023-07-11 13:20:34] [config] layer-normalization: false
[2023-07-11 13:20:34] [config] learn-rate: 0.0001
[2023-07-11 13:20:34] [config] lemma-dependency: ""
[2023-07-11 13:20:34] [config] lemma-dim-emb: 0
[2023-07-11 13:20:34] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:34] [config] log-level: info
[2023-07-11 13:20:34] [config] log-time-zone: ""
[2023-07-11 13:20:34] [config] logical-epoch:
[2023-07-11 13:20:34] [config]   - 1e
[2023-07-11 13:20:34] [config]   - 0
[2023-07-11 13:20:34] [config] lr-decay: 0
[2023-07-11 13:20:34] [config] lr-decay-freq: 50000
[2023-07-11 13:20:34] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:34] [config]   - 0
[2023-07-11 13:20:34] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:34] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:34] [config] lr-decay-start:
[2023-07-11 13:20:34] [config]   - 10
[2023-07-11 13:20:34] [config]   - 1
[2023-07-11 13:20:34] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:34] [config] lr-report: false
[2023-07-11 13:20:34] [config] lr-warmup: 0
[2023-07-11 13:20:34] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:34] [config] lr-warmup-cycle: false
[2023-07-11 13:20:34] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:34] [config] max-length: 50
[2023-07-11 13:20:34] [config] max-length-crop: false
[2023-07-11 13:20:34] [config] max-length-factor: 3
[2023-07-11 13:20:34] [config] maxi-batch: 100
[2023-07-11 13:20:34] [config] maxi-batch-sort: trg
[2023-07-11 13:20:34] [config] mini-batch: 64
[2023-07-11 13:20:34] [config] mini-batch-fit: false
[2023-07-11 13:20:34] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:34] [config] mini-batch-round-up: true
[2023-07-11 13:20:34] [config] mini-batch-track-lr: false
[2023-07-11 13:20:34] [config] mini-batch-warmup: 0
[2023-07-11 13:20:34] [config] mini-batch-words: 0
[2023-07-11 13:20:34] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:34] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:34] [config] multi-loss-type: sum
[2023-07-11 13:20:34] [config] n-best: false
[2023-07-11 13:20:34] [config] no-nccl: false
[2023-07-11 13:20:34] [config] no-reload: false
[2023-07-11 13:20:34] [config] no-restore-corpus: false
[2023-07-11 13:20:34] [config] normalize: 0
[2023-07-11 13:20:34] [config] normalize-gradient: false
[2023-07-11 13:20:34] [config] num-devices: 3
[2023-07-11 13:20:34] [config] optimizer: adam
[2023-07-11 13:20:34] [config] optimizer-delay: 1
[2023-07-11 13:20:34] [config] optimizer-params:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] output-omit-bias: false
[2023-07-11 13:20:34] [config] overwrite: true
[2023-07-11 13:20:34] [config] precision:
[2023-07-11 13:20:34] [config]   - float32
[2023-07-11 13:20:34] [config]   - float32
[2023-07-11 13:20:34] [config] pretrained-model: ""
[2023-07-11 13:20:34] [config] quantize-biases: false
[2023-07-11 13:20:34] [config] quantize-bits: 0
[2023-07-11 13:20:34] [config] quantize-log-based: false
[2023-07-11 13:20:34] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:34] [config] quiet: false
[2023-07-11 13:20:34] [config] quiet-translation: true
[2023-07-11 13:20:34] [config] relative-paths: false
[2023-07-11 13:20:34] [config] right-left: false
[2023-07-11 13:20:34] [config] save-freq: 10000u
[2023-07-11 13:20:34] [config] seed: 1234
[2023-07-11 13:20:34] [config] sentencepiece-alphas:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:34] [config] sentencepiece-options: ""
[2023-07-11 13:20:34] [config] sharding: global
[2023-07-11 13:20:34] [config] shuffle: data
[2023-07-11 13:20:34] [config] shuffle-in-ram: false
[2023-07-11 13:20:34] [config] sigterm: save-and-exit
[2023-07-11 13:20:34] [config] skip: false
[2023-07-11 13:20:34] [config] sqlite: ""
[2023-07-11 13:20:34] [config] sqlite-drop: false
[2023-07-11 13:20:34] [config] sync-freq: 200u
[2023-07-11 13:20:34] [config] sync-sgd: false
[2023-07-11 13:20:34] [config] tempdir: /tmp
[2023-07-11 13:20:34] [config] tied-embeddings: false
[2023-07-11 13:20:34] [config] tied-embeddings-all: false
[2023-07-11 13:20:34] [config] tied-embeddings-src: false
[2023-07-11 13:20:34] [config] train-embedder-rank:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] train-sets:
[2023-07-11 13:20:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:34] [config] transformer-aan-activation: swish
[2023-07-11 13:20:34] [config] transformer-aan-depth: 2
[2023-07-11 13:20:34] [config] transformer-aan-nogate: false
[2023-07-11 13:20:34] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:34] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:34] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:34] [config] transformer-depth-scaling: false
[2023-07-11 13:20:34] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:34] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:34] [config] transformer-dropout: 0
[2023-07-11 13:20:34] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:34] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:34] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:34] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:34] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:34] [config] transformer-heads: 8
[2023-07-11 13:20:34] [config] transformer-no-projection: false
[2023-07-11 13:20:34] [config] transformer-pool: false
[2023-07-11 13:20:34] [config] transformer-postprocess: dan
[2023-07-11 13:20:34] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:34] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:34] [config] transformer-preprocess: ""
[2023-07-11 13:20:34] [config] transformer-tied-layers:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:34] [config] tsv: false
[2023-07-11 13:20:34] [config] tsv-fields: 0
[2023-07-11 13:20:34] [config] type: transformer
[2023-07-11 13:20:34] [config] ulr: false
[2023-07-11 13:20:34] [config] ulr-dim-emb: 0
[2023-07-11 13:20:34] [config] ulr-dropout: 0
[2023-07-11 13:20:34] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:34] [config] ulr-query-vectors: ""
[2023-07-11 13:20:34] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:34] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:34] [config] unlikelihood-loss: false
[2023-07-11 13:20:34] [config] valid-freq: 50000000
[2023-07-11 13:20:34] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:34] [config] valid-max-length: 1000
[2023-07-11 13:20:34] [config] valid-metrics:
[2023-07-11 13:20:34] [config]   - cross-entropy
[2023-07-11 13:20:34] [config]   - translation
[2023-07-11 13:20:34] [config] valid-mini-batch: 32
[2023-07-11 13:20:34] [config] valid-reset-stalled: false
[2023-07-11 13:20:34] [config] valid-script-args:
[2023-07-11 13:20:34] [config]   []
[2023-07-11 13:20:34] [config] valid-script-path: ""
[2023-07-11 13:20:34] [config] valid-sets:
[2023-07-11 13:20:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:34] [config] vocabs:
[2023-07-11 13:20:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:34] [config] word-penalty: 0
[2023-07-11 13:20:34] [config] word-scores: false
[2023-07-11 13:20:34] [config] workspace: 2048
[2023-07-11 13:20:34] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:34] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:34] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x55e2c51ce5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x55e2c50840c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x55e2c503bb9c]    main                                               + 0x3c
[0x7fc9960950b3]    __libc_start_main                                  + 0xf3
[0x55e2c5082cbe]    _start                                             + 0x2e

[2023-07-11 13:20:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:37] [marian] Running on node23.datos.cluster.uy as process 9635 with command line:
[2023-07-11 13:20:37] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:37] [config] after: 0e
[2023-07-11 13:20:37] [config] after-batches: 0
[2023-07-11 13:20:37] [config] after-epochs: 50
[2023-07-11 13:20:37] [config] all-caps-every: 0
[2023-07-11 13:20:37] [config] allow-unk: false
[2023-07-11 13:20:37] [config] authors: false
[2023-07-11 13:20:37] [config] beam-size: 12
[2023-07-11 13:20:37] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:37] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:37] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:37] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:37] [config] build-info: ""
[2023-07-11 13:20:37] [config] check-gradient-nan: false
[2023-07-11 13:20:37] [config] check-nan: false
[2023-07-11 13:20:37] [config] cite: false
[2023-07-11 13:20:37] [config] clip-norm: 1
[2023-07-11 13:20:37] [config] cost-scaling:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] cost-type: ce-sum
[2023-07-11 13:20:37] [config] cpu-threads: 0
[2023-07-11 13:20:37] [config] data-threads: 8
[2023-07-11 13:20:37] [config] data-weighting: ""
[2023-07-11 13:20:37] [config] data-weighting-type: sentence
[2023-07-11 13:20:37] [config] dec-cell: gru
[2023-07-11 13:20:37] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:37] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:37] [config] dec-depth: 1
[2023-07-11 13:20:37] [config] devices:
[2023-07-11 13:20:37] [config]   - 0
[2023-07-11 13:20:37] [config] dim-emb: 512
[2023-07-11 13:20:37] [config] dim-rnn: 1024
[2023-07-11 13:20:37] [config] dim-vocabs:
[2023-07-11 13:20:37] [config]   - 0
[2023-07-11 13:20:37] [config]   - 0
[2023-07-11 13:20:37] [config] disp-first: 0
[2023-07-11 13:20:37] [config] disp-freq: 1000u
[2023-07-11 13:20:37] [config] disp-label-counts: true
[2023-07-11 13:20:37] [config] dropout-rnn: 0
[2023-07-11 13:20:37] [config] dropout-src: 0
[2023-07-11 13:20:37] [config] dropout-trg: 0
[2023-07-11 13:20:37] [config] dump-config: ""
[2023-07-11 13:20:37] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] early-stopping: 10
[2023-07-11 13:20:37] [config] early-stopping-on: first
[2023-07-11 13:20:37] [config] embedding-fix-src: false
[2023-07-11 13:20:37] [config] embedding-fix-trg: false
[2023-07-11 13:20:37] [config] embedding-normalization: false
[2023-07-11 13:20:37] [config] embedding-vectors:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] enc-cell: gru
[2023-07-11 13:20:37] [config] enc-cell-depth: 1
[2023-07-11 13:20:37] [config] enc-depth: 1
[2023-07-11 13:20:37] [config] enc-type: bidirectional
[2023-07-11 13:20:37] [config] english-title-case-every: 0
[2023-07-11 13:20:37] [config] exponential-smoothing: 0
[2023-07-11 13:20:37] [config] factor-weight: 1
[2023-07-11 13:20:37] [config] factors-combine: sum
[2023-07-11 13:20:37] [config] factors-dim-emb: 0
[2023-07-11 13:20:37] [config] gradient-checkpointing: false
[2023-07-11 13:20:37] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:37] [config] guided-alignment: none
[2023-07-11 13:20:37] [config] guided-alignment-cost: mse
[2023-07-11 13:20:37] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:37] [config] ignore-model-config: false
[2023-07-11 13:20:37] [config] input-types:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] interpolate-env-vars: false
[2023-07-11 13:20:37] [config] keep-best: false
[2023-07-11 13:20:37] [config] label-smoothing: 0
[2023-07-11 13:20:37] [config] layer-normalization: false
[2023-07-11 13:20:37] [config] learn-rate: 0.0001
[2023-07-11 13:20:37] [config] lemma-dependency: ""
[2023-07-11 13:20:37] [config] lemma-dim-emb: 0
[2023-07-11 13:20:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:37] [config] log-level: info
[2023-07-11 13:20:37] [config] log-time-zone: ""
[2023-07-11 13:20:37] [config] logical-epoch:
[2023-07-11 13:20:37] [config]   - 1e
[2023-07-11 13:20:37] [config]   - 0
[2023-07-11 13:20:37] [config] lr-decay: 0
[2023-07-11 13:20:37] [config] lr-decay-freq: 50000
[2023-07-11 13:20:37] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:37] [config]   - 0
[2023-07-11 13:20:37] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:37] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:37] [config] lr-decay-start:
[2023-07-11 13:20:37] [config]   - 10
[2023-07-11 13:20:37] [config]   - 1
[2023-07-11 13:20:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:37] [config] lr-report: false
[2023-07-11 13:20:37] [config] lr-warmup: 0
[2023-07-11 13:20:37] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:37] [config] lr-warmup-cycle: false
[2023-07-11 13:20:37] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:37] [config] max-length: 50
[2023-07-11 13:20:37] [config] max-length-crop: false
[2023-07-11 13:20:37] [config] max-length-factor: 3
[2023-07-11 13:20:37] [config] maxi-batch: 100
[2023-07-11 13:20:37] [config] maxi-batch-sort: trg
[2023-07-11 13:20:37] [config] mini-batch: 64
[2023-07-11 13:20:37] [config] mini-batch-fit: false
[2023-07-11 13:20:37] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:37] [config] mini-batch-round-up: true
[2023-07-11 13:20:37] [config] mini-batch-track-lr: false
[2023-07-11 13:20:37] [config] mini-batch-warmup: 0
[2023-07-11 13:20:37] [config] mini-batch-words: 0
[2023-07-11 13:20:37] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:37] [config] multi-loss-type: sum
[2023-07-11 13:20:37] [config] n-best: false
[2023-07-11 13:20:37] [config] no-nccl: false
[2023-07-11 13:20:37] [config] no-reload: false
[2023-07-11 13:20:37] [config] no-restore-corpus: false
[2023-07-11 13:20:37] [config] normalize: 0
[2023-07-11 13:20:37] [config] normalize-gradient: false
[2023-07-11 13:20:37] [config] num-devices: 3
[2023-07-11 13:20:37] [config] optimizer: adam
[2023-07-11 13:20:37] [config] optimizer-delay: 1
[2023-07-11 13:20:37] [config] optimizer-params:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] output-omit-bias: false
[2023-07-11 13:20:37] [config] overwrite: true
[2023-07-11 13:20:37] [config] precision:
[2023-07-11 13:20:37] [config]   - float32
[2023-07-11 13:20:37] [config]   - float32
[2023-07-11 13:20:37] [config] pretrained-model: ""
[2023-07-11 13:20:37] [config] quantize-biases: false
[2023-07-11 13:20:37] [config] quantize-bits: 0
[2023-07-11 13:20:37] [config] quantize-log-based: false
[2023-07-11 13:20:37] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:37] [config] quiet: false
[2023-07-11 13:20:37] [config] quiet-translation: true
[2023-07-11 13:20:37] [config] relative-paths: false
[2023-07-11 13:20:37] [config] right-left: false
[2023-07-11 13:20:37] [config] save-freq: 10000u
[2023-07-11 13:20:37] [config] seed: 1234
[2023-07-11 13:20:37] [config] sentencepiece-alphas:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:37] [config] sentencepiece-options: ""
[2023-07-11 13:20:37] [config] sharding: global
[2023-07-11 13:20:37] [config] shuffle: data
[2023-07-11 13:20:37] [config] shuffle-in-ram: false
[2023-07-11 13:20:37] [config] sigterm: save-and-exit
[2023-07-11 13:20:37] [config] skip: false
[2023-07-11 13:20:37] [config] sqlite: ""
[2023-07-11 13:20:37] [config] sqlite-drop: false
[2023-07-11 13:20:37] [config] sync-freq: 200u
[2023-07-11 13:20:37] [config] sync-sgd: false
[2023-07-11 13:20:37] [config] tempdir: /tmp
[2023-07-11 13:20:37] [config] tied-embeddings: false
[2023-07-11 13:20:37] [config] tied-embeddings-all: false
[2023-07-11 13:20:37] [config] tied-embeddings-src: false
[2023-07-11 13:20:37] [config] train-embedder-rank:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] train-sets:
[2023-07-11 13:20:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:37] [config] transformer-aan-activation: swish
[2023-07-11 13:20:37] [config] transformer-aan-depth: 2
[2023-07-11 13:20:37] [config] transformer-aan-nogate: false
[2023-07-11 13:20:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:37] [config] transformer-depth-scaling: false
[2023-07-11 13:20:37] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:37] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:37] [config] transformer-dropout: 0
[2023-07-11 13:20:37] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:37] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:37] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:37] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:37] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:37] [config] transformer-heads: 8
[2023-07-11 13:20:37] [config] transformer-no-projection: false
[2023-07-11 13:20:37] [config] transformer-pool: false
[2023-07-11 13:20:37] [config] transformer-postprocess: dan
[2023-07-11 13:20:37] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:37] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:37] [config] transformer-preprocess: ""
[2023-07-11 13:20:37] [config] transformer-tied-layers:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:37] [config] tsv: false
[2023-07-11 13:20:37] [config] tsv-fields: 0
[2023-07-11 13:20:37] [config] type: transformer
[2023-07-11 13:20:37] [config] ulr: false
[2023-07-11 13:20:37] [config] ulr-dim-emb: 0
[2023-07-11 13:20:37] [config] ulr-dropout: 0
[2023-07-11 13:20:37] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:37] [config] ulr-query-vectors: ""
[2023-07-11 13:20:37] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:37] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:37] [config] unlikelihood-loss: false
[2023-07-11 13:20:37] [config] valid-freq: 50000000
[2023-07-11 13:20:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:37] [config] valid-max-length: 1000
[2023-07-11 13:20:37] [config] valid-metrics:
[2023-07-11 13:20:37] [config]   - cross-entropy
[2023-07-11 13:20:37] [config]   - translation
[2023-07-11 13:20:37] [config] valid-mini-batch: 32
[2023-07-11 13:20:37] [config] valid-reset-stalled: false
[2023-07-11 13:20:37] [config] valid-script-args:
[2023-07-11 13:20:37] [config]   []
[2023-07-11 13:20:37] [config] valid-script-path: ""
[2023-07-11 13:20:37] [config] valid-sets:
[2023-07-11 13:20:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:37] [config] vocabs:
[2023-07-11 13:20:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:37] [config] word-penalty: 0
[2023-07-11 13:20:37] [config] word-scores: false
[2023-07-11 13:20:37] [config] workspace: 2048
[2023-07-11 13:20:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:37] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:37] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x55ebf81e95d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x55ebf809f0c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x55ebf8056b9c]    main                                               + 0x3c
[0x7f70d26b80b3]    __libc_start_main                                  + 0xf3
[0x55ebf809dcbe]    _start                                             + 0x2e

[2023-07-11 13:20:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:40] [marian] Running on node23.datos.cluster.uy as process 9642 with command line:
[2023-07-11 13:20:40] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:40] [config] after: 0e
[2023-07-11 13:20:40] [config] after-batches: 0
[2023-07-11 13:20:40] [config] after-epochs: 60
[2023-07-11 13:20:40] [config] all-caps-every: 0
[2023-07-11 13:20:40] [config] allow-unk: false
[2023-07-11 13:20:40] [config] authors: false
[2023-07-11 13:20:40] [config] beam-size: 12
[2023-07-11 13:20:40] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:40] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:40] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:40] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:40] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:40] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:40] [config] build-info: ""
[2023-07-11 13:20:40] [config] check-gradient-nan: false
[2023-07-11 13:20:40] [config] check-nan: false
[2023-07-11 13:20:40] [config] cite: false
[2023-07-11 13:20:40] [config] clip-norm: 1
[2023-07-11 13:20:40] [config] cost-scaling:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] cost-type: ce-sum
[2023-07-11 13:20:40] [config] cpu-threads: 0
[2023-07-11 13:20:40] [config] data-threads: 8
[2023-07-11 13:20:40] [config] data-weighting: ""
[2023-07-11 13:20:40] [config] data-weighting-type: sentence
[2023-07-11 13:20:40] [config] dec-cell: gru
[2023-07-11 13:20:40] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:40] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:40] [config] dec-depth: 1
[2023-07-11 13:20:40] [config] devices:
[2023-07-11 13:20:40] [config]   - 0
[2023-07-11 13:20:40] [config] dim-emb: 512
[2023-07-11 13:20:40] [config] dim-rnn: 1024
[2023-07-11 13:20:40] [config] dim-vocabs:
[2023-07-11 13:20:40] [config]   - 0
[2023-07-11 13:20:40] [config]   - 0
[2023-07-11 13:20:40] [config] disp-first: 0
[2023-07-11 13:20:40] [config] disp-freq: 1000u
[2023-07-11 13:20:40] [config] disp-label-counts: true
[2023-07-11 13:20:40] [config] dropout-rnn: 0
[2023-07-11 13:20:40] [config] dropout-src: 0
[2023-07-11 13:20:40] [config] dropout-trg: 0
[2023-07-11 13:20:40] [config] dump-config: ""
[2023-07-11 13:20:40] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] early-stopping: 10
[2023-07-11 13:20:40] [config] early-stopping-on: first
[2023-07-11 13:20:40] [config] embedding-fix-src: false
[2023-07-11 13:20:40] [config] embedding-fix-trg: false
[2023-07-11 13:20:40] [config] embedding-normalization: false
[2023-07-11 13:20:40] [config] embedding-vectors:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] enc-cell: gru
[2023-07-11 13:20:40] [config] enc-cell-depth: 1
[2023-07-11 13:20:40] [config] enc-depth: 1
[2023-07-11 13:20:40] [config] enc-type: bidirectional
[2023-07-11 13:20:40] [config] english-title-case-every: 0
[2023-07-11 13:20:40] [config] exponential-smoothing: 0
[2023-07-11 13:20:40] [config] factor-weight: 1
[2023-07-11 13:20:40] [config] factors-combine: sum
[2023-07-11 13:20:40] [config] factors-dim-emb: 0
[2023-07-11 13:20:40] [config] gradient-checkpointing: false
[2023-07-11 13:20:40] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:40] [config] guided-alignment: none
[2023-07-11 13:20:40] [config] guided-alignment-cost: mse
[2023-07-11 13:20:40] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:40] [config] ignore-model-config: false
[2023-07-11 13:20:40] [config] input-types:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] interpolate-env-vars: false
[2023-07-11 13:20:40] [config] keep-best: false
[2023-07-11 13:20:40] [config] label-smoothing: 0
[2023-07-11 13:20:40] [config] layer-normalization: false
[2023-07-11 13:20:40] [config] learn-rate: 0.0001
[2023-07-11 13:20:40] [config] lemma-dependency: ""
[2023-07-11 13:20:40] [config] lemma-dim-emb: 0
[2023-07-11 13:20:40] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:40] [config] log-level: info
[2023-07-11 13:20:40] [config] log-time-zone: ""
[2023-07-11 13:20:40] [config] logical-epoch:
[2023-07-11 13:20:40] [config]   - 1e
[2023-07-11 13:20:40] [config]   - 0
[2023-07-11 13:20:40] [config] lr-decay: 0
[2023-07-11 13:20:40] [config] lr-decay-freq: 50000
[2023-07-11 13:20:40] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:40] [config]   - 0
[2023-07-11 13:20:40] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:40] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:40] [config] lr-decay-start:
[2023-07-11 13:20:40] [config]   - 10
[2023-07-11 13:20:40] [config]   - 1
[2023-07-11 13:20:40] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:40] [config] lr-report: false
[2023-07-11 13:20:40] [config] lr-warmup: 0
[2023-07-11 13:20:40] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:40] [config] lr-warmup-cycle: false
[2023-07-11 13:20:40] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:40] [config] max-length: 50
[2023-07-11 13:20:40] [config] max-length-crop: false
[2023-07-11 13:20:40] [config] max-length-factor: 3
[2023-07-11 13:20:40] [config] maxi-batch: 100
[2023-07-11 13:20:40] [config] maxi-batch-sort: trg
[2023-07-11 13:20:40] [config] mini-batch: 64
[2023-07-11 13:20:40] [config] mini-batch-fit: false
[2023-07-11 13:20:40] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:40] [config] mini-batch-round-up: true
[2023-07-11 13:20:40] [config] mini-batch-track-lr: false
[2023-07-11 13:20:40] [config] mini-batch-warmup: 0
[2023-07-11 13:20:40] [config] mini-batch-words: 0
[2023-07-11 13:20:40] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:40] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:40] [config] multi-loss-type: sum
[2023-07-11 13:20:40] [config] n-best: false
[2023-07-11 13:20:40] [config] no-nccl: false
[2023-07-11 13:20:40] [config] no-reload: false
[2023-07-11 13:20:40] [config] no-restore-corpus: false
[2023-07-11 13:20:40] [config] normalize: 0
[2023-07-11 13:20:40] [config] normalize-gradient: false
[2023-07-11 13:20:40] [config] num-devices: 3
[2023-07-11 13:20:40] [config] optimizer: adam
[2023-07-11 13:20:40] [config] optimizer-delay: 1
[2023-07-11 13:20:40] [config] optimizer-params:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] output-omit-bias: false
[2023-07-11 13:20:40] [config] overwrite: true
[2023-07-11 13:20:40] [config] precision:
[2023-07-11 13:20:40] [config]   - float32
[2023-07-11 13:20:40] [config]   - float32
[2023-07-11 13:20:40] [config] pretrained-model: ""
[2023-07-11 13:20:40] [config] quantize-biases: false
[2023-07-11 13:20:40] [config] quantize-bits: 0
[2023-07-11 13:20:40] [config] quantize-log-based: false
[2023-07-11 13:20:40] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:40] [config] quiet: false
[2023-07-11 13:20:40] [config] quiet-translation: true
[2023-07-11 13:20:40] [config] relative-paths: false
[2023-07-11 13:20:40] [config] right-left: false
[2023-07-11 13:20:40] [config] save-freq: 10000u
[2023-07-11 13:20:40] [config] seed: 1234
[2023-07-11 13:20:40] [config] sentencepiece-alphas:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:40] [config] sentencepiece-options: ""
[2023-07-11 13:20:40] [config] sharding: global
[2023-07-11 13:20:40] [config] shuffle: data
[2023-07-11 13:20:40] [config] shuffle-in-ram: false
[2023-07-11 13:20:40] [config] sigterm: save-and-exit
[2023-07-11 13:20:40] [config] skip: false
[2023-07-11 13:20:40] [config] sqlite: ""
[2023-07-11 13:20:40] [config] sqlite-drop: false
[2023-07-11 13:20:40] [config] sync-freq: 200u
[2023-07-11 13:20:40] [config] sync-sgd: false
[2023-07-11 13:20:40] [config] tempdir: /tmp
[2023-07-11 13:20:40] [config] tied-embeddings: false
[2023-07-11 13:20:40] [config] tied-embeddings-all: false
[2023-07-11 13:20:40] [config] tied-embeddings-src: false
[2023-07-11 13:20:40] [config] train-embedder-rank:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] train-sets:
[2023-07-11 13:20:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:40] [config] transformer-aan-activation: swish
[2023-07-11 13:20:40] [config] transformer-aan-depth: 2
[2023-07-11 13:20:40] [config] transformer-aan-nogate: false
[2023-07-11 13:20:40] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:40] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:40] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:40] [config] transformer-depth-scaling: false
[2023-07-11 13:20:40] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:40] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:40] [config] transformer-dropout: 0
[2023-07-11 13:20:40] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:40] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:40] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:40] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:40] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:40] [config] transformer-heads: 8
[2023-07-11 13:20:40] [config] transformer-no-projection: false
[2023-07-11 13:20:40] [config] transformer-pool: false
[2023-07-11 13:20:40] [config] transformer-postprocess: dan
[2023-07-11 13:20:40] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:40] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:40] [config] transformer-preprocess: ""
[2023-07-11 13:20:40] [config] transformer-tied-layers:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:40] [config] tsv: false
[2023-07-11 13:20:40] [config] tsv-fields: 0
[2023-07-11 13:20:40] [config] type: transformer
[2023-07-11 13:20:40] [config] ulr: false
[2023-07-11 13:20:40] [config] ulr-dim-emb: 0
[2023-07-11 13:20:40] [config] ulr-dropout: 0
[2023-07-11 13:20:40] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:40] [config] ulr-query-vectors: ""
[2023-07-11 13:20:40] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:40] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:40] [config] unlikelihood-loss: false
[2023-07-11 13:20:40] [config] valid-freq: 50000000
[2023-07-11 13:20:40] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:40] [config] valid-max-length: 1000
[2023-07-11 13:20:40] [config] valid-metrics:
[2023-07-11 13:20:40] [config]   - cross-entropy
[2023-07-11 13:20:40] [config]   - translation
[2023-07-11 13:20:40] [config] valid-mini-batch: 32
[2023-07-11 13:20:40] [config] valid-reset-stalled: false
[2023-07-11 13:20:40] [config] valid-script-args:
[2023-07-11 13:20:40] [config]   []
[2023-07-11 13:20:40] [config] valid-script-path: ""
[2023-07-11 13:20:40] [config] valid-sets:
[2023-07-11 13:20:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:40] [config] vocabs:
[2023-07-11 13:20:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:40] [config] word-penalty: 0
[2023-07-11 13:20:40] [config] word-scores: false
[2023-07-11 13:20:40] [config] workspace: 2048
[2023-07-11 13:20:40] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:40] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:40] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x559e9e6cc5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x559e9e5820c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x559e9e539b9c]    main                                               + 0x3c
[0x7f274654f0b3]    __libc_start_main                                  + 0xf3
[0x559e9e580cbe]    _start                                             + 0x2e

[2023-07-11 13:20:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:43] [marian] Running on node23.datos.cluster.uy as process 9647 with command line:
[2023-07-11 13:20:43] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:43] [config] after: 0e
[2023-07-11 13:20:43] [config] after-batches: 0
[2023-07-11 13:20:43] [config] after-epochs: 70
[2023-07-11 13:20:43] [config] all-caps-every: 0
[2023-07-11 13:20:43] [config] allow-unk: false
[2023-07-11 13:20:43] [config] authors: false
[2023-07-11 13:20:43] [config] beam-size: 12
[2023-07-11 13:20:43] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:43] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:43] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:43] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:43] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:43] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:43] [config] build-info: ""
[2023-07-11 13:20:43] [config] check-gradient-nan: false
[2023-07-11 13:20:43] [config] check-nan: false
[2023-07-11 13:20:43] [config] cite: false
[2023-07-11 13:20:43] [config] clip-norm: 1
[2023-07-11 13:20:43] [config] cost-scaling:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] cost-type: ce-sum
[2023-07-11 13:20:43] [config] cpu-threads: 0
[2023-07-11 13:20:43] [config] data-threads: 8
[2023-07-11 13:20:43] [config] data-weighting: ""
[2023-07-11 13:20:43] [config] data-weighting-type: sentence
[2023-07-11 13:20:43] [config] dec-cell: gru
[2023-07-11 13:20:43] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:43] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:43] [config] dec-depth: 1
[2023-07-11 13:20:43] [config] devices:
[2023-07-11 13:20:43] [config]   - 0
[2023-07-11 13:20:43] [config] dim-emb: 512
[2023-07-11 13:20:43] [config] dim-rnn: 1024
[2023-07-11 13:20:43] [config] dim-vocabs:
[2023-07-11 13:20:43] [config]   - 0
[2023-07-11 13:20:43] [config]   - 0
[2023-07-11 13:20:43] [config] disp-first: 0
[2023-07-11 13:20:43] [config] disp-freq: 1000u
[2023-07-11 13:20:43] [config] disp-label-counts: true
[2023-07-11 13:20:43] [config] dropout-rnn: 0
[2023-07-11 13:20:43] [config] dropout-src: 0
[2023-07-11 13:20:43] [config] dropout-trg: 0
[2023-07-11 13:20:43] [config] dump-config: ""
[2023-07-11 13:20:43] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] early-stopping: 10
[2023-07-11 13:20:43] [config] early-stopping-on: first
[2023-07-11 13:20:43] [config] embedding-fix-src: false
[2023-07-11 13:20:43] [config] embedding-fix-trg: false
[2023-07-11 13:20:43] [config] embedding-normalization: false
[2023-07-11 13:20:43] [config] embedding-vectors:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] enc-cell: gru
[2023-07-11 13:20:43] [config] enc-cell-depth: 1
[2023-07-11 13:20:43] [config] enc-depth: 1
[2023-07-11 13:20:43] [config] enc-type: bidirectional
[2023-07-11 13:20:43] [config] english-title-case-every: 0
[2023-07-11 13:20:43] [config] exponential-smoothing: 0
[2023-07-11 13:20:43] [config] factor-weight: 1
[2023-07-11 13:20:43] [config] factors-combine: sum
[2023-07-11 13:20:43] [config] factors-dim-emb: 0
[2023-07-11 13:20:43] [config] gradient-checkpointing: false
[2023-07-11 13:20:43] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:43] [config] guided-alignment: none
[2023-07-11 13:20:43] [config] guided-alignment-cost: mse
[2023-07-11 13:20:43] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:43] [config] ignore-model-config: false
[2023-07-11 13:20:43] [config] input-types:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] interpolate-env-vars: false
[2023-07-11 13:20:43] [config] keep-best: false
[2023-07-11 13:20:43] [config] label-smoothing: 0
[2023-07-11 13:20:43] [config] layer-normalization: false
[2023-07-11 13:20:43] [config] learn-rate: 0.0001
[2023-07-11 13:20:43] [config] lemma-dependency: ""
[2023-07-11 13:20:43] [config] lemma-dim-emb: 0
[2023-07-11 13:20:43] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:43] [config] log-level: info
[2023-07-11 13:20:43] [config] log-time-zone: ""
[2023-07-11 13:20:43] [config] logical-epoch:
[2023-07-11 13:20:43] [config]   - 1e
[2023-07-11 13:20:43] [config]   - 0
[2023-07-11 13:20:43] [config] lr-decay: 0
[2023-07-11 13:20:43] [config] lr-decay-freq: 50000
[2023-07-11 13:20:43] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:43] [config]   - 0
[2023-07-11 13:20:43] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:43] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:43] [config] lr-decay-start:
[2023-07-11 13:20:43] [config]   - 10
[2023-07-11 13:20:43] [config]   - 1
[2023-07-11 13:20:43] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:43] [config] lr-report: false
[2023-07-11 13:20:43] [config] lr-warmup: 0
[2023-07-11 13:20:43] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:43] [config] lr-warmup-cycle: false
[2023-07-11 13:20:43] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:43] [config] max-length: 50
[2023-07-11 13:20:43] [config] max-length-crop: false
[2023-07-11 13:20:43] [config] max-length-factor: 3
[2023-07-11 13:20:43] [config] maxi-batch: 100
[2023-07-11 13:20:43] [config] maxi-batch-sort: trg
[2023-07-11 13:20:43] [config] mini-batch: 64
[2023-07-11 13:20:43] [config] mini-batch-fit: false
[2023-07-11 13:20:43] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:43] [config] mini-batch-round-up: true
[2023-07-11 13:20:43] [config] mini-batch-track-lr: false
[2023-07-11 13:20:43] [config] mini-batch-warmup: 0
[2023-07-11 13:20:43] [config] mini-batch-words: 0
[2023-07-11 13:20:43] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:43] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:43] [config] multi-loss-type: sum
[2023-07-11 13:20:43] [config] n-best: false
[2023-07-11 13:20:43] [config] no-nccl: false
[2023-07-11 13:20:43] [config] no-reload: false
[2023-07-11 13:20:43] [config] no-restore-corpus: false
[2023-07-11 13:20:43] [config] normalize: 0
[2023-07-11 13:20:43] [config] normalize-gradient: false
[2023-07-11 13:20:43] [config] num-devices: 3
[2023-07-11 13:20:43] [config] optimizer: adam
[2023-07-11 13:20:43] [config] optimizer-delay: 1
[2023-07-11 13:20:43] [config] optimizer-params:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] output-omit-bias: false
[2023-07-11 13:20:43] [config] overwrite: true
[2023-07-11 13:20:43] [config] precision:
[2023-07-11 13:20:43] [config]   - float32
[2023-07-11 13:20:43] [config]   - float32
[2023-07-11 13:20:43] [config] pretrained-model: ""
[2023-07-11 13:20:43] [config] quantize-biases: false
[2023-07-11 13:20:43] [config] quantize-bits: 0
[2023-07-11 13:20:43] [config] quantize-log-based: false
[2023-07-11 13:20:43] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:43] [config] quiet: false
[2023-07-11 13:20:43] [config] quiet-translation: true
[2023-07-11 13:20:43] [config] relative-paths: false
[2023-07-11 13:20:43] [config] right-left: false
[2023-07-11 13:20:43] [config] save-freq: 10000u
[2023-07-11 13:20:43] [config] seed: 1234
[2023-07-11 13:20:43] [config] sentencepiece-alphas:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:43] [config] sentencepiece-options: ""
[2023-07-11 13:20:43] [config] sharding: global
[2023-07-11 13:20:43] [config] shuffle: data
[2023-07-11 13:20:43] [config] shuffle-in-ram: false
[2023-07-11 13:20:43] [config] sigterm: save-and-exit
[2023-07-11 13:20:43] [config] skip: false
[2023-07-11 13:20:43] [config] sqlite: ""
[2023-07-11 13:20:43] [config] sqlite-drop: false
[2023-07-11 13:20:43] [config] sync-freq: 200u
[2023-07-11 13:20:43] [config] sync-sgd: false
[2023-07-11 13:20:43] [config] tempdir: /tmp
[2023-07-11 13:20:43] [config] tied-embeddings: false
[2023-07-11 13:20:43] [config] tied-embeddings-all: false
[2023-07-11 13:20:43] [config] tied-embeddings-src: false
[2023-07-11 13:20:43] [config] train-embedder-rank:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] train-sets:
[2023-07-11 13:20:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:43] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:43] [config] transformer-aan-activation: swish
[2023-07-11 13:20:43] [config] transformer-aan-depth: 2
[2023-07-11 13:20:43] [config] transformer-aan-nogate: false
[2023-07-11 13:20:43] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:43] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:43] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:43] [config] transformer-depth-scaling: false
[2023-07-11 13:20:43] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:43] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:43] [config] transformer-dropout: 0
[2023-07-11 13:20:43] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:43] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:43] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:43] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:43] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:43] [config] transformer-heads: 8
[2023-07-11 13:20:43] [config] transformer-no-projection: false
[2023-07-11 13:20:43] [config] transformer-pool: false
[2023-07-11 13:20:43] [config] transformer-postprocess: dan
[2023-07-11 13:20:43] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:43] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:43] [config] transformer-preprocess: ""
[2023-07-11 13:20:43] [config] transformer-tied-layers:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:43] [config] tsv: false
[2023-07-11 13:20:43] [config] tsv-fields: 0
[2023-07-11 13:20:43] [config] type: transformer
[2023-07-11 13:20:43] [config] ulr: false
[2023-07-11 13:20:43] [config] ulr-dim-emb: 0
[2023-07-11 13:20:43] [config] ulr-dropout: 0
[2023-07-11 13:20:43] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:43] [config] ulr-query-vectors: ""
[2023-07-11 13:20:43] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:43] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:43] [config] unlikelihood-loss: false
[2023-07-11 13:20:43] [config] valid-freq: 50000000
[2023-07-11 13:20:43] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:43] [config] valid-max-length: 1000
[2023-07-11 13:20:43] [config] valid-metrics:
[2023-07-11 13:20:43] [config]   - cross-entropy
[2023-07-11 13:20:43] [config]   - translation
[2023-07-11 13:20:43] [config] valid-mini-batch: 32
[2023-07-11 13:20:43] [config] valid-reset-stalled: false
[2023-07-11 13:20:43] [config] valid-script-args:
[2023-07-11 13:20:43] [config]   []
[2023-07-11 13:20:43] [config] valid-script-path: ""
[2023-07-11 13:20:43] [config] valid-sets:
[2023-07-11 13:20:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:43] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:43] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:43] [config] vocabs:
[2023-07-11 13:20:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:43] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:43] [config] word-penalty: 0
[2023-07-11 13:20:43] [config] word-scores: false
[2023-07-11 13:20:43] [config] workspace: 2048
[2023-07-11 13:20:43] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:43] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:43] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x55e52e20b5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x55e52e0c10c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x55e52e078b9c]    main                                               + 0x3c
[0x7f1cb80870b3]    __libc_start_main                                  + 0xf3
[0x55e52e0bfcbe]    _start                                             + 0x2e

[2023-07-11 13:20:46] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:46] [marian] Running on node23.datos.cluster.uy as process 9652 with command line:
[2023-07-11 13:20:46] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:46] [config] after: 0e
[2023-07-11 13:20:46] [config] after-batches: 0
[2023-07-11 13:20:46] [config] after-epochs: 80
[2023-07-11 13:20:46] [config] all-caps-every: 0
[2023-07-11 13:20:46] [config] allow-unk: false
[2023-07-11 13:20:46] [config] authors: false
[2023-07-11 13:20:46] [config] beam-size: 12
[2023-07-11 13:20:46] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:46] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:46] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:46] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:46] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:46] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:46] [config] build-info: ""
[2023-07-11 13:20:46] [config] check-gradient-nan: false
[2023-07-11 13:20:46] [config] check-nan: false
[2023-07-11 13:20:46] [config] cite: false
[2023-07-11 13:20:46] [config] clip-norm: 1
[2023-07-11 13:20:46] [config] cost-scaling:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] cost-type: ce-sum
[2023-07-11 13:20:46] [config] cpu-threads: 0
[2023-07-11 13:20:46] [config] data-threads: 8
[2023-07-11 13:20:46] [config] data-weighting: ""
[2023-07-11 13:20:46] [config] data-weighting-type: sentence
[2023-07-11 13:20:46] [config] dec-cell: gru
[2023-07-11 13:20:46] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:46] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:46] [config] dec-depth: 1
[2023-07-11 13:20:46] [config] devices:
[2023-07-11 13:20:46] [config]   - 0
[2023-07-11 13:20:46] [config] dim-emb: 512
[2023-07-11 13:20:46] [config] dim-rnn: 1024
[2023-07-11 13:20:46] [config] dim-vocabs:
[2023-07-11 13:20:46] [config]   - 0
[2023-07-11 13:20:46] [config]   - 0
[2023-07-11 13:20:46] [config] disp-first: 0
[2023-07-11 13:20:46] [config] disp-freq: 1000u
[2023-07-11 13:20:46] [config] disp-label-counts: true
[2023-07-11 13:20:46] [config] dropout-rnn: 0
[2023-07-11 13:20:46] [config] dropout-src: 0
[2023-07-11 13:20:46] [config] dropout-trg: 0
[2023-07-11 13:20:46] [config] dump-config: ""
[2023-07-11 13:20:46] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] early-stopping: 10
[2023-07-11 13:20:46] [config] early-stopping-on: first
[2023-07-11 13:20:46] [config] embedding-fix-src: false
[2023-07-11 13:20:46] [config] embedding-fix-trg: false
[2023-07-11 13:20:46] [config] embedding-normalization: false
[2023-07-11 13:20:46] [config] embedding-vectors:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] enc-cell: gru
[2023-07-11 13:20:46] [config] enc-cell-depth: 1
[2023-07-11 13:20:46] [config] enc-depth: 1
[2023-07-11 13:20:46] [config] enc-type: bidirectional
[2023-07-11 13:20:46] [config] english-title-case-every: 0
[2023-07-11 13:20:46] [config] exponential-smoothing: 0
[2023-07-11 13:20:46] [config] factor-weight: 1
[2023-07-11 13:20:46] [config] factors-combine: sum
[2023-07-11 13:20:46] [config] factors-dim-emb: 0
[2023-07-11 13:20:46] [config] gradient-checkpointing: false
[2023-07-11 13:20:46] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:46] [config] guided-alignment: none
[2023-07-11 13:20:46] [config] guided-alignment-cost: mse
[2023-07-11 13:20:46] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:46] [config] ignore-model-config: false
[2023-07-11 13:20:46] [config] input-types:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] interpolate-env-vars: false
[2023-07-11 13:20:46] [config] keep-best: false
[2023-07-11 13:20:46] [config] label-smoothing: 0
[2023-07-11 13:20:46] [config] layer-normalization: false
[2023-07-11 13:20:46] [config] learn-rate: 0.0001
[2023-07-11 13:20:46] [config] lemma-dependency: ""
[2023-07-11 13:20:46] [config] lemma-dim-emb: 0
[2023-07-11 13:20:46] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:46] [config] log-level: info
[2023-07-11 13:20:46] [config] log-time-zone: ""
[2023-07-11 13:20:46] [config] logical-epoch:
[2023-07-11 13:20:46] [config]   - 1e
[2023-07-11 13:20:46] [config]   - 0
[2023-07-11 13:20:46] [config] lr-decay: 0
[2023-07-11 13:20:46] [config] lr-decay-freq: 50000
[2023-07-11 13:20:46] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:46] [config]   - 0
[2023-07-11 13:20:46] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:46] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:46] [config] lr-decay-start:
[2023-07-11 13:20:46] [config]   - 10
[2023-07-11 13:20:46] [config]   - 1
[2023-07-11 13:20:46] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:46] [config] lr-report: false
[2023-07-11 13:20:46] [config] lr-warmup: 0
[2023-07-11 13:20:46] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:46] [config] lr-warmup-cycle: false
[2023-07-11 13:20:46] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:46] [config] max-length: 50
[2023-07-11 13:20:46] [config] max-length-crop: false
[2023-07-11 13:20:46] [config] max-length-factor: 3
[2023-07-11 13:20:46] [config] maxi-batch: 100
[2023-07-11 13:20:46] [config] maxi-batch-sort: trg
[2023-07-11 13:20:46] [config] mini-batch: 64
[2023-07-11 13:20:46] [config] mini-batch-fit: false
[2023-07-11 13:20:46] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:46] [config] mini-batch-round-up: true
[2023-07-11 13:20:46] [config] mini-batch-track-lr: false
[2023-07-11 13:20:46] [config] mini-batch-warmup: 0
[2023-07-11 13:20:46] [config] mini-batch-words: 0
[2023-07-11 13:20:46] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:46] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:46] [config] multi-loss-type: sum
[2023-07-11 13:20:46] [config] n-best: false
[2023-07-11 13:20:46] [config] no-nccl: false
[2023-07-11 13:20:46] [config] no-reload: false
[2023-07-11 13:20:46] [config] no-restore-corpus: false
[2023-07-11 13:20:46] [config] normalize: 0
[2023-07-11 13:20:46] [config] normalize-gradient: false
[2023-07-11 13:20:46] [config] num-devices: 3
[2023-07-11 13:20:46] [config] optimizer: adam
[2023-07-11 13:20:46] [config] optimizer-delay: 1
[2023-07-11 13:20:46] [config] optimizer-params:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] output-omit-bias: false
[2023-07-11 13:20:46] [config] overwrite: true
[2023-07-11 13:20:46] [config] precision:
[2023-07-11 13:20:46] [config]   - float32
[2023-07-11 13:20:46] [config]   - float32
[2023-07-11 13:20:46] [config] pretrained-model: ""
[2023-07-11 13:20:46] [config] quantize-biases: false
[2023-07-11 13:20:46] [config] quantize-bits: 0
[2023-07-11 13:20:46] [config] quantize-log-based: false
[2023-07-11 13:20:46] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:46] [config] quiet: false
[2023-07-11 13:20:46] [config] quiet-translation: true
[2023-07-11 13:20:46] [config] relative-paths: false
[2023-07-11 13:20:46] [config] right-left: false
[2023-07-11 13:20:46] [config] save-freq: 10000u
[2023-07-11 13:20:46] [config] seed: 1234
[2023-07-11 13:20:46] [config] sentencepiece-alphas:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:46] [config] sentencepiece-options: ""
[2023-07-11 13:20:46] [config] sharding: global
[2023-07-11 13:20:46] [config] shuffle: data
[2023-07-11 13:20:46] [config] shuffle-in-ram: false
[2023-07-11 13:20:46] [config] sigterm: save-and-exit
[2023-07-11 13:20:46] [config] skip: false
[2023-07-11 13:20:46] [config] sqlite: ""
[2023-07-11 13:20:46] [config] sqlite-drop: false
[2023-07-11 13:20:46] [config] sync-freq: 200u
[2023-07-11 13:20:46] [config] sync-sgd: false
[2023-07-11 13:20:46] [config] tempdir: /tmp
[2023-07-11 13:20:46] [config] tied-embeddings: false
[2023-07-11 13:20:46] [config] tied-embeddings-all: false
[2023-07-11 13:20:46] [config] tied-embeddings-src: false
[2023-07-11 13:20:46] [config] train-embedder-rank:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] train-sets:
[2023-07-11 13:20:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:46] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:46] [config] transformer-aan-activation: swish
[2023-07-11 13:20:46] [config] transformer-aan-depth: 2
[2023-07-11 13:20:46] [config] transformer-aan-nogate: false
[2023-07-11 13:20:46] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:46] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:46] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:46] [config] transformer-depth-scaling: false
[2023-07-11 13:20:46] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:46] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:46] [config] transformer-dropout: 0
[2023-07-11 13:20:46] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:46] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:46] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:46] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:46] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:46] [config] transformer-heads: 8
[2023-07-11 13:20:46] [config] transformer-no-projection: false
[2023-07-11 13:20:46] [config] transformer-pool: false
[2023-07-11 13:20:46] [config] transformer-postprocess: dan
[2023-07-11 13:20:46] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:46] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:46] [config] transformer-preprocess: ""
[2023-07-11 13:20:46] [config] transformer-tied-layers:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:46] [config] tsv: false
[2023-07-11 13:20:46] [config] tsv-fields: 0
[2023-07-11 13:20:46] [config] type: transformer
[2023-07-11 13:20:46] [config] ulr: false
[2023-07-11 13:20:46] [config] ulr-dim-emb: 0
[2023-07-11 13:20:46] [config] ulr-dropout: 0
[2023-07-11 13:20:46] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:46] [config] ulr-query-vectors: ""
[2023-07-11 13:20:46] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:46] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:46] [config] unlikelihood-loss: false
[2023-07-11 13:20:46] [config] valid-freq: 50000000
[2023-07-11 13:20:46] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:46] [config] valid-max-length: 1000
[2023-07-11 13:20:46] [config] valid-metrics:
[2023-07-11 13:20:46] [config]   - cross-entropy
[2023-07-11 13:20:46] [config]   - translation
[2023-07-11 13:20:46] [config] valid-mini-batch: 32
[2023-07-11 13:20:46] [config] valid-reset-stalled: false
[2023-07-11 13:20:46] [config] valid-script-args:
[2023-07-11 13:20:46] [config]   []
[2023-07-11 13:20:46] [config] valid-script-path: ""
[2023-07-11 13:20:46] [config] valid-sets:
[2023-07-11 13:20:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:46] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:46] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:46] [config] vocabs:
[2023-07-11 13:20:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:46] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:46] [config] word-penalty: 0
[2023-07-11 13:20:46] [config] word-scores: false
[2023-07-11 13:20:46] [config] workspace: 2048
[2023-07-11 13:20:46] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:46] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:46] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x5590f764e5d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x5590f75040c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x5590f74bbb9c]    main                                               + 0x3c
[0x7f61eeb660b3]    __libc_start_main                                  + 0xf3
[0x5590f7502cbe]    _start                                             + 0x2e

[2023-07-11 13:20:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:49] [marian] Running on node23.datos.cluster.uy as process 9656 with command line:
[2023-07-11 13:20:49] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:49] [config] after: 0e
[2023-07-11 13:20:49] [config] after-batches: 0
[2023-07-11 13:20:49] [config] after-epochs: 90
[2023-07-11 13:20:49] [config] all-caps-every: 0
[2023-07-11 13:20:49] [config] allow-unk: false
[2023-07-11 13:20:49] [config] authors: false
[2023-07-11 13:20:49] [config] beam-size: 12
[2023-07-11 13:20:49] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:49] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:49] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:49] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:49] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:49] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:49] [config] build-info: ""
[2023-07-11 13:20:49] [config] check-gradient-nan: false
[2023-07-11 13:20:49] [config] check-nan: false
[2023-07-11 13:20:49] [config] cite: false
[2023-07-11 13:20:49] [config] clip-norm: 1
[2023-07-11 13:20:49] [config] cost-scaling:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] cost-type: ce-sum
[2023-07-11 13:20:49] [config] cpu-threads: 0
[2023-07-11 13:20:49] [config] data-threads: 8
[2023-07-11 13:20:49] [config] data-weighting: ""
[2023-07-11 13:20:49] [config] data-weighting-type: sentence
[2023-07-11 13:20:49] [config] dec-cell: gru
[2023-07-11 13:20:49] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:49] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:49] [config] dec-depth: 1
[2023-07-11 13:20:49] [config] devices:
[2023-07-11 13:20:49] [config]   - 0
[2023-07-11 13:20:49] [config] dim-emb: 512
[2023-07-11 13:20:49] [config] dim-rnn: 1024
[2023-07-11 13:20:49] [config] dim-vocabs:
[2023-07-11 13:20:49] [config]   - 0
[2023-07-11 13:20:49] [config]   - 0
[2023-07-11 13:20:49] [config] disp-first: 0
[2023-07-11 13:20:49] [config] disp-freq: 1000u
[2023-07-11 13:20:49] [config] disp-label-counts: true
[2023-07-11 13:20:49] [config] dropout-rnn: 0
[2023-07-11 13:20:49] [config] dropout-src: 0
[2023-07-11 13:20:49] [config] dropout-trg: 0
[2023-07-11 13:20:49] [config] dump-config: ""
[2023-07-11 13:20:49] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] early-stopping: 10
[2023-07-11 13:20:49] [config] early-stopping-on: first
[2023-07-11 13:20:49] [config] embedding-fix-src: false
[2023-07-11 13:20:49] [config] embedding-fix-trg: false
[2023-07-11 13:20:49] [config] embedding-normalization: false
[2023-07-11 13:20:49] [config] embedding-vectors:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] enc-cell: gru
[2023-07-11 13:20:49] [config] enc-cell-depth: 1
[2023-07-11 13:20:49] [config] enc-depth: 1
[2023-07-11 13:20:49] [config] enc-type: bidirectional
[2023-07-11 13:20:49] [config] english-title-case-every: 0
[2023-07-11 13:20:49] [config] exponential-smoothing: 0
[2023-07-11 13:20:49] [config] factor-weight: 1
[2023-07-11 13:20:49] [config] factors-combine: sum
[2023-07-11 13:20:49] [config] factors-dim-emb: 0
[2023-07-11 13:20:49] [config] gradient-checkpointing: false
[2023-07-11 13:20:49] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:49] [config] guided-alignment: none
[2023-07-11 13:20:49] [config] guided-alignment-cost: mse
[2023-07-11 13:20:49] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:49] [config] ignore-model-config: false
[2023-07-11 13:20:49] [config] input-types:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] interpolate-env-vars: false
[2023-07-11 13:20:49] [config] keep-best: false
[2023-07-11 13:20:49] [config] label-smoothing: 0
[2023-07-11 13:20:49] [config] layer-normalization: false
[2023-07-11 13:20:49] [config] learn-rate: 0.0001
[2023-07-11 13:20:49] [config] lemma-dependency: ""
[2023-07-11 13:20:49] [config] lemma-dim-emb: 0
[2023-07-11 13:20:49] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:49] [config] log-level: info
[2023-07-11 13:20:49] [config] log-time-zone: ""
[2023-07-11 13:20:49] [config] logical-epoch:
[2023-07-11 13:20:49] [config]   - 1e
[2023-07-11 13:20:49] [config]   - 0
[2023-07-11 13:20:49] [config] lr-decay: 0
[2023-07-11 13:20:49] [config] lr-decay-freq: 50000
[2023-07-11 13:20:49] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:49] [config]   - 0
[2023-07-11 13:20:49] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:49] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:49] [config] lr-decay-start:
[2023-07-11 13:20:49] [config]   - 10
[2023-07-11 13:20:49] [config]   - 1
[2023-07-11 13:20:49] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:49] [config] lr-report: false
[2023-07-11 13:20:49] [config] lr-warmup: 0
[2023-07-11 13:20:49] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:49] [config] lr-warmup-cycle: false
[2023-07-11 13:20:49] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:49] [config] max-length: 50
[2023-07-11 13:20:49] [config] max-length-crop: false
[2023-07-11 13:20:49] [config] max-length-factor: 3
[2023-07-11 13:20:49] [config] maxi-batch: 100
[2023-07-11 13:20:49] [config] maxi-batch-sort: trg
[2023-07-11 13:20:49] [config] mini-batch: 64
[2023-07-11 13:20:49] [config] mini-batch-fit: false
[2023-07-11 13:20:49] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:49] [config] mini-batch-round-up: true
[2023-07-11 13:20:49] [config] mini-batch-track-lr: false
[2023-07-11 13:20:49] [config] mini-batch-warmup: 0
[2023-07-11 13:20:49] [config] mini-batch-words: 0
[2023-07-11 13:20:49] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:49] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:49] [config] multi-loss-type: sum
[2023-07-11 13:20:49] [config] n-best: false
[2023-07-11 13:20:49] [config] no-nccl: false
[2023-07-11 13:20:49] [config] no-reload: false
[2023-07-11 13:20:49] [config] no-restore-corpus: false
[2023-07-11 13:20:49] [config] normalize: 0
[2023-07-11 13:20:49] [config] normalize-gradient: false
[2023-07-11 13:20:49] [config] num-devices: 3
[2023-07-11 13:20:49] [config] optimizer: adam
[2023-07-11 13:20:49] [config] optimizer-delay: 1
[2023-07-11 13:20:49] [config] optimizer-params:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] output-omit-bias: false
[2023-07-11 13:20:49] [config] overwrite: true
[2023-07-11 13:20:49] [config] precision:
[2023-07-11 13:20:49] [config]   - float32
[2023-07-11 13:20:49] [config]   - float32
[2023-07-11 13:20:49] [config] pretrained-model: ""
[2023-07-11 13:20:49] [config] quantize-biases: false
[2023-07-11 13:20:49] [config] quantize-bits: 0
[2023-07-11 13:20:49] [config] quantize-log-based: false
[2023-07-11 13:20:49] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:49] [config] quiet: false
[2023-07-11 13:20:49] [config] quiet-translation: true
[2023-07-11 13:20:49] [config] relative-paths: false
[2023-07-11 13:20:49] [config] right-left: false
[2023-07-11 13:20:49] [config] save-freq: 10000u
[2023-07-11 13:20:49] [config] seed: 1234
[2023-07-11 13:20:49] [config] sentencepiece-alphas:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:49] [config] sentencepiece-options: ""
[2023-07-11 13:20:49] [config] sharding: global
[2023-07-11 13:20:49] [config] shuffle: data
[2023-07-11 13:20:49] [config] shuffle-in-ram: false
[2023-07-11 13:20:49] [config] sigterm: save-and-exit
[2023-07-11 13:20:49] [config] skip: false
[2023-07-11 13:20:49] [config] sqlite: ""
[2023-07-11 13:20:49] [config] sqlite-drop: false
[2023-07-11 13:20:49] [config] sync-freq: 200u
[2023-07-11 13:20:49] [config] sync-sgd: false
[2023-07-11 13:20:49] [config] tempdir: /tmp
[2023-07-11 13:20:49] [config] tied-embeddings: false
[2023-07-11 13:20:49] [config] tied-embeddings-all: false
[2023-07-11 13:20:49] [config] tied-embeddings-src: false
[2023-07-11 13:20:49] [config] train-embedder-rank:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] train-sets:
[2023-07-11 13:20:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:49] [config] transformer-aan-activation: swish
[2023-07-11 13:20:49] [config] transformer-aan-depth: 2
[2023-07-11 13:20:49] [config] transformer-aan-nogate: false
[2023-07-11 13:20:49] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:49] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:49] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:49] [config] transformer-depth-scaling: false
[2023-07-11 13:20:49] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:49] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:49] [config] transformer-dropout: 0
[2023-07-11 13:20:49] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:49] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:49] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:49] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:49] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:49] [config] transformer-heads: 8
[2023-07-11 13:20:49] [config] transformer-no-projection: false
[2023-07-11 13:20:49] [config] transformer-pool: false
[2023-07-11 13:20:49] [config] transformer-postprocess: dan
[2023-07-11 13:20:49] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:49] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:49] [config] transformer-preprocess: ""
[2023-07-11 13:20:49] [config] transformer-tied-layers:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:49] [config] tsv: false
[2023-07-11 13:20:49] [config] tsv-fields: 0
[2023-07-11 13:20:49] [config] type: transformer
[2023-07-11 13:20:49] [config] ulr: false
[2023-07-11 13:20:49] [config] ulr-dim-emb: 0
[2023-07-11 13:20:49] [config] ulr-dropout: 0
[2023-07-11 13:20:49] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:49] [config] ulr-query-vectors: ""
[2023-07-11 13:20:49] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:49] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:49] [config] unlikelihood-loss: false
[2023-07-11 13:20:49] [config] valid-freq: 50000000
[2023-07-11 13:20:49] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:49] [config] valid-max-length: 1000
[2023-07-11 13:20:49] [config] valid-metrics:
[2023-07-11 13:20:49] [config]   - cross-entropy
[2023-07-11 13:20:49] [config]   - translation
[2023-07-11 13:20:49] [config] valid-mini-batch: 32
[2023-07-11 13:20:49] [config] valid-reset-stalled: false
[2023-07-11 13:20:49] [config] valid-script-args:
[2023-07-11 13:20:49] [config]   []
[2023-07-11 13:20:49] [config] valid-script-path: ""
[2023-07-11 13:20:49] [config] valid-sets:
[2023-07-11 13:20:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:49] [config] vocabs:
[2023-07-11 13:20:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:49] [config] word-penalty: 0
[2023-07-11 13:20:49] [config] word-scores: false
[2023-07-11 13:20:49] [config] workspace: 2048
[2023-07-11 13:20:49] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:49] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:49] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x562e64d875d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x562e64c3d0c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x562e64bf4b9c]    main                                               + 0x3c
[0x7fe7accf20b3]    __libc_start_main                                  + 0xf3
[0x562e64c3bcbe]    _start                                             + 0x2e

[2023-07-11 13:20:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:51] [marian] Running on node23.datos.cluster.uy as process 9660 with command line:
[2023-07-11 13:20:51] [marian] /marian/build/marian --num-devices 3 --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:20:51] [config] after: 0e
[2023-07-11 13:20:51] [config] after-batches: 0
[2023-07-11 13:20:51] [config] after-epochs: 100
[2023-07-11 13:20:51] [config] all-caps-every: 0
[2023-07-11 13:20:51] [config] allow-unk: false
[2023-07-11 13:20:51] [config] authors: false
[2023-07-11 13:20:51] [config] beam-size: 12
[2023-07-11 13:20:51] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:20:51] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:20:51] [config] bert-masking-fraction: 0.15
[2023-07-11 13:20:51] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:20:51] [config] bert-train-type-embeddings: true
[2023-07-11 13:20:51] [config] bert-type-vocab-size: 2
[2023-07-11 13:20:51] [config] build-info: ""
[2023-07-11 13:20:51] [config] check-gradient-nan: false
[2023-07-11 13:20:51] [config] check-nan: false
[2023-07-11 13:20:51] [config] cite: false
[2023-07-11 13:20:51] [config] clip-norm: 1
[2023-07-11 13:20:51] [config] cost-scaling:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] cost-type: ce-sum
[2023-07-11 13:20:51] [config] cpu-threads: 0
[2023-07-11 13:20:51] [config] data-threads: 8
[2023-07-11 13:20:51] [config] data-weighting: ""
[2023-07-11 13:20:51] [config] data-weighting-type: sentence
[2023-07-11 13:20:51] [config] dec-cell: gru
[2023-07-11 13:20:51] [config] dec-cell-base-depth: 2
[2023-07-11 13:20:51] [config] dec-cell-high-depth: 1
[2023-07-11 13:20:51] [config] dec-depth: 1
[2023-07-11 13:20:51] [config] devices:
[2023-07-11 13:20:51] [config]   - 0
[2023-07-11 13:20:51] [config] dim-emb: 512
[2023-07-11 13:20:51] [config] dim-rnn: 1024
[2023-07-11 13:20:51] [config] dim-vocabs:
[2023-07-11 13:20:51] [config]   - 0
[2023-07-11 13:20:51] [config]   - 0
[2023-07-11 13:20:51] [config] disp-first: 0
[2023-07-11 13:20:51] [config] disp-freq: 1000u
[2023-07-11 13:20:51] [config] disp-label-counts: true
[2023-07-11 13:20:51] [config] dropout-rnn: 0
[2023-07-11 13:20:51] [config] dropout-src: 0
[2023-07-11 13:20:51] [config] dropout-trg: 0
[2023-07-11 13:20:51] [config] dump-config: ""
[2023-07-11 13:20:51] [config] dynamic-gradient-scaling:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] early-stopping: 10
[2023-07-11 13:20:51] [config] early-stopping-on: first
[2023-07-11 13:20:51] [config] embedding-fix-src: false
[2023-07-11 13:20:51] [config] embedding-fix-trg: false
[2023-07-11 13:20:51] [config] embedding-normalization: false
[2023-07-11 13:20:51] [config] embedding-vectors:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] enc-cell: gru
[2023-07-11 13:20:51] [config] enc-cell-depth: 1
[2023-07-11 13:20:51] [config] enc-depth: 1
[2023-07-11 13:20:51] [config] enc-type: bidirectional
[2023-07-11 13:20:51] [config] english-title-case-every: 0
[2023-07-11 13:20:51] [config] exponential-smoothing: 0
[2023-07-11 13:20:51] [config] factor-weight: 1
[2023-07-11 13:20:51] [config] factors-combine: sum
[2023-07-11 13:20:51] [config] factors-dim-emb: 0
[2023-07-11 13:20:51] [config] gradient-checkpointing: false
[2023-07-11 13:20:51] [config] gradient-norm-average-window: 100
[2023-07-11 13:20:51] [config] guided-alignment: none
[2023-07-11 13:20:51] [config] guided-alignment-cost: mse
[2023-07-11 13:20:51] [config] guided-alignment-weight: 0.1
[2023-07-11 13:20:51] [config] ignore-model-config: false
[2023-07-11 13:20:51] [config] input-types:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] interpolate-env-vars: false
[2023-07-11 13:20:51] [config] keep-best: false
[2023-07-11 13:20:51] [config] label-smoothing: 0
[2023-07-11 13:20:51] [config] layer-normalization: false
[2023-07-11 13:20:51] [config] learn-rate: 0.0001
[2023-07-11 13:20:51] [config] lemma-dependency: ""
[2023-07-11 13:20:51] [config] lemma-dim-emb: 0
[2023-07-11 13:20:51] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:51] [config] log-level: info
[2023-07-11 13:20:51] [config] log-time-zone: ""
[2023-07-11 13:20:51] [config] logical-epoch:
[2023-07-11 13:20:51] [config]   - 1e
[2023-07-11 13:20:51] [config]   - 0
[2023-07-11 13:20:51] [config] lr-decay: 0
[2023-07-11 13:20:51] [config] lr-decay-freq: 50000
[2023-07-11 13:20:51] [config] lr-decay-inv-sqrt:
[2023-07-11 13:20:51] [config]   - 0
[2023-07-11 13:20:51] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:20:51] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:20:51] [config] lr-decay-start:
[2023-07-11 13:20:51] [config]   - 10
[2023-07-11 13:20:51] [config]   - 1
[2023-07-11 13:20:51] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:20:51] [config] lr-report: false
[2023-07-11 13:20:51] [config] lr-warmup: 0
[2023-07-11 13:20:51] [config] lr-warmup-at-reload: false
[2023-07-11 13:20:51] [config] lr-warmup-cycle: false
[2023-07-11 13:20:51] [config] lr-warmup-start-rate: 0
[2023-07-11 13:20:51] [config] max-length: 50
[2023-07-11 13:20:51] [config] max-length-crop: false
[2023-07-11 13:20:51] [config] max-length-factor: 3
[2023-07-11 13:20:51] [config] maxi-batch: 100
[2023-07-11 13:20:51] [config] maxi-batch-sort: trg
[2023-07-11 13:20:51] [config] mini-batch: 64
[2023-07-11 13:20:51] [config] mini-batch-fit: false
[2023-07-11 13:20:51] [config] mini-batch-fit-step: 10
[2023-07-11 13:20:51] [config] mini-batch-round-up: true
[2023-07-11 13:20:51] [config] mini-batch-track-lr: false
[2023-07-11 13:20:51] [config] mini-batch-warmup: 0
[2023-07-11 13:20:51] [config] mini-batch-words: 0
[2023-07-11 13:20:51] [config] mini-batch-words-ref: 0
[2023-07-11 13:20:51] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:20:51] [config] multi-loss-type: sum
[2023-07-11 13:20:51] [config] n-best: false
[2023-07-11 13:20:51] [config] no-nccl: false
[2023-07-11 13:20:51] [config] no-reload: false
[2023-07-11 13:20:51] [config] no-restore-corpus: false
[2023-07-11 13:20:51] [config] normalize: 0
[2023-07-11 13:20:51] [config] normalize-gradient: false
[2023-07-11 13:20:51] [config] num-devices: 3
[2023-07-11 13:20:51] [config] optimizer: adam
[2023-07-11 13:20:51] [config] optimizer-delay: 1
[2023-07-11 13:20:51] [config] optimizer-params:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] output-omit-bias: false
[2023-07-11 13:20:51] [config] overwrite: true
[2023-07-11 13:20:51] [config] precision:
[2023-07-11 13:20:51] [config]   - float32
[2023-07-11 13:20:51] [config]   - float32
[2023-07-11 13:20:51] [config] pretrained-model: ""
[2023-07-11 13:20:51] [config] quantize-biases: false
[2023-07-11 13:20:51] [config] quantize-bits: 0
[2023-07-11 13:20:51] [config] quantize-log-based: false
[2023-07-11 13:20:51] [config] quantize-optimization-steps: 0
[2023-07-11 13:20:51] [config] quiet: false
[2023-07-11 13:20:51] [config] quiet-translation: true
[2023-07-11 13:20:51] [config] relative-paths: false
[2023-07-11 13:20:51] [config] right-left: false
[2023-07-11 13:20:51] [config] save-freq: 10000u
[2023-07-11 13:20:51] [config] seed: 1234
[2023-07-11 13:20:51] [config] sentencepiece-alphas:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:20:51] [config] sentencepiece-options: ""
[2023-07-11 13:20:51] [config] sharding: global
[2023-07-11 13:20:51] [config] shuffle: data
[2023-07-11 13:20:51] [config] shuffle-in-ram: false
[2023-07-11 13:20:51] [config] sigterm: save-and-exit
[2023-07-11 13:20:51] [config] skip: false
[2023-07-11 13:20:51] [config] sqlite: ""
[2023-07-11 13:20:51] [config] sqlite-drop: false
[2023-07-11 13:20:51] [config] sync-freq: 200u
[2023-07-11 13:20:51] [config] sync-sgd: false
[2023-07-11 13:20:51] [config] tempdir: /tmp
[2023-07-11 13:20:51] [config] tied-embeddings: false
[2023-07-11 13:20:51] [config] tied-embeddings-all: false
[2023-07-11 13:20:51] [config] tied-embeddings-src: false
[2023-07-11 13:20:51] [config] train-embedder-rank:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] train-sets:
[2023-07-11 13:20:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:20:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:20:51] [config] transformer-aan-activation: swish
[2023-07-11 13:20:51] [config] transformer-aan-depth: 2
[2023-07-11 13:20:51] [config] transformer-aan-nogate: false
[2023-07-11 13:20:51] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:20:51] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:20:51] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:20:51] [config] transformer-depth-scaling: false
[2023-07-11 13:20:51] [config] transformer-dim-aan: 2048
[2023-07-11 13:20:51] [config] transformer-dim-ffn: 2048
[2023-07-11 13:20:51] [config] transformer-dropout: 0
[2023-07-11 13:20:51] [config] transformer-dropout-attention: 0
[2023-07-11 13:20:51] [config] transformer-dropout-ffn: 0
[2023-07-11 13:20:51] [config] transformer-ffn-activation: swish
[2023-07-11 13:20:51] [config] transformer-ffn-depth: 2
[2023-07-11 13:20:51] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:20:51] [config] transformer-heads: 8
[2023-07-11 13:20:51] [config] transformer-no-projection: false
[2023-07-11 13:20:51] [config] transformer-pool: false
[2023-07-11 13:20:51] [config] transformer-postprocess: dan
[2023-07-11 13:20:51] [config] transformer-postprocess-emb: d
[2023-07-11 13:20:51] [config] transformer-postprocess-top: ""
[2023-07-11 13:20:51] [config] transformer-preprocess: ""
[2023-07-11 13:20:51] [config] transformer-tied-layers:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] transformer-train-position-embeddings: false
[2023-07-11 13:20:51] [config] tsv: false
[2023-07-11 13:20:51] [config] tsv-fields: 0
[2023-07-11 13:20:51] [config] type: transformer
[2023-07-11 13:20:51] [config] ulr: false
[2023-07-11 13:20:51] [config] ulr-dim-emb: 0
[2023-07-11 13:20:51] [config] ulr-dropout: 0
[2023-07-11 13:20:51] [config] ulr-keys-vectors: ""
[2023-07-11 13:20:51] [config] ulr-query-vectors: ""
[2023-07-11 13:20:51] [config] ulr-softmax-temperature: 1
[2023-07-11 13:20:51] [config] ulr-trainable-transformation: false
[2023-07-11 13:20:51] [config] unlikelihood-loss: false
[2023-07-11 13:20:51] [config] valid-freq: 50000000
[2023-07-11 13:20:51] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:20:51] [config] valid-max-length: 1000
[2023-07-11 13:20:51] [config] valid-metrics:
[2023-07-11 13:20:51] [config]   - cross-entropy
[2023-07-11 13:20:51] [config]   - translation
[2023-07-11 13:20:51] [config] valid-mini-batch: 32
[2023-07-11 13:20:51] [config] valid-reset-stalled: false
[2023-07-11 13:20:51] [config] valid-script-args:
[2023-07-11 13:20:51] [config]   []
[2023-07-11 13:20:51] [config] valid-script-path: ""
[2023-07-11 13:20:51] [config] valid-sets:
[2023-07-11 13:20:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:20:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:20:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:20:51] [config] vocabs:
[2023-07-11 13:20:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:20:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:20:51] [config] word-penalty: 0
[2023-07-11 13:20:51] [config] word-scores: false
[2023-07-11 13:20:51] [config] workspace: 2048
[2023-07-11 13:20:51] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:20:51] Error: devices[] size must be equal to numDevices
[2023-07-11 13:20:51] Error: Aborted from static std::vector<marian::DeviceId> marian::Config::getDevices(marian::Ptr<marian::Options>, size_t, size_t) in /marian/src/common/config.cpp:292

[CALL STACK]
[0x55bbbcab75d1]    marian::Config::  getDevices  (std::shared_ptr<marian::Options>,  unsigned long,  unsigned long) + 0xb91
[0x55bbbc96d0c3]    mainTrainer  (int,  char**)                        + 0x1c3
[0x55bbbc924b9c]    main                                               + 0x3c
[0x7fc785e0a0b3]    __libc_start_main                                  + 0xf3
[0x55bbbc96bcbe]    _start                                             + 0x2e

[2023-07-11 13:26:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:26:37] [marian] Running on node23.datos.cluster.uy as process 10063 with command line:
[2023-07-11 13:26:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:26:37] [config] after: 0e
[2023-07-11 13:26:37] [config] after-batches: 0
[2023-07-11 13:26:37] [config] after-epochs: 10
[2023-07-11 13:26:37] [config] all-caps-every: 0
[2023-07-11 13:26:37] [config] allow-unk: false
[2023-07-11 13:26:37] [config] authors: false
[2023-07-11 13:26:37] [config] beam-size: 12
[2023-07-11 13:26:37] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:26:37] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:26:37] [config] bert-masking-fraction: 0.15
[2023-07-11 13:26:37] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:26:37] [config] bert-train-type-embeddings: true
[2023-07-11 13:26:37] [config] bert-type-vocab-size: 2
[2023-07-11 13:26:37] [config] build-info: ""
[2023-07-11 13:26:37] [config] check-gradient-nan: false
[2023-07-11 13:26:37] [config] check-nan: false
[2023-07-11 13:26:37] [config] cite: false
[2023-07-11 13:26:37] [config] clip-norm: 1
[2023-07-11 13:26:37] [config] cost-scaling:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] cost-type: ce-sum
[2023-07-11 13:26:37] [config] cpu-threads: 0
[2023-07-11 13:26:37] [config] data-threads: 8
[2023-07-11 13:26:37] [config] data-weighting: ""
[2023-07-11 13:26:37] [config] data-weighting-type: sentence
[2023-07-11 13:26:37] [config] dec-cell: gru
[2023-07-11 13:26:37] [config] dec-cell-base-depth: 2
[2023-07-11 13:26:37] [config] dec-cell-high-depth: 1
[2023-07-11 13:26:37] [config] dec-depth: 1
[2023-07-11 13:26:37] [config] devices:
[2023-07-11 13:26:37] [config]   - 0
[2023-07-11 13:26:37] [config] dim-emb: 512
[2023-07-11 13:26:37] [config] dim-rnn: 1024
[2023-07-11 13:26:37] [config] dim-vocabs:
[2023-07-11 13:26:37] [config]   - 0
[2023-07-11 13:26:37] [config]   - 0
[2023-07-11 13:26:37] [config] disp-first: 0
[2023-07-11 13:26:37] [config] disp-freq: 1000u
[2023-07-11 13:26:37] [config] disp-label-counts: true
[2023-07-11 13:26:37] [config] dropout-rnn: 0
[2023-07-11 13:26:37] [config] dropout-src: 0
[2023-07-11 13:26:37] [config] dropout-trg: 0
[2023-07-11 13:26:37] [config] dump-config: ""
[2023-07-11 13:26:37] [config] dynamic-gradient-scaling:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] early-stopping: 10
[2023-07-11 13:26:37] [config] early-stopping-on: first
[2023-07-11 13:26:37] [config] embedding-fix-src: false
[2023-07-11 13:26:37] [config] embedding-fix-trg: false
[2023-07-11 13:26:37] [config] embedding-normalization: false
[2023-07-11 13:26:37] [config] embedding-vectors:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] enc-cell: gru
[2023-07-11 13:26:37] [config] enc-cell-depth: 1
[2023-07-11 13:26:37] [config] enc-depth: 1
[2023-07-11 13:26:37] [config] enc-type: bidirectional
[2023-07-11 13:26:37] [config] english-title-case-every: 0
[2023-07-11 13:26:37] [config] exponential-smoothing: 0
[2023-07-11 13:26:37] [config] factor-weight: 1
[2023-07-11 13:26:37] [config] factors-combine: sum
[2023-07-11 13:26:37] [config] factors-dim-emb: 0
[2023-07-11 13:26:37] [config] gradient-checkpointing: false
[2023-07-11 13:26:37] [config] gradient-norm-average-window: 100
[2023-07-11 13:26:37] [config] guided-alignment: none
[2023-07-11 13:26:37] [config] guided-alignment-cost: mse
[2023-07-11 13:26:37] [config] guided-alignment-weight: 0.1
[2023-07-11 13:26:37] [config] ignore-model-config: false
[2023-07-11 13:26:37] [config] input-types:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] interpolate-env-vars: false
[2023-07-11 13:26:37] [config] keep-best: false
[2023-07-11 13:26:37] [config] label-smoothing: 0
[2023-07-11 13:26:37] [config] layer-normalization: false
[2023-07-11 13:26:37] [config] learn-rate: 0.0001
[2023-07-11 13:26:37] [config] lemma-dependency: ""
[2023-07-11 13:26:37] [config] lemma-dim-emb: 0
[2023-07-11 13:26:37] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:26:37] [config] log-level: info
[2023-07-11 13:26:37] [config] log-time-zone: ""
[2023-07-11 13:26:37] [config] logical-epoch:
[2023-07-11 13:26:37] [config]   - 1e
[2023-07-11 13:26:37] [config]   - 0
[2023-07-11 13:26:37] [config] lr-decay: 0
[2023-07-11 13:26:37] [config] lr-decay-freq: 50000
[2023-07-11 13:26:37] [config] lr-decay-inv-sqrt:
[2023-07-11 13:26:37] [config]   - 0
[2023-07-11 13:26:37] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:26:37] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:26:37] [config] lr-decay-start:
[2023-07-11 13:26:37] [config]   - 10
[2023-07-11 13:26:37] [config]   - 1
[2023-07-11 13:26:37] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:26:37] [config] lr-report: false
[2023-07-11 13:26:37] [config] lr-warmup: 0
[2023-07-11 13:26:37] [config] lr-warmup-at-reload: false
[2023-07-11 13:26:37] [config] lr-warmup-cycle: false
[2023-07-11 13:26:37] [config] lr-warmup-start-rate: 0
[2023-07-11 13:26:37] [config] max-length: 50
[2023-07-11 13:26:37] [config] max-length-crop: false
[2023-07-11 13:26:37] [config] max-length-factor: 3
[2023-07-11 13:26:37] [config] maxi-batch: 100
[2023-07-11 13:26:37] [config] maxi-batch-sort: trg
[2023-07-11 13:26:37] [config] mini-batch: 64
[2023-07-11 13:26:37] [config] mini-batch-fit: false
[2023-07-11 13:26:37] [config] mini-batch-fit-step: 10
[2023-07-11 13:26:37] [config] mini-batch-round-up: true
[2023-07-11 13:26:37] [config] mini-batch-track-lr: false
[2023-07-11 13:26:37] [config] mini-batch-warmup: 0
[2023-07-11 13:26:37] [config] mini-batch-words: 0
[2023-07-11 13:26:37] [config] mini-batch-words-ref: 0
[2023-07-11 13:26:37] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:26:37] [config] multi-loss-type: sum
[2023-07-11 13:26:37] [config] n-best: false
[2023-07-11 13:26:37] [config] no-nccl: false
[2023-07-11 13:26:37] [config] no-reload: false
[2023-07-11 13:26:37] [config] no-restore-corpus: false
[2023-07-11 13:26:37] [config] normalize: 0
[2023-07-11 13:26:37] [config] normalize-gradient: false
[2023-07-11 13:26:37] [config] num-devices: 0
[2023-07-11 13:26:37] [config] optimizer: adam
[2023-07-11 13:26:37] [config] optimizer-delay: 1
[2023-07-11 13:26:37] [config] optimizer-params:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] output-omit-bias: false
[2023-07-11 13:26:37] [config] overwrite: true
[2023-07-11 13:26:37] [config] precision:
[2023-07-11 13:26:37] [config]   - float32
[2023-07-11 13:26:37] [config]   - float32
[2023-07-11 13:26:37] [config] pretrained-model: ""
[2023-07-11 13:26:37] [config] quantize-biases: false
[2023-07-11 13:26:37] [config] quantize-bits: 0
[2023-07-11 13:26:37] [config] quantize-log-based: false
[2023-07-11 13:26:37] [config] quantize-optimization-steps: 0
[2023-07-11 13:26:37] [config] quiet: false
[2023-07-11 13:26:37] [config] quiet-translation: true
[2023-07-11 13:26:37] [config] relative-paths: false
[2023-07-11 13:26:37] [config] right-left: false
[2023-07-11 13:26:37] [config] save-freq: 10000u
[2023-07-11 13:26:37] [config] seed: 1234
[2023-07-11 13:26:37] [config] sentencepiece-alphas:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:26:37] [config] sentencepiece-options: ""
[2023-07-11 13:26:37] [config] sharding: global
[2023-07-11 13:26:37] [config] shuffle: data
[2023-07-11 13:26:37] [config] shuffle-in-ram: false
[2023-07-11 13:26:37] [config] sigterm: save-and-exit
[2023-07-11 13:26:37] [config] skip: false
[2023-07-11 13:26:37] [config] sqlite: ""
[2023-07-11 13:26:37] [config] sqlite-drop: false
[2023-07-11 13:26:37] [config] sync-freq: 200u
[2023-07-11 13:26:37] [config] sync-sgd: false
[2023-07-11 13:26:37] [config] tempdir: /tmp
[2023-07-11 13:26:37] [config] tied-embeddings: false
[2023-07-11 13:26:37] [config] tied-embeddings-all: false
[2023-07-11 13:26:37] [config] tied-embeddings-src: false
[2023-07-11 13:26:37] [config] train-embedder-rank:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] train-sets:
[2023-07-11 13:26:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:26:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:26:37] [config] transformer-aan-activation: swish
[2023-07-11 13:26:37] [config] transformer-aan-depth: 2
[2023-07-11 13:26:37] [config] transformer-aan-nogate: false
[2023-07-11 13:26:37] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:26:37] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:26:37] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:26:37] [config] transformer-depth-scaling: false
[2023-07-11 13:26:37] [config] transformer-dim-aan: 2048
[2023-07-11 13:26:37] [config] transformer-dim-ffn: 2048
[2023-07-11 13:26:37] [config] transformer-dropout: 0
[2023-07-11 13:26:37] [config] transformer-dropout-attention: 0
[2023-07-11 13:26:37] [config] transformer-dropout-ffn: 0
[2023-07-11 13:26:37] [config] transformer-ffn-activation: swish
[2023-07-11 13:26:37] [config] transformer-ffn-depth: 2
[2023-07-11 13:26:37] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:26:37] [config] transformer-heads: 8
[2023-07-11 13:26:37] [config] transformer-no-projection: false
[2023-07-11 13:26:37] [config] transformer-pool: false
[2023-07-11 13:26:37] [config] transformer-postprocess: dan
[2023-07-11 13:26:37] [config] transformer-postprocess-emb: d
[2023-07-11 13:26:37] [config] transformer-postprocess-top: ""
[2023-07-11 13:26:37] [config] transformer-preprocess: ""
[2023-07-11 13:26:37] [config] transformer-tied-layers:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] transformer-train-position-embeddings: false
[2023-07-11 13:26:37] [config] tsv: false
[2023-07-11 13:26:37] [config] tsv-fields: 0
[2023-07-11 13:26:37] [config] type: transformer
[2023-07-11 13:26:37] [config] ulr: false
[2023-07-11 13:26:37] [config] ulr-dim-emb: 0
[2023-07-11 13:26:37] [config] ulr-dropout: 0
[2023-07-11 13:26:37] [config] ulr-keys-vectors: ""
[2023-07-11 13:26:37] [config] ulr-query-vectors: ""
[2023-07-11 13:26:37] [config] ulr-softmax-temperature: 1
[2023-07-11 13:26:37] [config] ulr-trainable-transformation: false
[2023-07-11 13:26:37] [config] unlikelihood-loss: false
[2023-07-11 13:26:37] [config] valid-freq: 50000000
[2023-07-11 13:26:37] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:26:37] [config] valid-max-length: 1000
[2023-07-11 13:26:37] [config] valid-metrics:
[2023-07-11 13:26:37] [config]   - cross-entropy
[2023-07-11 13:26:37] [config]   - translation
[2023-07-11 13:26:37] [config] valid-mini-batch: 32
[2023-07-11 13:26:37] [config] valid-reset-stalled: false
[2023-07-11 13:26:37] [config] valid-script-args:
[2023-07-11 13:26:37] [config]   []
[2023-07-11 13:26:37] [config] valid-script-path: ""
[2023-07-11 13:26:37] [config] valid-sets:
[2023-07-11 13:26:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:26:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:26:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:26:37] [config] vocabs:
[2023-07-11 13:26:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:26:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:26:37] [config] word-penalty: 0
[2023-07-11 13:26:37] [config] word-scores: false
[2023-07-11 13:26:37] [config] workspace: 2048
[2023-07-11 13:26:37] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:26:37] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:26:37] [training] Using single-device training
[2023-07-11 13:26:38] Synced seed 1234
[2023-07-11 13:26:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:26:38] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:26:38] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:26:38] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:26:38] [valid] No post-processing script given for validating translator
[2023-07-11 13:26:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:26:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:26:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:26:41] [comm] Using global sharding
[2023-07-11 13:26:41] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:26:41] [training] Using 1 GPUs
[2023-07-11 13:26:41] Training started
[2023-07-11 13:26:41] [data] Shuffling data
[2023-07-11 13:26:41] [data] Done reading 20,192 sentences
[2023-07-11 13:26:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:26:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:26:41] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:26:41] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:26:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:26:43] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:26:43] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:26:43] Allocating memory for Adam-specific shards
[2023-07-11 13:26:43] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:27:00] Seen 18,843 samples
[2023-07-11 13:27:00] Starting data epoch 2 in logical epoch 2
[2023-07-11 13:27:00] [data] Shuffling data
[2023-07-11 13:27:00] [data] Done reading 20,192 sentences
[2023-07-11 13:27:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:27:17] Seen 18,843 samples
[2023-07-11 13:27:17] Starting data epoch 3 in logical epoch 3
[2023-07-11 13:27:17] [data] Shuffling data
[2023-07-11 13:27:17] [data] Done reading 20,192 sentences
[2023-07-11 13:27:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:27:33] Seen 18,843 samples
[2023-07-11 13:27:33] Starting data epoch 4 in logical epoch 4
[2023-07-11 13:27:33] [data] Shuffling data
[2023-07-11 13:27:33] [data] Done reading 20,192 sentences
[2023-07-11 13:27:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:27:40] Ep. 4 : Up. 1000 : Sen. 6,932 : Cost 5.39951372 * 1,343,216 @ 768 after 1,343,216 : Time 61.65s : 21788.59 words/s : gNorm 2.2512
[2023-07-11 13:27:50] Seen 18,843 samples
[2023-07-11 13:27:50] Starting data epoch 5 in logical epoch 5
[2023-07-11 13:27:50] [data] Shuffling data
[2023-07-11 13:27:50] [data] Done reading 20,192 sentences
[2023-07-11 13:27:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:28:07] Seen 18,843 samples
[2023-07-11 13:28:07] Starting data epoch 6 in logical epoch 6
[2023-07-11 13:28:07] [data] Shuffling data
[2023-07-11 13:28:07] [data] Done reading 20,192 sentences
[2023-07-11 13:28:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:28:24] Seen 18,843 samples
[2023-07-11 13:28:24] Starting data epoch 7 in logical epoch 7
[2023-07-11 13:28:24] [data] Shuffling data
[2023-07-11 13:28:24] [data] Done reading 20,192 sentences
[2023-07-11 13:28:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:28:36] Ep. 7 : Up. 2000 : Sen. 13,882 : Cost 3.33698583 * 1,334,929 @ 2,976 after 2,678,145 : Time 56.03s : 23826.29 words/s : gNorm 2.7515
[2023-07-11 13:28:40] Seen 18,843 samples
[2023-07-11 13:28:40] Starting data epoch 8 in logical epoch 8
[2023-07-11 13:28:40] [data] Shuffling data
[2023-07-11 13:28:40] [data] Done reading 20,192 sentences
[2023-07-11 13:28:40] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:28:57] Seen 18,843 samples
[2023-07-11 13:28:57] Starting data epoch 9 in logical epoch 9
[2023-07-11 13:28:57] [data] Shuffling data
[2023-07-11 13:28:57] [data] Done reading 20,192 sentences
[2023-07-11 13:28:57] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:29:14] Seen 18,843 samples
[2023-07-11 13:29:14] Starting data epoch 10 in logical epoch 10
[2023-07-11 13:29:14] [data] Shuffling data
[2023-07-11 13:29:14] [data] Done reading 20,192 sentences
[2023-07-11 13:29:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:29:30] Seen 18,843 samples
[2023-07-11 13:29:30] Starting data epoch 11 in logical epoch 11
[2023-07-11 13:29:30] Training finished
[2023-07-11 13:29:33] [valid] Ep. 11 : Up. 2968 : cross-entropy : 125.788 : new best
[2023-07-11 13:31:29] [valid] Ep. 11 : Up. 2968 : translation : 0 : new best
[2023-07-11 13:31:29] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:31:31] Saving Adam parameters
[2023-07-11 13:31:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:31:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:31:41] [marian] Running on node23.datos.cluster.uy as process 10409 with command line:
[2023-07-11 13:31:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:31:41] [config] after: 0e
[2023-07-11 13:31:41] [config] after-batches: 0
[2023-07-11 13:31:41] [config] after-epochs: 20
[2023-07-11 13:31:41] [config] all-caps-every: 0
[2023-07-11 13:31:41] [config] allow-unk: false
[2023-07-11 13:31:41] [config] authors: false
[2023-07-11 13:31:41] [config] beam-size: 12
[2023-07-11 13:31:41] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:31:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:31:41] [config] bert-masking-fraction: 0.15
[2023-07-11 13:31:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:31:41] [config] bert-train-type-embeddings: true
[2023-07-11 13:31:41] [config] bert-type-vocab-size: 2
[2023-07-11 13:31:41] [config] build-info: ""
[2023-07-11 13:31:41] [config] check-gradient-nan: false
[2023-07-11 13:31:41] [config] check-nan: false
[2023-07-11 13:31:41] [config] cite: false
[2023-07-11 13:31:41] [config] clip-norm: 1
[2023-07-11 13:31:41] [config] cost-scaling:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] cost-type: ce-sum
[2023-07-11 13:31:41] [config] cpu-threads: 0
[2023-07-11 13:31:41] [config] data-threads: 8
[2023-07-11 13:31:41] [config] data-weighting: ""
[2023-07-11 13:31:41] [config] data-weighting-type: sentence
[2023-07-11 13:31:41] [config] dec-cell: gru
[2023-07-11 13:31:41] [config] dec-cell-base-depth: 2
[2023-07-11 13:31:41] [config] dec-cell-high-depth: 1
[2023-07-11 13:31:41] [config] dec-depth: 1
[2023-07-11 13:31:41] [config] devices:
[2023-07-11 13:31:41] [config]   - 0
[2023-07-11 13:31:41] [config] dim-emb: 512
[2023-07-11 13:31:41] [config] dim-rnn: 1024
[2023-07-11 13:31:41] [config] dim-vocabs:
[2023-07-11 13:31:41] [config]   - 54042
[2023-07-11 13:31:41] [config]   - 36507
[2023-07-11 13:31:41] [config] disp-first: 0
[2023-07-11 13:31:41] [config] disp-freq: 1000u
[2023-07-11 13:31:41] [config] disp-label-counts: true
[2023-07-11 13:31:41] [config] dropout-rnn: 0
[2023-07-11 13:31:41] [config] dropout-src: 0
[2023-07-11 13:31:41] [config] dropout-trg: 0
[2023-07-11 13:31:41] [config] dump-config: ""
[2023-07-11 13:31:41] [config] dynamic-gradient-scaling:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] early-stopping: 10
[2023-07-11 13:31:41] [config] early-stopping-on: first
[2023-07-11 13:31:41] [config] embedding-fix-src: false
[2023-07-11 13:31:41] [config] embedding-fix-trg: false
[2023-07-11 13:31:41] [config] embedding-normalization: false
[2023-07-11 13:31:41] [config] embedding-vectors:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] enc-cell: gru
[2023-07-11 13:31:41] [config] enc-cell-depth: 1
[2023-07-11 13:31:41] [config] enc-depth: 1
[2023-07-11 13:31:41] [config] enc-type: bidirectional
[2023-07-11 13:31:41] [config] english-title-case-every: 0
[2023-07-11 13:31:41] [config] exponential-smoothing: 0
[2023-07-11 13:31:41] [config] factor-weight: 1
[2023-07-11 13:31:41] [config] factors-combine: sum
[2023-07-11 13:31:41] [config] factors-dim-emb: 0
[2023-07-11 13:31:41] [config] gradient-checkpointing: false
[2023-07-11 13:31:41] [config] gradient-norm-average-window: 100
[2023-07-11 13:31:41] [config] guided-alignment: none
[2023-07-11 13:31:41] [config] guided-alignment-cost: mse
[2023-07-11 13:31:41] [config] guided-alignment-weight: 0.1
[2023-07-11 13:31:41] [config] ignore-model-config: false
[2023-07-11 13:31:41] [config] input-types:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] interpolate-env-vars: false
[2023-07-11 13:31:41] [config] keep-best: false
[2023-07-11 13:31:41] [config] label-smoothing: 0
[2023-07-11 13:31:41] [config] layer-normalization: false
[2023-07-11 13:31:41] [config] learn-rate: 0.0001
[2023-07-11 13:31:41] [config] lemma-dependency: ""
[2023-07-11 13:31:41] [config] lemma-dim-emb: 0
[2023-07-11 13:31:41] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:31:41] [config] log-level: info
[2023-07-11 13:31:41] [config] log-time-zone: ""
[2023-07-11 13:31:41] [config] logical-epoch:
[2023-07-11 13:31:41] [config]   - 1e
[2023-07-11 13:31:41] [config]   - 0
[2023-07-11 13:31:41] [config] lr-decay: 0
[2023-07-11 13:31:41] [config] lr-decay-freq: 50000
[2023-07-11 13:31:41] [config] lr-decay-inv-sqrt:
[2023-07-11 13:31:41] [config]   - 0
[2023-07-11 13:31:41] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:31:41] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:31:41] [config] lr-decay-start:
[2023-07-11 13:31:41] [config]   - 10
[2023-07-11 13:31:41] [config]   - 1
[2023-07-11 13:31:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:31:41] [config] lr-report: false
[2023-07-11 13:31:41] [config] lr-warmup: 0
[2023-07-11 13:31:41] [config] lr-warmup-at-reload: false
[2023-07-11 13:31:41] [config] lr-warmup-cycle: false
[2023-07-11 13:31:41] [config] lr-warmup-start-rate: 0
[2023-07-11 13:31:41] [config] max-length: 50
[2023-07-11 13:31:41] [config] max-length-crop: false
[2023-07-11 13:31:41] [config] max-length-factor: 3
[2023-07-11 13:31:41] [config] maxi-batch: 100
[2023-07-11 13:31:41] [config] maxi-batch-sort: trg
[2023-07-11 13:31:41] [config] mini-batch: 64
[2023-07-11 13:31:41] [config] mini-batch-fit: false
[2023-07-11 13:31:41] [config] mini-batch-fit-step: 10
[2023-07-11 13:31:41] [config] mini-batch-round-up: true
[2023-07-11 13:31:41] [config] mini-batch-track-lr: false
[2023-07-11 13:31:41] [config] mini-batch-warmup: 0
[2023-07-11 13:31:41] [config] mini-batch-words: 0
[2023-07-11 13:31:41] [config] mini-batch-words-ref: 0
[2023-07-11 13:31:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:31:41] [config] multi-loss-type: sum
[2023-07-11 13:31:41] [config] n-best: false
[2023-07-11 13:31:41] [config] no-nccl: false
[2023-07-11 13:31:41] [config] no-reload: false
[2023-07-11 13:31:41] [config] no-restore-corpus: false
[2023-07-11 13:31:41] [config] normalize: 0
[2023-07-11 13:31:41] [config] normalize-gradient: false
[2023-07-11 13:31:41] [config] num-devices: 0
[2023-07-11 13:31:41] [config] optimizer: adam
[2023-07-11 13:31:41] [config] optimizer-delay: 1
[2023-07-11 13:31:41] [config] optimizer-params:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] output-omit-bias: false
[2023-07-11 13:31:41] [config] overwrite: true
[2023-07-11 13:31:41] [config] precision:
[2023-07-11 13:31:41] [config]   - float32
[2023-07-11 13:31:41] [config]   - float32
[2023-07-11 13:31:41] [config] pretrained-model: ""
[2023-07-11 13:31:41] [config] quantize-biases: false
[2023-07-11 13:31:41] [config] quantize-bits: 0
[2023-07-11 13:31:41] [config] quantize-log-based: false
[2023-07-11 13:31:41] [config] quantize-optimization-steps: 0
[2023-07-11 13:31:41] [config] quiet: false
[2023-07-11 13:31:41] [config] quiet-translation: true
[2023-07-11 13:31:41] [config] relative-paths: false
[2023-07-11 13:31:41] [config] right-left: false
[2023-07-11 13:31:41] [config] save-freq: 10000u
[2023-07-11 13:31:41] [config] seed: 1234
[2023-07-11 13:31:41] [config] sentencepiece-alphas:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:31:41] [config] sentencepiece-options: ""
[2023-07-11 13:31:41] [config] sharding: global
[2023-07-11 13:31:41] [config] shuffle: data
[2023-07-11 13:31:41] [config] shuffle-in-ram: false
[2023-07-11 13:31:41] [config] sigterm: save-and-exit
[2023-07-11 13:31:41] [config] skip: false
[2023-07-11 13:31:41] [config] sqlite: ""
[2023-07-11 13:31:41] [config] sqlite-drop: false
[2023-07-11 13:31:41] [config] sync-freq: 200u
[2023-07-11 13:31:41] [config] sync-sgd: false
[2023-07-11 13:31:41] [config] tempdir: /tmp
[2023-07-11 13:31:41] [config] tied-embeddings: false
[2023-07-11 13:31:41] [config] tied-embeddings-all: false
[2023-07-11 13:31:41] [config] tied-embeddings-src: false
[2023-07-11 13:31:41] [config] train-embedder-rank:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] train-sets:
[2023-07-11 13:31:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:31:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:31:41] [config] transformer-aan-activation: swish
[2023-07-11 13:31:41] [config] transformer-aan-depth: 2
[2023-07-11 13:31:41] [config] transformer-aan-nogate: false
[2023-07-11 13:31:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:31:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:31:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:31:41] [config] transformer-depth-scaling: false
[2023-07-11 13:31:41] [config] transformer-dim-aan: 2048
[2023-07-11 13:31:41] [config] transformer-dim-ffn: 2048
[2023-07-11 13:31:41] [config] transformer-dropout: 0
[2023-07-11 13:31:41] [config] transformer-dropout-attention: 0
[2023-07-11 13:31:41] [config] transformer-dropout-ffn: 0
[2023-07-11 13:31:41] [config] transformer-ffn-activation: swish
[2023-07-11 13:31:41] [config] transformer-ffn-depth: 2
[2023-07-11 13:31:41] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:31:41] [config] transformer-heads: 8
[2023-07-11 13:31:41] [config] transformer-no-projection: false
[2023-07-11 13:31:41] [config] transformer-pool: false
[2023-07-11 13:31:41] [config] transformer-postprocess: dan
[2023-07-11 13:31:41] [config] transformer-postprocess-emb: d
[2023-07-11 13:31:41] [config] transformer-postprocess-top: ""
[2023-07-11 13:31:41] [config] transformer-preprocess: ""
[2023-07-11 13:31:41] [config] transformer-tied-layers:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] transformer-train-position-embeddings: false
[2023-07-11 13:31:41] [config] tsv: false
[2023-07-11 13:31:41] [config] tsv-fields: 0
[2023-07-11 13:31:41] [config] type: transformer
[2023-07-11 13:31:41] [config] ulr: false
[2023-07-11 13:31:41] [config] ulr-dim-emb: 0
[2023-07-11 13:31:41] [config] ulr-dropout: 0
[2023-07-11 13:31:41] [config] ulr-keys-vectors: ""
[2023-07-11 13:31:41] [config] ulr-query-vectors: ""
[2023-07-11 13:31:41] [config] ulr-softmax-temperature: 1
[2023-07-11 13:31:41] [config] ulr-trainable-transformation: false
[2023-07-11 13:31:41] [config] unlikelihood-loss: false
[2023-07-11 13:31:41] [config] valid-freq: 50000000
[2023-07-11 13:31:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:31:41] [config] valid-max-length: 1000
[2023-07-11 13:31:41] [config] valid-metrics:
[2023-07-11 13:31:41] [config]   - cross-entropy
[2023-07-11 13:31:41] [config]   - translation
[2023-07-11 13:31:41] [config] valid-mini-batch: 32
[2023-07-11 13:31:41] [config] valid-reset-stalled: false
[2023-07-11 13:31:41] [config] valid-script-args:
[2023-07-11 13:31:41] [config]   []
[2023-07-11 13:31:41] [config] valid-script-path: ""
[2023-07-11 13:31:41] [config] valid-sets:
[2023-07-11 13:31:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:31:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:31:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:31:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:31:41] [config] vocabs:
[2023-07-11 13:31:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:31:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:31:41] [config] word-penalty: 0
[2023-07-11 13:31:41] [config] word-scores: false
[2023-07-11 13:31:41] [config] workspace: 2048
[2023-07-11 13:31:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:31:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:31:41] [training] Using single-device training
[2023-07-11 13:31:41] Synced seed 1234
[2023-07-11 13:31:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:31:41] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:31:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:31:41] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:31:41] [valid] No post-processing script given for validating translator
[2023-07-11 13:31:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:31:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:31:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:31:43] [comm] Using global sharding
[2023-07-11 13:31:43] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:31:43] [training] Using 1 GPUs
[2023-07-11 13:31:43] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:31:45] Loading Adam parameters
[2023-07-11 13:31:45] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:31:45] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:31:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:31:46] [data] Restoring the corpus state to epoch 11, batch 2968
[2023-07-11 13:31:46] [data] Shuffling data
[2023-07-11 13:31:46] [data] Done reading 20,192 sentences
[2023-07-11 13:31:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:31:46] Training started
[2023-07-11 13:31:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:31:46] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:31:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:31:46] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:31:46] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:31:48] Ep. 11 : Up. 3000 : Sen. 2,048 : Cost 1.78810847 * 1,343,919 @ 1,536 after 4,022,064 : Time 6.20s : 216932.49 words/s : gNorm 2.0332
[2023-07-11 13:32:02] Seen 18,843 samples
[2023-07-11 13:32:02] Starting data epoch 12 in logical epoch 12
[2023-07-11 13:32:02] [data] Shuffling data
[2023-07-11 13:32:02] [data] Done reading 20,192 sentences
[2023-07-11 13:32:02] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:32:19] Seen 18,843 samples
[2023-07-11 13:32:19] Starting data epoch 13 in logical epoch 13
[2023-07-11 13:32:19] [data] Shuffling data
[2023-07-11 13:32:19] [data] Done reading 20,192 sentences
[2023-07-11 13:32:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:32:36] Seen 18,843 samples
[2023-07-11 13:32:36] Starting data epoch 14 in logical epoch 14
[2023-07-11 13:32:36] [data] Shuffling data
[2023-07-11 13:32:36] [data] Done reading 20,192 sentences
[2023-07-11 13:32:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:32:44] Ep. 14 : Up. 4000 : Sen. 9,128 : Cost 0.76778793 * 1,354,393 @ 2,176 after 5,376,457 : Time 56.64s : 23912.38 words/s : gNorm 1.5286
[2023-07-11 13:32:52] Seen 18,843 samples
[2023-07-11 13:32:52] Starting data epoch 15 in logical epoch 15
[2023-07-11 13:32:52] [data] Shuffling data
[2023-07-11 13:32:52] [data] Done reading 20,192 sentences
[2023-07-11 13:32:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:33:09] Seen 18,843 samples
[2023-07-11 13:33:09] Starting data epoch 16 in logical epoch 16
[2023-07-11 13:33:09] [data] Shuffling data
[2023-07-11 13:33:09] [data] Done reading 20,192 sentences
[2023-07-11 13:33:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:33:26] Seen 18,843 samples
[2023-07-11 13:33:26] Starting data epoch 17 in logical epoch 17
[2023-07-11 13:33:26] [data] Shuffling data
[2023-07-11 13:33:26] [data] Done reading 20,192 sentences
[2023-07-11 13:33:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:33:41] Ep. 17 : Up. 5000 : Sen. 16,135 : Cost 0.26952055 * 1,331,522 @ 1,216 after 6,707,979 : Time 56.54s : 23551.10 words/s : gNorm 1.2780
[2023-07-11 13:33:43] Seen 18,843 samples
[2023-07-11 13:33:43] Starting data epoch 18 in logical epoch 18
[2023-07-11 13:33:43] [data] Shuffling data
[2023-07-11 13:33:43] [data] Done reading 20,192 sentences
[2023-07-11 13:33:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:34:00] Seen 18,843 samples
[2023-07-11 13:34:00] Starting data epoch 19 in logical epoch 19
[2023-07-11 13:34:00] [data] Shuffling data
[2023-07-11 13:34:00] [data] Done reading 20,192 sentences
[2023-07-11 13:34:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:34:17] Seen 18,843 samples
[2023-07-11 13:34:17] Starting data epoch 20 in logical epoch 20
[2023-07-11 13:34:17] [data] Shuffling data
[2023-07-11 13:34:17] [data] Done reading 20,192 sentences
[2023-07-11 13:34:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:34:34] Seen 18,843 samples
[2023-07-11 13:34:34] Starting data epoch 21 in logical epoch 21
[2023-07-11 13:34:34] Training finished
[2023-07-11 13:34:37] [valid] Ep. 21 : Up. 5933 : cross-entropy : 154.175 : stalled 1 times (last best: 125.788)
[2023-07-11 13:36:31] [valid] Ep. 21 : Up. 5933 : translation : 0 : new best
[2023-07-11 13:36:31] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:36:33] Saving Adam parameters
[2023-07-11 13:36:34] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:36:43] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:36:43] [marian] Running on node23.datos.cluster.uy as process 10733 with command line:
[2023-07-11 13:36:43] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:36:44] [config] after: 0e
[2023-07-11 13:36:44] [config] after-batches: 0
[2023-07-11 13:36:44] [config] after-epochs: 30
[2023-07-11 13:36:44] [config] all-caps-every: 0
[2023-07-11 13:36:44] [config] allow-unk: false
[2023-07-11 13:36:44] [config] authors: false
[2023-07-11 13:36:44] [config] beam-size: 12
[2023-07-11 13:36:44] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:36:44] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:36:44] [config] bert-masking-fraction: 0.15
[2023-07-11 13:36:44] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:36:44] [config] bert-train-type-embeddings: true
[2023-07-11 13:36:44] [config] bert-type-vocab-size: 2
[2023-07-11 13:36:44] [config] build-info: ""
[2023-07-11 13:36:44] [config] check-gradient-nan: false
[2023-07-11 13:36:44] [config] check-nan: false
[2023-07-11 13:36:44] [config] cite: false
[2023-07-11 13:36:44] [config] clip-norm: 1
[2023-07-11 13:36:44] [config] cost-scaling:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] cost-type: ce-sum
[2023-07-11 13:36:44] [config] cpu-threads: 0
[2023-07-11 13:36:44] [config] data-threads: 8
[2023-07-11 13:36:44] [config] data-weighting: ""
[2023-07-11 13:36:44] [config] data-weighting-type: sentence
[2023-07-11 13:36:44] [config] dec-cell: gru
[2023-07-11 13:36:44] [config] dec-cell-base-depth: 2
[2023-07-11 13:36:44] [config] dec-cell-high-depth: 1
[2023-07-11 13:36:44] [config] dec-depth: 1
[2023-07-11 13:36:44] [config] devices:
[2023-07-11 13:36:44] [config]   - 0
[2023-07-11 13:36:44] [config] dim-emb: 512
[2023-07-11 13:36:44] [config] dim-rnn: 1024
[2023-07-11 13:36:44] [config] dim-vocabs:
[2023-07-11 13:36:44] [config]   - 54042
[2023-07-11 13:36:44] [config]   - 36507
[2023-07-11 13:36:44] [config] disp-first: 0
[2023-07-11 13:36:44] [config] disp-freq: 1000u
[2023-07-11 13:36:44] [config] disp-label-counts: true
[2023-07-11 13:36:44] [config] dropout-rnn: 0
[2023-07-11 13:36:44] [config] dropout-src: 0
[2023-07-11 13:36:44] [config] dropout-trg: 0
[2023-07-11 13:36:44] [config] dump-config: ""
[2023-07-11 13:36:44] [config] dynamic-gradient-scaling:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] early-stopping: 10
[2023-07-11 13:36:44] [config] early-stopping-on: first
[2023-07-11 13:36:44] [config] embedding-fix-src: false
[2023-07-11 13:36:44] [config] embedding-fix-trg: false
[2023-07-11 13:36:44] [config] embedding-normalization: false
[2023-07-11 13:36:44] [config] embedding-vectors:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] enc-cell: gru
[2023-07-11 13:36:44] [config] enc-cell-depth: 1
[2023-07-11 13:36:44] [config] enc-depth: 1
[2023-07-11 13:36:44] [config] enc-type: bidirectional
[2023-07-11 13:36:44] [config] english-title-case-every: 0
[2023-07-11 13:36:44] [config] exponential-smoothing: 0
[2023-07-11 13:36:44] [config] factor-weight: 1
[2023-07-11 13:36:44] [config] factors-combine: sum
[2023-07-11 13:36:44] [config] factors-dim-emb: 0
[2023-07-11 13:36:44] [config] gradient-checkpointing: false
[2023-07-11 13:36:44] [config] gradient-norm-average-window: 100
[2023-07-11 13:36:44] [config] guided-alignment: none
[2023-07-11 13:36:44] [config] guided-alignment-cost: mse
[2023-07-11 13:36:44] [config] guided-alignment-weight: 0.1
[2023-07-11 13:36:44] [config] ignore-model-config: false
[2023-07-11 13:36:44] [config] input-types:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] interpolate-env-vars: false
[2023-07-11 13:36:44] [config] keep-best: false
[2023-07-11 13:36:44] [config] label-smoothing: 0
[2023-07-11 13:36:44] [config] layer-normalization: false
[2023-07-11 13:36:44] [config] learn-rate: 0.0001
[2023-07-11 13:36:44] [config] lemma-dependency: ""
[2023-07-11 13:36:44] [config] lemma-dim-emb: 0
[2023-07-11 13:36:44] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:36:44] [config] log-level: info
[2023-07-11 13:36:44] [config] log-time-zone: ""
[2023-07-11 13:36:44] [config] logical-epoch:
[2023-07-11 13:36:44] [config]   - 1e
[2023-07-11 13:36:44] [config]   - 0
[2023-07-11 13:36:44] [config] lr-decay: 0
[2023-07-11 13:36:44] [config] lr-decay-freq: 50000
[2023-07-11 13:36:44] [config] lr-decay-inv-sqrt:
[2023-07-11 13:36:44] [config]   - 0
[2023-07-11 13:36:44] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:36:44] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:36:44] [config] lr-decay-start:
[2023-07-11 13:36:44] [config]   - 10
[2023-07-11 13:36:44] [config]   - 1
[2023-07-11 13:36:44] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:36:44] [config] lr-report: false
[2023-07-11 13:36:44] [config] lr-warmup: 0
[2023-07-11 13:36:44] [config] lr-warmup-at-reload: false
[2023-07-11 13:36:44] [config] lr-warmup-cycle: false
[2023-07-11 13:36:44] [config] lr-warmup-start-rate: 0
[2023-07-11 13:36:44] [config] max-length: 50
[2023-07-11 13:36:44] [config] max-length-crop: false
[2023-07-11 13:36:44] [config] max-length-factor: 3
[2023-07-11 13:36:44] [config] maxi-batch: 100
[2023-07-11 13:36:44] [config] maxi-batch-sort: trg
[2023-07-11 13:36:44] [config] mini-batch: 64
[2023-07-11 13:36:44] [config] mini-batch-fit: false
[2023-07-11 13:36:44] [config] mini-batch-fit-step: 10
[2023-07-11 13:36:44] [config] mini-batch-round-up: true
[2023-07-11 13:36:44] [config] mini-batch-track-lr: false
[2023-07-11 13:36:44] [config] mini-batch-warmup: 0
[2023-07-11 13:36:44] [config] mini-batch-words: 0
[2023-07-11 13:36:44] [config] mini-batch-words-ref: 0
[2023-07-11 13:36:44] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:36:44] [config] multi-loss-type: sum
[2023-07-11 13:36:44] [config] n-best: false
[2023-07-11 13:36:44] [config] no-nccl: false
[2023-07-11 13:36:44] [config] no-reload: false
[2023-07-11 13:36:44] [config] no-restore-corpus: false
[2023-07-11 13:36:44] [config] normalize: 0
[2023-07-11 13:36:44] [config] normalize-gradient: false
[2023-07-11 13:36:44] [config] num-devices: 0
[2023-07-11 13:36:44] [config] optimizer: adam
[2023-07-11 13:36:44] [config] optimizer-delay: 1
[2023-07-11 13:36:44] [config] optimizer-params:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] output-omit-bias: false
[2023-07-11 13:36:44] [config] overwrite: true
[2023-07-11 13:36:44] [config] precision:
[2023-07-11 13:36:44] [config]   - float32
[2023-07-11 13:36:44] [config]   - float32
[2023-07-11 13:36:44] [config] pretrained-model: ""
[2023-07-11 13:36:44] [config] quantize-biases: false
[2023-07-11 13:36:44] [config] quantize-bits: 0
[2023-07-11 13:36:44] [config] quantize-log-based: false
[2023-07-11 13:36:44] [config] quantize-optimization-steps: 0
[2023-07-11 13:36:44] [config] quiet: false
[2023-07-11 13:36:44] [config] quiet-translation: true
[2023-07-11 13:36:44] [config] relative-paths: false
[2023-07-11 13:36:44] [config] right-left: false
[2023-07-11 13:36:44] [config] save-freq: 10000u
[2023-07-11 13:36:44] [config] seed: 1234
[2023-07-11 13:36:44] [config] sentencepiece-alphas:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:36:44] [config] sentencepiece-options: ""
[2023-07-11 13:36:44] [config] sharding: global
[2023-07-11 13:36:44] [config] shuffle: data
[2023-07-11 13:36:44] [config] shuffle-in-ram: false
[2023-07-11 13:36:44] [config] sigterm: save-and-exit
[2023-07-11 13:36:44] [config] skip: false
[2023-07-11 13:36:44] [config] sqlite: ""
[2023-07-11 13:36:44] [config] sqlite-drop: false
[2023-07-11 13:36:44] [config] sync-freq: 200u
[2023-07-11 13:36:44] [config] sync-sgd: false
[2023-07-11 13:36:44] [config] tempdir: /tmp
[2023-07-11 13:36:44] [config] tied-embeddings: false
[2023-07-11 13:36:44] [config] tied-embeddings-all: false
[2023-07-11 13:36:44] [config] tied-embeddings-src: false
[2023-07-11 13:36:44] [config] train-embedder-rank:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] train-sets:
[2023-07-11 13:36:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:36:44] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:36:44] [config] transformer-aan-activation: swish
[2023-07-11 13:36:44] [config] transformer-aan-depth: 2
[2023-07-11 13:36:44] [config] transformer-aan-nogate: false
[2023-07-11 13:36:44] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:36:44] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:36:44] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:36:44] [config] transformer-depth-scaling: false
[2023-07-11 13:36:44] [config] transformer-dim-aan: 2048
[2023-07-11 13:36:44] [config] transformer-dim-ffn: 2048
[2023-07-11 13:36:44] [config] transformer-dropout: 0
[2023-07-11 13:36:44] [config] transformer-dropout-attention: 0
[2023-07-11 13:36:44] [config] transformer-dropout-ffn: 0
[2023-07-11 13:36:44] [config] transformer-ffn-activation: swish
[2023-07-11 13:36:44] [config] transformer-ffn-depth: 2
[2023-07-11 13:36:44] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:36:44] [config] transformer-heads: 8
[2023-07-11 13:36:44] [config] transformer-no-projection: false
[2023-07-11 13:36:44] [config] transformer-pool: false
[2023-07-11 13:36:44] [config] transformer-postprocess: dan
[2023-07-11 13:36:44] [config] transformer-postprocess-emb: d
[2023-07-11 13:36:44] [config] transformer-postprocess-top: ""
[2023-07-11 13:36:44] [config] transformer-preprocess: ""
[2023-07-11 13:36:44] [config] transformer-tied-layers:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] transformer-train-position-embeddings: false
[2023-07-11 13:36:44] [config] tsv: false
[2023-07-11 13:36:44] [config] tsv-fields: 0
[2023-07-11 13:36:44] [config] type: transformer
[2023-07-11 13:36:44] [config] ulr: false
[2023-07-11 13:36:44] [config] ulr-dim-emb: 0
[2023-07-11 13:36:44] [config] ulr-dropout: 0
[2023-07-11 13:36:44] [config] ulr-keys-vectors: ""
[2023-07-11 13:36:44] [config] ulr-query-vectors: ""
[2023-07-11 13:36:44] [config] ulr-softmax-temperature: 1
[2023-07-11 13:36:44] [config] ulr-trainable-transformation: false
[2023-07-11 13:36:44] [config] unlikelihood-loss: false
[2023-07-11 13:36:44] [config] valid-freq: 50000000
[2023-07-11 13:36:44] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:36:44] [config] valid-max-length: 1000
[2023-07-11 13:36:44] [config] valid-metrics:
[2023-07-11 13:36:44] [config]   - cross-entropy
[2023-07-11 13:36:44] [config]   - translation
[2023-07-11 13:36:44] [config] valid-mini-batch: 32
[2023-07-11 13:36:44] [config] valid-reset-stalled: false
[2023-07-11 13:36:44] [config] valid-script-args:
[2023-07-11 13:36:44] [config]   []
[2023-07-11 13:36:44] [config] valid-script-path: ""
[2023-07-11 13:36:44] [config] valid-sets:
[2023-07-11 13:36:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:36:44] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:36:44] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:36:44] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:36:44] [config] vocabs:
[2023-07-11 13:36:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:36:44] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:36:44] [config] word-penalty: 0
[2023-07-11 13:36:44] [config] word-scores: false
[2023-07-11 13:36:44] [config] workspace: 2048
[2023-07-11 13:36:44] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:36:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:36:44] [training] Using single-device training
[2023-07-11 13:36:44] Synced seed 1234
[2023-07-11 13:36:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:36:44] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:36:44] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:36:44] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:36:44] [valid] No post-processing script given for validating translator
[2023-07-11 13:36:44] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:36:45] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:36:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:36:46] [comm] Using global sharding
[2023-07-11 13:36:46] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:36:46] [training] Using 1 GPUs
[2023-07-11 13:36:46] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:36:47] Loading Adam parameters
[2023-07-11 13:36:48] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:36:48] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:36:48] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:36:48] [data] Restoring the corpus state to epoch 21, batch 5933
[2023-07-11 13:36:48] [data] Shuffling data
[2023-07-11 13:36:48] [data] Done reading 20,192 sentences
[2023-07-11 13:36:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:36:48] Training started
[2023-07-11 13:36:48] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:36:48] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:36:48] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:36:48] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:36:48] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:36:52] Ep. 21 : Up. 6000 : Sen. 4,288 : Cost 0.10450620 * 1,344,567 @ 1,231 after 8,052,546 : Time 8.23s : 163381.17 words/s : gNorm 0.9683
[2023-07-11 13:37:05] Seen 18,843 samples
[2023-07-11 13:37:05] Starting data epoch 22 in logical epoch 22
[2023-07-11 13:37:05] [data] Shuffling data
[2023-07-11 13:37:05] [data] Done reading 20,192 sentences
[2023-07-11 13:37:05] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:37:22] Seen 18,843 samples
[2023-07-11 13:37:22] Starting data epoch 23 in logical epoch 23
[2023-07-11 13:37:22] [data] Shuffling data
[2023-07-11 13:37:22] [data] Done reading 20,192 sentences
[2023-07-11 13:37:22] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:37:38] Seen 18,843 samples
[2023-07-11 13:37:38] Starting data epoch 24 in logical epoch 24
[2023-07-11 13:37:38] [data] Shuffling data
[2023-07-11 13:37:38] [data] Done reading 20,192 sentences
[2023-07-11 13:37:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:37:48] Ep. 24 : Up. 7000 : Sen. 11,277 : Cost 0.05596100 * 1,339,673 @ 704 after 9,392,219 : Time 56.26s : 23811.62 words/s : gNorm 0.9317
[2023-07-11 13:37:55] Seen 18,843 samples
[2023-07-11 13:37:55] Starting data epoch 25 in logical epoch 25
[2023-07-11 13:37:55] [data] Shuffling data
[2023-07-11 13:37:55] [data] Done reading 20,192 sentences
[2023-07-11 13:37:55] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:38:12] Seen 18,843 samples
[2023-07-11 13:38:12] Starting data epoch 26 in logical epoch 26
[2023-07-11 13:38:12] [data] Shuffling data
[2023-07-11 13:38:12] [data] Done reading 20,192 sentences
[2023-07-11 13:38:12] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:38:29] Seen 18,843 samples
[2023-07-11 13:38:29] Starting data epoch 27 in logical epoch 27
[2023-07-11 13:38:29] [data] Shuffling data
[2023-07-11 13:38:29] [data] Done reading 20,192 sentences
[2023-07-11 13:38:29] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:38:45] Ep. 27 : Up. 8000 : Sen. 18,247 : Cost 0.03860174 * 1,339,074 @ 1,034 after 10,731,293 : Time 57.05s : 23472.32 words/s : gNorm 0.8538
[2023-07-11 13:38:46] Seen 18,843 samples
[2023-07-11 13:38:46] Starting data epoch 28 in logical epoch 28
[2023-07-11 13:38:46] [data] Shuffling data
[2023-07-11 13:38:46] [data] Done reading 20,192 sentences
[2023-07-11 13:38:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:39:03] Seen 18,843 samples
[2023-07-11 13:39:03] Starting data epoch 29 in logical epoch 29
[2023-07-11 13:39:03] [data] Shuffling data
[2023-07-11 13:39:03] [data] Done reading 20,192 sentences
[2023-07-11 13:39:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:39:20] Seen 18,843 samples
[2023-07-11 13:39:20] Starting data epoch 30 in logical epoch 30
[2023-07-11 13:39:20] [data] Shuffling data
[2023-07-11 13:39:20] [data] Done reading 20,192 sentences
[2023-07-11 13:39:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:39:37] Seen 18,843 samples
[2023-07-11 13:39:37] Starting data epoch 31 in logical epoch 31
[2023-07-11 13:39:37] Training finished
[2023-07-11 13:39:39] [valid] Ep. 31 : Up. 8898 : cross-entropy : 168.508 : stalled 2 times (last best: 125.788)
[2023-07-11 13:41:21] [valid] Ep. 31 : Up. 8898 : translation : 0 : new best
[2023-07-11 13:41:21] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:41:23] Saving Adam parameters
[2023-07-11 13:41:24] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:41:32] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:41:32] [marian] Running on node23.datos.cluster.uy as process 11039 with command line:
[2023-07-11 13:41:32] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:41:32] [config] after: 0e
[2023-07-11 13:41:32] [config] after-batches: 0
[2023-07-11 13:41:32] [config] after-epochs: 40
[2023-07-11 13:41:32] [config] all-caps-every: 0
[2023-07-11 13:41:32] [config] allow-unk: false
[2023-07-11 13:41:32] [config] authors: false
[2023-07-11 13:41:32] [config] beam-size: 12
[2023-07-11 13:41:32] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:41:32] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:41:32] [config] bert-masking-fraction: 0.15
[2023-07-11 13:41:32] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:41:32] [config] bert-train-type-embeddings: true
[2023-07-11 13:41:32] [config] bert-type-vocab-size: 2
[2023-07-11 13:41:32] [config] build-info: ""
[2023-07-11 13:41:32] [config] check-gradient-nan: false
[2023-07-11 13:41:32] [config] check-nan: false
[2023-07-11 13:41:32] [config] cite: false
[2023-07-11 13:41:32] [config] clip-norm: 1
[2023-07-11 13:41:32] [config] cost-scaling:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] cost-type: ce-sum
[2023-07-11 13:41:32] [config] cpu-threads: 0
[2023-07-11 13:41:32] [config] data-threads: 8
[2023-07-11 13:41:32] [config] data-weighting: ""
[2023-07-11 13:41:32] [config] data-weighting-type: sentence
[2023-07-11 13:41:32] [config] dec-cell: gru
[2023-07-11 13:41:32] [config] dec-cell-base-depth: 2
[2023-07-11 13:41:32] [config] dec-cell-high-depth: 1
[2023-07-11 13:41:32] [config] dec-depth: 1
[2023-07-11 13:41:32] [config] devices:
[2023-07-11 13:41:32] [config]   - 0
[2023-07-11 13:41:32] [config] dim-emb: 512
[2023-07-11 13:41:32] [config] dim-rnn: 1024
[2023-07-11 13:41:32] [config] dim-vocabs:
[2023-07-11 13:41:32] [config]   - 54042
[2023-07-11 13:41:32] [config]   - 36507
[2023-07-11 13:41:32] [config] disp-first: 0
[2023-07-11 13:41:32] [config] disp-freq: 1000u
[2023-07-11 13:41:32] [config] disp-label-counts: true
[2023-07-11 13:41:32] [config] dropout-rnn: 0
[2023-07-11 13:41:32] [config] dropout-src: 0
[2023-07-11 13:41:32] [config] dropout-trg: 0
[2023-07-11 13:41:32] [config] dump-config: ""
[2023-07-11 13:41:32] [config] dynamic-gradient-scaling:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] early-stopping: 10
[2023-07-11 13:41:32] [config] early-stopping-on: first
[2023-07-11 13:41:32] [config] embedding-fix-src: false
[2023-07-11 13:41:32] [config] embedding-fix-trg: false
[2023-07-11 13:41:32] [config] embedding-normalization: false
[2023-07-11 13:41:32] [config] embedding-vectors:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] enc-cell: gru
[2023-07-11 13:41:32] [config] enc-cell-depth: 1
[2023-07-11 13:41:32] [config] enc-depth: 1
[2023-07-11 13:41:32] [config] enc-type: bidirectional
[2023-07-11 13:41:32] [config] english-title-case-every: 0
[2023-07-11 13:41:32] [config] exponential-smoothing: 0
[2023-07-11 13:41:32] [config] factor-weight: 1
[2023-07-11 13:41:32] [config] factors-combine: sum
[2023-07-11 13:41:32] [config] factors-dim-emb: 0
[2023-07-11 13:41:32] [config] gradient-checkpointing: false
[2023-07-11 13:41:32] [config] gradient-norm-average-window: 100
[2023-07-11 13:41:32] [config] guided-alignment: none
[2023-07-11 13:41:32] [config] guided-alignment-cost: mse
[2023-07-11 13:41:32] [config] guided-alignment-weight: 0.1
[2023-07-11 13:41:32] [config] ignore-model-config: false
[2023-07-11 13:41:32] [config] input-types:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] interpolate-env-vars: false
[2023-07-11 13:41:32] [config] keep-best: false
[2023-07-11 13:41:32] [config] label-smoothing: 0
[2023-07-11 13:41:32] [config] layer-normalization: false
[2023-07-11 13:41:32] [config] learn-rate: 0.0001
[2023-07-11 13:41:32] [config] lemma-dependency: ""
[2023-07-11 13:41:32] [config] lemma-dim-emb: 0
[2023-07-11 13:41:32] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:41:32] [config] log-level: info
[2023-07-11 13:41:32] [config] log-time-zone: ""
[2023-07-11 13:41:32] [config] logical-epoch:
[2023-07-11 13:41:32] [config]   - 1e
[2023-07-11 13:41:32] [config]   - 0
[2023-07-11 13:41:32] [config] lr-decay: 0
[2023-07-11 13:41:32] [config] lr-decay-freq: 50000
[2023-07-11 13:41:32] [config] lr-decay-inv-sqrt:
[2023-07-11 13:41:32] [config]   - 0
[2023-07-11 13:41:32] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:41:32] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:41:32] [config] lr-decay-start:
[2023-07-11 13:41:32] [config]   - 10
[2023-07-11 13:41:32] [config]   - 1
[2023-07-11 13:41:32] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:41:32] [config] lr-report: false
[2023-07-11 13:41:32] [config] lr-warmup: 0
[2023-07-11 13:41:32] [config] lr-warmup-at-reload: false
[2023-07-11 13:41:32] [config] lr-warmup-cycle: false
[2023-07-11 13:41:32] [config] lr-warmup-start-rate: 0
[2023-07-11 13:41:32] [config] max-length: 50
[2023-07-11 13:41:32] [config] max-length-crop: false
[2023-07-11 13:41:32] [config] max-length-factor: 3
[2023-07-11 13:41:32] [config] maxi-batch: 100
[2023-07-11 13:41:32] [config] maxi-batch-sort: trg
[2023-07-11 13:41:32] [config] mini-batch: 64
[2023-07-11 13:41:32] [config] mini-batch-fit: false
[2023-07-11 13:41:32] [config] mini-batch-fit-step: 10
[2023-07-11 13:41:32] [config] mini-batch-round-up: true
[2023-07-11 13:41:32] [config] mini-batch-track-lr: false
[2023-07-11 13:41:32] [config] mini-batch-warmup: 0
[2023-07-11 13:41:32] [config] mini-batch-words: 0
[2023-07-11 13:41:32] [config] mini-batch-words-ref: 0
[2023-07-11 13:41:32] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:41:32] [config] multi-loss-type: sum
[2023-07-11 13:41:32] [config] n-best: false
[2023-07-11 13:41:32] [config] no-nccl: false
[2023-07-11 13:41:32] [config] no-reload: false
[2023-07-11 13:41:32] [config] no-restore-corpus: false
[2023-07-11 13:41:32] [config] normalize: 0
[2023-07-11 13:41:32] [config] normalize-gradient: false
[2023-07-11 13:41:32] [config] num-devices: 0
[2023-07-11 13:41:32] [config] optimizer: adam
[2023-07-11 13:41:32] [config] optimizer-delay: 1
[2023-07-11 13:41:32] [config] optimizer-params:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] output-omit-bias: false
[2023-07-11 13:41:32] [config] overwrite: true
[2023-07-11 13:41:32] [config] precision:
[2023-07-11 13:41:32] [config]   - float32
[2023-07-11 13:41:32] [config]   - float32
[2023-07-11 13:41:32] [config] pretrained-model: ""
[2023-07-11 13:41:32] [config] quantize-biases: false
[2023-07-11 13:41:32] [config] quantize-bits: 0
[2023-07-11 13:41:32] [config] quantize-log-based: false
[2023-07-11 13:41:32] [config] quantize-optimization-steps: 0
[2023-07-11 13:41:32] [config] quiet: false
[2023-07-11 13:41:32] [config] quiet-translation: true
[2023-07-11 13:41:32] [config] relative-paths: false
[2023-07-11 13:41:32] [config] right-left: false
[2023-07-11 13:41:32] [config] save-freq: 10000u
[2023-07-11 13:41:32] [config] seed: 1234
[2023-07-11 13:41:32] [config] sentencepiece-alphas:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:41:32] [config] sentencepiece-options: ""
[2023-07-11 13:41:32] [config] sharding: global
[2023-07-11 13:41:32] [config] shuffle: data
[2023-07-11 13:41:32] [config] shuffle-in-ram: false
[2023-07-11 13:41:32] [config] sigterm: save-and-exit
[2023-07-11 13:41:32] [config] skip: false
[2023-07-11 13:41:32] [config] sqlite: ""
[2023-07-11 13:41:32] [config] sqlite-drop: false
[2023-07-11 13:41:32] [config] sync-freq: 200u
[2023-07-11 13:41:32] [config] sync-sgd: false
[2023-07-11 13:41:32] [config] tempdir: /tmp
[2023-07-11 13:41:32] [config] tied-embeddings: false
[2023-07-11 13:41:32] [config] tied-embeddings-all: false
[2023-07-11 13:41:32] [config] tied-embeddings-src: false
[2023-07-11 13:41:32] [config] train-embedder-rank:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] train-sets:
[2023-07-11 13:41:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:41:32] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:41:32] [config] transformer-aan-activation: swish
[2023-07-11 13:41:32] [config] transformer-aan-depth: 2
[2023-07-11 13:41:32] [config] transformer-aan-nogate: false
[2023-07-11 13:41:32] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:41:32] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:41:32] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:41:32] [config] transformer-depth-scaling: false
[2023-07-11 13:41:32] [config] transformer-dim-aan: 2048
[2023-07-11 13:41:32] [config] transformer-dim-ffn: 2048
[2023-07-11 13:41:32] [config] transformer-dropout: 0
[2023-07-11 13:41:32] [config] transformer-dropout-attention: 0
[2023-07-11 13:41:32] [config] transformer-dropout-ffn: 0
[2023-07-11 13:41:32] [config] transformer-ffn-activation: swish
[2023-07-11 13:41:32] [config] transformer-ffn-depth: 2
[2023-07-11 13:41:32] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:41:32] [config] transformer-heads: 8
[2023-07-11 13:41:32] [config] transformer-no-projection: false
[2023-07-11 13:41:32] [config] transformer-pool: false
[2023-07-11 13:41:32] [config] transformer-postprocess: dan
[2023-07-11 13:41:32] [config] transformer-postprocess-emb: d
[2023-07-11 13:41:32] [config] transformer-postprocess-top: ""
[2023-07-11 13:41:32] [config] transformer-preprocess: ""
[2023-07-11 13:41:32] [config] transformer-tied-layers:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] transformer-train-position-embeddings: false
[2023-07-11 13:41:32] [config] tsv: false
[2023-07-11 13:41:32] [config] tsv-fields: 0
[2023-07-11 13:41:32] [config] type: transformer
[2023-07-11 13:41:32] [config] ulr: false
[2023-07-11 13:41:32] [config] ulr-dim-emb: 0
[2023-07-11 13:41:32] [config] ulr-dropout: 0
[2023-07-11 13:41:32] [config] ulr-keys-vectors: ""
[2023-07-11 13:41:32] [config] ulr-query-vectors: ""
[2023-07-11 13:41:32] [config] ulr-softmax-temperature: 1
[2023-07-11 13:41:32] [config] ulr-trainable-transformation: false
[2023-07-11 13:41:32] [config] unlikelihood-loss: false
[2023-07-11 13:41:32] [config] valid-freq: 50000000
[2023-07-11 13:41:32] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:41:32] [config] valid-max-length: 1000
[2023-07-11 13:41:32] [config] valid-metrics:
[2023-07-11 13:41:32] [config]   - cross-entropy
[2023-07-11 13:41:32] [config]   - translation
[2023-07-11 13:41:32] [config] valid-mini-batch: 32
[2023-07-11 13:41:32] [config] valid-reset-stalled: false
[2023-07-11 13:41:32] [config] valid-script-args:
[2023-07-11 13:41:32] [config]   []
[2023-07-11 13:41:32] [config] valid-script-path: ""
[2023-07-11 13:41:32] [config] valid-sets:
[2023-07-11 13:41:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:41:32] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:41:32] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:41:32] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:41:32] [config] vocabs:
[2023-07-11 13:41:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:41:32] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:41:32] [config] word-penalty: 0
[2023-07-11 13:41:32] [config] word-scores: false
[2023-07-11 13:41:32] [config] workspace: 2048
[2023-07-11 13:41:32] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:41:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:41:32] [training] Using single-device training
[2023-07-11 13:41:33] Synced seed 1234
[2023-07-11 13:41:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:41:33] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:41:33] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:41:33] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:41:33] [valid] No post-processing script given for validating translator
[2023-07-11 13:41:33] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:41:34] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:41:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:41:34] [comm] Using global sharding
[2023-07-11 13:41:35] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:41:35] [training] Using 1 GPUs
[2023-07-11 13:41:35] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:41:36] Loading Adam parameters
[2023-07-11 13:41:37] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:41:37] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:41:37] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:41:37] [data] Restoring the corpus state to epoch 31, batch 8898
[2023-07-11 13:41:37] [data] Shuffling data
[2023-07-11 13:41:37] [data] Done reading 20,192 sentences
[2023-07-11 13:41:37] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:41:37] Training started
[2023-07-11 13:41:37] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:41:37] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:41:37] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:41:37] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:41:37] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:41:43] Ep. 31 : Up. 9000 : Sen. 6,474 : Cost 0.02955522 * 1,341,072 @ 320 after 12,072,365 : Time 10.06s : 133288.55 words/s : gNorm 0.8296
[2023-07-11 13:41:54] Seen 18,843 samples
[2023-07-11 13:41:54] Starting data epoch 32 in logical epoch 32
[2023-07-11 13:41:54] [data] Shuffling data
[2023-07-11 13:41:54] [data] Done reading 20,192 sentences
[2023-07-11 13:41:54] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:42:10] Seen 18,843 samples
[2023-07-11 13:42:10] Starting data epoch 33 in logical epoch 33
[2023-07-11 13:42:10] [data] Shuffling data
[2023-07-11 13:42:11] [data] Done reading 20,192 sentences
[2023-07-11 13:42:11] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:42:27] Seen 18,843 samples
[2023-07-11 13:42:27] Starting data epoch 34 in logical epoch 34
[2023-07-11 13:42:27] [data] Shuffling data
[2023-07-11 13:42:27] [data] Done reading 20,192 sentences
[2023-07-11 13:42:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:42:39] Ep. 34 : Up. 10000 : Sen. 13,515 : Cost 0.02339145 * 1,347,521 @ 882 after 13,419,886 : Time 56.46s : 23865.57 words/s : gNorm 0.6528
[2023-07-11 13:42:39] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:42:42] Saving Adam parameters
[2023-07-11 13:42:43] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:42:53] Seen 18,843 samples
[2023-07-11 13:42:53] Starting data epoch 35 in logical epoch 35
[2023-07-11 13:42:53] [data] Shuffling data
[2023-07-11 13:42:53] [data] Done reading 20,192 sentences
[2023-07-11 13:42:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:43:09] Seen 18,843 samples
[2023-07-11 13:43:09] Starting data epoch 36 in logical epoch 36
[2023-07-11 13:43:09] [data] Shuffling data
[2023-07-11 13:43:09] [data] Done reading 20,192 sentences
[2023-07-11 13:43:09] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:43:26] Seen 18,843 samples
[2023-07-11 13:43:26] Starting data epoch 37 in logical epoch 37
[2023-07-11 13:43:26] [data] Shuffling data
[2023-07-11 13:43:26] [data] Done reading 20,192 sentences
[2023-07-11 13:43:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:43:43] Seen 18,843 samples
[2023-07-11 13:43:43] Starting data epoch 38 in logical epoch 38
[2023-07-11 13:43:43] [data] Shuffling data
[2023-07-11 13:43:43] [data] Done reading 20,192 sentences
[2023-07-11 13:43:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:43:45] Ep. 38 : Up. 11000 : Sen. 1,728 : Cost 0.01993802 * 1,344,952 @ 1,403 after 14,764,838 : Time 65.28s : 20604.24 words/s : gNorm 0.6173
[2023-07-11 13:44:00] Seen 18,843 samples
[2023-07-11 13:44:00] Starting data epoch 39 in logical epoch 39
[2023-07-11 13:44:00] [data] Shuffling data
[2023-07-11 13:44:00] [data] Done reading 20,192 sentences
[2023-07-11 13:44:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:44:17] Seen 18,843 samples
[2023-07-11 13:44:17] Starting data epoch 40 in logical epoch 40
[2023-07-11 13:44:17] [data] Shuffling data
[2023-07-11 13:44:17] [data] Done reading 20,192 sentences
[2023-07-11 13:44:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:44:34] Seen 18,843 samples
[2023-07-11 13:44:34] Starting data epoch 41 in logical epoch 41
[2023-07-11 13:44:34] Training finished
[2023-07-11 13:44:36] [valid] Ep. 41 : Up. 11864 : cross-entropy : 175.763 : stalled 3 times (last best: 125.788)
[2023-07-11 13:46:19] [valid] Ep. 41 : Up. 11864 : translation : 0 : new best
[2023-07-11 13:46:19] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:46:21] Saving Adam parameters
[2023-07-11 13:46:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:46:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:46:31] [marian] Running on node23.datos.cluster.uy as process 11354 with command line:
[2023-07-11 13:46:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:46:31] [config] after: 0e
[2023-07-11 13:46:31] [config] after-batches: 0
[2023-07-11 13:46:31] [config] after-epochs: 50
[2023-07-11 13:46:31] [config] all-caps-every: 0
[2023-07-11 13:46:31] [config] allow-unk: false
[2023-07-11 13:46:31] [config] authors: false
[2023-07-11 13:46:31] [config] beam-size: 12
[2023-07-11 13:46:31] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:46:31] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:46:31] [config] bert-masking-fraction: 0.15
[2023-07-11 13:46:31] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:46:31] [config] bert-train-type-embeddings: true
[2023-07-11 13:46:31] [config] bert-type-vocab-size: 2
[2023-07-11 13:46:31] [config] build-info: ""
[2023-07-11 13:46:31] [config] check-gradient-nan: false
[2023-07-11 13:46:31] [config] check-nan: false
[2023-07-11 13:46:31] [config] cite: false
[2023-07-11 13:46:31] [config] clip-norm: 1
[2023-07-11 13:46:31] [config] cost-scaling:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] cost-type: ce-sum
[2023-07-11 13:46:31] [config] cpu-threads: 0
[2023-07-11 13:46:31] [config] data-threads: 8
[2023-07-11 13:46:31] [config] data-weighting: ""
[2023-07-11 13:46:31] [config] data-weighting-type: sentence
[2023-07-11 13:46:31] [config] dec-cell: gru
[2023-07-11 13:46:31] [config] dec-cell-base-depth: 2
[2023-07-11 13:46:31] [config] dec-cell-high-depth: 1
[2023-07-11 13:46:31] [config] dec-depth: 1
[2023-07-11 13:46:31] [config] devices:
[2023-07-11 13:46:31] [config]   - 0
[2023-07-11 13:46:31] [config] dim-emb: 512
[2023-07-11 13:46:31] [config] dim-rnn: 1024
[2023-07-11 13:46:31] [config] dim-vocabs:
[2023-07-11 13:46:31] [config]   - 54042
[2023-07-11 13:46:31] [config]   - 36507
[2023-07-11 13:46:31] [config] disp-first: 0
[2023-07-11 13:46:31] [config] disp-freq: 1000u
[2023-07-11 13:46:31] [config] disp-label-counts: true
[2023-07-11 13:46:31] [config] dropout-rnn: 0
[2023-07-11 13:46:31] [config] dropout-src: 0
[2023-07-11 13:46:31] [config] dropout-trg: 0
[2023-07-11 13:46:31] [config] dump-config: ""
[2023-07-11 13:46:31] [config] dynamic-gradient-scaling:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] early-stopping: 10
[2023-07-11 13:46:31] [config] early-stopping-on: first
[2023-07-11 13:46:31] [config] embedding-fix-src: false
[2023-07-11 13:46:31] [config] embedding-fix-trg: false
[2023-07-11 13:46:31] [config] embedding-normalization: false
[2023-07-11 13:46:31] [config] embedding-vectors:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] enc-cell: gru
[2023-07-11 13:46:31] [config] enc-cell-depth: 1
[2023-07-11 13:46:31] [config] enc-depth: 1
[2023-07-11 13:46:31] [config] enc-type: bidirectional
[2023-07-11 13:46:31] [config] english-title-case-every: 0
[2023-07-11 13:46:31] [config] exponential-smoothing: 0
[2023-07-11 13:46:31] [config] factor-weight: 1
[2023-07-11 13:46:31] [config] factors-combine: sum
[2023-07-11 13:46:31] [config] factors-dim-emb: 0
[2023-07-11 13:46:31] [config] gradient-checkpointing: false
[2023-07-11 13:46:31] [config] gradient-norm-average-window: 100
[2023-07-11 13:46:31] [config] guided-alignment: none
[2023-07-11 13:46:31] [config] guided-alignment-cost: mse
[2023-07-11 13:46:31] [config] guided-alignment-weight: 0.1
[2023-07-11 13:46:31] [config] ignore-model-config: false
[2023-07-11 13:46:31] [config] input-types:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] interpolate-env-vars: false
[2023-07-11 13:46:31] [config] keep-best: false
[2023-07-11 13:46:31] [config] label-smoothing: 0
[2023-07-11 13:46:31] [config] layer-normalization: false
[2023-07-11 13:46:31] [config] learn-rate: 0.0001
[2023-07-11 13:46:31] [config] lemma-dependency: ""
[2023-07-11 13:46:31] [config] lemma-dim-emb: 0
[2023-07-11 13:46:31] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:46:31] [config] log-level: info
[2023-07-11 13:46:31] [config] log-time-zone: ""
[2023-07-11 13:46:31] [config] logical-epoch:
[2023-07-11 13:46:31] [config]   - 1e
[2023-07-11 13:46:31] [config]   - 0
[2023-07-11 13:46:31] [config] lr-decay: 0
[2023-07-11 13:46:31] [config] lr-decay-freq: 50000
[2023-07-11 13:46:31] [config] lr-decay-inv-sqrt:
[2023-07-11 13:46:31] [config]   - 0
[2023-07-11 13:46:31] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:46:31] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:46:31] [config] lr-decay-start:
[2023-07-11 13:46:31] [config]   - 10
[2023-07-11 13:46:31] [config]   - 1
[2023-07-11 13:46:31] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:46:31] [config] lr-report: false
[2023-07-11 13:46:31] [config] lr-warmup: 0
[2023-07-11 13:46:31] [config] lr-warmup-at-reload: false
[2023-07-11 13:46:31] [config] lr-warmup-cycle: false
[2023-07-11 13:46:31] [config] lr-warmup-start-rate: 0
[2023-07-11 13:46:31] [config] max-length: 50
[2023-07-11 13:46:31] [config] max-length-crop: false
[2023-07-11 13:46:31] [config] max-length-factor: 3
[2023-07-11 13:46:31] [config] maxi-batch: 100
[2023-07-11 13:46:31] [config] maxi-batch-sort: trg
[2023-07-11 13:46:31] [config] mini-batch: 64
[2023-07-11 13:46:31] [config] mini-batch-fit: false
[2023-07-11 13:46:31] [config] mini-batch-fit-step: 10
[2023-07-11 13:46:31] [config] mini-batch-round-up: true
[2023-07-11 13:46:31] [config] mini-batch-track-lr: false
[2023-07-11 13:46:31] [config] mini-batch-warmup: 0
[2023-07-11 13:46:31] [config] mini-batch-words: 0
[2023-07-11 13:46:31] [config] mini-batch-words-ref: 0
[2023-07-11 13:46:31] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:46:31] [config] multi-loss-type: sum
[2023-07-11 13:46:31] [config] n-best: false
[2023-07-11 13:46:31] [config] no-nccl: false
[2023-07-11 13:46:31] [config] no-reload: false
[2023-07-11 13:46:31] [config] no-restore-corpus: false
[2023-07-11 13:46:31] [config] normalize: 0
[2023-07-11 13:46:31] [config] normalize-gradient: false
[2023-07-11 13:46:31] [config] num-devices: 0
[2023-07-11 13:46:31] [config] optimizer: adam
[2023-07-11 13:46:31] [config] optimizer-delay: 1
[2023-07-11 13:46:31] [config] optimizer-params:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] output-omit-bias: false
[2023-07-11 13:46:31] [config] overwrite: true
[2023-07-11 13:46:31] [config] precision:
[2023-07-11 13:46:31] [config]   - float32
[2023-07-11 13:46:31] [config]   - float32
[2023-07-11 13:46:31] [config] pretrained-model: ""
[2023-07-11 13:46:31] [config] quantize-biases: false
[2023-07-11 13:46:31] [config] quantize-bits: 0
[2023-07-11 13:46:31] [config] quantize-log-based: false
[2023-07-11 13:46:31] [config] quantize-optimization-steps: 0
[2023-07-11 13:46:31] [config] quiet: false
[2023-07-11 13:46:31] [config] quiet-translation: true
[2023-07-11 13:46:31] [config] relative-paths: false
[2023-07-11 13:46:31] [config] right-left: false
[2023-07-11 13:46:31] [config] save-freq: 10000u
[2023-07-11 13:46:31] [config] seed: 1234
[2023-07-11 13:46:31] [config] sentencepiece-alphas:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:46:31] [config] sentencepiece-options: ""
[2023-07-11 13:46:31] [config] sharding: global
[2023-07-11 13:46:31] [config] shuffle: data
[2023-07-11 13:46:31] [config] shuffle-in-ram: false
[2023-07-11 13:46:31] [config] sigterm: save-and-exit
[2023-07-11 13:46:31] [config] skip: false
[2023-07-11 13:46:31] [config] sqlite: ""
[2023-07-11 13:46:31] [config] sqlite-drop: false
[2023-07-11 13:46:31] [config] sync-freq: 200u
[2023-07-11 13:46:31] [config] sync-sgd: false
[2023-07-11 13:46:31] [config] tempdir: /tmp
[2023-07-11 13:46:31] [config] tied-embeddings: false
[2023-07-11 13:46:31] [config] tied-embeddings-all: false
[2023-07-11 13:46:31] [config] tied-embeddings-src: false
[2023-07-11 13:46:31] [config] train-embedder-rank:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] train-sets:
[2023-07-11 13:46:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:46:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:46:31] [config] transformer-aan-activation: swish
[2023-07-11 13:46:31] [config] transformer-aan-depth: 2
[2023-07-11 13:46:31] [config] transformer-aan-nogate: false
[2023-07-11 13:46:31] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:46:31] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:46:31] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:46:31] [config] transformer-depth-scaling: false
[2023-07-11 13:46:31] [config] transformer-dim-aan: 2048
[2023-07-11 13:46:31] [config] transformer-dim-ffn: 2048
[2023-07-11 13:46:31] [config] transformer-dropout: 0
[2023-07-11 13:46:31] [config] transformer-dropout-attention: 0
[2023-07-11 13:46:31] [config] transformer-dropout-ffn: 0
[2023-07-11 13:46:31] [config] transformer-ffn-activation: swish
[2023-07-11 13:46:31] [config] transformer-ffn-depth: 2
[2023-07-11 13:46:31] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:46:31] [config] transformer-heads: 8
[2023-07-11 13:46:31] [config] transformer-no-projection: false
[2023-07-11 13:46:31] [config] transformer-pool: false
[2023-07-11 13:46:31] [config] transformer-postprocess: dan
[2023-07-11 13:46:31] [config] transformer-postprocess-emb: d
[2023-07-11 13:46:31] [config] transformer-postprocess-top: ""
[2023-07-11 13:46:31] [config] transformer-preprocess: ""
[2023-07-11 13:46:31] [config] transformer-tied-layers:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] transformer-train-position-embeddings: false
[2023-07-11 13:46:31] [config] tsv: false
[2023-07-11 13:46:31] [config] tsv-fields: 0
[2023-07-11 13:46:31] [config] type: transformer
[2023-07-11 13:46:31] [config] ulr: false
[2023-07-11 13:46:31] [config] ulr-dim-emb: 0
[2023-07-11 13:46:31] [config] ulr-dropout: 0
[2023-07-11 13:46:31] [config] ulr-keys-vectors: ""
[2023-07-11 13:46:31] [config] ulr-query-vectors: ""
[2023-07-11 13:46:31] [config] ulr-softmax-temperature: 1
[2023-07-11 13:46:31] [config] ulr-trainable-transformation: false
[2023-07-11 13:46:31] [config] unlikelihood-loss: false
[2023-07-11 13:46:31] [config] valid-freq: 50000000
[2023-07-11 13:46:31] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:46:31] [config] valid-max-length: 1000
[2023-07-11 13:46:31] [config] valid-metrics:
[2023-07-11 13:46:31] [config]   - cross-entropy
[2023-07-11 13:46:31] [config]   - translation
[2023-07-11 13:46:31] [config] valid-mini-batch: 32
[2023-07-11 13:46:31] [config] valid-reset-stalled: false
[2023-07-11 13:46:31] [config] valid-script-args:
[2023-07-11 13:46:31] [config]   []
[2023-07-11 13:46:31] [config] valid-script-path: ""
[2023-07-11 13:46:31] [config] valid-sets:
[2023-07-11 13:46:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:46:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:46:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:46:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:46:31] [config] vocabs:
[2023-07-11 13:46:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:46:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:46:31] [config] word-penalty: 0
[2023-07-11 13:46:31] [config] word-scores: false
[2023-07-11 13:46:31] [config] workspace: 2048
[2023-07-11 13:46:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:46:31] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:46:31] [training] Using single-device training
[2023-07-11 13:46:32] Synced seed 1234
[2023-07-11 13:46:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:46:32] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:46:32] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:46:32] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:46:32] [valid] No post-processing script given for validating translator
[2023-07-11 13:46:32] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:46:33] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:46:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:46:34] [comm] Using global sharding
[2023-07-11 13:46:34] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:46:34] [training] Using 1 GPUs
[2023-07-11 13:46:34] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:46:36] Loading Adam parameters
[2023-07-11 13:46:36] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:46:36] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:46:36] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:46:36] [data] Restoring the corpus state to epoch 41, batch 11864
[2023-07-11 13:46:36] [data] Shuffling data
[2023-07-11 13:46:36] [data] Done reading 20,192 sentences
[2023-07-11 13:46:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:46:36] Training started
[2023-07-11 13:46:36] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:46:36] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:46:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:46:36] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:46:36] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:46:44] Ep. 41 : Up. 12000 : Sen. 8,670 : Cost 0.01740303 * 1,335,380 @ 968 after 16,100,218 : Time 12.27s : 108796.81 words/s : gNorm 0.6470
[2023-07-11 13:46:53] Seen 18,843 samples
[2023-07-11 13:46:53] Starting data epoch 42 in logical epoch 42
[2023-07-11 13:46:53] [data] Shuffling data
[2023-07-11 13:46:53] [data] Done reading 20,192 sentences
[2023-07-11 13:46:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:47:10] Seen 18,843 samples
[2023-07-11 13:47:10] Starting data epoch 43 in logical epoch 43
[2023-07-11 13:47:10] [data] Shuffling data
[2023-07-11 13:47:10] [data] Done reading 20,192 sentences
[2023-07-11 13:47:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:47:26] Seen 18,843 samples
[2023-07-11 13:47:26] Starting data epoch 44 in logical epoch 44
[2023-07-11 13:47:26] [data] Shuffling data
[2023-07-11 13:47:26] [data] Done reading 20,192 sentences
[2023-07-11 13:47:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:47:40] Ep. 44 : Up. 13000 : Sen. 15,674 : Cost 0.01555253 * 1,337,866 @ 718 after 17,438,084 : Time 56.11s : 23842.29 words/s : gNorm 0.5475
[2023-07-11 13:47:43] Seen 18,843 samples
[2023-07-11 13:47:43] Starting data epoch 45 in logical epoch 45
[2023-07-11 13:47:43] [data] Shuffling data
[2023-07-11 13:47:43] [data] Done reading 20,192 sentences
[2023-07-11 13:47:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:48:00] Seen 18,843 samples
[2023-07-11 13:48:00] Starting data epoch 46 in logical epoch 46
[2023-07-11 13:48:00] [data] Shuffling data
[2023-07-11 13:48:00] [data] Done reading 20,192 sentences
[2023-07-11 13:48:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:48:17] Seen 18,843 samples
[2023-07-11 13:48:17] Starting data epoch 47 in logical epoch 47
[2023-07-11 13:48:17] [data] Shuffling data
[2023-07-11 13:48:17] [data] Done reading 20,192 sentences
[2023-07-11 13:48:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:48:34] Seen 18,843 samples
[2023-07-11 13:48:34] Starting data epoch 48 in logical epoch 48
[2023-07-11 13:48:34] [data] Shuffling data
[2023-07-11 13:48:34] [data] Done reading 20,192 sentences
[2023-07-11 13:48:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:48:38] Ep. 48 : Up. 14000 : Sen. 3,840 : Cost 0.01424893 * 1,348,446 @ 1,408 after 18,786,530 : Time 57.46s : 23469.55 words/s : gNorm 0.6213
[2023-07-11 13:48:51] Seen 18,843 samples
[2023-07-11 13:48:51] Starting data epoch 49 in logical epoch 49
[2023-07-11 13:48:51] [data] Shuffling data
[2023-07-11 13:48:51] [data] Done reading 20,192 sentences
[2023-07-11 13:48:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:49:08] Seen 18,843 samples
[2023-07-11 13:49:08] Starting data epoch 50 in logical epoch 50
[2023-07-11 13:49:08] [data] Shuffling data
[2023-07-11 13:49:08] [data] Done reading 20,192 sentences
[2023-07-11 13:49:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:49:25] Seen 18,843 samples
[2023-07-11 13:49:25] Starting data epoch 51 in logical epoch 51
[2023-07-11 13:49:25] Training finished
[2023-07-11 13:49:27] [valid] Ep. 51 : Up. 14829 : cross-entropy : 181.531 : stalled 4 times (last best: 125.788)
[2023-07-11 13:51:24] [valid] Ep. 51 : Up. 14829 : translation : 0 : new best
[2023-07-11 13:51:24] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:51:26] Saving Adam parameters
[2023-07-11 13:51:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:51:36] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:51:36] [marian] Running on node23.datos.cluster.uy as process 11994 with command line:
[2023-07-11 13:51:36] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:51:36] [config] after: 0e
[2023-07-11 13:51:36] [config] after-batches: 0
[2023-07-11 13:51:36] [config] after-epochs: 60
[2023-07-11 13:51:36] [config] all-caps-every: 0
[2023-07-11 13:51:36] [config] allow-unk: false
[2023-07-11 13:51:36] [config] authors: false
[2023-07-11 13:51:36] [config] beam-size: 12
[2023-07-11 13:51:36] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:51:36] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:51:36] [config] bert-masking-fraction: 0.15
[2023-07-11 13:51:36] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:51:36] [config] bert-train-type-embeddings: true
[2023-07-11 13:51:36] [config] bert-type-vocab-size: 2
[2023-07-11 13:51:36] [config] build-info: ""
[2023-07-11 13:51:36] [config] check-gradient-nan: false
[2023-07-11 13:51:36] [config] check-nan: false
[2023-07-11 13:51:36] [config] cite: false
[2023-07-11 13:51:36] [config] clip-norm: 1
[2023-07-11 13:51:36] [config] cost-scaling:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] cost-type: ce-sum
[2023-07-11 13:51:36] [config] cpu-threads: 0
[2023-07-11 13:51:36] [config] data-threads: 8
[2023-07-11 13:51:36] [config] data-weighting: ""
[2023-07-11 13:51:36] [config] data-weighting-type: sentence
[2023-07-11 13:51:36] [config] dec-cell: gru
[2023-07-11 13:51:36] [config] dec-cell-base-depth: 2
[2023-07-11 13:51:36] [config] dec-cell-high-depth: 1
[2023-07-11 13:51:36] [config] dec-depth: 1
[2023-07-11 13:51:36] [config] devices:
[2023-07-11 13:51:36] [config]   - 0
[2023-07-11 13:51:36] [config] dim-emb: 512
[2023-07-11 13:51:36] [config] dim-rnn: 1024
[2023-07-11 13:51:36] [config] dim-vocabs:
[2023-07-11 13:51:36] [config]   - 54042
[2023-07-11 13:51:36] [config]   - 36507
[2023-07-11 13:51:36] [config] disp-first: 0
[2023-07-11 13:51:36] [config] disp-freq: 1000u
[2023-07-11 13:51:36] [config] disp-label-counts: true
[2023-07-11 13:51:36] [config] dropout-rnn: 0
[2023-07-11 13:51:36] [config] dropout-src: 0
[2023-07-11 13:51:36] [config] dropout-trg: 0
[2023-07-11 13:51:36] [config] dump-config: ""
[2023-07-11 13:51:36] [config] dynamic-gradient-scaling:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] early-stopping: 10
[2023-07-11 13:51:36] [config] early-stopping-on: first
[2023-07-11 13:51:36] [config] embedding-fix-src: false
[2023-07-11 13:51:36] [config] embedding-fix-trg: false
[2023-07-11 13:51:36] [config] embedding-normalization: false
[2023-07-11 13:51:36] [config] embedding-vectors:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] enc-cell: gru
[2023-07-11 13:51:36] [config] enc-cell-depth: 1
[2023-07-11 13:51:36] [config] enc-depth: 1
[2023-07-11 13:51:36] [config] enc-type: bidirectional
[2023-07-11 13:51:36] [config] english-title-case-every: 0
[2023-07-11 13:51:36] [config] exponential-smoothing: 0
[2023-07-11 13:51:36] [config] factor-weight: 1
[2023-07-11 13:51:36] [config] factors-combine: sum
[2023-07-11 13:51:36] [config] factors-dim-emb: 0
[2023-07-11 13:51:36] [config] gradient-checkpointing: false
[2023-07-11 13:51:36] [config] gradient-norm-average-window: 100
[2023-07-11 13:51:36] [config] guided-alignment: none
[2023-07-11 13:51:36] [config] guided-alignment-cost: mse
[2023-07-11 13:51:36] [config] guided-alignment-weight: 0.1
[2023-07-11 13:51:36] [config] ignore-model-config: false
[2023-07-11 13:51:36] [config] input-types:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] interpolate-env-vars: false
[2023-07-11 13:51:36] [config] keep-best: false
[2023-07-11 13:51:36] [config] label-smoothing: 0
[2023-07-11 13:51:36] [config] layer-normalization: false
[2023-07-11 13:51:36] [config] learn-rate: 0.0001
[2023-07-11 13:51:36] [config] lemma-dependency: ""
[2023-07-11 13:51:36] [config] lemma-dim-emb: 0
[2023-07-11 13:51:36] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:51:36] [config] log-level: info
[2023-07-11 13:51:36] [config] log-time-zone: ""
[2023-07-11 13:51:36] [config] logical-epoch:
[2023-07-11 13:51:36] [config]   - 1e
[2023-07-11 13:51:36] [config]   - 0
[2023-07-11 13:51:36] [config] lr-decay: 0
[2023-07-11 13:51:36] [config] lr-decay-freq: 50000
[2023-07-11 13:51:36] [config] lr-decay-inv-sqrt:
[2023-07-11 13:51:36] [config]   - 0
[2023-07-11 13:51:36] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:51:36] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:51:36] [config] lr-decay-start:
[2023-07-11 13:51:36] [config]   - 10
[2023-07-11 13:51:36] [config]   - 1
[2023-07-11 13:51:36] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:51:36] [config] lr-report: false
[2023-07-11 13:51:36] [config] lr-warmup: 0
[2023-07-11 13:51:36] [config] lr-warmup-at-reload: false
[2023-07-11 13:51:36] [config] lr-warmup-cycle: false
[2023-07-11 13:51:36] [config] lr-warmup-start-rate: 0
[2023-07-11 13:51:36] [config] max-length: 50
[2023-07-11 13:51:36] [config] max-length-crop: false
[2023-07-11 13:51:36] [config] max-length-factor: 3
[2023-07-11 13:51:36] [config] maxi-batch: 100
[2023-07-11 13:51:36] [config] maxi-batch-sort: trg
[2023-07-11 13:51:36] [config] mini-batch: 64
[2023-07-11 13:51:36] [config] mini-batch-fit: false
[2023-07-11 13:51:36] [config] mini-batch-fit-step: 10
[2023-07-11 13:51:36] [config] mini-batch-round-up: true
[2023-07-11 13:51:36] [config] mini-batch-track-lr: false
[2023-07-11 13:51:36] [config] mini-batch-warmup: 0
[2023-07-11 13:51:36] [config] mini-batch-words: 0
[2023-07-11 13:51:36] [config] mini-batch-words-ref: 0
[2023-07-11 13:51:36] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:51:36] [config] multi-loss-type: sum
[2023-07-11 13:51:36] [config] n-best: false
[2023-07-11 13:51:36] [config] no-nccl: false
[2023-07-11 13:51:36] [config] no-reload: false
[2023-07-11 13:51:36] [config] no-restore-corpus: false
[2023-07-11 13:51:36] [config] normalize: 0
[2023-07-11 13:51:36] [config] normalize-gradient: false
[2023-07-11 13:51:36] [config] num-devices: 0
[2023-07-11 13:51:36] [config] optimizer: adam
[2023-07-11 13:51:36] [config] optimizer-delay: 1
[2023-07-11 13:51:36] [config] optimizer-params:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] output-omit-bias: false
[2023-07-11 13:51:36] [config] overwrite: true
[2023-07-11 13:51:36] [config] precision:
[2023-07-11 13:51:36] [config]   - float32
[2023-07-11 13:51:36] [config]   - float32
[2023-07-11 13:51:36] [config] pretrained-model: ""
[2023-07-11 13:51:36] [config] quantize-biases: false
[2023-07-11 13:51:36] [config] quantize-bits: 0
[2023-07-11 13:51:36] [config] quantize-log-based: false
[2023-07-11 13:51:36] [config] quantize-optimization-steps: 0
[2023-07-11 13:51:36] [config] quiet: false
[2023-07-11 13:51:36] [config] quiet-translation: true
[2023-07-11 13:51:36] [config] relative-paths: false
[2023-07-11 13:51:36] [config] right-left: false
[2023-07-11 13:51:36] [config] save-freq: 10000u
[2023-07-11 13:51:36] [config] seed: 1234
[2023-07-11 13:51:36] [config] sentencepiece-alphas:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:51:36] [config] sentencepiece-options: ""
[2023-07-11 13:51:36] [config] sharding: global
[2023-07-11 13:51:36] [config] shuffle: data
[2023-07-11 13:51:36] [config] shuffle-in-ram: false
[2023-07-11 13:51:36] [config] sigterm: save-and-exit
[2023-07-11 13:51:36] [config] skip: false
[2023-07-11 13:51:36] [config] sqlite: ""
[2023-07-11 13:51:36] [config] sqlite-drop: false
[2023-07-11 13:51:36] [config] sync-freq: 200u
[2023-07-11 13:51:36] [config] sync-sgd: false
[2023-07-11 13:51:36] [config] tempdir: /tmp
[2023-07-11 13:51:36] [config] tied-embeddings: false
[2023-07-11 13:51:36] [config] tied-embeddings-all: false
[2023-07-11 13:51:36] [config] tied-embeddings-src: false
[2023-07-11 13:51:36] [config] train-embedder-rank:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] train-sets:
[2023-07-11 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:51:36] [config] transformer-aan-activation: swish
[2023-07-11 13:51:36] [config] transformer-aan-depth: 2
[2023-07-11 13:51:36] [config] transformer-aan-nogate: false
[2023-07-11 13:51:36] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:51:36] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:51:36] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:51:36] [config] transformer-depth-scaling: false
[2023-07-11 13:51:36] [config] transformer-dim-aan: 2048
[2023-07-11 13:51:36] [config] transformer-dim-ffn: 2048
[2023-07-11 13:51:36] [config] transformer-dropout: 0
[2023-07-11 13:51:36] [config] transformer-dropout-attention: 0
[2023-07-11 13:51:36] [config] transformer-dropout-ffn: 0
[2023-07-11 13:51:36] [config] transformer-ffn-activation: swish
[2023-07-11 13:51:36] [config] transformer-ffn-depth: 2
[2023-07-11 13:51:36] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:51:36] [config] transformer-heads: 8
[2023-07-11 13:51:36] [config] transformer-no-projection: false
[2023-07-11 13:51:36] [config] transformer-pool: false
[2023-07-11 13:51:36] [config] transformer-postprocess: dan
[2023-07-11 13:51:36] [config] transformer-postprocess-emb: d
[2023-07-11 13:51:36] [config] transformer-postprocess-top: ""
[2023-07-11 13:51:36] [config] transformer-preprocess: ""
[2023-07-11 13:51:36] [config] transformer-tied-layers:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] transformer-train-position-embeddings: false
[2023-07-11 13:51:36] [config] tsv: false
[2023-07-11 13:51:36] [config] tsv-fields: 0
[2023-07-11 13:51:36] [config] type: transformer
[2023-07-11 13:51:36] [config] ulr: false
[2023-07-11 13:51:36] [config] ulr-dim-emb: 0
[2023-07-11 13:51:36] [config] ulr-dropout: 0
[2023-07-11 13:51:36] [config] ulr-keys-vectors: ""
[2023-07-11 13:51:36] [config] ulr-query-vectors: ""
[2023-07-11 13:51:36] [config] ulr-softmax-temperature: 1
[2023-07-11 13:51:36] [config] ulr-trainable-transformation: false
[2023-07-11 13:51:36] [config] unlikelihood-loss: false
[2023-07-11 13:51:36] [config] valid-freq: 50000000
[2023-07-11 13:51:36] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:51:36] [config] valid-max-length: 1000
[2023-07-11 13:51:36] [config] valid-metrics:
[2023-07-11 13:51:36] [config]   - cross-entropy
[2023-07-11 13:51:36] [config]   - translation
[2023-07-11 13:51:36] [config] valid-mini-batch: 32
[2023-07-11 13:51:36] [config] valid-reset-stalled: false
[2023-07-11 13:51:36] [config] valid-script-args:
[2023-07-11 13:51:36] [config]   []
[2023-07-11 13:51:36] [config] valid-script-path: ""
[2023-07-11 13:51:36] [config] valid-sets:
[2023-07-11 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:51:36] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:51:36] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:51:36] [config] vocabs:
[2023-07-11 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:51:36] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:51:36] [config] word-penalty: 0
[2023-07-11 13:51:36] [config] word-scores: false
[2023-07-11 13:51:36] [config] workspace: 2048
[2023-07-11 13:51:36] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:51:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:51:36] [training] Using single-device training
[2023-07-11 13:51:36] Synced seed 1234
[2023-07-11 13:51:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:51:36] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:51:36] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:51:36] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:51:36] [valid] No post-processing script given for validating translator
[2023-07-11 13:51:36] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:51:38] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:51:38] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:51:38] [comm] Using global sharding
[2023-07-11 13:51:38] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:51:38] [training] Using 1 GPUs
[2023-07-11 13:51:38] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:51:40] Loading Adam parameters
[2023-07-11 13:51:40] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:51:40] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:51:41] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:51:41] [data] Restoring the corpus state to epoch 51, batch 14829
[2023-07-11 13:51:41] [data] Shuffling data
[2023-07-11 13:51:41] [data] Done reading 20,192 sentences
[2023-07-11 13:51:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:51:41] Training started
[2023-07-11 13:51:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:51:41] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:51:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:51:41] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:51:41] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:51:50] Ep. 51 : Up. 15000 : Sen. 10,850 : Cost 0.01252822 * 1,333,303 @ 559 after 20,119,833 : Time 13.99s : 95284.55 words/s : gNorm 0.5341
[2023-07-11 13:51:57] Seen 18,843 samples
[2023-07-11 13:51:57] Starting data epoch 52 in logical epoch 52
[2023-07-11 13:51:57] [data] Shuffling data
[2023-07-11 13:51:57] [data] Done reading 20,192 sentences
[2023-07-11 13:51:58] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:52:14] Seen 18,843 samples
[2023-07-11 13:52:14] Starting data epoch 53 in logical epoch 53
[2023-07-11 13:52:14] [data] Shuffling data
[2023-07-11 13:52:14] [data] Done reading 20,192 sentences
[2023-07-11 13:52:14] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:52:31] Seen 18,843 samples
[2023-07-11 13:52:31] Starting data epoch 54 in logical epoch 54
[2023-07-11 13:52:31] [data] Shuffling data
[2023-07-11 13:52:31] [data] Done reading 20,192 sentences
[2023-07-11 13:52:31] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:52:47] Ep. 54 : Up. 16000 : Sen. 17,857 : Cost 0.01240557 * 1,343,441 @ 128 after 21,463,274 : Time 56.29s : 23868.03 words/s : gNorm 0.5838
[2023-07-11 13:52:48] Seen 18,843 samples
[2023-07-11 13:52:48] Starting data epoch 55 in logical epoch 55
[2023-07-11 13:52:48] [data] Shuffling data
[2023-07-11 13:52:48] [data] Done reading 20,192 sentences
[2023-07-11 13:52:48] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:53:04] Seen 18,843 samples
[2023-07-11 13:53:04] Starting data epoch 56 in logical epoch 56
[2023-07-11 13:53:04] [data] Shuffling data
[2023-07-11 13:53:04] [data] Done reading 20,192 sentences
[2023-07-11 13:53:04] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:53:21] Seen 18,843 samples
[2023-07-11 13:53:21] Starting data epoch 57 in logical epoch 57
[2023-07-11 13:53:21] [data] Shuffling data
[2023-07-11 13:53:21] [data] Done reading 20,192 sentences
[2023-07-11 13:53:21] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:53:38] Seen 18,843 samples
[2023-07-11 13:53:38] Starting data epoch 58 in logical epoch 58
[2023-07-11 13:53:38] [data] Shuffling data
[2023-07-11 13:53:38] [data] Done reading 20,192 sentences
[2023-07-11 13:53:38] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:53:44] Ep. 58 : Up. 17000 : Sen. 6,061 : Cost 0.01054912 * 1,347,361 @ 2,048 after 22,810,635 : Time 57.41s : 23467.28 words/s : gNorm 0.4453
[2023-07-11 13:53:55] Seen 18,843 samples
[2023-07-11 13:53:55] Starting data epoch 59 in logical epoch 59
[2023-07-11 13:53:55] [data] Shuffling data
[2023-07-11 13:53:55] [data] Done reading 20,192 sentences
[2023-07-11 13:53:56] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:54:12] Seen 18,843 samples
[2023-07-11 13:54:12] Starting data epoch 60 in logical epoch 60
[2023-07-11 13:54:12] [data] Shuffling data
[2023-07-11 13:54:13] [data] Done reading 20,192 sentences
[2023-07-11 13:54:13] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:54:30] Seen 18,843 samples
[2023-07-11 13:54:30] Starting data epoch 61 in logical epoch 61
[2023-07-11 13:54:30] Training finished
[2023-07-11 13:54:32] [valid] Ep. 61 : Up. 17795 : cross-entropy : 185.126 : stalled 5 times (last best: 125.788)
[2023-07-11 13:56:26] [valid] Ep. 61 : Up. 17795 : translation : 0 : new best
[2023-07-11 13:56:26] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:56:29] Saving Adam parameters
[2023-07-11 13:56:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:56:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:56:38] [marian] Running on node23.datos.cluster.uy as process 12316 with command line:
[2023-07-11 13:56:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 13:56:38] [config] after: 0e
[2023-07-11 13:56:38] [config] after-batches: 0
[2023-07-11 13:56:38] [config] after-epochs: 70
[2023-07-11 13:56:38] [config] all-caps-every: 0
[2023-07-11 13:56:38] [config] allow-unk: false
[2023-07-11 13:56:38] [config] authors: false
[2023-07-11 13:56:38] [config] beam-size: 12
[2023-07-11 13:56:38] [config] bert-class-symbol: "[CLS]"
[2023-07-11 13:56:38] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 13:56:38] [config] bert-masking-fraction: 0.15
[2023-07-11 13:56:38] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 13:56:38] [config] bert-train-type-embeddings: true
[2023-07-11 13:56:38] [config] bert-type-vocab-size: 2
[2023-07-11 13:56:38] [config] build-info: ""
[2023-07-11 13:56:38] [config] check-gradient-nan: false
[2023-07-11 13:56:38] [config] check-nan: false
[2023-07-11 13:56:38] [config] cite: false
[2023-07-11 13:56:38] [config] clip-norm: 1
[2023-07-11 13:56:38] [config] cost-scaling:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] cost-type: ce-sum
[2023-07-11 13:56:38] [config] cpu-threads: 0
[2023-07-11 13:56:38] [config] data-threads: 8
[2023-07-11 13:56:38] [config] data-weighting: ""
[2023-07-11 13:56:38] [config] data-weighting-type: sentence
[2023-07-11 13:56:38] [config] dec-cell: gru
[2023-07-11 13:56:38] [config] dec-cell-base-depth: 2
[2023-07-11 13:56:38] [config] dec-cell-high-depth: 1
[2023-07-11 13:56:38] [config] dec-depth: 1
[2023-07-11 13:56:38] [config] devices:
[2023-07-11 13:56:38] [config]   - 0
[2023-07-11 13:56:38] [config] dim-emb: 512
[2023-07-11 13:56:38] [config] dim-rnn: 1024
[2023-07-11 13:56:38] [config] dim-vocabs:
[2023-07-11 13:56:38] [config]   - 54042
[2023-07-11 13:56:38] [config]   - 36507
[2023-07-11 13:56:38] [config] disp-first: 0
[2023-07-11 13:56:38] [config] disp-freq: 1000u
[2023-07-11 13:56:38] [config] disp-label-counts: true
[2023-07-11 13:56:38] [config] dropout-rnn: 0
[2023-07-11 13:56:38] [config] dropout-src: 0
[2023-07-11 13:56:38] [config] dropout-trg: 0
[2023-07-11 13:56:38] [config] dump-config: ""
[2023-07-11 13:56:38] [config] dynamic-gradient-scaling:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] early-stopping: 10
[2023-07-11 13:56:38] [config] early-stopping-on: first
[2023-07-11 13:56:38] [config] embedding-fix-src: false
[2023-07-11 13:56:38] [config] embedding-fix-trg: false
[2023-07-11 13:56:38] [config] embedding-normalization: false
[2023-07-11 13:56:38] [config] embedding-vectors:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] enc-cell: gru
[2023-07-11 13:56:38] [config] enc-cell-depth: 1
[2023-07-11 13:56:38] [config] enc-depth: 1
[2023-07-11 13:56:38] [config] enc-type: bidirectional
[2023-07-11 13:56:38] [config] english-title-case-every: 0
[2023-07-11 13:56:38] [config] exponential-smoothing: 0
[2023-07-11 13:56:38] [config] factor-weight: 1
[2023-07-11 13:56:38] [config] factors-combine: sum
[2023-07-11 13:56:38] [config] factors-dim-emb: 0
[2023-07-11 13:56:38] [config] gradient-checkpointing: false
[2023-07-11 13:56:38] [config] gradient-norm-average-window: 100
[2023-07-11 13:56:38] [config] guided-alignment: none
[2023-07-11 13:56:38] [config] guided-alignment-cost: mse
[2023-07-11 13:56:38] [config] guided-alignment-weight: 0.1
[2023-07-11 13:56:38] [config] ignore-model-config: false
[2023-07-11 13:56:38] [config] input-types:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] interpolate-env-vars: false
[2023-07-11 13:56:38] [config] keep-best: false
[2023-07-11 13:56:38] [config] label-smoothing: 0
[2023-07-11 13:56:38] [config] layer-normalization: false
[2023-07-11 13:56:38] [config] learn-rate: 0.0001
[2023-07-11 13:56:38] [config] lemma-dependency: ""
[2023-07-11 13:56:38] [config] lemma-dim-emb: 0
[2023-07-11 13:56:38] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:56:38] [config] log-level: info
[2023-07-11 13:56:38] [config] log-time-zone: ""
[2023-07-11 13:56:38] [config] logical-epoch:
[2023-07-11 13:56:38] [config]   - 1e
[2023-07-11 13:56:38] [config]   - 0
[2023-07-11 13:56:38] [config] lr-decay: 0
[2023-07-11 13:56:38] [config] lr-decay-freq: 50000
[2023-07-11 13:56:38] [config] lr-decay-inv-sqrt:
[2023-07-11 13:56:38] [config]   - 0
[2023-07-11 13:56:38] [config] lr-decay-repeat-warmup: false
[2023-07-11 13:56:38] [config] lr-decay-reset-optimizer: false
[2023-07-11 13:56:38] [config] lr-decay-start:
[2023-07-11 13:56:38] [config]   - 10
[2023-07-11 13:56:38] [config]   - 1
[2023-07-11 13:56:38] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 13:56:38] [config] lr-report: false
[2023-07-11 13:56:38] [config] lr-warmup: 0
[2023-07-11 13:56:38] [config] lr-warmup-at-reload: false
[2023-07-11 13:56:38] [config] lr-warmup-cycle: false
[2023-07-11 13:56:38] [config] lr-warmup-start-rate: 0
[2023-07-11 13:56:38] [config] max-length: 50
[2023-07-11 13:56:38] [config] max-length-crop: false
[2023-07-11 13:56:38] [config] max-length-factor: 3
[2023-07-11 13:56:38] [config] maxi-batch: 100
[2023-07-11 13:56:38] [config] maxi-batch-sort: trg
[2023-07-11 13:56:38] [config] mini-batch: 64
[2023-07-11 13:56:38] [config] mini-batch-fit: false
[2023-07-11 13:56:38] [config] mini-batch-fit-step: 10
[2023-07-11 13:56:38] [config] mini-batch-round-up: true
[2023-07-11 13:56:38] [config] mini-batch-track-lr: false
[2023-07-11 13:56:38] [config] mini-batch-warmup: 0
[2023-07-11 13:56:38] [config] mini-batch-words: 0
[2023-07-11 13:56:38] [config] mini-batch-words-ref: 0
[2023-07-11 13:56:38] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:56:38] [config] multi-loss-type: sum
[2023-07-11 13:56:38] [config] n-best: false
[2023-07-11 13:56:38] [config] no-nccl: false
[2023-07-11 13:56:38] [config] no-reload: false
[2023-07-11 13:56:38] [config] no-restore-corpus: false
[2023-07-11 13:56:38] [config] normalize: 0
[2023-07-11 13:56:38] [config] normalize-gradient: false
[2023-07-11 13:56:38] [config] num-devices: 0
[2023-07-11 13:56:38] [config] optimizer: adam
[2023-07-11 13:56:38] [config] optimizer-delay: 1
[2023-07-11 13:56:38] [config] optimizer-params:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] output-omit-bias: false
[2023-07-11 13:56:38] [config] overwrite: true
[2023-07-11 13:56:38] [config] precision:
[2023-07-11 13:56:38] [config]   - float32
[2023-07-11 13:56:38] [config]   - float32
[2023-07-11 13:56:38] [config] pretrained-model: ""
[2023-07-11 13:56:38] [config] quantize-biases: false
[2023-07-11 13:56:38] [config] quantize-bits: 0
[2023-07-11 13:56:38] [config] quantize-log-based: false
[2023-07-11 13:56:38] [config] quantize-optimization-steps: 0
[2023-07-11 13:56:38] [config] quiet: false
[2023-07-11 13:56:38] [config] quiet-translation: true
[2023-07-11 13:56:38] [config] relative-paths: false
[2023-07-11 13:56:38] [config] right-left: false
[2023-07-11 13:56:38] [config] save-freq: 10000u
[2023-07-11 13:56:38] [config] seed: 1234
[2023-07-11 13:56:38] [config] sentencepiece-alphas:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] sentencepiece-max-lines: 2000000
[2023-07-11 13:56:38] [config] sentencepiece-options: ""
[2023-07-11 13:56:38] [config] sharding: global
[2023-07-11 13:56:38] [config] shuffle: data
[2023-07-11 13:56:38] [config] shuffle-in-ram: false
[2023-07-11 13:56:38] [config] sigterm: save-and-exit
[2023-07-11 13:56:38] [config] skip: false
[2023-07-11 13:56:38] [config] sqlite: ""
[2023-07-11 13:56:38] [config] sqlite-drop: false
[2023-07-11 13:56:38] [config] sync-freq: 200u
[2023-07-11 13:56:38] [config] sync-sgd: false
[2023-07-11 13:56:38] [config] tempdir: /tmp
[2023-07-11 13:56:38] [config] tied-embeddings: false
[2023-07-11 13:56:38] [config] tied-embeddings-all: false
[2023-07-11 13:56:38] [config] tied-embeddings-src: false
[2023-07-11 13:56:38] [config] train-embedder-rank:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] train-sets:
[2023-07-11 13:56:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 13:56:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 13:56:38] [config] transformer-aan-activation: swish
[2023-07-11 13:56:38] [config] transformer-aan-depth: 2
[2023-07-11 13:56:38] [config] transformer-aan-nogate: false
[2023-07-11 13:56:38] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 13:56:38] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 13:56:38] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 13:56:38] [config] transformer-depth-scaling: false
[2023-07-11 13:56:38] [config] transformer-dim-aan: 2048
[2023-07-11 13:56:38] [config] transformer-dim-ffn: 2048
[2023-07-11 13:56:38] [config] transformer-dropout: 0
[2023-07-11 13:56:38] [config] transformer-dropout-attention: 0
[2023-07-11 13:56:38] [config] transformer-dropout-ffn: 0
[2023-07-11 13:56:38] [config] transformer-ffn-activation: swish
[2023-07-11 13:56:38] [config] transformer-ffn-depth: 2
[2023-07-11 13:56:38] [config] transformer-guided-alignment-layer: last
[2023-07-11 13:56:38] [config] transformer-heads: 8
[2023-07-11 13:56:38] [config] transformer-no-projection: false
[2023-07-11 13:56:38] [config] transformer-pool: false
[2023-07-11 13:56:38] [config] transformer-postprocess: dan
[2023-07-11 13:56:38] [config] transformer-postprocess-emb: d
[2023-07-11 13:56:38] [config] transformer-postprocess-top: ""
[2023-07-11 13:56:38] [config] transformer-preprocess: ""
[2023-07-11 13:56:38] [config] transformer-tied-layers:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] transformer-train-position-embeddings: false
[2023-07-11 13:56:38] [config] tsv: false
[2023-07-11 13:56:38] [config] tsv-fields: 0
[2023-07-11 13:56:38] [config] type: transformer
[2023-07-11 13:56:38] [config] ulr: false
[2023-07-11 13:56:38] [config] ulr-dim-emb: 0
[2023-07-11 13:56:38] [config] ulr-dropout: 0
[2023-07-11 13:56:38] [config] ulr-keys-vectors: ""
[2023-07-11 13:56:38] [config] ulr-query-vectors: ""
[2023-07-11 13:56:38] [config] ulr-softmax-temperature: 1
[2023-07-11 13:56:38] [config] ulr-trainable-transformation: false
[2023-07-11 13:56:38] [config] unlikelihood-loss: false
[2023-07-11 13:56:38] [config] valid-freq: 50000000
[2023-07-11 13:56:38] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 13:56:38] [config] valid-max-length: 1000
[2023-07-11 13:56:38] [config] valid-metrics:
[2023-07-11 13:56:38] [config]   - cross-entropy
[2023-07-11 13:56:38] [config]   - translation
[2023-07-11 13:56:38] [config] valid-mini-batch: 32
[2023-07-11 13:56:38] [config] valid-reset-stalled: false
[2023-07-11 13:56:38] [config] valid-script-args:
[2023-07-11 13:56:38] [config]   []
[2023-07-11 13:56:38] [config] valid-script-path: ""
[2023-07-11 13:56:38] [config] valid-sets:
[2023-07-11 13:56:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 13:56:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 13:56:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 13:56:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:56:38] [config] vocabs:
[2023-07-11 13:56:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:56:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:56:38] [config] word-penalty: 0
[2023-07-11 13:56:38] [config] word-scores: false
[2023-07-11 13:56:38] [config] workspace: 2048
[2023-07-11 13:56:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 13:56:38] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:56:38] [training] Using single-device training
[2023-07-11 13:56:39] Synced seed 1234
[2023-07-11 13:56:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 13:56:39] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 13:56:39] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 13:56:39] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 13:56:39] [valid] No post-processing script given for validating translator
[2023-07-11 13:56:39] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 13:56:40] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 13:56:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 13:56:41] [comm] Using global sharding
[2023-07-11 13:56:41] [comm] NCCLCommunicators constructed successfully
[2023-07-11 13:56:41] [training] Using 1 GPUs
[2023-07-11 13:56:41] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:56:42] Loading Adam parameters
[2023-07-11 13:56:43] [memory] Reserving 552 MB, device gpu0
[2023-07-11 13:56:43] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:56:43] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:56:43] [data] Restoring the corpus state to epoch 61, batch 17795
[2023-07-11 13:56:43] [data] Shuffling data
[2023-07-11 13:56:43] [data] Done reading 20,192 sentences
[2023-07-11 13:56:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:56:43] Training started
[2023-07-11 13:56:43] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 13:56:43] [logits] Applying loss function for 1 factor(s)
[2023-07-11 13:56:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 13:56:43] [memory] Reserving 276 MB, device gpu0
[2023-07-11 13:56:43] Parameter type float32, optimization type float32, casting types false
[2023-07-11 13:56:55] Ep. 61 : Up. 18000 : Sen. 13,037 : Cost 0.01068402 * 1,335,891 @ 1,435 after 24,146,526 : Time 15.77s : 84724.97 words/s : gNorm 0.4977
[2023-07-11 13:57:00] Seen 18,843 samples
[2023-07-11 13:57:00] Starting data epoch 62 in logical epoch 62
[2023-07-11 13:57:00] [data] Shuffling data
[2023-07-11 13:57:00] [data] Done reading 20,192 sentences
[2023-07-11 13:57:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:57:17] Seen 18,843 samples
[2023-07-11 13:57:17] Starting data epoch 63 in logical epoch 63
[2023-07-11 13:57:17] [data] Shuffling data
[2023-07-11 13:57:17] [data] Done reading 20,192 sentences
[2023-07-11 13:57:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:57:33] Seen 18,843 samples
[2023-07-11 13:57:33] Starting data epoch 64 in logical epoch 64
[2023-07-11 13:57:33] [data] Shuffling data
[2023-07-11 13:57:33] [data] Done reading 20,192 sentences
[2023-07-11 13:57:33] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:57:50] Seen 18,843 samples
[2023-07-11 13:57:50] Starting data epoch 65 in logical epoch 65
[2023-07-11 13:57:50] [data] Shuffling data
[2023-07-11 13:57:50] [data] Done reading 20,192 sentences
[2023-07-11 13:57:50] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:57:51] Ep. 65 : Up. 19000 : Sen. 1,137 : Cost 0.00998862 * 1,337,858 @ 479 after 25,484,384 : Time 56.42s : 23714.53 words/s : gNorm 0.5822
[2023-07-11 13:58:07] Seen 18,843 samples
[2023-07-11 13:58:07] Starting data epoch 66 in logical epoch 66
[2023-07-11 13:58:07] [data] Shuffling data
[2023-07-11 13:58:07] [data] Done reading 20,192 sentences
[2023-07-11 13:58:07] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:58:24] Seen 18,843 samples
[2023-07-11 13:58:24] Starting data epoch 67 in logical epoch 67
[2023-07-11 13:58:24] [data] Shuffling data
[2023-07-11 13:58:24] [data] Done reading 20,192 sentences
[2023-07-11 13:58:24] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:58:41] Seen 18,843 samples
[2023-07-11 13:58:41] Starting data epoch 68 in logical epoch 68
[2023-07-11 13:58:41] [data] Shuffling data
[2023-07-11 13:58:41] [data] Done reading 20,192 sentences
[2023-07-11 13:58:41] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:58:49] Ep. 68 : Up. 20000 : Sen. 8,298 : Cost 0.00954745 * 1,354,931 @ 1,600 after 26,839,315 : Time 57.58s : 23529.74 words/s : gNorm 0.4106
[2023-07-11 13:58:49] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 13:58:51] Saving Adam parameters
[2023-07-11 13:58:52] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 13:59:06] Seen 18,843 samples
[2023-07-11 13:59:06] Starting data epoch 69 in logical epoch 69
[2023-07-11 13:59:06] [data] Shuffling data
[2023-07-11 13:59:06] [data] Done reading 20,192 sentences
[2023-07-11 13:59:06] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:59:23] Seen 18,843 samples
[2023-07-11 13:59:23] Starting data epoch 70 in logical epoch 70
[2023-07-11 13:59:23] [data] Shuffling data
[2023-07-11 13:59:23] [data] Done reading 20,192 sentences
[2023-07-11 13:59:23] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 13:59:40] Seen 18,843 samples
[2023-07-11 13:59:40] Starting data epoch 71 in logical epoch 71
[2023-07-11 13:59:40] Training finished
[2023-07-11 13:59:42] [valid] Ep. 71 : Up. 20760 : cross-entropy : 190.297 : stalled 6 times (last best: 125.788)
[2023-07-11 14:01:29] [valid] Ep. 71 : Up. 20760 : translation : 0 : new best
[2023-07-11 14:01:29] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:01:32] Saving Adam parameters
[2023-07-11 14:01:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 14:01:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:01:41] [marian] Running on node23.datos.cluster.uy as process 12651 with command line:
[2023-07-11 14:01:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 14:01:41] [config] after: 0e
[2023-07-11 14:01:41] [config] after-batches: 0
[2023-07-11 14:01:41] [config] after-epochs: 80
[2023-07-11 14:01:41] [config] all-caps-every: 0
[2023-07-11 14:01:41] [config] allow-unk: false
[2023-07-11 14:01:41] [config] authors: false
[2023-07-11 14:01:41] [config] beam-size: 12
[2023-07-11 14:01:41] [config] bert-class-symbol: "[CLS]"
[2023-07-11 14:01:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 14:01:41] [config] bert-masking-fraction: 0.15
[2023-07-11 14:01:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 14:01:41] [config] bert-train-type-embeddings: true
[2023-07-11 14:01:41] [config] bert-type-vocab-size: 2
[2023-07-11 14:01:41] [config] build-info: ""
[2023-07-11 14:01:41] [config] check-gradient-nan: false
[2023-07-11 14:01:41] [config] check-nan: false
[2023-07-11 14:01:41] [config] cite: false
[2023-07-11 14:01:41] [config] clip-norm: 1
[2023-07-11 14:01:41] [config] cost-scaling:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] cost-type: ce-sum
[2023-07-11 14:01:41] [config] cpu-threads: 0
[2023-07-11 14:01:41] [config] data-threads: 8
[2023-07-11 14:01:41] [config] data-weighting: ""
[2023-07-11 14:01:41] [config] data-weighting-type: sentence
[2023-07-11 14:01:41] [config] dec-cell: gru
[2023-07-11 14:01:41] [config] dec-cell-base-depth: 2
[2023-07-11 14:01:41] [config] dec-cell-high-depth: 1
[2023-07-11 14:01:41] [config] dec-depth: 1
[2023-07-11 14:01:41] [config] devices:
[2023-07-11 14:01:41] [config]   - 0
[2023-07-11 14:01:41] [config] dim-emb: 512
[2023-07-11 14:01:41] [config] dim-rnn: 1024
[2023-07-11 14:01:41] [config] dim-vocabs:
[2023-07-11 14:01:41] [config]   - 54042
[2023-07-11 14:01:41] [config]   - 36507
[2023-07-11 14:01:41] [config] disp-first: 0
[2023-07-11 14:01:41] [config] disp-freq: 1000u
[2023-07-11 14:01:41] [config] disp-label-counts: true
[2023-07-11 14:01:41] [config] dropout-rnn: 0
[2023-07-11 14:01:41] [config] dropout-src: 0
[2023-07-11 14:01:41] [config] dropout-trg: 0
[2023-07-11 14:01:41] [config] dump-config: ""
[2023-07-11 14:01:41] [config] dynamic-gradient-scaling:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] early-stopping: 10
[2023-07-11 14:01:41] [config] early-stopping-on: first
[2023-07-11 14:01:41] [config] embedding-fix-src: false
[2023-07-11 14:01:41] [config] embedding-fix-trg: false
[2023-07-11 14:01:41] [config] embedding-normalization: false
[2023-07-11 14:01:41] [config] embedding-vectors:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] enc-cell: gru
[2023-07-11 14:01:41] [config] enc-cell-depth: 1
[2023-07-11 14:01:41] [config] enc-depth: 1
[2023-07-11 14:01:41] [config] enc-type: bidirectional
[2023-07-11 14:01:41] [config] english-title-case-every: 0
[2023-07-11 14:01:41] [config] exponential-smoothing: 0
[2023-07-11 14:01:41] [config] factor-weight: 1
[2023-07-11 14:01:41] [config] factors-combine: sum
[2023-07-11 14:01:41] [config] factors-dim-emb: 0
[2023-07-11 14:01:41] [config] gradient-checkpointing: false
[2023-07-11 14:01:41] [config] gradient-norm-average-window: 100
[2023-07-11 14:01:41] [config] guided-alignment: none
[2023-07-11 14:01:41] [config] guided-alignment-cost: mse
[2023-07-11 14:01:41] [config] guided-alignment-weight: 0.1
[2023-07-11 14:01:41] [config] ignore-model-config: false
[2023-07-11 14:01:41] [config] input-types:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] interpolate-env-vars: false
[2023-07-11 14:01:41] [config] keep-best: false
[2023-07-11 14:01:41] [config] label-smoothing: 0
[2023-07-11 14:01:41] [config] layer-normalization: false
[2023-07-11 14:01:41] [config] learn-rate: 0.0001
[2023-07-11 14:01:41] [config] lemma-dependency: ""
[2023-07-11 14:01:41] [config] lemma-dim-emb: 0
[2023-07-11 14:01:41] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 14:01:41] [config] log-level: info
[2023-07-11 14:01:41] [config] log-time-zone: ""
[2023-07-11 14:01:41] [config] logical-epoch:
[2023-07-11 14:01:41] [config]   - 1e
[2023-07-11 14:01:41] [config]   - 0
[2023-07-11 14:01:41] [config] lr-decay: 0
[2023-07-11 14:01:41] [config] lr-decay-freq: 50000
[2023-07-11 14:01:41] [config] lr-decay-inv-sqrt:
[2023-07-11 14:01:41] [config]   - 0
[2023-07-11 14:01:41] [config] lr-decay-repeat-warmup: false
[2023-07-11 14:01:41] [config] lr-decay-reset-optimizer: false
[2023-07-11 14:01:41] [config] lr-decay-start:
[2023-07-11 14:01:41] [config]   - 10
[2023-07-11 14:01:41] [config]   - 1
[2023-07-11 14:01:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 14:01:41] [config] lr-report: false
[2023-07-11 14:01:41] [config] lr-warmup: 0
[2023-07-11 14:01:41] [config] lr-warmup-at-reload: false
[2023-07-11 14:01:41] [config] lr-warmup-cycle: false
[2023-07-11 14:01:41] [config] lr-warmup-start-rate: 0
[2023-07-11 14:01:41] [config] max-length: 50
[2023-07-11 14:01:41] [config] max-length-crop: false
[2023-07-11 14:01:41] [config] max-length-factor: 3
[2023-07-11 14:01:41] [config] maxi-batch: 100
[2023-07-11 14:01:41] [config] maxi-batch-sort: trg
[2023-07-11 14:01:41] [config] mini-batch: 64
[2023-07-11 14:01:41] [config] mini-batch-fit: false
[2023-07-11 14:01:41] [config] mini-batch-fit-step: 10
[2023-07-11 14:01:41] [config] mini-batch-round-up: true
[2023-07-11 14:01:41] [config] mini-batch-track-lr: false
[2023-07-11 14:01:41] [config] mini-batch-warmup: 0
[2023-07-11 14:01:41] [config] mini-batch-words: 0
[2023-07-11 14:01:41] [config] mini-batch-words-ref: 0
[2023-07-11 14:01:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:01:41] [config] multi-loss-type: sum
[2023-07-11 14:01:41] [config] n-best: false
[2023-07-11 14:01:41] [config] no-nccl: false
[2023-07-11 14:01:41] [config] no-reload: false
[2023-07-11 14:01:41] [config] no-restore-corpus: false
[2023-07-11 14:01:41] [config] normalize: 0
[2023-07-11 14:01:41] [config] normalize-gradient: false
[2023-07-11 14:01:41] [config] num-devices: 0
[2023-07-11 14:01:41] [config] optimizer: adam
[2023-07-11 14:01:41] [config] optimizer-delay: 1
[2023-07-11 14:01:41] [config] optimizer-params:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] output-omit-bias: false
[2023-07-11 14:01:41] [config] overwrite: true
[2023-07-11 14:01:41] [config] precision:
[2023-07-11 14:01:41] [config]   - float32
[2023-07-11 14:01:41] [config]   - float32
[2023-07-11 14:01:41] [config] pretrained-model: ""
[2023-07-11 14:01:41] [config] quantize-biases: false
[2023-07-11 14:01:41] [config] quantize-bits: 0
[2023-07-11 14:01:41] [config] quantize-log-based: false
[2023-07-11 14:01:41] [config] quantize-optimization-steps: 0
[2023-07-11 14:01:41] [config] quiet: false
[2023-07-11 14:01:41] [config] quiet-translation: true
[2023-07-11 14:01:41] [config] relative-paths: false
[2023-07-11 14:01:41] [config] right-left: false
[2023-07-11 14:01:41] [config] save-freq: 10000u
[2023-07-11 14:01:41] [config] seed: 1234
[2023-07-11 14:01:41] [config] sentencepiece-alphas:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] sentencepiece-max-lines: 2000000
[2023-07-11 14:01:41] [config] sentencepiece-options: ""
[2023-07-11 14:01:41] [config] sharding: global
[2023-07-11 14:01:41] [config] shuffle: data
[2023-07-11 14:01:41] [config] shuffle-in-ram: false
[2023-07-11 14:01:41] [config] sigterm: save-and-exit
[2023-07-11 14:01:41] [config] skip: false
[2023-07-11 14:01:41] [config] sqlite: ""
[2023-07-11 14:01:41] [config] sqlite-drop: false
[2023-07-11 14:01:41] [config] sync-freq: 200u
[2023-07-11 14:01:41] [config] sync-sgd: false
[2023-07-11 14:01:41] [config] tempdir: /tmp
[2023-07-11 14:01:41] [config] tied-embeddings: false
[2023-07-11 14:01:41] [config] tied-embeddings-all: false
[2023-07-11 14:01:41] [config] tied-embeddings-src: false
[2023-07-11 14:01:41] [config] train-embedder-rank:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] train-sets:
[2023-07-11 14:01:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 14:01:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 14:01:41] [config] transformer-aan-activation: swish
[2023-07-11 14:01:41] [config] transformer-aan-depth: 2
[2023-07-11 14:01:41] [config] transformer-aan-nogate: false
[2023-07-11 14:01:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 14:01:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 14:01:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 14:01:41] [config] transformer-depth-scaling: false
[2023-07-11 14:01:41] [config] transformer-dim-aan: 2048
[2023-07-11 14:01:41] [config] transformer-dim-ffn: 2048
[2023-07-11 14:01:41] [config] transformer-dropout: 0
[2023-07-11 14:01:41] [config] transformer-dropout-attention: 0
[2023-07-11 14:01:41] [config] transformer-dropout-ffn: 0
[2023-07-11 14:01:41] [config] transformer-ffn-activation: swish
[2023-07-11 14:01:41] [config] transformer-ffn-depth: 2
[2023-07-11 14:01:41] [config] transformer-guided-alignment-layer: last
[2023-07-11 14:01:41] [config] transformer-heads: 8
[2023-07-11 14:01:41] [config] transformer-no-projection: false
[2023-07-11 14:01:41] [config] transformer-pool: false
[2023-07-11 14:01:41] [config] transformer-postprocess: dan
[2023-07-11 14:01:41] [config] transformer-postprocess-emb: d
[2023-07-11 14:01:41] [config] transformer-postprocess-top: ""
[2023-07-11 14:01:41] [config] transformer-preprocess: ""
[2023-07-11 14:01:41] [config] transformer-tied-layers:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] transformer-train-position-embeddings: false
[2023-07-11 14:01:41] [config] tsv: false
[2023-07-11 14:01:41] [config] tsv-fields: 0
[2023-07-11 14:01:41] [config] type: transformer
[2023-07-11 14:01:41] [config] ulr: false
[2023-07-11 14:01:41] [config] ulr-dim-emb: 0
[2023-07-11 14:01:41] [config] ulr-dropout: 0
[2023-07-11 14:01:41] [config] ulr-keys-vectors: ""
[2023-07-11 14:01:41] [config] ulr-query-vectors: ""
[2023-07-11 14:01:41] [config] ulr-softmax-temperature: 1
[2023-07-11 14:01:41] [config] ulr-trainable-transformation: false
[2023-07-11 14:01:41] [config] unlikelihood-loss: false
[2023-07-11 14:01:41] [config] valid-freq: 50000000
[2023-07-11 14:01:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 14:01:41] [config] valid-max-length: 1000
[2023-07-11 14:01:41] [config] valid-metrics:
[2023-07-11 14:01:41] [config]   - cross-entropy
[2023-07-11 14:01:41] [config]   - translation
[2023-07-11 14:01:41] [config] valid-mini-batch: 32
[2023-07-11 14:01:41] [config] valid-reset-stalled: false
[2023-07-11 14:01:41] [config] valid-script-args:
[2023-07-11 14:01:41] [config]   []
[2023-07-11 14:01:41] [config] valid-script-path: ""
[2023-07-11 14:01:41] [config] valid-sets:
[2023-07-11 14:01:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 14:01:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 14:01:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 14:01:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:01:41] [config] vocabs:
[2023-07-11 14:01:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 14:01:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 14:01:41] [config] word-penalty: 0
[2023-07-11 14:01:41] [config] word-scores: false
[2023-07-11 14:01:41] [config] workspace: 2048
[2023-07-11 14:01:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:01:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 14:01:41] [training] Using single-device training
[2023-07-11 14:01:42] Synced seed 1234
[2023-07-11 14:01:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 14:01:42] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 14:01:42] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 14:01:42] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 14:01:42] [valid] No post-processing script given for validating translator
[2023-07-11 14:01:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 14:01:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 14:01:44] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 14:01:44] [comm] Using global sharding
[2023-07-11 14:01:44] [comm] NCCLCommunicators constructed successfully
[2023-07-11 14:01:44] [training] Using 1 GPUs
[2023-07-11 14:01:44] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:01:45] Loading Adam parameters
[2023-07-11 14:01:46] [memory] Reserving 552 MB, device gpu0
[2023-07-11 14:01:46] [memory] Reserving 276 MB, device gpu0
[2023-07-11 14:01:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 14:01:46] [data] Restoring the corpus state to epoch 71, batch 20760
[2023-07-11 14:01:46] [data] Shuffling data
[2023-07-11 14:01:46] [data] Done reading 20,192 sentences
[2023-07-11 14:01:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:01:46] Training started
[2023-07-11 14:01:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 14:01:46] [logits] Applying loss function for 1 factor(s)
[2023-07-11 14:01:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 14:01:46] [memory] Reserving 276 MB, device gpu0
[2023-07-11 14:01:46] Parameter type float32, optimization type float32, casting types false
[2023-07-11 14:01:59] Ep. 71 : Up. 21000 : Sen. 15,222 : Cost 0.00881836 * 1,330,991 @ 1,562 after 28,170,306 : Time 17.70s : 75201.21 words/s : gNorm 0.4796
[2023-07-11 14:02:03] Seen 18,843 samples
[2023-07-11 14:02:03] Starting data epoch 72 in logical epoch 72
[2023-07-11 14:02:03] [data] Shuffling data
[2023-07-11 14:02:03] [data] Done reading 20,192 sentences
[2023-07-11 14:02:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:02:20] Seen 18,843 samples
[2023-07-11 14:02:20] Starting data epoch 73 in logical epoch 73
[2023-07-11 14:02:20] [data] Shuffling data
[2023-07-11 14:02:20] [data] Done reading 20,192 sentences
[2023-07-11 14:02:20] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:02:36] Seen 18,843 samples
[2023-07-11 14:02:36] Starting data epoch 74 in logical epoch 74
[2023-07-11 14:02:36] [data] Shuffling data
[2023-07-11 14:02:36] [data] Done reading 20,192 sentences
[2023-07-11 14:02:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:02:53] Seen 18,843 samples
[2023-07-11 14:02:53] Starting data epoch 75 in logical epoch 75
[2023-07-11 14:02:53] [data] Shuffling data
[2023-07-11 14:02:53] [data] Done reading 20,192 sentences
[2023-07-11 14:02:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:02:56] Ep. 75 : Up. 22000 : Sen. 3,456 : Cost 0.00846127 * 1,344,658 @ 2,757 after 29,514,964 : Time 56.51s : 23794.17 words/s : gNorm 0.4369
[2023-07-11 14:03:10] Seen 18,843 samples
[2023-07-11 14:03:10] Starting data epoch 76 in logical epoch 76
[2023-07-11 14:03:10] [data] Shuffling data
[2023-07-11 14:03:10] [data] Done reading 20,192 sentences
[2023-07-11 14:03:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:03:27] Seen 18,843 samples
[2023-07-11 14:03:27] Starting data epoch 77 in logical epoch 77
[2023-07-11 14:03:27] [data] Shuffling data
[2023-07-11 14:03:27] [data] Done reading 20,192 sentences
[2023-07-11 14:03:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:03:44] Seen 18,843 samples
[2023-07-11 14:03:44] Starting data epoch 78 in logical epoch 78
[2023-07-11 14:03:44] [data] Shuffling data
[2023-07-11 14:03:44] [data] Done reading 20,192 sentences
[2023-07-11 14:03:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:03:53] Ep. 78 : Up. 23000 : Sen. 10,431 : Cost 0.00816127 * 1,340,855 @ 527 after 30,855,819 : Time 57.24s : 23423.56 words/s : gNorm 0.5198
[2023-07-11 14:04:01] Seen 18,843 samples
[2023-07-11 14:04:01] Starting data epoch 79 in logical epoch 79
[2023-07-11 14:04:01] [data] Shuffling data
[2023-07-11 14:04:01] [data] Done reading 20,192 sentences
[2023-07-11 14:04:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:04:18] Seen 18,843 samples
[2023-07-11 14:04:18] Starting data epoch 80 in logical epoch 80
[2023-07-11 14:04:18] [data] Shuffling data
[2023-07-11 14:04:18] [data] Done reading 20,192 sentences
[2023-07-11 14:04:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:04:35] Seen 18,843 samples
[2023-07-11 14:04:35] Starting data epoch 81 in logical epoch 81
[2023-07-11 14:04:35] Training finished
[2023-07-11 14:04:37] [valid] Ep. 81 : Up. 23727 : cross-entropy : 194.183 : stalled 7 times (last best: 125.788)
[2023-07-11 14:06:36] [valid] Ep. 81 : Up. 23727 : translation : 0 : new best
[2023-07-11 14:06:36] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:06:38] Saving Adam parameters
[2023-07-11 14:06:39] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 14:06:48] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:06:48] [marian] Running on node23.datos.cluster.uy as process 12973 with command line:
[2023-07-11 14:06:48] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 14:06:48] [config] after: 0e
[2023-07-11 14:06:48] [config] after-batches: 0
[2023-07-11 14:06:48] [config] after-epochs: 90
[2023-07-11 14:06:48] [config] all-caps-every: 0
[2023-07-11 14:06:48] [config] allow-unk: false
[2023-07-11 14:06:48] [config] authors: false
[2023-07-11 14:06:48] [config] beam-size: 12
[2023-07-11 14:06:48] [config] bert-class-symbol: "[CLS]"
[2023-07-11 14:06:48] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 14:06:48] [config] bert-masking-fraction: 0.15
[2023-07-11 14:06:48] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 14:06:48] [config] bert-train-type-embeddings: true
[2023-07-11 14:06:48] [config] bert-type-vocab-size: 2
[2023-07-11 14:06:48] [config] build-info: ""
[2023-07-11 14:06:48] [config] check-gradient-nan: false
[2023-07-11 14:06:48] [config] check-nan: false
[2023-07-11 14:06:48] [config] cite: false
[2023-07-11 14:06:48] [config] clip-norm: 1
[2023-07-11 14:06:48] [config] cost-scaling:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] cost-type: ce-sum
[2023-07-11 14:06:48] [config] cpu-threads: 0
[2023-07-11 14:06:48] [config] data-threads: 8
[2023-07-11 14:06:48] [config] data-weighting: ""
[2023-07-11 14:06:48] [config] data-weighting-type: sentence
[2023-07-11 14:06:48] [config] dec-cell: gru
[2023-07-11 14:06:48] [config] dec-cell-base-depth: 2
[2023-07-11 14:06:48] [config] dec-cell-high-depth: 1
[2023-07-11 14:06:48] [config] dec-depth: 1
[2023-07-11 14:06:48] [config] devices:
[2023-07-11 14:06:48] [config]   - 0
[2023-07-11 14:06:48] [config] dim-emb: 512
[2023-07-11 14:06:48] [config] dim-rnn: 1024
[2023-07-11 14:06:48] [config] dim-vocabs:
[2023-07-11 14:06:48] [config]   - 54042
[2023-07-11 14:06:48] [config]   - 36507
[2023-07-11 14:06:48] [config] disp-first: 0
[2023-07-11 14:06:48] [config] disp-freq: 1000u
[2023-07-11 14:06:48] [config] disp-label-counts: true
[2023-07-11 14:06:48] [config] dropout-rnn: 0
[2023-07-11 14:06:48] [config] dropout-src: 0
[2023-07-11 14:06:48] [config] dropout-trg: 0
[2023-07-11 14:06:48] [config] dump-config: ""
[2023-07-11 14:06:48] [config] dynamic-gradient-scaling:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] early-stopping: 10
[2023-07-11 14:06:48] [config] early-stopping-on: first
[2023-07-11 14:06:48] [config] embedding-fix-src: false
[2023-07-11 14:06:48] [config] embedding-fix-trg: false
[2023-07-11 14:06:48] [config] embedding-normalization: false
[2023-07-11 14:06:48] [config] embedding-vectors:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] enc-cell: gru
[2023-07-11 14:06:48] [config] enc-cell-depth: 1
[2023-07-11 14:06:48] [config] enc-depth: 1
[2023-07-11 14:06:48] [config] enc-type: bidirectional
[2023-07-11 14:06:48] [config] english-title-case-every: 0
[2023-07-11 14:06:48] [config] exponential-smoothing: 0
[2023-07-11 14:06:48] [config] factor-weight: 1
[2023-07-11 14:06:48] [config] factors-combine: sum
[2023-07-11 14:06:48] [config] factors-dim-emb: 0
[2023-07-11 14:06:48] [config] gradient-checkpointing: false
[2023-07-11 14:06:48] [config] gradient-norm-average-window: 100
[2023-07-11 14:06:48] [config] guided-alignment: none
[2023-07-11 14:06:48] [config] guided-alignment-cost: mse
[2023-07-11 14:06:48] [config] guided-alignment-weight: 0.1
[2023-07-11 14:06:48] [config] ignore-model-config: false
[2023-07-11 14:06:48] [config] input-types:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] interpolate-env-vars: false
[2023-07-11 14:06:48] [config] keep-best: false
[2023-07-11 14:06:48] [config] label-smoothing: 0
[2023-07-11 14:06:48] [config] layer-normalization: false
[2023-07-11 14:06:48] [config] learn-rate: 0.0001
[2023-07-11 14:06:48] [config] lemma-dependency: ""
[2023-07-11 14:06:48] [config] lemma-dim-emb: 0
[2023-07-11 14:06:48] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 14:06:48] [config] log-level: info
[2023-07-11 14:06:48] [config] log-time-zone: ""
[2023-07-11 14:06:48] [config] logical-epoch:
[2023-07-11 14:06:48] [config]   - 1e
[2023-07-11 14:06:48] [config]   - 0
[2023-07-11 14:06:48] [config] lr-decay: 0
[2023-07-11 14:06:48] [config] lr-decay-freq: 50000
[2023-07-11 14:06:48] [config] lr-decay-inv-sqrt:
[2023-07-11 14:06:48] [config]   - 0
[2023-07-11 14:06:48] [config] lr-decay-repeat-warmup: false
[2023-07-11 14:06:48] [config] lr-decay-reset-optimizer: false
[2023-07-11 14:06:48] [config] lr-decay-start:
[2023-07-11 14:06:48] [config]   - 10
[2023-07-11 14:06:48] [config]   - 1
[2023-07-11 14:06:48] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 14:06:48] [config] lr-report: false
[2023-07-11 14:06:48] [config] lr-warmup: 0
[2023-07-11 14:06:48] [config] lr-warmup-at-reload: false
[2023-07-11 14:06:48] [config] lr-warmup-cycle: false
[2023-07-11 14:06:48] [config] lr-warmup-start-rate: 0
[2023-07-11 14:06:48] [config] max-length: 50
[2023-07-11 14:06:48] [config] max-length-crop: false
[2023-07-11 14:06:48] [config] max-length-factor: 3
[2023-07-11 14:06:48] [config] maxi-batch: 100
[2023-07-11 14:06:48] [config] maxi-batch-sort: trg
[2023-07-11 14:06:48] [config] mini-batch: 64
[2023-07-11 14:06:48] [config] mini-batch-fit: false
[2023-07-11 14:06:48] [config] mini-batch-fit-step: 10
[2023-07-11 14:06:48] [config] mini-batch-round-up: true
[2023-07-11 14:06:48] [config] mini-batch-track-lr: false
[2023-07-11 14:06:48] [config] mini-batch-warmup: 0
[2023-07-11 14:06:48] [config] mini-batch-words: 0
[2023-07-11 14:06:48] [config] mini-batch-words-ref: 0
[2023-07-11 14:06:48] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:06:48] [config] multi-loss-type: sum
[2023-07-11 14:06:48] [config] n-best: false
[2023-07-11 14:06:48] [config] no-nccl: false
[2023-07-11 14:06:48] [config] no-reload: false
[2023-07-11 14:06:48] [config] no-restore-corpus: false
[2023-07-11 14:06:48] [config] normalize: 0
[2023-07-11 14:06:48] [config] normalize-gradient: false
[2023-07-11 14:06:48] [config] num-devices: 0
[2023-07-11 14:06:48] [config] optimizer: adam
[2023-07-11 14:06:48] [config] optimizer-delay: 1
[2023-07-11 14:06:48] [config] optimizer-params:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] output-omit-bias: false
[2023-07-11 14:06:48] [config] overwrite: true
[2023-07-11 14:06:48] [config] precision:
[2023-07-11 14:06:48] [config]   - float32
[2023-07-11 14:06:48] [config]   - float32
[2023-07-11 14:06:48] [config] pretrained-model: ""
[2023-07-11 14:06:48] [config] quantize-biases: false
[2023-07-11 14:06:48] [config] quantize-bits: 0
[2023-07-11 14:06:48] [config] quantize-log-based: false
[2023-07-11 14:06:48] [config] quantize-optimization-steps: 0
[2023-07-11 14:06:48] [config] quiet: false
[2023-07-11 14:06:48] [config] quiet-translation: true
[2023-07-11 14:06:48] [config] relative-paths: false
[2023-07-11 14:06:48] [config] right-left: false
[2023-07-11 14:06:48] [config] save-freq: 10000u
[2023-07-11 14:06:48] [config] seed: 1234
[2023-07-11 14:06:48] [config] sentencepiece-alphas:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] sentencepiece-max-lines: 2000000
[2023-07-11 14:06:48] [config] sentencepiece-options: ""
[2023-07-11 14:06:48] [config] sharding: global
[2023-07-11 14:06:48] [config] shuffle: data
[2023-07-11 14:06:48] [config] shuffle-in-ram: false
[2023-07-11 14:06:48] [config] sigterm: save-and-exit
[2023-07-11 14:06:48] [config] skip: false
[2023-07-11 14:06:48] [config] sqlite: ""
[2023-07-11 14:06:48] [config] sqlite-drop: false
[2023-07-11 14:06:48] [config] sync-freq: 200u
[2023-07-11 14:06:48] [config] sync-sgd: false
[2023-07-11 14:06:48] [config] tempdir: /tmp
[2023-07-11 14:06:48] [config] tied-embeddings: false
[2023-07-11 14:06:48] [config] tied-embeddings-all: false
[2023-07-11 14:06:48] [config] tied-embeddings-src: false
[2023-07-11 14:06:48] [config] train-embedder-rank:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] train-sets:
[2023-07-11 14:06:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 14:06:48] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 14:06:48] [config] transformer-aan-activation: swish
[2023-07-11 14:06:48] [config] transformer-aan-depth: 2
[2023-07-11 14:06:48] [config] transformer-aan-nogate: false
[2023-07-11 14:06:48] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 14:06:48] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 14:06:48] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 14:06:48] [config] transformer-depth-scaling: false
[2023-07-11 14:06:48] [config] transformer-dim-aan: 2048
[2023-07-11 14:06:48] [config] transformer-dim-ffn: 2048
[2023-07-11 14:06:48] [config] transformer-dropout: 0
[2023-07-11 14:06:48] [config] transformer-dropout-attention: 0
[2023-07-11 14:06:48] [config] transformer-dropout-ffn: 0
[2023-07-11 14:06:48] [config] transformer-ffn-activation: swish
[2023-07-11 14:06:48] [config] transformer-ffn-depth: 2
[2023-07-11 14:06:48] [config] transformer-guided-alignment-layer: last
[2023-07-11 14:06:48] [config] transformer-heads: 8
[2023-07-11 14:06:48] [config] transformer-no-projection: false
[2023-07-11 14:06:48] [config] transformer-pool: false
[2023-07-11 14:06:48] [config] transformer-postprocess: dan
[2023-07-11 14:06:48] [config] transformer-postprocess-emb: d
[2023-07-11 14:06:48] [config] transformer-postprocess-top: ""
[2023-07-11 14:06:48] [config] transformer-preprocess: ""
[2023-07-11 14:06:48] [config] transformer-tied-layers:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] transformer-train-position-embeddings: false
[2023-07-11 14:06:48] [config] tsv: false
[2023-07-11 14:06:48] [config] tsv-fields: 0
[2023-07-11 14:06:48] [config] type: transformer
[2023-07-11 14:06:48] [config] ulr: false
[2023-07-11 14:06:48] [config] ulr-dim-emb: 0
[2023-07-11 14:06:48] [config] ulr-dropout: 0
[2023-07-11 14:06:48] [config] ulr-keys-vectors: ""
[2023-07-11 14:06:48] [config] ulr-query-vectors: ""
[2023-07-11 14:06:48] [config] ulr-softmax-temperature: 1
[2023-07-11 14:06:48] [config] ulr-trainable-transformation: false
[2023-07-11 14:06:48] [config] unlikelihood-loss: false
[2023-07-11 14:06:48] [config] valid-freq: 50000000
[2023-07-11 14:06:48] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 14:06:48] [config] valid-max-length: 1000
[2023-07-11 14:06:48] [config] valid-metrics:
[2023-07-11 14:06:48] [config]   - cross-entropy
[2023-07-11 14:06:48] [config]   - translation
[2023-07-11 14:06:48] [config] valid-mini-batch: 32
[2023-07-11 14:06:48] [config] valid-reset-stalled: false
[2023-07-11 14:06:48] [config] valid-script-args:
[2023-07-11 14:06:48] [config]   []
[2023-07-11 14:06:48] [config] valid-script-path: ""
[2023-07-11 14:06:48] [config] valid-sets:
[2023-07-11 14:06:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 14:06:48] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 14:06:48] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 14:06:48] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:06:48] [config] vocabs:
[2023-07-11 14:06:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 14:06:48] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 14:06:48] [config] word-penalty: 0
[2023-07-11 14:06:48] [config] word-scores: false
[2023-07-11 14:06:48] [config] workspace: 2048
[2023-07-11 14:06:48] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:06:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 14:06:48] [training] Using single-device training
[2023-07-11 14:06:48] Synced seed 1234
[2023-07-11 14:06:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 14:06:48] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 14:06:48] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 14:06:48] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 14:06:48] [valid] No post-processing script given for validating translator
[2023-07-11 14:06:48] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 14:06:50] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 14:06:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 14:06:50] [comm] Using global sharding
[2023-07-11 14:06:50] [comm] NCCLCommunicators constructed successfully
[2023-07-11 14:06:50] [training] Using 1 GPUs
[2023-07-11 14:06:50] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:06:52] Loading Adam parameters
[2023-07-11 14:06:52] [memory] Reserving 552 MB, device gpu0
[2023-07-11 14:06:53] [memory] Reserving 276 MB, device gpu0
[2023-07-11 14:06:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 14:06:53] [data] Restoring the corpus state to epoch 81, batch 23727
[2023-07-11 14:06:53] [data] Shuffling data
[2023-07-11 14:06:53] [data] Done reading 20,192 sentences
[2023-07-11 14:06:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:06:53] Training started
[2023-07-11 14:06:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 14:06:53] [logits] Applying loss function for 1 factor(s)
[2023-07-11 14:06:53] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 14:06:53] [memory] Reserving 276 MB, device gpu0
[2023-07-11 14:06:53] Parameter type float32, optimization type float32, casting types false
[2023-07-11 14:07:08] Ep. 81 : Up. 24000 : Sen. 17,408 : Cost 0.00784317 * 1,343,267 @ 832 after 32,199,086 : Time 19.80s : 67848.65 words/s : gNorm 0.4696
[2023-07-11 14:07:10] Seen 18,843 samples
[2023-07-11 14:07:10] Starting data epoch 82 in logical epoch 82
[2023-07-11 14:07:10] [data] Shuffling data
[2023-07-11 14:07:10] [data] Done reading 20,192 sentences
[2023-07-11 14:07:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:07:26] Seen 18,843 samples
[2023-07-11 14:07:26] Starting data epoch 83 in logical epoch 83
[2023-07-11 14:07:26] [data] Shuffling data
[2023-07-11 14:07:26] [data] Done reading 20,192 sentences
[2023-07-11 14:07:26] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:07:43] Seen 18,843 samples
[2023-07-11 14:07:43] Starting data epoch 84 in logical epoch 84
[2023-07-11 14:07:43] [data] Shuffling data
[2023-07-11 14:07:43] [data] Done reading 20,192 sentences
[2023-07-11 14:07:43] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:08:00] Seen 18,843 samples
[2023-07-11 14:08:00] Starting data epoch 85 in logical epoch 85
[2023-07-11 14:08:00] [data] Shuffling data
[2023-07-11 14:08:00] [data] Done reading 20,192 sentences
[2023-07-11 14:08:00] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:08:05] Ep. 85 : Up. 25000 : Sen. 5,534 : Cost 0.00695652 * 1,339,320 @ 1,280 after 33,538,406 : Time 56.33s : 23775.23 words/s : gNorm 0.3663
[2023-07-11 14:08:17] Seen 18,843 samples
[2023-07-11 14:08:17] Starting data epoch 86 in logical epoch 86
[2023-07-11 14:08:17] [data] Shuffling data
[2023-07-11 14:08:17] [data] Done reading 20,192 sentences
[2023-07-11 14:08:17] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:08:34] Seen 18,843 samples
[2023-07-11 14:08:34] Starting data epoch 87 in logical epoch 87
[2023-07-11 14:08:34] [data] Shuffling data
[2023-07-11 14:08:34] [data] Done reading 20,192 sentences
[2023-07-11 14:08:34] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:08:51] Seen 18,843 samples
[2023-07-11 14:08:51] Starting data epoch 88 in logical epoch 88
[2023-07-11 14:08:51] [data] Shuffling data
[2023-07-11 14:08:51] [data] Done reading 20,192 sentences
[2023-07-11 14:08:51] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:09:02] Ep. 88 : Up. 26000 : Sen. 12,547 : Cost 0.00744204 * 1,346,822 @ 896 after 34,885,228 : Time 57.58s : 23388.57 words/s : gNorm 0.4311
[2023-07-11 14:09:08] Seen 18,843 samples
[2023-07-11 14:09:08] Starting data epoch 89 in logical epoch 89
[2023-07-11 14:09:08] [data] Shuffling data
[2023-07-11 14:09:08] [data] Done reading 20,192 sentences
[2023-07-11 14:09:08] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:09:25] Seen 18,843 samples
[2023-07-11 14:09:25] Starting data epoch 90 in logical epoch 90
[2023-07-11 14:09:25] [data] Shuffling data
[2023-07-11 14:09:25] [data] Done reading 20,192 sentences
[2023-07-11 14:09:25] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:09:42] Seen 18,843 samples
[2023-07-11 14:09:42] Starting data epoch 91 in logical epoch 91
[2023-07-11 14:09:42] Training finished
[2023-07-11 14:09:44] [valid] Ep. 91 : Up. 26693 : cross-entropy : 199.041 : stalled 8 times (last best: 125.788)
[2023-07-11 14:11:29] [valid] Ep. 91 : Up. 26693 : translation : 0 : new best
[2023-07-11 14:11:29] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:11:31] Saving Adam parameters
[2023-07-11 14:11:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 14:11:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:11:41] [marian] Running on node23.datos.cluster.uy as process 13284 with command line:
[2023-07-11 14:11:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn /docker/home/marianmt/artifacts/data/train/train_es.txt.es --model /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es --seed 1234 --type transformer --cpu-threads 0 --log /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-log /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt --quiet-translation --overwrite
[2023-07-11 14:11:41] [config] after: 0e
[2023-07-11 14:11:41] [config] after-batches: 0
[2023-07-11 14:11:41] [config] after-epochs: 100
[2023-07-11 14:11:41] [config] all-caps-every: 0
[2023-07-11 14:11:41] [config] allow-unk: false
[2023-07-11 14:11:41] [config] authors: false
[2023-07-11 14:11:41] [config] beam-size: 12
[2023-07-11 14:11:41] [config] bert-class-symbol: "[CLS]"
[2023-07-11 14:11:41] [config] bert-mask-symbol: "[MASK]"
[2023-07-11 14:11:41] [config] bert-masking-fraction: 0.15
[2023-07-11 14:11:41] [config] bert-sep-symbol: "[SEP]"
[2023-07-11 14:11:41] [config] bert-train-type-embeddings: true
[2023-07-11 14:11:41] [config] bert-type-vocab-size: 2
[2023-07-11 14:11:41] [config] build-info: ""
[2023-07-11 14:11:41] [config] check-gradient-nan: false
[2023-07-11 14:11:41] [config] check-nan: false
[2023-07-11 14:11:41] [config] cite: false
[2023-07-11 14:11:41] [config] clip-norm: 1
[2023-07-11 14:11:41] [config] cost-scaling:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] cost-type: ce-sum
[2023-07-11 14:11:41] [config] cpu-threads: 0
[2023-07-11 14:11:41] [config] data-threads: 8
[2023-07-11 14:11:41] [config] data-weighting: ""
[2023-07-11 14:11:41] [config] data-weighting-type: sentence
[2023-07-11 14:11:41] [config] dec-cell: gru
[2023-07-11 14:11:41] [config] dec-cell-base-depth: 2
[2023-07-11 14:11:41] [config] dec-cell-high-depth: 1
[2023-07-11 14:11:41] [config] dec-depth: 1
[2023-07-11 14:11:41] [config] devices:
[2023-07-11 14:11:41] [config]   - 0
[2023-07-11 14:11:41] [config] dim-emb: 512
[2023-07-11 14:11:41] [config] dim-rnn: 1024
[2023-07-11 14:11:41] [config] dim-vocabs:
[2023-07-11 14:11:41] [config]   - 54042
[2023-07-11 14:11:41] [config]   - 36507
[2023-07-11 14:11:41] [config] disp-first: 0
[2023-07-11 14:11:41] [config] disp-freq: 1000u
[2023-07-11 14:11:41] [config] disp-label-counts: true
[2023-07-11 14:11:41] [config] dropout-rnn: 0
[2023-07-11 14:11:41] [config] dropout-src: 0
[2023-07-11 14:11:41] [config] dropout-trg: 0
[2023-07-11 14:11:41] [config] dump-config: ""
[2023-07-11 14:11:41] [config] dynamic-gradient-scaling:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] early-stopping: 10
[2023-07-11 14:11:41] [config] early-stopping-on: first
[2023-07-11 14:11:41] [config] embedding-fix-src: false
[2023-07-11 14:11:41] [config] embedding-fix-trg: false
[2023-07-11 14:11:41] [config] embedding-normalization: false
[2023-07-11 14:11:41] [config] embedding-vectors:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] enc-cell: gru
[2023-07-11 14:11:41] [config] enc-cell-depth: 1
[2023-07-11 14:11:41] [config] enc-depth: 1
[2023-07-11 14:11:41] [config] enc-type: bidirectional
[2023-07-11 14:11:41] [config] english-title-case-every: 0
[2023-07-11 14:11:41] [config] exponential-smoothing: 0
[2023-07-11 14:11:41] [config] factor-weight: 1
[2023-07-11 14:11:41] [config] factors-combine: sum
[2023-07-11 14:11:41] [config] factors-dim-emb: 0
[2023-07-11 14:11:41] [config] gradient-checkpointing: false
[2023-07-11 14:11:41] [config] gradient-norm-average-window: 100
[2023-07-11 14:11:41] [config] guided-alignment: none
[2023-07-11 14:11:41] [config] guided-alignment-cost: mse
[2023-07-11 14:11:41] [config] guided-alignment-weight: 0.1
[2023-07-11 14:11:41] [config] ignore-model-config: false
[2023-07-11 14:11:41] [config] input-types:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] interpolate-env-vars: false
[2023-07-11 14:11:41] [config] keep-best: false
[2023-07-11 14:11:41] [config] label-smoothing: 0
[2023-07-11 14:11:41] [config] layer-normalization: false
[2023-07-11 14:11:41] [config] learn-rate: 0.0001
[2023-07-11 14:11:41] [config] lemma-dependency: ""
[2023-07-11 14:11:41] [config] lemma-dim-emb: 0
[2023-07-11 14:11:41] [config] log: /docker/home/marianmt/logs/marian/log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 14:11:41] [config] log-level: info
[2023-07-11 14:11:41] [config] log-time-zone: ""
[2023-07-11 14:11:41] [config] logical-epoch:
[2023-07-11 14:11:41] [config]   - 1e
[2023-07-11 14:11:41] [config]   - 0
[2023-07-11 14:11:41] [config] lr-decay: 0
[2023-07-11 14:11:41] [config] lr-decay-freq: 50000
[2023-07-11 14:11:41] [config] lr-decay-inv-sqrt:
[2023-07-11 14:11:41] [config]   - 0
[2023-07-11 14:11:41] [config] lr-decay-repeat-warmup: false
[2023-07-11 14:11:41] [config] lr-decay-reset-optimizer: false
[2023-07-11 14:11:41] [config] lr-decay-start:
[2023-07-11 14:11:41] [config]   - 10
[2023-07-11 14:11:41] [config]   - 1
[2023-07-11 14:11:41] [config] lr-decay-strategy: epoch+stalled
[2023-07-11 14:11:41] [config] lr-report: false
[2023-07-11 14:11:41] [config] lr-warmup: 0
[2023-07-11 14:11:41] [config] lr-warmup-at-reload: false
[2023-07-11 14:11:41] [config] lr-warmup-cycle: false
[2023-07-11 14:11:41] [config] lr-warmup-start-rate: 0
[2023-07-11 14:11:41] [config] max-length: 50
[2023-07-11 14:11:41] [config] max-length-crop: false
[2023-07-11 14:11:41] [config] max-length-factor: 3
[2023-07-11 14:11:41] [config] maxi-batch: 100
[2023-07-11 14:11:41] [config] maxi-batch-sort: trg
[2023-07-11 14:11:41] [config] mini-batch: 64
[2023-07-11 14:11:41] [config] mini-batch-fit: false
[2023-07-11 14:11:41] [config] mini-batch-fit-step: 10
[2023-07-11 14:11:41] [config] mini-batch-round-up: true
[2023-07-11 14:11:41] [config] mini-batch-track-lr: false
[2023-07-11 14:11:41] [config] mini-batch-warmup: 0
[2023-07-11 14:11:41] [config] mini-batch-words: 0
[2023-07-11 14:11:41] [config] mini-batch-words-ref: 0
[2023-07-11 14:11:41] [config] model: /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:11:41] [config] multi-loss-type: sum
[2023-07-11 14:11:41] [config] n-best: false
[2023-07-11 14:11:41] [config] no-nccl: false
[2023-07-11 14:11:41] [config] no-reload: false
[2023-07-11 14:11:41] [config] no-restore-corpus: false
[2023-07-11 14:11:41] [config] normalize: 0
[2023-07-11 14:11:41] [config] normalize-gradient: false
[2023-07-11 14:11:41] [config] num-devices: 0
[2023-07-11 14:11:41] [config] optimizer: adam
[2023-07-11 14:11:41] [config] optimizer-delay: 1
[2023-07-11 14:11:41] [config] optimizer-params:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] output-omit-bias: false
[2023-07-11 14:11:41] [config] overwrite: true
[2023-07-11 14:11:41] [config] precision:
[2023-07-11 14:11:41] [config]   - float32
[2023-07-11 14:11:41] [config]   - float32
[2023-07-11 14:11:41] [config] pretrained-model: ""
[2023-07-11 14:11:41] [config] quantize-biases: false
[2023-07-11 14:11:41] [config] quantize-bits: 0
[2023-07-11 14:11:41] [config] quantize-log-based: false
[2023-07-11 14:11:41] [config] quantize-optimization-steps: 0
[2023-07-11 14:11:41] [config] quiet: false
[2023-07-11 14:11:41] [config] quiet-translation: true
[2023-07-11 14:11:41] [config] relative-paths: false
[2023-07-11 14:11:41] [config] right-left: false
[2023-07-11 14:11:41] [config] save-freq: 10000u
[2023-07-11 14:11:41] [config] seed: 1234
[2023-07-11 14:11:41] [config] sentencepiece-alphas:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] sentencepiece-max-lines: 2000000
[2023-07-11 14:11:41] [config] sentencepiece-options: ""
[2023-07-11 14:11:41] [config] sharding: global
[2023-07-11 14:11:41] [config] shuffle: data
[2023-07-11 14:11:41] [config] shuffle-in-ram: false
[2023-07-11 14:11:41] [config] sigterm: save-and-exit
[2023-07-11 14:11:41] [config] skip: false
[2023-07-11 14:11:41] [config] sqlite: ""
[2023-07-11 14:11:41] [config] sqlite-drop: false
[2023-07-11 14:11:41] [config] sync-freq: 200u
[2023-07-11 14:11:41] [config] sync-sgd: false
[2023-07-11 14:11:41] [config] tempdir: /tmp
[2023-07-11 14:11:41] [config] tied-embeddings: false
[2023-07-11 14:11:41] [config] tied-embeddings-all: false
[2023-07-11 14:11:41] [config] tied-embeddings-src: false
[2023-07-11 14:11:41] [config] train-embedder-rank:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] train-sets:
[2023-07-11 14:11:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-07-11 14:11:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-07-11 14:11:41] [config] transformer-aan-activation: swish
[2023-07-11 14:11:41] [config] transformer-aan-depth: 2
[2023-07-11 14:11:41] [config] transformer-aan-nogate: false
[2023-07-11 14:11:41] [config] transformer-decoder-autoreg: self-attention
[2023-07-11 14:11:41] [config] transformer-decoder-dim-ffn: 0
[2023-07-11 14:11:41] [config] transformer-decoder-ffn-depth: 0
[2023-07-11 14:11:41] [config] transformer-depth-scaling: false
[2023-07-11 14:11:41] [config] transformer-dim-aan: 2048
[2023-07-11 14:11:41] [config] transformer-dim-ffn: 2048
[2023-07-11 14:11:41] [config] transformer-dropout: 0
[2023-07-11 14:11:41] [config] transformer-dropout-attention: 0
[2023-07-11 14:11:41] [config] transformer-dropout-ffn: 0
[2023-07-11 14:11:41] [config] transformer-ffn-activation: swish
[2023-07-11 14:11:41] [config] transformer-ffn-depth: 2
[2023-07-11 14:11:41] [config] transformer-guided-alignment-layer: last
[2023-07-11 14:11:41] [config] transformer-heads: 8
[2023-07-11 14:11:41] [config] transformer-no-projection: false
[2023-07-11 14:11:41] [config] transformer-pool: false
[2023-07-11 14:11:41] [config] transformer-postprocess: dan
[2023-07-11 14:11:41] [config] transformer-postprocess-emb: d
[2023-07-11 14:11:41] [config] transformer-postprocess-top: ""
[2023-07-11 14:11:41] [config] transformer-preprocess: ""
[2023-07-11 14:11:41] [config] transformer-tied-layers:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] transformer-train-position-embeddings: false
[2023-07-11 14:11:41] [config] tsv: false
[2023-07-11 14:11:41] [config] tsv-fields: 0
[2023-07-11 14:11:41] [config] type: transformer
[2023-07-11 14:11:41] [config] ulr: false
[2023-07-11 14:11:41] [config] ulr-dim-emb: 0
[2023-07-11 14:11:41] [config] ulr-dropout: 0
[2023-07-11 14:11:41] [config] ulr-keys-vectors: ""
[2023-07-11 14:11:41] [config] ulr-query-vectors: ""
[2023-07-11 14:11:41] [config] ulr-softmax-temperature: 1
[2023-07-11 14:11:41] [config] ulr-trainable-transformation: false
[2023-07-11 14:11:41] [config] unlikelihood-loss: false
[2023-07-11 14:11:41] [config] valid-freq: 50000000
[2023-07-11 14:11:41] [config] valid-log: /docker/home/marianmt/logs/marian/valid_log_gn_es_july_transformer_cpu_nodenode23_4.log
[2023-07-11 14:11:41] [config] valid-max-length: 1000
[2023-07-11 14:11:41] [config] valid-metrics:
[2023-07-11 14:11:41] [config]   - cross-entropy
[2023-07-11 14:11:41] [config]   - translation
[2023-07-11 14:11:41] [config] valid-mini-batch: 32
[2023-07-11 14:11:41] [config] valid-reset-stalled: false
[2023-07-11 14:11:41] [config] valid-script-args:
[2023-07-11 14:11:41] [config]   []
[2023-07-11 14:11:41] [config] valid-script-path: ""
[2023-07-11 14:11:41] [config] valid-sets:
[2023-07-11 14:11:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-07-11 14:11:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-07-11 14:11:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-transformer-gn-es.txt
[2023-07-11 14:11:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:11:41] [config] vocabs:
[2023-07-11 14:11:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 14:11:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 14:11:41] [config] word-penalty: 0
[2023-07-11 14:11:41] [config] word-scores: false
[2023-07-11 14:11:41] [config] workspace: 2048
[2023-07-11 14:11:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-07-11 14:11:41] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 14:11:41] [training] Using single-device training
[2023-07-11 14:11:41] Synced seed 1234
[2023-07-11 14:11:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens.txt.gn
[2023-07-11 14:11:41] [data] Setting vocabulary size for input 0 to 54,042
[2023-07-11 14:11:41] [data] Loading vocabulary from text file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens.txt.es
[2023-07-11 14:11:41] [data] Setting vocabulary size for input 1 to 36,507
[2023-07-11 14:11:41] [valid] No post-processing script given for validating translator
[2023-07-11 14:11:42] [MPI rank 0 out of 1]: GPU[0]
[2023-07-11 14:11:43] [memory] Extending reserved space to 2048 MB (device gpu0)
[2023-07-11 14:11:43] [comm] Using NCCL 2.8.3 for GPU communication
[2023-07-11 14:11:43] [comm] Using global sharding
[2023-07-11 14:11:43] [comm] NCCLCommunicators constructed successfully
[2023-07-11 14:11:43] [training] Using 1 GPUs
[2023-07-11 14:11:43] Loading model from /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:11:45] Loading Adam parameters
[2023-07-11 14:11:45] [memory] Reserving 552 MB, device gpu0
[2023-07-11 14:11:46] [memory] Reserving 276 MB, device gpu0
[2023-07-11 14:11:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
[2023-07-11 14:11:46] [data] Restoring the corpus state to epoch 91, batch 26693
[2023-07-11 14:11:46] [data] Shuffling data
[2023-07-11 14:11:46] [data] Done reading 20,192 sentences
[2023-07-11 14:11:46] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:11:46] Training started
[2023-07-11 14:11:46] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-07-11 14:11:46] [logits] Applying loss function for 1 factor(s)
[2023-07-11 14:11:46] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-07-11 14:11:46] [memory] Reserving 276 MB, device gpu0
[2023-07-11 14:11:46] Parameter type float32, optimization type float32, casting types false
[2023-07-11 14:12:03] Seen 18,843 samples
[2023-07-11 14:12:03] Starting data epoch 92 in logical epoch 92
[2023-07-11 14:12:03] [data] Shuffling data
[2023-07-11 14:12:03] [data] Done reading 20,192 sentences
[2023-07-11 14:12:03] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:12:03] Ep. 92 : Up. 27000 : Sen. 704 : Cost 0.00720184 * 1,333,196 @ 488 after 36,218,424 : Time 21.62s : 61658.63 words/s : gNorm 0.3790
[2023-07-11 14:12:19] Seen 18,843 samples
[2023-07-11 14:12:19] Starting data epoch 93 in logical epoch 93
[2023-07-11 14:12:19] [data] Shuffling data
[2023-07-11 14:12:19] [data] Done reading 20,192 sentences
[2023-07-11 14:12:19] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:12:36] Seen 18,843 samples
[2023-07-11 14:12:36] Starting data epoch 94 in logical epoch 94
[2023-07-11 14:12:36] [data] Shuffling data
[2023-07-11 14:12:36] [data] Done reading 20,192 sentences
[2023-07-11 14:12:36] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:12:53] Seen 18,843 samples
[2023-07-11 14:12:53] Starting data epoch 95 in logical epoch 95
[2023-07-11 14:12:53] [data] Shuffling data
[2023-07-11 14:12:53] [data] Done reading 20,192 sentences
[2023-07-11 14:12:53] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:13:00] Ep. 95 : Up. 28000 : Sen. 7,700 : Cost 0.00689801 * 1,349,095 @ 2,048 after 37,567,519 : Time 56.54s : 23860.02 words/s : gNorm 0.3469
[2023-07-11 14:13:10] Seen 18,843 samples
[2023-07-11 14:13:10] Starting data epoch 96 in logical epoch 96
[2023-07-11 14:13:10] [data] Shuffling data
[2023-07-11 14:13:10] [data] Done reading 20,192 sentences
[2023-07-11 14:13:10] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:13:27] Seen 18,843 samples
[2023-07-11 14:13:27] Starting data epoch 97 in logical epoch 97
[2023-07-11 14:13:27] [data] Shuffling data
[2023-07-11 14:13:27] [data] Done reading 20,192 sentences
[2023-07-11 14:13:27] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:13:44] Seen 18,843 samples
[2023-07-11 14:13:44] Starting data epoch 98 in logical epoch 98
[2023-07-11 14:13:44] [data] Shuffling data
[2023-07-11 14:13:44] [data] Done reading 20,192 sentences
[2023-07-11 14:13:44] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:13:57] Ep. 98 : Up. 29000 : Sen. 14,591 : Cost 0.00715780 * 1,338,821 @ 2,572 after 38,906,340 : Time 57.13s : 23434.76 words/s : gNorm 0.3967
[2023-07-11 14:14:01] Seen 18,843 samples
[2023-07-11 14:14:01] Starting data epoch 99 in logical epoch 99
[2023-07-11 14:14:01] [data] Shuffling data
[2023-07-11 14:14:01] [data] Done reading 20,192 sentences
[2023-07-11 14:14:01] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:14:18] Seen 18,843 samples
[2023-07-11 14:14:18] Starting data epoch 100 in logical epoch 100
[2023-07-11 14:14:18] [data] Shuffling data
[2023-07-11 14:14:18] [data] Done reading 20,192 sentences
[2023-07-11 14:14:18] [data] Done shuffling 20,192 sentences to temp files
[2023-07-11 14:14:35] Seen 18,843 samples
[2023-07-11 14:14:35] Starting data epoch 101 in logical epoch 101
[2023-07-11 14:14:35] Training finished
[2023-07-11 14:14:37] [valid] Ep. 101 : Up. 29659 : cross-entropy : 203.786 : stalled 9 times (last best: 125.788)
[2023-07-11 14:16:33] [valid] Ep. 101 : Up. 29659 : translation : 0 : new best
[2023-07-11 14:16:33] Saving model weights and runtime parameters to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz
[2023-07-11 14:16:35] Saving Adam parameters
[2023-07-11 14:16:36] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz and /docker/home/marianmt/artifacts/models/model_gn_es_july_transformer_cpu_nodenode23_4/gn_es_july_transformer_cpu_nodenode23_4.npz.optimizer.npz
