[2023-06-29 07:47:15] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 07:47:15] [marian] Running on node20.datos.cluster.uy as process 11670 with command line:
[2023-06-29 07:47:15] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 10 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 07:47:15] [config] after: 0e
[2023-06-29 07:47:15] [config] after-batches: 0
[2023-06-29 07:47:15] [config] after-epochs: 10
[2023-06-29 07:47:15] [config] all-caps-every: 0
[2023-06-29 07:47:15] [config] allow-unk: false
[2023-06-29 07:47:15] [config] authors: false
[2023-06-29 07:47:15] [config] beam-size: 6
[2023-06-29 07:47:15] [config] bert-class-symbol: "[CLS]"
[2023-06-29 07:47:15] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 07:47:15] [config] bert-masking-fraction: 0.15
[2023-06-29 07:47:15] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 07:47:15] [config] bert-train-type-embeddings: true
[2023-06-29 07:47:15] [config] bert-type-vocab-size: 2
[2023-06-29 07:47:15] [config] build-info: ""
[2023-06-29 07:47:15] [config] check-gradient-nan: false
[2023-06-29 07:47:15] [config] check-nan: false
[2023-06-29 07:47:15] [config] cite: false
[2023-06-29 07:47:15] [config] clip-norm: 1
[2023-06-29 07:47:15] [config] cost-scaling:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] cost-type: ce-sum
[2023-06-29 07:47:15] [config] cpu-threads: 0
[2023-06-29 07:47:15] [config] data-threads: 8
[2023-06-29 07:47:15] [config] data-weighting: ""
[2023-06-29 07:47:15] [config] data-weighting-type: sentence
[2023-06-29 07:47:15] [config] dec-cell: gru
[2023-06-29 07:47:15] [config] dec-cell-base-depth: 2
[2023-06-29 07:47:15] [config] dec-cell-high-depth: 1
[2023-06-29 07:47:15] [config] dec-depth: 1
[2023-06-29 07:47:15] [config] devices:
[2023-06-29 07:47:15] [config]   - 0
[2023-06-29 07:47:15] [config] dim-emb: 512
[2023-06-29 07:47:15] [config] dim-rnn: 1024
[2023-06-29 07:47:15] [config] dim-vocabs:
[2023-06-29 07:47:15] [config]   - 16384
[2023-06-29 07:47:15] [config]   - 16384
[2023-06-29 07:47:15] [config] disp-first: 0
[2023-06-29 07:47:15] [config] disp-freq: 1000u
[2023-06-29 07:47:15] [config] disp-label-counts: true
[2023-06-29 07:47:15] [config] dropout-rnn: 0.2
[2023-06-29 07:47:15] [config] dropout-src: 0.1
[2023-06-29 07:47:15] [config] dropout-trg: 0.1
[2023-06-29 07:47:15] [config] dump-config: ""
[2023-06-29 07:47:15] [config] dynamic-gradient-scaling:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] early-stopping: 10
[2023-06-29 07:47:15] [config] early-stopping-on: first
[2023-06-29 07:47:15] [config] embedding-fix-src: false
[2023-06-29 07:47:15] [config] embedding-fix-trg: false
[2023-06-29 07:47:15] [config] embedding-normalization: false
[2023-06-29 07:47:15] [config] embedding-vectors:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] enc-cell: gru
[2023-06-29 07:47:15] [config] enc-cell-depth: 1
[2023-06-29 07:47:15] [config] enc-depth: 1
[2023-06-29 07:47:15] [config] enc-type: bidirectional
[2023-06-29 07:47:15] [config] english-title-case-every: 0
[2023-06-29 07:47:15] [config] exponential-smoothing: 0
[2023-06-29 07:47:15] [config] factor-weight: 1
[2023-06-29 07:47:15] [config] factors-combine: sum
[2023-06-29 07:47:15] [config] factors-dim-emb: 0
[2023-06-29 07:47:15] [config] gradient-checkpointing: false
[2023-06-29 07:47:15] [config] gradient-norm-average-window: 100
[2023-06-29 07:47:15] [config] guided-alignment: none
[2023-06-29 07:47:15] [config] guided-alignment-cost: mse
[2023-06-29 07:47:15] [config] guided-alignment-weight: 0.1
[2023-06-29 07:47:15] [config] ignore-model-config: false
[2023-06-29 07:47:15] [config] input-types:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] interpolate-env-vars: false
[2023-06-29 07:47:15] [config] keep-best: false
[2023-06-29 07:47:15] [config] label-smoothing: 0
[2023-06-29 07:47:15] [config] layer-normalization: true
[2023-06-29 07:47:15] [config] learn-rate: 0.0001
[2023-06-29 07:47:15] [config] lemma-dependency: ""
[2023-06-29 07:47:15] [config] lemma-dim-emb: 0
[2023-06-29 07:47:15] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 07:47:15] [config] log-level: info
[2023-06-29 07:47:15] [config] log-time-zone: ""
[2023-06-29 07:47:15] [config] logical-epoch:
[2023-06-29 07:47:15] [config]   - 1e
[2023-06-29 07:47:15] [config]   - 0
[2023-06-29 07:47:15] [config] lr-decay: 0
[2023-06-29 07:47:15] [config] lr-decay-freq: 50000
[2023-06-29 07:47:15] [config] lr-decay-inv-sqrt:
[2023-06-29 07:47:15] [config]   - 0
[2023-06-29 07:47:15] [config] lr-decay-repeat-warmup: false
[2023-06-29 07:47:15] [config] lr-decay-reset-optimizer: false
[2023-06-29 07:47:15] [config] lr-decay-start:
[2023-06-29 07:47:15] [config]   - 10
[2023-06-29 07:47:15] [config]   - 1
[2023-06-29 07:47:15] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 07:47:15] [config] lr-report: false
[2023-06-29 07:47:15] [config] lr-warmup: 0
[2023-06-29 07:47:15] [config] lr-warmup-at-reload: false
[2023-06-29 07:47:15] [config] lr-warmup-cycle: false
[2023-06-29 07:47:15] [config] lr-warmup-start-rate: 0
[2023-06-29 07:47:15] [config] max-length: 50
[2023-06-29 07:47:15] [config] max-length-crop: false
[2023-06-29 07:47:15] [config] max-length-factor: 3
[2023-06-29 07:47:15] [config] maxi-batch: 100
[2023-06-29 07:47:15] [config] maxi-batch-sort: trg
[2023-06-29 07:47:15] [config] mini-batch: 64
[2023-06-29 07:47:15] [config] mini-batch-fit: true
[2023-06-29 07:47:15] [config] mini-batch-fit-step: 10
[2023-06-29 07:47:15] [config] mini-batch-round-up: true
[2023-06-29 07:47:15] [config] mini-batch-track-lr: false
[2023-06-29 07:47:15] [config] mini-batch-warmup: 0
[2023-06-29 07:47:15] [config] mini-batch-words: 0
[2023-06-29 07:47:15] [config] mini-batch-words-ref: 0
[2023-06-29 07:47:15] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 07:47:15] [config] multi-loss-type: sum
[2023-06-29 07:47:15] [config] n-best: false
[2023-06-29 07:47:15] [config] no-nccl: false
[2023-06-29 07:47:15] [config] no-reload: false
[2023-06-29 07:47:15] [config] no-restore-corpus: false
[2023-06-29 07:47:15] [config] normalize: 0.6
[2023-06-29 07:47:15] [config] normalize-gradient: false
[2023-06-29 07:47:15] [config] num-devices: 0
[2023-06-29 07:47:15] [config] optimizer: adam
[2023-06-29 07:47:15] [config] optimizer-delay: 1
[2023-06-29 07:47:15] [config] optimizer-params:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] output-omit-bias: false
[2023-06-29 07:47:15] [config] overwrite: true
[2023-06-29 07:47:15] [config] precision:
[2023-06-29 07:47:15] [config]   - float32
[2023-06-29 07:47:15] [config]   - float32
[2023-06-29 07:47:15] [config] pretrained-model: ""
[2023-06-29 07:47:15] [config] quantize-biases: false
[2023-06-29 07:47:15] [config] quantize-bits: 0
[2023-06-29 07:47:15] [config] quantize-log-based: false
[2023-06-29 07:47:15] [config] quantize-optimization-steps: 0
[2023-06-29 07:47:15] [config] quiet: false
[2023-06-29 07:47:15] [config] quiet-translation: true
[2023-06-29 07:47:15] [config] relative-paths: false
[2023-06-29 07:47:15] [config] right-left: false
[2023-06-29 07:47:15] [config] save-freq: 10000u
[2023-06-29 07:47:15] [config] seed: 1234
[2023-06-29 07:47:15] [config] sentencepiece-alphas:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] sentencepiece-max-lines: 2000000
[2023-06-29 07:47:15] [config] sentencepiece-options: ""
[2023-06-29 07:47:15] [config] sharding: global
[2023-06-29 07:47:15] [config] shuffle: data
[2023-06-29 07:47:15] [config] shuffle-in-ram: false
[2023-06-29 07:47:15] [config] sigterm: save-and-exit
[2023-06-29 07:47:15] [config] skip: false
[2023-06-29 07:47:15] [config] sqlite: ""
[2023-06-29 07:47:15] [config] sqlite-drop: false
[2023-06-29 07:47:15] [config] sync-freq: 200u
[2023-06-29 07:47:15] [config] sync-sgd: false
[2023-06-29 07:47:15] [config] tempdir: /tmp
[2023-06-29 07:47:15] [config] tied-embeddings: false
[2023-06-29 07:47:15] [config] tied-embeddings-all: true
[2023-06-29 07:47:15] [config] tied-embeddings-src: false
[2023-06-29 07:47:15] [config] train-embedder-rank:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] train-sets:
[2023-06-29 07:47:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 07:47:15] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 07:47:15] [config] transformer-aan-activation: swish
[2023-06-29 07:47:15] [config] transformer-aan-depth: 2
[2023-06-29 07:47:15] [config] transformer-aan-nogate: false
[2023-06-29 07:47:15] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 07:47:15] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 07:47:15] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 07:47:15] [config] transformer-depth-scaling: false
[2023-06-29 07:47:15] [config] transformer-dim-aan: 2048
[2023-06-29 07:47:15] [config] transformer-dim-ffn: 2048
[2023-06-29 07:47:15] [config] transformer-dropout: 0
[2023-06-29 07:47:15] [config] transformer-dropout-attention: 0
[2023-06-29 07:47:15] [config] transformer-dropout-ffn: 0
[2023-06-29 07:47:15] [config] transformer-ffn-activation: swish
[2023-06-29 07:47:15] [config] transformer-ffn-depth: 2
[2023-06-29 07:47:15] [config] transformer-guided-alignment-layer: last
[2023-06-29 07:47:15] [config] transformer-heads: 8
[2023-06-29 07:47:15] [config] transformer-no-projection: false
[2023-06-29 07:47:15] [config] transformer-pool: false
[2023-06-29 07:47:15] [config] transformer-postprocess: dan
[2023-06-29 07:47:15] [config] transformer-postprocess-emb: d
[2023-06-29 07:47:15] [config] transformer-postprocess-top: ""
[2023-06-29 07:47:15] [config] transformer-preprocess: ""
[2023-06-29 07:47:15] [config] transformer-tied-layers:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] transformer-train-position-embeddings: false
[2023-06-29 07:47:15] [config] tsv: false
[2023-06-29 07:47:15] [config] tsv-fields: 0
[2023-06-29 07:47:15] [config] type: amun
[2023-06-29 07:47:15] [config] ulr: false
[2023-06-29 07:47:15] [config] ulr-dim-emb: 0
[2023-06-29 07:47:15] [config] ulr-dropout: 0
[2023-06-29 07:47:15] [config] ulr-keys-vectors: ""
[2023-06-29 07:47:15] [config] ulr-query-vectors: ""
[2023-06-29 07:47:15] [config] ulr-softmax-temperature: 1
[2023-06-29 07:47:15] [config] ulr-trainable-transformation: false
[2023-06-29 07:47:15] [config] unlikelihood-loss: false
[2023-06-29 07:47:15] [config] valid-freq: 50000000
[2023-06-29 07:47:15] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 07:47:15] [config] valid-max-length: 1000
[2023-06-29 07:47:15] [config] valid-metrics:
[2023-06-29 07:47:15] [config]   - cross-entropy
[2023-06-29 07:47:15] [config]   - translation
[2023-06-29 07:47:15] [config] valid-mini-batch: 32
[2023-06-29 07:47:15] [config] valid-reset-stalled: false
[2023-06-29 07:47:15] [config] valid-script-args:
[2023-06-29 07:47:15] [config]   []
[2023-06-29 07:47:15] [config] valid-script-path: ""
[2023-06-29 07:47:15] [config] valid-sets:
[2023-06-29 07:47:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 07:47:15] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 07:47:15] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 07:47:15] [config] vocabs:
[2023-06-29 07:47:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 07:47:15] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 07:47:15] [config] word-penalty: 0
[2023-06-29 07:47:15] [config] word-scores: false
[2023-06-29 07:47:15] [config] workspace: 3000
[2023-06-29 07:47:15] [config] Model is being created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 07:47:15] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 07:47:15] [training] Using single-device training
[2023-06-29 07:47:16] Synced seed 1234
[2023-06-29 07:47:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 07:47:16] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 07:47:16] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 07:47:16] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 07:47:16] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 07:47:16] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 07:47:17] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 07:47:18] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 07:47:18] [comm] Using global sharding
[2023-06-29 07:47:18] [comm] NCCLCommunicators constructed successfully
[2023-06-29 07:47:18] [training] Using 1 GPUs
[2023-06-29 07:47:18] [logits] Applying loss function for 1 factor(s)
[2023-06-29 07:47:18] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:47:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 07:47:22] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:47:34] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 07:47:34] [valid] No post-processing script given for validating translator
[2023-06-29 07:47:34] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 07:47:34] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 07:47:34] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 07:47:34] [comm] Using global sharding
[2023-06-29 07:47:34] [comm] NCCLCommunicators constructed successfully
[2023-06-29 07:47:34] [training] Using 1 GPUs
[2023-06-29 07:47:34] Training started
[2023-06-29 07:47:34] [data] Shuffling data
[2023-06-29 07:47:34] [data] Done reading 20,192 sentences
[2023-06-29 07:47:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:47:34] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 07:47:34] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:47:35] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:47:35] Parameter type float32, optimization type float32, casting types false
[2023-06-29 07:47:35] Allocating memory for Adam-specific shards
[2023-06-29 07:47:35] [memory] Reserving 322 MB, device gpu0
[2023-06-29 07:48:09] Seen 16,611 samples
[2023-06-29 07:48:09] Starting data epoch 2 in logical epoch 2
[2023-06-29 07:48:09] [data] Shuffling data
[2023-06-29 07:48:09] [data] Done reading 20,192 sentences
[2023-06-29 07:48:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:48:48] Seen 16,611 samples
[2023-06-29 07:48:48] Starting data epoch 3 in logical epoch 3
[2023-06-29 07:48:48] [data] Shuffling data
[2023-06-29 07:48:48] [data] Done reading 20,192 sentences
[2023-06-29 07:48:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:49:27] Seen 16,611 samples
[2023-06-29 07:49:27] Starting data epoch 4 in logical epoch 4
[2023-06-29 07:49:27] [data] Shuffling data
[2023-06-29 07:49:27] [data] Done reading 20,192 sentences
[2023-06-29 07:49:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:50:06] Seen 16,611 samples
[2023-06-29 07:50:06] Starting data epoch 5 in logical epoch 5
[2023-06-29 07:50:06] [data] Shuffling data
[2023-06-29 07:50:06] [data] Done reading 20,192 sentences
[2023-06-29 07:50:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:50:45] Seen 16,611 samples
[2023-06-29 07:50:45] Starting data epoch 6 in logical epoch 6
[2023-06-29 07:50:45] [data] Shuffling data
[2023-06-29 07:50:45] [data] Done reading 20,192 sentences
[2023-06-29 07:50:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:51:24] Seen 16,611 samples
[2023-06-29 07:51:24] Starting data epoch 7 in logical epoch 7
[2023-06-29 07:51:24] [data] Shuffling data
[2023-06-29 07:51:24] [data] Done reading 20,192 sentences
[2023-06-29 07:51:24] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:52:04] Seen 16,611 samples
[2023-06-29 07:52:04] Starting data epoch 8 in logical epoch 8
[2023-06-29 07:52:04] [data] Shuffling data
[2023-06-29 07:52:04] [data] Done reading 20,192 sentences
[2023-06-29 07:52:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:52:43] Seen 16,611 samples
[2023-06-29 07:52:43] Starting data epoch 9 in logical epoch 9
[2023-06-29 07:52:43] [data] Shuffling data
[2023-06-29 07:52:43] [data] Done reading 20,192 sentences
[2023-06-29 07:52:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:53:22] Seen 16,611 samples
[2023-06-29 07:53:22] Starting data epoch 10 in logical epoch 10
[2023-06-29 07:53:22] [data] Shuffling data
[2023-06-29 07:53:22] [data] Done reading 20,192 sentences
[2023-06-29 07:53:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:53:23] Ep. 10 : Up. 1000 : Sen. 128 : Cost 6.04153490 * 3,112,186 @ 3,685 after 3,112,186 : Time 348.74s : 8924.05 words/s : gNorm 1.1850
[2023-06-29 07:54:01] Seen 16,611 samples
[2023-06-29 07:54:01] Starting data epoch 11 in logical epoch 11
[2023-06-29 07:54:01] Training finished
[2023-06-29 07:54:13] [valid] Ep. 11 : Up. 1110 : cross-entropy : 254.592 : new best
[2023-06-29 07:56:19] [valid] Ep. 11 : Up. 1110 : translation : 0 : new best
[2023-06-29 07:56:19] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 07:56:21] Saving Adam parameters
[2023-06-29 07:56:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 07:56:31] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 07:56:31] [marian] Running on node20.datos.cluster.uy as process 12211 with command line:
[2023-06-29 07:56:31] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 20 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 07:56:31] [config] after: 0e
[2023-06-29 07:56:31] [config] after-batches: 0
[2023-06-29 07:56:31] [config] after-epochs: 20
[2023-06-29 07:56:31] [config] all-caps-every: 0
[2023-06-29 07:56:31] [config] allow-unk: false
[2023-06-29 07:56:31] [config] authors: false
[2023-06-29 07:56:31] [config] beam-size: 6
[2023-06-29 07:56:31] [config] bert-class-symbol: "[CLS]"
[2023-06-29 07:56:31] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 07:56:31] [config] bert-masking-fraction: 0.15
[2023-06-29 07:56:31] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 07:56:31] [config] bert-train-type-embeddings: true
[2023-06-29 07:56:31] [config] bert-type-vocab-size: 2
[2023-06-29 07:56:31] [config] build-info: ""
[2023-06-29 07:56:31] [config] check-gradient-nan: false
[2023-06-29 07:56:31] [config] check-nan: false
[2023-06-29 07:56:31] [config] cite: false
[2023-06-29 07:56:31] [config] clip-norm: 1
[2023-06-29 07:56:31] [config] cost-scaling:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] cost-type: ce-sum
[2023-06-29 07:56:31] [config] cpu-threads: 0
[2023-06-29 07:56:31] [config] data-threads: 8
[2023-06-29 07:56:31] [config] data-weighting: ""
[2023-06-29 07:56:31] [config] data-weighting-type: sentence
[2023-06-29 07:56:31] [config] dec-cell: gru
[2023-06-29 07:56:31] [config] dec-cell-base-depth: 2
[2023-06-29 07:56:31] [config] dec-cell-high-depth: 1
[2023-06-29 07:56:31] [config] dec-depth: 1
[2023-06-29 07:56:31] [config] devices:
[2023-06-29 07:56:31] [config]   - 0
[2023-06-29 07:56:31] [config] dim-emb: 512
[2023-06-29 07:56:31] [config] dim-rnn: 1024
[2023-06-29 07:56:31] [config] dim-vocabs:
[2023-06-29 07:56:31] [config]   - 16384
[2023-06-29 07:56:31] [config]   - 16384
[2023-06-29 07:56:31] [config] disp-first: 0
[2023-06-29 07:56:31] [config] disp-freq: 1000u
[2023-06-29 07:56:31] [config] disp-label-counts: true
[2023-06-29 07:56:31] [config] dropout-rnn: 0.2
[2023-06-29 07:56:31] [config] dropout-src: 0.1
[2023-06-29 07:56:31] [config] dropout-trg: 0.1
[2023-06-29 07:56:31] [config] dump-config: ""
[2023-06-29 07:56:31] [config] dynamic-gradient-scaling:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] early-stopping: 10
[2023-06-29 07:56:31] [config] early-stopping-on: first
[2023-06-29 07:56:31] [config] embedding-fix-src: false
[2023-06-29 07:56:31] [config] embedding-fix-trg: false
[2023-06-29 07:56:31] [config] embedding-normalization: false
[2023-06-29 07:56:31] [config] embedding-vectors:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] enc-cell: gru
[2023-06-29 07:56:31] [config] enc-cell-depth: 1
[2023-06-29 07:56:31] [config] enc-depth: 1
[2023-06-29 07:56:31] [config] enc-type: bidirectional
[2023-06-29 07:56:31] [config] english-title-case-every: 0
[2023-06-29 07:56:31] [config] exponential-smoothing: 0
[2023-06-29 07:56:31] [config] factor-weight: 1
[2023-06-29 07:56:31] [config] factors-combine: sum
[2023-06-29 07:56:31] [config] factors-dim-emb: 0
[2023-06-29 07:56:31] [config] gradient-checkpointing: false
[2023-06-29 07:56:31] [config] gradient-norm-average-window: 100
[2023-06-29 07:56:31] [config] guided-alignment: none
[2023-06-29 07:56:31] [config] guided-alignment-cost: mse
[2023-06-29 07:56:31] [config] guided-alignment-weight: 0.1
[2023-06-29 07:56:31] [config] ignore-model-config: false
[2023-06-29 07:56:31] [config] input-types:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] interpolate-env-vars: false
[2023-06-29 07:56:31] [config] keep-best: false
[2023-06-29 07:56:31] [config] label-smoothing: 0
[2023-06-29 07:56:31] [config] layer-normalization: true
[2023-06-29 07:56:31] [config] learn-rate: 0.0001
[2023-06-29 07:56:31] [config] lemma-dependency: ""
[2023-06-29 07:56:31] [config] lemma-dim-emb: 0
[2023-06-29 07:56:31] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 07:56:31] [config] log-level: info
[2023-06-29 07:56:31] [config] log-time-zone: ""
[2023-06-29 07:56:31] [config] logical-epoch:
[2023-06-29 07:56:31] [config]   - 1e
[2023-06-29 07:56:31] [config]   - 0
[2023-06-29 07:56:31] [config] lr-decay: 0
[2023-06-29 07:56:31] [config] lr-decay-freq: 50000
[2023-06-29 07:56:31] [config] lr-decay-inv-sqrt:
[2023-06-29 07:56:31] [config]   - 0
[2023-06-29 07:56:31] [config] lr-decay-repeat-warmup: false
[2023-06-29 07:56:31] [config] lr-decay-reset-optimizer: false
[2023-06-29 07:56:31] [config] lr-decay-start:
[2023-06-29 07:56:31] [config]   - 10
[2023-06-29 07:56:31] [config]   - 1
[2023-06-29 07:56:31] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 07:56:31] [config] lr-report: false
[2023-06-29 07:56:31] [config] lr-warmup: 0
[2023-06-29 07:56:31] [config] lr-warmup-at-reload: false
[2023-06-29 07:56:31] [config] lr-warmup-cycle: false
[2023-06-29 07:56:31] [config] lr-warmup-start-rate: 0
[2023-06-29 07:56:31] [config] max-length: 50
[2023-06-29 07:56:31] [config] max-length-crop: false
[2023-06-29 07:56:31] [config] max-length-factor: 3
[2023-06-29 07:56:31] [config] maxi-batch: 100
[2023-06-29 07:56:31] [config] maxi-batch-sort: trg
[2023-06-29 07:56:31] [config] mini-batch: 64
[2023-06-29 07:56:31] [config] mini-batch-fit: true
[2023-06-29 07:56:31] [config] mini-batch-fit-step: 10
[2023-06-29 07:56:31] [config] mini-batch-round-up: true
[2023-06-29 07:56:31] [config] mini-batch-track-lr: false
[2023-06-29 07:56:31] [config] mini-batch-warmup: 0
[2023-06-29 07:56:31] [config] mini-batch-words: 0
[2023-06-29 07:56:31] [config] mini-batch-words-ref: 0
[2023-06-29 07:56:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 07:56:31] [config] multi-loss-type: sum
[2023-06-29 07:56:31] [config] n-best: false
[2023-06-29 07:56:31] [config] no-nccl: false
[2023-06-29 07:56:31] [config] no-reload: false
[2023-06-29 07:56:31] [config] no-restore-corpus: false
[2023-06-29 07:56:31] [config] normalize: 0.6
[2023-06-29 07:56:31] [config] normalize-gradient: false
[2023-06-29 07:56:31] [config] num-devices: 0
[2023-06-29 07:56:31] [config] optimizer: adam
[2023-06-29 07:56:31] [config] optimizer-delay: 1
[2023-06-29 07:56:31] [config] optimizer-params:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] output-omit-bias: false
[2023-06-29 07:56:31] [config] overwrite: true
[2023-06-29 07:56:31] [config] precision:
[2023-06-29 07:56:31] [config]   - float32
[2023-06-29 07:56:31] [config]   - float32
[2023-06-29 07:56:31] [config] pretrained-model: ""
[2023-06-29 07:56:31] [config] quantize-biases: false
[2023-06-29 07:56:31] [config] quantize-bits: 0
[2023-06-29 07:56:31] [config] quantize-log-based: false
[2023-06-29 07:56:31] [config] quantize-optimization-steps: 0
[2023-06-29 07:56:31] [config] quiet: false
[2023-06-29 07:56:31] [config] quiet-translation: true
[2023-06-29 07:56:31] [config] relative-paths: false
[2023-06-29 07:56:31] [config] right-left: false
[2023-06-29 07:56:31] [config] save-freq: 10000u
[2023-06-29 07:56:31] [config] seed: 1234
[2023-06-29 07:56:31] [config] sentencepiece-alphas:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] sentencepiece-max-lines: 2000000
[2023-06-29 07:56:31] [config] sentencepiece-options: ""
[2023-06-29 07:56:31] [config] sharding: global
[2023-06-29 07:56:31] [config] shuffle: data
[2023-06-29 07:56:31] [config] shuffle-in-ram: false
[2023-06-29 07:56:31] [config] sigterm: save-and-exit
[2023-06-29 07:56:31] [config] skip: false
[2023-06-29 07:56:31] [config] sqlite: ""
[2023-06-29 07:56:31] [config] sqlite-drop: false
[2023-06-29 07:56:31] [config] sync-freq: 200u
[2023-06-29 07:56:31] [config] sync-sgd: false
[2023-06-29 07:56:31] [config] tempdir: /tmp
[2023-06-29 07:56:31] [config] tied-embeddings: false
[2023-06-29 07:56:31] [config] tied-embeddings-all: true
[2023-06-29 07:56:31] [config] tied-embeddings-src: false
[2023-06-29 07:56:31] [config] train-embedder-rank:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] train-sets:
[2023-06-29 07:56:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 07:56:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 07:56:31] [config] transformer-aan-activation: swish
[2023-06-29 07:56:31] [config] transformer-aan-depth: 2
[2023-06-29 07:56:31] [config] transformer-aan-nogate: false
[2023-06-29 07:56:31] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 07:56:31] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 07:56:31] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 07:56:31] [config] transformer-depth-scaling: false
[2023-06-29 07:56:31] [config] transformer-dim-aan: 2048
[2023-06-29 07:56:31] [config] transformer-dim-ffn: 2048
[2023-06-29 07:56:31] [config] transformer-dropout: 0
[2023-06-29 07:56:31] [config] transformer-dropout-attention: 0
[2023-06-29 07:56:31] [config] transformer-dropout-ffn: 0
[2023-06-29 07:56:31] [config] transformer-ffn-activation: swish
[2023-06-29 07:56:31] [config] transformer-ffn-depth: 2
[2023-06-29 07:56:31] [config] transformer-guided-alignment-layer: last
[2023-06-29 07:56:31] [config] transformer-heads: 8
[2023-06-29 07:56:31] [config] transformer-no-projection: false
[2023-06-29 07:56:31] [config] transformer-pool: false
[2023-06-29 07:56:31] [config] transformer-postprocess: dan
[2023-06-29 07:56:31] [config] transformer-postprocess-emb: d
[2023-06-29 07:56:31] [config] transformer-postprocess-top: ""
[2023-06-29 07:56:31] [config] transformer-preprocess: ""
[2023-06-29 07:56:31] [config] transformer-tied-layers:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] transformer-train-position-embeddings: false
[2023-06-29 07:56:31] [config] tsv: false
[2023-06-29 07:56:31] [config] tsv-fields: 0
[2023-06-29 07:56:31] [config] type: amun
[2023-06-29 07:56:31] [config] ulr: false
[2023-06-29 07:56:31] [config] ulr-dim-emb: 0
[2023-06-29 07:56:31] [config] ulr-dropout: 0
[2023-06-29 07:56:31] [config] ulr-keys-vectors: ""
[2023-06-29 07:56:31] [config] ulr-query-vectors: ""
[2023-06-29 07:56:31] [config] ulr-softmax-temperature: 1
[2023-06-29 07:56:31] [config] ulr-trainable-transformation: false
[2023-06-29 07:56:31] [config] unlikelihood-loss: false
[2023-06-29 07:56:31] [config] valid-freq: 50000000
[2023-06-29 07:56:31] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 07:56:31] [config] valid-max-length: 1000
[2023-06-29 07:56:31] [config] valid-metrics:
[2023-06-29 07:56:31] [config]   - cross-entropy
[2023-06-29 07:56:31] [config]   - translation
[2023-06-29 07:56:31] [config] valid-mini-batch: 32
[2023-06-29 07:56:31] [config] valid-reset-stalled: false
[2023-06-29 07:56:31] [config] valid-script-args:
[2023-06-29 07:56:31] [config]   []
[2023-06-29 07:56:31] [config] valid-script-path: ""
[2023-06-29 07:56:31] [config] valid-sets:
[2023-06-29 07:56:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 07:56:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 07:56:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 07:56:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 07:56:31] [config] vocabs:
[2023-06-29 07:56:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 07:56:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 07:56:31] [config] word-penalty: 0
[2023-06-29 07:56:31] [config] word-scores: false
[2023-06-29 07:56:31] [config] workspace: 3000
[2023-06-29 07:56:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 07:56:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 07:56:31] [training] Using single-device training
[2023-06-29 07:56:32] Synced seed 1234
[2023-06-29 07:56:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 07:56:32] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 07:56:32] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 07:56:32] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 07:56:32] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 07:56:32] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 07:56:33] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 07:56:33] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 07:56:33] [comm] Using global sharding
[2023-06-29 07:56:33] [comm] NCCLCommunicators constructed successfully
[2023-06-29 07:56:33] [training] Using 1 GPUs
[2023-06-29 07:56:33] [logits] Applying loss function for 1 factor(s)
[2023-06-29 07:56:33] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:56:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 07:56:33] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:56:45] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 07:56:46] [valid] No post-processing script given for validating translator
[2023-06-29 07:56:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 07:56:46] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 07:56:46] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 07:56:46] [comm] Using global sharding
[2023-06-29 07:56:46] [comm] NCCLCommunicators constructed successfully
[2023-06-29 07:56:46] [training] Using 1 GPUs
[2023-06-29 07:56:46] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 07:56:47] Loading Adam parameters
[2023-06-29 07:56:47] [memory] Reserving 322 MB, device gpu0
[2023-06-29 07:56:47] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:56:47] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 07:56:47] [data] Restoring the corpus state to epoch 11, batch 1110
[2023-06-29 07:56:47] [data] Shuffling data
[2023-06-29 07:56:47] [data] Done reading 20,192 sentences
[2023-06-29 07:56:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:56:47] Training started
[2023-06-29 07:56:47] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 07:56:47] [memory] Reserving 161 MB, device gpu0
[2023-06-29 07:56:48] Parameter type float32, optimization type float32, casting types false
[2023-06-29 07:57:26] Seen 16,611 samples
[2023-06-29 07:57:26] Starting data epoch 12 in logical epoch 12
[2023-06-29 07:57:26] [data] Shuffling data
[2023-06-29 07:57:26] [data] Done reading 20,192 sentences
[2023-06-29 07:57:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:58:05] Seen 16,611 samples
[2023-06-29 07:58:05] Starting data epoch 13 in logical epoch 13
[2023-06-29 07:58:05] [data] Shuffling data
[2023-06-29 07:58:05] [data] Done reading 20,192 sentences
[2023-06-29 07:58:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:58:44] Seen 16,611 samples
[2023-06-29 07:58:44] Starting data epoch 14 in logical epoch 14
[2023-06-29 07:58:44] [data] Shuffling data
[2023-06-29 07:58:44] [data] Done reading 20,192 sentences
[2023-06-29 07:58:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 07:59:23] Seen 16,611 samples
[2023-06-29 07:59:25] Starting data epoch 15 in logical epoch 15
[2023-06-29 07:59:25] [data] Shuffling data
[2023-06-29 07:59:26] [data] Done reading 20,192 sentences
[2023-06-29 07:59:26] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:00:04] Seen 16,611 samples
[2023-06-29 08:00:04] Starting data epoch 16 in logical epoch 16
[2023-06-29 08:00:04] [data] Shuffling data
[2023-06-29 08:00:04] [data] Done reading 20,192 sentences
[2023-06-29 08:00:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:00:44] Seen 16,611 samples
[2023-06-29 08:00:44] Starting data epoch 17 in logical epoch 17
[2023-06-29 08:00:44] [data] Shuffling data
[2023-06-29 08:00:44] [data] Done reading 20,192 sentences
[2023-06-29 08:00:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:01:23] Seen 16,611 samples
[2023-06-29 08:01:24] Starting data epoch 18 in logical epoch 18
[2023-06-29 08:01:24] [data] Shuffling data
[2023-06-29 08:01:26] [data] Done reading 20,192 sentences
[2023-06-29 08:01:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:02:04] Ep. 18 : Up. 2000 : Sen. 16,483 : Cost 4.64697838 * 3,102,659 @ 2,952 after 6,214,845 : Time 318.68s : 9735.85 words/s : gNorm 1.5759
[2023-06-29 08:02:04] Seen 16,611 samples
[2023-06-29 08:02:04] Starting data epoch 19 in logical epoch 19
[2023-06-29 08:02:04] [data] Shuffling data
[2023-06-29 08:02:04] [data] Done reading 20,192 sentences
[2023-06-29 08:02:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:02:44] Seen 16,611 samples
[2023-06-29 08:02:44] Starting data epoch 20 in logical epoch 20
[2023-06-29 08:02:44] [data] Shuffling data
[2023-06-29 08:02:44] [data] Done reading 20,192 sentences
[2023-06-29 08:02:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:03:23] Seen 16,611 samples
[2023-06-29 08:03:25] Starting data epoch 21 in logical epoch 21
[2023-06-29 08:03:25] Training finished
[2023-06-29 08:03:37] [valid] Ep. 21 : Up. 2224 : cross-entropy : 245.318 : new best
[2023-06-29 08:04:56] [valid] Ep. 21 : Up. 2224 : translation : 0 : new best
[2023-06-29 08:04:56] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:04:57] Saving Adam parameters
[2023-06-29 08:04:58] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:05:05] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:05:05] [marian] Running on node20.datos.cluster.uy as process 12724 with command line:
[2023-06-29 08:05:05] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 30 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:05:05] [config] after: 0e
[2023-06-29 08:05:05] [config] after-batches: 0
[2023-06-29 08:05:05] [config] after-epochs: 30
[2023-06-29 08:05:05] [config] all-caps-every: 0
[2023-06-29 08:05:05] [config] allow-unk: false
[2023-06-29 08:05:05] [config] authors: false
[2023-06-29 08:05:05] [config] beam-size: 6
[2023-06-29 08:05:05] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:05:05] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:05:05] [config] bert-masking-fraction: 0.15
[2023-06-29 08:05:05] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:05:05] [config] bert-train-type-embeddings: true
[2023-06-29 08:05:05] [config] bert-type-vocab-size: 2
[2023-06-29 08:05:05] [config] build-info: ""
[2023-06-29 08:05:05] [config] check-gradient-nan: false
[2023-06-29 08:05:05] [config] check-nan: false
[2023-06-29 08:05:05] [config] cite: false
[2023-06-29 08:05:05] [config] clip-norm: 1
[2023-06-29 08:05:05] [config] cost-scaling:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] cost-type: ce-sum
[2023-06-29 08:05:05] [config] cpu-threads: 0
[2023-06-29 08:05:05] [config] data-threads: 8
[2023-06-29 08:05:05] [config] data-weighting: ""
[2023-06-29 08:05:05] [config] data-weighting-type: sentence
[2023-06-29 08:05:05] [config] dec-cell: gru
[2023-06-29 08:05:05] [config] dec-cell-base-depth: 2
[2023-06-29 08:05:05] [config] dec-cell-high-depth: 1
[2023-06-29 08:05:05] [config] dec-depth: 1
[2023-06-29 08:05:05] [config] devices:
[2023-06-29 08:05:05] [config]   - 0
[2023-06-29 08:05:05] [config] dim-emb: 512
[2023-06-29 08:05:05] [config] dim-rnn: 1024
[2023-06-29 08:05:05] [config] dim-vocabs:
[2023-06-29 08:05:05] [config]   - 16384
[2023-06-29 08:05:05] [config]   - 16384
[2023-06-29 08:05:05] [config] disp-first: 0
[2023-06-29 08:05:05] [config] disp-freq: 1000u
[2023-06-29 08:05:05] [config] disp-label-counts: true
[2023-06-29 08:05:05] [config] dropout-rnn: 0.2
[2023-06-29 08:05:05] [config] dropout-src: 0.1
[2023-06-29 08:05:05] [config] dropout-trg: 0.1
[2023-06-29 08:05:05] [config] dump-config: ""
[2023-06-29 08:05:05] [config] dynamic-gradient-scaling:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] early-stopping: 10
[2023-06-29 08:05:05] [config] early-stopping-on: first
[2023-06-29 08:05:05] [config] embedding-fix-src: false
[2023-06-29 08:05:05] [config] embedding-fix-trg: false
[2023-06-29 08:05:05] [config] embedding-normalization: false
[2023-06-29 08:05:05] [config] embedding-vectors:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] enc-cell: gru
[2023-06-29 08:05:05] [config] enc-cell-depth: 1
[2023-06-29 08:05:05] [config] enc-depth: 1
[2023-06-29 08:05:05] [config] enc-type: bidirectional
[2023-06-29 08:05:05] [config] english-title-case-every: 0
[2023-06-29 08:05:05] [config] exponential-smoothing: 0
[2023-06-29 08:05:05] [config] factor-weight: 1
[2023-06-29 08:05:05] [config] factors-combine: sum
[2023-06-29 08:05:05] [config] factors-dim-emb: 0
[2023-06-29 08:05:05] [config] gradient-checkpointing: false
[2023-06-29 08:05:05] [config] gradient-norm-average-window: 100
[2023-06-29 08:05:05] [config] guided-alignment: none
[2023-06-29 08:05:05] [config] guided-alignment-cost: mse
[2023-06-29 08:05:05] [config] guided-alignment-weight: 0.1
[2023-06-29 08:05:05] [config] ignore-model-config: false
[2023-06-29 08:05:05] [config] input-types:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] interpolate-env-vars: false
[2023-06-29 08:05:05] [config] keep-best: false
[2023-06-29 08:05:05] [config] label-smoothing: 0
[2023-06-29 08:05:05] [config] layer-normalization: true
[2023-06-29 08:05:05] [config] learn-rate: 0.0001
[2023-06-29 08:05:05] [config] lemma-dependency: ""
[2023-06-29 08:05:05] [config] lemma-dim-emb: 0
[2023-06-29 08:05:05] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:05:05] [config] log-level: info
[2023-06-29 08:05:05] [config] log-time-zone: ""
[2023-06-29 08:05:05] [config] logical-epoch:
[2023-06-29 08:05:05] [config]   - 1e
[2023-06-29 08:05:05] [config]   - 0
[2023-06-29 08:05:05] [config] lr-decay: 0
[2023-06-29 08:05:05] [config] lr-decay-freq: 50000
[2023-06-29 08:05:05] [config] lr-decay-inv-sqrt:
[2023-06-29 08:05:05] [config]   - 0
[2023-06-29 08:05:05] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:05:05] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:05:05] [config] lr-decay-start:
[2023-06-29 08:05:05] [config]   - 10
[2023-06-29 08:05:05] [config]   - 1
[2023-06-29 08:05:05] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:05:05] [config] lr-report: false
[2023-06-29 08:05:05] [config] lr-warmup: 0
[2023-06-29 08:05:05] [config] lr-warmup-at-reload: false
[2023-06-29 08:05:05] [config] lr-warmup-cycle: false
[2023-06-29 08:05:05] [config] lr-warmup-start-rate: 0
[2023-06-29 08:05:05] [config] max-length: 50
[2023-06-29 08:05:05] [config] max-length-crop: false
[2023-06-29 08:05:05] [config] max-length-factor: 3
[2023-06-29 08:05:05] [config] maxi-batch: 100
[2023-06-29 08:05:05] [config] maxi-batch-sort: trg
[2023-06-29 08:05:05] [config] mini-batch: 64
[2023-06-29 08:05:05] [config] mini-batch-fit: true
[2023-06-29 08:05:05] [config] mini-batch-fit-step: 10
[2023-06-29 08:05:05] [config] mini-batch-round-up: true
[2023-06-29 08:05:05] [config] mini-batch-track-lr: false
[2023-06-29 08:05:05] [config] mini-batch-warmup: 0
[2023-06-29 08:05:05] [config] mini-batch-words: 0
[2023-06-29 08:05:05] [config] mini-batch-words-ref: 0
[2023-06-29 08:05:05] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:05:05] [config] multi-loss-type: sum
[2023-06-29 08:05:05] [config] n-best: false
[2023-06-29 08:05:05] [config] no-nccl: false
[2023-06-29 08:05:05] [config] no-reload: false
[2023-06-29 08:05:05] [config] no-restore-corpus: false
[2023-06-29 08:05:05] [config] normalize: 0.6
[2023-06-29 08:05:05] [config] normalize-gradient: false
[2023-06-29 08:05:05] [config] num-devices: 0
[2023-06-29 08:05:05] [config] optimizer: adam
[2023-06-29 08:05:05] [config] optimizer-delay: 1
[2023-06-29 08:05:05] [config] optimizer-params:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] output-omit-bias: false
[2023-06-29 08:05:05] [config] overwrite: true
[2023-06-29 08:05:05] [config] precision:
[2023-06-29 08:05:05] [config]   - float32
[2023-06-29 08:05:05] [config]   - float32
[2023-06-29 08:05:05] [config] pretrained-model: ""
[2023-06-29 08:05:05] [config] quantize-biases: false
[2023-06-29 08:05:05] [config] quantize-bits: 0
[2023-06-29 08:05:05] [config] quantize-log-based: false
[2023-06-29 08:05:05] [config] quantize-optimization-steps: 0
[2023-06-29 08:05:05] [config] quiet: false
[2023-06-29 08:05:05] [config] quiet-translation: true
[2023-06-29 08:05:05] [config] relative-paths: false
[2023-06-29 08:05:05] [config] right-left: false
[2023-06-29 08:05:05] [config] save-freq: 10000u
[2023-06-29 08:05:05] [config] seed: 1234
[2023-06-29 08:05:05] [config] sentencepiece-alphas:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:05:05] [config] sentencepiece-options: ""
[2023-06-29 08:05:05] [config] sharding: global
[2023-06-29 08:05:05] [config] shuffle: data
[2023-06-29 08:05:05] [config] shuffle-in-ram: false
[2023-06-29 08:05:05] [config] sigterm: save-and-exit
[2023-06-29 08:05:05] [config] skip: false
[2023-06-29 08:05:05] [config] sqlite: ""
[2023-06-29 08:05:05] [config] sqlite-drop: false
[2023-06-29 08:05:05] [config] sync-freq: 200u
[2023-06-29 08:05:05] [config] sync-sgd: false
[2023-06-29 08:05:05] [config] tempdir: /tmp
[2023-06-29 08:05:05] [config] tied-embeddings: false
[2023-06-29 08:05:05] [config] tied-embeddings-all: true
[2023-06-29 08:05:05] [config] tied-embeddings-src: false
[2023-06-29 08:05:05] [config] train-embedder-rank:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] train-sets:
[2023-06-29 08:05:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:05:05] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:05:05] [config] transformer-aan-activation: swish
[2023-06-29 08:05:05] [config] transformer-aan-depth: 2
[2023-06-29 08:05:05] [config] transformer-aan-nogate: false
[2023-06-29 08:05:05] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:05:05] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:05:05] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:05:05] [config] transformer-depth-scaling: false
[2023-06-29 08:05:05] [config] transformer-dim-aan: 2048
[2023-06-29 08:05:05] [config] transformer-dim-ffn: 2048
[2023-06-29 08:05:05] [config] transformer-dropout: 0
[2023-06-29 08:05:05] [config] transformer-dropout-attention: 0
[2023-06-29 08:05:05] [config] transformer-dropout-ffn: 0
[2023-06-29 08:05:05] [config] transformer-ffn-activation: swish
[2023-06-29 08:05:05] [config] transformer-ffn-depth: 2
[2023-06-29 08:05:05] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:05:05] [config] transformer-heads: 8
[2023-06-29 08:05:05] [config] transformer-no-projection: false
[2023-06-29 08:05:05] [config] transformer-pool: false
[2023-06-29 08:05:05] [config] transformer-postprocess: dan
[2023-06-29 08:05:05] [config] transformer-postprocess-emb: d
[2023-06-29 08:05:05] [config] transformer-postprocess-top: ""
[2023-06-29 08:05:05] [config] transformer-preprocess: ""
[2023-06-29 08:05:05] [config] transformer-tied-layers:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] transformer-train-position-embeddings: false
[2023-06-29 08:05:05] [config] tsv: false
[2023-06-29 08:05:05] [config] tsv-fields: 0
[2023-06-29 08:05:05] [config] type: amun
[2023-06-29 08:05:05] [config] ulr: false
[2023-06-29 08:05:05] [config] ulr-dim-emb: 0
[2023-06-29 08:05:05] [config] ulr-dropout: 0
[2023-06-29 08:05:05] [config] ulr-keys-vectors: ""
[2023-06-29 08:05:05] [config] ulr-query-vectors: ""
[2023-06-29 08:05:05] [config] ulr-softmax-temperature: 1
[2023-06-29 08:05:05] [config] ulr-trainable-transformation: false
[2023-06-29 08:05:05] [config] unlikelihood-loss: false
[2023-06-29 08:05:05] [config] valid-freq: 50000000
[2023-06-29 08:05:05] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:05:05] [config] valid-max-length: 1000
[2023-06-29 08:05:05] [config] valid-metrics:
[2023-06-29 08:05:05] [config]   - cross-entropy
[2023-06-29 08:05:05] [config]   - translation
[2023-06-29 08:05:05] [config] valid-mini-batch: 32
[2023-06-29 08:05:05] [config] valid-reset-stalled: false
[2023-06-29 08:05:05] [config] valid-script-args:
[2023-06-29 08:05:05] [config]   []
[2023-06-29 08:05:05] [config] valid-script-path: ""
[2023-06-29 08:05:05] [config] valid-sets:
[2023-06-29 08:05:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:05:05] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:05:05] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:05:05] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:05:05] [config] vocabs:
[2023-06-29 08:05:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:05:05] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:05:05] [config] word-penalty: 0
[2023-06-29 08:05:05] [config] word-scores: false
[2023-06-29 08:05:05] [config] workspace: 3000
[2023-06-29 08:05:05] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:05:05] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:05:05] [training] Using single-device training
[2023-06-29 08:05:05] Synced seed 1234
[2023-06-29 08:05:05] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:05:06] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:05:06] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:05:06] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:05:06] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:05:06] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:05:06] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:05:07] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:05:07] [comm] Using global sharding
[2023-06-29 08:05:07] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:05:07] [training] Using 1 GPUs
[2023-06-29 08:05:07] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:05:07] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:05:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:05:07] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:05:19] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:05:19] [valid] No post-processing script given for validating translator
[2023-06-29 08:05:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:05:19] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:05:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:05:19] [comm] Using global sharding
[2023-06-29 08:05:19] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:05:19] [training] Using 1 GPUs
[2023-06-29 08:05:19] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:05:20] Loading Adam parameters
[2023-06-29 08:05:20] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:05:21] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:05:21] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:05:21] [data] Restoring the corpus state to epoch 21, batch 2224
[2023-06-29 08:05:21] [data] Shuffling data
[2023-06-29 08:05:21] [data] Done reading 20,192 sentences
[2023-06-29 08:05:21] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:05:21] Training started
[2023-06-29 08:05:21] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:05:21] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:05:21] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:05:59] Seen 16,611 samples
[2023-06-29 08:05:59] Starting data epoch 22 in logical epoch 22
[2023-06-29 08:05:59] [data] Shuffling data
[2023-06-29 08:05:59] [data] Done reading 20,192 sentences
[2023-06-29 08:05:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:06:38] Seen 16,611 samples
[2023-06-29 08:06:38] Starting data epoch 23 in logical epoch 23
[2023-06-29 08:06:38] [data] Shuffling data
[2023-06-29 08:06:38] [data] Done reading 20,192 sentences
[2023-06-29 08:06:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:07:18] Seen 16,611 samples
[2023-06-29 08:07:18] Starting data epoch 24 in logical epoch 24
[2023-06-29 08:07:18] [data] Shuffling data
[2023-06-29 08:07:18] [data] Done reading 20,192 sentences
[2023-06-29 08:07:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:07:57] Seen 16,611 samples
[2023-06-29 08:07:57] Starting data epoch 25 in logical epoch 25
[2023-06-29 08:07:57] [data] Shuffling data
[2023-06-29 08:07:57] [data] Done reading 20,192 sentences
[2023-06-29 08:07:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:08:36] Seen 16,611 samples
[2023-06-29 08:08:36] Starting data epoch 26 in logical epoch 26
[2023-06-29 08:08:36] [data] Shuffling data
[2023-06-29 08:08:36] [data] Done reading 20,192 sentences
[2023-06-29 08:08:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:09:16] Seen 16,611 samples
[2023-06-29 08:09:16] Starting data epoch 27 in logical epoch 27
[2023-06-29 08:09:16] [data] Shuffling data
[2023-06-29 08:09:16] [data] Done reading 20,192 sentences
[2023-06-29 08:09:16] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:09:53] Ep. 27 : Up. 3000 : Sen. 16,034 : Cost 3.79131627 * 3,096,146 @ 1,811 after 9,310,991 : Time 274.31s : 11287.14 words/s : gNorm 1.4399
[2023-06-29 08:09:55] Seen 16,611 samples
[2023-06-29 08:09:55] Starting data epoch 28 in logical epoch 28
[2023-06-29 08:09:55] [data] Shuffling data
[2023-06-29 08:09:55] [data] Done reading 20,192 sentences
[2023-06-29 08:09:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:10:34] Seen 16,611 samples
[2023-06-29 08:10:34] Starting data epoch 29 in logical epoch 29
[2023-06-29 08:10:34] [data] Shuffling data
[2023-06-29 08:10:34] [data] Done reading 20,192 sentences
[2023-06-29 08:10:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:11:14] Seen 16,611 samples
[2023-06-29 08:11:14] Starting data epoch 30 in logical epoch 30
[2023-06-29 08:11:14] [data] Shuffling data
[2023-06-29 08:11:14] [data] Done reading 20,192 sentences
[2023-06-29 08:11:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:11:53] Seen 16,611 samples
[2023-06-29 08:11:53] Starting data epoch 31 in logical epoch 31
[2023-06-29 08:11:53] Training finished
[2023-06-29 08:12:05] [valid] Ep. 31 : Up. 3341 : cross-entropy : 240.973 : new best
[2023-06-29 08:13:27] [valid] Ep. 31 : Up. 3341 : translation : 0 : new best
[2023-06-29 08:13:27] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:13:29] Saving Adam parameters
[2023-06-29 08:13:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:13:51] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:13:51] [marian] Running on node20.datos.cluster.uy as process 13551 with command line:
[2023-06-29 08:13:51] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 40 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:13:51] [config] after: 0e
[2023-06-29 08:13:51] [config] after-batches: 0
[2023-06-29 08:13:51] [config] after-epochs: 40
[2023-06-29 08:13:51] [config] all-caps-every: 0
[2023-06-29 08:13:51] [config] allow-unk: false
[2023-06-29 08:13:51] [config] authors: false
[2023-06-29 08:13:51] [config] beam-size: 6
[2023-06-29 08:13:51] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:13:51] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:13:51] [config] bert-masking-fraction: 0.15
[2023-06-29 08:13:51] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:13:51] [config] bert-train-type-embeddings: true
[2023-06-29 08:13:51] [config] bert-type-vocab-size: 2
[2023-06-29 08:13:51] [config] build-info: ""
[2023-06-29 08:13:51] [config] check-gradient-nan: false
[2023-06-29 08:13:51] [config] check-nan: false
[2023-06-29 08:13:51] [config] cite: false
[2023-06-29 08:13:51] [config] clip-norm: 1
[2023-06-29 08:13:51] [config] cost-scaling:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] cost-type: ce-sum
[2023-06-29 08:13:51] [config] cpu-threads: 0
[2023-06-29 08:13:51] [config] data-threads: 8
[2023-06-29 08:13:51] [config] data-weighting: ""
[2023-06-29 08:13:51] [config] data-weighting-type: sentence
[2023-06-29 08:13:51] [config] dec-cell: gru
[2023-06-29 08:13:51] [config] dec-cell-base-depth: 2
[2023-06-29 08:13:51] [config] dec-cell-high-depth: 1
[2023-06-29 08:13:51] [config] dec-depth: 1
[2023-06-29 08:13:51] [config] devices:
[2023-06-29 08:13:51] [config]   - 0
[2023-06-29 08:13:51] [config] dim-emb: 512
[2023-06-29 08:13:51] [config] dim-rnn: 1024
[2023-06-29 08:13:51] [config] dim-vocabs:
[2023-06-29 08:13:51] [config]   - 16384
[2023-06-29 08:13:51] [config]   - 16384
[2023-06-29 08:13:51] [config] disp-first: 0
[2023-06-29 08:13:51] [config] disp-freq: 1000u
[2023-06-29 08:13:51] [config] disp-label-counts: true
[2023-06-29 08:13:51] [config] dropout-rnn: 0.2
[2023-06-29 08:13:51] [config] dropout-src: 0.1
[2023-06-29 08:13:51] [config] dropout-trg: 0.1
[2023-06-29 08:13:51] [config] dump-config: ""
[2023-06-29 08:13:51] [config] dynamic-gradient-scaling:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] early-stopping: 10
[2023-06-29 08:13:51] [config] early-stopping-on: first
[2023-06-29 08:13:51] [config] embedding-fix-src: false
[2023-06-29 08:13:51] [config] embedding-fix-trg: false
[2023-06-29 08:13:51] [config] embedding-normalization: false
[2023-06-29 08:13:51] [config] embedding-vectors:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] enc-cell: gru
[2023-06-29 08:13:51] [config] enc-cell-depth: 1
[2023-06-29 08:13:51] [config] enc-depth: 1
[2023-06-29 08:13:51] [config] enc-type: bidirectional
[2023-06-29 08:13:51] [config] english-title-case-every: 0
[2023-06-29 08:13:51] [config] exponential-smoothing: 0
[2023-06-29 08:13:51] [config] factor-weight: 1
[2023-06-29 08:13:51] [config] factors-combine: sum
[2023-06-29 08:13:51] [config] factors-dim-emb: 0
[2023-06-29 08:13:51] [config] gradient-checkpointing: false
[2023-06-29 08:13:51] [config] gradient-norm-average-window: 100
[2023-06-29 08:13:51] [config] guided-alignment: none
[2023-06-29 08:13:51] [config] guided-alignment-cost: mse
[2023-06-29 08:13:51] [config] guided-alignment-weight: 0.1
[2023-06-29 08:13:51] [config] ignore-model-config: false
[2023-06-29 08:13:51] [config] input-types:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] interpolate-env-vars: false
[2023-06-29 08:13:51] [config] keep-best: false
[2023-06-29 08:13:51] [config] label-smoothing: 0
[2023-06-29 08:13:51] [config] layer-normalization: true
[2023-06-29 08:13:51] [config] learn-rate: 0.0001
[2023-06-29 08:13:51] [config] lemma-dependency: ""
[2023-06-29 08:13:51] [config] lemma-dim-emb: 0
[2023-06-29 08:13:51] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:13:51] [config] log-level: info
[2023-06-29 08:13:51] [config] log-time-zone: ""
[2023-06-29 08:13:51] [config] logical-epoch:
[2023-06-29 08:13:51] [config]   - 1e
[2023-06-29 08:13:51] [config]   - 0
[2023-06-29 08:13:51] [config] lr-decay: 0
[2023-06-29 08:13:51] [config] lr-decay-freq: 50000
[2023-06-29 08:13:51] [config] lr-decay-inv-sqrt:
[2023-06-29 08:13:51] [config]   - 0
[2023-06-29 08:13:51] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:13:51] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:13:51] [config] lr-decay-start:
[2023-06-29 08:13:51] [config]   - 10
[2023-06-29 08:13:51] [config]   - 1
[2023-06-29 08:13:51] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:13:51] [config] lr-report: false
[2023-06-29 08:13:51] [config] lr-warmup: 0
[2023-06-29 08:13:51] [config] lr-warmup-at-reload: false
[2023-06-29 08:13:51] [config] lr-warmup-cycle: false
[2023-06-29 08:13:51] [config] lr-warmup-start-rate: 0
[2023-06-29 08:13:51] [config] max-length: 50
[2023-06-29 08:13:51] [config] max-length-crop: false
[2023-06-29 08:13:51] [config] max-length-factor: 3
[2023-06-29 08:13:51] [config] maxi-batch: 100
[2023-06-29 08:13:51] [config] maxi-batch-sort: trg
[2023-06-29 08:13:51] [config] mini-batch: 64
[2023-06-29 08:13:51] [config] mini-batch-fit: true
[2023-06-29 08:13:51] [config] mini-batch-fit-step: 10
[2023-06-29 08:13:51] [config] mini-batch-round-up: true
[2023-06-29 08:13:51] [config] mini-batch-track-lr: false
[2023-06-29 08:13:51] [config] mini-batch-warmup: 0
[2023-06-29 08:13:51] [config] mini-batch-words: 0
[2023-06-29 08:13:51] [config] mini-batch-words-ref: 0
[2023-06-29 08:13:51] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:13:51] [config] multi-loss-type: sum
[2023-06-29 08:13:51] [config] n-best: false
[2023-06-29 08:13:51] [config] no-nccl: false
[2023-06-29 08:13:51] [config] no-reload: false
[2023-06-29 08:13:51] [config] no-restore-corpus: false
[2023-06-29 08:13:51] [config] normalize: 0.6
[2023-06-29 08:13:51] [config] normalize-gradient: false
[2023-06-29 08:13:51] [config] num-devices: 0
[2023-06-29 08:13:51] [config] optimizer: adam
[2023-06-29 08:13:51] [config] optimizer-delay: 1
[2023-06-29 08:13:51] [config] optimizer-params:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] output-omit-bias: false
[2023-06-29 08:13:51] [config] overwrite: true
[2023-06-29 08:13:51] [config] precision:
[2023-06-29 08:13:51] [config]   - float32
[2023-06-29 08:13:51] [config]   - float32
[2023-06-29 08:13:51] [config] pretrained-model: ""
[2023-06-29 08:13:51] [config] quantize-biases: false
[2023-06-29 08:13:51] [config] quantize-bits: 0
[2023-06-29 08:13:51] [config] quantize-log-based: false
[2023-06-29 08:13:51] [config] quantize-optimization-steps: 0
[2023-06-29 08:13:51] [config] quiet: false
[2023-06-29 08:13:51] [config] quiet-translation: true
[2023-06-29 08:13:51] [config] relative-paths: false
[2023-06-29 08:13:51] [config] right-left: false
[2023-06-29 08:13:51] [config] save-freq: 10000u
[2023-06-29 08:13:51] [config] seed: 1234
[2023-06-29 08:13:51] [config] sentencepiece-alphas:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:13:51] [config] sentencepiece-options: ""
[2023-06-29 08:13:51] [config] sharding: global
[2023-06-29 08:13:51] [config] shuffle: data
[2023-06-29 08:13:51] [config] shuffle-in-ram: false
[2023-06-29 08:13:51] [config] sigterm: save-and-exit
[2023-06-29 08:13:51] [config] skip: false
[2023-06-29 08:13:51] [config] sqlite: ""
[2023-06-29 08:13:51] [config] sqlite-drop: false
[2023-06-29 08:13:51] [config] sync-freq: 200u
[2023-06-29 08:13:51] [config] sync-sgd: false
[2023-06-29 08:13:51] [config] tempdir: /tmp
[2023-06-29 08:13:51] [config] tied-embeddings: false
[2023-06-29 08:13:51] [config] tied-embeddings-all: true
[2023-06-29 08:13:51] [config] tied-embeddings-src: false
[2023-06-29 08:13:51] [config] train-embedder-rank:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] train-sets:
[2023-06-29 08:13:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:13:51] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:13:51] [config] transformer-aan-activation: swish
[2023-06-29 08:13:51] [config] transformer-aan-depth: 2
[2023-06-29 08:13:51] [config] transformer-aan-nogate: false
[2023-06-29 08:13:51] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:13:51] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:13:51] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:13:51] [config] transformer-depth-scaling: false
[2023-06-29 08:13:51] [config] transformer-dim-aan: 2048
[2023-06-29 08:13:51] [config] transformer-dim-ffn: 2048
[2023-06-29 08:13:51] [config] transformer-dropout: 0
[2023-06-29 08:13:51] [config] transformer-dropout-attention: 0
[2023-06-29 08:13:51] [config] transformer-dropout-ffn: 0
[2023-06-29 08:13:51] [config] transformer-ffn-activation: swish
[2023-06-29 08:13:51] [config] transformer-ffn-depth: 2
[2023-06-29 08:13:51] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:13:51] [config] transformer-heads: 8
[2023-06-29 08:13:51] [config] transformer-no-projection: false
[2023-06-29 08:13:51] [config] transformer-pool: false
[2023-06-29 08:13:51] [config] transformer-postprocess: dan
[2023-06-29 08:13:51] [config] transformer-postprocess-emb: d
[2023-06-29 08:13:51] [config] transformer-postprocess-top: ""
[2023-06-29 08:13:51] [config] transformer-preprocess: ""
[2023-06-29 08:13:51] [config] transformer-tied-layers:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] transformer-train-position-embeddings: false
[2023-06-29 08:13:51] [config] tsv: false
[2023-06-29 08:13:51] [config] tsv-fields: 0
[2023-06-29 08:13:51] [config] type: amun
[2023-06-29 08:13:51] [config] ulr: false
[2023-06-29 08:13:51] [config] ulr-dim-emb: 0
[2023-06-29 08:13:51] [config] ulr-dropout: 0
[2023-06-29 08:13:51] [config] ulr-keys-vectors: ""
[2023-06-29 08:13:51] [config] ulr-query-vectors: ""
[2023-06-29 08:13:51] [config] ulr-softmax-temperature: 1
[2023-06-29 08:13:51] [config] ulr-trainable-transformation: false
[2023-06-29 08:13:51] [config] unlikelihood-loss: false
[2023-06-29 08:13:51] [config] valid-freq: 50000000
[2023-06-29 08:13:51] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:13:51] [config] valid-max-length: 1000
[2023-06-29 08:13:51] [config] valid-metrics:
[2023-06-29 08:13:51] [config]   - cross-entropy
[2023-06-29 08:13:51] [config]   - translation
[2023-06-29 08:13:51] [config] valid-mini-batch: 32
[2023-06-29 08:13:51] [config] valid-reset-stalled: false
[2023-06-29 08:13:51] [config] valid-script-args:
[2023-06-29 08:13:51] [config]   []
[2023-06-29 08:13:51] [config] valid-script-path: ""
[2023-06-29 08:13:51] [config] valid-sets:
[2023-06-29 08:13:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:13:51] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:13:51] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:13:51] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:13:51] [config] vocabs:
[2023-06-29 08:13:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:13:51] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:13:51] [config] word-penalty: 0
[2023-06-29 08:13:51] [config] word-scores: false
[2023-06-29 08:13:51] [config] workspace: 3000
[2023-06-29 08:13:51] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:13:51] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:13:51] [training] Using single-device training
[2023-06-29 08:13:58] Synced seed 1234
[2023-06-29 08:13:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:13:58] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:13:58] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:13:58] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:13:58] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:13:58] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:13:59] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:13:59] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:13:59] [comm] Using global sharding
[2023-06-29 08:13:59] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:13:59] [training] Using 1 GPUs
[2023-06-29 08:13:59] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:13:59] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:13:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:13:59] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:14:12] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:14:12] [valid] No post-processing script given for validating translator
[2023-06-29 08:14:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:14:12] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:14:12] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:14:12] [comm] Using global sharding
[2023-06-29 08:14:12] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:14:12] [training] Using 1 GPUs
[2023-06-29 08:14:12] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:14:13] Loading Adam parameters
[2023-06-29 08:14:13] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:14:13] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:14:13] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:14:13] [data] Restoring the corpus state to epoch 31, batch 3341
[2023-06-29 08:14:13] [data] Shuffling data
[2023-06-29 08:14:13] [data] Done reading 20,192 sentences
[2023-06-29 08:14:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:14:13] Training started
[2023-06-29 08:14:13] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:14:13] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:14:14] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:14:49] Seen 16,611 samples
[2023-06-29 08:14:49] Starting data epoch 32 in logical epoch 32
[2023-06-29 08:14:49] [data] Shuffling data
[2023-06-29 08:14:49] [data] Done reading 20,192 sentences
[2023-06-29 08:14:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:15:27] Seen 16,611 samples
[2023-06-29 08:15:27] Starting data epoch 33 in logical epoch 33
[2023-06-29 08:15:27] [data] Shuffling data
[2023-06-29 08:15:27] [data] Done reading 20,192 sentences
[2023-06-29 08:15:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:16:06] Seen 16,611 samples
[2023-06-29 08:16:06] Starting data epoch 34 in logical epoch 34
[2023-06-29 08:16:06] [data] Shuffling data
[2023-06-29 08:16:06] [data] Done reading 20,192 sentences
[2023-06-29 08:16:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:16:45] Seen 16,611 samples
[2023-06-29 08:16:45] Starting data epoch 35 in logical epoch 35
[2023-06-29 08:16:45] [data] Shuffling data
[2023-06-29 08:16:45] [data] Done reading 20,192 sentences
[2023-06-29 08:16:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:17:24] Seen 16,611 samples
[2023-06-29 08:17:24] Starting data epoch 36 in logical epoch 36
[2023-06-29 08:17:24] [data] Shuffling data
[2023-06-29 08:17:25] [data] Done reading 20,192 sentences
[2023-06-29 08:17:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:18:00] Ep. 36 : Up. 4000 : Sen. 15,271 : Cost 3.15337706 * 3,090,291 @ 4,934 after 12,401,282 : Time 228.49s : 13525.12 words/s : gNorm 1.4012
[2023-06-29 08:18:04] Seen 16,611 samples
[2023-06-29 08:18:04] Starting data epoch 37 in logical epoch 37
[2023-06-29 08:18:04] [data] Shuffling data
[2023-06-29 08:18:04] [data] Done reading 20,192 sentences
[2023-06-29 08:18:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:18:44] Seen 16,611 samples
[2023-06-29 08:18:44] Starting data epoch 38 in logical epoch 38
[2023-06-29 08:18:44] [data] Shuffling data
[2023-06-29 08:18:44] [data] Done reading 20,192 sentences
[2023-06-29 08:18:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:19:23] Seen 16,611 samples
[2023-06-29 08:19:23] Starting data epoch 39 in logical epoch 39
[2023-06-29 08:19:23] [data] Shuffling data
[2023-06-29 08:19:23] [data] Done reading 20,192 sentences
[2023-06-29 08:19:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:20:02] Seen 16,611 samples
[2023-06-29 08:20:02] Starting data epoch 40 in logical epoch 40
[2023-06-29 08:20:02] [data] Shuffling data
[2023-06-29 08:20:02] [data] Done reading 20,192 sentences
[2023-06-29 08:20:02] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:20:42] Seen 16,611 samples
[2023-06-29 08:20:42] Starting data epoch 41 in logical epoch 41
[2023-06-29 08:20:42] Training finished
[2023-06-29 08:20:54] [valid] Ep. 41 : Up. 4458 : cross-entropy : 244.02 : stalled 1 times (last best: 240.973)
[2023-06-29 08:22:03] [valid] Ep. 41 : Up. 4458 : translation : 0 : new best
[2023-06-29 08:22:03] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:22:04] Saving Adam parameters
[2023-06-29 08:22:05] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:22:12] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:22:12] [marian] Running on node20.datos.cluster.uy as process 14047 with command line:
[2023-06-29 08:22:12] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 50 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:22:12] [config] after: 0e
[2023-06-29 08:22:12] [config] after-batches: 0
[2023-06-29 08:22:12] [config] after-epochs: 50
[2023-06-29 08:22:12] [config] all-caps-every: 0
[2023-06-29 08:22:12] [config] allow-unk: false
[2023-06-29 08:22:12] [config] authors: false
[2023-06-29 08:22:12] [config] beam-size: 6
[2023-06-29 08:22:12] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:22:12] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:22:12] [config] bert-masking-fraction: 0.15
[2023-06-29 08:22:12] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:22:12] [config] bert-train-type-embeddings: true
[2023-06-29 08:22:12] [config] bert-type-vocab-size: 2
[2023-06-29 08:22:12] [config] build-info: ""
[2023-06-29 08:22:12] [config] check-gradient-nan: false
[2023-06-29 08:22:12] [config] check-nan: false
[2023-06-29 08:22:12] [config] cite: false
[2023-06-29 08:22:12] [config] clip-norm: 1
[2023-06-29 08:22:12] [config] cost-scaling:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] cost-type: ce-sum
[2023-06-29 08:22:12] [config] cpu-threads: 0
[2023-06-29 08:22:12] [config] data-threads: 8
[2023-06-29 08:22:12] [config] data-weighting: ""
[2023-06-29 08:22:12] [config] data-weighting-type: sentence
[2023-06-29 08:22:12] [config] dec-cell: gru
[2023-06-29 08:22:12] [config] dec-cell-base-depth: 2
[2023-06-29 08:22:12] [config] dec-cell-high-depth: 1
[2023-06-29 08:22:12] [config] dec-depth: 1
[2023-06-29 08:22:12] [config] devices:
[2023-06-29 08:22:12] [config]   - 0
[2023-06-29 08:22:12] [config] dim-emb: 512
[2023-06-29 08:22:12] [config] dim-rnn: 1024
[2023-06-29 08:22:12] [config] dim-vocabs:
[2023-06-29 08:22:12] [config]   - 16384
[2023-06-29 08:22:12] [config]   - 16384
[2023-06-29 08:22:12] [config] disp-first: 0
[2023-06-29 08:22:12] [config] disp-freq: 1000u
[2023-06-29 08:22:12] [config] disp-label-counts: true
[2023-06-29 08:22:12] [config] dropout-rnn: 0.2
[2023-06-29 08:22:12] [config] dropout-src: 0.1
[2023-06-29 08:22:12] [config] dropout-trg: 0.1
[2023-06-29 08:22:12] [config] dump-config: ""
[2023-06-29 08:22:12] [config] dynamic-gradient-scaling:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] early-stopping: 10
[2023-06-29 08:22:12] [config] early-stopping-on: first
[2023-06-29 08:22:12] [config] embedding-fix-src: false
[2023-06-29 08:22:12] [config] embedding-fix-trg: false
[2023-06-29 08:22:12] [config] embedding-normalization: false
[2023-06-29 08:22:12] [config] embedding-vectors:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] enc-cell: gru
[2023-06-29 08:22:12] [config] enc-cell-depth: 1
[2023-06-29 08:22:12] [config] enc-depth: 1
[2023-06-29 08:22:12] [config] enc-type: bidirectional
[2023-06-29 08:22:12] [config] english-title-case-every: 0
[2023-06-29 08:22:12] [config] exponential-smoothing: 0
[2023-06-29 08:22:12] [config] factor-weight: 1
[2023-06-29 08:22:12] [config] factors-combine: sum
[2023-06-29 08:22:12] [config] factors-dim-emb: 0
[2023-06-29 08:22:12] [config] gradient-checkpointing: false
[2023-06-29 08:22:12] [config] gradient-norm-average-window: 100
[2023-06-29 08:22:12] [config] guided-alignment: none
[2023-06-29 08:22:12] [config] guided-alignment-cost: mse
[2023-06-29 08:22:12] [config] guided-alignment-weight: 0.1
[2023-06-29 08:22:12] [config] ignore-model-config: false
[2023-06-29 08:22:12] [config] input-types:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] interpolate-env-vars: false
[2023-06-29 08:22:12] [config] keep-best: false
[2023-06-29 08:22:12] [config] label-smoothing: 0
[2023-06-29 08:22:12] [config] layer-normalization: true
[2023-06-29 08:22:12] [config] learn-rate: 0.0001
[2023-06-29 08:22:12] [config] lemma-dependency: ""
[2023-06-29 08:22:12] [config] lemma-dim-emb: 0
[2023-06-29 08:22:12] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:22:12] [config] log-level: info
[2023-06-29 08:22:12] [config] log-time-zone: ""
[2023-06-29 08:22:12] [config] logical-epoch:
[2023-06-29 08:22:12] [config]   - 1e
[2023-06-29 08:22:12] [config]   - 0
[2023-06-29 08:22:12] [config] lr-decay: 0
[2023-06-29 08:22:12] [config] lr-decay-freq: 50000
[2023-06-29 08:22:12] [config] lr-decay-inv-sqrt:
[2023-06-29 08:22:12] [config]   - 0
[2023-06-29 08:22:12] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:22:12] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:22:12] [config] lr-decay-start:
[2023-06-29 08:22:12] [config]   - 10
[2023-06-29 08:22:12] [config]   - 1
[2023-06-29 08:22:12] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:22:12] [config] lr-report: false
[2023-06-29 08:22:12] [config] lr-warmup: 0
[2023-06-29 08:22:12] [config] lr-warmup-at-reload: false
[2023-06-29 08:22:12] [config] lr-warmup-cycle: false
[2023-06-29 08:22:12] [config] lr-warmup-start-rate: 0
[2023-06-29 08:22:12] [config] max-length: 50
[2023-06-29 08:22:12] [config] max-length-crop: false
[2023-06-29 08:22:12] [config] max-length-factor: 3
[2023-06-29 08:22:12] [config] maxi-batch: 100
[2023-06-29 08:22:12] [config] maxi-batch-sort: trg
[2023-06-29 08:22:12] [config] mini-batch: 64
[2023-06-29 08:22:12] [config] mini-batch-fit: true
[2023-06-29 08:22:12] [config] mini-batch-fit-step: 10
[2023-06-29 08:22:12] [config] mini-batch-round-up: true
[2023-06-29 08:22:12] [config] mini-batch-track-lr: false
[2023-06-29 08:22:12] [config] mini-batch-warmup: 0
[2023-06-29 08:22:12] [config] mini-batch-words: 0
[2023-06-29 08:22:12] [config] mini-batch-words-ref: 0
[2023-06-29 08:22:12] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:22:12] [config] multi-loss-type: sum
[2023-06-29 08:22:12] [config] n-best: false
[2023-06-29 08:22:12] [config] no-nccl: false
[2023-06-29 08:22:12] [config] no-reload: false
[2023-06-29 08:22:12] [config] no-restore-corpus: false
[2023-06-29 08:22:12] [config] normalize: 0.6
[2023-06-29 08:22:12] [config] normalize-gradient: false
[2023-06-29 08:22:12] [config] num-devices: 0
[2023-06-29 08:22:12] [config] optimizer: adam
[2023-06-29 08:22:12] [config] optimizer-delay: 1
[2023-06-29 08:22:12] [config] optimizer-params:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] output-omit-bias: false
[2023-06-29 08:22:12] [config] overwrite: true
[2023-06-29 08:22:12] [config] precision:
[2023-06-29 08:22:12] [config]   - float32
[2023-06-29 08:22:12] [config]   - float32
[2023-06-29 08:22:12] [config] pretrained-model: ""
[2023-06-29 08:22:12] [config] quantize-biases: false
[2023-06-29 08:22:12] [config] quantize-bits: 0
[2023-06-29 08:22:12] [config] quantize-log-based: false
[2023-06-29 08:22:12] [config] quantize-optimization-steps: 0
[2023-06-29 08:22:12] [config] quiet: false
[2023-06-29 08:22:12] [config] quiet-translation: true
[2023-06-29 08:22:12] [config] relative-paths: false
[2023-06-29 08:22:12] [config] right-left: false
[2023-06-29 08:22:12] [config] save-freq: 10000u
[2023-06-29 08:22:12] [config] seed: 1234
[2023-06-29 08:22:12] [config] sentencepiece-alphas:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:22:12] [config] sentencepiece-options: ""
[2023-06-29 08:22:12] [config] sharding: global
[2023-06-29 08:22:12] [config] shuffle: data
[2023-06-29 08:22:12] [config] shuffle-in-ram: false
[2023-06-29 08:22:12] [config] sigterm: save-and-exit
[2023-06-29 08:22:12] [config] skip: false
[2023-06-29 08:22:12] [config] sqlite: ""
[2023-06-29 08:22:12] [config] sqlite-drop: false
[2023-06-29 08:22:12] [config] sync-freq: 200u
[2023-06-29 08:22:12] [config] sync-sgd: false
[2023-06-29 08:22:12] [config] tempdir: /tmp
[2023-06-29 08:22:12] [config] tied-embeddings: false
[2023-06-29 08:22:12] [config] tied-embeddings-all: true
[2023-06-29 08:22:12] [config] tied-embeddings-src: false
[2023-06-29 08:22:12] [config] train-embedder-rank:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] train-sets:
[2023-06-29 08:22:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:22:12] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:22:12] [config] transformer-aan-activation: swish
[2023-06-29 08:22:12] [config] transformer-aan-depth: 2
[2023-06-29 08:22:12] [config] transformer-aan-nogate: false
[2023-06-29 08:22:12] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:22:12] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:22:12] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:22:12] [config] transformer-depth-scaling: false
[2023-06-29 08:22:12] [config] transformer-dim-aan: 2048
[2023-06-29 08:22:12] [config] transformer-dim-ffn: 2048
[2023-06-29 08:22:12] [config] transformer-dropout: 0
[2023-06-29 08:22:12] [config] transformer-dropout-attention: 0
[2023-06-29 08:22:12] [config] transformer-dropout-ffn: 0
[2023-06-29 08:22:12] [config] transformer-ffn-activation: swish
[2023-06-29 08:22:12] [config] transformer-ffn-depth: 2
[2023-06-29 08:22:12] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:22:12] [config] transformer-heads: 8
[2023-06-29 08:22:12] [config] transformer-no-projection: false
[2023-06-29 08:22:12] [config] transformer-pool: false
[2023-06-29 08:22:12] [config] transformer-postprocess: dan
[2023-06-29 08:22:12] [config] transformer-postprocess-emb: d
[2023-06-29 08:22:12] [config] transformer-postprocess-top: ""
[2023-06-29 08:22:12] [config] transformer-preprocess: ""
[2023-06-29 08:22:12] [config] transformer-tied-layers:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] transformer-train-position-embeddings: false
[2023-06-29 08:22:12] [config] tsv: false
[2023-06-29 08:22:12] [config] tsv-fields: 0
[2023-06-29 08:22:12] [config] type: amun
[2023-06-29 08:22:12] [config] ulr: false
[2023-06-29 08:22:12] [config] ulr-dim-emb: 0
[2023-06-29 08:22:12] [config] ulr-dropout: 0
[2023-06-29 08:22:12] [config] ulr-keys-vectors: ""
[2023-06-29 08:22:12] [config] ulr-query-vectors: ""
[2023-06-29 08:22:12] [config] ulr-softmax-temperature: 1
[2023-06-29 08:22:12] [config] ulr-trainable-transformation: false
[2023-06-29 08:22:12] [config] unlikelihood-loss: false
[2023-06-29 08:22:12] [config] valid-freq: 50000000
[2023-06-29 08:22:12] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:22:12] [config] valid-max-length: 1000
[2023-06-29 08:22:12] [config] valid-metrics:
[2023-06-29 08:22:12] [config]   - cross-entropy
[2023-06-29 08:22:12] [config]   - translation
[2023-06-29 08:22:12] [config] valid-mini-batch: 32
[2023-06-29 08:22:12] [config] valid-reset-stalled: false
[2023-06-29 08:22:12] [config] valid-script-args:
[2023-06-29 08:22:12] [config]   []
[2023-06-29 08:22:12] [config] valid-script-path: ""
[2023-06-29 08:22:12] [config] valid-sets:
[2023-06-29 08:22:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:22:12] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:22:12] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:22:12] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:22:12] [config] vocabs:
[2023-06-29 08:22:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:22:12] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:22:12] [config] word-penalty: 0
[2023-06-29 08:22:12] [config] word-scores: false
[2023-06-29 08:22:12] [config] workspace: 3000
[2023-06-29 08:22:12] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:22:12] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:22:12] [training] Using single-device training
[2023-06-29 08:22:14] Synced seed 1234
[2023-06-29 08:22:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:22:14] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:22:14] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:22:14] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:22:14] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:22:14] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:22:15] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:22:15] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:22:15] [comm] Using global sharding
[2023-06-29 08:22:15] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:22:15] [training] Using 1 GPUs
[2023-06-29 08:22:15] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:22:15] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:22:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:22:15] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:22:27] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:22:27] [valid] No post-processing script given for validating translator
[2023-06-29 08:22:28] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:22:28] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:22:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:22:28] [comm] Using global sharding
[2023-06-29 08:22:28] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:22:28] [training] Using 1 GPUs
[2023-06-29 08:22:28] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:22:29] Loading Adam parameters
[2023-06-29 08:22:29] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:22:29] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:22:29] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:22:29] [data] Restoring the corpus state to epoch 41, batch 4458
[2023-06-29 08:22:29] [data] Shuffling data
[2023-06-29 08:22:29] [data] Done reading 20,192 sentences
[2023-06-29 08:22:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:22:29] Training started
[2023-06-29 08:22:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:22:29] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:22:30] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:23:05] Seen 16,611 samples
[2023-06-29 08:23:05] Starting data epoch 42 in logical epoch 42
[2023-06-29 08:23:05] [data] Shuffling data
[2023-06-29 08:23:05] [data] Done reading 20,192 sentences
[2023-06-29 08:23:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:23:44] Seen 16,611 samples
[2023-06-29 08:23:50] Starting data epoch 43 in logical epoch 43
[2023-06-29 08:23:50] [data] Shuffling data
[2023-06-29 08:23:50] [data] Done reading 20,192 sentences
[2023-06-29 08:23:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:24:27] Seen 16,611 samples
[2023-06-29 08:24:27] Starting data epoch 44 in logical epoch 44
[2023-06-29 08:24:27] [data] Shuffling data
[2023-06-29 08:24:27] [data] Done reading 20,192 sentences
[2023-06-29 08:24:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:25:06] Seen 16,611 samples
[2023-06-29 08:25:06] Starting data epoch 45 in logical epoch 45
[2023-06-29 08:25:06] [data] Shuffling data
[2023-06-29 08:25:06] [data] Done reading 20,192 sentences
[2023-06-29 08:25:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:25:40] Ep. 45 : Up. 5000 : Sen. 14,656 : Cost 2.65463114 * 3,100,966 @ 2,016 after 15,502,248 : Time 192.98s : 16069.00 words/s : gNorm 1.3610
[2023-06-29 08:25:45] Seen 16,611 samples
[2023-06-29 08:25:45] Starting data epoch 46 in logical epoch 46
[2023-06-29 08:25:45] [data] Shuffling data
[2023-06-29 08:25:45] [data] Done reading 20,192 sentences
[2023-06-29 08:25:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:26:24] Seen 16,611 samples
[2023-06-29 08:26:24] Starting data epoch 47 in logical epoch 47
[2023-06-29 08:26:24] [data] Shuffling data
[2023-06-29 08:26:25] [data] Done reading 20,192 sentences
[2023-06-29 08:26:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:27:04] Seen 16,611 samples
[2023-06-29 08:27:04] Starting data epoch 48 in logical epoch 48
[2023-06-29 08:27:04] [data] Shuffling data
[2023-06-29 08:27:04] [data] Done reading 20,192 sentences
[2023-06-29 08:27:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:27:43] Seen 16,611 samples
[2023-06-29 08:27:43] Starting data epoch 49 in logical epoch 49
[2023-06-29 08:27:43] [data] Shuffling data
[2023-06-29 08:27:43] [data] Done reading 20,192 sentences
[2023-06-29 08:27:43] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:28:22] Seen 16,611 samples
[2023-06-29 08:28:22] Starting data epoch 50 in logical epoch 50
[2023-06-29 08:28:22] [data] Shuffling data
[2023-06-29 08:28:22] [data] Done reading 20,192 sentences
[2023-06-29 08:28:22] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:29:02] Seen 16,611 samples
[2023-06-29 08:29:02] Starting data epoch 51 in logical epoch 51
[2023-06-29 08:29:02] Training finished
[2023-06-29 08:29:14] [valid] Ep. 51 : Up. 5570 : cross-entropy : 243.899 : stalled 2 times (last best: 240.973)
[2023-06-29 08:30:14] [valid] Ep. 51 : Up. 5570 : translation : 0 : new best
[2023-06-29 08:30:14] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:30:16] Saving Adam parameters
[2023-06-29 08:30:16] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:30:24] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:30:24] [marian] Running on node20.datos.cluster.uy as process 14523 with command line:
[2023-06-29 08:30:24] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 60 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:30:24] [config] after: 0e
[2023-06-29 08:30:24] [config] after-batches: 0
[2023-06-29 08:30:24] [config] after-epochs: 60
[2023-06-29 08:30:24] [config] all-caps-every: 0
[2023-06-29 08:30:24] [config] allow-unk: false
[2023-06-29 08:30:24] [config] authors: false
[2023-06-29 08:30:24] [config] beam-size: 6
[2023-06-29 08:30:24] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:30:24] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:30:24] [config] bert-masking-fraction: 0.15
[2023-06-29 08:30:24] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:30:24] [config] bert-train-type-embeddings: true
[2023-06-29 08:30:24] [config] bert-type-vocab-size: 2
[2023-06-29 08:30:24] [config] build-info: ""
[2023-06-29 08:30:24] [config] check-gradient-nan: false
[2023-06-29 08:30:24] [config] check-nan: false
[2023-06-29 08:30:24] [config] cite: false
[2023-06-29 08:30:24] [config] clip-norm: 1
[2023-06-29 08:30:24] [config] cost-scaling:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] cost-type: ce-sum
[2023-06-29 08:30:24] [config] cpu-threads: 0
[2023-06-29 08:30:24] [config] data-threads: 8
[2023-06-29 08:30:24] [config] data-weighting: ""
[2023-06-29 08:30:24] [config] data-weighting-type: sentence
[2023-06-29 08:30:24] [config] dec-cell: gru
[2023-06-29 08:30:24] [config] dec-cell-base-depth: 2
[2023-06-29 08:30:24] [config] dec-cell-high-depth: 1
[2023-06-29 08:30:24] [config] dec-depth: 1
[2023-06-29 08:30:24] [config] devices:
[2023-06-29 08:30:24] [config]   - 0
[2023-06-29 08:30:24] [config] dim-emb: 512
[2023-06-29 08:30:24] [config] dim-rnn: 1024
[2023-06-29 08:30:24] [config] dim-vocabs:
[2023-06-29 08:30:24] [config]   - 16384
[2023-06-29 08:30:24] [config]   - 16384
[2023-06-29 08:30:24] [config] disp-first: 0
[2023-06-29 08:30:24] [config] disp-freq: 1000u
[2023-06-29 08:30:24] [config] disp-label-counts: true
[2023-06-29 08:30:24] [config] dropout-rnn: 0.2
[2023-06-29 08:30:24] [config] dropout-src: 0.1
[2023-06-29 08:30:24] [config] dropout-trg: 0.1
[2023-06-29 08:30:24] [config] dump-config: ""
[2023-06-29 08:30:24] [config] dynamic-gradient-scaling:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] early-stopping: 10
[2023-06-29 08:30:24] [config] early-stopping-on: first
[2023-06-29 08:30:24] [config] embedding-fix-src: false
[2023-06-29 08:30:24] [config] embedding-fix-trg: false
[2023-06-29 08:30:24] [config] embedding-normalization: false
[2023-06-29 08:30:24] [config] embedding-vectors:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] enc-cell: gru
[2023-06-29 08:30:24] [config] enc-cell-depth: 1
[2023-06-29 08:30:24] [config] enc-depth: 1
[2023-06-29 08:30:24] [config] enc-type: bidirectional
[2023-06-29 08:30:24] [config] english-title-case-every: 0
[2023-06-29 08:30:24] [config] exponential-smoothing: 0
[2023-06-29 08:30:24] [config] factor-weight: 1
[2023-06-29 08:30:24] [config] factors-combine: sum
[2023-06-29 08:30:24] [config] factors-dim-emb: 0
[2023-06-29 08:30:24] [config] gradient-checkpointing: false
[2023-06-29 08:30:24] [config] gradient-norm-average-window: 100
[2023-06-29 08:30:24] [config] guided-alignment: none
[2023-06-29 08:30:24] [config] guided-alignment-cost: mse
[2023-06-29 08:30:24] [config] guided-alignment-weight: 0.1
[2023-06-29 08:30:24] [config] ignore-model-config: false
[2023-06-29 08:30:24] [config] input-types:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] interpolate-env-vars: false
[2023-06-29 08:30:24] [config] keep-best: false
[2023-06-29 08:30:24] [config] label-smoothing: 0
[2023-06-29 08:30:24] [config] layer-normalization: true
[2023-06-29 08:30:24] [config] learn-rate: 0.0001
[2023-06-29 08:30:24] [config] lemma-dependency: ""
[2023-06-29 08:30:24] [config] lemma-dim-emb: 0
[2023-06-29 08:30:24] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:30:24] [config] log-level: info
[2023-06-29 08:30:24] [config] log-time-zone: ""
[2023-06-29 08:30:24] [config] logical-epoch:
[2023-06-29 08:30:24] [config]   - 1e
[2023-06-29 08:30:24] [config]   - 0
[2023-06-29 08:30:24] [config] lr-decay: 0
[2023-06-29 08:30:24] [config] lr-decay-freq: 50000
[2023-06-29 08:30:24] [config] lr-decay-inv-sqrt:
[2023-06-29 08:30:24] [config]   - 0
[2023-06-29 08:30:24] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:30:24] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:30:24] [config] lr-decay-start:
[2023-06-29 08:30:24] [config]   - 10
[2023-06-29 08:30:24] [config]   - 1
[2023-06-29 08:30:24] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:30:24] [config] lr-report: false
[2023-06-29 08:30:24] [config] lr-warmup: 0
[2023-06-29 08:30:24] [config] lr-warmup-at-reload: false
[2023-06-29 08:30:24] [config] lr-warmup-cycle: false
[2023-06-29 08:30:24] [config] lr-warmup-start-rate: 0
[2023-06-29 08:30:24] [config] max-length: 50
[2023-06-29 08:30:24] [config] max-length-crop: false
[2023-06-29 08:30:24] [config] max-length-factor: 3
[2023-06-29 08:30:24] [config] maxi-batch: 100
[2023-06-29 08:30:24] [config] maxi-batch-sort: trg
[2023-06-29 08:30:24] [config] mini-batch: 64
[2023-06-29 08:30:24] [config] mini-batch-fit: true
[2023-06-29 08:30:24] [config] mini-batch-fit-step: 10
[2023-06-29 08:30:24] [config] mini-batch-round-up: true
[2023-06-29 08:30:24] [config] mini-batch-track-lr: false
[2023-06-29 08:30:24] [config] mini-batch-warmup: 0
[2023-06-29 08:30:24] [config] mini-batch-words: 0
[2023-06-29 08:30:24] [config] mini-batch-words-ref: 0
[2023-06-29 08:30:24] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:30:24] [config] multi-loss-type: sum
[2023-06-29 08:30:24] [config] n-best: false
[2023-06-29 08:30:24] [config] no-nccl: false
[2023-06-29 08:30:24] [config] no-reload: false
[2023-06-29 08:30:24] [config] no-restore-corpus: false
[2023-06-29 08:30:24] [config] normalize: 0.6
[2023-06-29 08:30:24] [config] normalize-gradient: false
[2023-06-29 08:30:24] [config] num-devices: 0
[2023-06-29 08:30:24] [config] optimizer: adam
[2023-06-29 08:30:24] [config] optimizer-delay: 1
[2023-06-29 08:30:24] [config] optimizer-params:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] output-omit-bias: false
[2023-06-29 08:30:24] [config] overwrite: true
[2023-06-29 08:30:24] [config] precision:
[2023-06-29 08:30:24] [config]   - float32
[2023-06-29 08:30:24] [config]   - float32
[2023-06-29 08:30:24] [config] pretrained-model: ""
[2023-06-29 08:30:24] [config] quantize-biases: false
[2023-06-29 08:30:24] [config] quantize-bits: 0
[2023-06-29 08:30:24] [config] quantize-log-based: false
[2023-06-29 08:30:24] [config] quantize-optimization-steps: 0
[2023-06-29 08:30:24] [config] quiet: false
[2023-06-29 08:30:24] [config] quiet-translation: true
[2023-06-29 08:30:24] [config] relative-paths: false
[2023-06-29 08:30:24] [config] right-left: false
[2023-06-29 08:30:24] [config] save-freq: 10000u
[2023-06-29 08:30:24] [config] seed: 1234
[2023-06-29 08:30:24] [config] sentencepiece-alphas:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:30:24] [config] sentencepiece-options: ""
[2023-06-29 08:30:24] [config] sharding: global
[2023-06-29 08:30:24] [config] shuffle: data
[2023-06-29 08:30:24] [config] shuffle-in-ram: false
[2023-06-29 08:30:24] [config] sigterm: save-and-exit
[2023-06-29 08:30:24] [config] skip: false
[2023-06-29 08:30:24] [config] sqlite: ""
[2023-06-29 08:30:24] [config] sqlite-drop: false
[2023-06-29 08:30:24] [config] sync-freq: 200u
[2023-06-29 08:30:24] [config] sync-sgd: false
[2023-06-29 08:30:24] [config] tempdir: /tmp
[2023-06-29 08:30:24] [config] tied-embeddings: false
[2023-06-29 08:30:24] [config] tied-embeddings-all: true
[2023-06-29 08:30:24] [config] tied-embeddings-src: false
[2023-06-29 08:30:24] [config] train-embedder-rank:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] train-sets:
[2023-06-29 08:30:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:30:24] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:30:24] [config] transformer-aan-activation: swish
[2023-06-29 08:30:24] [config] transformer-aan-depth: 2
[2023-06-29 08:30:24] [config] transformer-aan-nogate: false
[2023-06-29 08:30:24] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:30:24] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:30:24] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:30:24] [config] transformer-depth-scaling: false
[2023-06-29 08:30:24] [config] transformer-dim-aan: 2048
[2023-06-29 08:30:24] [config] transformer-dim-ffn: 2048
[2023-06-29 08:30:24] [config] transformer-dropout: 0
[2023-06-29 08:30:24] [config] transformer-dropout-attention: 0
[2023-06-29 08:30:24] [config] transformer-dropout-ffn: 0
[2023-06-29 08:30:24] [config] transformer-ffn-activation: swish
[2023-06-29 08:30:24] [config] transformer-ffn-depth: 2
[2023-06-29 08:30:24] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:30:24] [config] transformer-heads: 8
[2023-06-29 08:30:24] [config] transformer-no-projection: false
[2023-06-29 08:30:24] [config] transformer-pool: false
[2023-06-29 08:30:24] [config] transformer-postprocess: dan
[2023-06-29 08:30:24] [config] transformer-postprocess-emb: d
[2023-06-29 08:30:24] [config] transformer-postprocess-top: ""
[2023-06-29 08:30:24] [config] transformer-preprocess: ""
[2023-06-29 08:30:24] [config] transformer-tied-layers:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] transformer-train-position-embeddings: false
[2023-06-29 08:30:24] [config] tsv: false
[2023-06-29 08:30:24] [config] tsv-fields: 0
[2023-06-29 08:30:24] [config] type: amun
[2023-06-29 08:30:24] [config] ulr: false
[2023-06-29 08:30:24] [config] ulr-dim-emb: 0
[2023-06-29 08:30:24] [config] ulr-dropout: 0
[2023-06-29 08:30:24] [config] ulr-keys-vectors: ""
[2023-06-29 08:30:24] [config] ulr-query-vectors: ""
[2023-06-29 08:30:24] [config] ulr-softmax-temperature: 1
[2023-06-29 08:30:24] [config] ulr-trainable-transformation: false
[2023-06-29 08:30:24] [config] unlikelihood-loss: false
[2023-06-29 08:30:24] [config] valid-freq: 50000000
[2023-06-29 08:30:24] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:30:24] [config] valid-max-length: 1000
[2023-06-29 08:30:24] [config] valid-metrics:
[2023-06-29 08:30:24] [config]   - cross-entropy
[2023-06-29 08:30:24] [config]   - translation
[2023-06-29 08:30:24] [config] valid-mini-batch: 32
[2023-06-29 08:30:24] [config] valid-reset-stalled: false
[2023-06-29 08:30:24] [config] valid-script-args:
[2023-06-29 08:30:24] [config]   []
[2023-06-29 08:30:24] [config] valid-script-path: ""
[2023-06-29 08:30:24] [config] valid-sets:
[2023-06-29 08:30:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:30:24] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:30:24] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:30:24] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:30:24] [config] vocabs:
[2023-06-29 08:30:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:30:24] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:30:24] [config] word-penalty: 0
[2023-06-29 08:30:24] [config] word-scores: false
[2023-06-29 08:30:24] [config] workspace: 3000
[2023-06-29 08:30:24] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:30:24] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:30:24] [training] Using single-device training
[2023-06-29 08:30:26] Synced seed 1234
[2023-06-29 08:30:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:30:26] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:30:26] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:30:26] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:30:26] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:30:26] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:30:26] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:30:26] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:30:26] [comm] Using global sharding
[2023-06-29 08:30:26] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:30:26] [training] Using 1 GPUs
[2023-06-29 08:30:26] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:30:26] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:30:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:30:27] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:30:39] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:30:39] [valid] No post-processing script given for validating translator
[2023-06-29 08:30:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:30:39] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:30:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:30:39] [comm] Using global sharding
[2023-06-29 08:30:39] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:30:39] [training] Using 1 GPUs
[2023-06-29 08:30:39] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:30:40] Loading Adam parameters
[2023-06-29 08:30:40] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:30:40] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:30:40] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:30:40] [data] Restoring the corpus state to epoch 51, batch 5570
[2023-06-29 08:30:40] [data] Shuffling data
[2023-06-29 08:30:40] [data] Done reading 20,192 sentences
[2023-06-29 08:30:41] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:30:41] Training started
[2023-06-29 08:30:41] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:30:41] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:30:41] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:31:18] Seen 16,611 samples
[2023-06-29 08:31:18] Starting data epoch 52 in logical epoch 52
[2023-06-29 08:31:18] [data] Shuffling data
[2023-06-29 08:31:18] [data] Done reading 20,192 sentences
[2023-06-29 08:31:18] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:31:57] Seen 16,611 samples
[2023-06-29 08:32:03] Starting data epoch 53 in logical epoch 53
[2023-06-29 08:32:03] [data] Shuffling data
[2023-06-29 08:32:03] [data] Done reading 20,192 sentences
[2023-06-29 08:32:03] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:32:40] Seen 16,611 samples
[2023-06-29 08:32:40] Starting data epoch 54 in logical epoch 54
[2023-06-29 08:32:40] [data] Shuffling data
[2023-06-29 08:32:40] [data] Done reading 20,192 sentences
[2023-06-29 08:32:40] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:33:14] Ep. 54 : Up. 6000 : Sen. 14,310 : Cost 2.23500419 * 3,106,851 @ 4,693 after 18,609,099 : Time 155.29s : 20007.33 words/s : gNorm 1.3336
[2023-06-29 08:33:19] Seen 16,611 samples
[2023-06-29 08:33:19] Starting data epoch 55 in logical epoch 55
[2023-06-29 08:33:19] [data] Shuffling data
[2023-06-29 08:33:19] [data] Done reading 20,192 sentences
[2023-06-29 08:33:19] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:33:59] Seen 16,611 samples
[2023-06-29 08:33:59] Starting data epoch 56 in logical epoch 56
[2023-06-29 08:33:59] [data] Shuffling data
[2023-06-29 08:33:59] [data] Done reading 20,192 sentences
[2023-06-29 08:33:59] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:34:38] Seen 16,611 samples
[2023-06-29 08:34:38] Starting data epoch 57 in logical epoch 57
[2023-06-29 08:34:38] [data] Shuffling data
[2023-06-29 08:34:38] [data] Done reading 20,192 sentences
[2023-06-29 08:34:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:35:17] Seen 16,611 samples
[2023-06-29 08:35:17] Starting data epoch 58 in logical epoch 58
[2023-06-29 08:35:17] [data] Shuffling data
[2023-06-29 08:35:17] [data] Done reading 20,192 sentences
[2023-06-29 08:35:17] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:35:57] Seen 16,611 samples
[2023-06-29 08:35:57] Starting data epoch 59 in logical epoch 59
[2023-06-29 08:35:57] [data] Shuffling data
[2023-06-29 08:35:57] [data] Done reading 20,192 sentences
[2023-06-29 08:35:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:36:36] Seen 16,611 samples
[2023-06-29 08:36:36] Starting data epoch 60 in logical epoch 60
[2023-06-29 08:36:36] [data] Shuffling data
[2023-06-29 08:36:36] [data] Done reading 20,192 sentences
[2023-06-29 08:36:36] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:37:15] Seen 16,611 samples
[2023-06-29 08:37:15] Starting data epoch 61 in logical epoch 61
[2023-06-29 08:37:15] Training finished
[2023-06-29 08:37:27] [valid] Ep. 61 : Up. 6682 : cross-entropy : 247.414 : stalled 3 times (last best: 240.973)
[2023-06-29 08:38:29] [valid] Ep. 61 : Up. 6682 : translation : 0 : new best
[2023-06-29 08:38:29] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:38:31] Saving Adam parameters
[2023-06-29 08:38:32] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:38:40] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:38:40] [marian] Running on node20.datos.cluster.uy as process 15326 with command line:
[2023-06-29 08:38:40] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 70 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:38:40] [config] after: 0e
[2023-06-29 08:38:40] [config] after-batches: 0
[2023-06-29 08:38:40] [config] after-epochs: 70
[2023-06-29 08:38:40] [config] all-caps-every: 0
[2023-06-29 08:38:40] [config] allow-unk: false
[2023-06-29 08:38:40] [config] authors: false
[2023-06-29 08:38:40] [config] beam-size: 6
[2023-06-29 08:38:40] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:38:40] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:38:40] [config] bert-masking-fraction: 0.15
[2023-06-29 08:38:40] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:38:40] [config] bert-train-type-embeddings: true
[2023-06-29 08:38:40] [config] bert-type-vocab-size: 2
[2023-06-29 08:38:40] [config] build-info: ""
[2023-06-29 08:38:40] [config] check-gradient-nan: false
[2023-06-29 08:38:40] [config] check-nan: false
[2023-06-29 08:38:40] [config] cite: false
[2023-06-29 08:38:40] [config] clip-norm: 1
[2023-06-29 08:38:40] [config] cost-scaling:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] cost-type: ce-sum
[2023-06-29 08:38:40] [config] cpu-threads: 0
[2023-06-29 08:38:40] [config] data-threads: 8
[2023-06-29 08:38:40] [config] data-weighting: ""
[2023-06-29 08:38:40] [config] data-weighting-type: sentence
[2023-06-29 08:38:40] [config] dec-cell: gru
[2023-06-29 08:38:40] [config] dec-cell-base-depth: 2
[2023-06-29 08:38:40] [config] dec-cell-high-depth: 1
[2023-06-29 08:38:40] [config] dec-depth: 1
[2023-06-29 08:38:40] [config] devices:
[2023-06-29 08:38:40] [config]   - 0
[2023-06-29 08:38:40] [config] dim-emb: 512
[2023-06-29 08:38:40] [config] dim-rnn: 1024
[2023-06-29 08:38:40] [config] dim-vocabs:
[2023-06-29 08:38:40] [config]   - 16384
[2023-06-29 08:38:40] [config]   - 16384
[2023-06-29 08:38:40] [config] disp-first: 0
[2023-06-29 08:38:40] [config] disp-freq: 1000u
[2023-06-29 08:38:40] [config] disp-label-counts: true
[2023-06-29 08:38:40] [config] dropout-rnn: 0.2
[2023-06-29 08:38:40] [config] dropout-src: 0.1
[2023-06-29 08:38:40] [config] dropout-trg: 0.1
[2023-06-29 08:38:40] [config] dump-config: ""
[2023-06-29 08:38:40] [config] dynamic-gradient-scaling:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] early-stopping: 10
[2023-06-29 08:38:40] [config] early-stopping-on: first
[2023-06-29 08:38:40] [config] embedding-fix-src: false
[2023-06-29 08:38:40] [config] embedding-fix-trg: false
[2023-06-29 08:38:40] [config] embedding-normalization: false
[2023-06-29 08:38:40] [config] embedding-vectors:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] enc-cell: gru
[2023-06-29 08:38:40] [config] enc-cell-depth: 1
[2023-06-29 08:38:40] [config] enc-depth: 1
[2023-06-29 08:38:40] [config] enc-type: bidirectional
[2023-06-29 08:38:40] [config] english-title-case-every: 0
[2023-06-29 08:38:40] [config] exponential-smoothing: 0
[2023-06-29 08:38:40] [config] factor-weight: 1
[2023-06-29 08:38:40] [config] factors-combine: sum
[2023-06-29 08:38:40] [config] factors-dim-emb: 0
[2023-06-29 08:38:40] [config] gradient-checkpointing: false
[2023-06-29 08:38:40] [config] gradient-norm-average-window: 100
[2023-06-29 08:38:40] [config] guided-alignment: none
[2023-06-29 08:38:40] [config] guided-alignment-cost: mse
[2023-06-29 08:38:40] [config] guided-alignment-weight: 0.1
[2023-06-29 08:38:40] [config] ignore-model-config: false
[2023-06-29 08:38:40] [config] input-types:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] interpolate-env-vars: false
[2023-06-29 08:38:40] [config] keep-best: false
[2023-06-29 08:38:40] [config] label-smoothing: 0
[2023-06-29 08:38:40] [config] layer-normalization: true
[2023-06-29 08:38:40] [config] learn-rate: 0.0001
[2023-06-29 08:38:40] [config] lemma-dependency: ""
[2023-06-29 08:38:40] [config] lemma-dim-emb: 0
[2023-06-29 08:38:40] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:38:40] [config] log-level: info
[2023-06-29 08:38:40] [config] log-time-zone: ""
[2023-06-29 08:38:40] [config] logical-epoch:
[2023-06-29 08:38:40] [config]   - 1e
[2023-06-29 08:38:40] [config]   - 0
[2023-06-29 08:38:40] [config] lr-decay: 0
[2023-06-29 08:38:40] [config] lr-decay-freq: 50000
[2023-06-29 08:38:40] [config] lr-decay-inv-sqrt:
[2023-06-29 08:38:40] [config]   - 0
[2023-06-29 08:38:40] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:38:40] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:38:40] [config] lr-decay-start:
[2023-06-29 08:38:40] [config]   - 10
[2023-06-29 08:38:40] [config]   - 1
[2023-06-29 08:38:40] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:38:40] [config] lr-report: false
[2023-06-29 08:38:40] [config] lr-warmup: 0
[2023-06-29 08:38:40] [config] lr-warmup-at-reload: false
[2023-06-29 08:38:40] [config] lr-warmup-cycle: false
[2023-06-29 08:38:40] [config] lr-warmup-start-rate: 0
[2023-06-29 08:38:40] [config] max-length: 50
[2023-06-29 08:38:40] [config] max-length-crop: false
[2023-06-29 08:38:40] [config] max-length-factor: 3
[2023-06-29 08:38:40] [config] maxi-batch: 100
[2023-06-29 08:38:40] [config] maxi-batch-sort: trg
[2023-06-29 08:38:40] [config] mini-batch: 64
[2023-06-29 08:38:40] [config] mini-batch-fit: true
[2023-06-29 08:38:40] [config] mini-batch-fit-step: 10
[2023-06-29 08:38:40] [config] mini-batch-round-up: true
[2023-06-29 08:38:40] [config] mini-batch-track-lr: false
[2023-06-29 08:38:40] [config] mini-batch-warmup: 0
[2023-06-29 08:38:40] [config] mini-batch-words: 0
[2023-06-29 08:38:40] [config] mini-batch-words-ref: 0
[2023-06-29 08:38:40] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:38:40] [config] multi-loss-type: sum
[2023-06-29 08:38:40] [config] n-best: false
[2023-06-29 08:38:40] [config] no-nccl: false
[2023-06-29 08:38:40] [config] no-reload: false
[2023-06-29 08:38:40] [config] no-restore-corpus: false
[2023-06-29 08:38:40] [config] normalize: 0.6
[2023-06-29 08:38:40] [config] normalize-gradient: false
[2023-06-29 08:38:40] [config] num-devices: 0
[2023-06-29 08:38:40] [config] optimizer: adam
[2023-06-29 08:38:40] [config] optimizer-delay: 1
[2023-06-29 08:38:40] [config] optimizer-params:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] output-omit-bias: false
[2023-06-29 08:38:40] [config] overwrite: true
[2023-06-29 08:38:40] [config] precision:
[2023-06-29 08:38:40] [config]   - float32
[2023-06-29 08:38:40] [config]   - float32
[2023-06-29 08:38:40] [config] pretrained-model: ""
[2023-06-29 08:38:40] [config] quantize-biases: false
[2023-06-29 08:38:40] [config] quantize-bits: 0
[2023-06-29 08:38:40] [config] quantize-log-based: false
[2023-06-29 08:38:40] [config] quantize-optimization-steps: 0
[2023-06-29 08:38:40] [config] quiet: false
[2023-06-29 08:38:40] [config] quiet-translation: true
[2023-06-29 08:38:40] [config] relative-paths: false
[2023-06-29 08:38:40] [config] right-left: false
[2023-06-29 08:38:40] [config] save-freq: 10000u
[2023-06-29 08:38:40] [config] seed: 1234
[2023-06-29 08:38:40] [config] sentencepiece-alphas:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:38:40] [config] sentencepiece-options: ""
[2023-06-29 08:38:40] [config] sharding: global
[2023-06-29 08:38:40] [config] shuffle: data
[2023-06-29 08:38:40] [config] shuffle-in-ram: false
[2023-06-29 08:38:40] [config] sigterm: save-and-exit
[2023-06-29 08:38:40] [config] skip: false
[2023-06-29 08:38:40] [config] sqlite: ""
[2023-06-29 08:38:40] [config] sqlite-drop: false
[2023-06-29 08:38:40] [config] sync-freq: 200u
[2023-06-29 08:38:40] [config] sync-sgd: false
[2023-06-29 08:38:40] [config] tempdir: /tmp
[2023-06-29 08:38:40] [config] tied-embeddings: false
[2023-06-29 08:38:40] [config] tied-embeddings-all: true
[2023-06-29 08:38:40] [config] tied-embeddings-src: false
[2023-06-29 08:38:40] [config] train-embedder-rank:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] train-sets:
[2023-06-29 08:38:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:38:40] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:38:40] [config] transformer-aan-activation: swish
[2023-06-29 08:38:40] [config] transformer-aan-depth: 2
[2023-06-29 08:38:40] [config] transformer-aan-nogate: false
[2023-06-29 08:38:40] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:38:40] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:38:40] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:38:40] [config] transformer-depth-scaling: false
[2023-06-29 08:38:40] [config] transformer-dim-aan: 2048
[2023-06-29 08:38:40] [config] transformer-dim-ffn: 2048
[2023-06-29 08:38:40] [config] transformer-dropout: 0
[2023-06-29 08:38:40] [config] transformer-dropout-attention: 0
[2023-06-29 08:38:40] [config] transformer-dropout-ffn: 0
[2023-06-29 08:38:40] [config] transformer-ffn-activation: swish
[2023-06-29 08:38:40] [config] transformer-ffn-depth: 2
[2023-06-29 08:38:40] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:38:40] [config] transformer-heads: 8
[2023-06-29 08:38:40] [config] transformer-no-projection: false
[2023-06-29 08:38:40] [config] transformer-pool: false
[2023-06-29 08:38:40] [config] transformer-postprocess: dan
[2023-06-29 08:38:40] [config] transformer-postprocess-emb: d
[2023-06-29 08:38:40] [config] transformer-postprocess-top: ""
[2023-06-29 08:38:40] [config] transformer-preprocess: ""
[2023-06-29 08:38:40] [config] transformer-tied-layers:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] transformer-train-position-embeddings: false
[2023-06-29 08:38:40] [config] tsv: false
[2023-06-29 08:38:40] [config] tsv-fields: 0
[2023-06-29 08:38:40] [config] type: amun
[2023-06-29 08:38:40] [config] ulr: false
[2023-06-29 08:38:40] [config] ulr-dim-emb: 0
[2023-06-29 08:38:40] [config] ulr-dropout: 0
[2023-06-29 08:38:40] [config] ulr-keys-vectors: ""
[2023-06-29 08:38:40] [config] ulr-query-vectors: ""
[2023-06-29 08:38:40] [config] ulr-softmax-temperature: 1
[2023-06-29 08:38:40] [config] ulr-trainable-transformation: false
[2023-06-29 08:38:40] [config] unlikelihood-loss: false
[2023-06-29 08:38:40] [config] valid-freq: 50000000
[2023-06-29 08:38:40] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:38:40] [config] valid-max-length: 1000
[2023-06-29 08:38:40] [config] valid-metrics:
[2023-06-29 08:38:40] [config]   - cross-entropy
[2023-06-29 08:38:40] [config]   - translation
[2023-06-29 08:38:40] [config] valid-mini-batch: 32
[2023-06-29 08:38:40] [config] valid-reset-stalled: false
[2023-06-29 08:38:40] [config] valid-script-args:
[2023-06-29 08:38:40] [config]   []
[2023-06-29 08:38:40] [config] valid-script-path: ""
[2023-06-29 08:38:40] [config] valid-sets:
[2023-06-29 08:38:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:38:40] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:38:40] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:38:40] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:38:40] [config] vocabs:
[2023-06-29 08:38:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:38:40] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:38:40] [config] word-penalty: 0
[2023-06-29 08:38:40] [config] word-scores: false
[2023-06-29 08:38:40] [config] workspace: 3000
[2023-06-29 08:38:40] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:38:40] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:38:40] [training] Using single-device training
[2023-06-29 08:38:41] Synced seed 1234
[2023-06-29 08:38:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:38:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:38:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:38:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:38:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:38:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:38:41] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:38:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:38:41] [comm] Using global sharding
[2023-06-29 08:38:41] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:38:41] [training] Using 1 GPUs
[2023-06-29 08:38:41] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:38:41] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:38:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:38:42] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:38:54] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:38:54] [valid] No post-processing script given for validating translator
[2023-06-29 08:38:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:38:54] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:38:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:38:54] [comm] Using global sharding
[2023-06-29 08:38:54] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:38:54] [training] Using 1 GPUs
[2023-06-29 08:38:54] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:38:55] Loading Adam parameters
[2023-06-29 08:38:55] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:38:55] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:38:55] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:38:55] [data] Restoring the corpus state to epoch 61, batch 6682
[2023-06-29 08:38:55] [data] Shuffling data
[2023-06-29 08:38:55] [data] Done reading 20,192 sentences
[2023-06-29 08:38:55] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:38:55] Training started
[2023-06-29 08:38:55] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:38:56] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:38:56] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:39:32] Seen 16,611 samples
[2023-06-29 08:39:32] Starting data epoch 62 in logical epoch 62
[2023-06-29 08:39:32] [data] Shuffling data
[2023-06-29 08:39:32] [data] Done reading 20,192 sentences
[2023-06-29 08:39:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:40:11] Seen 16,611 samples
[2023-06-29 08:40:13] Starting data epoch 63 in logical epoch 63
[2023-06-29 08:40:13] [data] Shuffling data
[2023-06-29 08:40:15] [data] Done reading 20,192 sentences
[2023-06-29 08:40:15] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:40:48] Ep. 63 : Up. 7000 : Sen. 14,296 : Cost 1.89208472 * 3,110,176 @ 4,524 after 21,719,275 : Time 113.85s : 27318.57 words/s : gNorm 1.2962
[2023-06-29 08:40:53] Seen 16,611 samples
[2023-06-29 08:40:53] Starting data epoch 64 in logical epoch 64
[2023-06-29 08:40:53] [data] Shuffling data
[2023-06-29 08:40:53] [data] Done reading 20,192 sentences
[2023-06-29 08:40:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:41:32] Seen 16,611 samples
[2023-06-29 08:41:32] Starting data epoch 65 in logical epoch 65
[2023-06-29 08:41:32] [data] Shuffling data
[2023-06-29 08:41:32] [data] Done reading 20,192 sentences
[2023-06-29 08:41:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:42:11] Seen 16,611 samples
[2023-06-29 08:42:11] Starting data epoch 66 in logical epoch 66
[2023-06-29 08:42:11] [data] Shuffling data
[2023-06-29 08:42:11] [data] Done reading 20,192 sentences
[2023-06-29 08:42:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:42:51] Seen 16,611 samples
[2023-06-29 08:42:51] Starting data epoch 67 in logical epoch 67
[2023-06-29 08:42:51] [data] Shuffling data
[2023-06-29 08:42:51] [data] Done reading 20,192 sentences
[2023-06-29 08:42:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:43:30] Seen 16,611 samples
[2023-06-29 08:43:30] Starting data epoch 68 in logical epoch 68
[2023-06-29 08:43:30] [data] Shuffling data
[2023-06-29 08:43:30] [data] Done reading 20,192 sentences
[2023-06-29 08:43:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:44:09] Seen 16,611 samples
[2023-06-29 08:44:09] Starting data epoch 69 in logical epoch 69
[2023-06-29 08:44:09] [data] Shuffling data
[2023-06-29 08:44:09] [data] Done reading 20,192 sentences
[2023-06-29 08:44:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:44:48] Seen 16,611 samples
[2023-06-29 08:44:48] Starting data epoch 70 in logical epoch 70
[2023-06-29 08:44:48] [data] Shuffling data
[2023-06-29 08:44:48] [data] Done reading 20,192 sentences
[2023-06-29 08:44:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:45:28] Seen 16,611 samples
[2023-06-29 08:45:28] Starting data epoch 71 in logical epoch 71
[2023-06-29 08:45:28] Training finished
[2023-06-29 08:45:40] [valid] Ep. 71 : Up. 7793 : cross-entropy : 250.195 : stalled 4 times (last best: 240.973)
[2023-06-29 08:46:29] [valid] Ep. 71 : Up. 7793 : translation : 0 : new best
[2023-06-29 08:46:29] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:46:31] Saving Adam parameters
[2023-06-29 08:46:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:46:39] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:46:39] [marian] Running on node20.datos.cluster.uy as process 15794 with command line:
[2023-06-29 08:46:39] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 80 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:46:39] [config] after: 0e
[2023-06-29 08:46:39] [config] after-batches: 0
[2023-06-29 08:46:39] [config] after-epochs: 80
[2023-06-29 08:46:39] [config] all-caps-every: 0
[2023-06-29 08:46:39] [config] allow-unk: false
[2023-06-29 08:46:39] [config] authors: false
[2023-06-29 08:46:39] [config] beam-size: 6
[2023-06-29 08:46:39] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:46:39] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:46:39] [config] bert-masking-fraction: 0.15
[2023-06-29 08:46:39] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:46:39] [config] bert-train-type-embeddings: true
[2023-06-29 08:46:39] [config] bert-type-vocab-size: 2
[2023-06-29 08:46:39] [config] build-info: ""
[2023-06-29 08:46:39] [config] check-gradient-nan: false
[2023-06-29 08:46:39] [config] check-nan: false
[2023-06-29 08:46:39] [config] cite: false
[2023-06-29 08:46:39] [config] clip-norm: 1
[2023-06-29 08:46:39] [config] cost-scaling:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] cost-type: ce-sum
[2023-06-29 08:46:39] [config] cpu-threads: 0
[2023-06-29 08:46:39] [config] data-threads: 8
[2023-06-29 08:46:39] [config] data-weighting: ""
[2023-06-29 08:46:39] [config] data-weighting-type: sentence
[2023-06-29 08:46:39] [config] dec-cell: gru
[2023-06-29 08:46:39] [config] dec-cell-base-depth: 2
[2023-06-29 08:46:39] [config] dec-cell-high-depth: 1
[2023-06-29 08:46:39] [config] dec-depth: 1
[2023-06-29 08:46:39] [config] devices:
[2023-06-29 08:46:39] [config]   - 0
[2023-06-29 08:46:39] [config] dim-emb: 512
[2023-06-29 08:46:39] [config] dim-rnn: 1024
[2023-06-29 08:46:39] [config] dim-vocabs:
[2023-06-29 08:46:39] [config]   - 16384
[2023-06-29 08:46:39] [config]   - 16384
[2023-06-29 08:46:39] [config] disp-first: 0
[2023-06-29 08:46:39] [config] disp-freq: 1000u
[2023-06-29 08:46:39] [config] disp-label-counts: true
[2023-06-29 08:46:39] [config] dropout-rnn: 0.2
[2023-06-29 08:46:39] [config] dropout-src: 0.1
[2023-06-29 08:46:39] [config] dropout-trg: 0.1
[2023-06-29 08:46:39] [config] dump-config: ""
[2023-06-29 08:46:39] [config] dynamic-gradient-scaling:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] early-stopping: 10
[2023-06-29 08:46:39] [config] early-stopping-on: first
[2023-06-29 08:46:39] [config] embedding-fix-src: false
[2023-06-29 08:46:39] [config] embedding-fix-trg: false
[2023-06-29 08:46:39] [config] embedding-normalization: false
[2023-06-29 08:46:39] [config] embedding-vectors:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] enc-cell: gru
[2023-06-29 08:46:39] [config] enc-cell-depth: 1
[2023-06-29 08:46:39] [config] enc-depth: 1
[2023-06-29 08:46:39] [config] enc-type: bidirectional
[2023-06-29 08:46:39] [config] english-title-case-every: 0
[2023-06-29 08:46:39] [config] exponential-smoothing: 0
[2023-06-29 08:46:39] [config] factor-weight: 1
[2023-06-29 08:46:39] [config] factors-combine: sum
[2023-06-29 08:46:39] [config] factors-dim-emb: 0
[2023-06-29 08:46:39] [config] gradient-checkpointing: false
[2023-06-29 08:46:39] [config] gradient-norm-average-window: 100
[2023-06-29 08:46:39] [config] guided-alignment: none
[2023-06-29 08:46:39] [config] guided-alignment-cost: mse
[2023-06-29 08:46:39] [config] guided-alignment-weight: 0.1
[2023-06-29 08:46:39] [config] ignore-model-config: false
[2023-06-29 08:46:39] [config] input-types:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] interpolate-env-vars: false
[2023-06-29 08:46:39] [config] keep-best: false
[2023-06-29 08:46:39] [config] label-smoothing: 0
[2023-06-29 08:46:39] [config] layer-normalization: true
[2023-06-29 08:46:39] [config] learn-rate: 0.0001
[2023-06-29 08:46:39] [config] lemma-dependency: ""
[2023-06-29 08:46:39] [config] lemma-dim-emb: 0
[2023-06-29 08:46:39] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:46:39] [config] log-level: info
[2023-06-29 08:46:39] [config] log-time-zone: ""
[2023-06-29 08:46:39] [config] logical-epoch:
[2023-06-29 08:46:39] [config]   - 1e
[2023-06-29 08:46:39] [config]   - 0
[2023-06-29 08:46:39] [config] lr-decay: 0
[2023-06-29 08:46:39] [config] lr-decay-freq: 50000
[2023-06-29 08:46:39] [config] lr-decay-inv-sqrt:
[2023-06-29 08:46:39] [config]   - 0
[2023-06-29 08:46:39] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:46:39] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:46:39] [config] lr-decay-start:
[2023-06-29 08:46:39] [config]   - 10
[2023-06-29 08:46:39] [config]   - 1
[2023-06-29 08:46:39] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:46:39] [config] lr-report: false
[2023-06-29 08:46:39] [config] lr-warmup: 0
[2023-06-29 08:46:39] [config] lr-warmup-at-reload: false
[2023-06-29 08:46:39] [config] lr-warmup-cycle: false
[2023-06-29 08:46:39] [config] lr-warmup-start-rate: 0
[2023-06-29 08:46:39] [config] max-length: 50
[2023-06-29 08:46:39] [config] max-length-crop: false
[2023-06-29 08:46:39] [config] max-length-factor: 3
[2023-06-29 08:46:39] [config] maxi-batch: 100
[2023-06-29 08:46:39] [config] maxi-batch-sort: trg
[2023-06-29 08:46:39] [config] mini-batch: 64
[2023-06-29 08:46:39] [config] mini-batch-fit: true
[2023-06-29 08:46:39] [config] mini-batch-fit-step: 10
[2023-06-29 08:46:39] [config] mini-batch-round-up: true
[2023-06-29 08:46:39] [config] mini-batch-track-lr: false
[2023-06-29 08:46:39] [config] mini-batch-warmup: 0
[2023-06-29 08:46:39] [config] mini-batch-words: 0
[2023-06-29 08:46:39] [config] mini-batch-words-ref: 0
[2023-06-29 08:46:39] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:46:39] [config] multi-loss-type: sum
[2023-06-29 08:46:39] [config] n-best: false
[2023-06-29 08:46:39] [config] no-nccl: false
[2023-06-29 08:46:39] [config] no-reload: false
[2023-06-29 08:46:39] [config] no-restore-corpus: false
[2023-06-29 08:46:39] [config] normalize: 0.6
[2023-06-29 08:46:39] [config] normalize-gradient: false
[2023-06-29 08:46:39] [config] num-devices: 0
[2023-06-29 08:46:39] [config] optimizer: adam
[2023-06-29 08:46:39] [config] optimizer-delay: 1
[2023-06-29 08:46:39] [config] optimizer-params:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] output-omit-bias: false
[2023-06-29 08:46:39] [config] overwrite: true
[2023-06-29 08:46:39] [config] precision:
[2023-06-29 08:46:39] [config]   - float32
[2023-06-29 08:46:39] [config]   - float32
[2023-06-29 08:46:39] [config] pretrained-model: ""
[2023-06-29 08:46:39] [config] quantize-biases: false
[2023-06-29 08:46:39] [config] quantize-bits: 0
[2023-06-29 08:46:39] [config] quantize-log-based: false
[2023-06-29 08:46:39] [config] quantize-optimization-steps: 0
[2023-06-29 08:46:39] [config] quiet: false
[2023-06-29 08:46:39] [config] quiet-translation: true
[2023-06-29 08:46:39] [config] relative-paths: false
[2023-06-29 08:46:39] [config] right-left: false
[2023-06-29 08:46:39] [config] save-freq: 10000u
[2023-06-29 08:46:39] [config] seed: 1234
[2023-06-29 08:46:39] [config] sentencepiece-alphas:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:46:39] [config] sentencepiece-options: ""
[2023-06-29 08:46:39] [config] sharding: global
[2023-06-29 08:46:39] [config] shuffle: data
[2023-06-29 08:46:39] [config] shuffle-in-ram: false
[2023-06-29 08:46:39] [config] sigterm: save-and-exit
[2023-06-29 08:46:39] [config] skip: false
[2023-06-29 08:46:39] [config] sqlite: ""
[2023-06-29 08:46:39] [config] sqlite-drop: false
[2023-06-29 08:46:39] [config] sync-freq: 200u
[2023-06-29 08:46:39] [config] sync-sgd: false
[2023-06-29 08:46:39] [config] tempdir: /tmp
[2023-06-29 08:46:39] [config] tied-embeddings: false
[2023-06-29 08:46:39] [config] tied-embeddings-all: true
[2023-06-29 08:46:39] [config] tied-embeddings-src: false
[2023-06-29 08:46:39] [config] train-embedder-rank:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] train-sets:
[2023-06-29 08:46:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:46:39] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:46:39] [config] transformer-aan-activation: swish
[2023-06-29 08:46:39] [config] transformer-aan-depth: 2
[2023-06-29 08:46:39] [config] transformer-aan-nogate: false
[2023-06-29 08:46:39] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:46:39] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:46:39] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:46:39] [config] transformer-depth-scaling: false
[2023-06-29 08:46:39] [config] transformer-dim-aan: 2048
[2023-06-29 08:46:39] [config] transformer-dim-ffn: 2048
[2023-06-29 08:46:39] [config] transformer-dropout: 0
[2023-06-29 08:46:39] [config] transformer-dropout-attention: 0
[2023-06-29 08:46:39] [config] transformer-dropout-ffn: 0
[2023-06-29 08:46:39] [config] transformer-ffn-activation: swish
[2023-06-29 08:46:39] [config] transformer-ffn-depth: 2
[2023-06-29 08:46:39] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:46:39] [config] transformer-heads: 8
[2023-06-29 08:46:39] [config] transformer-no-projection: false
[2023-06-29 08:46:39] [config] transformer-pool: false
[2023-06-29 08:46:39] [config] transformer-postprocess: dan
[2023-06-29 08:46:39] [config] transformer-postprocess-emb: d
[2023-06-29 08:46:39] [config] transformer-postprocess-top: ""
[2023-06-29 08:46:39] [config] transformer-preprocess: ""
[2023-06-29 08:46:39] [config] transformer-tied-layers:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] transformer-train-position-embeddings: false
[2023-06-29 08:46:39] [config] tsv: false
[2023-06-29 08:46:39] [config] tsv-fields: 0
[2023-06-29 08:46:39] [config] type: amun
[2023-06-29 08:46:39] [config] ulr: false
[2023-06-29 08:46:39] [config] ulr-dim-emb: 0
[2023-06-29 08:46:39] [config] ulr-dropout: 0
[2023-06-29 08:46:39] [config] ulr-keys-vectors: ""
[2023-06-29 08:46:39] [config] ulr-query-vectors: ""
[2023-06-29 08:46:39] [config] ulr-softmax-temperature: 1
[2023-06-29 08:46:39] [config] ulr-trainable-transformation: false
[2023-06-29 08:46:39] [config] unlikelihood-loss: false
[2023-06-29 08:46:39] [config] valid-freq: 50000000
[2023-06-29 08:46:39] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:46:39] [config] valid-max-length: 1000
[2023-06-29 08:46:39] [config] valid-metrics:
[2023-06-29 08:46:39] [config]   - cross-entropy
[2023-06-29 08:46:39] [config]   - translation
[2023-06-29 08:46:39] [config] valid-mini-batch: 32
[2023-06-29 08:46:39] [config] valid-reset-stalled: false
[2023-06-29 08:46:39] [config] valid-script-args:
[2023-06-29 08:46:39] [config]   []
[2023-06-29 08:46:39] [config] valid-script-path: ""
[2023-06-29 08:46:39] [config] valid-sets:
[2023-06-29 08:46:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:46:39] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:46:39] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:46:39] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:46:39] [config] vocabs:
[2023-06-29 08:46:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:46:39] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:46:39] [config] word-penalty: 0
[2023-06-29 08:46:39] [config] word-scores: false
[2023-06-29 08:46:39] [config] workspace: 3000
[2023-06-29 08:46:39] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:46:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:46:39] [training] Using single-device training
[2023-06-29 08:46:41] Synced seed 1234
[2023-06-29 08:46:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:46:41] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:46:41] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:46:41] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:46:41] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:46:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:46:42] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:46:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:46:42] [comm] Using global sharding
[2023-06-29 08:46:42] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:46:42] [training] Using 1 GPUs
[2023-06-29 08:46:42] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:46:42] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:46:42] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:46:42] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:46:54] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:46:54] [valid] No post-processing script given for validating translator
[2023-06-29 08:46:54] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:46:54] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:46:54] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:46:54] [comm] Using global sharding
[2023-06-29 08:46:54] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:46:54] [training] Using 1 GPUs
[2023-06-29 08:46:54] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:46:55] Loading Adam parameters
[2023-06-29 08:46:56] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:46:56] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:46:56] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:46:56] [data] Restoring the corpus state to epoch 71, batch 7793
[2023-06-29 08:46:56] [data] Shuffling data
[2023-06-29 08:46:56] [data] Done reading 20,192 sentences
[2023-06-29 08:46:56] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:46:56] Training started
[2023-06-29 08:46:56] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:46:56] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:46:56] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:47:34] Seen 16,611 samples
[2023-06-29 08:47:34] Starting data epoch 72 in logical epoch 72
[2023-06-29 08:47:34] [data] Shuffling data
[2023-06-29 08:47:34] [data] Done reading 20,192 sentences
[2023-06-29 08:47:34] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:48:07] Ep. 72 : Up. 8000 : Sen. 14,374 : Cost 1.60703480 * 3,099,328 @ 3,634 after 24,818,603 : Time 72.87s : 42532.76 words/s : gNorm 1.1577
[2023-06-29 08:48:13] Seen 16,611 samples
[2023-06-29 08:48:13] Starting data epoch 73 in logical epoch 73
[2023-06-29 08:48:13] [data] Shuffling data
[2023-06-29 08:48:13] [data] Done reading 20,192 sentences
[2023-06-29 08:48:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:48:53] Seen 16,611 samples
[2023-06-29 08:48:53] Starting data epoch 74 in logical epoch 74
[2023-06-29 08:48:53] [data] Shuffling data
[2023-06-29 08:48:53] [data] Done reading 20,192 sentences
[2023-06-29 08:48:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:49:32] Seen 16,611 samples
[2023-06-29 08:49:32] Starting data epoch 75 in logical epoch 75
[2023-06-29 08:49:32] [data] Shuffling data
[2023-06-29 08:49:32] [data] Done reading 20,192 sentences
[2023-06-29 08:49:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:50:12] Seen 16,611 samples
[2023-06-29 08:50:12] Starting data epoch 76 in logical epoch 76
[2023-06-29 08:50:12] [data] Shuffling data
[2023-06-29 08:50:12] [data] Done reading 20,192 sentences
[2023-06-29 08:50:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:50:51] Seen 16,611 samples
[2023-06-29 08:50:51] Starting data epoch 77 in logical epoch 77
[2023-06-29 08:50:51] [data] Shuffling data
[2023-06-29 08:50:51] [data] Done reading 20,192 sentences
[2023-06-29 08:50:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:51:30] Seen 16,611 samples
[2023-06-29 08:51:30] Starting data epoch 78 in logical epoch 78
[2023-06-29 08:51:30] [data] Shuffling data
[2023-06-29 08:51:30] [data] Done reading 20,192 sentences
[2023-06-29 08:51:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:52:10] Seen 16,611 samples
[2023-06-29 08:52:10] Starting data epoch 79 in logical epoch 79
[2023-06-29 08:52:10] [data] Shuffling data
[2023-06-29 08:52:10] [data] Done reading 20,192 sentences
[2023-06-29 08:52:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:52:49] Seen 16,611 samples
[2023-06-29 08:52:49] Starting data epoch 80 in logical epoch 80
[2023-06-29 08:52:49] [data] Shuffling data
[2023-06-29 08:52:49] [data] Done reading 20,192 sentences
[2023-06-29 08:52:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:53:28] Seen 16,611 samples
[2023-06-29 08:53:28] Starting data epoch 81 in logical epoch 81
[2023-06-29 08:53:28] Training finished
[2023-06-29 08:53:40] [valid] Ep. 81 : Up. 8906 : cross-entropy : 254.005 : stalled 5 times (last best: 240.973)
[2023-06-29 08:54:28] [valid] Ep. 81 : Up. 8906 : translation : 0 : new best
[2023-06-29 08:54:28] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:54:29] Saving Adam parameters
[2023-06-29 08:54:30] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:54:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:54:38] [marian] Running on node20.datos.cluster.uy as process 16264 with command line:
[2023-06-29 08:54:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 90 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 08:54:38] [config] after: 0e
[2023-06-29 08:54:38] [config] after-batches: 0
[2023-06-29 08:54:38] [config] after-epochs: 90
[2023-06-29 08:54:38] [config] all-caps-every: 0
[2023-06-29 08:54:38] [config] allow-unk: false
[2023-06-29 08:54:38] [config] authors: false
[2023-06-29 08:54:38] [config] beam-size: 6
[2023-06-29 08:54:38] [config] bert-class-symbol: "[CLS]"
[2023-06-29 08:54:38] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 08:54:38] [config] bert-masking-fraction: 0.15
[2023-06-29 08:54:38] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 08:54:38] [config] bert-train-type-embeddings: true
[2023-06-29 08:54:38] [config] bert-type-vocab-size: 2
[2023-06-29 08:54:38] [config] build-info: ""
[2023-06-29 08:54:38] [config] check-gradient-nan: false
[2023-06-29 08:54:38] [config] check-nan: false
[2023-06-29 08:54:38] [config] cite: false
[2023-06-29 08:54:38] [config] clip-norm: 1
[2023-06-29 08:54:38] [config] cost-scaling:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] cost-type: ce-sum
[2023-06-29 08:54:38] [config] cpu-threads: 0
[2023-06-29 08:54:38] [config] data-threads: 8
[2023-06-29 08:54:38] [config] data-weighting: ""
[2023-06-29 08:54:38] [config] data-weighting-type: sentence
[2023-06-29 08:54:38] [config] dec-cell: gru
[2023-06-29 08:54:38] [config] dec-cell-base-depth: 2
[2023-06-29 08:54:38] [config] dec-cell-high-depth: 1
[2023-06-29 08:54:38] [config] dec-depth: 1
[2023-06-29 08:54:38] [config] devices:
[2023-06-29 08:54:38] [config]   - 0
[2023-06-29 08:54:38] [config] dim-emb: 512
[2023-06-29 08:54:38] [config] dim-rnn: 1024
[2023-06-29 08:54:38] [config] dim-vocabs:
[2023-06-29 08:54:38] [config]   - 16384
[2023-06-29 08:54:38] [config]   - 16384
[2023-06-29 08:54:38] [config] disp-first: 0
[2023-06-29 08:54:38] [config] disp-freq: 1000u
[2023-06-29 08:54:38] [config] disp-label-counts: true
[2023-06-29 08:54:38] [config] dropout-rnn: 0.2
[2023-06-29 08:54:38] [config] dropout-src: 0.1
[2023-06-29 08:54:38] [config] dropout-trg: 0.1
[2023-06-29 08:54:38] [config] dump-config: ""
[2023-06-29 08:54:38] [config] dynamic-gradient-scaling:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] early-stopping: 10
[2023-06-29 08:54:38] [config] early-stopping-on: first
[2023-06-29 08:54:38] [config] embedding-fix-src: false
[2023-06-29 08:54:38] [config] embedding-fix-trg: false
[2023-06-29 08:54:38] [config] embedding-normalization: false
[2023-06-29 08:54:38] [config] embedding-vectors:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] enc-cell: gru
[2023-06-29 08:54:38] [config] enc-cell-depth: 1
[2023-06-29 08:54:38] [config] enc-depth: 1
[2023-06-29 08:54:38] [config] enc-type: bidirectional
[2023-06-29 08:54:38] [config] english-title-case-every: 0
[2023-06-29 08:54:38] [config] exponential-smoothing: 0
[2023-06-29 08:54:38] [config] factor-weight: 1
[2023-06-29 08:54:38] [config] factors-combine: sum
[2023-06-29 08:54:38] [config] factors-dim-emb: 0
[2023-06-29 08:54:38] [config] gradient-checkpointing: false
[2023-06-29 08:54:38] [config] gradient-norm-average-window: 100
[2023-06-29 08:54:38] [config] guided-alignment: none
[2023-06-29 08:54:38] [config] guided-alignment-cost: mse
[2023-06-29 08:54:38] [config] guided-alignment-weight: 0.1
[2023-06-29 08:54:38] [config] ignore-model-config: false
[2023-06-29 08:54:38] [config] input-types:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] interpolate-env-vars: false
[2023-06-29 08:54:38] [config] keep-best: false
[2023-06-29 08:54:38] [config] label-smoothing: 0
[2023-06-29 08:54:38] [config] layer-normalization: true
[2023-06-29 08:54:38] [config] learn-rate: 0.0001
[2023-06-29 08:54:38] [config] lemma-dependency: ""
[2023-06-29 08:54:38] [config] lemma-dim-emb: 0
[2023-06-29 08:54:38] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 08:54:38] [config] log-level: info
[2023-06-29 08:54:38] [config] log-time-zone: ""
[2023-06-29 08:54:38] [config] logical-epoch:
[2023-06-29 08:54:38] [config]   - 1e
[2023-06-29 08:54:38] [config]   - 0
[2023-06-29 08:54:38] [config] lr-decay: 0
[2023-06-29 08:54:38] [config] lr-decay-freq: 50000
[2023-06-29 08:54:38] [config] lr-decay-inv-sqrt:
[2023-06-29 08:54:38] [config]   - 0
[2023-06-29 08:54:38] [config] lr-decay-repeat-warmup: false
[2023-06-29 08:54:38] [config] lr-decay-reset-optimizer: false
[2023-06-29 08:54:38] [config] lr-decay-start:
[2023-06-29 08:54:38] [config]   - 10
[2023-06-29 08:54:38] [config]   - 1
[2023-06-29 08:54:38] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 08:54:38] [config] lr-report: false
[2023-06-29 08:54:38] [config] lr-warmup: 0
[2023-06-29 08:54:38] [config] lr-warmup-at-reload: false
[2023-06-29 08:54:38] [config] lr-warmup-cycle: false
[2023-06-29 08:54:38] [config] lr-warmup-start-rate: 0
[2023-06-29 08:54:38] [config] max-length: 50
[2023-06-29 08:54:38] [config] max-length-crop: false
[2023-06-29 08:54:38] [config] max-length-factor: 3
[2023-06-29 08:54:38] [config] maxi-batch: 100
[2023-06-29 08:54:38] [config] maxi-batch-sort: trg
[2023-06-29 08:54:38] [config] mini-batch: 64
[2023-06-29 08:54:38] [config] mini-batch-fit: true
[2023-06-29 08:54:38] [config] mini-batch-fit-step: 10
[2023-06-29 08:54:38] [config] mini-batch-round-up: true
[2023-06-29 08:54:38] [config] mini-batch-track-lr: false
[2023-06-29 08:54:38] [config] mini-batch-warmup: 0
[2023-06-29 08:54:38] [config] mini-batch-words: 0
[2023-06-29 08:54:38] [config] mini-batch-words-ref: 0
[2023-06-29 08:54:38] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:54:38] [config] multi-loss-type: sum
[2023-06-29 08:54:38] [config] n-best: false
[2023-06-29 08:54:38] [config] no-nccl: false
[2023-06-29 08:54:38] [config] no-reload: false
[2023-06-29 08:54:38] [config] no-restore-corpus: false
[2023-06-29 08:54:38] [config] normalize: 0.6
[2023-06-29 08:54:38] [config] normalize-gradient: false
[2023-06-29 08:54:38] [config] num-devices: 0
[2023-06-29 08:54:38] [config] optimizer: adam
[2023-06-29 08:54:38] [config] optimizer-delay: 1
[2023-06-29 08:54:38] [config] optimizer-params:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] output-omit-bias: false
[2023-06-29 08:54:38] [config] overwrite: true
[2023-06-29 08:54:38] [config] precision:
[2023-06-29 08:54:38] [config]   - float32
[2023-06-29 08:54:38] [config]   - float32
[2023-06-29 08:54:38] [config] pretrained-model: ""
[2023-06-29 08:54:38] [config] quantize-biases: false
[2023-06-29 08:54:38] [config] quantize-bits: 0
[2023-06-29 08:54:38] [config] quantize-log-based: false
[2023-06-29 08:54:38] [config] quantize-optimization-steps: 0
[2023-06-29 08:54:38] [config] quiet: false
[2023-06-29 08:54:38] [config] quiet-translation: true
[2023-06-29 08:54:38] [config] relative-paths: false
[2023-06-29 08:54:38] [config] right-left: false
[2023-06-29 08:54:38] [config] save-freq: 10000u
[2023-06-29 08:54:38] [config] seed: 1234
[2023-06-29 08:54:38] [config] sentencepiece-alphas:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] sentencepiece-max-lines: 2000000
[2023-06-29 08:54:38] [config] sentencepiece-options: ""
[2023-06-29 08:54:38] [config] sharding: global
[2023-06-29 08:54:38] [config] shuffle: data
[2023-06-29 08:54:38] [config] shuffle-in-ram: false
[2023-06-29 08:54:38] [config] sigterm: save-and-exit
[2023-06-29 08:54:38] [config] skip: false
[2023-06-29 08:54:38] [config] sqlite: ""
[2023-06-29 08:54:38] [config] sqlite-drop: false
[2023-06-29 08:54:38] [config] sync-freq: 200u
[2023-06-29 08:54:38] [config] sync-sgd: false
[2023-06-29 08:54:38] [config] tempdir: /tmp
[2023-06-29 08:54:38] [config] tied-embeddings: false
[2023-06-29 08:54:38] [config] tied-embeddings-all: true
[2023-06-29 08:54:38] [config] tied-embeddings-src: false
[2023-06-29 08:54:38] [config] train-embedder-rank:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] train-sets:
[2023-06-29 08:54:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 08:54:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 08:54:38] [config] transformer-aan-activation: swish
[2023-06-29 08:54:38] [config] transformer-aan-depth: 2
[2023-06-29 08:54:38] [config] transformer-aan-nogate: false
[2023-06-29 08:54:38] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 08:54:38] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 08:54:38] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 08:54:38] [config] transformer-depth-scaling: false
[2023-06-29 08:54:38] [config] transformer-dim-aan: 2048
[2023-06-29 08:54:38] [config] transformer-dim-ffn: 2048
[2023-06-29 08:54:38] [config] transformer-dropout: 0
[2023-06-29 08:54:38] [config] transformer-dropout-attention: 0
[2023-06-29 08:54:38] [config] transformer-dropout-ffn: 0
[2023-06-29 08:54:38] [config] transformer-ffn-activation: swish
[2023-06-29 08:54:38] [config] transformer-ffn-depth: 2
[2023-06-29 08:54:38] [config] transformer-guided-alignment-layer: last
[2023-06-29 08:54:38] [config] transformer-heads: 8
[2023-06-29 08:54:38] [config] transformer-no-projection: false
[2023-06-29 08:54:38] [config] transformer-pool: false
[2023-06-29 08:54:38] [config] transformer-postprocess: dan
[2023-06-29 08:54:38] [config] transformer-postprocess-emb: d
[2023-06-29 08:54:38] [config] transformer-postprocess-top: ""
[2023-06-29 08:54:38] [config] transformer-preprocess: ""
[2023-06-29 08:54:38] [config] transformer-tied-layers:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] transformer-train-position-embeddings: false
[2023-06-29 08:54:38] [config] tsv: false
[2023-06-29 08:54:38] [config] tsv-fields: 0
[2023-06-29 08:54:38] [config] type: amun
[2023-06-29 08:54:38] [config] ulr: false
[2023-06-29 08:54:38] [config] ulr-dim-emb: 0
[2023-06-29 08:54:38] [config] ulr-dropout: 0
[2023-06-29 08:54:38] [config] ulr-keys-vectors: ""
[2023-06-29 08:54:38] [config] ulr-query-vectors: ""
[2023-06-29 08:54:38] [config] ulr-softmax-temperature: 1
[2023-06-29 08:54:38] [config] ulr-trainable-transformation: false
[2023-06-29 08:54:38] [config] unlikelihood-loss: false
[2023-06-29 08:54:38] [config] valid-freq: 50000000
[2023-06-29 08:54:38] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 08:54:38] [config] valid-max-length: 1000
[2023-06-29 08:54:38] [config] valid-metrics:
[2023-06-29 08:54:38] [config]   - cross-entropy
[2023-06-29 08:54:38] [config]   - translation
[2023-06-29 08:54:38] [config] valid-mini-batch: 32
[2023-06-29 08:54:38] [config] valid-reset-stalled: false
[2023-06-29 08:54:38] [config] valid-script-args:
[2023-06-29 08:54:38] [config]   []
[2023-06-29 08:54:38] [config] valid-script-path: ""
[2023-06-29 08:54:38] [config] valid-sets:
[2023-06-29 08:54:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 08:54:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 08:54:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 08:54:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:54:38] [config] vocabs:
[2023-06-29 08:54:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:54:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:54:38] [config] word-penalty: 0
[2023-06-29 08:54:38] [config] word-scores: false
[2023-06-29 08:54:38] [config] workspace: 3000
[2023-06-29 08:54:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 08:54:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:54:38] [training] Using single-device training
[2023-06-29 08:54:39] Synced seed 1234
[2023-06-29 08:54:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 08:54:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 08:54:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 08:54:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 08:54:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 08:54:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:54:39] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:54:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:54:39] [comm] Using global sharding
[2023-06-29 08:54:40] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:54:40] [training] Using 1 GPUs
[2023-06-29 08:54:40] [logits] Applying loss function for 1 factor(s)
[2023-06-29 08:54:40] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:54:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 08:54:40] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:54:52] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 08:54:52] [valid] No post-processing script given for validating translator
[2023-06-29 08:54:52] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 08:54:52] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 08:54:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 08:54:52] [comm] Using global sharding
[2023-06-29 08:54:52] [comm] NCCLCommunicators constructed successfully
[2023-06-29 08:54:52] [training] Using 1 GPUs
[2023-06-29 08:54:52] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 08:54:53] Loading Adam parameters
[2023-06-29 08:54:54] [memory] Reserving 322 MB, device gpu0
[2023-06-29 08:54:54] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:54:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 08:54:54] [data] Restoring the corpus state to epoch 81, batch 8906
[2023-06-29 08:54:54] [data] Shuffling data
[2023-06-29 08:54:54] [data] Done reading 20,192 sentences
[2023-06-29 08:54:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:54:54] Training started
[2023-06-29 08:54:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 08:54:54] [memory] Reserving 161 MB, device gpu0
[2023-06-29 08:54:54] Parameter type float32, optimization type float32, casting types false
[2023-06-29 08:55:25] Ep. 81 : Up. 9000 : Sen. 14,356 : Cost 1.38116801 * 3,102,114 @ 3,372 after 27,920,717 : Time 32.92s : 94223.12 words/s : gNorm 1.2216
[2023-06-29 08:55:32] Seen 16,611 samples
[2023-06-29 08:55:32] Starting data epoch 82 in logical epoch 82
[2023-06-29 08:55:32] [data] Shuffling data
[2023-06-29 08:55:32] [data] Done reading 20,192 sentences
[2023-06-29 08:55:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:56:11] Seen 16,611 samples
[2023-06-29 08:56:11] Starting data epoch 83 in logical epoch 83
[2023-06-29 08:56:11] [data] Shuffling data
[2023-06-29 08:56:11] [data] Done reading 20,192 sentences
[2023-06-29 08:56:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:56:51] Seen 16,611 samples
[2023-06-29 08:56:51] Starting data epoch 84 in logical epoch 84
[2023-06-29 08:56:51] [data] Shuffling data
[2023-06-29 08:56:51] [data] Done reading 20,192 sentences
[2023-06-29 08:56:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:57:30] Seen 16,611 samples
[2023-06-29 08:57:30] Starting data epoch 85 in logical epoch 85
[2023-06-29 08:57:30] [data] Shuffling data
[2023-06-29 08:57:30] [data] Done reading 20,192 sentences
[2023-06-29 08:57:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:58:10] Seen 16,611 samples
[2023-06-29 08:58:10] Starting data epoch 86 in logical epoch 86
[2023-06-29 08:58:10] [data] Shuffling data
[2023-06-29 08:58:10] [data] Done reading 20,192 sentences
[2023-06-29 08:58:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:58:50] Seen 16,611 samples
[2023-06-29 08:58:50] Starting data epoch 87 in logical epoch 87
[2023-06-29 08:58:50] [data] Shuffling data
[2023-06-29 08:58:50] [data] Done reading 20,192 sentences
[2023-06-29 08:58:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 08:59:29] Seen 16,611 samples
[2023-06-29 08:59:29] Starting data epoch 88 in logical epoch 88
[2023-06-29 08:59:29] [data] Shuffling data
[2023-06-29 08:59:29] [data] Done reading 20,192 sentences
[2023-06-29 08:59:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:00:09] Seen 16,611 samples
[2023-06-29 09:00:09] Starting data epoch 89 in logical epoch 89
[2023-06-29 09:00:09] [data] Shuffling data
[2023-06-29 09:00:09] [data] Done reading 20,192 sentences
[2023-06-29 09:00:09] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:00:48] Seen 16,611 samples
[2023-06-29 09:00:48] Starting data epoch 90 in logical epoch 90
[2023-06-29 09:00:48] [data] Shuffling data
[2023-06-29 09:00:48] [data] Done reading 20,192 sentences
[2023-06-29 09:00:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:01:20] Ep. 90 : Up. 10000 : Sen. 13,654 : Cost 1.18343174 * 3,097,056 @ 4,194 after 31,017,773 : Time 354.43s : 8738.05 words/s : gNorm 1.1635
[2023-06-29 09:01:20] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:01:21] Saving Adam parameters
[2023-06-29 09:01:22] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:01:32] Seen 16,611 samples
[2023-06-29 09:01:32] Starting data epoch 91 in logical epoch 91
[2023-06-29 09:01:32] Training finished
[2023-06-29 09:01:44] [valid] Ep. 91 : Up. 10021 : cross-entropy : 256.337 : stalled 6 times (last best: 240.973)
[2023-06-29 09:02:31] [valid] Ep. 91 : Up. 10021 : translation : 0 : new best
[2023-06-29 09:02:31] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:02:33] Saving Adam parameters
[2023-06-29 09:02:33] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:02:41] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:02:41] [marian] Running on node20.datos.cluster.uy as process 16752 with command line:
[2023-06-29 09:02:41] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 100 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:02:41] [config] after: 0e
[2023-06-29 09:02:41] [config] after-batches: 0
[2023-06-29 09:02:41] [config] after-epochs: 100
[2023-06-29 09:02:41] [config] all-caps-every: 0
[2023-06-29 09:02:41] [config] allow-unk: false
[2023-06-29 09:02:41] [config] authors: false
[2023-06-29 09:02:41] [config] beam-size: 6
[2023-06-29 09:02:41] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:02:41] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:02:41] [config] bert-masking-fraction: 0.15
[2023-06-29 09:02:41] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:02:41] [config] bert-train-type-embeddings: true
[2023-06-29 09:02:41] [config] bert-type-vocab-size: 2
[2023-06-29 09:02:41] [config] build-info: ""
[2023-06-29 09:02:41] [config] check-gradient-nan: false
[2023-06-29 09:02:41] [config] check-nan: false
[2023-06-29 09:02:41] [config] cite: false
[2023-06-29 09:02:41] [config] clip-norm: 1
[2023-06-29 09:02:41] [config] cost-scaling:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] cost-type: ce-sum
[2023-06-29 09:02:41] [config] cpu-threads: 0
[2023-06-29 09:02:41] [config] data-threads: 8
[2023-06-29 09:02:41] [config] data-weighting: ""
[2023-06-29 09:02:41] [config] data-weighting-type: sentence
[2023-06-29 09:02:41] [config] dec-cell: gru
[2023-06-29 09:02:41] [config] dec-cell-base-depth: 2
[2023-06-29 09:02:41] [config] dec-cell-high-depth: 1
[2023-06-29 09:02:41] [config] dec-depth: 1
[2023-06-29 09:02:41] [config] devices:
[2023-06-29 09:02:41] [config]   - 0
[2023-06-29 09:02:41] [config] dim-emb: 512
[2023-06-29 09:02:41] [config] dim-rnn: 1024
[2023-06-29 09:02:41] [config] dim-vocabs:
[2023-06-29 09:02:41] [config]   - 16384
[2023-06-29 09:02:41] [config]   - 16384
[2023-06-29 09:02:41] [config] disp-first: 0
[2023-06-29 09:02:41] [config] disp-freq: 1000u
[2023-06-29 09:02:41] [config] disp-label-counts: true
[2023-06-29 09:02:41] [config] dropout-rnn: 0.2
[2023-06-29 09:02:41] [config] dropout-src: 0.1
[2023-06-29 09:02:41] [config] dropout-trg: 0.1
[2023-06-29 09:02:41] [config] dump-config: ""
[2023-06-29 09:02:41] [config] dynamic-gradient-scaling:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] early-stopping: 10
[2023-06-29 09:02:41] [config] early-stopping-on: first
[2023-06-29 09:02:41] [config] embedding-fix-src: false
[2023-06-29 09:02:41] [config] embedding-fix-trg: false
[2023-06-29 09:02:41] [config] embedding-normalization: false
[2023-06-29 09:02:41] [config] embedding-vectors:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] enc-cell: gru
[2023-06-29 09:02:41] [config] enc-cell-depth: 1
[2023-06-29 09:02:41] [config] enc-depth: 1
[2023-06-29 09:02:41] [config] enc-type: bidirectional
[2023-06-29 09:02:41] [config] english-title-case-every: 0
[2023-06-29 09:02:41] [config] exponential-smoothing: 0
[2023-06-29 09:02:41] [config] factor-weight: 1
[2023-06-29 09:02:41] [config] factors-combine: sum
[2023-06-29 09:02:41] [config] factors-dim-emb: 0
[2023-06-29 09:02:41] [config] gradient-checkpointing: false
[2023-06-29 09:02:41] [config] gradient-norm-average-window: 100
[2023-06-29 09:02:41] [config] guided-alignment: none
[2023-06-29 09:02:41] [config] guided-alignment-cost: mse
[2023-06-29 09:02:41] [config] guided-alignment-weight: 0.1
[2023-06-29 09:02:41] [config] ignore-model-config: false
[2023-06-29 09:02:41] [config] input-types:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] interpolate-env-vars: false
[2023-06-29 09:02:41] [config] keep-best: false
[2023-06-29 09:02:41] [config] label-smoothing: 0
[2023-06-29 09:02:41] [config] layer-normalization: true
[2023-06-29 09:02:41] [config] learn-rate: 0.0001
[2023-06-29 09:02:41] [config] lemma-dependency: ""
[2023-06-29 09:02:41] [config] lemma-dim-emb: 0
[2023-06-29 09:02:41] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:02:41] [config] log-level: info
[2023-06-29 09:02:41] [config] log-time-zone: ""
[2023-06-29 09:02:41] [config] logical-epoch:
[2023-06-29 09:02:41] [config]   - 1e
[2023-06-29 09:02:41] [config]   - 0
[2023-06-29 09:02:41] [config] lr-decay: 0
[2023-06-29 09:02:41] [config] lr-decay-freq: 50000
[2023-06-29 09:02:41] [config] lr-decay-inv-sqrt:
[2023-06-29 09:02:41] [config]   - 0
[2023-06-29 09:02:41] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:02:41] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:02:41] [config] lr-decay-start:
[2023-06-29 09:02:41] [config]   - 10
[2023-06-29 09:02:41] [config]   - 1
[2023-06-29 09:02:41] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:02:41] [config] lr-report: false
[2023-06-29 09:02:41] [config] lr-warmup: 0
[2023-06-29 09:02:41] [config] lr-warmup-at-reload: false
[2023-06-29 09:02:41] [config] lr-warmup-cycle: false
[2023-06-29 09:02:41] [config] lr-warmup-start-rate: 0
[2023-06-29 09:02:41] [config] max-length: 50
[2023-06-29 09:02:41] [config] max-length-crop: false
[2023-06-29 09:02:41] [config] max-length-factor: 3
[2023-06-29 09:02:41] [config] maxi-batch: 100
[2023-06-29 09:02:41] [config] maxi-batch-sort: trg
[2023-06-29 09:02:41] [config] mini-batch: 64
[2023-06-29 09:02:41] [config] mini-batch-fit: true
[2023-06-29 09:02:41] [config] mini-batch-fit-step: 10
[2023-06-29 09:02:41] [config] mini-batch-round-up: true
[2023-06-29 09:02:41] [config] mini-batch-track-lr: false
[2023-06-29 09:02:41] [config] mini-batch-warmup: 0
[2023-06-29 09:02:41] [config] mini-batch-words: 0
[2023-06-29 09:02:41] [config] mini-batch-words-ref: 0
[2023-06-29 09:02:41] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:02:41] [config] multi-loss-type: sum
[2023-06-29 09:02:41] [config] n-best: false
[2023-06-29 09:02:41] [config] no-nccl: false
[2023-06-29 09:02:41] [config] no-reload: false
[2023-06-29 09:02:41] [config] no-restore-corpus: false
[2023-06-29 09:02:41] [config] normalize: 0.6
[2023-06-29 09:02:41] [config] normalize-gradient: false
[2023-06-29 09:02:41] [config] num-devices: 0
[2023-06-29 09:02:41] [config] optimizer: adam
[2023-06-29 09:02:41] [config] optimizer-delay: 1
[2023-06-29 09:02:41] [config] optimizer-params:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] output-omit-bias: false
[2023-06-29 09:02:41] [config] overwrite: true
[2023-06-29 09:02:41] [config] precision:
[2023-06-29 09:02:41] [config]   - float32
[2023-06-29 09:02:41] [config]   - float32
[2023-06-29 09:02:41] [config] pretrained-model: ""
[2023-06-29 09:02:41] [config] quantize-biases: false
[2023-06-29 09:02:41] [config] quantize-bits: 0
[2023-06-29 09:02:41] [config] quantize-log-based: false
[2023-06-29 09:02:41] [config] quantize-optimization-steps: 0
[2023-06-29 09:02:41] [config] quiet: false
[2023-06-29 09:02:41] [config] quiet-translation: true
[2023-06-29 09:02:41] [config] relative-paths: false
[2023-06-29 09:02:41] [config] right-left: false
[2023-06-29 09:02:41] [config] save-freq: 10000u
[2023-06-29 09:02:41] [config] seed: 1234
[2023-06-29 09:02:41] [config] sentencepiece-alphas:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:02:41] [config] sentencepiece-options: ""
[2023-06-29 09:02:41] [config] sharding: global
[2023-06-29 09:02:41] [config] shuffle: data
[2023-06-29 09:02:41] [config] shuffle-in-ram: false
[2023-06-29 09:02:41] [config] sigterm: save-and-exit
[2023-06-29 09:02:41] [config] skip: false
[2023-06-29 09:02:41] [config] sqlite: ""
[2023-06-29 09:02:41] [config] sqlite-drop: false
[2023-06-29 09:02:41] [config] sync-freq: 200u
[2023-06-29 09:02:41] [config] sync-sgd: false
[2023-06-29 09:02:41] [config] tempdir: /tmp
[2023-06-29 09:02:41] [config] tied-embeddings: false
[2023-06-29 09:02:41] [config] tied-embeddings-all: true
[2023-06-29 09:02:41] [config] tied-embeddings-src: false
[2023-06-29 09:02:41] [config] train-embedder-rank:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] train-sets:
[2023-06-29 09:02:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:02:41] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:02:41] [config] transformer-aan-activation: swish
[2023-06-29 09:02:41] [config] transformer-aan-depth: 2
[2023-06-29 09:02:41] [config] transformer-aan-nogate: false
[2023-06-29 09:02:41] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:02:41] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:02:41] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:02:41] [config] transformer-depth-scaling: false
[2023-06-29 09:02:41] [config] transformer-dim-aan: 2048
[2023-06-29 09:02:41] [config] transformer-dim-ffn: 2048
[2023-06-29 09:02:41] [config] transformer-dropout: 0
[2023-06-29 09:02:41] [config] transformer-dropout-attention: 0
[2023-06-29 09:02:41] [config] transformer-dropout-ffn: 0
[2023-06-29 09:02:41] [config] transformer-ffn-activation: swish
[2023-06-29 09:02:41] [config] transformer-ffn-depth: 2
[2023-06-29 09:02:41] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:02:41] [config] transformer-heads: 8
[2023-06-29 09:02:41] [config] transformer-no-projection: false
[2023-06-29 09:02:41] [config] transformer-pool: false
[2023-06-29 09:02:41] [config] transformer-postprocess: dan
[2023-06-29 09:02:41] [config] transformer-postprocess-emb: d
[2023-06-29 09:02:41] [config] transformer-postprocess-top: ""
[2023-06-29 09:02:41] [config] transformer-preprocess: ""
[2023-06-29 09:02:41] [config] transformer-tied-layers:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] transformer-train-position-embeddings: false
[2023-06-29 09:02:41] [config] tsv: false
[2023-06-29 09:02:41] [config] tsv-fields: 0
[2023-06-29 09:02:41] [config] type: amun
[2023-06-29 09:02:41] [config] ulr: false
[2023-06-29 09:02:41] [config] ulr-dim-emb: 0
[2023-06-29 09:02:41] [config] ulr-dropout: 0
[2023-06-29 09:02:41] [config] ulr-keys-vectors: ""
[2023-06-29 09:02:41] [config] ulr-query-vectors: ""
[2023-06-29 09:02:41] [config] ulr-softmax-temperature: 1
[2023-06-29 09:02:41] [config] ulr-trainable-transformation: false
[2023-06-29 09:02:41] [config] unlikelihood-loss: false
[2023-06-29 09:02:41] [config] valid-freq: 50000000
[2023-06-29 09:02:41] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:02:41] [config] valid-max-length: 1000
[2023-06-29 09:02:41] [config] valid-metrics:
[2023-06-29 09:02:41] [config]   - cross-entropy
[2023-06-29 09:02:41] [config]   - translation
[2023-06-29 09:02:41] [config] valid-mini-batch: 32
[2023-06-29 09:02:41] [config] valid-reset-stalled: false
[2023-06-29 09:02:41] [config] valid-script-args:
[2023-06-29 09:02:41] [config]   []
[2023-06-29 09:02:41] [config] valid-script-path: ""
[2023-06-29 09:02:41] [config] valid-sets:
[2023-06-29 09:02:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:02:41] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:02:41] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:02:41] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:02:41] [config] vocabs:
[2023-06-29 09:02:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:02:41] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:02:41] [config] word-penalty: 0
[2023-06-29 09:02:41] [config] word-scores: false
[2023-06-29 09:02:41] [config] workspace: 3000
[2023-06-29 09:02:41] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:02:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:02:41] [training] Using single-device training
[2023-06-29 09:02:42] Synced seed 1234
[2023-06-29 09:02:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:02:42] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:02:42] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:02:42] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:02:42] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:02:42] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:02:42] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:02:42] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:02:42] [comm] Using global sharding
[2023-06-29 09:02:43] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:02:43] [training] Using 1 GPUs
[2023-06-29 09:02:43] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:02:43] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:02:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:02:43] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:02:55] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:02:55] [valid] No post-processing script given for validating translator
[2023-06-29 09:02:55] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:02:55] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:02:55] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:02:55] [comm] Using global sharding
[2023-06-29 09:02:55] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:02:55] [training] Using 1 GPUs
[2023-06-29 09:02:55] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:02:56] Loading Adam parameters
[2023-06-29 09:02:57] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:02:57] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:02:57] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:02:57] [data] Restoring the corpus state to epoch 91, batch 10021
[2023-06-29 09:02:57] [data] Shuffling data
[2023-06-29 09:02:57] [data] Done reading 20,192 sentences
[2023-06-29 09:02:57] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:02:57] Training started
[2023-06-29 09:02:57] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 09:02:57] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:02:57] Parameter type float32, optimization type float32, casting types false
[2023-06-29 09:03:35] Seen 16,611 samples
[2023-06-29 09:03:35] Starting data epoch 92 in logical epoch 92
[2023-06-29 09:03:35] [data] Shuffling data
[2023-06-29 09:03:35] [data] Done reading 20,192 sentences
[2023-06-29 09:03:35] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:04:14] Seen 16,611 samples
[2023-06-29 09:04:14] Starting data epoch 93 in logical epoch 93
[2023-06-29 09:04:14] [data] Shuffling data
[2023-06-29 09:04:14] [data] Done reading 20,192 sentences
[2023-06-29 09:04:14] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:04:54] Seen 16,611 samples
[2023-06-29 09:04:54] Starting data epoch 94 in logical epoch 94
[2023-06-29 09:04:54] [data] Shuffling data
[2023-06-29 09:04:54] [data] Done reading 20,192 sentences
[2023-06-29 09:04:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:05:33] Seen 16,611 samples
[2023-06-29 09:05:33] Starting data epoch 95 in logical epoch 95
[2023-06-29 09:05:33] [data] Shuffling data
[2023-06-29 09:05:33] [data] Done reading 20,192 sentences
[2023-06-29 09:05:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:06:13] Seen 16,611 samples
[2023-06-29 09:06:13] Starting data epoch 96 in logical epoch 96
[2023-06-29 09:06:13] [data] Shuffling data
[2023-06-29 09:06:13] [data] Done reading 20,192 sentences
[2023-06-29 09:06:13] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:06:52] Seen 16,611 samples
[2023-06-29 09:06:52] Starting data epoch 97 in logical epoch 97
[2023-06-29 09:06:52] [data] Shuffling data
[2023-06-29 09:06:52] [data] Done reading 20,192 sentences
[2023-06-29 09:06:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:07:32] Seen 16,611 samples
[2023-06-29 09:07:32] Starting data epoch 98 in logical epoch 98
[2023-06-29 09:07:32] [data] Shuffling data
[2023-06-29 09:07:32] [data] Done reading 20,192 sentences
[2023-06-29 09:07:32] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:08:11] Seen 16,611 samples
[2023-06-29 09:08:11] Starting data epoch 99 in logical epoch 99
[2023-06-29 09:08:11] [data] Shuffling data
[2023-06-29 09:08:11] [data] Done reading 20,192 sentences
[2023-06-29 09:08:11] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:08:42] Ep. 99 : Up. 11000 : Sen. 12,964 : Cost 1.04593420 * 3,100,590 @ 2,990 after 34,118,363 : Time 346.77s : 8941.39 words/s : gNorm 1.1508
[2023-06-29 09:08:51] Seen 16,611 samples
[2023-06-29 09:08:51] Starting data epoch 100 in logical epoch 100
[2023-06-29 09:08:51] [data] Shuffling data
[2023-06-29 09:08:51] [data] Done reading 20,192 sentences
[2023-06-29 09:08:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:09:30] Seen 16,611 samples
[2023-06-29 09:09:30] Starting data epoch 101 in logical epoch 101
[2023-06-29 09:09:30] Training finished
[2023-06-29 09:09:42] [valid] Ep. 101 : Up. 11137 : cross-entropy : 258.718 : stalled 7 times (last best: 240.973)
[2023-06-29 09:10:29] [valid] Ep. 101 : Up. 11137 : translation : 0 : new best
[2023-06-29 09:10:29] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:10:31] Saving Adam parameters
[2023-06-29 09:10:31] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:10:38] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:10:38] [marian] Running on node20.datos.cluster.uy as process 17534 with command line:
[2023-06-29 09:10:38] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 110 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:10:38] [config] after: 0e
[2023-06-29 09:10:38] [config] after-batches: 0
[2023-06-29 09:10:38] [config] after-epochs: 110
[2023-06-29 09:10:38] [config] all-caps-every: 0
[2023-06-29 09:10:38] [config] allow-unk: false
[2023-06-29 09:10:38] [config] authors: false
[2023-06-29 09:10:38] [config] beam-size: 6
[2023-06-29 09:10:38] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:10:38] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:10:38] [config] bert-masking-fraction: 0.15
[2023-06-29 09:10:38] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:10:38] [config] bert-train-type-embeddings: true
[2023-06-29 09:10:38] [config] bert-type-vocab-size: 2
[2023-06-29 09:10:38] [config] build-info: ""
[2023-06-29 09:10:38] [config] check-gradient-nan: false
[2023-06-29 09:10:38] [config] check-nan: false
[2023-06-29 09:10:38] [config] cite: false
[2023-06-29 09:10:38] [config] clip-norm: 1
[2023-06-29 09:10:38] [config] cost-scaling:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] cost-type: ce-sum
[2023-06-29 09:10:38] [config] cpu-threads: 0
[2023-06-29 09:10:38] [config] data-threads: 8
[2023-06-29 09:10:38] [config] data-weighting: ""
[2023-06-29 09:10:38] [config] data-weighting-type: sentence
[2023-06-29 09:10:38] [config] dec-cell: gru
[2023-06-29 09:10:38] [config] dec-cell-base-depth: 2
[2023-06-29 09:10:38] [config] dec-cell-high-depth: 1
[2023-06-29 09:10:38] [config] dec-depth: 1
[2023-06-29 09:10:38] [config] devices:
[2023-06-29 09:10:38] [config]   - 0
[2023-06-29 09:10:38] [config] dim-emb: 512
[2023-06-29 09:10:38] [config] dim-rnn: 1024
[2023-06-29 09:10:38] [config] dim-vocabs:
[2023-06-29 09:10:38] [config]   - 16384
[2023-06-29 09:10:38] [config]   - 16384
[2023-06-29 09:10:38] [config] disp-first: 0
[2023-06-29 09:10:38] [config] disp-freq: 1000u
[2023-06-29 09:10:38] [config] disp-label-counts: true
[2023-06-29 09:10:38] [config] dropout-rnn: 0.2
[2023-06-29 09:10:38] [config] dropout-src: 0.1
[2023-06-29 09:10:38] [config] dropout-trg: 0.1
[2023-06-29 09:10:38] [config] dump-config: ""
[2023-06-29 09:10:38] [config] dynamic-gradient-scaling:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] early-stopping: 10
[2023-06-29 09:10:38] [config] early-stopping-on: first
[2023-06-29 09:10:38] [config] embedding-fix-src: false
[2023-06-29 09:10:38] [config] embedding-fix-trg: false
[2023-06-29 09:10:38] [config] embedding-normalization: false
[2023-06-29 09:10:38] [config] embedding-vectors:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] enc-cell: gru
[2023-06-29 09:10:38] [config] enc-cell-depth: 1
[2023-06-29 09:10:38] [config] enc-depth: 1
[2023-06-29 09:10:38] [config] enc-type: bidirectional
[2023-06-29 09:10:38] [config] english-title-case-every: 0
[2023-06-29 09:10:38] [config] exponential-smoothing: 0
[2023-06-29 09:10:38] [config] factor-weight: 1
[2023-06-29 09:10:38] [config] factors-combine: sum
[2023-06-29 09:10:38] [config] factors-dim-emb: 0
[2023-06-29 09:10:38] [config] gradient-checkpointing: false
[2023-06-29 09:10:38] [config] gradient-norm-average-window: 100
[2023-06-29 09:10:38] [config] guided-alignment: none
[2023-06-29 09:10:38] [config] guided-alignment-cost: mse
[2023-06-29 09:10:38] [config] guided-alignment-weight: 0.1
[2023-06-29 09:10:38] [config] ignore-model-config: false
[2023-06-29 09:10:38] [config] input-types:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] interpolate-env-vars: false
[2023-06-29 09:10:38] [config] keep-best: false
[2023-06-29 09:10:38] [config] label-smoothing: 0
[2023-06-29 09:10:38] [config] layer-normalization: true
[2023-06-29 09:10:38] [config] learn-rate: 0.0001
[2023-06-29 09:10:38] [config] lemma-dependency: ""
[2023-06-29 09:10:38] [config] lemma-dim-emb: 0
[2023-06-29 09:10:38] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:10:38] [config] log-level: info
[2023-06-29 09:10:38] [config] log-time-zone: ""
[2023-06-29 09:10:38] [config] logical-epoch:
[2023-06-29 09:10:38] [config]   - 1e
[2023-06-29 09:10:38] [config]   - 0
[2023-06-29 09:10:38] [config] lr-decay: 0
[2023-06-29 09:10:38] [config] lr-decay-freq: 50000
[2023-06-29 09:10:38] [config] lr-decay-inv-sqrt:
[2023-06-29 09:10:38] [config]   - 0
[2023-06-29 09:10:38] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:10:38] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:10:38] [config] lr-decay-start:
[2023-06-29 09:10:38] [config]   - 10
[2023-06-29 09:10:38] [config]   - 1
[2023-06-29 09:10:38] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:10:38] [config] lr-report: false
[2023-06-29 09:10:38] [config] lr-warmup: 0
[2023-06-29 09:10:38] [config] lr-warmup-at-reload: false
[2023-06-29 09:10:38] [config] lr-warmup-cycle: false
[2023-06-29 09:10:38] [config] lr-warmup-start-rate: 0
[2023-06-29 09:10:38] [config] max-length: 50
[2023-06-29 09:10:38] [config] max-length-crop: false
[2023-06-29 09:10:38] [config] max-length-factor: 3
[2023-06-29 09:10:38] [config] maxi-batch: 100
[2023-06-29 09:10:38] [config] maxi-batch-sort: trg
[2023-06-29 09:10:38] [config] mini-batch: 64
[2023-06-29 09:10:38] [config] mini-batch-fit: true
[2023-06-29 09:10:38] [config] mini-batch-fit-step: 10
[2023-06-29 09:10:38] [config] mini-batch-round-up: true
[2023-06-29 09:10:38] [config] mini-batch-track-lr: false
[2023-06-29 09:10:38] [config] mini-batch-warmup: 0
[2023-06-29 09:10:38] [config] mini-batch-words: 0
[2023-06-29 09:10:38] [config] mini-batch-words-ref: 0
[2023-06-29 09:10:38] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:10:38] [config] multi-loss-type: sum
[2023-06-29 09:10:38] [config] n-best: false
[2023-06-29 09:10:38] [config] no-nccl: false
[2023-06-29 09:10:38] [config] no-reload: false
[2023-06-29 09:10:38] [config] no-restore-corpus: false
[2023-06-29 09:10:38] [config] normalize: 0.6
[2023-06-29 09:10:38] [config] normalize-gradient: false
[2023-06-29 09:10:38] [config] num-devices: 0
[2023-06-29 09:10:38] [config] optimizer: adam
[2023-06-29 09:10:38] [config] optimizer-delay: 1
[2023-06-29 09:10:38] [config] optimizer-params:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] output-omit-bias: false
[2023-06-29 09:10:38] [config] overwrite: true
[2023-06-29 09:10:38] [config] precision:
[2023-06-29 09:10:38] [config]   - float32
[2023-06-29 09:10:38] [config]   - float32
[2023-06-29 09:10:38] [config] pretrained-model: ""
[2023-06-29 09:10:38] [config] quantize-biases: false
[2023-06-29 09:10:38] [config] quantize-bits: 0
[2023-06-29 09:10:38] [config] quantize-log-based: false
[2023-06-29 09:10:38] [config] quantize-optimization-steps: 0
[2023-06-29 09:10:38] [config] quiet: false
[2023-06-29 09:10:38] [config] quiet-translation: true
[2023-06-29 09:10:38] [config] relative-paths: false
[2023-06-29 09:10:38] [config] right-left: false
[2023-06-29 09:10:38] [config] save-freq: 10000u
[2023-06-29 09:10:38] [config] seed: 1234
[2023-06-29 09:10:38] [config] sentencepiece-alphas:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:10:38] [config] sentencepiece-options: ""
[2023-06-29 09:10:38] [config] sharding: global
[2023-06-29 09:10:38] [config] shuffle: data
[2023-06-29 09:10:38] [config] shuffle-in-ram: false
[2023-06-29 09:10:38] [config] sigterm: save-and-exit
[2023-06-29 09:10:38] [config] skip: false
[2023-06-29 09:10:38] [config] sqlite: ""
[2023-06-29 09:10:38] [config] sqlite-drop: false
[2023-06-29 09:10:38] [config] sync-freq: 200u
[2023-06-29 09:10:38] [config] sync-sgd: false
[2023-06-29 09:10:38] [config] tempdir: /tmp
[2023-06-29 09:10:38] [config] tied-embeddings: false
[2023-06-29 09:10:38] [config] tied-embeddings-all: true
[2023-06-29 09:10:38] [config] tied-embeddings-src: false
[2023-06-29 09:10:38] [config] train-embedder-rank:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] train-sets:
[2023-06-29 09:10:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:10:38] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:10:38] [config] transformer-aan-activation: swish
[2023-06-29 09:10:38] [config] transformer-aan-depth: 2
[2023-06-29 09:10:38] [config] transformer-aan-nogate: false
[2023-06-29 09:10:38] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:10:38] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:10:38] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:10:38] [config] transformer-depth-scaling: false
[2023-06-29 09:10:38] [config] transformer-dim-aan: 2048
[2023-06-29 09:10:38] [config] transformer-dim-ffn: 2048
[2023-06-29 09:10:38] [config] transformer-dropout: 0
[2023-06-29 09:10:38] [config] transformer-dropout-attention: 0
[2023-06-29 09:10:38] [config] transformer-dropout-ffn: 0
[2023-06-29 09:10:38] [config] transformer-ffn-activation: swish
[2023-06-29 09:10:38] [config] transformer-ffn-depth: 2
[2023-06-29 09:10:38] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:10:38] [config] transformer-heads: 8
[2023-06-29 09:10:38] [config] transformer-no-projection: false
[2023-06-29 09:10:38] [config] transformer-pool: false
[2023-06-29 09:10:38] [config] transformer-postprocess: dan
[2023-06-29 09:10:38] [config] transformer-postprocess-emb: d
[2023-06-29 09:10:38] [config] transformer-postprocess-top: ""
[2023-06-29 09:10:38] [config] transformer-preprocess: ""
[2023-06-29 09:10:38] [config] transformer-tied-layers:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] transformer-train-position-embeddings: false
[2023-06-29 09:10:38] [config] tsv: false
[2023-06-29 09:10:38] [config] tsv-fields: 0
[2023-06-29 09:10:38] [config] type: amun
[2023-06-29 09:10:38] [config] ulr: false
[2023-06-29 09:10:38] [config] ulr-dim-emb: 0
[2023-06-29 09:10:38] [config] ulr-dropout: 0
[2023-06-29 09:10:38] [config] ulr-keys-vectors: ""
[2023-06-29 09:10:38] [config] ulr-query-vectors: ""
[2023-06-29 09:10:38] [config] ulr-softmax-temperature: 1
[2023-06-29 09:10:38] [config] ulr-trainable-transformation: false
[2023-06-29 09:10:38] [config] unlikelihood-loss: false
[2023-06-29 09:10:38] [config] valid-freq: 50000000
[2023-06-29 09:10:38] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:10:38] [config] valid-max-length: 1000
[2023-06-29 09:10:38] [config] valid-metrics:
[2023-06-29 09:10:38] [config]   - cross-entropy
[2023-06-29 09:10:38] [config]   - translation
[2023-06-29 09:10:38] [config] valid-mini-batch: 32
[2023-06-29 09:10:38] [config] valid-reset-stalled: false
[2023-06-29 09:10:38] [config] valid-script-args:
[2023-06-29 09:10:38] [config]   []
[2023-06-29 09:10:38] [config] valid-script-path: ""
[2023-06-29 09:10:38] [config] valid-sets:
[2023-06-29 09:10:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:10:38] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:10:38] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:10:38] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:10:38] [config] vocabs:
[2023-06-29 09:10:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:10:38] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:10:38] [config] word-penalty: 0
[2023-06-29 09:10:38] [config] word-scores: false
[2023-06-29 09:10:38] [config] workspace: 3000
[2023-06-29 09:10:38] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:10:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:10:38] [training] Using single-device training
[2023-06-29 09:10:39] Synced seed 1234
[2023-06-29 09:10:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:10:39] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:10:39] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:10:39] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:10:39] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:10:39] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:10:40] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:10:40] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:10:40] [comm] Using global sharding
[2023-06-29 09:10:40] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:10:40] [training] Using 1 GPUs
[2023-06-29 09:10:40] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:10:40] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:10:40] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:10:40] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:10:53] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:10:53] [valid] No post-processing script given for validating translator
[2023-06-29 09:10:53] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:10:53] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:10:53] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:10:53] [comm] Using global sharding
[2023-06-29 09:10:53] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:10:53] [training] Using 1 GPUs
[2023-06-29 09:10:53] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:10:54] Loading Adam parameters
[2023-06-29 09:10:54] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:10:54] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:10:54] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:10:54] [data] Restoring the corpus state to epoch 101, batch 11137
[2023-06-29 09:10:54] [data] Shuffling data
[2023-06-29 09:10:54] [data] Done reading 20,192 sentences
[2023-06-29 09:10:54] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:10:54] Training started
[2023-06-29 09:10:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 09:10:54] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:10:55] Parameter type float32, optimization type float32, casting types false
[2023-06-29 09:11:33] Seen 16,611 samples
[2023-06-29 09:11:33] Starting data epoch 102 in logical epoch 102
[2023-06-29 09:11:33] [data] Shuffling data
[2023-06-29 09:11:33] [data] Done reading 20,192 sentences
[2023-06-29 09:11:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:12:12] Seen 16,611 samples
[2023-06-29 09:12:12] Starting data epoch 103 in logical epoch 103
[2023-06-29 09:12:12] [data] Shuffling data
[2023-06-29 09:12:12] [data] Done reading 20,192 sentences
[2023-06-29 09:12:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:12:51] Seen 16,611 samples
[2023-06-29 09:12:51] Starting data epoch 104 in logical epoch 104
[2023-06-29 09:12:51] [data] Shuffling data
[2023-06-29 09:12:51] [data] Done reading 20,192 sentences
[2023-06-29 09:12:51] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:13:31] Seen 16,611 samples
[2023-06-29 09:13:31] Starting data epoch 105 in logical epoch 105
[2023-06-29 09:13:31] [data] Shuffling data
[2023-06-29 09:13:31] [data] Done reading 20,192 sentences
[2023-06-29 09:13:31] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:14:10] Seen 16,611 samples
[2023-06-29 09:14:10] Starting data epoch 106 in logical epoch 106
[2023-06-29 09:14:10] [data] Shuffling data
[2023-06-29 09:14:10] [data] Done reading 20,192 sentences
[2023-06-29 09:14:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:14:49] Seen 16,611 samples
[2023-06-29 09:14:49] Starting data epoch 107 in logical epoch 107
[2023-06-29 09:14:49] [data] Shuffling data
[2023-06-29 09:14:49] [data] Done reading 20,192 sentences
[2023-06-29 09:14:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:15:29] Seen 16,611 samples
[2023-06-29 09:15:29] Starting data epoch 108 in logical epoch 108
[2023-06-29 09:15:29] [data] Shuffling data
[2023-06-29 09:15:29] [data] Done reading 20,192 sentences
[2023-06-29 09:15:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:15:59] Ep. 108 : Up. 12000 : Sen. 12,894 : Cost 0.89271700 * 3,103,674 @ 177 after 37,222,037 : Time 306.56s : 10124.32 words/s : gNorm 1.0273
[2023-06-29 09:16:08] Seen 16,611 samples
[2023-06-29 09:16:08] Starting data epoch 109 in logical epoch 109
[2023-06-29 09:16:08] [data] Shuffling data
[2023-06-29 09:16:08] [data] Done reading 20,192 sentences
[2023-06-29 09:16:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:16:48] Seen 16,611 samples
[2023-06-29 09:16:48] Starting data epoch 110 in logical epoch 110
[2023-06-29 09:16:48] [data] Shuffling data
[2023-06-29 09:16:48] [data] Done reading 20,192 sentences
[2023-06-29 09:16:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:17:27] Seen 16,611 samples
[2023-06-29 09:17:27] Starting data epoch 111 in logical epoch 111
[2023-06-29 09:17:27] Training finished
[2023-06-29 09:17:39] [valid] Ep. 111 : Up. 12249 : cross-entropy : 260.473 : stalled 8 times (last best: 240.973)
[2023-06-29 09:18:27] [valid] Ep. 111 : Up. 12249 : translation : 0 : new best
[2023-06-29 09:18:27] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:18:29] Saving Adam parameters
[2023-06-29 09:18:29] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:18:37] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:18:37] [marian] Running on node20.datos.cluster.uy as process 18007 with command line:
[2023-06-29 09:18:37] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 120 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:18:37] [config] after: 0e
[2023-06-29 09:18:37] [config] after-batches: 0
[2023-06-29 09:18:37] [config] after-epochs: 120
[2023-06-29 09:18:37] [config] all-caps-every: 0
[2023-06-29 09:18:37] [config] allow-unk: false
[2023-06-29 09:18:37] [config] authors: false
[2023-06-29 09:18:37] [config] beam-size: 6
[2023-06-29 09:18:37] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:18:37] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:18:37] [config] bert-masking-fraction: 0.15
[2023-06-29 09:18:37] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:18:37] [config] bert-train-type-embeddings: true
[2023-06-29 09:18:37] [config] bert-type-vocab-size: 2
[2023-06-29 09:18:37] [config] build-info: ""
[2023-06-29 09:18:37] [config] check-gradient-nan: false
[2023-06-29 09:18:37] [config] check-nan: false
[2023-06-29 09:18:37] [config] cite: false
[2023-06-29 09:18:37] [config] clip-norm: 1
[2023-06-29 09:18:37] [config] cost-scaling:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] cost-type: ce-sum
[2023-06-29 09:18:37] [config] cpu-threads: 0
[2023-06-29 09:18:37] [config] data-threads: 8
[2023-06-29 09:18:37] [config] data-weighting: ""
[2023-06-29 09:18:37] [config] data-weighting-type: sentence
[2023-06-29 09:18:37] [config] dec-cell: gru
[2023-06-29 09:18:37] [config] dec-cell-base-depth: 2
[2023-06-29 09:18:37] [config] dec-cell-high-depth: 1
[2023-06-29 09:18:37] [config] dec-depth: 1
[2023-06-29 09:18:37] [config] devices:
[2023-06-29 09:18:37] [config]   - 0
[2023-06-29 09:18:37] [config] dim-emb: 512
[2023-06-29 09:18:37] [config] dim-rnn: 1024
[2023-06-29 09:18:37] [config] dim-vocabs:
[2023-06-29 09:18:37] [config]   - 16384
[2023-06-29 09:18:37] [config]   - 16384
[2023-06-29 09:18:37] [config] disp-first: 0
[2023-06-29 09:18:37] [config] disp-freq: 1000u
[2023-06-29 09:18:37] [config] disp-label-counts: true
[2023-06-29 09:18:37] [config] dropout-rnn: 0.2
[2023-06-29 09:18:37] [config] dropout-src: 0.1
[2023-06-29 09:18:37] [config] dropout-trg: 0.1
[2023-06-29 09:18:37] [config] dump-config: ""
[2023-06-29 09:18:37] [config] dynamic-gradient-scaling:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] early-stopping: 10
[2023-06-29 09:18:37] [config] early-stopping-on: first
[2023-06-29 09:18:37] [config] embedding-fix-src: false
[2023-06-29 09:18:37] [config] embedding-fix-trg: false
[2023-06-29 09:18:37] [config] embedding-normalization: false
[2023-06-29 09:18:37] [config] embedding-vectors:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] enc-cell: gru
[2023-06-29 09:18:37] [config] enc-cell-depth: 1
[2023-06-29 09:18:37] [config] enc-depth: 1
[2023-06-29 09:18:37] [config] enc-type: bidirectional
[2023-06-29 09:18:37] [config] english-title-case-every: 0
[2023-06-29 09:18:37] [config] exponential-smoothing: 0
[2023-06-29 09:18:37] [config] factor-weight: 1
[2023-06-29 09:18:37] [config] factors-combine: sum
[2023-06-29 09:18:37] [config] factors-dim-emb: 0
[2023-06-29 09:18:37] [config] gradient-checkpointing: false
[2023-06-29 09:18:37] [config] gradient-norm-average-window: 100
[2023-06-29 09:18:37] [config] guided-alignment: none
[2023-06-29 09:18:37] [config] guided-alignment-cost: mse
[2023-06-29 09:18:37] [config] guided-alignment-weight: 0.1
[2023-06-29 09:18:37] [config] ignore-model-config: false
[2023-06-29 09:18:37] [config] input-types:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] interpolate-env-vars: false
[2023-06-29 09:18:37] [config] keep-best: false
[2023-06-29 09:18:37] [config] label-smoothing: 0
[2023-06-29 09:18:37] [config] layer-normalization: true
[2023-06-29 09:18:37] [config] learn-rate: 0.0001
[2023-06-29 09:18:37] [config] lemma-dependency: ""
[2023-06-29 09:18:37] [config] lemma-dim-emb: 0
[2023-06-29 09:18:37] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:18:37] [config] log-level: info
[2023-06-29 09:18:37] [config] log-time-zone: ""
[2023-06-29 09:18:37] [config] logical-epoch:
[2023-06-29 09:18:37] [config]   - 1e
[2023-06-29 09:18:37] [config]   - 0
[2023-06-29 09:18:37] [config] lr-decay: 0
[2023-06-29 09:18:37] [config] lr-decay-freq: 50000
[2023-06-29 09:18:37] [config] lr-decay-inv-sqrt:
[2023-06-29 09:18:37] [config]   - 0
[2023-06-29 09:18:37] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:18:37] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:18:37] [config] lr-decay-start:
[2023-06-29 09:18:37] [config]   - 10
[2023-06-29 09:18:37] [config]   - 1
[2023-06-29 09:18:37] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:18:37] [config] lr-report: false
[2023-06-29 09:18:37] [config] lr-warmup: 0
[2023-06-29 09:18:37] [config] lr-warmup-at-reload: false
[2023-06-29 09:18:37] [config] lr-warmup-cycle: false
[2023-06-29 09:18:37] [config] lr-warmup-start-rate: 0
[2023-06-29 09:18:37] [config] max-length: 50
[2023-06-29 09:18:37] [config] max-length-crop: false
[2023-06-29 09:18:37] [config] max-length-factor: 3
[2023-06-29 09:18:37] [config] maxi-batch: 100
[2023-06-29 09:18:37] [config] maxi-batch-sort: trg
[2023-06-29 09:18:37] [config] mini-batch: 64
[2023-06-29 09:18:37] [config] mini-batch-fit: true
[2023-06-29 09:18:37] [config] mini-batch-fit-step: 10
[2023-06-29 09:18:37] [config] mini-batch-round-up: true
[2023-06-29 09:18:37] [config] mini-batch-track-lr: false
[2023-06-29 09:18:37] [config] mini-batch-warmup: 0
[2023-06-29 09:18:37] [config] mini-batch-words: 0
[2023-06-29 09:18:37] [config] mini-batch-words-ref: 0
[2023-06-29 09:18:37] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:18:37] [config] multi-loss-type: sum
[2023-06-29 09:18:37] [config] n-best: false
[2023-06-29 09:18:37] [config] no-nccl: false
[2023-06-29 09:18:37] [config] no-reload: false
[2023-06-29 09:18:37] [config] no-restore-corpus: false
[2023-06-29 09:18:37] [config] normalize: 0.6
[2023-06-29 09:18:37] [config] normalize-gradient: false
[2023-06-29 09:18:37] [config] num-devices: 0
[2023-06-29 09:18:37] [config] optimizer: adam
[2023-06-29 09:18:37] [config] optimizer-delay: 1
[2023-06-29 09:18:37] [config] optimizer-params:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] output-omit-bias: false
[2023-06-29 09:18:37] [config] overwrite: true
[2023-06-29 09:18:37] [config] precision:
[2023-06-29 09:18:37] [config]   - float32
[2023-06-29 09:18:37] [config]   - float32
[2023-06-29 09:18:37] [config] pretrained-model: ""
[2023-06-29 09:18:37] [config] quantize-biases: false
[2023-06-29 09:18:37] [config] quantize-bits: 0
[2023-06-29 09:18:37] [config] quantize-log-based: false
[2023-06-29 09:18:37] [config] quantize-optimization-steps: 0
[2023-06-29 09:18:37] [config] quiet: false
[2023-06-29 09:18:37] [config] quiet-translation: true
[2023-06-29 09:18:37] [config] relative-paths: false
[2023-06-29 09:18:37] [config] right-left: false
[2023-06-29 09:18:37] [config] save-freq: 10000u
[2023-06-29 09:18:37] [config] seed: 1234
[2023-06-29 09:18:37] [config] sentencepiece-alphas:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:18:37] [config] sentencepiece-options: ""
[2023-06-29 09:18:37] [config] sharding: global
[2023-06-29 09:18:37] [config] shuffle: data
[2023-06-29 09:18:37] [config] shuffle-in-ram: false
[2023-06-29 09:18:37] [config] sigterm: save-and-exit
[2023-06-29 09:18:37] [config] skip: false
[2023-06-29 09:18:37] [config] sqlite: ""
[2023-06-29 09:18:37] [config] sqlite-drop: false
[2023-06-29 09:18:37] [config] sync-freq: 200u
[2023-06-29 09:18:37] [config] sync-sgd: false
[2023-06-29 09:18:37] [config] tempdir: /tmp
[2023-06-29 09:18:37] [config] tied-embeddings: false
[2023-06-29 09:18:37] [config] tied-embeddings-all: true
[2023-06-29 09:18:37] [config] tied-embeddings-src: false
[2023-06-29 09:18:37] [config] train-embedder-rank:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] train-sets:
[2023-06-29 09:18:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:18:37] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:18:37] [config] transformer-aan-activation: swish
[2023-06-29 09:18:37] [config] transformer-aan-depth: 2
[2023-06-29 09:18:37] [config] transformer-aan-nogate: false
[2023-06-29 09:18:37] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:18:37] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:18:37] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:18:37] [config] transformer-depth-scaling: false
[2023-06-29 09:18:37] [config] transformer-dim-aan: 2048
[2023-06-29 09:18:37] [config] transformer-dim-ffn: 2048
[2023-06-29 09:18:37] [config] transformer-dropout: 0
[2023-06-29 09:18:37] [config] transformer-dropout-attention: 0
[2023-06-29 09:18:37] [config] transformer-dropout-ffn: 0
[2023-06-29 09:18:37] [config] transformer-ffn-activation: swish
[2023-06-29 09:18:37] [config] transformer-ffn-depth: 2
[2023-06-29 09:18:37] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:18:37] [config] transformer-heads: 8
[2023-06-29 09:18:37] [config] transformer-no-projection: false
[2023-06-29 09:18:37] [config] transformer-pool: false
[2023-06-29 09:18:37] [config] transformer-postprocess: dan
[2023-06-29 09:18:37] [config] transformer-postprocess-emb: d
[2023-06-29 09:18:37] [config] transformer-postprocess-top: ""
[2023-06-29 09:18:37] [config] transformer-preprocess: ""
[2023-06-29 09:18:37] [config] transformer-tied-layers:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] transformer-train-position-embeddings: false
[2023-06-29 09:18:37] [config] tsv: false
[2023-06-29 09:18:37] [config] tsv-fields: 0
[2023-06-29 09:18:37] [config] type: amun
[2023-06-29 09:18:37] [config] ulr: false
[2023-06-29 09:18:37] [config] ulr-dim-emb: 0
[2023-06-29 09:18:37] [config] ulr-dropout: 0
[2023-06-29 09:18:37] [config] ulr-keys-vectors: ""
[2023-06-29 09:18:37] [config] ulr-query-vectors: ""
[2023-06-29 09:18:37] [config] ulr-softmax-temperature: 1
[2023-06-29 09:18:37] [config] ulr-trainable-transformation: false
[2023-06-29 09:18:37] [config] unlikelihood-loss: false
[2023-06-29 09:18:37] [config] valid-freq: 50000000
[2023-06-29 09:18:37] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:18:37] [config] valid-max-length: 1000
[2023-06-29 09:18:37] [config] valid-metrics:
[2023-06-29 09:18:37] [config]   - cross-entropy
[2023-06-29 09:18:37] [config]   - translation
[2023-06-29 09:18:37] [config] valid-mini-batch: 32
[2023-06-29 09:18:37] [config] valid-reset-stalled: false
[2023-06-29 09:18:37] [config] valid-script-args:
[2023-06-29 09:18:37] [config]   []
[2023-06-29 09:18:37] [config] valid-script-path: ""
[2023-06-29 09:18:37] [config] valid-sets:
[2023-06-29 09:18:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:18:37] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:18:37] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:18:37] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:18:37] [config] vocabs:
[2023-06-29 09:18:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:18:37] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:18:37] [config] word-penalty: 0
[2023-06-29 09:18:37] [config] word-scores: false
[2023-06-29 09:18:37] [config] workspace: 3000
[2023-06-29 09:18:37] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:18:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:18:37] [training] Using single-device training
[2023-06-29 09:18:38] Synced seed 1234
[2023-06-29 09:18:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:18:38] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:18:38] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:18:38] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:18:38] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:18:38] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:18:39] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:18:39] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:18:39] [comm] Using global sharding
[2023-06-29 09:18:39] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:18:39] [training] Using 1 GPUs
[2023-06-29 09:18:39] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:18:39] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:18:39] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:18:39] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:18:52] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:18:52] [valid] No post-processing script given for validating translator
[2023-06-29 09:18:52] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:18:52] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:18:52] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:18:52] [comm] Using global sharding
[2023-06-29 09:18:52] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:18:52] [training] Using 1 GPUs
[2023-06-29 09:18:52] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:18:53] Loading Adam parameters
[2023-06-29 09:18:53] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:18:53] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:18:53] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:18:53] [data] Restoring the corpus state to epoch 111, batch 12249
[2023-06-29 09:18:53] [data] Shuffling data
[2023-06-29 09:18:53] [data] Done reading 20,192 sentences
[2023-06-29 09:18:53] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:18:53] Training started
[2023-06-29 09:18:53] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 09:18:53] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:18:54] Parameter type float32, optimization type float32, casting types false
[2023-06-29 09:19:32] Seen 16,611 samples
[2023-06-29 09:19:32] Starting data epoch 112 in logical epoch 112
[2023-06-29 09:19:32] [data] Shuffling data
[2023-06-29 09:19:33] [data] Done reading 20,192 sentences
[2023-06-29 09:19:33] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:20:12] Seen 16,611 samples
[2023-06-29 09:20:12] Starting data epoch 113 in logical epoch 113
[2023-06-29 09:20:12] [data] Shuffling data
[2023-06-29 09:20:12] [data] Done reading 20,192 sentences
[2023-06-29 09:20:12] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:20:51] Seen 16,611 samples
[2023-06-29 09:20:51] Starting data epoch 114 in logical epoch 114
[2023-06-29 09:20:51] [data] Shuffling data
[2023-06-29 09:20:52] [data] Done reading 20,192 sentences
[2023-06-29 09:20:52] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:21:30] Seen 16,611 samples
[2023-06-29 09:21:30] Starting data epoch 115 in logical epoch 115
[2023-06-29 09:21:30] [data] Shuffling data
[2023-06-29 09:21:30] [data] Done reading 20,192 sentences
[2023-06-29 09:21:30] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:22:10] Seen 16,611 samples
[2023-06-29 09:22:10] Starting data epoch 116 in logical epoch 116
[2023-06-29 09:22:10] [data] Shuffling data
[2023-06-29 09:22:10] [data] Done reading 20,192 sentences
[2023-06-29 09:22:10] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:22:49] Seen 16,611 samples
[2023-06-29 09:22:49] Starting data epoch 117 in logical epoch 117
[2023-06-29 09:22:49] [data] Shuffling data
[2023-06-29 09:22:49] [data] Done reading 20,192 sentences
[2023-06-29 09:22:49] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:23:20] Ep. 117 : Up. 13000 : Sen. 12,528 : Cost 0.79156268 * 3,112,661 @ 5,016 after 40,334,698 : Time 267.94s : 11617.17 words/s : gNorm 1.0534
[2023-06-29 09:23:29] Seen 16,611 samples
[2023-06-29 09:23:29] Starting data epoch 118 in logical epoch 118
[2023-06-29 09:23:29] [data] Shuffling data
[2023-06-29 09:23:29] [data] Done reading 20,192 sentences
[2023-06-29 09:23:29] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:24:08] Seen 16,611 samples
[2023-06-29 09:24:08] Starting data epoch 119 in logical epoch 119
[2023-06-29 09:24:08] [data] Shuffling data
[2023-06-29 09:24:08] [data] Done reading 20,192 sentences
[2023-06-29 09:24:08] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:24:47] Seen 16,611 samples
[2023-06-29 09:24:47] Starting data epoch 120 in logical epoch 120
[2023-06-29 09:24:47] [data] Shuffling data
[2023-06-29 09:24:47] [data] Done reading 20,192 sentences
[2023-06-29 09:24:48] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:25:27] Seen 16,611 samples
[2023-06-29 09:25:27] Starting data epoch 121 in logical epoch 121
[2023-06-29 09:25:27] Training finished
[2023-06-29 09:25:39] [valid] Ep. 121 : Up. 13362 : cross-entropy : 265.75 : stalled 9 times (last best: 240.973)
[2023-06-29 09:26:25] [valid] Ep. 121 : Up. 13362 : translation : 0 : new best
[2023-06-29 09:26:25] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:26:27] Saving Adam parameters
[2023-06-29 09:26:27] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:26:34] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:26:34] [marian] Running on node20.datos.cluster.uy as process 18475 with command line:
[2023-06-29 09:26:34] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 130 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:26:34] [config] after: 0e
[2023-06-29 09:26:34] [config] after-batches: 0
[2023-06-29 09:26:34] [config] after-epochs: 130
[2023-06-29 09:26:34] [config] all-caps-every: 0
[2023-06-29 09:26:34] [config] allow-unk: false
[2023-06-29 09:26:34] [config] authors: false
[2023-06-29 09:26:34] [config] beam-size: 6
[2023-06-29 09:26:34] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:26:34] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:26:34] [config] bert-masking-fraction: 0.15
[2023-06-29 09:26:34] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:26:34] [config] bert-train-type-embeddings: true
[2023-06-29 09:26:34] [config] bert-type-vocab-size: 2
[2023-06-29 09:26:34] [config] build-info: ""
[2023-06-29 09:26:34] [config] check-gradient-nan: false
[2023-06-29 09:26:34] [config] check-nan: false
[2023-06-29 09:26:34] [config] cite: false
[2023-06-29 09:26:34] [config] clip-norm: 1
[2023-06-29 09:26:34] [config] cost-scaling:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] cost-type: ce-sum
[2023-06-29 09:26:34] [config] cpu-threads: 0
[2023-06-29 09:26:34] [config] data-threads: 8
[2023-06-29 09:26:34] [config] data-weighting: ""
[2023-06-29 09:26:34] [config] data-weighting-type: sentence
[2023-06-29 09:26:34] [config] dec-cell: gru
[2023-06-29 09:26:34] [config] dec-cell-base-depth: 2
[2023-06-29 09:26:34] [config] dec-cell-high-depth: 1
[2023-06-29 09:26:34] [config] dec-depth: 1
[2023-06-29 09:26:34] [config] devices:
[2023-06-29 09:26:34] [config]   - 0
[2023-06-29 09:26:34] [config] dim-emb: 512
[2023-06-29 09:26:34] [config] dim-rnn: 1024
[2023-06-29 09:26:34] [config] dim-vocabs:
[2023-06-29 09:26:34] [config]   - 16384
[2023-06-29 09:26:34] [config]   - 16384
[2023-06-29 09:26:34] [config] disp-first: 0
[2023-06-29 09:26:34] [config] disp-freq: 1000u
[2023-06-29 09:26:34] [config] disp-label-counts: true
[2023-06-29 09:26:34] [config] dropout-rnn: 0.2
[2023-06-29 09:26:34] [config] dropout-src: 0.1
[2023-06-29 09:26:34] [config] dropout-trg: 0.1
[2023-06-29 09:26:34] [config] dump-config: ""
[2023-06-29 09:26:34] [config] dynamic-gradient-scaling:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] early-stopping: 10
[2023-06-29 09:26:34] [config] early-stopping-on: first
[2023-06-29 09:26:34] [config] embedding-fix-src: false
[2023-06-29 09:26:34] [config] embedding-fix-trg: false
[2023-06-29 09:26:34] [config] embedding-normalization: false
[2023-06-29 09:26:34] [config] embedding-vectors:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] enc-cell: gru
[2023-06-29 09:26:34] [config] enc-cell-depth: 1
[2023-06-29 09:26:34] [config] enc-depth: 1
[2023-06-29 09:26:34] [config] enc-type: bidirectional
[2023-06-29 09:26:34] [config] english-title-case-every: 0
[2023-06-29 09:26:34] [config] exponential-smoothing: 0
[2023-06-29 09:26:34] [config] factor-weight: 1
[2023-06-29 09:26:34] [config] factors-combine: sum
[2023-06-29 09:26:34] [config] factors-dim-emb: 0
[2023-06-29 09:26:34] [config] gradient-checkpointing: false
[2023-06-29 09:26:34] [config] gradient-norm-average-window: 100
[2023-06-29 09:26:34] [config] guided-alignment: none
[2023-06-29 09:26:34] [config] guided-alignment-cost: mse
[2023-06-29 09:26:34] [config] guided-alignment-weight: 0.1
[2023-06-29 09:26:34] [config] ignore-model-config: false
[2023-06-29 09:26:34] [config] input-types:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] interpolate-env-vars: false
[2023-06-29 09:26:34] [config] keep-best: false
[2023-06-29 09:26:34] [config] label-smoothing: 0
[2023-06-29 09:26:34] [config] layer-normalization: true
[2023-06-29 09:26:34] [config] learn-rate: 0.0001
[2023-06-29 09:26:34] [config] lemma-dependency: ""
[2023-06-29 09:26:34] [config] lemma-dim-emb: 0
[2023-06-29 09:26:34] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:26:34] [config] log-level: info
[2023-06-29 09:26:34] [config] log-time-zone: ""
[2023-06-29 09:26:34] [config] logical-epoch:
[2023-06-29 09:26:34] [config]   - 1e
[2023-06-29 09:26:34] [config]   - 0
[2023-06-29 09:26:34] [config] lr-decay: 0
[2023-06-29 09:26:34] [config] lr-decay-freq: 50000
[2023-06-29 09:26:34] [config] lr-decay-inv-sqrt:
[2023-06-29 09:26:34] [config]   - 0
[2023-06-29 09:26:34] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:26:34] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:26:34] [config] lr-decay-start:
[2023-06-29 09:26:34] [config]   - 10
[2023-06-29 09:26:34] [config]   - 1
[2023-06-29 09:26:34] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:26:34] [config] lr-report: false
[2023-06-29 09:26:34] [config] lr-warmup: 0
[2023-06-29 09:26:34] [config] lr-warmup-at-reload: false
[2023-06-29 09:26:34] [config] lr-warmup-cycle: false
[2023-06-29 09:26:34] [config] lr-warmup-start-rate: 0
[2023-06-29 09:26:34] [config] max-length: 50
[2023-06-29 09:26:34] [config] max-length-crop: false
[2023-06-29 09:26:34] [config] max-length-factor: 3
[2023-06-29 09:26:34] [config] maxi-batch: 100
[2023-06-29 09:26:34] [config] maxi-batch-sort: trg
[2023-06-29 09:26:34] [config] mini-batch: 64
[2023-06-29 09:26:34] [config] mini-batch-fit: true
[2023-06-29 09:26:34] [config] mini-batch-fit-step: 10
[2023-06-29 09:26:34] [config] mini-batch-round-up: true
[2023-06-29 09:26:34] [config] mini-batch-track-lr: false
[2023-06-29 09:26:34] [config] mini-batch-warmup: 0
[2023-06-29 09:26:34] [config] mini-batch-words: 0
[2023-06-29 09:26:34] [config] mini-batch-words-ref: 0
[2023-06-29 09:26:34] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:26:34] [config] multi-loss-type: sum
[2023-06-29 09:26:34] [config] n-best: false
[2023-06-29 09:26:34] [config] no-nccl: false
[2023-06-29 09:26:34] [config] no-reload: false
[2023-06-29 09:26:34] [config] no-restore-corpus: false
[2023-06-29 09:26:34] [config] normalize: 0.6
[2023-06-29 09:26:34] [config] normalize-gradient: false
[2023-06-29 09:26:34] [config] num-devices: 0
[2023-06-29 09:26:34] [config] optimizer: adam
[2023-06-29 09:26:34] [config] optimizer-delay: 1
[2023-06-29 09:26:34] [config] optimizer-params:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] output-omit-bias: false
[2023-06-29 09:26:34] [config] overwrite: true
[2023-06-29 09:26:34] [config] precision:
[2023-06-29 09:26:34] [config]   - float32
[2023-06-29 09:26:34] [config]   - float32
[2023-06-29 09:26:34] [config] pretrained-model: ""
[2023-06-29 09:26:34] [config] quantize-biases: false
[2023-06-29 09:26:34] [config] quantize-bits: 0
[2023-06-29 09:26:34] [config] quantize-log-based: false
[2023-06-29 09:26:34] [config] quantize-optimization-steps: 0
[2023-06-29 09:26:34] [config] quiet: false
[2023-06-29 09:26:34] [config] quiet-translation: true
[2023-06-29 09:26:34] [config] relative-paths: false
[2023-06-29 09:26:34] [config] right-left: false
[2023-06-29 09:26:34] [config] save-freq: 10000u
[2023-06-29 09:26:34] [config] seed: 1234
[2023-06-29 09:26:34] [config] sentencepiece-alphas:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:26:34] [config] sentencepiece-options: ""
[2023-06-29 09:26:34] [config] sharding: global
[2023-06-29 09:26:34] [config] shuffle: data
[2023-06-29 09:26:34] [config] shuffle-in-ram: false
[2023-06-29 09:26:34] [config] sigterm: save-and-exit
[2023-06-29 09:26:34] [config] skip: false
[2023-06-29 09:26:34] [config] sqlite: ""
[2023-06-29 09:26:34] [config] sqlite-drop: false
[2023-06-29 09:26:34] [config] sync-freq: 200u
[2023-06-29 09:26:34] [config] sync-sgd: false
[2023-06-29 09:26:34] [config] tempdir: /tmp
[2023-06-29 09:26:34] [config] tied-embeddings: false
[2023-06-29 09:26:34] [config] tied-embeddings-all: true
[2023-06-29 09:26:34] [config] tied-embeddings-src: false
[2023-06-29 09:26:34] [config] train-embedder-rank:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] train-sets:
[2023-06-29 09:26:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:26:34] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:26:34] [config] transformer-aan-activation: swish
[2023-06-29 09:26:34] [config] transformer-aan-depth: 2
[2023-06-29 09:26:34] [config] transformer-aan-nogate: false
[2023-06-29 09:26:34] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:26:34] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:26:34] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:26:34] [config] transformer-depth-scaling: false
[2023-06-29 09:26:34] [config] transformer-dim-aan: 2048
[2023-06-29 09:26:34] [config] transformer-dim-ffn: 2048
[2023-06-29 09:26:34] [config] transformer-dropout: 0
[2023-06-29 09:26:34] [config] transformer-dropout-attention: 0
[2023-06-29 09:26:34] [config] transformer-dropout-ffn: 0
[2023-06-29 09:26:34] [config] transformer-ffn-activation: swish
[2023-06-29 09:26:34] [config] transformer-ffn-depth: 2
[2023-06-29 09:26:34] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:26:34] [config] transformer-heads: 8
[2023-06-29 09:26:34] [config] transformer-no-projection: false
[2023-06-29 09:26:34] [config] transformer-pool: false
[2023-06-29 09:26:34] [config] transformer-postprocess: dan
[2023-06-29 09:26:34] [config] transformer-postprocess-emb: d
[2023-06-29 09:26:34] [config] transformer-postprocess-top: ""
[2023-06-29 09:26:34] [config] transformer-preprocess: ""
[2023-06-29 09:26:34] [config] transformer-tied-layers:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] transformer-train-position-embeddings: false
[2023-06-29 09:26:34] [config] tsv: false
[2023-06-29 09:26:34] [config] tsv-fields: 0
[2023-06-29 09:26:34] [config] type: amun
[2023-06-29 09:26:34] [config] ulr: false
[2023-06-29 09:26:34] [config] ulr-dim-emb: 0
[2023-06-29 09:26:34] [config] ulr-dropout: 0
[2023-06-29 09:26:34] [config] ulr-keys-vectors: ""
[2023-06-29 09:26:34] [config] ulr-query-vectors: ""
[2023-06-29 09:26:34] [config] ulr-softmax-temperature: 1
[2023-06-29 09:26:34] [config] ulr-trainable-transformation: false
[2023-06-29 09:26:34] [config] unlikelihood-loss: false
[2023-06-29 09:26:34] [config] valid-freq: 50000000
[2023-06-29 09:26:34] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:26:34] [config] valid-max-length: 1000
[2023-06-29 09:26:34] [config] valid-metrics:
[2023-06-29 09:26:34] [config]   - cross-entropy
[2023-06-29 09:26:34] [config]   - translation
[2023-06-29 09:26:34] [config] valid-mini-batch: 32
[2023-06-29 09:26:34] [config] valid-reset-stalled: false
[2023-06-29 09:26:34] [config] valid-script-args:
[2023-06-29 09:26:34] [config]   []
[2023-06-29 09:26:34] [config] valid-script-path: ""
[2023-06-29 09:26:34] [config] valid-sets:
[2023-06-29 09:26:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:26:34] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:26:34] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:26:34] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:26:34] [config] vocabs:
[2023-06-29 09:26:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:26:34] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:26:34] [config] word-penalty: 0
[2023-06-29 09:26:34] [config] word-scores: false
[2023-06-29 09:26:34] [config] workspace: 3000
[2023-06-29 09:26:34] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:26:34] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:26:34] [training] Using single-device training
[2023-06-29 09:26:35] Synced seed 1234
[2023-06-29 09:26:35] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:26:35] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:26:35] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:26:35] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:26:35] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:26:35] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:26:36] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:26:36] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:26:36] [comm] Using global sharding
[2023-06-29 09:26:36] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:26:36] [training] Using 1 GPUs
[2023-06-29 09:26:36] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:26:36] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:26:36] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:26:36] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:26:49] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:26:49] [valid] No post-processing script given for validating translator
[2023-06-29 09:26:49] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:26:49] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:26:49] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:26:49] [comm] Using global sharding
[2023-06-29 09:26:49] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:26:49] [training] Using 1 GPUs
[2023-06-29 09:26:49] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:26:50] Loading Adam parameters
[2023-06-29 09:26:50] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:26:50] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:26:50] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:26:50] [data] Restoring the corpus state to epoch 121, batch 13362
[2023-06-29 09:26:50] [data] Shuffling data
[2023-06-29 09:26:50] [data] Done reading 20,192 sentences
[2023-06-29 09:26:50] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:26:50] Training started
[2023-06-29 09:26:50] [training] Batches are processed as 1 process(es) x 1 devices/process
[2023-06-29 09:26:50] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:26:51] Parameter type float32, optimization type float32, casting types false
[2023-06-29 09:27:28] Seen 16,611 samples
[2023-06-29 09:27:28] Starting data epoch 122 in logical epoch 122
[2023-06-29 09:27:28] [data] Shuffling data
[2023-06-29 09:27:28] [data] Done reading 20,192 sentences
[2023-06-29 09:27:28] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:28:07] Seen 16,611 samples
[2023-06-29 09:28:07] Starting data epoch 123 in logical epoch 123
[2023-06-29 09:28:07] [data] Shuffling data
[2023-06-29 09:28:07] [data] Done reading 20,192 sentences
[2023-06-29 09:28:07] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:28:47] Seen 16,611 samples
[2023-06-29 09:28:47] Starting data epoch 124 in logical epoch 124
[2023-06-29 09:28:47] [data] Shuffling data
[2023-06-29 09:28:47] [data] Done reading 20,192 sentences
[2023-06-29 09:28:47] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:29:26] Seen 16,611 samples
[2023-06-29 09:29:26] Starting data epoch 125 in logical epoch 125
[2023-06-29 09:29:26] [data] Shuffling data
[2023-06-29 09:29:26] [data] Done reading 20,192 sentences
[2023-06-29 09:29:27] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:30:06] Seen 16,611 samples
[2023-06-29 09:30:06] Starting data epoch 126 in logical epoch 126
[2023-06-29 09:30:06] [data] Shuffling data
[2023-06-29 09:30:06] [data] Done reading 20,192 sentences
[2023-06-29 09:30:06] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:30:35] Ep. 126 : Up. 14000 : Sen. 12,361 : Cost 0.69203985 * 3,093,398 @ 3,960 after 43,428,096 : Time 226.10s : 13681.71 words/s : gNorm 0.9831
[2023-06-29 09:30:45] Seen 16,611 samples
[2023-06-29 09:30:45] Starting data epoch 127 in logical epoch 127
[2023-06-29 09:30:45] [data] Shuffling data
[2023-06-29 09:30:45] [data] Done reading 20,192 sentences
[2023-06-29 09:30:45] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:31:25] Seen 16,611 samples
[2023-06-29 09:31:25] Starting data epoch 128 in logical epoch 128
[2023-06-29 09:31:25] [data] Shuffling data
[2023-06-29 09:31:25] [data] Done reading 20,192 sentences
[2023-06-29 09:31:25] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:32:04] Seen 16,611 samples
[2023-06-29 09:32:04] Starting data epoch 129 in logical epoch 129
[2023-06-29 09:32:04] [data] Shuffling data
[2023-06-29 09:32:04] [data] Done reading 20,192 sentences
[2023-06-29 09:32:04] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:32:44] Seen 16,611 samples
[2023-06-29 09:32:44] Starting data epoch 130 in logical epoch 130
[2023-06-29 09:32:44] [data] Shuffling data
[2023-06-29 09:32:44] [data] Done reading 20,192 sentences
[2023-06-29 09:32:44] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:33:23] Seen 16,611 samples
[2023-06-29 09:33:23] Starting data epoch 131 in logical epoch 131
[2023-06-29 09:33:23] Training finished
[2023-06-29 09:33:35] [valid] Ep. 131 : Up. 14475 : cross-entropy : 265.529 : stalled 10 times (last best: 240.973)
[2023-06-29 09:34:21] [valid] Ep. 131 : Up. 14475 : translation : 0 : new best
[2023-06-29 09:34:21] Saving model to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:34:23] Saving Adam parameters
[2023-06-29 09:34:23] [training] Saving training checkpoint to /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:34:30] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:34:30] [marian] Running on node20.datos.cluster.uy as process 18940 with command line:
[2023-06-29 09:34:30] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 140 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:34:31] [config] after: 0e
[2023-06-29 09:34:31] [config] after-batches: 0
[2023-06-29 09:34:31] [config] after-epochs: 140
[2023-06-29 09:34:31] [config] all-caps-every: 0
[2023-06-29 09:34:31] [config] allow-unk: false
[2023-06-29 09:34:31] [config] authors: false
[2023-06-29 09:34:31] [config] beam-size: 6
[2023-06-29 09:34:31] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:34:31] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:34:31] [config] bert-masking-fraction: 0.15
[2023-06-29 09:34:31] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:34:31] [config] bert-train-type-embeddings: true
[2023-06-29 09:34:31] [config] bert-type-vocab-size: 2
[2023-06-29 09:34:31] [config] build-info: ""
[2023-06-29 09:34:31] [config] check-gradient-nan: false
[2023-06-29 09:34:31] [config] check-nan: false
[2023-06-29 09:34:31] [config] cite: false
[2023-06-29 09:34:31] [config] clip-norm: 1
[2023-06-29 09:34:31] [config] cost-scaling:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] cost-type: ce-sum
[2023-06-29 09:34:31] [config] cpu-threads: 0
[2023-06-29 09:34:31] [config] data-threads: 8
[2023-06-29 09:34:31] [config] data-weighting: ""
[2023-06-29 09:34:31] [config] data-weighting-type: sentence
[2023-06-29 09:34:31] [config] dec-cell: gru
[2023-06-29 09:34:31] [config] dec-cell-base-depth: 2
[2023-06-29 09:34:31] [config] dec-cell-high-depth: 1
[2023-06-29 09:34:31] [config] dec-depth: 1
[2023-06-29 09:34:31] [config] devices:
[2023-06-29 09:34:31] [config]   - 0
[2023-06-29 09:34:31] [config] dim-emb: 512
[2023-06-29 09:34:31] [config] dim-rnn: 1024
[2023-06-29 09:34:31] [config] dim-vocabs:
[2023-06-29 09:34:31] [config]   - 16384
[2023-06-29 09:34:31] [config]   - 16384
[2023-06-29 09:34:31] [config] disp-first: 0
[2023-06-29 09:34:31] [config] disp-freq: 1000u
[2023-06-29 09:34:31] [config] disp-label-counts: true
[2023-06-29 09:34:31] [config] dropout-rnn: 0.2
[2023-06-29 09:34:31] [config] dropout-src: 0.1
[2023-06-29 09:34:31] [config] dropout-trg: 0.1
[2023-06-29 09:34:31] [config] dump-config: ""
[2023-06-29 09:34:31] [config] dynamic-gradient-scaling:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] early-stopping: 10
[2023-06-29 09:34:31] [config] early-stopping-on: first
[2023-06-29 09:34:31] [config] embedding-fix-src: false
[2023-06-29 09:34:31] [config] embedding-fix-trg: false
[2023-06-29 09:34:31] [config] embedding-normalization: false
[2023-06-29 09:34:31] [config] embedding-vectors:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] enc-cell: gru
[2023-06-29 09:34:31] [config] enc-cell-depth: 1
[2023-06-29 09:34:31] [config] enc-depth: 1
[2023-06-29 09:34:31] [config] enc-type: bidirectional
[2023-06-29 09:34:31] [config] english-title-case-every: 0
[2023-06-29 09:34:31] [config] exponential-smoothing: 0
[2023-06-29 09:34:31] [config] factor-weight: 1
[2023-06-29 09:34:31] [config] factors-combine: sum
[2023-06-29 09:34:31] [config] factors-dim-emb: 0
[2023-06-29 09:34:31] [config] gradient-checkpointing: false
[2023-06-29 09:34:31] [config] gradient-norm-average-window: 100
[2023-06-29 09:34:31] [config] guided-alignment: none
[2023-06-29 09:34:31] [config] guided-alignment-cost: mse
[2023-06-29 09:34:31] [config] guided-alignment-weight: 0.1
[2023-06-29 09:34:31] [config] ignore-model-config: false
[2023-06-29 09:34:31] [config] input-types:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] interpolate-env-vars: false
[2023-06-29 09:34:31] [config] keep-best: false
[2023-06-29 09:34:31] [config] label-smoothing: 0
[2023-06-29 09:34:31] [config] layer-normalization: true
[2023-06-29 09:34:31] [config] learn-rate: 0.0001
[2023-06-29 09:34:31] [config] lemma-dependency: ""
[2023-06-29 09:34:31] [config] lemma-dim-emb: 0
[2023-06-29 09:34:31] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:34:31] [config] log-level: info
[2023-06-29 09:34:31] [config] log-time-zone: ""
[2023-06-29 09:34:31] [config] logical-epoch:
[2023-06-29 09:34:31] [config]   - 1e
[2023-06-29 09:34:31] [config]   - 0
[2023-06-29 09:34:31] [config] lr-decay: 0
[2023-06-29 09:34:31] [config] lr-decay-freq: 50000
[2023-06-29 09:34:31] [config] lr-decay-inv-sqrt:
[2023-06-29 09:34:31] [config]   - 0
[2023-06-29 09:34:31] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:34:31] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:34:31] [config] lr-decay-start:
[2023-06-29 09:34:31] [config]   - 10
[2023-06-29 09:34:31] [config]   - 1
[2023-06-29 09:34:31] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:34:31] [config] lr-report: false
[2023-06-29 09:34:31] [config] lr-warmup: 0
[2023-06-29 09:34:31] [config] lr-warmup-at-reload: false
[2023-06-29 09:34:31] [config] lr-warmup-cycle: false
[2023-06-29 09:34:31] [config] lr-warmup-start-rate: 0
[2023-06-29 09:34:31] [config] max-length: 50
[2023-06-29 09:34:31] [config] max-length-crop: false
[2023-06-29 09:34:31] [config] max-length-factor: 3
[2023-06-29 09:34:31] [config] maxi-batch: 100
[2023-06-29 09:34:31] [config] maxi-batch-sort: trg
[2023-06-29 09:34:31] [config] mini-batch: 64
[2023-06-29 09:34:31] [config] mini-batch-fit: true
[2023-06-29 09:34:31] [config] mini-batch-fit-step: 10
[2023-06-29 09:34:31] [config] mini-batch-round-up: true
[2023-06-29 09:34:31] [config] mini-batch-track-lr: false
[2023-06-29 09:34:31] [config] mini-batch-warmup: 0
[2023-06-29 09:34:31] [config] mini-batch-words: 0
[2023-06-29 09:34:31] [config] mini-batch-words-ref: 0
[2023-06-29 09:34:31] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:34:31] [config] multi-loss-type: sum
[2023-06-29 09:34:31] [config] n-best: false
[2023-06-29 09:34:31] [config] no-nccl: false
[2023-06-29 09:34:31] [config] no-reload: false
[2023-06-29 09:34:31] [config] no-restore-corpus: false
[2023-06-29 09:34:31] [config] normalize: 0.6
[2023-06-29 09:34:31] [config] normalize-gradient: false
[2023-06-29 09:34:31] [config] num-devices: 0
[2023-06-29 09:34:31] [config] optimizer: adam
[2023-06-29 09:34:31] [config] optimizer-delay: 1
[2023-06-29 09:34:31] [config] optimizer-params:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] output-omit-bias: false
[2023-06-29 09:34:31] [config] overwrite: true
[2023-06-29 09:34:31] [config] precision:
[2023-06-29 09:34:31] [config]   - float32
[2023-06-29 09:34:31] [config]   - float32
[2023-06-29 09:34:31] [config] pretrained-model: ""
[2023-06-29 09:34:31] [config] quantize-biases: false
[2023-06-29 09:34:31] [config] quantize-bits: 0
[2023-06-29 09:34:31] [config] quantize-log-based: false
[2023-06-29 09:34:31] [config] quantize-optimization-steps: 0
[2023-06-29 09:34:31] [config] quiet: false
[2023-06-29 09:34:31] [config] quiet-translation: true
[2023-06-29 09:34:31] [config] relative-paths: false
[2023-06-29 09:34:31] [config] right-left: false
[2023-06-29 09:34:31] [config] save-freq: 10000u
[2023-06-29 09:34:31] [config] seed: 1234
[2023-06-29 09:34:31] [config] sentencepiece-alphas:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:34:31] [config] sentencepiece-options: ""
[2023-06-29 09:34:31] [config] sharding: global
[2023-06-29 09:34:31] [config] shuffle: data
[2023-06-29 09:34:31] [config] shuffle-in-ram: false
[2023-06-29 09:34:31] [config] sigterm: save-and-exit
[2023-06-29 09:34:31] [config] skip: false
[2023-06-29 09:34:31] [config] sqlite: ""
[2023-06-29 09:34:31] [config] sqlite-drop: false
[2023-06-29 09:34:31] [config] sync-freq: 200u
[2023-06-29 09:34:31] [config] sync-sgd: false
[2023-06-29 09:34:31] [config] tempdir: /tmp
[2023-06-29 09:34:31] [config] tied-embeddings: false
[2023-06-29 09:34:31] [config] tied-embeddings-all: true
[2023-06-29 09:34:31] [config] tied-embeddings-src: false
[2023-06-29 09:34:31] [config] train-embedder-rank:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] train-sets:
[2023-06-29 09:34:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:34:31] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:34:31] [config] transformer-aan-activation: swish
[2023-06-29 09:34:31] [config] transformer-aan-depth: 2
[2023-06-29 09:34:31] [config] transformer-aan-nogate: false
[2023-06-29 09:34:31] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:34:31] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:34:31] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:34:31] [config] transformer-depth-scaling: false
[2023-06-29 09:34:31] [config] transformer-dim-aan: 2048
[2023-06-29 09:34:31] [config] transformer-dim-ffn: 2048
[2023-06-29 09:34:31] [config] transformer-dropout: 0
[2023-06-29 09:34:31] [config] transformer-dropout-attention: 0
[2023-06-29 09:34:31] [config] transformer-dropout-ffn: 0
[2023-06-29 09:34:31] [config] transformer-ffn-activation: swish
[2023-06-29 09:34:31] [config] transformer-ffn-depth: 2
[2023-06-29 09:34:31] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:34:31] [config] transformer-heads: 8
[2023-06-29 09:34:31] [config] transformer-no-projection: false
[2023-06-29 09:34:31] [config] transformer-pool: false
[2023-06-29 09:34:31] [config] transformer-postprocess: dan
[2023-06-29 09:34:31] [config] transformer-postprocess-emb: d
[2023-06-29 09:34:31] [config] transformer-postprocess-top: ""
[2023-06-29 09:34:31] [config] transformer-preprocess: ""
[2023-06-29 09:34:31] [config] transformer-tied-layers:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] transformer-train-position-embeddings: false
[2023-06-29 09:34:31] [config] tsv: false
[2023-06-29 09:34:31] [config] tsv-fields: 0
[2023-06-29 09:34:31] [config] type: amun
[2023-06-29 09:34:31] [config] ulr: false
[2023-06-29 09:34:31] [config] ulr-dim-emb: 0
[2023-06-29 09:34:31] [config] ulr-dropout: 0
[2023-06-29 09:34:31] [config] ulr-keys-vectors: ""
[2023-06-29 09:34:31] [config] ulr-query-vectors: ""
[2023-06-29 09:34:31] [config] ulr-softmax-temperature: 1
[2023-06-29 09:34:31] [config] ulr-trainable-transformation: false
[2023-06-29 09:34:31] [config] unlikelihood-loss: false
[2023-06-29 09:34:31] [config] valid-freq: 50000000
[2023-06-29 09:34:31] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:34:31] [config] valid-max-length: 1000
[2023-06-29 09:34:31] [config] valid-metrics:
[2023-06-29 09:34:31] [config]   - cross-entropy
[2023-06-29 09:34:31] [config]   - translation
[2023-06-29 09:34:31] [config] valid-mini-batch: 32
[2023-06-29 09:34:31] [config] valid-reset-stalled: false
[2023-06-29 09:34:31] [config] valid-script-args:
[2023-06-29 09:34:31] [config]   []
[2023-06-29 09:34:31] [config] valid-script-path: ""
[2023-06-29 09:34:31] [config] valid-sets:
[2023-06-29 09:34:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:34:31] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:34:31] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:34:31] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:34:31] [config] vocabs:
[2023-06-29 09:34:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:34:31] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:34:31] [config] word-penalty: 0
[2023-06-29 09:34:31] [config] word-scores: false
[2023-06-29 09:34:31] [config] workspace: 3000
[2023-06-29 09:34:31] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:34:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:34:31] [training] Using single-device training
[2023-06-29 09:34:31] Synced seed 1234
[2023-06-29 09:34:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:34:31] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:34:31] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:34:31] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:34:31] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:34:31] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:34:32] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:34:32] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:34:32] [comm] Using global sharding
[2023-06-29 09:34:32] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:34:32] [training] Using 1 GPUs
[2023-06-29 09:34:32] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:34:32] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:34:32] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:34:32] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:34:44] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:34:44] [valid] No post-processing script given for validating translator
[2023-06-29 09:34:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:34:45] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:34:45] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:34:45] [comm] Using global sharding
[2023-06-29 09:34:45] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:34:45] [training] Using 1 GPUs
[2023-06-29 09:34:45] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:34:46] Loading Adam parameters
[2023-06-29 09:34:46] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:34:46] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:34:46] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:34:46] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:34:46] [data] Shuffling data
[2023-06-29 09:34:46] [data] Done reading 20,192 sentences
[2023-06-29 09:34:46] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:34:46] Training started
[2023-06-29 09:34:46] Training finished
[2023-06-29 09:34:49] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:34:49] [marian] Running on node20.datos.cluster.uy as process 19008 with command line:
[2023-06-29 09:34:49] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 150 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:34:49] [config] after: 0e
[2023-06-29 09:34:49] [config] after-batches: 0
[2023-06-29 09:34:49] [config] after-epochs: 150
[2023-06-29 09:34:49] [config] all-caps-every: 0
[2023-06-29 09:34:49] [config] allow-unk: false
[2023-06-29 09:34:49] [config] authors: false
[2023-06-29 09:34:49] [config] beam-size: 6
[2023-06-29 09:34:49] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:34:49] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:34:49] [config] bert-masking-fraction: 0.15
[2023-06-29 09:34:49] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:34:49] [config] bert-train-type-embeddings: true
[2023-06-29 09:34:49] [config] bert-type-vocab-size: 2
[2023-06-29 09:34:49] [config] build-info: ""
[2023-06-29 09:34:49] [config] check-gradient-nan: false
[2023-06-29 09:34:49] [config] check-nan: false
[2023-06-29 09:34:49] [config] cite: false
[2023-06-29 09:34:49] [config] clip-norm: 1
[2023-06-29 09:34:49] [config] cost-scaling:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] cost-type: ce-sum
[2023-06-29 09:34:49] [config] cpu-threads: 0
[2023-06-29 09:34:49] [config] data-threads: 8
[2023-06-29 09:34:49] [config] data-weighting: ""
[2023-06-29 09:34:49] [config] data-weighting-type: sentence
[2023-06-29 09:34:49] [config] dec-cell: gru
[2023-06-29 09:34:49] [config] dec-cell-base-depth: 2
[2023-06-29 09:34:49] [config] dec-cell-high-depth: 1
[2023-06-29 09:34:49] [config] dec-depth: 1
[2023-06-29 09:34:49] [config] devices:
[2023-06-29 09:34:49] [config]   - 0
[2023-06-29 09:34:49] [config] dim-emb: 512
[2023-06-29 09:34:49] [config] dim-rnn: 1024
[2023-06-29 09:34:49] [config] dim-vocabs:
[2023-06-29 09:34:49] [config]   - 16384
[2023-06-29 09:34:49] [config]   - 16384
[2023-06-29 09:34:49] [config] disp-first: 0
[2023-06-29 09:34:49] [config] disp-freq: 1000u
[2023-06-29 09:34:49] [config] disp-label-counts: true
[2023-06-29 09:34:49] [config] dropout-rnn: 0.2
[2023-06-29 09:34:49] [config] dropout-src: 0.1
[2023-06-29 09:34:49] [config] dropout-trg: 0.1
[2023-06-29 09:34:49] [config] dump-config: ""
[2023-06-29 09:34:49] [config] dynamic-gradient-scaling:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] early-stopping: 10
[2023-06-29 09:34:49] [config] early-stopping-on: first
[2023-06-29 09:34:49] [config] embedding-fix-src: false
[2023-06-29 09:34:49] [config] embedding-fix-trg: false
[2023-06-29 09:34:49] [config] embedding-normalization: false
[2023-06-29 09:34:49] [config] embedding-vectors:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] enc-cell: gru
[2023-06-29 09:34:49] [config] enc-cell-depth: 1
[2023-06-29 09:34:49] [config] enc-depth: 1
[2023-06-29 09:34:49] [config] enc-type: bidirectional
[2023-06-29 09:34:49] [config] english-title-case-every: 0
[2023-06-29 09:34:49] [config] exponential-smoothing: 0
[2023-06-29 09:34:49] [config] factor-weight: 1
[2023-06-29 09:34:49] [config] factors-combine: sum
[2023-06-29 09:34:49] [config] factors-dim-emb: 0
[2023-06-29 09:34:49] [config] gradient-checkpointing: false
[2023-06-29 09:34:49] [config] gradient-norm-average-window: 100
[2023-06-29 09:34:49] [config] guided-alignment: none
[2023-06-29 09:34:49] [config] guided-alignment-cost: mse
[2023-06-29 09:34:49] [config] guided-alignment-weight: 0.1
[2023-06-29 09:34:49] [config] ignore-model-config: false
[2023-06-29 09:34:49] [config] input-types:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] interpolate-env-vars: false
[2023-06-29 09:34:49] [config] keep-best: false
[2023-06-29 09:34:49] [config] label-smoothing: 0
[2023-06-29 09:34:49] [config] layer-normalization: true
[2023-06-29 09:34:49] [config] learn-rate: 0.0001
[2023-06-29 09:34:49] [config] lemma-dependency: ""
[2023-06-29 09:34:49] [config] lemma-dim-emb: 0
[2023-06-29 09:34:49] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:34:49] [config] log-level: info
[2023-06-29 09:34:49] [config] log-time-zone: ""
[2023-06-29 09:34:49] [config] logical-epoch:
[2023-06-29 09:34:49] [config]   - 1e
[2023-06-29 09:34:49] [config]   - 0
[2023-06-29 09:34:49] [config] lr-decay: 0
[2023-06-29 09:34:49] [config] lr-decay-freq: 50000
[2023-06-29 09:34:49] [config] lr-decay-inv-sqrt:
[2023-06-29 09:34:49] [config]   - 0
[2023-06-29 09:34:49] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:34:49] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:34:49] [config] lr-decay-start:
[2023-06-29 09:34:49] [config]   - 10
[2023-06-29 09:34:49] [config]   - 1
[2023-06-29 09:34:49] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:34:49] [config] lr-report: false
[2023-06-29 09:34:49] [config] lr-warmup: 0
[2023-06-29 09:34:49] [config] lr-warmup-at-reload: false
[2023-06-29 09:34:49] [config] lr-warmup-cycle: false
[2023-06-29 09:34:49] [config] lr-warmup-start-rate: 0
[2023-06-29 09:34:49] [config] max-length: 50
[2023-06-29 09:34:49] [config] max-length-crop: false
[2023-06-29 09:34:49] [config] max-length-factor: 3
[2023-06-29 09:34:49] [config] maxi-batch: 100
[2023-06-29 09:34:49] [config] maxi-batch-sort: trg
[2023-06-29 09:34:49] [config] mini-batch: 64
[2023-06-29 09:34:49] [config] mini-batch-fit: true
[2023-06-29 09:34:49] [config] mini-batch-fit-step: 10
[2023-06-29 09:34:49] [config] mini-batch-round-up: true
[2023-06-29 09:34:49] [config] mini-batch-track-lr: false
[2023-06-29 09:34:49] [config] mini-batch-warmup: 0
[2023-06-29 09:34:49] [config] mini-batch-words: 0
[2023-06-29 09:34:49] [config] mini-batch-words-ref: 0
[2023-06-29 09:34:49] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:34:49] [config] multi-loss-type: sum
[2023-06-29 09:34:49] [config] n-best: false
[2023-06-29 09:34:49] [config] no-nccl: false
[2023-06-29 09:34:49] [config] no-reload: false
[2023-06-29 09:34:49] [config] no-restore-corpus: false
[2023-06-29 09:34:49] [config] normalize: 0.6
[2023-06-29 09:34:49] [config] normalize-gradient: false
[2023-06-29 09:34:49] [config] num-devices: 0
[2023-06-29 09:34:49] [config] optimizer: adam
[2023-06-29 09:34:49] [config] optimizer-delay: 1
[2023-06-29 09:34:49] [config] optimizer-params:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] output-omit-bias: false
[2023-06-29 09:34:49] [config] overwrite: true
[2023-06-29 09:34:49] [config] precision:
[2023-06-29 09:34:49] [config]   - float32
[2023-06-29 09:34:49] [config]   - float32
[2023-06-29 09:34:49] [config] pretrained-model: ""
[2023-06-29 09:34:49] [config] quantize-biases: false
[2023-06-29 09:34:49] [config] quantize-bits: 0
[2023-06-29 09:34:49] [config] quantize-log-based: false
[2023-06-29 09:34:49] [config] quantize-optimization-steps: 0
[2023-06-29 09:34:49] [config] quiet: false
[2023-06-29 09:34:49] [config] quiet-translation: true
[2023-06-29 09:34:49] [config] relative-paths: false
[2023-06-29 09:34:49] [config] right-left: false
[2023-06-29 09:34:49] [config] save-freq: 10000u
[2023-06-29 09:34:49] [config] seed: 1234
[2023-06-29 09:34:49] [config] sentencepiece-alphas:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:34:49] [config] sentencepiece-options: ""
[2023-06-29 09:34:49] [config] sharding: global
[2023-06-29 09:34:49] [config] shuffle: data
[2023-06-29 09:34:49] [config] shuffle-in-ram: false
[2023-06-29 09:34:49] [config] sigterm: save-and-exit
[2023-06-29 09:34:49] [config] skip: false
[2023-06-29 09:34:49] [config] sqlite: ""
[2023-06-29 09:34:49] [config] sqlite-drop: false
[2023-06-29 09:34:49] [config] sync-freq: 200u
[2023-06-29 09:34:49] [config] sync-sgd: false
[2023-06-29 09:34:49] [config] tempdir: /tmp
[2023-06-29 09:34:49] [config] tied-embeddings: false
[2023-06-29 09:34:49] [config] tied-embeddings-all: true
[2023-06-29 09:34:49] [config] tied-embeddings-src: false
[2023-06-29 09:34:49] [config] train-embedder-rank:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] train-sets:
[2023-06-29 09:34:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:34:49] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:34:49] [config] transformer-aan-activation: swish
[2023-06-29 09:34:49] [config] transformer-aan-depth: 2
[2023-06-29 09:34:49] [config] transformer-aan-nogate: false
[2023-06-29 09:34:49] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:34:49] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:34:49] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:34:49] [config] transformer-depth-scaling: false
[2023-06-29 09:34:49] [config] transformer-dim-aan: 2048
[2023-06-29 09:34:49] [config] transformer-dim-ffn: 2048
[2023-06-29 09:34:49] [config] transformer-dropout: 0
[2023-06-29 09:34:49] [config] transformer-dropout-attention: 0
[2023-06-29 09:34:49] [config] transformer-dropout-ffn: 0
[2023-06-29 09:34:49] [config] transformer-ffn-activation: swish
[2023-06-29 09:34:49] [config] transformer-ffn-depth: 2
[2023-06-29 09:34:49] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:34:49] [config] transformer-heads: 8
[2023-06-29 09:34:49] [config] transformer-no-projection: false
[2023-06-29 09:34:49] [config] transformer-pool: false
[2023-06-29 09:34:49] [config] transformer-postprocess: dan
[2023-06-29 09:34:49] [config] transformer-postprocess-emb: d
[2023-06-29 09:34:49] [config] transformer-postprocess-top: ""
[2023-06-29 09:34:49] [config] transformer-preprocess: ""
[2023-06-29 09:34:49] [config] transformer-tied-layers:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] transformer-train-position-embeddings: false
[2023-06-29 09:34:49] [config] tsv: false
[2023-06-29 09:34:49] [config] tsv-fields: 0
[2023-06-29 09:34:49] [config] type: amun
[2023-06-29 09:34:49] [config] ulr: false
[2023-06-29 09:34:49] [config] ulr-dim-emb: 0
[2023-06-29 09:34:49] [config] ulr-dropout: 0
[2023-06-29 09:34:49] [config] ulr-keys-vectors: ""
[2023-06-29 09:34:49] [config] ulr-query-vectors: ""
[2023-06-29 09:34:49] [config] ulr-softmax-temperature: 1
[2023-06-29 09:34:49] [config] ulr-trainable-transformation: false
[2023-06-29 09:34:49] [config] unlikelihood-loss: false
[2023-06-29 09:34:49] [config] valid-freq: 50000000
[2023-06-29 09:34:49] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:34:49] [config] valid-max-length: 1000
[2023-06-29 09:34:49] [config] valid-metrics:
[2023-06-29 09:34:49] [config]   - cross-entropy
[2023-06-29 09:34:49] [config]   - translation
[2023-06-29 09:34:49] [config] valid-mini-batch: 32
[2023-06-29 09:34:49] [config] valid-reset-stalled: false
[2023-06-29 09:34:49] [config] valid-script-args:
[2023-06-29 09:34:49] [config]   []
[2023-06-29 09:34:49] [config] valid-script-path: ""
[2023-06-29 09:34:49] [config] valid-sets:
[2023-06-29 09:34:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:34:49] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:34:49] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:34:49] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:34:49] [config] vocabs:
[2023-06-29 09:34:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:34:49] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:34:49] [config] word-penalty: 0
[2023-06-29 09:34:49] [config] word-scores: false
[2023-06-29 09:34:49] [config] workspace: 3000
[2023-06-29 09:34:49] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:34:49] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:34:49] [training] Using single-device training
[2023-06-29 09:34:50] Synced seed 1234
[2023-06-29 09:34:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:34:50] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:34:50] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:34:50] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:34:50] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:34:50] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:34:50] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:34:50] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:34:50] [comm] Using global sharding
[2023-06-29 09:34:51] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:34:51] [training] Using 1 GPUs
[2023-06-29 09:34:51] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:34:51] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:34:51] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:34:51] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:03] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:35:04] [valid] No post-processing script given for validating translator
[2023-06-29 09:35:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:04] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:35:04] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:35:04] [comm] Using global sharding
[2023-06-29 09:35:04] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:35:04] [training] Using 1 GPUs
[2023-06-29 09:35:04] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:35:04] Loading Adam parameters
[2023-06-29 09:35:04] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:35:05] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:05] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:35:05] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:35:05] [data] Shuffling data
[2023-06-29 09:35:05] [data] Done reading 20,192 sentences
[2023-06-29 09:35:05] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:35:05] Training started
[2023-06-29 09:35:05] Training finished
[2023-06-29 09:35:08] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:08] [marian] Running on node20.datos.cluster.uy as process 19073 with command line:
[2023-06-29 09:35:08] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 160 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:35:08] [config] after: 0e
[2023-06-29 09:35:08] [config] after-batches: 0
[2023-06-29 09:35:08] [config] after-epochs: 160
[2023-06-29 09:35:08] [config] all-caps-every: 0
[2023-06-29 09:35:08] [config] allow-unk: false
[2023-06-29 09:35:08] [config] authors: false
[2023-06-29 09:35:08] [config] beam-size: 6
[2023-06-29 09:35:08] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:35:08] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:35:08] [config] bert-masking-fraction: 0.15
[2023-06-29 09:35:08] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:35:08] [config] bert-train-type-embeddings: true
[2023-06-29 09:35:08] [config] bert-type-vocab-size: 2
[2023-06-29 09:35:08] [config] build-info: ""
[2023-06-29 09:35:08] [config] check-gradient-nan: false
[2023-06-29 09:35:08] [config] check-nan: false
[2023-06-29 09:35:08] [config] cite: false
[2023-06-29 09:35:08] [config] clip-norm: 1
[2023-06-29 09:35:08] [config] cost-scaling:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] cost-type: ce-sum
[2023-06-29 09:35:08] [config] cpu-threads: 0
[2023-06-29 09:35:08] [config] data-threads: 8
[2023-06-29 09:35:08] [config] data-weighting: ""
[2023-06-29 09:35:08] [config] data-weighting-type: sentence
[2023-06-29 09:35:08] [config] dec-cell: gru
[2023-06-29 09:35:08] [config] dec-cell-base-depth: 2
[2023-06-29 09:35:08] [config] dec-cell-high-depth: 1
[2023-06-29 09:35:08] [config] dec-depth: 1
[2023-06-29 09:35:08] [config] devices:
[2023-06-29 09:35:08] [config]   - 0
[2023-06-29 09:35:08] [config] dim-emb: 512
[2023-06-29 09:35:08] [config] dim-rnn: 1024
[2023-06-29 09:35:08] [config] dim-vocabs:
[2023-06-29 09:35:08] [config]   - 16384
[2023-06-29 09:35:08] [config]   - 16384
[2023-06-29 09:35:08] [config] disp-first: 0
[2023-06-29 09:35:08] [config] disp-freq: 1000u
[2023-06-29 09:35:08] [config] disp-label-counts: true
[2023-06-29 09:35:08] [config] dropout-rnn: 0.2
[2023-06-29 09:35:08] [config] dropout-src: 0.1
[2023-06-29 09:35:08] [config] dropout-trg: 0.1
[2023-06-29 09:35:08] [config] dump-config: ""
[2023-06-29 09:35:08] [config] dynamic-gradient-scaling:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] early-stopping: 10
[2023-06-29 09:35:08] [config] early-stopping-on: first
[2023-06-29 09:35:08] [config] embedding-fix-src: false
[2023-06-29 09:35:08] [config] embedding-fix-trg: false
[2023-06-29 09:35:08] [config] embedding-normalization: false
[2023-06-29 09:35:08] [config] embedding-vectors:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] enc-cell: gru
[2023-06-29 09:35:08] [config] enc-cell-depth: 1
[2023-06-29 09:35:08] [config] enc-depth: 1
[2023-06-29 09:35:08] [config] enc-type: bidirectional
[2023-06-29 09:35:08] [config] english-title-case-every: 0
[2023-06-29 09:35:08] [config] exponential-smoothing: 0
[2023-06-29 09:35:08] [config] factor-weight: 1
[2023-06-29 09:35:08] [config] factors-combine: sum
[2023-06-29 09:35:08] [config] factors-dim-emb: 0
[2023-06-29 09:35:08] [config] gradient-checkpointing: false
[2023-06-29 09:35:08] [config] gradient-norm-average-window: 100
[2023-06-29 09:35:08] [config] guided-alignment: none
[2023-06-29 09:35:08] [config] guided-alignment-cost: mse
[2023-06-29 09:35:08] [config] guided-alignment-weight: 0.1
[2023-06-29 09:35:08] [config] ignore-model-config: false
[2023-06-29 09:35:08] [config] input-types:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] interpolate-env-vars: false
[2023-06-29 09:35:08] [config] keep-best: false
[2023-06-29 09:35:08] [config] label-smoothing: 0
[2023-06-29 09:35:08] [config] layer-normalization: true
[2023-06-29 09:35:08] [config] learn-rate: 0.0001
[2023-06-29 09:35:08] [config] lemma-dependency: ""
[2023-06-29 09:35:08] [config] lemma-dim-emb: 0
[2023-06-29 09:35:08] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:35:08] [config] log-level: info
[2023-06-29 09:35:08] [config] log-time-zone: ""
[2023-06-29 09:35:08] [config] logical-epoch:
[2023-06-29 09:35:08] [config]   - 1e
[2023-06-29 09:35:08] [config]   - 0
[2023-06-29 09:35:08] [config] lr-decay: 0
[2023-06-29 09:35:08] [config] lr-decay-freq: 50000
[2023-06-29 09:35:08] [config] lr-decay-inv-sqrt:
[2023-06-29 09:35:08] [config]   - 0
[2023-06-29 09:35:08] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:35:08] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:35:08] [config] lr-decay-start:
[2023-06-29 09:35:08] [config]   - 10
[2023-06-29 09:35:08] [config]   - 1
[2023-06-29 09:35:08] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:35:08] [config] lr-report: false
[2023-06-29 09:35:08] [config] lr-warmup: 0
[2023-06-29 09:35:08] [config] lr-warmup-at-reload: false
[2023-06-29 09:35:08] [config] lr-warmup-cycle: false
[2023-06-29 09:35:08] [config] lr-warmup-start-rate: 0
[2023-06-29 09:35:08] [config] max-length: 50
[2023-06-29 09:35:08] [config] max-length-crop: false
[2023-06-29 09:35:08] [config] max-length-factor: 3
[2023-06-29 09:35:08] [config] maxi-batch: 100
[2023-06-29 09:35:08] [config] maxi-batch-sort: trg
[2023-06-29 09:35:08] [config] mini-batch: 64
[2023-06-29 09:35:08] [config] mini-batch-fit: true
[2023-06-29 09:35:08] [config] mini-batch-fit-step: 10
[2023-06-29 09:35:08] [config] mini-batch-round-up: true
[2023-06-29 09:35:08] [config] mini-batch-track-lr: false
[2023-06-29 09:35:08] [config] mini-batch-warmup: 0
[2023-06-29 09:35:08] [config] mini-batch-words: 0
[2023-06-29 09:35:08] [config] mini-batch-words-ref: 0
[2023-06-29 09:35:08] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:35:08] [config] multi-loss-type: sum
[2023-06-29 09:35:08] [config] n-best: false
[2023-06-29 09:35:08] [config] no-nccl: false
[2023-06-29 09:35:08] [config] no-reload: false
[2023-06-29 09:35:08] [config] no-restore-corpus: false
[2023-06-29 09:35:08] [config] normalize: 0.6
[2023-06-29 09:35:08] [config] normalize-gradient: false
[2023-06-29 09:35:08] [config] num-devices: 0
[2023-06-29 09:35:08] [config] optimizer: adam
[2023-06-29 09:35:08] [config] optimizer-delay: 1
[2023-06-29 09:35:08] [config] optimizer-params:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] output-omit-bias: false
[2023-06-29 09:35:08] [config] overwrite: true
[2023-06-29 09:35:08] [config] precision:
[2023-06-29 09:35:08] [config]   - float32
[2023-06-29 09:35:08] [config]   - float32
[2023-06-29 09:35:08] [config] pretrained-model: ""
[2023-06-29 09:35:08] [config] quantize-biases: false
[2023-06-29 09:35:08] [config] quantize-bits: 0
[2023-06-29 09:35:08] [config] quantize-log-based: false
[2023-06-29 09:35:08] [config] quantize-optimization-steps: 0
[2023-06-29 09:35:08] [config] quiet: false
[2023-06-29 09:35:08] [config] quiet-translation: true
[2023-06-29 09:35:08] [config] relative-paths: false
[2023-06-29 09:35:08] [config] right-left: false
[2023-06-29 09:35:08] [config] save-freq: 10000u
[2023-06-29 09:35:08] [config] seed: 1234
[2023-06-29 09:35:08] [config] sentencepiece-alphas:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:35:08] [config] sentencepiece-options: ""
[2023-06-29 09:35:08] [config] sharding: global
[2023-06-29 09:35:08] [config] shuffle: data
[2023-06-29 09:35:08] [config] shuffle-in-ram: false
[2023-06-29 09:35:08] [config] sigterm: save-and-exit
[2023-06-29 09:35:08] [config] skip: false
[2023-06-29 09:35:08] [config] sqlite: ""
[2023-06-29 09:35:08] [config] sqlite-drop: false
[2023-06-29 09:35:08] [config] sync-freq: 200u
[2023-06-29 09:35:08] [config] sync-sgd: false
[2023-06-29 09:35:08] [config] tempdir: /tmp
[2023-06-29 09:35:08] [config] tied-embeddings: false
[2023-06-29 09:35:08] [config] tied-embeddings-all: true
[2023-06-29 09:35:08] [config] tied-embeddings-src: false
[2023-06-29 09:35:08] [config] train-embedder-rank:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] train-sets:
[2023-06-29 09:35:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:35:08] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:35:08] [config] transformer-aan-activation: swish
[2023-06-29 09:35:08] [config] transformer-aan-depth: 2
[2023-06-29 09:35:08] [config] transformer-aan-nogate: false
[2023-06-29 09:35:08] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:35:08] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:35:08] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:35:08] [config] transformer-depth-scaling: false
[2023-06-29 09:35:08] [config] transformer-dim-aan: 2048
[2023-06-29 09:35:08] [config] transformer-dim-ffn: 2048
[2023-06-29 09:35:08] [config] transformer-dropout: 0
[2023-06-29 09:35:08] [config] transformer-dropout-attention: 0
[2023-06-29 09:35:08] [config] transformer-dropout-ffn: 0
[2023-06-29 09:35:08] [config] transformer-ffn-activation: swish
[2023-06-29 09:35:08] [config] transformer-ffn-depth: 2
[2023-06-29 09:35:08] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:35:08] [config] transformer-heads: 8
[2023-06-29 09:35:08] [config] transformer-no-projection: false
[2023-06-29 09:35:08] [config] transformer-pool: false
[2023-06-29 09:35:08] [config] transformer-postprocess: dan
[2023-06-29 09:35:08] [config] transformer-postprocess-emb: d
[2023-06-29 09:35:08] [config] transformer-postprocess-top: ""
[2023-06-29 09:35:08] [config] transformer-preprocess: ""
[2023-06-29 09:35:08] [config] transformer-tied-layers:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] transformer-train-position-embeddings: false
[2023-06-29 09:35:08] [config] tsv: false
[2023-06-29 09:35:08] [config] tsv-fields: 0
[2023-06-29 09:35:08] [config] type: amun
[2023-06-29 09:35:08] [config] ulr: false
[2023-06-29 09:35:08] [config] ulr-dim-emb: 0
[2023-06-29 09:35:08] [config] ulr-dropout: 0
[2023-06-29 09:35:08] [config] ulr-keys-vectors: ""
[2023-06-29 09:35:08] [config] ulr-query-vectors: ""
[2023-06-29 09:35:08] [config] ulr-softmax-temperature: 1
[2023-06-29 09:35:08] [config] ulr-trainable-transformation: false
[2023-06-29 09:35:08] [config] unlikelihood-loss: false
[2023-06-29 09:35:08] [config] valid-freq: 50000000
[2023-06-29 09:35:08] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:35:08] [config] valid-max-length: 1000
[2023-06-29 09:35:08] [config] valid-metrics:
[2023-06-29 09:35:08] [config]   - cross-entropy
[2023-06-29 09:35:08] [config]   - translation
[2023-06-29 09:35:08] [config] valid-mini-batch: 32
[2023-06-29 09:35:08] [config] valid-reset-stalled: false
[2023-06-29 09:35:08] [config] valid-script-args:
[2023-06-29 09:35:08] [config]   []
[2023-06-29 09:35:08] [config] valid-script-path: ""
[2023-06-29 09:35:08] [config] valid-sets:
[2023-06-29 09:35:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:35:08] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:35:08] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:35:08] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:08] [config] vocabs:
[2023-06-29 09:35:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:35:08] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:35:08] [config] word-penalty: 0
[2023-06-29 09:35:08] [config] word-scores: false
[2023-06-29 09:35:08] [config] workspace: 3000
[2023-06-29 09:35:08] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:08] [training] Using single-device training
[2023-06-29 09:35:08] Synced seed 1234
[2023-06-29 09:35:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:35:08] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:35:08] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:35:08] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:35:08] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:35:08] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:09] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:35:09] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:35:09] [comm] Using global sharding
[2023-06-29 09:35:09] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:35:09] [training] Using 1 GPUs
[2023-06-29 09:35:09] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:35:09] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:09] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:35:09] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:22] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:35:22] [valid] No post-processing script given for validating translator
[2023-06-29 09:35:22] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:22] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:35:22] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:35:22] [comm] Using global sharding
[2023-06-29 09:35:22] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:35:22] [training] Using 1 GPUs
[2023-06-29 09:35:22] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:35:23] Loading Adam parameters
[2023-06-29 09:35:23] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:35:23] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:23] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:35:23] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:35:23] [data] Shuffling data
[2023-06-29 09:35:23] [data] Done reading 20,192 sentences
[2023-06-29 09:35:23] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:35:23] Training started
[2023-06-29 09:35:23] Training finished
[2023-06-29 09:35:27] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:27] [marian] Running on node20.datos.cluster.uy as process 19138 with command line:
[2023-06-29 09:35:27] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 170 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:35:27] [config] after: 0e
[2023-06-29 09:35:27] [config] after-batches: 0
[2023-06-29 09:35:27] [config] after-epochs: 170
[2023-06-29 09:35:27] [config] all-caps-every: 0
[2023-06-29 09:35:27] [config] allow-unk: false
[2023-06-29 09:35:27] [config] authors: false
[2023-06-29 09:35:27] [config] beam-size: 6
[2023-06-29 09:35:27] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:35:27] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:35:27] [config] bert-masking-fraction: 0.15
[2023-06-29 09:35:27] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:35:27] [config] bert-train-type-embeddings: true
[2023-06-29 09:35:27] [config] bert-type-vocab-size: 2
[2023-06-29 09:35:27] [config] build-info: ""
[2023-06-29 09:35:27] [config] check-gradient-nan: false
[2023-06-29 09:35:27] [config] check-nan: false
[2023-06-29 09:35:27] [config] cite: false
[2023-06-29 09:35:27] [config] clip-norm: 1
[2023-06-29 09:35:27] [config] cost-scaling:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] cost-type: ce-sum
[2023-06-29 09:35:27] [config] cpu-threads: 0
[2023-06-29 09:35:27] [config] data-threads: 8
[2023-06-29 09:35:27] [config] data-weighting: ""
[2023-06-29 09:35:27] [config] data-weighting-type: sentence
[2023-06-29 09:35:27] [config] dec-cell: gru
[2023-06-29 09:35:27] [config] dec-cell-base-depth: 2
[2023-06-29 09:35:27] [config] dec-cell-high-depth: 1
[2023-06-29 09:35:27] [config] dec-depth: 1
[2023-06-29 09:35:27] [config] devices:
[2023-06-29 09:35:27] [config]   - 0
[2023-06-29 09:35:27] [config] dim-emb: 512
[2023-06-29 09:35:27] [config] dim-rnn: 1024
[2023-06-29 09:35:27] [config] dim-vocabs:
[2023-06-29 09:35:27] [config]   - 16384
[2023-06-29 09:35:27] [config]   - 16384
[2023-06-29 09:35:27] [config] disp-first: 0
[2023-06-29 09:35:27] [config] disp-freq: 1000u
[2023-06-29 09:35:27] [config] disp-label-counts: true
[2023-06-29 09:35:27] [config] dropout-rnn: 0.2
[2023-06-29 09:35:27] [config] dropout-src: 0.1
[2023-06-29 09:35:27] [config] dropout-trg: 0.1
[2023-06-29 09:35:27] [config] dump-config: ""
[2023-06-29 09:35:27] [config] dynamic-gradient-scaling:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] early-stopping: 10
[2023-06-29 09:35:27] [config] early-stopping-on: first
[2023-06-29 09:35:27] [config] embedding-fix-src: false
[2023-06-29 09:35:27] [config] embedding-fix-trg: false
[2023-06-29 09:35:27] [config] embedding-normalization: false
[2023-06-29 09:35:27] [config] embedding-vectors:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] enc-cell: gru
[2023-06-29 09:35:27] [config] enc-cell-depth: 1
[2023-06-29 09:35:27] [config] enc-depth: 1
[2023-06-29 09:35:27] [config] enc-type: bidirectional
[2023-06-29 09:35:27] [config] english-title-case-every: 0
[2023-06-29 09:35:27] [config] exponential-smoothing: 0
[2023-06-29 09:35:27] [config] factor-weight: 1
[2023-06-29 09:35:27] [config] factors-combine: sum
[2023-06-29 09:35:27] [config] factors-dim-emb: 0
[2023-06-29 09:35:27] [config] gradient-checkpointing: false
[2023-06-29 09:35:27] [config] gradient-norm-average-window: 100
[2023-06-29 09:35:27] [config] guided-alignment: none
[2023-06-29 09:35:27] [config] guided-alignment-cost: mse
[2023-06-29 09:35:27] [config] guided-alignment-weight: 0.1
[2023-06-29 09:35:27] [config] ignore-model-config: false
[2023-06-29 09:35:27] [config] input-types:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] interpolate-env-vars: false
[2023-06-29 09:35:27] [config] keep-best: false
[2023-06-29 09:35:27] [config] label-smoothing: 0
[2023-06-29 09:35:27] [config] layer-normalization: true
[2023-06-29 09:35:27] [config] learn-rate: 0.0001
[2023-06-29 09:35:27] [config] lemma-dependency: ""
[2023-06-29 09:35:27] [config] lemma-dim-emb: 0
[2023-06-29 09:35:27] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:35:27] [config] log-level: info
[2023-06-29 09:35:27] [config] log-time-zone: ""
[2023-06-29 09:35:27] [config] logical-epoch:
[2023-06-29 09:35:27] [config]   - 1e
[2023-06-29 09:35:27] [config]   - 0
[2023-06-29 09:35:27] [config] lr-decay: 0
[2023-06-29 09:35:27] [config] lr-decay-freq: 50000
[2023-06-29 09:35:27] [config] lr-decay-inv-sqrt:
[2023-06-29 09:35:27] [config]   - 0
[2023-06-29 09:35:27] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:35:27] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:35:27] [config] lr-decay-start:
[2023-06-29 09:35:27] [config]   - 10
[2023-06-29 09:35:27] [config]   - 1
[2023-06-29 09:35:27] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:35:27] [config] lr-report: false
[2023-06-29 09:35:27] [config] lr-warmup: 0
[2023-06-29 09:35:27] [config] lr-warmup-at-reload: false
[2023-06-29 09:35:27] [config] lr-warmup-cycle: false
[2023-06-29 09:35:27] [config] lr-warmup-start-rate: 0
[2023-06-29 09:35:27] [config] max-length: 50
[2023-06-29 09:35:27] [config] max-length-crop: false
[2023-06-29 09:35:27] [config] max-length-factor: 3
[2023-06-29 09:35:27] [config] maxi-batch: 100
[2023-06-29 09:35:27] [config] maxi-batch-sort: trg
[2023-06-29 09:35:27] [config] mini-batch: 64
[2023-06-29 09:35:27] [config] mini-batch-fit: true
[2023-06-29 09:35:27] [config] mini-batch-fit-step: 10
[2023-06-29 09:35:27] [config] mini-batch-round-up: true
[2023-06-29 09:35:27] [config] mini-batch-track-lr: false
[2023-06-29 09:35:27] [config] mini-batch-warmup: 0
[2023-06-29 09:35:27] [config] mini-batch-words: 0
[2023-06-29 09:35:27] [config] mini-batch-words-ref: 0
[2023-06-29 09:35:27] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:35:27] [config] multi-loss-type: sum
[2023-06-29 09:35:27] [config] n-best: false
[2023-06-29 09:35:27] [config] no-nccl: false
[2023-06-29 09:35:27] [config] no-reload: false
[2023-06-29 09:35:27] [config] no-restore-corpus: false
[2023-06-29 09:35:27] [config] normalize: 0.6
[2023-06-29 09:35:27] [config] normalize-gradient: false
[2023-06-29 09:35:27] [config] num-devices: 0
[2023-06-29 09:35:27] [config] optimizer: adam
[2023-06-29 09:35:27] [config] optimizer-delay: 1
[2023-06-29 09:35:27] [config] optimizer-params:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] output-omit-bias: false
[2023-06-29 09:35:27] [config] overwrite: true
[2023-06-29 09:35:27] [config] precision:
[2023-06-29 09:35:27] [config]   - float32
[2023-06-29 09:35:27] [config]   - float32
[2023-06-29 09:35:27] [config] pretrained-model: ""
[2023-06-29 09:35:27] [config] quantize-biases: false
[2023-06-29 09:35:27] [config] quantize-bits: 0
[2023-06-29 09:35:27] [config] quantize-log-based: false
[2023-06-29 09:35:27] [config] quantize-optimization-steps: 0
[2023-06-29 09:35:27] [config] quiet: false
[2023-06-29 09:35:27] [config] quiet-translation: true
[2023-06-29 09:35:27] [config] relative-paths: false
[2023-06-29 09:35:27] [config] right-left: false
[2023-06-29 09:35:27] [config] save-freq: 10000u
[2023-06-29 09:35:27] [config] seed: 1234
[2023-06-29 09:35:27] [config] sentencepiece-alphas:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:35:27] [config] sentencepiece-options: ""
[2023-06-29 09:35:27] [config] sharding: global
[2023-06-29 09:35:27] [config] shuffle: data
[2023-06-29 09:35:27] [config] shuffle-in-ram: false
[2023-06-29 09:35:27] [config] sigterm: save-and-exit
[2023-06-29 09:35:27] [config] skip: false
[2023-06-29 09:35:27] [config] sqlite: ""
[2023-06-29 09:35:27] [config] sqlite-drop: false
[2023-06-29 09:35:27] [config] sync-freq: 200u
[2023-06-29 09:35:27] [config] sync-sgd: false
[2023-06-29 09:35:27] [config] tempdir: /tmp
[2023-06-29 09:35:27] [config] tied-embeddings: false
[2023-06-29 09:35:27] [config] tied-embeddings-all: true
[2023-06-29 09:35:27] [config] tied-embeddings-src: false
[2023-06-29 09:35:27] [config] train-embedder-rank:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] train-sets:
[2023-06-29 09:35:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:35:27] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:35:27] [config] transformer-aan-activation: swish
[2023-06-29 09:35:27] [config] transformer-aan-depth: 2
[2023-06-29 09:35:27] [config] transformer-aan-nogate: false
[2023-06-29 09:35:27] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:35:27] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:35:27] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:35:27] [config] transformer-depth-scaling: false
[2023-06-29 09:35:27] [config] transformer-dim-aan: 2048
[2023-06-29 09:35:27] [config] transformer-dim-ffn: 2048
[2023-06-29 09:35:27] [config] transformer-dropout: 0
[2023-06-29 09:35:27] [config] transformer-dropout-attention: 0
[2023-06-29 09:35:27] [config] transformer-dropout-ffn: 0
[2023-06-29 09:35:27] [config] transformer-ffn-activation: swish
[2023-06-29 09:35:27] [config] transformer-ffn-depth: 2
[2023-06-29 09:35:27] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:35:27] [config] transformer-heads: 8
[2023-06-29 09:35:27] [config] transformer-no-projection: false
[2023-06-29 09:35:27] [config] transformer-pool: false
[2023-06-29 09:35:27] [config] transformer-postprocess: dan
[2023-06-29 09:35:27] [config] transformer-postprocess-emb: d
[2023-06-29 09:35:27] [config] transformer-postprocess-top: ""
[2023-06-29 09:35:27] [config] transformer-preprocess: ""
[2023-06-29 09:35:27] [config] transformer-tied-layers:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] transformer-train-position-embeddings: false
[2023-06-29 09:35:27] [config] tsv: false
[2023-06-29 09:35:27] [config] tsv-fields: 0
[2023-06-29 09:35:27] [config] type: amun
[2023-06-29 09:35:27] [config] ulr: false
[2023-06-29 09:35:27] [config] ulr-dim-emb: 0
[2023-06-29 09:35:27] [config] ulr-dropout: 0
[2023-06-29 09:35:27] [config] ulr-keys-vectors: ""
[2023-06-29 09:35:27] [config] ulr-query-vectors: ""
[2023-06-29 09:35:27] [config] ulr-softmax-temperature: 1
[2023-06-29 09:35:27] [config] ulr-trainable-transformation: false
[2023-06-29 09:35:27] [config] unlikelihood-loss: false
[2023-06-29 09:35:27] [config] valid-freq: 50000000
[2023-06-29 09:35:27] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:35:27] [config] valid-max-length: 1000
[2023-06-29 09:35:27] [config] valid-metrics:
[2023-06-29 09:35:27] [config]   - cross-entropy
[2023-06-29 09:35:27] [config]   - translation
[2023-06-29 09:35:27] [config] valid-mini-batch: 32
[2023-06-29 09:35:27] [config] valid-reset-stalled: false
[2023-06-29 09:35:27] [config] valid-script-args:
[2023-06-29 09:35:27] [config]   []
[2023-06-29 09:35:27] [config] valid-script-path: ""
[2023-06-29 09:35:27] [config] valid-sets:
[2023-06-29 09:35:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:35:27] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:35:27] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:35:27] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:27] [config] vocabs:
[2023-06-29 09:35:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:35:27] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:35:27] [config] word-penalty: 0
[2023-06-29 09:35:27] [config] word-scores: false
[2023-06-29 09:35:27] [config] workspace: 3000
[2023-06-29 09:35:27] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:27] [training] Using single-device training
[2023-06-29 09:35:27] Synced seed 1234
[2023-06-29 09:35:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:35:27] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:35:27] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:35:27] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:35:27] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:35:27] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:28] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:35:28] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:35:28] [comm] Using global sharding
[2023-06-29 09:35:28] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:35:28] [training] Using 1 GPUs
[2023-06-29 09:35:28] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:35:28] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:28] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:35:28] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:41] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:35:41] [valid] No post-processing script given for validating translator
[2023-06-29 09:35:41] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:41] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:35:41] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:35:41] [comm] Using global sharding
[2023-06-29 09:35:41] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:35:41] [training] Using 1 GPUs
[2023-06-29 09:35:41] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:35:42] Loading Adam parameters
[2023-06-29 09:35:42] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:35:42] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:42] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:35:42] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:35:42] [data] Shuffling data
[2023-06-29 09:35:42] [data] Done reading 20,192 sentences
[2023-06-29 09:35:42] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:35:42] Training started
[2023-06-29 09:35:42] Training finished
[2023-06-29 09:35:45] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:45] [marian] Running on node20.datos.cluster.uy as process 19202 with command line:
[2023-06-29 09:35:45] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 180 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:35:45] [config] after: 0e
[2023-06-29 09:35:45] [config] after-batches: 0
[2023-06-29 09:35:45] [config] after-epochs: 180
[2023-06-29 09:35:45] [config] all-caps-every: 0
[2023-06-29 09:35:45] [config] allow-unk: false
[2023-06-29 09:35:45] [config] authors: false
[2023-06-29 09:35:45] [config] beam-size: 6
[2023-06-29 09:35:45] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:35:45] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:35:45] [config] bert-masking-fraction: 0.15
[2023-06-29 09:35:45] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:35:45] [config] bert-train-type-embeddings: true
[2023-06-29 09:35:45] [config] bert-type-vocab-size: 2
[2023-06-29 09:35:45] [config] build-info: ""
[2023-06-29 09:35:45] [config] check-gradient-nan: false
[2023-06-29 09:35:45] [config] check-nan: false
[2023-06-29 09:35:45] [config] cite: false
[2023-06-29 09:35:45] [config] clip-norm: 1
[2023-06-29 09:35:45] [config] cost-scaling:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] cost-type: ce-sum
[2023-06-29 09:35:45] [config] cpu-threads: 0
[2023-06-29 09:35:45] [config] data-threads: 8
[2023-06-29 09:35:45] [config] data-weighting: ""
[2023-06-29 09:35:45] [config] data-weighting-type: sentence
[2023-06-29 09:35:45] [config] dec-cell: gru
[2023-06-29 09:35:45] [config] dec-cell-base-depth: 2
[2023-06-29 09:35:45] [config] dec-cell-high-depth: 1
[2023-06-29 09:35:45] [config] dec-depth: 1
[2023-06-29 09:35:45] [config] devices:
[2023-06-29 09:35:45] [config]   - 0
[2023-06-29 09:35:45] [config] dim-emb: 512
[2023-06-29 09:35:45] [config] dim-rnn: 1024
[2023-06-29 09:35:45] [config] dim-vocabs:
[2023-06-29 09:35:45] [config]   - 16384
[2023-06-29 09:35:45] [config]   - 16384
[2023-06-29 09:35:45] [config] disp-first: 0
[2023-06-29 09:35:45] [config] disp-freq: 1000u
[2023-06-29 09:35:45] [config] disp-label-counts: true
[2023-06-29 09:35:45] [config] dropout-rnn: 0.2
[2023-06-29 09:35:45] [config] dropout-src: 0.1
[2023-06-29 09:35:45] [config] dropout-trg: 0.1
[2023-06-29 09:35:45] [config] dump-config: ""
[2023-06-29 09:35:45] [config] dynamic-gradient-scaling:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] early-stopping: 10
[2023-06-29 09:35:45] [config] early-stopping-on: first
[2023-06-29 09:35:45] [config] embedding-fix-src: false
[2023-06-29 09:35:45] [config] embedding-fix-trg: false
[2023-06-29 09:35:45] [config] embedding-normalization: false
[2023-06-29 09:35:45] [config] embedding-vectors:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] enc-cell: gru
[2023-06-29 09:35:45] [config] enc-cell-depth: 1
[2023-06-29 09:35:45] [config] enc-depth: 1
[2023-06-29 09:35:45] [config] enc-type: bidirectional
[2023-06-29 09:35:45] [config] english-title-case-every: 0
[2023-06-29 09:35:45] [config] exponential-smoothing: 0
[2023-06-29 09:35:45] [config] factor-weight: 1
[2023-06-29 09:35:45] [config] factors-combine: sum
[2023-06-29 09:35:45] [config] factors-dim-emb: 0
[2023-06-29 09:35:45] [config] gradient-checkpointing: false
[2023-06-29 09:35:45] [config] gradient-norm-average-window: 100
[2023-06-29 09:35:45] [config] guided-alignment: none
[2023-06-29 09:35:45] [config] guided-alignment-cost: mse
[2023-06-29 09:35:45] [config] guided-alignment-weight: 0.1
[2023-06-29 09:35:45] [config] ignore-model-config: false
[2023-06-29 09:35:45] [config] input-types:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] interpolate-env-vars: false
[2023-06-29 09:35:45] [config] keep-best: false
[2023-06-29 09:35:45] [config] label-smoothing: 0
[2023-06-29 09:35:45] [config] layer-normalization: true
[2023-06-29 09:35:45] [config] learn-rate: 0.0001
[2023-06-29 09:35:45] [config] lemma-dependency: ""
[2023-06-29 09:35:45] [config] lemma-dim-emb: 0
[2023-06-29 09:35:45] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:35:45] [config] log-level: info
[2023-06-29 09:35:45] [config] log-time-zone: ""
[2023-06-29 09:35:45] [config] logical-epoch:
[2023-06-29 09:35:45] [config]   - 1e
[2023-06-29 09:35:45] [config]   - 0
[2023-06-29 09:35:45] [config] lr-decay: 0
[2023-06-29 09:35:45] [config] lr-decay-freq: 50000
[2023-06-29 09:35:45] [config] lr-decay-inv-sqrt:
[2023-06-29 09:35:45] [config]   - 0
[2023-06-29 09:35:45] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:35:45] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:35:45] [config] lr-decay-start:
[2023-06-29 09:35:45] [config]   - 10
[2023-06-29 09:35:45] [config]   - 1
[2023-06-29 09:35:45] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:35:45] [config] lr-report: false
[2023-06-29 09:35:45] [config] lr-warmup: 0
[2023-06-29 09:35:45] [config] lr-warmup-at-reload: false
[2023-06-29 09:35:45] [config] lr-warmup-cycle: false
[2023-06-29 09:35:45] [config] lr-warmup-start-rate: 0
[2023-06-29 09:35:45] [config] max-length: 50
[2023-06-29 09:35:45] [config] max-length-crop: false
[2023-06-29 09:35:45] [config] max-length-factor: 3
[2023-06-29 09:35:45] [config] maxi-batch: 100
[2023-06-29 09:35:45] [config] maxi-batch-sort: trg
[2023-06-29 09:35:45] [config] mini-batch: 64
[2023-06-29 09:35:45] [config] mini-batch-fit: true
[2023-06-29 09:35:45] [config] mini-batch-fit-step: 10
[2023-06-29 09:35:45] [config] mini-batch-round-up: true
[2023-06-29 09:35:45] [config] mini-batch-track-lr: false
[2023-06-29 09:35:45] [config] mini-batch-warmup: 0
[2023-06-29 09:35:45] [config] mini-batch-words: 0
[2023-06-29 09:35:45] [config] mini-batch-words-ref: 0
[2023-06-29 09:35:45] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:35:45] [config] multi-loss-type: sum
[2023-06-29 09:35:45] [config] n-best: false
[2023-06-29 09:35:45] [config] no-nccl: false
[2023-06-29 09:35:45] [config] no-reload: false
[2023-06-29 09:35:45] [config] no-restore-corpus: false
[2023-06-29 09:35:45] [config] normalize: 0.6
[2023-06-29 09:35:45] [config] normalize-gradient: false
[2023-06-29 09:35:45] [config] num-devices: 0
[2023-06-29 09:35:45] [config] optimizer: adam
[2023-06-29 09:35:45] [config] optimizer-delay: 1
[2023-06-29 09:35:45] [config] optimizer-params:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] output-omit-bias: false
[2023-06-29 09:35:45] [config] overwrite: true
[2023-06-29 09:35:45] [config] precision:
[2023-06-29 09:35:45] [config]   - float32
[2023-06-29 09:35:45] [config]   - float32
[2023-06-29 09:35:45] [config] pretrained-model: ""
[2023-06-29 09:35:45] [config] quantize-biases: false
[2023-06-29 09:35:45] [config] quantize-bits: 0
[2023-06-29 09:35:45] [config] quantize-log-based: false
[2023-06-29 09:35:45] [config] quantize-optimization-steps: 0
[2023-06-29 09:35:45] [config] quiet: false
[2023-06-29 09:35:45] [config] quiet-translation: true
[2023-06-29 09:35:45] [config] relative-paths: false
[2023-06-29 09:35:45] [config] right-left: false
[2023-06-29 09:35:45] [config] save-freq: 10000u
[2023-06-29 09:35:45] [config] seed: 1234
[2023-06-29 09:35:45] [config] sentencepiece-alphas:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:35:45] [config] sentencepiece-options: ""
[2023-06-29 09:35:45] [config] sharding: global
[2023-06-29 09:35:45] [config] shuffle: data
[2023-06-29 09:35:45] [config] shuffle-in-ram: false
[2023-06-29 09:35:45] [config] sigterm: save-and-exit
[2023-06-29 09:35:45] [config] skip: false
[2023-06-29 09:35:45] [config] sqlite: ""
[2023-06-29 09:35:45] [config] sqlite-drop: false
[2023-06-29 09:35:45] [config] sync-freq: 200u
[2023-06-29 09:35:45] [config] sync-sgd: false
[2023-06-29 09:35:45] [config] tempdir: /tmp
[2023-06-29 09:35:45] [config] tied-embeddings: false
[2023-06-29 09:35:45] [config] tied-embeddings-all: true
[2023-06-29 09:35:45] [config] tied-embeddings-src: false
[2023-06-29 09:35:45] [config] train-embedder-rank:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] train-sets:
[2023-06-29 09:35:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:35:45] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:35:45] [config] transformer-aan-activation: swish
[2023-06-29 09:35:45] [config] transformer-aan-depth: 2
[2023-06-29 09:35:45] [config] transformer-aan-nogate: false
[2023-06-29 09:35:45] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:35:45] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:35:45] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:35:45] [config] transformer-depth-scaling: false
[2023-06-29 09:35:45] [config] transformer-dim-aan: 2048
[2023-06-29 09:35:45] [config] transformer-dim-ffn: 2048
[2023-06-29 09:35:45] [config] transformer-dropout: 0
[2023-06-29 09:35:45] [config] transformer-dropout-attention: 0
[2023-06-29 09:35:45] [config] transformer-dropout-ffn: 0
[2023-06-29 09:35:45] [config] transformer-ffn-activation: swish
[2023-06-29 09:35:45] [config] transformer-ffn-depth: 2
[2023-06-29 09:35:45] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:35:45] [config] transformer-heads: 8
[2023-06-29 09:35:45] [config] transformer-no-projection: false
[2023-06-29 09:35:45] [config] transformer-pool: false
[2023-06-29 09:35:45] [config] transformer-postprocess: dan
[2023-06-29 09:35:45] [config] transformer-postprocess-emb: d
[2023-06-29 09:35:45] [config] transformer-postprocess-top: ""
[2023-06-29 09:35:45] [config] transformer-preprocess: ""
[2023-06-29 09:35:45] [config] transformer-tied-layers:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] transformer-train-position-embeddings: false
[2023-06-29 09:35:45] [config] tsv: false
[2023-06-29 09:35:45] [config] tsv-fields: 0
[2023-06-29 09:35:45] [config] type: amun
[2023-06-29 09:35:45] [config] ulr: false
[2023-06-29 09:35:45] [config] ulr-dim-emb: 0
[2023-06-29 09:35:45] [config] ulr-dropout: 0
[2023-06-29 09:35:45] [config] ulr-keys-vectors: ""
[2023-06-29 09:35:45] [config] ulr-query-vectors: ""
[2023-06-29 09:35:45] [config] ulr-softmax-temperature: 1
[2023-06-29 09:35:45] [config] ulr-trainable-transformation: false
[2023-06-29 09:35:45] [config] unlikelihood-loss: false
[2023-06-29 09:35:45] [config] valid-freq: 50000000
[2023-06-29 09:35:45] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:35:45] [config] valid-max-length: 1000
[2023-06-29 09:35:45] [config] valid-metrics:
[2023-06-29 09:35:45] [config]   - cross-entropy
[2023-06-29 09:35:45] [config]   - translation
[2023-06-29 09:35:45] [config] valid-mini-batch: 32
[2023-06-29 09:35:45] [config] valid-reset-stalled: false
[2023-06-29 09:35:45] [config] valid-script-args:
[2023-06-29 09:35:45] [config]   []
[2023-06-29 09:35:45] [config] valid-script-path: ""
[2023-06-29 09:35:45] [config] valid-sets:
[2023-06-29 09:35:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:35:45] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:35:45] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:35:45] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:45] [config] vocabs:
[2023-06-29 09:35:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:35:45] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:35:45] [config] word-penalty: 0
[2023-06-29 09:35:45] [config] word-scores: false
[2023-06-29 09:35:45] [config] workspace: 3000
[2023-06-29 09:35:45] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:35:45] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:45] [training] Using single-device training
[2023-06-29 09:35:46] Synced seed 1234
[2023-06-29 09:35:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:35:46] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:35:46] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:35:46] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:35:46] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:35:46] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:35:46] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:35:47] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:35:47] [comm] Using global sharding
[2023-06-29 09:35:47] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:35:47] [training] Using 1 GPUs
[2023-06-29 09:35:47] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:35:47] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:35:47] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:35:47] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:00] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:36:00] [valid] No post-processing script given for validating translator
[2023-06-29 09:36:00] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:00] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:36:00] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:36:00] [comm] Using global sharding
[2023-06-29 09:36:00] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:36:00] [training] Using 1 GPUs
[2023-06-29 09:36:00] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:36:00] Loading Adam parameters
[2023-06-29 09:36:01] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:36:01] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:01] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:36:01] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:36:01] [data] Shuffling data
[2023-06-29 09:36:01] [data] Done reading 20,192 sentences
[2023-06-29 09:36:01] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:36:01] Training started
[2023-06-29 09:36:01] Training finished
[2023-06-29 09:36:04] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:36:04] [marian] Running on node20.datos.cluster.uy as process 19269 with command line:
[2023-06-29 09:36:04] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 190 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:36:04] [config] after: 0e
[2023-06-29 09:36:04] [config] after-batches: 0
[2023-06-29 09:36:04] [config] after-epochs: 190
[2023-06-29 09:36:04] [config] all-caps-every: 0
[2023-06-29 09:36:04] [config] allow-unk: false
[2023-06-29 09:36:04] [config] authors: false
[2023-06-29 09:36:04] [config] beam-size: 6
[2023-06-29 09:36:04] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:36:04] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:36:04] [config] bert-masking-fraction: 0.15
[2023-06-29 09:36:04] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:36:04] [config] bert-train-type-embeddings: true
[2023-06-29 09:36:04] [config] bert-type-vocab-size: 2
[2023-06-29 09:36:04] [config] build-info: ""
[2023-06-29 09:36:04] [config] check-gradient-nan: false
[2023-06-29 09:36:04] [config] check-nan: false
[2023-06-29 09:36:04] [config] cite: false
[2023-06-29 09:36:04] [config] clip-norm: 1
[2023-06-29 09:36:04] [config] cost-scaling:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] cost-type: ce-sum
[2023-06-29 09:36:04] [config] cpu-threads: 0
[2023-06-29 09:36:04] [config] data-threads: 8
[2023-06-29 09:36:04] [config] data-weighting: ""
[2023-06-29 09:36:04] [config] data-weighting-type: sentence
[2023-06-29 09:36:04] [config] dec-cell: gru
[2023-06-29 09:36:04] [config] dec-cell-base-depth: 2
[2023-06-29 09:36:04] [config] dec-cell-high-depth: 1
[2023-06-29 09:36:04] [config] dec-depth: 1
[2023-06-29 09:36:04] [config] devices:
[2023-06-29 09:36:04] [config]   - 0
[2023-06-29 09:36:04] [config] dim-emb: 512
[2023-06-29 09:36:04] [config] dim-rnn: 1024
[2023-06-29 09:36:04] [config] dim-vocabs:
[2023-06-29 09:36:04] [config]   - 16384
[2023-06-29 09:36:04] [config]   - 16384
[2023-06-29 09:36:04] [config] disp-first: 0
[2023-06-29 09:36:04] [config] disp-freq: 1000u
[2023-06-29 09:36:04] [config] disp-label-counts: true
[2023-06-29 09:36:04] [config] dropout-rnn: 0.2
[2023-06-29 09:36:04] [config] dropout-src: 0.1
[2023-06-29 09:36:04] [config] dropout-trg: 0.1
[2023-06-29 09:36:04] [config] dump-config: ""
[2023-06-29 09:36:04] [config] dynamic-gradient-scaling:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] early-stopping: 10
[2023-06-29 09:36:04] [config] early-stopping-on: first
[2023-06-29 09:36:04] [config] embedding-fix-src: false
[2023-06-29 09:36:04] [config] embedding-fix-trg: false
[2023-06-29 09:36:04] [config] embedding-normalization: false
[2023-06-29 09:36:04] [config] embedding-vectors:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] enc-cell: gru
[2023-06-29 09:36:04] [config] enc-cell-depth: 1
[2023-06-29 09:36:04] [config] enc-depth: 1
[2023-06-29 09:36:04] [config] enc-type: bidirectional
[2023-06-29 09:36:04] [config] english-title-case-every: 0
[2023-06-29 09:36:04] [config] exponential-smoothing: 0
[2023-06-29 09:36:04] [config] factor-weight: 1
[2023-06-29 09:36:04] [config] factors-combine: sum
[2023-06-29 09:36:04] [config] factors-dim-emb: 0
[2023-06-29 09:36:04] [config] gradient-checkpointing: false
[2023-06-29 09:36:04] [config] gradient-norm-average-window: 100
[2023-06-29 09:36:04] [config] guided-alignment: none
[2023-06-29 09:36:04] [config] guided-alignment-cost: mse
[2023-06-29 09:36:04] [config] guided-alignment-weight: 0.1
[2023-06-29 09:36:04] [config] ignore-model-config: false
[2023-06-29 09:36:04] [config] input-types:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] interpolate-env-vars: false
[2023-06-29 09:36:04] [config] keep-best: false
[2023-06-29 09:36:04] [config] label-smoothing: 0
[2023-06-29 09:36:04] [config] layer-normalization: true
[2023-06-29 09:36:04] [config] learn-rate: 0.0001
[2023-06-29 09:36:04] [config] lemma-dependency: ""
[2023-06-29 09:36:04] [config] lemma-dim-emb: 0
[2023-06-29 09:36:04] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:36:04] [config] log-level: info
[2023-06-29 09:36:04] [config] log-time-zone: ""
[2023-06-29 09:36:04] [config] logical-epoch:
[2023-06-29 09:36:04] [config]   - 1e
[2023-06-29 09:36:04] [config]   - 0
[2023-06-29 09:36:04] [config] lr-decay: 0
[2023-06-29 09:36:04] [config] lr-decay-freq: 50000
[2023-06-29 09:36:04] [config] lr-decay-inv-sqrt:
[2023-06-29 09:36:04] [config]   - 0
[2023-06-29 09:36:04] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:36:04] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:36:04] [config] lr-decay-start:
[2023-06-29 09:36:04] [config]   - 10
[2023-06-29 09:36:04] [config]   - 1
[2023-06-29 09:36:04] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:36:04] [config] lr-report: false
[2023-06-29 09:36:04] [config] lr-warmup: 0
[2023-06-29 09:36:04] [config] lr-warmup-at-reload: false
[2023-06-29 09:36:04] [config] lr-warmup-cycle: false
[2023-06-29 09:36:04] [config] lr-warmup-start-rate: 0
[2023-06-29 09:36:04] [config] max-length: 50
[2023-06-29 09:36:04] [config] max-length-crop: false
[2023-06-29 09:36:04] [config] max-length-factor: 3
[2023-06-29 09:36:04] [config] maxi-batch: 100
[2023-06-29 09:36:04] [config] maxi-batch-sort: trg
[2023-06-29 09:36:04] [config] mini-batch: 64
[2023-06-29 09:36:04] [config] mini-batch-fit: true
[2023-06-29 09:36:04] [config] mini-batch-fit-step: 10
[2023-06-29 09:36:04] [config] mini-batch-round-up: true
[2023-06-29 09:36:04] [config] mini-batch-track-lr: false
[2023-06-29 09:36:04] [config] mini-batch-warmup: 0
[2023-06-29 09:36:04] [config] mini-batch-words: 0
[2023-06-29 09:36:04] [config] mini-batch-words-ref: 0
[2023-06-29 09:36:04] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:36:04] [config] multi-loss-type: sum
[2023-06-29 09:36:04] [config] n-best: false
[2023-06-29 09:36:04] [config] no-nccl: false
[2023-06-29 09:36:04] [config] no-reload: false
[2023-06-29 09:36:04] [config] no-restore-corpus: false
[2023-06-29 09:36:04] [config] normalize: 0.6
[2023-06-29 09:36:04] [config] normalize-gradient: false
[2023-06-29 09:36:04] [config] num-devices: 0
[2023-06-29 09:36:04] [config] optimizer: adam
[2023-06-29 09:36:04] [config] optimizer-delay: 1
[2023-06-29 09:36:04] [config] optimizer-params:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] output-omit-bias: false
[2023-06-29 09:36:04] [config] overwrite: true
[2023-06-29 09:36:04] [config] precision:
[2023-06-29 09:36:04] [config]   - float32
[2023-06-29 09:36:04] [config]   - float32
[2023-06-29 09:36:04] [config] pretrained-model: ""
[2023-06-29 09:36:04] [config] quantize-biases: false
[2023-06-29 09:36:04] [config] quantize-bits: 0
[2023-06-29 09:36:04] [config] quantize-log-based: false
[2023-06-29 09:36:04] [config] quantize-optimization-steps: 0
[2023-06-29 09:36:04] [config] quiet: false
[2023-06-29 09:36:04] [config] quiet-translation: true
[2023-06-29 09:36:04] [config] relative-paths: false
[2023-06-29 09:36:04] [config] right-left: false
[2023-06-29 09:36:04] [config] save-freq: 10000u
[2023-06-29 09:36:04] [config] seed: 1234
[2023-06-29 09:36:04] [config] sentencepiece-alphas:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:36:04] [config] sentencepiece-options: ""
[2023-06-29 09:36:04] [config] sharding: global
[2023-06-29 09:36:04] [config] shuffle: data
[2023-06-29 09:36:04] [config] shuffle-in-ram: false
[2023-06-29 09:36:04] [config] sigterm: save-and-exit
[2023-06-29 09:36:04] [config] skip: false
[2023-06-29 09:36:04] [config] sqlite: ""
[2023-06-29 09:36:04] [config] sqlite-drop: false
[2023-06-29 09:36:04] [config] sync-freq: 200u
[2023-06-29 09:36:04] [config] sync-sgd: false
[2023-06-29 09:36:04] [config] tempdir: /tmp
[2023-06-29 09:36:04] [config] tied-embeddings: false
[2023-06-29 09:36:04] [config] tied-embeddings-all: true
[2023-06-29 09:36:04] [config] tied-embeddings-src: false
[2023-06-29 09:36:04] [config] train-embedder-rank:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] train-sets:
[2023-06-29 09:36:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:36:04] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:36:04] [config] transformer-aan-activation: swish
[2023-06-29 09:36:04] [config] transformer-aan-depth: 2
[2023-06-29 09:36:04] [config] transformer-aan-nogate: false
[2023-06-29 09:36:04] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:36:04] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:36:04] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:36:04] [config] transformer-depth-scaling: false
[2023-06-29 09:36:04] [config] transformer-dim-aan: 2048
[2023-06-29 09:36:04] [config] transformer-dim-ffn: 2048
[2023-06-29 09:36:04] [config] transformer-dropout: 0
[2023-06-29 09:36:04] [config] transformer-dropout-attention: 0
[2023-06-29 09:36:04] [config] transformer-dropout-ffn: 0
[2023-06-29 09:36:04] [config] transformer-ffn-activation: swish
[2023-06-29 09:36:04] [config] transformer-ffn-depth: 2
[2023-06-29 09:36:04] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:36:04] [config] transformer-heads: 8
[2023-06-29 09:36:04] [config] transformer-no-projection: false
[2023-06-29 09:36:04] [config] transformer-pool: false
[2023-06-29 09:36:04] [config] transformer-postprocess: dan
[2023-06-29 09:36:04] [config] transformer-postprocess-emb: d
[2023-06-29 09:36:04] [config] transformer-postprocess-top: ""
[2023-06-29 09:36:04] [config] transformer-preprocess: ""
[2023-06-29 09:36:04] [config] transformer-tied-layers:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] transformer-train-position-embeddings: false
[2023-06-29 09:36:04] [config] tsv: false
[2023-06-29 09:36:04] [config] tsv-fields: 0
[2023-06-29 09:36:04] [config] type: amun
[2023-06-29 09:36:04] [config] ulr: false
[2023-06-29 09:36:04] [config] ulr-dim-emb: 0
[2023-06-29 09:36:04] [config] ulr-dropout: 0
[2023-06-29 09:36:04] [config] ulr-keys-vectors: ""
[2023-06-29 09:36:04] [config] ulr-query-vectors: ""
[2023-06-29 09:36:04] [config] ulr-softmax-temperature: 1
[2023-06-29 09:36:04] [config] ulr-trainable-transformation: false
[2023-06-29 09:36:04] [config] unlikelihood-loss: false
[2023-06-29 09:36:04] [config] valid-freq: 50000000
[2023-06-29 09:36:04] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:36:04] [config] valid-max-length: 1000
[2023-06-29 09:36:04] [config] valid-metrics:
[2023-06-29 09:36:04] [config]   - cross-entropy
[2023-06-29 09:36:04] [config]   - translation
[2023-06-29 09:36:04] [config] valid-mini-batch: 32
[2023-06-29 09:36:04] [config] valid-reset-stalled: false
[2023-06-29 09:36:04] [config] valid-script-args:
[2023-06-29 09:36:04] [config]   []
[2023-06-29 09:36:04] [config] valid-script-path: ""
[2023-06-29 09:36:04] [config] valid-sets:
[2023-06-29 09:36:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:36:04] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:36:04] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:36:04] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:36:04] [config] vocabs:
[2023-06-29 09:36:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:36:04] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:36:04] [config] word-penalty: 0
[2023-06-29 09:36:04] [config] word-scores: false
[2023-06-29 09:36:04] [config] workspace: 3000
[2023-06-29 09:36:04] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:36:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:04] [training] Using single-device training
[2023-06-29 09:36:04] Synced seed 1234
[2023-06-29 09:36:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:36:04] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:36:04] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:36:04] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:36:04] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:36:04] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:05] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:36:05] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:36:05] [comm] Using global sharding
[2023-06-29 09:36:05] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:36:05] [training] Using 1 GPUs
[2023-06-29 09:36:05] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:36:05] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:05] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:36:06] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:19] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:36:19] [valid] No post-processing script given for validating translator
[2023-06-29 09:36:19] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:19] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:36:19] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:36:19] [comm] Using global sharding
[2023-06-29 09:36:19] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:36:19] [training] Using 1 GPUs
[2023-06-29 09:36:19] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:36:19] Loading Adam parameters
[2023-06-29 09:36:20] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:36:20] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:20] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:36:20] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:36:20] [data] Shuffling data
[2023-06-29 09:36:20] [data] Done reading 20,192 sentences
[2023-06-29 09:36:20] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:36:20] Training started
[2023-06-29 09:36:20] Training finished
[2023-06-29 09:36:23] [marian] Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:36:23] [marian] Running on node20.datos.cluster.uy as process 19335 with command line:
[2023-06-29 09:36:23] [marian] /marian/build/marian --train-sets /docker/home/marianmt/artifacts/data/train/train_es.txt.es /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn --model /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz --after-epochs 200 --valid-freq 50000000 --vocabs /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm --seed 1234 --type amun --tied-embeddings-all --dim-vocabs 16384 16384 --normalize 0.6 --beam-size 6 --mini-batch-fit -w 3000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --cpu-threads 0 --log /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log --valid-log /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log --valid-sets /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es --valid-metrics cross-entropy translation --valid-translation-output /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt --quiet-translation --overwrite
[2023-06-29 09:36:23] [config] after: 0e
[2023-06-29 09:36:23] [config] after-batches: 0
[2023-06-29 09:36:23] [config] after-epochs: 200
[2023-06-29 09:36:23] [config] all-caps-every: 0
[2023-06-29 09:36:23] [config] allow-unk: false
[2023-06-29 09:36:23] [config] authors: false
[2023-06-29 09:36:23] [config] beam-size: 6
[2023-06-29 09:36:23] [config] bert-class-symbol: "[CLS]"
[2023-06-29 09:36:23] [config] bert-mask-symbol: "[MASK]"
[2023-06-29 09:36:23] [config] bert-masking-fraction: 0.15
[2023-06-29 09:36:23] [config] bert-sep-symbol: "[SEP]"
[2023-06-29 09:36:23] [config] bert-train-type-embeddings: true
[2023-06-29 09:36:23] [config] bert-type-vocab-size: 2
[2023-06-29 09:36:23] [config] build-info: ""
[2023-06-29 09:36:23] [config] check-gradient-nan: false
[2023-06-29 09:36:23] [config] check-nan: false
[2023-06-29 09:36:23] [config] cite: false
[2023-06-29 09:36:23] [config] clip-norm: 1
[2023-06-29 09:36:23] [config] cost-scaling:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] cost-type: ce-sum
[2023-06-29 09:36:23] [config] cpu-threads: 0
[2023-06-29 09:36:23] [config] data-threads: 8
[2023-06-29 09:36:23] [config] data-weighting: ""
[2023-06-29 09:36:23] [config] data-weighting-type: sentence
[2023-06-29 09:36:23] [config] dec-cell: gru
[2023-06-29 09:36:23] [config] dec-cell-base-depth: 2
[2023-06-29 09:36:23] [config] dec-cell-high-depth: 1
[2023-06-29 09:36:23] [config] dec-depth: 1
[2023-06-29 09:36:23] [config] devices:
[2023-06-29 09:36:23] [config]   - 0
[2023-06-29 09:36:23] [config] dim-emb: 512
[2023-06-29 09:36:23] [config] dim-rnn: 1024
[2023-06-29 09:36:23] [config] dim-vocabs:
[2023-06-29 09:36:23] [config]   - 16384
[2023-06-29 09:36:23] [config]   - 16384
[2023-06-29 09:36:23] [config] disp-first: 0
[2023-06-29 09:36:23] [config] disp-freq: 1000u
[2023-06-29 09:36:23] [config] disp-label-counts: true
[2023-06-29 09:36:23] [config] dropout-rnn: 0.2
[2023-06-29 09:36:23] [config] dropout-src: 0.1
[2023-06-29 09:36:23] [config] dropout-trg: 0.1
[2023-06-29 09:36:23] [config] dump-config: ""
[2023-06-29 09:36:23] [config] dynamic-gradient-scaling:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] early-stopping: 10
[2023-06-29 09:36:23] [config] early-stopping-on: first
[2023-06-29 09:36:23] [config] embedding-fix-src: false
[2023-06-29 09:36:23] [config] embedding-fix-trg: false
[2023-06-29 09:36:23] [config] embedding-normalization: false
[2023-06-29 09:36:23] [config] embedding-vectors:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] enc-cell: gru
[2023-06-29 09:36:23] [config] enc-cell-depth: 1
[2023-06-29 09:36:23] [config] enc-depth: 1
[2023-06-29 09:36:23] [config] enc-type: bidirectional
[2023-06-29 09:36:23] [config] english-title-case-every: 0
[2023-06-29 09:36:23] [config] exponential-smoothing: 0
[2023-06-29 09:36:23] [config] factor-weight: 1
[2023-06-29 09:36:23] [config] factors-combine: sum
[2023-06-29 09:36:23] [config] factors-dim-emb: 0
[2023-06-29 09:36:23] [config] gradient-checkpointing: false
[2023-06-29 09:36:23] [config] gradient-norm-average-window: 100
[2023-06-29 09:36:23] [config] guided-alignment: none
[2023-06-29 09:36:23] [config] guided-alignment-cost: mse
[2023-06-29 09:36:23] [config] guided-alignment-weight: 0.1
[2023-06-29 09:36:23] [config] ignore-model-config: false
[2023-06-29 09:36:23] [config] input-types:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] interpolate-env-vars: false
[2023-06-29 09:36:23] [config] keep-best: false
[2023-06-29 09:36:23] [config] label-smoothing: 0
[2023-06-29 09:36:23] [config] layer-normalization: true
[2023-06-29 09:36:23] [config] learn-rate: 0.0001
[2023-06-29 09:36:23] [config] lemma-dependency: ""
[2023-06-29 09:36:23] [config] lemma-dim-emb: 0
[2023-06-29 09:36:23] [config] log: /docker/home/marianmt/logs/marian/split_model_es_es_scored_june_sp.log
[2023-06-29 09:36:23] [config] log-level: info
[2023-06-29 09:36:23] [config] log-time-zone: ""
[2023-06-29 09:36:23] [config] logical-epoch:
[2023-06-29 09:36:23] [config]   - 1e
[2023-06-29 09:36:23] [config]   - 0
[2023-06-29 09:36:23] [config] lr-decay: 0
[2023-06-29 09:36:23] [config] lr-decay-freq: 50000
[2023-06-29 09:36:23] [config] lr-decay-inv-sqrt:
[2023-06-29 09:36:23] [config]   - 0
[2023-06-29 09:36:23] [config] lr-decay-repeat-warmup: false
[2023-06-29 09:36:23] [config] lr-decay-reset-optimizer: false
[2023-06-29 09:36:23] [config] lr-decay-start:
[2023-06-29 09:36:23] [config]   - 10
[2023-06-29 09:36:23] [config]   - 1
[2023-06-29 09:36:23] [config] lr-decay-strategy: epoch+stalled
[2023-06-29 09:36:23] [config] lr-report: false
[2023-06-29 09:36:23] [config] lr-warmup: 0
[2023-06-29 09:36:23] [config] lr-warmup-at-reload: false
[2023-06-29 09:36:23] [config] lr-warmup-cycle: false
[2023-06-29 09:36:23] [config] lr-warmup-start-rate: 0
[2023-06-29 09:36:23] [config] max-length: 50
[2023-06-29 09:36:23] [config] max-length-crop: false
[2023-06-29 09:36:23] [config] max-length-factor: 3
[2023-06-29 09:36:23] [config] maxi-batch: 100
[2023-06-29 09:36:23] [config] maxi-batch-sort: trg
[2023-06-29 09:36:23] [config] mini-batch: 64
[2023-06-29 09:36:23] [config] mini-batch-fit: true
[2023-06-29 09:36:23] [config] mini-batch-fit-step: 10
[2023-06-29 09:36:23] [config] mini-batch-round-up: true
[2023-06-29 09:36:23] [config] mini-batch-track-lr: false
[2023-06-29 09:36:23] [config] mini-batch-warmup: 0
[2023-06-29 09:36:23] [config] mini-batch-words: 0
[2023-06-29 09:36:23] [config] mini-batch-words-ref: 0
[2023-06-29 09:36:23] [config] model: /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:36:23] [config] multi-loss-type: sum
[2023-06-29 09:36:23] [config] n-best: false
[2023-06-29 09:36:23] [config] no-nccl: false
[2023-06-29 09:36:23] [config] no-reload: false
[2023-06-29 09:36:23] [config] no-restore-corpus: false
[2023-06-29 09:36:23] [config] normalize: 0.6
[2023-06-29 09:36:23] [config] normalize-gradient: false
[2023-06-29 09:36:23] [config] num-devices: 0
[2023-06-29 09:36:23] [config] optimizer: adam
[2023-06-29 09:36:23] [config] optimizer-delay: 1
[2023-06-29 09:36:23] [config] optimizer-params:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] output-omit-bias: false
[2023-06-29 09:36:23] [config] overwrite: true
[2023-06-29 09:36:23] [config] precision:
[2023-06-29 09:36:23] [config]   - float32
[2023-06-29 09:36:23] [config]   - float32
[2023-06-29 09:36:23] [config] pretrained-model: ""
[2023-06-29 09:36:23] [config] quantize-biases: false
[2023-06-29 09:36:23] [config] quantize-bits: 0
[2023-06-29 09:36:23] [config] quantize-log-based: false
[2023-06-29 09:36:23] [config] quantize-optimization-steps: 0
[2023-06-29 09:36:23] [config] quiet: false
[2023-06-29 09:36:23] [config] quiet-translation: true
[2023-06-29 09:36:23] [config] relative-paths: false
[2023-06-29 09:36:23] [config] right-left: false
[2023-06-29 09:36:23] [config] save-freq: 10000u
[2023-06-29 09:36:23] [config] seed: 1234
[2023-06-29 09:36:23] [config] sentencepiece-alphas:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] sentencepiece-max-lines: 2000000
[2023-06-29 09:36:23] [config] sentencepiece-options: ""
[2023-06-29 09:36:23] [config] sharding: global
[2023-06-29 09:36:23] [config] shuffle: data
[2023-06-29 09:36:23] [config] shuffle-in-ram: false
[2023-06-29 09:36:23] [config] sigterm: save-and-exit
[2023-06-29 09:36:23] [config] skip: false
[2023-06-29 09:36:23] [config] sqlite: ""
[2023-06-29 09:36:23] [config] sqlite-drop: false
[2023-06-29 09:36:23] [config] sync-freq: 200u
[2023-06-29 09:36:23] [config] sync-sgd: false
[2023-06-29 09:36:23] [config] tempdir: /tmp
[2023-06-29 09:36:23] [config] tied-embeddings: false
[2023-06-29 09:36:23] [config] tied-embeddings-all: true
[2023-06-29 09:36:23] [config] tied-embeddings-src: false
[2023-06-29 09:36:23] [config] train-embedder-rank:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] train-sets:
[2023-06-29 09:36:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_es.txt.es
[2023-06-29 09:36:23] [config]   - /docker/home/marianmt/artifacts/data/train/train_gn.txt.gn
[2023-06-29 09:36:23] [config] transformer-aan-activation: swish
[2023-06-29 09:36:23] [config] transformer-aan-depth: 2
[2023-06-29 09:36:23] [config] transformer-aan-nogate: false
[2023-06-29 09:36:23] [config] transformer-decoder-autoreg: self-attention
[2023-06-29 09:36:23] [config] transformer-decoder-dim-ffn: 0
[2023-06-29 09:36:23] [config] transformer-decoder-ffn-depth: 0
[2023-06-29 09:36:23] [config] transformer-depth-scaling: false
[2023-06-29 09:36:23] [config] transformer-dim-aan: 2048
[2023-06-29 09:36:23] [config] transformer-dim-ffn: 2048
[2023-06-29 09:36:23] [config] transformer-dropout: 0
[2023-06-29 09:36:23] [config] transformer-dropout-attention: 0
[2023-06-29 09:36:23] [config] transformer-dropout-ffn: 0
[2023-06-29 09:36:23] [config] transformer-ffn-activation: swish
[2023-06-29 09:36:23] [config] transformer-ffn-depth: 2
[2023-06-29 09:36:23] [config] transformer-guided-alignment-layer: last
[2023-06-29 09:36:23] [config] transformer-heads: 8
[2023-06-29 09:36:23] [config] transformer-no-projection: false
[2023-06-29 09:36:23] [config] transformer-pool: false
[2023-06-29 09:36:23] [config] transformer-postprocess: dan
[2023-06-29 09:36:23] [config] transformer-postprocess-emb: d
[2023-06-29 09:36:23] [config] transformer-postprocess-top: ""
[2023-06-29 09:36:23] [config] transformer-preprocess: ""
[2023-06-29 09:36:23] [config] transformer-tied-layers:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] transformer-train-position-embeddings: false
[2023-06-29 09:36:23] [config] tsv: false
[2023-06-29 09:36:23] [config] tsv-fields: 0
[2023-06-29 09:36:23] [config] type: amun
[2023-06-29 09:36:23] [config] ulr: false
[2023-06-29 09:36:23] [config] ulr-dim-emb: 0
[2023-06-29 09:36:23] [config] ulr-dropout: 0
[2023-06-29 09:36:23] [config] ulr-keys-vectors: ""
[2023-06-29 09:36:23] [config] ulr-query-vectors: ""
[2023-06-29 09:36:23] [config] ulr-softmax-temperature: 1
[2023-06-29 09:36:23] [config] ulr-trainable-transformation: false
[2023-06-29 09:36:23] [config] unlikelihood-loss: false
[2023-06-29 09:36:23] [config] valid-freq: 50000000
[2023-06-29 09:36:23] [config] valid-log: /docker/home/marianmt/logs/marian/split_tok_150_es_es_scored_june_sp.log
[2023-06-29 09:36:23] [config] valid-max-length: 1000
[2023-06-29 09:36:23] [config] valid-metrics:
[2023-06-29 09:36:23] [config]   - cross-entropy
[2023-06-29 09:36:23] [config]   - translation
[2023-06-29 09:36:23] [config] valid-mini-batch: 32
[2023-06-29 09:36:23] [config] valid-reset-stalled: false
[2023-06-29 09:36:23] [config] valid-script-args:
[2023-06-29 09:36:23] [config]   []
[2023-06-29 09:36:23] [config] valid-script-path: ""
[2023-06-29 09:36:23] [config] valid-sets:
[2023-06-29 09:36:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_gn.txt.gn
[2023-06-29 09:36:23] [config]   - /docker/home/marianmt/artifacts/data/validation/valid_es.txt.es
[2023-06-29 09:36:23] [config] valid-translation-output: /docker/home/marianmt/evaluation/decoded-sp16-gn-es.txt
[2023-06-29 09:36:23] [config] version: v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:36:23] [config] vocabs:
[2023-06-29 09:36:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:36:23] [config]   - /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:36:23] [config] word-penalty: 0
[2023-06-29 09:36:23] [config] word-scores: false
[2023-06-29 09:36:23] [config] workspace: 3000
[2023-06-29 09:36:23] [config] Loaded model has been created with Marian v1.11.0 f00d062 2022-02-08 08:39:24 -0800
[2023-06-29 09:36:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:23] [training] Using single-device training
[2023-06-29 09:36:23] Synced seed 1234
[2023-06-29 09:36:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/es_unique_tokens16.txt.es.spm
[2023-06-29 09:36:23] [data] Setting vocabulary size for input 0 to 16,384
[2023-06-29 09:36:23] [data] Loading SentencePiece vocabulary from file /docker/home/marianmt/artifacts/data/vocabulary/gn_unique_tokens16.txt.gn.spm
[2023-06-29 09:36:23] [data] Setting vocabulary size for input 1 to 16,384
[2023-06-29 09:36:23] [batching] Collecting statistics for batch fitting with step size 10
[2023-06-29 09:36:23] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:24] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:36:24] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:36:24] [comm] Using global sharding
[2023-06-29 09:36:24] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:36:24] [training] Using 1 GPUs
[2023-06-29 09:36:24] [logits] Applying loss function for 1 factor(s)
[2023-06-29 09:36:24] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:24] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2023-06-29 09:36:25] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:37] [batching] Done. Typical MB size is 6,418 target words
[2023-06-29 09:36:37] [valid] No post-processing script given for validating translator
[2023-06-29 09:36:37] [MPI rank 0 out of 1]: GPU[0]
[2023-06-29 09:36:37] [memory] Extending reserved space to 3072 MB (device gpu0)
[2023-06-29 09:36:37] [comm] Using NCCL 2.8.3 for GPU communication
[2023-06-29 09:36:37] [comm] Using global sharding
[2023-06-29 09:36:37] [comm] NCCLCommunicators constructed successfully
[2023-06-29 09:36:37] [training] Using 1 GPUs
[2023-06-29 09:36:37] Loading model from /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz
[2023-06-29 09:36:38] Loading Adam parameters
[2023-06-29 09:36:38] [memory] Reserving 322 MB, device gpu0
[2023-06-29 09:36:38] [memory] Reserving 161 MB, device gpu0
[2023-06-29 09:36:38] [training] Master parameters and optimizers restored from training checkpoint /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz and /docker/home/marianmt/artifacts/models/model_es_es_scored_june_sp/es_es_scored_june_sp.npz.optimizer.npz
[2023-06-29 09:36:38] [data] Restoring the corpus state to epoch 131, batch 14475
[2023-06-29 09:36:38] [data] Shuffling data
[2023-06-29 09:36:38] [data] Done reading 20,192 sentences
[2023-06-29 09:36:38] [data] Done shuffling 20,192 sentences to temp files
[2023-06-29 09:36:38] Training started
[2023-06-29 09:36:38] Training finished
